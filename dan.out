cscope 15 $HOME/server/dante-1.4.1               0002617263
	@_sockopttmp0.c

1 { 
	gSOL_SOCKET
, 
	gSO_BROADCAST
, "SO_BROADCAST" },

2 { 
	gSOL_SOCKET
, 
	gSO_DEBUG
, "SO_DEBUG" },

3 { 
	gSOL_SOCKET
, 
	gSO_DONTROUTE
, "SO_DONTROUTE" },

4 { 
	gSOL_SOCKET
, 
	gSO_KEEPALIVE
, "SO_KEEPALIVE" },

5 { 
	gSOL_SOCKET
, 
	gSO_LINGER
, "SO_LINGER" },

6 { 
	gSOL_SOCKET
, 
	gSO_OOBINLINE
, "SO_OOBINLINE" },

7 { 
	gSOL_SOCKET
, 
	gSO_RCVBUF
, "SO_RCVBUF" },

8 { 
	gSOL_SOCKET
, 
	gSO_RCVLOWAT
, "SO_RCVLOWAT" },

9 { 
	gSOL_SOCKET
, 
	gSO_RCVTIMEO
, "SO_RCVTIMEO" },

10 { 
	gSOL_SOCKET
, 
	gSO_SNDBUF
, "SO_SNDBUF" },

11 { 
	gSOL_SOCKET
, 
	gSO_SNDLOWAT
, "SO_SNDLOWAT" },

12 { 
	gSOL_SOCKET
, 
	gSO_SNDTIMEO
, "SO_SNDTIMEO" },

13 { 
	gSOL_SOCKET
, 
	gSO_TIMESTAMP
, "SO_TIMESTAMP" },

14 { 
	gIPPROTO_TCP
, 
	gTCP_MAXSEG
, "TCP_MAXSEG" },

15 { 
	gIPPROTO_TCP
, 
	gTCP_NODELAY
, "TCP_NODELAY" },

16 { 
	gIPPROTO_IP
, 
	gIP_TOS
, "IP_TOS" },

17 { 
	gIPPROTO_IP
, 
	gIP_TTL
, "IP_TTL" },

18 { 
	gSOL_SOCKET
, 
	gSO_REUSEADDR
, "SO_REUSEADDR" },

19 { 
	gSOL_SOCKET
, 
	gSO_REUSEPORT
, "SO_REUSEPORT" },

20 { 
	gIPPROTO_IP
, 
	gIP_HDRINCL
, "IP_HDRINCL" },

21 { 
	gIPPROTO_IP
, 
	gIP_HDRINCL
, "IP_HDRINCL" },

22 { 
	gIPPROTO_IP
, 
	gIP_MULTICAST_IF
, "IP_MULTICAST_IF" },

23 { 
	gIPPROTO_IP
, 
	gIP_MULTICAST_LOOP
, "IP_MULTICAST_LOOP" },

24 { 
	gIPPROTO_IP
, 
	gIP_MULTICAST_TTL
, "IP_MULTICAST_TTL" },

25 { 
	gIPPROTO_IP
, 
	gIP_OPTIONS
, "IP_OPTIONS" },

	@capi/socks.h

46 
	~<sys/ty≥s.h
>

47 
	~<sys/sockë.h
>

54 
	~<√töë/ö.h
>

56 
	~<√tdb.h
>

59 
	#ac˚±
 
Rac˚±


	)

60 
	#böd
 
Rböd


	)

61 
	#bödªsvp‹t
 
Rbödªsvp‹t


	)

62 
	#c⁄√˘
 
Rc⁄√˘


	)

63 
	#gëho°by«me
 
Rgëho°by«me


	)

64 
	#gëho°by«me2
 
Rgëho°by«me2


	)

65 
	#gëaddröfo
 
Rgëaddröfo


	)

66 
	#gëùnodeby«me
 
Rgëùnodeby«me


	)

67 
	#gë≥î«me
 
Rgë≥î«me


	)

68 
	#gësock«me
 
Rgësock«me


	)

69 
	#gësock›t
 
Rgësock›t


	)

70 
	#li°í
 
Rli°í


	)

71 
	#ªad
 
Rªad


	)

72 
	#ªadv
 
Rªadv


	)

73 
	#ªcv
 
Rªcv


	)

74 
	#ªcv‰om
 
Rªcv‰om


	)

75 
	#ªcv‰om
 
Rªcv‰om


	)

76 
	#ªcvmsg
 
Rªcvmsg


	)

77 
	#ºesvp‹t
 
Rºesvp‹t


	)

78 
	#£nd
 
R£nd


	)

79 
	#£ndmsg
 
R£ndmsg


	)

80 
	#£ndto
 
R£ndto


	)

81 
	#wrôe
 
Rwrôe


	)

82 
	#wrôev
 
Rwrôev


	)

85 
SOCKSöô
(*
¥og«me
);

93 
Rac˚±
(, 
sockaddr
 *, 
sockÀn_t
 *);

94 
Rc⁄√˘
(, c⁄° 
sockaddr
 *, 
sockÀn_t
);

95 
Rgësock«me
(, 
sockaddr
 *, 
sockÀn_t
 *);

96 
Rgësock›t
(, , , *, 
sockÀn_t
 *);

97 
Rgë≥î«me
(, 
sockaddr
 *, 
sockÀn_t
 *);

98 
ssize_t
 
R£ndto
(
s
, c⁄° *
msg
, 
size_t
 
Àn
, 
Êags
,

99 c⁄° 
sockaddr
 *
to
, 
sockÀn_t
 
tﬁí
);

100 
ssize_t
 
Rªcv‰om
(
s
, *
buf
, 
size_t
 
Àn
, 
Êags
,

101 
sockaddr
 * 
‰om
, 
sockÀn_t
 *
‰omÀn
);

102 
ssize_t
 
R£ndmsg
(
s
, c⁄° 
msghdr
 *
msg
, 
Êags
);

103 
ssize_t
 
Rªcvmsg
(
s
, 
msghdr
 *
msg
, 
Êags
);

104 
Rböd
(, c⁄° 
sockaddr
 *, 
sockÀn_t
);

106 
Rbödªsvp‹t
(, 
sockaddr_ö
 *);

107 
Rºesvp‹t
(*);

108 
ho°ít
 *
Rgëho°by«me
(const *);

109 
ho°ít
 *
Rgëho°by«me2
(c⁄° *, 
af
);

110 
Rgëaddröfo
(c⁄° *
nodíame
, c⁄° *
£rv«me
,

111 c⁄° 
addröfo
 *
höts
, addröfÿ**
ªs
);

112 
ho°ít
 *
Rgëùnodeby«me
(c⁄° *
«me
, 
af
, 
Êags
,

113 *
îr‹_num
);

114 
ssize_t
 
Rwrôe
(
d
, c⁄° *
buf
, 
size_t
 
nbyãs
);

115 
ssize_t
 
Rwrôev
(
d
, c⁄° 
iovec
 *
iov
, 
iov˙t
);

116 
ssize_t
 
R£nd
(
s
, c⁄° *
msg
, 
size_t
 
Àn
, 
Êags
);

117 
ssize_t
 
Rªad
(
d
, *
buf
, 
size_t
 
nbyãs
);

118 
ssize_t
 
Rªadv
(
d
, c⁄° 
iovec
 *
iov
, 
iov˙t
);

119 
ssize_t
 
Rªcv
(
s
, *
msg
, 
size_t
 
Àn
, 
Êags
);

121 
Rli°í
(, );

122 
R£À˘
(, 
fd_£t
 *, fd_£à*, fd_£à*, 
timevÆ
 *);

	@capi/socks_glibc.h

54 #i‡
HAVE_GSSAPI


55 
	#gës
 
Rgës


	)

56 
	#fgëc
 
Rfgëc


	)

57 
	#fgës
 
Rfgës


	)

58 
	#Âutc
 
RÂutc


	)

59 
	#Âuts
 
RÂuts


	)

60 
	#fÊush
 
RfÊush


	)

61 
	#f˛o£
 
Rf˛o£


	)

62 
	#Ârötf
 
RÂrötf


	)

63 
	#vÂrötf
 
RvÂrötf


	)

64 
	#fwrôe
 
Rfwrôe


	)

65 
	#‰ód
 
R‰ód


	)

66 
	#puts
(
x
Ë
	`RÂuts
(x, 
°dout
)

	)

67 
	#¥ötf
(
x
, ...Ë
	`RÂrötf
(
°dout
,x, 
__VA_ARGS__
)

	)

68 
	#v¥ötf
(
x
, 
y
Ë
	`RvÂrötf
(
°dout
,x, y)

	)

70 #ifde‡
gëc


71 #unde‡
gëc


73 
	#gëc
 
Rfgëc


	)

75 #ifde‡
putc


76 #unde‡
putc


78 
	#putc
 
RÂutc


	)

80 #ifde‡
__Ârötf_chk


81 #unde‡
__Ârötf_chk


83 
	#__Ârötf_chk
 
RÂrötf


	)

84 #ifde‡
__vÂrötf_chk


85 #unde‡
__vÂrötf_chk


87 
	#__vÂrötf_chk
 
RvÂrötf


	)

89 
Rfgëc
(
FILE
 *
Â
);

90 
RÂutc
(
c
, 
FILE
 *
Â
);

91 *
Rgës
(*
s
);

92 *
Rfgës
(*
s
, 
size
, 
FILE
 *
Â
);

93 
RÂuts
(c⁄° *
s
, 
FILE
 *
Â
);

94 
RÂrötf
(
FILE
 *
Â
, c⁄° *
s
, ...);

95 
RvÂrötf
(
FILE
 *
Â
, c⁄° *
s
, 
va_li°
 
≠
);

96 
size_t
 
Rfwrôe
(c⁄° *
±r
, size_à
size
, size_à
nmb
, 
FILE
 *
Â
);

97 
size_t
 
R‰ód
(*
±r
, size_à
size
, size_à
nmb
, 
FILE
 *
Â
);

98 
RfÊush
(
FILE
 *
Â
);

99 
Rf˛o£
(
FILE
 *
Â
);

	@dlib/int_osf1.c

44 
	~"comm⁄.h
"

46 #i‡
HAVE_EXTRA_OSF_SYMBOLS


48 #i‡
SOCKSLIBRARY_DYNAMIC


50 c⁄° 
	grcsid
[] =

53 #unde‡
ac˚±


54 #unde‡
gë≥î«me


55 #unde‡
gësock«me


56 #unde‡
ªadv


57 #unde‡
ªcv‰om


58 #unde‡
ªcvmsg


59 #unde‡
£ndmsg


60 #unde‡
wrôev


65 
	$sys_Eac˚±
(
s
, 
addr
, 
addæí
)

66 
s
;

67 
sockaddr
 * 
addr
;

68 
sockÀn_t
 *
addæí
;

70 
rc
;

71 (*
fun˘i⁄
)(
s
, 
sockaddr
 *
addr
, 
sockÀn_t
 *
addæí
);

73 
	`socks_sysˇŒ_°¨t
(
s
);

74 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_EACCEPT
);

75 
rc
 = 
	`fun˘i⁄
(
s
, 
addr
, 
addæí
);

76 
	`socks_sysˇŒ_íd
(
s
);

77  
rc
;

78 
	}
}

81 
	$sys_Egë≥î«me
(
s
, 
«me
, 
«mñí
)

82 
s
;

83 
sockaddr
 * 
«me
;

84 
sockÀn_t
 *
«mñí
;

86 
rc
;

87 (*
fun˘i⁄
)(
s
, c⁄° 
sockaddr
 *
«me
, 
sockÀn_t
 *
«mñí
);

89 
	`socks_sysˇŒ_°¨t
(
s
);

90 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_EGETPEERNAME
);

91 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

92 
	`socks_sysˇŒ_íd
(
s
);

93  
rc
;

94 
	}
}

97 
	$sys_Egësock«me
(
s
, 
«me
, 
«mñí
)

98 
s
;

99 
sockaddr
 * 
«me
;

100 
sockÀn_t
 *
«mñí
;

102 
rc
;

103 (*
fun˘i⁄
)(
s
, c⁄° 
sockaddr
 *
«me
, 
sockÀn_t
 *
«mñí
);

105 
	`socks_sysˇŒ_°¨t
(
s
);

106 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_EGETSOCKNAME
);

107 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

108 
	`socks_sysˇŒ_íd
(
s
);

109  
rc
;

110 
	}
}

112 
ssize_t


113 
	$sys_Eªadv
(
d
, 
iov
, 
iov˙t
)

114 
d
;

115 c⁄° 
iovec
 *
iov
;

116 
iov˙t
;

118 
ssize_t
 
rc
;

119 (*
fun˘i⁄
)(
d
, c⁄° 
iovec
 *
iov
, 
iov˙t
);

121 
	`socks_sysˇŒ_°¨t
(
d
);

122 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_EREADV
);

123 
rc
 = 
	`fun˘i⁄
(
d
, 
iov
, 
iov˙t
);

124 
	`socks_sysˇŒ_íd
(
d
);

125  
rc
;

126 
	}
}

129 
	$sys_Eªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

130 
s
;

131 *
buf
;

132 
size_t
 
Àn
;

133 
Êags
;

134 
sockaddr
 * 
‰om
;

135 
size_t
 *
‰omÀn
;

137 
rc
;

138 (*
fun˘i⁄
)(
s
, *
buf
, 
size_t
 
Àn
, 
Êags
,

139 
sockaddr
 *
‰om
, 
sockÀn_t
 *
‰omÀn
);

141 
	`socks_sysˇŒ_°¨t
(
s
);

142 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_ERECVFROM
);

143 
rc
 = 
	`fun˘i⁄
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

144 
	`socks_sysˇŒ_íd
(
s
);

145  
rc
;

146 
	}
}

148 
ssize_t


149 
	$sys_Eªcvmsg
(
s
, 
msg
, 
Êags
)

150 
s
;

151 
msghdr
 *
msg
;

152 
Êags
;

154 
ssize_t
 
rc
;

155 (*
fun˘i⁄
)(
s
, 
msghdr
 *
msg
, 
Êags
);

157 
	`socks_sysˇŒ_°¨t
(
s
);

158 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_ERECVMSG
);

159 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

160 
	`socks_sysˇŒ_íd
(
s
);

161  
rc
;

162 
	}
}

164 
ssize_t


165 
	$sys_E£ndmsg
(
s
, 
msg
, 
Êags
)

166 
s
;

167 c⁄° 
msghdr
 *
msg
;

168 
Êags
;

170 
ssize_t
 
rc
;

171 (*
fun˘i⁄
)(
s
, c⁄° 
msghdr
 *
msg
, 
Êags
);

173 
	`socks_sysˇŒ_°¨t
(
s
);

174 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_ESENDMSG
);

175 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

176 
	`socks_sysˇŒ_íd
(
s
);

177  
rc
;

178 
	}
}

180 
ssize_t


181 
	$sys_Ewrôev
(
d
, 
iov
, 
iov˙t
)

182 
d
;

183 c⁄° 
iovec
 *
iov
;

184 
iov˙t
;

186 
ssize_t
 
rc
;

187 (*
fun˘i⁄
)(
d
, c⁄° 
iovec
 *
buf
, 
iov˙t
);

189 
	`socks_sysˇŒ_°¨t
(
d
);

190 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_EWRITEV
);

191 
rc
 = 
	`fun˘i⁄
(
d
, 
iov
, 
iov˙t
);

192 
	`socks_sysˇŒ_íd
(
d
);

193  
rc
;

194 
	}
}

201 
	$_Eac˚±
(
s
, 
addr
, 
addæí
)

202 
s
;

203 
sockaddr
 * 
addr
;

204 
sockÀn_t
 *
addæí
;

206 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL__EACCEPT
))

207  
	`sys_Eac˚±
(
s
, 
addr
, 
addæí
);

208  
	`Rac˚±
(
s
, 
addr
, 
addæí
);

209 
	}
}

212 
	$_Egë≥î«me
(
s
, 
«me
, 
«mñí
)

213 
s
;

214 
sockaddr
 * 
«me
;

215 
sockÀn_t
 *
«mñí
;

217 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL__EGETPEERNAME
))

218  
	`sys_Egë≥î«me
(
s
, 
«me
, 
«mñí
);

219  
	`Rgë≥î«me
(
s
, 
«me
, 
«mñí
);

220 
	}
}

223 
	$_Egësock«me
(
s
, 
«me
, 
«mñí
)

224 
s
;

225 
sockaddr
 * 
«me
;

226 
sockÀn_t
 *
«mñí
;

228 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL__EGETSOCKNAME
))

229  
	`sys_Egësock«me
(
s
, 
«me
, 
«mñí
);

230  
	`Rgësock«me
(
s
, 
«me
, 
«mñí
);

231 
	}
}

233 
ssize_t


234 
	$_Eªadv
(
d
, 
iov
, 
iov˙t
)

235 
d
;

236 c⁄° 
iovec
 *
iov
;

237 
iov˙t
;

239 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL__EREADV
))

240  
	`sys_Eªadv
(
d
, 
iov
, 
iov˙t
);

241  
	`Rªadv
(
d
, 
iov
, 
iov˙t
);

242 
	}
}

244 
ssize_t


245 
	$_Eªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

246 
s
;

247 *
buf
;

248 
size_t
 
Àn
;

249 
Êags
;

250 
sockaddr
 * 
‰om
;

251 
size_t
 *
‰omÀn
;

253 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL__ERECVFROM
))

254  
	`sys_Eªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

255  
	`Rªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

256 
	}
}

258 
ssize_t


259 
	$_Eªcvmsg
(
s
, 
msg
, 
Êags
)

260 
s
;

261 
msghdr
 *
msg
;

262 
Êags
;

264 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL__ERECVMSG
))

265  
	`sys_Eªcvmsg
(
s
, 
msg
, 
Êags
);

266  
	`Rªcvmsg
(
s
, 
msg
, 
Êags
);

267 
	}
}

269 
ssize_t


270 
	$_Ewrôev
(
d
, 
iov
, 
iov˙t
)

271 
d
;

272 c⁄° 
iovec
 *
iov
;

273 
iov˙t
;

275 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL__EWRITEV
))

276  
	`sys_Ewrôev
(
d
, 
iov
, 
iov˙t
);

277  
	`Rwrôev
(
d
, 
iov
, 
iov˙t
);

278 
	}
}

280 
ssize_t


281 
	$_E£ndmsg
(
s
, 
msg
, 
Êags
)

282 
s
;

283 c⁄° 
msghdr
 *
msg
;

284 
Êags
;

286 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL__ESENDMSG
))

287  
	`sys_E£ndmsg
(
s
, 
msg
, 
Êags
);

288  
	`R£ndmsg
(
s
, 
msg
, 
Êags
);

289 
	}
}

	@dlib/int_osf2.c

44 
	~"comm⁄.h
"

46 #i‡
HAVE_EXTRA_OSF_SYMBOLS


48 #i‡
SOCKSLIBRARY_DYNAMIC


50 c⁄° 
	grcsid
[] =

53 #unde‡
ac˚±


54 #unde‡
gë≥î«me


55 #unde‡
gësock«me


56 #unde‡
ªcv‰om


57 #unde‡
ªcvmsg


58 #unde‡
£ndmsg


63 
	$sys_«c˚±
(
s
, 
addr
, 
addæí
)

64 
s
;

65 
sockaddr
 *
addr
;

66 
sockÀn_t
 *
addæí
;

68 
rc
;

69 (*
fun˘i⁄
)(
s
, 
sockaddr
 *
addr
, 
sockÀn_t
 *
addæí
);

71 
	`socks_sysˇŒ_°¨t
(
s
);

72 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_NACCEPT
);

73 
rc
 = 
	`fun˘i⁄
(
s
, 
addr
, 
addæí
);

74 
	`socks_sysˇŒ_íd
(
s
);

75  
rc
;

76 
	}
}

79 
	$sys_ngë≥î«me
(
s
, 
«me
, 
«mñí
)

80 
s
;

81 
sockaddr
 *
«me
;

82 
sockÀn_t
 *
«mñí
;

84 
rc
;

85 (*
fun˘i⁄
)(
s
, c⁄° 
sockaddr
 *
«me
, 
sockÀn_t
 *
«mñí
);

87 
	`socks_sysˇŒ_°¨t
(
s
);

88 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_NGETPEERNAME
);

89 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

90 
	`socks_sysˇŒ_íd
(
s
);

91  
rc
;

92 
	}
}

95 
	$sys_ngësock«me
(
s
, 
«me
, 
«mñí
)

96 
s
;

97 
sockaddr
 *
«me
;

98 
sockÀn_t
 *
«mñí
;

100 
rc
;

101 (*
fun˘i⁄
)(
s
, c⁄° 
sockaddr
 *
«me
, 
sockÀn_t
 *
«mñí
);

103 
	`socks_sysˇŒ_°¨t
(
s
);

104 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_NGETSOCKNAME
);

105 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

106 
	`socks_sysˇŒ_íd
(
s
);

107  
rc
;

108 
	}
}

111 
	$sys_ƒecv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

112 
s
;

113 *
buf
;

114 
size_t
 
Àn
;

115 
Êags
;

116 
sockaddr
 *
‰om
;

117 
size_t
 *
‰omÀn
;

119 
rc
;

120 (*
fun˘i⁄
)(
s
, *
buf
, 
size_t
 
Àn
, 
Êags
,

121 
sockaddr
 *
‰om
, 
sockÀn_t
 *
‰omÀn
);

123 
	`socks_sysˇŒ_°¨t
(
s
);

124 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_NRECVFROM
);

125 
rc
 = 
	`fun˘i⁄
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

126 
	`socks_sysˇŒ_íd
(
s
);

127  
rc
;

128 
	}
}

130 
ssize_t


131 
	$sys_ƒecvmsg
(
s
, 
msg
, 
Êags
)

132 
s
;

133 
msghdr
 *
msg
;

134 
Êags
;

136 
ssize_t
 
rc
;

137 (*
fun˘i⁄
)(
s
, 
msghdr
 *
msg
, 
Êags
);

139 
	`socks_sysˇŒ_°¨t
(
s
);

140 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_NRECVMSG
);

141 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

142 
	`socks_sysˇŒ_íd
(
s
);

143  
rc
;

144 
	}
}

146 
ssize_t


147 
	$sys_n£ndmsg
(
s
, 
msg
, 
Êags
)

148 
s
;

149 c⁄° 
msghdr
 *
msg
;

150 
Êags
;

152 
ssize_t
 
rc
;

153 (*
fun˘i⁄
)(
s
, c⁄° 
msghdr
 *
msg
, 
Êags
);

155 
	`socks_sysˇŒ_°¨t
(
s
);

156 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_NSENDMSG
);

157 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

158 
	`socks_sysˇŒ_íd
(
s
);

159  
rc
;

160 
	}
}

167 
	$«c˚±
(
s
, 
addr
, 
addæí
)

168 
s
;

169 
sockaddr
 *
addr
;

170 
sockÀn_t
 *
addæí
;

172 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_NACCEPT
))

173  
	`sys_«c˚±
(
s
, 
addr
, 
addæí
);

174  
	`Rac˚±
(
s
, 
addr
, 
addæí
);

175 
	}
}

177 
	$ngë≥î«me
(
s
, 
«me
, 
«mñí
)

178 
s
;

179 
sockaddr
 *
«me
;

180 
sockÀn_t
 *
«mñí
;

182 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_NGETPEERNAME
))

183  
	`sys_ngë≥î«me
(
s
, 
«me
, 
«mñí
);

184  
	`Rgë≥î«me
(
s
, 
«me
, 
«mñí
);

185 
	}
}

188 
	$ngësock«me
(
s
, 
«me
, 
«mñí
)

189 
s
;

190 
sockaddr
 *
«me
;

191 
sockÀn_t
 *
«mñí
;

193 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_NGETSOCKNAME
))

194  
	`sys_ngë≥î«me
(
s
, 
«me
, 
«mñí
);

195  
	`Rgësock«me
(
s
, 
«me
, 
«mñí
);

196 
	}
}

198 
ssize_t


199 
	$ƒecv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

200 
s
;

201 *
buf
;

202 
size_t
 
Àn
;

203 
Êags
;

204 
sockaddr
 *
‰om
;

205 
size_t
 *
‰omÀn
;

207 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_NRECVFROM
))

208  
	`sys_ƒecv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

209  
	`Rªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

210 
	}
}

212 
ssize_t


213 
	$ƒecvmsg
(
s
, 
msg
, 
Êags
)

214 
s
;

215 
msghdr
 *
msg
;

216 
Êags
;

218 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_NRECVMSG
))

219  
	`sys_ƒecvmsg
(
s
, 
msg
, 
Êags
);

220  
	`Rªcvmsg
(
s
, 
msg
, 
Êags
);

221 
	}
}

223 
ssize_t


224 
	$n£ndmsg
(
s
, 
msg
, 
Êags
)

225 
s
;

226 c⁄° 
msghdr
 *
msg
;

227 
Êags
;

229 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_NSENDMSG
))

230  
	`sys_n£ndmsg
(
s
, 
msg
, 
Êags
);

231  
	`R£ndmsg
(
s
, 
msg
, 
Êags
);

232 
	}
}

	@dlib/int_osf3.c

44 
	~"autoc⁄f.h
"

46 #i‡
HAVE_EXTRA_OSF_SYMBOLS


48 #i‡
SOCKSLIBRARY_DYNAMIC


50 #unde‡
_XOPEN_SOURCE_EXTENDED


51 #unde‡
_SOCKADDR_LEN


52 
	#HAVE_OSF_OLDSTYLE
 1

	)

58 
	#bzîo
(
a
, 
b
Ë(
	`mem£t
◊, 0, b))

	)

60 
	#SOCKS_DLIB_OSF


	)

63 
	#ªadv
 
XXX


	)

64 
	#wrôev
 
XXX


	)

66 
	~"comm⁄.h
"

68 c⁄° 
	grcsid
[] =

71 #unde‡
ac˚±


72 #unde‡
böd


73 #unde‡
gë≥î«me


74 #unde‡
gësock«me


75 #unde‡
ªcv‰om


76 #unde‡
ªcvmsg


77 #unde‡
£ndmsg


78 #unde‡
c⁄√˘


79 #unde‡
ªadv


80 #unde‡
wrôev


81 #unde‡
£ndto


88 
	sn_sockaddr
 {

89 
	mß_Àn
;

90 
ß_Ámûy_t
 
	mß_Ámûy
;

91 
	mß_d©a
[14];

94 
	sn_msghdr
 {

95 *
	mmsg_«me
;

96 
size_t
 
	mmsg_«mñí
;

97 
iovec
 *
	mmsg_iov
;

98 
	mmsg_iovÀn
;

99 *
	mmsg_c⁄åﬁ
;

100 
size_t
 
	mmsg_c⁄åﬁÀn
;

101 
	mmsg_Êags
;

104 
ssize_t
 
R£ndto
(, c⁄° *, 
size_t
, ,

105 c⁄° 
n_sockaddr
 *, 
sockÀn_t
);

106 
Rc⁄√˘
(, c⁄° 
n_sockaddr
 *, 
sockÀn_t
);

107 
ssize_t
 
R£ndmsg
(, c⁄° 
n_msghdr
 *, );

108 
ssize_t
 
Rªcv‰om
(, *, , , 
n_sockaddr
 *, 
sockÀn_t
 *);

109 
Rgësock«me
(, 
n_sockaddr
 *, 
sockÀn_t
 *);

110 
Rgë≥î«me
(, 
n_sockaddr
 *, 
sockÀn_t
 *);

111 
Rac˚±
(, 
n_sockaddr
 *, 
sockÀn_t
 *);

112 
ssize_t
 
Rªcvmsg
(
s
, 
n_msghdr
 *
msg
, 
Êags
);

113 
Rböd
(, c⁄° 
n_sockaddr
 *, 
sockÀn_t
);

119 
	$sys_ac˚±
(
s
, 
addr
, 
addæí
)

120 
s
;

121 
sockaddr
 *
addr
;

122 *
addæí
;

124 
rc
;

125 (*
fun˘i⁄
)(
s
, 
sockaddr
 * 
addr
, 
sockÀn_t
 *
addæí
);

127 
	`socks_sysˇŒ_°¨t
(
s
);

128 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_ACCEPT
);

129 
rc
 = 
	`fun˘i⁄
(
s
, 
addr
, (
sockÀn_t
 *Ë
addæí
);

130 
	`socks_sysˇŒ_íd
(
s
);

131  
rc
;

132 
	}
}

135 
	$sys_gë≥î«me
(
s
, 
«me
, 
«mñí
)

136 
s
;

137 
sockaddr
 *
«me
;

138 *
«mñí
;

140 
rc
;

141 (*
fun˘i⁄
)(
s
, c⁄° 
sockaddr
 *
«me
, 
sockÀn_t
 *
«mñí
);

143 
	`socks_sysˇŒ_°¨t
(
s
);

144 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_GETPEERNAME
);

145 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, (
sockÀn_t
 *Ë
«mñí
);

146 
	`socks_sysˇŒ_íd
(
s
);

147  
rc
;

148 
	}
}

151 
	$sys_gësock«me
(
s
, 
«me
, 
«mñí
)

152 
s
;

153 
sockaddr
 *
«me
;

154 *
«mñí
;

156 
rc
;

157 (*
fun˘i⁄
)(
s
, c⁄° 
sockaddr
 *
«me
, 
sockÀn_t
 *
«mñí
);

159 
	`socks_sysˇŒ_°¨t
(
s
);

160 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_GETSOCKNAME
);

161 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, (
sockÀn_t
 *Ë
«mñí
);

162 
	`socks_sysˇŒ_íd
(
s
);

163  
rc
;

164 
	}
}

167 
	$sys_ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

168 
s
;

169 *
buf
;

170 
Àn
;

171 
Êags
;

172 
sockaddr
 *
‰om
;

173 *
‰omÀn
;

175 
rc
;

176 (*
fun˘i⁄
)(
s
, *
buf
, 
size_t
 
Àn
, 
Êags
,

177 
sockaddr
 *
‰om
, 
sockÀn_t
 *
‰omÀn
);

179 
	`socks_sysˇŒ_°¨t
(
s
);

180 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_RECVFROM
);

181 
rc
 = 
	`fun˘i⁄
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, (
sockÀn_t
 *Ë
‰omÀn
);

182 
	`socks_sysˇŒ_íd
(
s
);

183  
rc
;

184 
	}
}

186 
ssize_t


187 
	$sys_ªcvmsg
(
s
, 
msg
, 
Êags
)

188 
s
;

189 
msghdr
 *
msg
;

190 
Êags
;

192 
ssize_t
 
rc
;

193 (*
fun˘i⁄
)(
s
, 
msghdr
 *
msg
, 
Êags
);

195 
	`socks_sysˇŒ_°¨t
(
s
);

196 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_RECVMSG
);

197 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

198 
	`socks_sysˇŒ_íd
(
s
);

199  
rc
;

200 
	}
}

202 
ssize_t


203 
	$sys_£ndmsg
(
s
, 
msg
, 
Êags
)

204 
s
;

205 
msghdr
 *
msg
;

206 
Êags
;

208 
ssize_t
 
rc
;

209 (*
fun˘i⁄
)(
s
, c⁄° 
msghdr
 *
msg
, 
Êags
);

211 
	`socks_sysˇŒ_°¨t
(
s
);

212 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_SENDMSG
);

213 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

214 
	`socks_sysˇŒ_íd
(
s
);

215  
rc
;

216 
	}
}

218 
ssize_t


219 
	$sys_ªadv
(
d
, 
iov
, 
iov˙t
)

220 
d
;

221 c⁄° 
iovec
 *
iov
;

222 
iov˙t
;

224 
ssize_t
 
rc
;

225 (*
fun˘i⁄
)(
d
, c⁄° 
iovec
 *
iov
, 
iov˙t
);

227 
	`socks_sysˇŒ_°¨t
(
d
);

228 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_READV
);

229 
rc
 = 
	`fun˘i⁄
(
d
, 
iov
, 
iov˙t
);

230 
	`socks_sysˇŒ_íd
(
d
);

231  
rc
;

232 
	}
}

234 
ssize_t


235 
	$sys_wrôev
(
d
, 
iov
, 
iov˙t
)

236 
d
;

237 c⁄° 
iovec
 *
iov
;

238 
iov˙t
;

240 
ssize_t
 
rc
;

241 (*
fun˘i⁄
)(
d
, c⁄° 
iovec
 *
buf
, 
iov˙t
);

243 
	`socks_sysˇŒ_°¨t
(
d
);

244 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_WRITEV
);

245 
rc
 = 
	`fun˘i⁄
(
d
, 
iov
, 
iov˙t
);

246 
	`socks_sysˇŒ_íd
(
d
);

247  
rc
;

248 
	}
}

251 
	$sys_c⁄√˘
(
s
, 
«me
, 
«mñí
)

252 
s
;

253 c⁄° 
sockaddr
 *
«me
;

254 
«mñí
;

256 
rc
;

257 (*
fun˘i⁄
)(
s
, c⁄° 
sockaddr
 *
«me
, 
sockÀn_t
 
«mñí
);

259 
	`socks_sysˇŒ_°¨t
(
s
);

260 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_CONNECT
);

261 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

262 
	`socks_sysˇŒ_íd
(
s
);

263  
rc
;

264 
	}
}

267 
	$sys_böd
(
s
, 
«me
, 
«mñí
)

268 
s
;

269 c⁄° 
sockaddr
 *
«me
;

270 
«mñí
;

272 
rc
;

273 (*
fun˘i⁄
)(
s
, c⁄° 
sockaddr
 *
«me
, 
sockÀn_t
 
«mñí
);

275 
	`socks_sysˇŒ_°¨t
(
s
);

276 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_BIND
);

277 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

278 
	`socks_sysˇŒ_íd
(
s
);

279  
rc
;

280 
	}
}

283 
	$sys_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

284 
s
;

285 c⁄° *
msg
;

286 
Àn
;

287 
Êags
;

288 c⁄° 
sockaddr
 *
to
;

289 
sockÀn_t
 
tﬁí
;

291 
ssize_t
 
rc
;

292 (*
fun˘i⁄
)(
s
, c⁄° *
msg
, 
size_t
 
Àn
, 
Êags
,

293 c⁄° 
sockaddr
 *
to
, 
sockÀn_t
 
tﬁí
);

295 
	`socks_sysˇŒ_°¨t
(
s
);

296 
fun˘i⁄
 = 
	`symbﬁfun˘i⁄
(
SYMBOL_SENDTO
);

297 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

298 
	`socks_sysˇŒ_íd
(
s
);

299  
rc
;

300 
	}
}

307 
	#ADDRLEN_SET
(
a
,
b
Ë((◊Ë=
NULL
Ë? 0 : (b))

	)

310 
	#SOCKADDR_COPYRES
(
a
,
b
,
c
,
d
) \

311 dÿ{ i‡(((
c
Ë!
NULL
Ë&& (*(
d
Ë> 0Ë&& (*(
b
) > 0)) { \

312 
n_sockaddr
 
n
 = *(
a
); \

313 
tm∂í
 = *(
d
); \

315 i‡(
tm∂í
 >(
n
.
ß_Ámûy
)) \

316 (
c
)->
ß_Ámûy
 = ()
n
.sa_family; \

317 
tm∂í
 -((
c
)->
ß_Ámûy
); \

318 
tm∂í
 = 
	`MAX
(0,Åmplen); \

319 
	`mem˝y
((
c
)->
ß_d©a
, 
n
.ß_d©a, (
size_t
)
tm∂í
); \

320 *(
d
Ë
	`MIN
(*d, (
sockaddr
)); \

322 }  0)

	)

325 
	#SOCKADDR_COPYPARAM
(
a
,
b
,
c
,
d
) \

326 dÿ{ i‡(((
a
Ë!
NULL
Ë&& (*(
b
) > 0)) { \

327 
n_sockaddr
 
n
; \

328 
tm∂í
 = *(
b
); \

330 
	`bzîo
((*)&
n
, (n)); \

332 i‡(
tm∂í
 >= ()) \

333 
n
.
ß_Ámûy
 = (
ß_Ámûy_t
)(
a
)->sa_family; \

334 
tm∂í
 -(
n
.
ß_Ámûy
); \

335 
tm∂í
 = 
	`MAX
(0,Åmplen); \

336 
	`mem˝y
(
n
.
ß_d©a
, (
a
)->ß_d©a, (
size_t
)
tm∂í
); \

337 *(
d
Ë(
n
); \

338 *
c
 = 
n
; \

340 *(
d
Ë*(
b
); \

342 }  0)

	)

345 
	$ac˚±
(
s
, 
addr
, 
addæí
)

346 
s
;

347 
sockaddr
 *
addr
;

348 *
addæí
;

350 
n_sockaddr
 
n_addr
;

351 
sockÀn_t
 
n_addæí
;

352 
rc
;

354 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_ACCEPT
))

355  
	`sys_ac˚±
(
s
, 
addr
, 
addæí
);

357 
n_addæí
 = 
	`ADDRLEN_SET
(
addr
, (
n_addr
));

359 
rc
 = 
	`Rac˚±
(
s
, &
n_addr
, &
n_addæí
);

361 i‡(
rc
 != -1)

362 
	`SOCKADDR_COPYRES
(&
n_addr
, &
n_addæí
, 
addr
, 
addæí
);

364  
rc
;

365 
	}
}

368 
	$gë≥î«me
(
s
, 
«me
, 
«mñí
)

369 
s
;

370 
sockaddr
 *
«me
;

371 *
«mñí
;

373 
n_sockaddr
 
n_«me
;

374 
sockÀn_t
 
n_«mñí
;

375 
rc
;

377 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_GETPEERNAME
))

378  
	`sys_gë≥î«me
(
s
, 
«me
, 
«mñí
);

380 
n_«mñí
 = 
	`ADDRLEN_SET
(
«me
, (
n_«me
));

382 
rc
 = 
	`Rgë≥î«me
(
s
, &
n_«me
, &
n_«mñí
);

384 i‡(
rc
 != -1)

385 
	`SOCKADDR_COPYRES
(&
n_«me
, &
n_«mñí
, 
«me
, 
«mñí
);

387  
rc
;

388 
	}
}

391 
	$gësock«me
(
s
, 
«me
, 
«mñí
)

392 
s
;

393 
sockaddr
 *
«me
;

394 *
«mñí
;

396 
n_sockaddr
 
n_«me
;

397 
sockÀn_t
 
n_«mñí
;

398 
rc
;

400 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_GETSOCKNAME
))

401  
	`sys_gësock«me
(
s
, 
«me
, 
«mñí
);

403 
n_«mñí
 = 
	`ADDRLEN_SET
(
«me
, (
n_«me
));

405 
rc
 = 
	`Rgësock«me
(
s
, &
n_«me
, &
n_«mñí
);

407 i‡(
rc
 != -1)

408 
	`SOCKADDR_COPYRES
(&
n_«me
, &
n_«mñí
, 
«me
, 
«mñí
);

410  
rc
;

411 
	}
}

414 
	$ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

415 
s
;

416 *
buf
;

417 
Àn
;

418 
Êags
;

419 
sockaddr
 *
‰om
;

420 *
‰omÀn
;

422 
n_sockaddr
 
n_‰om
;

423 
sockÀn_t
 
n_‰omÀn
;

424 
ssize_t
 
rc
;

426 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_RECVFROM
))

427  
	`sys_ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

429 
n_‰omÀn
 = 
	`ADDRLEN_SET
(
‰om
, (
n_‰om
));

431 
rc
 = 
	`Rªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, (
n_sockaddr
 *)&
n_‰om
, &
n_‰omÀn
);

433 i‡(
rc
 != -1)

434 
	`SOCKADDR_COPYRES
(&
n_‰om
, &
n_‰omÀn
, 
‰om
, 
‰omÀn
);

436  
rc
;

437 
	}
}

440 
	$ªcvmsg
(
s
, 
msg
, 
Êags
)

441 
s
;

442 
msghdr
 *
msg
;

443 
Êags
;

445 
n_msghdr
 
n_msg
;

446 
ssize_t
 
rc
;

448 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_RECVMSG
))

449  
	`sys_ªcvmsg
(
s
, 
msg
, 
Êags
);

451 
	`bzîo
((*)&
n_msg
, (
n_msghdr
));

452 
n_msg
.
msg_«me
 = 
msg
->msg_name;

453 
n_msg
.
msg_«mñí
 = 
msg
->msg_namelen;

454 
n_msg
.
msg_iov
 = 
msg
->msg_iov;

455 
n_msg
.
msg_iovÀn
 = 
msg
->msg_iovlen;

458 
rc
 = 
	`Rªcvmsg
(
s
, &
n_msg
, 
Êags
);

460 i‡(
rc
 != -1) {

461 
msg
->
msg_«me
 = 
n_msg
.msg_name;

462 
msg
->
msg_«mñí
 = 
n_msg
.msg_namelen;

463 
msg
->
msg_iov
 = 
n_msg
.msg_iov;

464 
msg
->
msg_iovÀn
 = 
n_msg
.msg_iovlen;

466 i‡(
n_msg
.
msg_c⁄åﬁÀn
 != 0)

467 
	`sw¨n
("msg_accrights/controllen conversionÇot supported");

470  
rc
;

471 
	}
}

474 
	$£ndmsg
(
s
, 
msg
, 
Êags
)

475 
s
;

476 
msghdr
 *
msg
;

477 
Êags
;

479 
n_msghdr
 
n_msg
;

480 
ssize_t
 
rc
;

482 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_SENDMSG
))

483  
	`sys_£ndmsg
(
s
, 
msg
, 
Êags
);

485 
	`bzîo
((*)&
n_msg
, (
n_msghdr
));

486 
n_msg
.
msg_«me
 = 
msg
->msg_name;

487 
n_msg
.
msg_«mñí
 = 
msg
->msg_namelen;

488 
n_msg
.
msg_iov
 = 
msg
->msg_iov;

489 
n_msg
.
msg_iovÀn
 = 
msg
->msg_iovlen;

491 i‡(
msg
->
msg_ac¸ight¶í
 != 0)

492 
	`sw¨n
("warning: msg_accrights/controllen conversionÇot supported");

495 
rc
 = 
	`R£ndmsg
(
s
, (
n_msghdr
 *)&
n_msg
, 
Êags
);

497 i‡(
rc
 != -1) {

498 
msg
->
msg_«me
 = 
n_msg
.msg_name;

499 
msg
->
msg_«mñí
 = 
n_msg
.msg_namelen;

500 
msg
->
msg_iov
 = 
n_msg
.msg_iov;

501 
msg
->
msg_iovÀn
 = 
n_msg
.msg_iovlen;

505  
rc
;

506 
	}
}

509 
	$c⁄√˘
(
s
, 
«me
, 
«mñí
)

510 
s
;

511 c⁄° 
sockaddr
 *
«me
;

512 
«mñí
;

514 
n_sockaddr
 
n_«me
;

515 
n_«mñí
;

517 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_CONNECT
))

518  
	`sys_c⁄√˘
(
s
, 
«me
, 
«mñí
);

520 
	`SOCKADDR_COPYPARAM
(
«me
, &
«mñí
, &
n_«me
, &
n_«mñí
);

522  
	`Rc⁄√˘
(
s
, &
n_«me
, 
n_«mñí
);

523 
	}
}

526 
	$böd
(
s
, 
«me
, 
«mñí
)

527 
s
;

528 c⁄° 
sockaddr
 *
«me
;

529 
«mñí
;

531 
n_sockaddr
 
n_«me
;

532 
n_«mñí
;

534 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_BIND
))

535  
	`sys_böd
(
s
, 
«me
, 
«mñí
);

537 
	`SOCKADDR_COPYPARAM
(
«me
, &
«mñí
, &
n_«me
, &
n_«mñí
);

539  
	`Rböd
(
s
, &
n_«me
, 
n_«mñí
);

540 
	}
}

543 
	$£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

544 
s
;

545 c⁄° *
msg
;

546 
Àn
;

547 
Êags
;

548 c⁄° 
sockaddr
 *
to
;

549 
tﬁí
;

551 
n_sockaddr
 
n_to
;

552 
n_tﬁí
;

554 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_SENDTO
))

555  
	`sys_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

557 
	`SOCKADDR_COPYPARAM
(
to
, &
tﬁí
, &
n_to
, &
n_tﬁí
);

559  
	`R£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, &
n_to
, 
n_tﬁí
);

560 
	}
}

562 
ssize_t


563 
	$wrôev
(
d
, 
iov
, 
iov˙t
)

564 
d
;

565 c⁄° 
iovec
 *
iov
;

566 
iov˙t
;

568 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_WRITEV
))

569  
	`sys_wrôev
(
d
, 
iov
, 
iov˙t
);

571  
	`Rwrôev
(
d
, 
iov
, 
iov˙t
);

572 
	}
}

574 
ssize_t


575 
	$ªadv
(
d
, 
iov
, 
iov˙t
)

576 
d
;

577 c⁄° 
iovec
 *
iov
;

578 
iov˙t
;

580 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_READV
))

581  
	`sys_ªadv
(
d
, 
iov
, 
iov˙t
);

583  
	`Rªadv
(
d
, 
iov
, 
iov˙t
);

584 
	}
}

	@dlib/interposition.c

45 
	#_NO_SUN_PRAGMA


	)

47 
	~"comm⁄.h
"

49 c⁄° 
	grcsid
[] =

52 #i‡
SOCKSLIBRARY_DYNAMIC


54 #i‡(
deföed
 
__sun
Ë&& (deföed 
_XPG4_2
)

56 
HAVE_PROT_BIND_0


57 
böd
(
HAVE_PROT_BIND_1
, 
HAVE_PROT_BIND_2
, 
HAVE_PROT_BIND_3
);

59 
HAVE_PROT_CONNECT_0


60 
c⁄√˘
(
HAVE_PROT_CONNECT_1
, 
HAVE_PROT_CONNECT_2
, 
HAVE_PROT_CONNECT_3
);

62 
HAVE_PROT_LISTEN_0


63 
li°í
(
HAVE_PROT_LISTEN_1
, 
HAVE_PROT_LISTEN_2
);

65 
HAVE_PROT_RECVMSG_0


66 
ªcvmsg
(
HAVE_PROT_RECVMSG_1
, 
HAVE_PROT_RECVMSG_2
, 
HAVE_PROT_RECVMSG_3
);

68 
HAVE_PROT_SENDMSG_0


69 
£ndmsg
(
HAVE_PROT_SENDMSG_1
, 
HAVE_PROT_SENDMSG_2
, 
HAVE_PROT_SENDMSG_3
);

71 
HAVE_PROT_SENDTO_0


72 
£ndto
(
HAVE_PROT_SENDTO_1
, 
HAVE_PROT_SENDTO_2
, 
HAVE_PROT_SENDTO_3
,

73 
HAVE_PROT_SENDTO_4
, 
HAVE_PROT_SENDTO_5
, 
HAVE_PROT_SENDTO_6
);

77 #i‡
HAVE_DARWIN


79 
HAVE_PROT_CONNECT_0


80 
c⁄√˘$NOCANCEL
(
HAVE_PROT_CONNECT_1
, 
HAVE_PROT_CONNECT_2
,

81 
HAVE_PROT_CONNECT_3
);

82 
HAVE_PROT_READ_0


83 
ªad$NOCANCEL
(
HAVE_PROT_READ_1
, 
HAVE_PROT_READ_2
, 
HAVE_PROT_READ_3
);

84 
HAVE_PROT_RECVFROM_0


85 
ªcv‰om$NOCANCEL
(
HAVE_PROT_RECVFROM_1
, 
HAVE_PROT_RECVFROM_2
,

86 
HAVE_PROT_RECVFROM_3
, 
HAVE_PROT_RECVFROM_4
,

87 
HAVE_PROT_RECVFROM_5
, 
HAVE_PROT_RECVFROM_6
);

88 
HAVE_PROT_SENDTO_0


89 
£ndto$NOCANCEL
(
HAVE_PROT_SENDTO_1
, 
HAVE_PROT_SENDTO_2
, 
HAVE_PROT_SENDTO_3
,

90 
HAVE_PROT_SENDTO_4
, 
HAVE_PROT_SENDTO_5
, 
HAVE_PROT_SENDTO_6
);

91 
HAVE_PROT_WRITE_0


92 
wrôe$NOCANCEL
(
HAVE_PROT_WRITE_1
, 
HAVE_PROT_WRITE_2
, 
HAVE_PROT_WRITE_3
);

96 #i‚de‡
__USE_GNU


97 
	#__USE_GNU


	)

99 
	~<dlf˙.h
>

101 #ifde‡
__COVERITY__


109 #unde‡
sys_ac˚±


110 #unde‡
sys_böd


111 #unde‡
sys_bödªsvp‹t


112 #unde‡
sys_c⁄√˘


113 #unde‡
sys_gëho°by«me


114 #unde‡
sys_gëho°by«me2
 
gëho°by«me2


115 #unde‡
sys_gëaddröfo


116 #unde‡
sys_gë«meöfo


117 #unde‡
sys_gëùnodeby«me


118 #unde‡
sys_gë≥î«me


119 #unde‡
sys_gësock«me


120 #unde‡
sys_gësock›t


121 #unde‡
sys_li°í


122 #unde‡
sys_ªad


123 #unde‡
sys_ªadv


124 #unde‡
sys_ªcv


125 #unde‡
sys_ªcv‰om


126 #unde‡
sys_ªcv‰om


127 #unde‡
sys_ªcvmsg


128 #unde‡
sys_ºesvp‹t


129 #unde‡
sys_£nd


130 #unde‡
sys_£ndmsg


131 #unde‡
sys_£ndto


132 #unde‡
sys_wrôe


133 #unde‡
sys_wrôev


136 #unde‡
ac˚±


137 #unde‡
böd


138 #unde‡
bödªsvp‹t


139 #unde‡
c⁄√˘


140 #unde‡
gëho°byaddr


141 #unde‡
gëho°by«me


142 #unde‡
gëho°by«me2


143 #unde‡
gëaddröfo


144 #unde‡
gëùnodeby«me


145 #unde‡
‰ìho°ít


146 #unde‡
gë≥î«me


147 #unde‡
gësock«me


148 #unde‡
gësock›t


149 #unde‡
li°í


150 #unde‡
ªad


151 #unde‡
ªadv


152 #unde‡
ªcv


153 #unde‡
ªcv‰om


154 #unde‡
ªcvmsg


155 #unde‡
ºesvp‹t


156 #unde‡
£nd


157 #unde‡
£ndmsg


158 #unde‡
£ndto


159 #unde‡
wrôe


160 #unde‡
wrôev


161 #i‡
HAVE_GSSAPI
 && 
HAVE_LINUX_GLIBC_WORKAROUND


162 #unde‡
gëc


163 #unde‡
fgëc


164 #unde‡
gës


165 #unde‡
fgës


166 #unde‡
putc


167 #unde‡
Âutc


168 #unde‡
puts


169 #unde‡
Âuts


170 #unde‡
¥ötf


171 #unde‡
v¥ötf


172 #unde‡
Ârötf


173 #unde‡
vÂrötf


174 #unde‡
fwrôe


175 #unde‡
‰ód


176 #unde‡
fÊush


177 #unde‡
f˛o£


179 #i‡
HAVE__IO_GETC


180 #unde‡
_IO_gëc


182 #i‡
HAVE__IO_PUTC


183 #unde‡
_IO_putc


185 #i‡
HAVE___FPRINTF_CHK


186 #unde‡
__Ârötf_chk


188 #i‡
HAVE___VFPRINTF_CHK


189 #unde‡
__vÂrötf_chk


191 #i‡
HAVE___READ_CHK


192 #unde‡
__ªad_chk


196 
libsymbﬁ_t
 
	glibsymbﬁv
[] = {

197 #i‡
SOCKS_CLIENT


198 { 
SYMBOL_ACCEPT
, 
LIBRARY_ACCEPT
, 
NULL
, NULL, NULL },

199 { 
SYMBOL_BIND
, 
LIBRARY_BIND
, 
NULL
, NULL, NULL },

200 { 
SYMBOL_BINDRESVPORT
, 
LIBRARY_BINDRESVPORT
, 
NULL
, NULL, NULL },

201 { 
SYMBOL_CONNECT
, 
LIBRARY_CONNECT
, 
NULL
, NULL, NULL },

202 { 
SYMBOL_GETPEERNAME
, 
LIBRARY_GETPEERNAME
, 
NULL
, NULL, NULL },

203 { 
SYMBOL_GETSOCKNAME
, 
LIBRARY_GETSOCKNAME
, 
NULL
, NULL, NULL },

204 { 
SYMBOL_GETSOCKOPT
, 
LIBRARY_GETSOCKOPT
, 
NULL
, NULL, NULL },

205 { 
SYMBOL_LISTEN
, 
LIBRARY_LISTEN
, 
NULL
, NULL, NULL },

206 { 
SYMBOL_READ
, 
LIBRARY_READ
, 
NULL
, NULL, NULL },

207 { 
SYMBOL_READV
, 
LIBRARY_READV
, 
NULL
, NULL, NULL },

208 { 
SYMBOL_RECV
, 
LIBRARY_RECV
, 
NULL
, NULL, NULL },

209 { 
SYMBOL_RECVMSG
, 
LIBRARY_RECVMSG
, 
NULL
, NULL, NULL },

210 { 
SYMBOL_RECVFROM
, 
LIBRARY_RECVFROM
, 
NULL
, NULL, NULL },

212 #i‡
HAVE_RRESVPORT


213 { 
SYMBOL_RRESVPORT
, 
LIBRARY_RRESVPORT
, 
NULL
, NULL, NULL },

216 { 
SYMBOL_SEND
, 
LIBRARY_SEND
, 
NULL
, NULL, NULL },

217 { 
SYMBOL_SENDMSG
, 
LIBRARY_SENDMSG
, 
NULL
, NULL, NULL },

218 { 
SYMBOL_SENDTO
, 
LIBRARY_SENDTO
, 
NULL
, NULL, NULL },

219 { 
SYMBOL_WRITE
, 
LIBRARY_WRITE
, 
NULL
, NULL, NULL },

220 { 
SYMBOL_WRITEV
, 
LIBRARY_WRITEV
, 
NULL
, NULL, NULL },

222 { 
SYMBOL_GETHOSTBYNAME
, 
LIBRARY_GETHOSTBYNAME
, 
NULL
, NULL, NULL },

224 #i‡
HAVE_GETHOSTBYNAME2


225 { 
SYMBOL_GETHOSTBYNAME2
, 
LIBRARY_GETHOSTBYNAME2
, 
NULL
, NULL, NULL },

228 #i‡
HAVE_GETIPNODEBYNAME


229 { 
SYMBOL_GETIPNODEBYNAME
, 
LIBRARY_GETIPNODEBYNAME
,
NULL
, NULL, NULL },

230 { 
SYMBOL_FREEHOSTENT
, 
LIBRARY_FREEHOSTENT
, 
NULL
, NULL, NULL },

233 #i‡
HAVE_GETADDRINFO


234 { 
SYMBOL_GETADDRINFO
, 
LIBRARY_GETADDRINFO
, 
NULL
, NULL, NULL },

237 #i‡
HAVE_GETNAMEINFO
 && !
SOCKS_CLIENT


238 { 
SYMBOL_GETNAMEINFO
, 
LIBRARY_GETNAMEINFO
, 
NULL
, NULL, NULL },

241 #ifde‡
__sun


242 { 
SYMBOL_XNET_BIND
, 
LIBRARY_BIND
, 
NULL
, NULL, NULL },

243 { 
SYMBOL_XNET_CONNECT
, 
LIBRARY_CONNECT
, 
NULL
, NULL, NULL },

244 { 
SYMBOL_XNET_LISTEN
, 
LIBRARY_LISTEN
, 
NULL
, NULL, NULL },

245 { 
SYMBOL_XNET_RECVMSG
, 
LIBRARY_RECVMSG
, 
NULL
, NULL, NULL },

246 { 
SYMBOL_XNET_SENDMSG
, 
LIBRARY_SENDMSG
, 
NULL
, NULL, NULL },

247 { 
SYMBOL_XNET_SENDTO
, 
LIBRARY_SENDTO
, 
NULL
, NULL, NULL },

250 #i‡
HAVE_DARWIN


251 { 
SYMBOL_CONNECT_NOCANCEL
, 
LIBRARY_CONNECT
, 
NULL
, NULL, NULL },

252 { 
SYMBOL_READ_NOCANCEL
, 
LIBRARY_READ
, 
NULL
, NULL, NULL },

253 { 
SYMBOL_RECVFROM_NOCANCEL
, 
LIBRARY_RECVFROM
, 
NULL
, NULL, NULL },

254 { 
SYMBOL_SENDTO_NOCANCEL
, 
LIBRARY_SENDTO
, 
NULL
, NULL, NULL },

255 { 
SYMBOL_WRITE_NOCANCEL
, 
LIBRARY_WRITE
, 
NULL
, NULL, NULL },

258 #i‡
HAVE_EXTRA_OSF_SYMBOLS


259 { 
SYMBOL_EACCEPT
, 
LIBRARY_EACCEPT
, 
NULL
, NULL, NULL },

260 { 
SYMBOL_EGETPEERNAME
, 
LIBRARY_EGETPEERNAME
, 
NULL
, NULL, NULL },

261 { 
SYMBOL_EGETSOCKNAME
, 
LIBRARY_EGETSOCKNAME
, 
NULL
, NULL, NULL },

262 { 
SYMBOL_EREADV
, 
LIBRARY_EREADV
, 
NULL
, NULL, NULL },

263 { 
SYMBOL_ERECVFROM
, 
LIBRARY_ERECVFROM
, 
NULL
, NULL, NULL },

264 { 
SYMBOL_ERECVMSG
, 
LIBRARY_ERECVMSG
, 
NULL
, NULL, NULL },

265 { 
SYMBOL_ESENDMSG
, 
LIBRARY_ESENDMSG
, 
NULL
, NULL, NULL },

266 { 
SYMBOL_EWRITEV
, 
LIBRARY_EWRITEV
, 
NULL
, NULL, NULL },

267 { 
SYMBOL_NACCEPT
, 
LIBRARY_EACCEPT
, 
NULL
, NULL, NULL },

268 { 
SYMBOL_NGETPEERNAME
, 
LIBRARY_NGETPEERNAME
, 
NULL
, NULL, NULL },

269 { 
SYMBOL_NGETSOCKNAME
, 
LIBRARY_NGETSOCKNAME
, 
NULL
, NULL, NULL },

270 { 
SYMBOL_NRECVFROM
, 
LIBRARY_NRECVFROM
, 
NULL
, NULL, NULL },

271 { 
SYMBOL_NRECVMSG
, 
LIBRARY_NRECVMSG
, 
NULL
, NULL, NULL },

272 { 
SYMBOL_NSENDMSG
, 
LIBRARY_NSENDMSG
, 
NULL
, NULL, NULL },

275 #i‡
HAVE_GSSAPI
 && 
HAVE_LINUX_GLIBC_WORKAROUND


276 { 
SYMBOL_GETC
, 
LIBRARY_GETC
, 
NULL
, NULL, NULL },

277 { 
SYMBOL_FGETC
, 
LIBRARY_FGETC
, 
NULL
, NULL, NULL },

278 { 
SYMBOL_GETS
, 
LIBRARY_GETS
, 
NULL
, NULL, NULL },

279 { 
SYMBOL_FGETS
, 
LIBRARY_FGETS
, 
NULL
, NULL, NULL },

280 { 
SYMBOL_PUTC
, 
LIBRARY_PUTC
, 
NULL
, NULL, NULL },

281 { 
SYMBOL_FPUTC
, 
LIBRARY_FPUTC
, 
NULL
, NULL, NULL },

282 { 
SYMBOL_PUTS
, 
LIBRARY_PUTS
, 
NULL
, NULL, NULL },

283 { 
SYMBOL_FPUTS
, 
LIBRARY_FPUTS
, 
NULL
, NULL, NULL },

284 { 
SYMBOL_PRINTF
, 
LIBRARY_PRINTF
, 
NULL
, NULL, NULL },

285 { 
SYMBOL_VPRINTF
, 
LIBRARY_VPRINTF
, 
NULL
, NULL, NULL },

286 { 
SYMBOL_FPRINTF
, 
LIBRARY_FPRINTF
, 
NULL
, NULL, NULL },

287 { 
SYMBOL_VFPRINTF
, 
LIBRARY_VFPRINTF
, 
NULL
, NULL, NULL },

288 { 
SYMBOL_FWRITE
, 
LIBRARY_FWRITE
, 
NULL
, NULL, NULL },

289 { 
SYMBOL_FREAD
, 
LIBRARY_FREAD
, 
NULL
, NULL, NULL },

290 { 
SYMBOL_FFLUSH
, 
LIBRARY_FFLUSH
, 
NULL
, NULL, NULL },

291 { 
SYMBOL_FCLOSE
, 
LIBRARY_FCLOSE
, 
NULL
, NULL, NULL },

293 #i‡
HAVE__IO_GETC


294 { 
SYMBOL__IO_GETC
, 
LIBRARY__IO_GETC
, 
NULL
, NULL, NULL },

297 #i‡
HAVE__IO_PUTC


298 { 
SYMBOL__IO_PUTC
, 
LIBRARY__IO_PUTC
, 
NULL
, NULL, NULL },

301 #i‡
HAVE___FPRINTF_CHK


302 { 
SYMBOL___FPRINTF_CHK
, 
LIBRARY___FPRINTF_CHK
, 
NULL
, NULL, NULL },

305 #i‡
HAVE___VFPRINTF_CHK


306 { 
SYMBOL___VFPRINTF_CHK
, 
LIBRARY___VFPRINTF_CHK
, 
NULL
, NULL, NULL },

309 #i‡
HAVE___READ_CHK


310 { 
SYMBOL___READ_CHK
, 
LIBRARY___READ_CHK
, 
NULL
, NULL, NULL },

335 { 
SYMBOL_GETHOSTBYADDR
, 
LIBRARY_GETHOSTBYADDR
, 
NULL
, NULL, NULL },

336 { 
SYMBOL_GETHOSTBYNAME
, 
LIBRARY_GETHOSTBYNAME
, 
NULL
, NULL, NULL },

341 #i‡
SOCKS_CLIENT


349 #ifde‡
HAVE_VOLATILE_SIG_ATOMIC_T


350 
sig_©omic_t
 
doög_addröô
;

352 vﬁ©ûê
sig_©omic_t
 
doög_addröô
;

355 
	#DNSCODE_START
() \

356 dÿ{ ++
sockscf
.
°©e
.
executögdnscode
; }  0)

	)

358 
	#DNSCODE_END
() \

359 dÿ{ --
sockscf
.
°©e
.
executögdnscode
; }  0)

	)

363 
	#DNSCODE_START
()

	)

364 
	#DNSCODE_END
()

	)

369 
addtﬁi°
(c⁄° *
fun˘i⁄«me
, c⁄° 
socks_id_t
 *
id
);

376 
ªmove‰omli°
(c⁄° *
fun˘i⁄«me
, c⁄° 
socks_id_t
 *
id
);

384 
idßªequÆ
(c⁄° 
socks_id_t
 *
a
, c⁄° socks_id_à*
b
);

390 
libsymbﬁ_t
 *

391 
libsymbﬁ
(c⁄° *
symbﬁ
);

397 #i‡
SOCKS_CLIENT


399 
	$socks_issysˇŒ
(
s
, 
«me
)

400 c⁄° 
s
;

401 c⁄° *
«me
;

403 
socksfd_t
 
socksfd
;

405 i‡(
s
 < 0)

408 i‡(
	`socks_shouldˇŒa¢©ive
(
«me
))

411 i‡(
	`socks_gëaddr
(
s
, &
socksfd
, 1Ë!
NULL


412 && 
socksfd
.
°©e
.
sysˇŒdïth
 > 0)

416 
	}
}

419 
	$socks_sysˇŒ_°¨t
(
s
)

420 c⁄° 
s
;

422 
socksfd_t
 *
p
;

423 
addæock›aque_t
 
›aque
;

425 i‡(
s
 < 0)

428 i‡(
	`socks_logm©ch
(
s
, &
sockscf
.
log
)

429 || 
	`socks_logm©ch
(
s
, &
sockscf
.
îæog
))

432 
	`socks_addæock
(
F_WRLCK
, &
›aque
);

434 i‡((
p
 = 
	`socks_gëaddr
(
s
, 
NULL
, 0)) == NULL) {

435 
socksfd_t
 
socksfd
;

437 
	`bzîo
(&
socksfd
, (socksfd));

438 
socksfd
.
°©e
.
comm™d
 = -1;

439 
socksfd
.
°©e
.
issysˇŒ
 = 1;

440 
p
 = 
	`socks_addaddr
(
s
, &
socksfd
, 0);

443 
	`SASSERTX
(
p
 !
NULL
);

445 ++(
p
->
°©e
.
sysˇŒdïth
);

446 
	`socks_addaddr
(
s
, 
p
, 0);

448 
	`socks_addru∆ock
(&
›aque
);

449 
	}
}

452 
	$socks_sysˇŒ_íd
(
s
)

453 c⁄° 
s
;

455 
addæock›aque_t
 
›aque
;

456 
socksfd_t
 
socksfd
, *
p
;

458 i‡(
s
 < 0)

461 i‡(
	`socks_logm©ch
(
s
, &
sockscf
.
log
)

462 || 
	`socks_logm©ch
(
s
, &
sockscf
.
îæog
))

465 
	`socks_addæock
(
F_WRLCK
, &
›aque
);

467 
p
 = 
	`socks_gëaddr
(
s
, &
socksfd
, 0);

469 i‡(
p
 =
NULL
) {

470 
	`socks_addru∆ock
(&
›aque
);

474 i‡(
p
->
°©e
.
sysˇŒdïth
 <= 0)

477 --(
p
->
°©e
.
sysˇŒdïth
);

479 i‡(
p
->
°©e
.
sysˇŒdïth
 <= 0) {

480 i‡(
p
->
°©e
.
issysˇŒ
)

481 
	`socks_rmaddr
(
s
, 0);

483 
	`socks_addaddr
(
s
, &
socksfd
, 0);

486 
	`socks_addaddr
(
s
, &
socksfd
, 0);

488 
	`socks_addru∆ock
(&
›aque
);

489 
	}
}

496 
	$symbﬁcheck
()

498 
size_t
 
i
;

500 
i
 = 0; i < 
	`ELEMENTS
(
libsymbﬁv
); ++i)

501 
	`symbﬁfun˘i⁄
(
libsymbﬁv
[
i
].
symbﬁ
);

502 
	}
}

506 
	$socks_shouldˇŒa¢©ive
(
symbﬁ
)

507 c⁄° *
symbﬁ
;

509 
socks_id_t
 
myid
, *
fid
;

510 
libsymbﬁ_t
 *
lib
;

512 #i‡
SOCKS_CLIENT


513 i‡(
doög_addröô
)

517 
lib
 = 
	`libsymbﬁ
(
symbﬁ
);

518 
	`SASSERTX
(
lib
 !
NULL
);

520 i‡((
fid
 = 
lib
->
dosysˇŒ
Ë=
NULL
)

523 
	`socks_whﬂmi
(&
myid
);

525 ; 
fid
 !
NULL
; fid = fid->
√xt
)

526 i‡(
	`idßªequÆ
(&
myid
, 
fid
))

530 
	}
}

533 
	$socks_m¨ka¢©ive
(
symbﬁ
)

534 c⁄° *
symbﬁ
;

536 c⁄° *
fun˘i⁄
 = "socks_markasnative()";

537 
socks_id_t
 
myid
;

539 i‡(
sockscf
.
›ti⁄
.
debug
 > 
DEBUG_VERBOSE
)

540 
	`¶og
(
LOG_DEBUG
, "%s: marking %sásÇative for current id",

541 
fun˘i⁄
, 
symbﬁ
);

543 i‡(
	`°rcmp
(
symbﬁ
, "*") == 0) {

544 
size_t
 
i
;

546 
i
 = 0; i < 
	`ELEMENTS
(
libsymbﬁv
); ++i)

547 
	`socks_m¨ka¢©ive
(
libsymbﬁv
[
i
].
symbﬁ
);

552 
	`socks_whﬂmi
(&
myid
);

553 
	`addtﬁi°
(
symbﬁ
, &
myid
);

554 
	}
}

557 
	$socks_m¨ka¢‹mÆ
(
symbﬁ
)

558 c⁄° *
symbﬁ
;

560 c⁄° *
fun˘i⁄
 = "socks_markasnormal()";

561 
socks_id_t
 
myid
;

563 i‡(
sockscf
.
›ti⁄
.
debug
 > 
DEBUG_VERBOSE
)

564 
	`¶og
(
LOG_DEBUG
, "%s: marking %sásÇormal for current id",

565 
fun˘i⁄
, 
symbﬁ
);

567 i‡(
	`°rcmp
(
symbﬁ
, "*") == 0) {

568 
size_t
 
i
;

570 
i
 = 0; i < 
	`ELEMENTS
(
libsymbﬁv
); ++i)

571 
	`socks_m¨ka¢‹mÆ
(
libsymbﬁv
[
i
].
symbﬁ
);

576 
	`socks_whﬂmi
(&
myid
);

577 
	`ªmove‰omli°
(
symbﬁ
, &
myid
);

578 
	}
}

582 
	$symbﬁfun˘i⁄
(
symbﬁ
)

583 c⁄° *
symbﬁ
;

585 c⁄° *
fun˘i⁄
 = "symbolfunction()";

586 
libsymbﬁ_t
 *
lib
;

588 
lib
 = 
	`libsymbﬁ
(
symbﬁ
);

590 
	`SASSERTX
(
lib
 !
NULL
);

591 
	`SASSERTX
(
lib
->
libøry
 !
NULL
);

592 
	`SASSERTX
(
	`°rcmp
(
lib
->
symbﬁ
, symbol) == 0);

594 #i‡
HAVE_RTLD_NEXT


595 i‡(
lib
->
fun˘i⁄
 =
NULL
) {

596 i‡((
lib
->
fun˘i⁄
 = 
	`dlsym
(
RTLD_NEXT
, 
symbﬁ
)Ë=
NULL
) {

597 i‡(
	`°rcmp
(
symbﬁ
, 
SYMBOL_WRITE
) != 0)

598 
	`£ºx
("%s: compileÅime configurationÉrror? "

600 
fun˘i⁄
, 
symbﬁ
, 
	`dÀº‹
());

604 i‡(
	`°rcmp
(
symbﬁ
, 
SYMBOL_WRITE
) != 0)

605 
	`¶og
(
LOG_DEBUG
, "found symbﬁ %†usög RTLD_NEXT", 
lib
->
symbﬁ
);

611 i‡(
lib
->
h™dÀ
 =
NULL
)

612 i‡((
lib
->
h™dÀ
 = 
	`dl›í
÷ib->
libøry
, 
DL_LAZY
)Ë=
NULL
)

613 
	`£ºx
("%s: compileÅime configurationÉrror? "

615 
fun˘i⁄
, 
lib
->
libøry
, 
	`dÀº‹
());

617 i‡(
lib
->
fun˘i⁄
 =
NULL
)

618 i‡((
lib
->
fun˘i⁄
 = 
	`dlsym
÷ib->
h™dÀ
, 
symbﬁ
)Ë=
NULL
)

619 
	`£ºx
("%s: compileÅime configurationÉrror? "

621 
fun˘i⁄
, 
symbﬁ
, 
lib
->
libøry
, 
	`dÀº‹
());

624 i‡(
	`°rcmp
(
symbﬁ
, 
SYMBOL_WRITE
) != 0)

625 
	`¶og
(
LOG_DEBUG
, "found symbol %s inÜibrary %s",

626 
lib
->
symbﬁ
,Üib->
libøry
);

630  
lib
->
fun˘i⁄
;

631 
	}
}

633 #i‡
SOCKS_CLIENT


636 
	$socks_m¨k_io_as_«tive
()

638 c⁄° *
fun˘i⁄
 = "socks_mark_io_as_native()";

640 
	`¶og
(
LOG_DEBUG
, "%s: m¨kög i/ÿˇŒ†a†«tivê...", 
fun˘i⁄
);

641 
	`socks_m¨ka¢©ive
("*");

642 
	}
}

645 
	$socks_m¨k_io_as_n‹mÆ
()

647 c⁄° *
fun˘i⁄
 = "socks_mark_io_as_normal()";

649 
	`¶og
(
LOG_DEBUG
, "%s: m¨kög io-ªœãd cÆl†a†n‹mÆágaö", 
fun˘i⁄
);

650 
	`socks_m¨ka¢‹mÆ
("*");

651 
	}
}

657 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


658 
HAVE_PROT_ACCEPT_0


659 
	$sys_ac˚±
(
s
, 
addr
, 
addæí
)

660 
HAVE_PROT_ACCEPT_1
 
s
;

661 
HAVE_PROT_ACCEPT_2
 
addr
;

662 
HAVE_PROT_ACCEPT_3
 
addæí
;

664 
rc
;

665 
	`HAVE_PROT_ACCEPT_0
 (*
	tACCEPT_FUNC_T
)(
	tHAVE_PROT_ACCEPT_1
,

666 
	tHAVE_PROT_ACCEPT_2
,

667 
	tHAVE_PROT_ACCEPT_3
);

668 
ACCEPT_FUNC_T
 
fun˘i⁄
 = (ACCEPT_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_ACCEPT
);

669 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

671 i‡(
ègged
)

672 
	`socks_sysˇŒ_°¨t
(
s
);

674 
rc
 = 
	`fun˘i⁄
(
s
, 
addr
, 
addæí
);

676 i‡(
ègged
)

677 
	`socks_sysˇŒ_íd
(
s
);

679  
rc
;

680 
	}
}

683 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


684 
HAVE_PROT_BIND_0


685 
	$sys_böd
(
s
, 
«me
, 
«mñí
)

686 
HAVE_PROT_BIND_1
 
s
;

687 
HAVE_PROT_BIND_2
 
«me
;

688 
HAVE_PROT_BIND_3
 
«mñí
;

690 
rc
;

691 
	`HAVE_PROT_BIND_0
 (*
	tBIND_FUNC_T
)(
	tHAVE_PROT_BIND_1
,

692 
	tHAVE_PROT_BIND_2
,

693 
	tHAVE_PROT_BIND_3
);

694 
BIND_FUNC_T
 
fun˘i⁄
 = (BIND_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_BIND
);

695 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

697 i‡(
ègged
)

698 
	`socks_sysˇŒ_°¨t
(
s
);

700 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

702 i‡(
ègged
)

703 
	`socks_sysˇŒ_íd
(
s
);

705  
rc
;

706 
	}
}

710 
	$sys_bödªsvp‹t
(
sd
, 
sö
)

711 
sd
;

712 
sockaddr_ö
 *
sö
;

714 
rc
;

715 (*
	tBINDRESVPORT_FUNC_T
)(, 
	tsockaddr_ö
 *);

716 
BINDRESVPORT_FUNC_T
 
fun˘i⁄


717 (
BINDRESVPORT_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_BINDRESVPORT
);

718 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

720 i‡(
ègged
)

721 
	`socks_sysˇŒ_°¨t
(
sd
);

723 
rc
 = 
	`fun˘i⁄
(
sd
, 
sö
);

725 i‡(
ègged
)

726 
	`socks_sysˇŒ_íd
(
sd
);

728  
rc
;

729 
	}
}

731 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


732 
HAVE_PROT_CONNECT_0


733 
	$sys_c⁄√˘
(
s
, 
«me
, 
«mñí
)

734 
HAVE_PROT_CONNECT_1
 
s
;

735 
HAVE_PROT_CONNECT_2
 
«me
;

736 
HAVE_PROT_CONNECT_3
 
«mñí
;

738 
rc
;

739 
	`HAVE_PROT_CONNECT_0
 (*
	tCONNECT_FUNC_T
)(
	tHAVE_PROT_CONNECT_1
,

740 
	tHAVE_PROT_CONNECT_2
,

741 
	tHAVE_PROT_CONNECT_3
);

742 
CONNECT_FUNC_T
 
fun˘i⁄
 = (CONNECT_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_CONNECT
);

743 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

745 i‡(
ègged
)

746 
	`socks_sysˇŒ_°¨t
(
s
);

748 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

750 i‡(
ègged
)

751 
	`socks_sysˇŒ_íd
(
s
);

753  
rc
;

754 
	}
}

757 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


758 
HAVE_PROT_GETPEERNAME_0


759 
	$sys_gë≥î«me
(
s
, 
«me
, 
«mñí
)

760 
HAVE_PROT_GETPEERNAME_1
 
s
;

761 
HAVE_PROT_GETPEERNAME_2
 
«me
;

762 
HAVE_PROT_GETPEERNAME_3
 
«mñí
;

764 
rc
;

765 
HAVE_PROT_GETPEERNAME_0


766 (*
	tGETPEERNAME_FUNC_T
)(
	tHAVE_PROT_GETPEERNAME_1
,

767 
	tHAVE_PROT_GETPEERNAME_2
,

768 
	tHAVE_PROT_GETPEERNAME_3
);

769 
GETPEERNAME_FUNC_T
 
fun˘i⁄


770 (
GETPEERNAME_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_GETPEERNAME
);

771 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

773 i‡(
ègged
)

774 
	`socks_sysˇŒ_°¨t
(
s
);

776 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

778 i‡(
ègged
)

779 
	`socks_sysˇŒ_íd
(
s
);

781  
rc
;

782 
	}
}

785 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


786 
HAVE_PROT_GETSOCKNAME_0


787 
	$sys_gësock«me
(
s
, 
«me
, 
«mñí
)

788 
HAVE_PROT_GETSOCKNAME_1
 
s
;

789 
HAVE_PROT_GETSOCKNAME_2
 
«me
;

790 
HAVE_PROT_GETSOCKNAME_3
 
«mñí
;

792 
rc
;

793 
HAVE_PROT_GETSOCKNAME_0


794 (*
	tGETSOCKNAME_FUNC_T
)(
	tHAVE_PROT_GETSOCKNAME_1
,

795 
	tHAVE_PROT_GETSOCKNAME_2
,

796 
	tHAVE_PROT_GETSOCKNAME_3
);

797 
GETSOCKNAME_FUNC_T
 
fun˘i⁄


798 (
GETSOCKNAME_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_GETSOCKNAME
);

799 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

801 i‡(
ègged
)

802 
	`socks_sysˇŒ_°¨t
(
s
);

804 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

806 i‡(
ègged
)

807 
	`socks_sysˇŒ_íd
(
s
);

809  
rc
;

810 
	}
}

814 
HAVE_PROT_GETSOCKOPT_0


815 
	$sys_gësock›t
(
s
, 
Àvñ
, 
›äame
, 
›tvÆ
, 
›éí
)

816 
HAVE_PROT_GETSOCKOPT_1
 
s
;

817 
HAVE_PROT_GETSOCKOPT_2
 
Àvñ
;

818 
HAVE_PROT_GETSOCKOPT_3
 
›äame
;

819 
HAVE_PROT_GETSOCKOPT_4
 
›tvÆ
;

820 
HAVE_PROT_GETSOCKOPT_5
 
›éí
;

822 
rc
;

823 
HAVE_PROT_GETSOCKOPT_0


824 (*
	tGETSOCKOPT_FUNC_T
)(
	tHAVE_PROT_GETSOCKOPT_1
,

825 
	tHAVE_PROT_GETSOCKOPT_2
,

826 
	tHAVE_PROT_GETSOCKOPT_3
,

827 
	tHAVE_PROT_GETSOCKOPT_4
,

828 
	tHAVE_PROT_GETSOCKOPT_5
);

829 
GETSOCKOPT_FUNC_T
 
fun˘i⁄


830 (
GETSOCKOPT_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_GETSOCKOPT
);

831 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

833 i‡(
ègged
)

834 
	`socks_sysˇŒ_°¨t
(
s
);

836 
rc
 = 
	`fun˘i⁄
(
s
, 
Àvñ
, 
›äame
, 
›tvÆ
, 
›éí
);

838 i‡(
ègged
)

839 
	`socks_sysˇŒ_íd
(
s
);

841  
rc
;

842 
	}
}

844 
HAVE_PROT_LISTEN_0


845 
	$sys_li°í
(
s
, 
backlog
)

846 
HAVE_PROT_LISTEN_1
 
s
;

847 
HAVE_PROT_LISTEN_2
 
backlog
;

849 
HAVE_PROT_LISTEN_0
 
rc
;

850 
	`HAVE_PROT_LISTEN_0
 (*
	tLISTEN_FUNC_T
)(
	tHAVE_PROT_LISTEN_1
,

851 
	tHAVE_PROT_LISTEN_2
);

852 
LISTEN_FUNC_T
 
fun˘i⁄
 = (LISTEN_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_LISTEN
);

853 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

855 i‡(
ègged
)

856 
	`socks_sysˇŒ_°¨t
(
s
);

858 
rc
 = 
	`fun˘i⁄
(
s
, 
backlog
);

860 i‡(
ègged
)

861 
	`socks_sysˇŒ_íd
(
s
);

863  
rc
;

864 
	}
}

866 
HAVE_PROT_READ_0


867 
	$sys_ªad
(
d
, 
buf
, 
nbyãs
)

868 
HAVE_PROT_READ_1
 
d
;

869 
HAVE_PROT_READ_2
 
buf
;

870 
HAVE_PROT_READ_3
 
nbyãs
;

872 
ssize_t
 
rc
;

873 
	`HAVE_PROT_READ_0
 (*
	tREAD_FUNC_T
)(
	tHAVE_PROT_READ_1
,

874 
	tHAVE_PROT_READ_2
,

875 
	tHAVE_PROT_READ_3
);

876 
READ_FUNC_T
 
fun˘i⁄
 = (READ_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_READ
);

878 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

880 i‡(
ègged
)

881 
	`socks_sysˇŒ_°¨t
(
d
);

883 
rc
 = 
	`fun˘i⁄
(
d
, 
buf
, 
nbyãs
);

885 i‡(
ègged
)

886 
	`socks_sysˇŒ_íd
(
d
);

888  
rc
;

889 
	}
}

891 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


892 
HAVE_PROT_READV_0


893 
	$sys_ªadv
(
d
, 
iov
, 
iov˙t
)

894 
HAVE_PROT_READV_1
 
d
;

895 
HAVE_PROT_READV_2
 
iov
;

896 
HAVE_PROT_READV_3
 
iov˙t
;

898 
ssize_t
 
rc
;

899 
	`HAVE_PROT_READV_0
 (*
	tREADV_FUNC_T
)(
	tHAVE_PROT_READV_1
,

900 
	tHAVE_PROT_READV_2
,

901 
	tHAVE_PROT_READV_3
);

902 
READV_FUNC_T
 
fun˘i⁄
 = (READV_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_READV
);

903 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

905 i‡(
ègged
)

906 
	`socks_sysˇŒ_°¨t
(
d
);

908 
rc
 = 
	`fun˘i⁄
(
d
, 
iov
, 
iov˙t
);

910 i‡(
ègged
)

911 
	`socks_sysˇŒ_íd
(
d
);

913  
rc
;

914 
	}
}

917 
HAVE_PROT_RECV_0


918 
	$sys_ªcv
(
s
, 
buf
, 
Àn
, 
Êags
)

919 
HAVE_PROT_RECV_1
 
s
;

920 
HAVE_PROT_RECV_2
 
buf
;

921 
HAVE_PROT_RECV_3
 
Àn
;

922 
HAVE_PROT_RECV_4
 
Êags
;

924 
ssize_t
 
rc
;

925 
	`HAVE_PROT_RECV_0
 (*
	tRECV_FUNC_T
)(
	tHAVE_PROT_RECV_1
,

926 
	tHAVE_PROT_RECV_2
,

927 
	tHAVE_PROT_RECV_3
,

928 
	tHAVE_PROT_RECV_4
);

929 
RECV_FUNC_T
 
fun˘i⁄
 = (RECV_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_RECV
);

930 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

932 i‡(
ègged
)

933 
	`socks_sysˇŒ_°¨t
(
s
);

935 
rc
 = 
	`fun˘i⁄
(
s
, 
buf
, 
Àn
, 
Êags
);

937 i‡(
ègged
)

938 
	`socks_sysˇŒ_íd
(
s
);

940  
rc
;

941 
	}
}

943 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


944 
HAVE_PROT_RECVFROM_0


945 
	$sys_ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

946 
HAVE_PROT_RECVFROM_1
 
s
;

947 
HAVE_PROT_RECVFROM_2
 
buf
;

948 
HAVE_PROT_RECVFROM_3
 
Àn
;

949 
HAVE_PROT_RECVFROM_4
 
Êags
;

950 
HAVE_PROT_RECVFROM_5
 
‰om
;

951 
HAVE_PROT_RECVFROM_6
 
‰omÀn
;

953 
HAVE_PROT_RECVFROM_0
 
rc
;

954 
	`HAVE_PROT_RECVFROM_0
 (*
	tRECVFROM_FUNC_T
)(
	tHAVE_PROT_RECVFROM_1
,

955 
	tHAVE_PROT_RECVFROM_2
,

956 
	tHAVE_PROT_RECVFROM_3
,

957 
	tHAVE_PROT_RECVFROM_4
,

958 
	tHAVE_PROT_RECVFROM_5
,

959 
	tHAVE_PROT_RECVFROM_6
);

960 
RECVFROM_FUNC_T
 
fun˘i⁄
 = (RECVFROM_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_RECVFROM
);

961 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

963 i‡(
ègged
)

964 
	`socks_sysˇŒ_°¨t
(
s
);

966 
rc
 = 
	`fun˘i⁄
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

968 i‡(
ègged
)

969 
	`socks_sysˇŒ_íd
(
s
);

971  
rc
;

972 
	}
}

975 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


976 
HAVE_PROT_RECVMSG_0


977 
	$sys_ªcvmsg
(
s
, 
msg
, 
Êags
)

978 
HAVE_PROT_RECVMSG_1
 
s
;

979 
HAVE_PROT_RECVMSG_2
 
msg
;

980 
HAVE_PROT_RECVMSG_3
 
Êags
;

982 
ssize_t
 
rc
;

983 
	`HAVE_PROT_RECVMSG_0
 (*
	tRECVMSG_FUNC_T
)(
	tHAVE_PROT_RECVMSG_1
,

984 
	tHAVE_PROT_RECVMSG_2
,

985 
	tHAVE_PROT_RECVMSG_3
);

986 
RECVMSG_FUNC_T
 
fun˘i⁄
 = (RECVMSG_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_RECVMSG
);

987 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

989 i‡(
ègged
)

990 
	`socks_sysˇŒ_°¨t
(
s
);

992 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

994 i‡(
ègged
)

995 
	`socks_sysˇŒ_íd
(
s
);

997  
rc
;

998 
	}
}

1001 #i‡
HAVE_RRESVPORT


1003 
	$sys_ºesvp‹t
(
p‹t
)

1004 *
p‹t
;

1006 (*
	tRRESVPORT_FUNC_T
)(*);

1007 
RRESVPORT_FUNC_T
 
fun˘i⁄
;

1009 
fun˘i⁄
 = (
RRESVPORT_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_RRESVPORT
);

1010  
	`fun˘i⁄
(
p‹t
);

1011 
	}
}

1014 
HAVE_PROT_SEND_0


1015 
	$sys_£nd
(
s
, 
msg
, 
Àn
, 
Êags
)

1016 
HAVE_PROT_SEND_1
 
s
;

1017 
HAVE_PROT_SEND_2
 
msg
;

1018 
HAVE_PROT_SEND_3
 
Àn
;

1019 
HAVE_PROT_SEND_4
 
Êags
;

1021 
ssize_t
 
rc
;

1022 
	`HAVE_PROT_SEND_0
 (*
	tSEND_FUNC_T
)(
	tHAVE_PROT_SEND_1
,

1023 
	tHAVE_PROT_SEND_2
,

1024 
	tHAVE_PROT_SEND_3
,

1025 
	tHAVE_PROT_SEND_4
);

1026 
SEND_FUNC_T
 
fun˘i⁄
 = (SEND_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_SEND
);

1027 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1029 i‡(
ègged
)

1030 
	`socks_sysˇŒ_°¨t
(
s
);

1032 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Àn
, 
Êags
);

1034 i‡(
ègged
)

1035 
	`socks_sysˇŒ_íd
(
s
);

1037  
rc
;

1038 
	}
}

1040 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1041 
HAVE_PROT_SENDMSG_0


1042 
	$sys_£ndmsg
(
s
, 
msg
, 
Êags
)

1043 
HAVE_PROT_SENDMSG_1
 
s
;

1044 
HAVE_PROT_SENDMSG_2
 
msg
;

1045 
HAVE_PROT_SENDMSG_3
 
Êags
;

1047 
ssize_t
 
rc
;

1048 
	`HAVE_PROT_SENDMSG_0
 (*
	tSENDMSG_FUNC_T
)(
	tHAVE_PROT_SENDMSG_1
,

1049 
	tHAVE_PROT_SENDMSG_2
,

1050 
	tHAVE_PROT_SENDMSG_3
);

1051 
SENDMSG_FUNC_T
 
fun˘i⁄
 = (SENDMSG_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_SENDMSG
);

1052 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1054 i‡(
ègged
)

1055 
	`socks_sysˇŒ_°¨t
(
s
);

1057 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

1059 i‡(
ègged
)

1060 
	`socks_sysˇŒ_íd
(
s
);

1062  
rc
;

1063 
	}
}

1066 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1067 
HAVE_PROT_SENDTO_0


1068 
	$sys_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

1069 
HAVE_PROT_SENDTO_1
 
s
;

1070 
HAVE_PROT_SENDTO_2
 
msg
;

1071 
HAVE_PROT_SENDTO_3
 
Àn
;

1072 
HAVE_PROT_SENDTO_4
 
Êags
;

1073 
HAVE_PROT_SENDTO_5
 
to
;

1074 
HAVE_PROT_SENDTO_6
 
tﬁí
;

1076 
ssize_t
 
rc
;

1077 
	`HAVE_PROT_SENDTO_0
 (*
	tSENDTO_FUNC_T
)(
	tHAVE_PROT_SENDTO_1
,

1078 
	tHAVE_PROT_SENDTO_2
,

1079 
	tHAVE_PROT_SENDTO_3
,

1080 
	tHAVE_PROT_SENDTO_4
,

1081 
	tHAVE_PROT_SENDTO_5
,

1082 
	tHAVE_PROT_SENDTO_6
);

1083 
SENDTO_FUNC_T
 
fun˘i⁄
 = (SENDTO_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_SENDTO
);

1084 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1086 i‡(
ègged
)

1087 
	`socks_sysˇŒ_°¨t
(
s
);

1089 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

1091 i‡(
ègged
)

1092 
	`socks_sysˇŒ_íd
(
s
);

1094  
rc
;

1095 
	}
}

1098 
HAVE_PROT_WRITE_0


1099 
	$sys_wrôe
(
d
, 
buf
, 
nbyãs
)

1100 
HAVE_PROT_WRITE_1
 
d
;

1101 
HAVE_PROT_WRITE_2
 
buf
;

1102 
HAVE_PROT_WRITE_3
 
nbyãs
;

1104 
ssize_t
 
rc
;

1105 
	`HAVE_PROT_WRITE_0
 (*
	tWRITE_FUNC_T
)(
	tHAVE_PROT_WRITE_1
,

1106 
	tHAVE_PROT_WRITE_2
,

1107 
	tHAVE_PROT_WRITE_3
);

1108 
WRITE_FUNC_T
 
fun˘i⁄
 = (WRITE_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_WRITE
);

1109 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1111 i‡(
ègged
)

1112 
	`socks_sysˇŒ_°¨t
(
d
);

1114 
rc
 = 
	`fun˘i⁄
(
d
, 
buf
, 
nbyãs
);

1116 i‡(
ègged
)

1117 
	`socks_sysˇŒ_íd
(
d
);

1119  
rc
;

1120 
	}
}

1122 #i‡
DEBUG


1123 
HAVE_PROT_WRITE_0
 
syssys_wrôe
(
HAVE_PROT_WRITE_1
 
d
, 
HAVE_PROT_WRITE_2
 
buf
,

1124 
HAVE_PROT_WRITE_3
 
nbyãs
);

1125 
HAVE_PROT_WRITE_0


1126 
	$syssys_wrôe
(
d
, 
buf
, 
nbyãs
)

1127 
HAVE_PROT_WRITE_1
 
d
;

1128 
HAVE_PROT_WRITE_2
 
buf
;

1129 
HAVE_PROT_WRITE_3
 
nbyãs
;

1131 
	`HAVE_PROT_WRITE_0
 (*
	tWRITE_FUNC_T
)(
	tHAVE_PROT_WRITE_1
,

1132 
	tHAVE_PROT_WRITE_2
,

1133 
	tHAVE_PROT_WRITE_3
);

1134 
WRITE_FUNC_T
 
fun˘i⁄
;

1136 
fun˘i⁄
 = (
WRITE_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_WRITE
);

1137  
	`fun˘i⁄
(
d
, 
buf
, 
nbyãs
);

1138 
	}
}

1141 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1142 
HAVE_PROT_WRITEV_0


1143 
	$sys_wrôev
(
d
, 
iov
, 
iov˙t
)

1144 
HAVE_PROT_WRITEV_1
 
d
;

1145 
HAVE_PROT_WRITEV_2
 
iov
;

1146 
HAVE_PROT_WRITEV_3
 
iov˙t
;

1148 
ssize_t
 
rc
;

1149 
	`HAVE_PROT_WRITEV_0
 (*
	tWRITEV_FUNC_T
)(
	tHAVE_PROT_WRITEV_1
,

1150 
	tHAVE_PROT_WRITEV_2
,

1151 
	tHAVE_PROT_WRITEV_3
);

1152 
WRITEV_FUNC_T
 
fun˘i⁄
 = (WRITEV_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_WRITEV
);

1153 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1155 i‡(
ègged
)

1156 
	`socks_sysˇŒ_°¨t
(
d
);

1158 
rc
 = 
	`fun˘i⁄
(
d
, 
iov
, 
iov˙t
);

1160 i‡(
ègged
)

1161 
	`socks_sysˇŒ_íd
(
d
);

1163  
rc
;

1164 
	}
}

1167 #i‡
HAVE_GSSAPI
 && 
HAVE_LINUX_GLIBC_WORKAROUND


1168 
HAVE_PROT_GETC_0


1169 
	$sys_gëc
(
°ªam
)

1170 
HAVE_PROT_GETC_1
 
°ªam
;

1172 c⁄° 
d
 = 
	`fûío
(
°ªam
);

1173 
HAVE_PROT_GETC_0
 
rc
;

1174 
	`HAVE_PROT_GETC_0
 (*
	tGETC_FUNC_T
)(
	tHAVE_PROT_GETC_1
);

1175 
GETC_FUNC_T
 
fun˘i⁄
 = (GETC_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_GETC
);

1176 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1178 i‡(
ègged
)

1179 
	`socks_sysˇŒ_°¨t
(
d
);

1181 
rc
 = 
	`fun˘i⁄
(
°ªam
);

1183 i‡(
ègged
)

1184 
	`socks_sysˇŒ_íd
(
d
);

1186  
rc
;

1187 
	}
}

1189 
HAVE_PROT_FGETC_0


1190 
	$sys_fgëc
(
°ªam
)

1191 
HAVE_PROT_FGETC_1
 
°ªam
;

1193 c⁄° 
d
 = 
	`fûío
(
°ªam
);

1194 
HAVE_PROT_FGETC_0
 
rc
;

1195 
	`HAVE_PROT_FGETC_0
 (*
	tFGETC_FUNC_T
)(
	tHAVE_PROT_FGETC_1
);

1196 
FGETC_FUNC_T
 
fun˘i⁄
 = (FGETC_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_FGETC
);

1197 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1199 i‡(
ègged
)

1200 
	`socks_sysˇŒ_°¨t
(
d
);

1202 
rc
 = 
	`fun˘i⁄
(
°ªam
);

1204 i‡(
ègged
)

1205 
	`socks_sysˇŒ_íd
(
d
);

1207  
rc
;

1208 
	}
}

1210 
HAVE_PROT_GETS_0


1211 
	$sys_gës
(
buf
)

1212 
HAVE_PROT_GETS_1
 
buf
;

1214 c⁄° 
d
 = 
	`fûío
(
°dö
);

1215 
HAVE_PROT_GETS_0
 
rv
;

1216 
	`HAVE_PROT_GETS_0
(*
	tGETS_FUNC_T
)(
	tHAVE_PROT_GETS_1
);

1217 
GETS_FUNC_T
 
fun˘i⁄
 = (GETS_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_GETS
);

1218 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1220 i‡(
ègged
)

1221 
	`socks_sysˇŒ_°¨t
(
d
);

1223 
rv
 = 
	`fun˘i⁄
(
buf
);

1225 i‡(
ègged
)

1226 
	`socks_sysˇŒ_íd
(
d
);

1228  
rv
;

1229 
	}
}

1231 
HAVE_PROT_FGETS_0


1232 
	$sys_fgës
(
buf
, 
size
, 
°ªam
)

1233 
HAVE_PROT_FGETS_1
 
buf
;

1234 
HAVE_PROT_FGETS_2
 
size
;

1235 
HAVE_PROT_FGETS_3
 
°ªam
;

1237 c⁄° 
d
 = 
	`fûío
(
°ªam
);

1238 
HAVE_PROT_FGETS_0
 
rc
;

1239 
	`HAVE_PROT_FGETS_0
(*
	tFGETS_FUNC_T
)(
	tHAVE_PROT_FGETS_1
,

1240 
	tHAVE_PROT_FGETS_2
,

1241 
	tHAVE_PROT_FGETS_3
);

1242 
FGETS_FUNC_T
 
fun˘i⁄
 = (FGETS_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_FGETS
);

1243 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1245 i‡(
ègged
)

1246 
	`socks_sysˇŒ_°¨t
(
d
);

1248 
rc
 = 
	`fun˘i⁄
(
buf
, 
size
, 
°ªam
);

1250 i‡(
ègged
)

1251 
	`socks_sysˇŒ_íd
(
d
);

1253  
rc
;

1254 
	}
}

1256 
HAVE_PROT_PUTC_0


1257 
	$sys_putc
(
c
, 
°ªam
)

1258 
HAVE_PROT_PUTC_1
 
c
;

1259 
HAVE_PROT_PUTC_2
 
°ªam
;

1261 c⁄° 
d
 = 
	`fûío
(
°ªam
);

1262 
HAVE_PROT_PUTC_0
 
rc
;

1263 
	`HAVE_PROT_PUTC_0
(*
	tPUTC_FUNC_T
)(
	tHAVE_PROT_PUTC_1
, 
	tHAVE_PROT_PUTC_2
);

1264 
PUTC_FUNC_T
 
fun˘i⁄
 = (PUTC_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_PUTC
);

1265 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1267 i‡(
ègged
)

1268 
	`socks_sysˇŒ_°¨t
(
d
);

1270 
rc
 = 
	`fun˘i⁄
(
c
, 
°ªam
);

1272 i‡(
ègged
)

1273 
	`socks_sysˇŒ_íd
(
d
);

1275  
rc
;

1276 
	}
}

1278 
HAVE_PROT_FPUTC_0


1279 
	$sys_Âutc
(
c
, 
°ªam
)

1280 
HAVE_PROT_FPUTC_1
 
c
;

1281 
HAVE_PROT_FPUTC_2
 
°ªam
;

1283 c⁄° 
d
 = 
	`fûío
(
°ªam
);

1284 
HAVE_PROT_FPUTC_0
 
rc
;

1285 
	`HAVE_PROT_FPUTC_0
 (*
	tFPUTC_FUNC_T
)(
	tHAVE_PROT_FPUTC_1
,

1286 
	tHAVE_PROT_FPUTC_2
);

1287 
FPUTC_FUNC_T
 
fun˘i⁄
 = (FPUTC_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_FPUTC
);

1288 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1290 i‡(
ègged
)

1291 
	`socks_sysˇŒ_°¨t
(
d
);

1293 
rc
 = 
	`fun˘i⁄
(
c
, 
°ªam
);

1295 i‡(
ègged
)

1296 
	`socks_sysˇŒ_íd
(
d
);

1298  
rc
;

1299 
	}
}

1301 
HAVE_PROT_PUTS_0


1302 
	$sys_puts
(
buf
)

1303 
HAVE_PROT_PUTS_1
 
buf
;

1305 c⁄° 
d
 = 
	`fûío
(
°dout
);

1306 
HAVE_PROT_PUTS_0
 
rc
;

1307 
	`HAVE_PROT_PUTS_0
 (*
	tPUTS_FUNC_T
)(
	tHAVE_PROT_PUTS_1
);

1308 
PUTS_FUNC_T
 
fun˘i⁄
 = (PUTS_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_PUTS
);

1309 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1311 i‡(
ègged
)

1312 
	`socks_sysˇŒ_°¨t
(
d
);

1314 
rc
 = 
	`fun˘i⁄
(
buf
);

1316 i‡(
ègged
)

1317 
	`socks_sysˇŒ_íd
(
d
);

1319  
rc
;

1320 
	}
}

1322 
HAVE_PROT_FPUTS_0


1323 
	$sys_Âuts
(
buf
, 
°ªam
)

1324 
HAVE_PROT_FPUTS_1
 
buf
;

1325 
HAVE_PROT_FPUTS_2
 
°ªam
;

1327 c⁄° 
d
 = 
	`fûío
(
°ªam
);

1328 
HAVE_PROT_FPUTS_0
 
rc
;

1329 
	`HAVE_PROT_FPUTS_0
 (*
	tFPUTS_FUNC_T
)(
	tHAVE_PROT_FPUTS_1
,

1330 
	tHAVE_PROT_FPUTS_2
);

1331 
FPUTS_FUNC_T
 
fun˘i⁄
 = (FPUTS_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_FPUTS
);

1332 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1334 i‡(
ègged
)

1335 
	`socks_sysˇŒ_°¨t
(
d
);

1337 
rc
 = 
	`fun˘i⁄
(
buf
, 
°ªam
);

1339 i‡(
ègged
)

1340 
	`socks_sysˇŒ_íd
(
d
);

1342  
rc
;

1343 
	}
}

1345 
HAVE_PROT_FFLUSH_0


1346 
	$sys_fÊush
(
°ªam
)

1347 
HAVE_PROT_FFLUSH_1
 
°ªam
;

1349 
HAVE_PROT_FFLUSH_0
 
rc
;

1350 
	`HAVE_PROT_FFLUSH_0
 (*
	tFFLUSH_FUNC_T
)(
	tHAVE_PROT_FFLUSH_1
);

1351 
FFLUSH_FUNC_T
 
fun˘i⁄
 = (FFLUSH_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_FFLUSH
);

1352 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1354 i‡(
°ªam
 !
NULL
 && 
ègged
)

1355 
	`socks_sysˇŒ_°¨t
(
	`fûío
(
°ªam
));

1357 
rc
 = 
	`fun˘i⁄
(
°ªam
);

1359 i‡(
°ªam
 !
NULL
 && 
ègged
)

1360 
	`socks_sysˇŒ_íd
(
	`fûío
(
°ªam
));

1362  
rc
;

1363 
	}
}

1365 
HAVE_PROT_FCLOSE_0


1366 
	$sys_f˛o£
(
°ªam
)

1367 
HAVE_PROT_FCLOSE_1
 
°ªam
;

1369 c⁄° 
d
 = 
	`fûío
(
°ªam
);

1370 
HAVE_PROT_FCLOSE_0
 
rc
;

1371 
	`HAVE_PROT_FCLOSE_0
 (*
	tFCLOSE_FUNC_T
)(
	tHAVE_PROT_FCLOSE_1
);

1372 
FCLOSE_FUNC_T
 
fun˘i⁄
 = (FCLOSE_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_FCLOSE
);

1373 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1375 i‡(
ègged
)

1376 
	`socks_sysˇŒ_°¨t
(
d
);

1378 
rc
 = 
	`fun˘i⁄
(
°ªam
);

1380 i‡(
ègged
)

1381 
	`socks_sysˇŒ_íd
(
d
);

1383  
rc
;

1384 
	}
}

1386 
HAVE_PROT_PRINTF_0


1387 
	$sys_¥ötf
(
HAVE_PROT_PRINTF_1
 
f‹m©
, ...)

1389 
va_li°
 
≠
;

1390 
HAVE_PROT_FPRINTF_0
 
rc
;

1392 
	`va_°¨t
(
≠
, 
f‹m©
);

1393 
rc
 = 
	`sys_v¥ötf
(
f‹m©
, 
≠
);

1394 
	`va_íd
(
≠
);

1395  
rc
;

1396 
	}
}

1398 
HAVE_PROT_VPRINTF_0


1399 
	$sys_v¥ötf
(
f‹m©
, 
≠
)

1400 
HAVE_PROT_VPRINTF_1
 
f‹m©
;

1401 
HAVE_PROT_VPRINTF_2
 
≠
;

1403 c⁄° 
d
 = 
	`fûío
(
°dout
);

1404 
HAVE_PROT_VFPRINTF_0
 
rc
;

1405 
	`HAVE_PROT_VPRINTF_0
 (*
	tVPRINTF_FUNC_T
)(
	tHAVE_PROT_VPRINTF_1
,

1406 
	tHAVE_PROT_VPRINTF_2
);

1407 
VPRINTF_FUNC_T
 
fun˘i⁄
 = (VPRINTF_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_VPRINTF
);

1408 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1410 i‡(
ègged
)

1411 
	`socks_sysˇŒ_°¨t
(
d
);

1413 
rc
 = 
	`fun˘i⁄
(
f‹m©
, 
≠
);

1415 i‡(
ègged
)

1416 
	`socks_sysˇŒ_íd
(
d
);

1418  
rc
;

1419 
	}
}

1421 
HAVE_PROT_FPRINTF_0


1422 
	$sys_Ârötf
(
HAVE_PROT_FPRINTF_1
 
°ªam
, 
HAVE_PROT_FPRINTF_2
 
f‹m©
, ...)

1424 
va_li°
 
≠
;

1425 
HAVE_PROT_FPRINTF_0
 
rc
;

1427 
	`va_°¨t
(
≠
, 
f‹m©
);

1428 
rc
 = 
	`sys_vÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

1429 
	`va_íd
(
≠
);

1430  
rc
;

1431 
	}
}

1433 
HAVE_PROT_VFPRINTF_0


1434 
	$sys_vÂrötf
(
°ªam
, 
f‹m©
, 
≠
)

1435 
HAVE_PROT_VFPRINTF_1
 
°ªam
;

1436 
HAVE_PROT_VFPRINTF_2
 
f‹m©
;

1437 
HAVE_PROT_VFPRINTF_3
 
≠
;

1439 
HAVE_PROT_VFPRINTF_0
 
rc
;

1440 
d
 = 
	`fûío
(
°ªam
);

1441 
	`HAVE_PROT_VFPRINTF_0
 (*
	tVFPRINTF_FUNC_T
)(
	tHAVE_PROT_VFPRINTF_1
,

1442 
	tHAVE_PROT_VFPRINTF_2
,

1443 
	tHAVE_PROT_VFPRINTF_3
);

1444 
VFPRINTF_FUNC_T
 
fun˘i⁄
 = (VFPRINTF_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_VFPRINTF
);

1445 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1447 i‡(
ègged
)

1448 
	`socks_sysˇŒ_°¨t
(
d
);

1450 
rc
 = 
	`fun˘i⁄
(
°ªam
, 
f‹m©
, 
≠
);

1452 i‡(
ègged
)

1453 
	`socks_sysˇŒ_íd
(
d
);

1455  
rc
;

1456 
	}
}

1458 
HAVE_PROT_FWRITE_0


1459 
	$sys_fwrôe
(
±r
, 
size
, 
nmb
, 
°ªam
)

1460 
HAVE_PROT_FWRITE_1
 
±r
;

1461 
HAVE_PROT_FWRITE_2
 
size
;

1462 
HAVE_PROT_FWRITE_3
 
nmb
;

1463 
HAVE_PROT_FWRITE_4
 
°ªam
;

1465 c⁄° 
d
 = 
	`fûío
(
°ªam
);

1466 
HAVE_PROT_FWRITE_0
 
rc
;

1467 
	`HAVE_PROT_FWRITE_0
 (*
	tFWRITE_FUNC_T
)(
	tHAVE_PROT_FWRITE_1
,

1468 
	tHAVE_PROT_FWRITE_2
,

1469 
	tHAVE_PROT_FWRITE_3
,

1470 
	tHAVE_PROT_FWRITE_4
);

1471 
FWRITE_FUNC_T
 
fun˘i⁄
 = (FWRITE_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_FWRITE
);

1472 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1474 i‡(
ègged
)

1475 
	`socks_sysˇŒ_°¨t
(
d
);

1477 
rc
 = 
	`fun˘i⁄
(
±r
, 
size
, 
nmb
, 
°ªam
);

1479 i‡(
ègged
)

1480 
	`socks_sysˇŒ_íd
(
d
);

1482  
rc
;

1483 
	}
}

1485 
HAVE_PROT_FREAD_0


1486 
	$sys_‰ód
(
±r
, 
size
, 
nmb
, 
°ªam
)

1487 
HAVE_PROT_FREAD_1
 
±r
;

1488 
HAVE_PROT_FREAD_2
 
size
;

1489 
HAVE_PROT_FREAD_3
 
nmb
;

1490 
HAVE_PROT_FREAD_4
 
°ªam
;

1492 c⁄° 
d
 = 
	`fûío
(
°ªam
);

1493 
HAVE_PROT_FREAD_0
 
rc
;

1494 
	`HAVE_PROT_FREAD_0
 (*
	tFREAD_FUNC_T
)(
	tHAVE_PROT_FREAD_1
,

1495 
	tHAVE_PROT_FREAD_2
,

1496 
	tHAVE_PROT_FREAD_3
,

1497 
	tHAVE_PROT_FREAD_4
);

1498 
FREAD_FUNC_T
 
fun˘i⁄
 = (FREAD_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_FREAD
);

1499 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1501 i‡(
ègged
)

1502 
	`socks_sysˇŒ_°¨t
(
d
);

1504 
rc
 = 
	`fun˘i⁄
(
±r
, 
size
, 
nmb
, 
°ªam
);

1506 i‡(
ègged
)

1507 
	`socks_sysˇŒ_íd
(
d
);

1509  
rc
;

1510 
	}
}

1517 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1518 
HAVE_PROT_ACCEPT_0


1519 
	$ac˚±
(
s
, 
addr
, 
addæí
)

1520 
HAVE_PROT_ACCEPT_1
 
s
;

1521 
HAVE_PROT_ACCEPT_2
 
addr
;

1522 
HAVE_PROT_ACCEPT_3
 
addæí
;

1524 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_ACCEPT
))

1525  
	`sys_ac˚±
(
s
, 
addr
, 
addæí
);

1526  
	`Rac˚±
(
s
, 
addr
, (
sockÀn_t
 *)
addæí
);

1527 
	}
}

1530 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1531 
HAVE_PROT_BIND_0


1532 
	$böd
(
s
, 
«me
, 
«mñí
)

1533 
HAVE_PROT_BIND_1
 
s
;

1534 
HAVE_PROT_BIND_2
 
«me
;

1535 
HAVE_PROT_BIND_3
 
«mñí
;

1537 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_BIND
))

1538  
	`sys_böd
(
s
, 
«me
, 
«mñí
);

1539  
	`Rböd
(
s
, 
«me
, 
«mñí
);

1540 
	}
}

1544 
	$bödªsvp‹t
(
sd
, 
sö
)

1545 
sd
;

1546 
sockaddr_ö
 *
sö
;

1548 i‡(
	`socks_issysˇŒ
(
sd
, 
SYMBOL_BINDRESVPORT
))

1549  
	`sys_bödªsvp‹t
(
sd
, 
sö
);

1550  
	`Rbödªsvp‹t
(
sd
, 
sö
);

1551 
	}
}

1553 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1554 
HAVE_PROT_CONNECT_0


1555 
	$c⁄√˘
(
s
, 
«me
, 
«mñí
)

1556 
HAVE_PROT_CONNECT_1
 
s
;

1557 
HAVE_PROT_CONNECT_2
 
«me
;

1558 
HAVE_PROT_CONNECT_3
 
«mñí
;

1560 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_CONNECT
))

1561  
	`sys_c⁄√˘
(
s
, 
«me
, 
«mñí
);

1562  
	`Rc⁄√˘
(
s
, 
«me
, 
«mñí
);

1563 
	}
}

1566 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1567 
HAVE_PROT_GETPEERNAME_0


1568 
	$gë≥î«me
(
s
, 
«me
, 
«mñí
)

1569 
HAVE_PROT_GETPEERNAME_1
 
s
;

1570 
HAVE_PROT_GETPEERNAME_2
 
«me
;

1571 
HAVE_PROT_GETPEERNAME_3
 
«mñí
;

1573 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_GETPEERNAME
))

1574  
	`sys_gë≥î«me
(
s
, 
«me
, 
«mñí
);

1575  
	`Rgë≥î«me
(
s
, 
«me
, 
«mñí
);

1576 
	}
}

1579 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1580 
HAVE_PROT_GETSOCKNAME_0


1581 
	$gësock«me
(
s
, 
«me
, 
«mñí
)

1582 
HAVE_PROT_GETSOCKNAME_1
 
s
;

1583 
HAVE_PROT_GETSOCKNAME_2
 
«me
;

1584 
HAVE_PROT_GETSOCKNAME_3
 
«mñí
;

1586 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_GETSOCKNAME
))

1587  
	`sys_gësock«me
(
s
, 
«me
, 
«mñí
);

1588  
	`Rgësock«me
(
s
, 
«me
, 
«mñí
);

1589 
	}
}

1592 
HAVE_PROT_GETSOCKOPT_0


1593 
	$gësock›t
(
s
, 
Àvñ
, 
›äame
, 
›tvÆ
, 
›éí
)

1594 
HAVE_PROT_GETSOCKOPT_1
 
s
;

1595 
HAVE_PROT_GETSOCKOPT_2
 
Àvñ
;

1596 
HAVE_PROT_GETSOCKOPT_3
 
›äame
;

1597 
HAVE_PROT_GETSOCKOPT_4
 
›tvÆ
;

1598 
HAVE_PROT_GETSOCKOPT_5
 
›éí
;

1600 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_GETSOCKNAME
))

1601  
	`sys_gësock›t
(
s
, 
Àvñ
, 
›äame
, 
›tvÆ
, 
›éí
);

1602  
	`Rgësock›t
(
s
, 
Àvñ
, 
›äame
, 
›tvÆ
, 
›éí
);

1603 
	}
}

1605 
HAVE_PROT_LISTEN_0


1606 
	$li°í
(
s
, 
backlog
)

1607 
HAVE_PROT_LISTEN_1
 
s
;

1608 
HAVE_PROT_LISTEN_2
 
backlog
;

1610 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_LISTEN
))

1611  
	`sys_li°í
(
s
, 
backlog
);

1612  
	`Rli°í
(
s
, 
backlog
);

1613 
	}
}

1615 
HAVE_PROT_READ_0


1616 
	$ªad
(
d
, 
buf
, 
nbyãs
)

1617 
HAVE_PROT_READ_1
 
d
;

1618 
HAVE_PROT_READ_2
 
buf
;

1619 
HAVE_PROT_READ_3
 
nbyãs
;

1621 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_READ
))

1622  
	`sys_ªad
(
d
, 
buf
, 
nbyãs
);

1623  
	`Rªad
(
d
, 
buf
, 
nbyãs
);

1624 
	}
}

1626 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1627 
HAVE_PROT_READV_0


1628 
	$ªadv
(
d
, 
iov
, 
iov˙t
)

1629 
HAVE_PROT_READV_1
 
d
;

1630 
HAVE_PROT_READV_2
 
iov
;

1631 
HAVE_PROT_READV_3
 
iov˙t
;

1633 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_READV
))

1634  
	`sys_ªadv
(
d
, 
iov
, 
iov˙t
);

1635  
	`Rªadv
(
d
, 
iov
, 
iov˙t
);

1636 
	}
}

1639 
HAVE_PROT_RECV_0


1640 
	$ªcv
(
s
, 
msg
, 
Àn
, 
Êags
)

1641 
HAVE_PROT_RECV_1
 
s
;

1642 
HAVE_PROT_RECV_2
 
msg
;

1643 
HAVE_PROT_RECV_3
 
Àn
;

1644 
HAVE_PROT_RECV_4
 
Êags
;

1646 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_RECV
))

1647  
	`sys_ªcv
(
s
, 
msg
, 
Àn
, 
Êags
);

1648  
	`Rªcv
(
s
, 
msg
, 
Àn
, 
Êags
);

1649 
	}
}

1651 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1652 
HAVE_PROT_RECVFROM_0


1653 
	$ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

1654 
HAVE_PROT_RECVFROM_1
 
s
;

1655 
HAVE_PROT_RECVFROM_2
 
buf
;

1656 
HAVE_PROT_RECVFROM_3
 
Àn
;

1657 
HAVE_PROT_RECVFROM_4
 
Êags
;

1658 
HAVE_PROT_RECVFROM_5
 
‰om
;

1659 
HAVE_PROT_RECVFROM_6
 
‰omÀn
;

1661 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_RECVFROM
))

1662  
	`sys_ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

1663  
	`Rªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

1664 
	}
}

1667 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1668 
HAVE_PROT_RECVMSG_0


1669 
	$ªcvmsg
(
s
, 
msg
, 
Êags
)

1670 
HAVE_PROT_RECVMSG_1
 
s
;

1671 
HAVE_PROT_RECVMSG_2
 
msg
;

1672 
HAVE_PROT_RECVMSG_3
 
Êags
;

1674 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_RECVMSG
))

1675  
	`sys_ªcvmsg
(
s
, 
msg
, 
Êags
);

1676  
	`Rªcvmsg
(
s
, 
msg
, 
Êags
);

1677 
	}
}

1680 #i‡
HAVE_RRESVPORT


1682 
	$ºesvp‹t
(
p‹t
)

1683 *
p‹t
;

1685  
	`Rºesvp‹t
(
p‹t
);

1686 
	}
}

1689 
HAVE_PROT_WRITE_0


1690 
	$wrôe
(
d
, 
buf
, 
nbyãs
)

1691 
HAVE_PROT_WRITE_1
 
d
;

1692 
HAVE_PROT_WRITE_2
 
buf
;

1693 
HAVE_PROT_WRITE_3
 
nbyãs
;

1695 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_WRITE
))

1696  
	`sys_wrôe
(
d
, 
buf
, 
nbyãs
);

1697  
	`Rwrôe
(
d
, 
buf
, 
nbyãs
);

1698 
	}
}

1700 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1701 
HAVE_PROT_WRITEV_0


1702 
	$wrôev
(
d
, 
iov
, 
iov˙t
)

1703 
HAVE_PROT_WRITEV_1
 
d
;

1704 
HAVE_PROT_WRITEV_2
 
iov
;

1705 
HAVE_PROT_WRITEV_3
 
iov˙t
;

1707 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_WRITEV
))

1708  
	`sys_wrôev
(
d
, 
iov
, 
iov˙t
);

1709  
	`Rwrôev
(
d
, 
iov
, 
iov˙t
);

1710 
	}
}

1713 
HAVE_PROT_SEND_0


1714 
	$£nd
(
s
, 
msg
, 
Àn
, 
Êags
)

1715 
HAVE_PROT_SEND_1
 
s
;

1716 
HAVE_PROT_SEND_2
 
msg
;

1717 
HAVE_PROT_SEND_3
 
Àn
;

1718 
HAVE_PROT_SEND_4
 
Êags
;

1720 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_SEND
))

1721  
	`sys_£nd
(
s
, 
msg
, 
Àn
, 
Êags
);

1722  
	`R£nd
(
s
, 
msg
, 
Àn
, 
Êags
);

1723 
	}
}

1725 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1726 
HAVE_PROT_SENDMSG_0


1727 
	$£ndmsg
(
s
, 
msg
, 
Êags
)

1728 
HAVE_PROT_SENDMSG_1
 
s
;

1729 
HAVE_PROT_SENDMSG_2
 
msg
;

1730 
HAVE_PROT_SENDMSG_3
 
Êags
;

1732 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_SENDMSG
))

1733  
	`sys_£ndmsg
(
s
, 
msg
, 
Êags
);

1734  
	`R£ndmsg
(
s
, 
msg
, 
Êags
);

1735 
	}
}

1738 #i‡!
HAVE_EXTRA_OSF_SYMBOLS


1739 
HAVE_PROT_SENDTO_0


1740 
	$£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

1741 
HAVE_PROT_SENDTO_1
 
s
;

1742 
HAVE_PROT_SENDTO_2
 
msg
;

1743 
HAVE_PROT_SENDTO_3
 
Àn
;

1744 
HAVE_PROT_SENDTO_4
 
Êags
;

1745 
HAVE_PROT_SENDTO_5
 
to
;

1746 
HAVE_PROT_SENDTO_6
 
tﬁí
;

1748 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_SENDTO
))

1749  
	`sys_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

1750  
	`R£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

1751 
	}
}

1754 #ifde‡
__sun


1757 
HAVE_PROT_BIND_0


1758 
	$sys_x√t_böd
(
s
, 
«me
, 
«mñí
)

1759 
HAVE_PROT_BIND_1
 
s
;

1760 
HAVE_PROT_BIND_2
 
«me
;

1761 
HAVE_PROT_BIND_3
 
«mñí
;

1763 
rc
;

1764 
	`HAVE_PROT_BIND_0
 (*
	tBIND_FUNC_T
)(
	tHAVE_PROT_BIND_1
,

1765 
	tHAVE_PROT_BIND_2
,

1766 
	tHAVE_PROT_BIND_3
);

1767 
BIND_FUNC_T
 
fun˘i⁄
 = (BIND_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_XNET_BIND
);

1768 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1770 i‡(
ègged
)

1771 
	`socks_sysˇŒ_°¨t
(
s
);

1773 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

1775 i‡(
ègged
)

1776 
	`socks_sysˇŒ_íd
(
s
);

1778  
rc
;

1779 
	}
}

1781 
HAVE_PROT_BIND_0


1782 
	$__x√t_böd
(
s
, 
«me
, 
«mñí
)

1783 
HAVE_PROT_BIND_1
 
s
;

1784 
HAVE_PROT_BIND_2
 
«me
;

1785 
HAVE_PROT_BIND_3
 
«mñí
;

1787 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_XNET_BIND
))

1788  
	`sys_x√t_böd
(
s
, 
«me
, 
«mñí
);

1789  
	`Rböd
(
s
, 
«me
, 
«mñí
);

1790 
	}
}

1792 
HAVE_PROT_CONNECT_0


1793 
	$sys_x√t_c⁄√˘
(
s
, 
«me
, 
«mñí
)

1794 
HAVE_PROT_CONNECT_1
 
s
;

1795 
HAVE_PROT_CONNECT_2
 
«me
;

1796 
HAVE_PROT_CONNECT_3
 
«mñí
;

1798 
rc
;

1799 
	`HAVE_PROT_CONNECT_0
 (*
	tCONNECT_FUNC_T
)(
	tHAVE_PROT_CONNECT_1
,

1800 
	tHAVE_PROT_CONNECT_2
,

1801 
	tHAVE_PROT_CONNECT_3
);

1802 
CONNECT_FUNC_T
 
fun˘i⁄


1803 (
CONNECT_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_XNET_CONNECT
);

1804 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1806 i‡(
ègged
)

1807 
	`socks_sysˇŒ_°¨t
(
s
);

1809 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

1811 i‡(
ègged
)

1812 
	`socks_sysˇŒ_íd
(
s
);

1814  
rc
;

1815 
	}
}

1817 
HAVE_PROT_CONNECT_0


1818 
	$__x√t_c⁄√˘
(
s
, 
«me
, 
«mñí
)

1819 
HAVE_PROT_CONNECT_1
 
s
;

1820 
HAVE_PROT_CONNECT_2
 
«me
;

1821 
HAVE_PROT_CONNECT_3
 
«mñí
;

1823 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_XNET_CONNECT
))

1824  
	`sys_x√t_c⁄√˘
(
s
, 
«me
, 
«mñí
);

1825  
	`Rc⁄√˘
(
s
, 
«me
, 
«mñí
);

1826 
	}
}

1828 
HAVE_PROT_LISTEN_0


1829 
	$sys_x√t_li°í
(
s
, 
backlog
)

1830 
HAVE_PROT_LISTEN_1
 
s
;

1831 
HAVE_PROT_LISTEN_2
 
backlog
;

1833 
HAVE_PROT_LISTEN_0
 
rc
;

1834 
	`HAVE_PROT_LISTEN_0
 (*
	tLISTEN_FUNC_T
)(
	tHAVE_PROT_LISTEN_1
,

1835 
	tHAVE_PROT_LISTEN_2
);

1836 
LISTEN_FUNC_T
 
fun˘i⁄
 = (LISTEN_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_XNET_LISTEN
);

1837 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1839 i‡(
ègged
)

1840 
	`socks_sysˇŒ_°¨t
(
s
);

1842 
rc
 = 
	`fun˘i⁄
(
s
, 
backlog
);

1844 i‡(
ègged
)

1845 
	`socks_sysˇŒ_íd
(
s
);

1847  
rc
;

1848 
	}
}

1850 
HAVE_PROT_LISTEN_0


1851 
	$__x√t_li°í
(
s
, 
backlog
)

1852 
HAVE_PROT_LISTEN_1
 
s
;

1853 
HAVE_PROT_LISTEN_2
 
backlog
;

1855 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_XNET_LISTEN
))

1856  
	`sys_x√t_li°í
(
s
, 
backlog
);

1857  
	`Rli°í
(
s
, 
backlog
);

1858 
	}
}

1860 
HAVE_PROT_RECVMSG_0


1861 
	$sys_x√t_ªcvmsg
(
s
, 
msg
, 
Êags
)

1862 
HAVE_PROT_RECVMSG_1
 
s
;

1863 
HAVE_PROT_RECVMSG_2
 
msg
;

1864 
HAVE_PROT_RECVMSG_3
 
Êags
;

1866 
ssize_t
 
rc
;

1867 
	`HAVE_PROT_RECVMSG_0
 (*
	tRECVMSG_FUNC_T
)(
	tHAVE_PROT_RECVMSG_1
,

1868 
	tHAVE_PROT_RECVMSG_2
,

1869 
	tHAVE_PROT_RECVMSG_3
);

1870 
RECVMSG_FUNC_T
 
fun˘i⁄


1871 (
RECVMSG_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_XNET_RECVMSG
);

1872 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1874 i‡(
ègged
)

1875 
	`socks_sysˇŒ_°¨t
(
s
);

1877 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

1879 i‡(
ègged
)

1880 
	`socks_sysˇŒ_íd
(
s
);

1882  
rc
;

1883 
	}
}

1885 
HAVE_PROT_RECVMSG_0


1886 
	$__x√t_ªcvmsg
(
s
, 
msg
, 
Êags
)

1887 
HAVE_PROT_RECVMSG_1
 
s
;

1888 
HAVE_PROT_RECVMSG_2
 
msg
;

1889 
HAVE_PROT_RECVMSG_3
 
Êags
;

1891 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_XNET_RECVMSG
))

1892  
	`sys_x√t_ªcvmsg
(
s
, 
msg
, 
Êags
);

1893  
	`Rªcvmsg
(
s
, 
msg
, 
Êags
);

1894 
	}
}

1896 
HAVE_PROT_SENDMSG_0


1897 
	$sys_x√t_£ndmsg
(
s
, 
msg
, 
Êags
)

1898 
HAVE_PROT_SENDMSG_1
 
s
;

1899 
HAVE_PROT_SENDMSG_2
 
msg
;

1900 
HAVE_PROT_SENDMSG_3
 
Êags
;

1902 
ssize_t
 
rc
;

1903 
	`HAVE_PROT_SENDMSG_0
 (*
	tSENDMSG_FUNC_T
)(
	tHAVE_PROT_SENDMSG_1
,

1904 
	tHAVE_PROT_SENDMSG_2
,

1905 
	tHAVE_PROT_SENDMSG_3
);

1906 
SENDMSG_FUNC_T
 
fun˘i⁄


1907 (
SENDMSG_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_XNET_SENDMSG
);

1908 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1910 i‡(
ègged
)

1911 
	`socks_sysˇŒ_°¨t
(
s
);

1913 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Êags
);

1915 i‡(
ègged
)

1916 
	`socks_sysˇŒ_íd
(
s
);

1918  
rc
;

1919 
	}
}

1921 
HAVE_PROT_SENDMSG_0


1922 
	$__x√t_£ndmsg
(
s
, 
msg
, 
Êags
)

1923 
HAVE_PROT_SENDMSG_1
 
s
;

1924 
HAVE_PROT_SENDMSG_2
 
msg
;

1925 
HAVE_PROT_SENDMSG_3
 
Êags
;

1927 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_XNET_SENDMSG
))

1928  
	`sys_x√t_£ndmsg
(
s
, 
msg
, 
Êags
);

1929  
	`R£ndmsg
(
s
, 
msg
, 
Êags
);

1930 
	}
}

1932 
HAVE_PROT_SENDTO_0


1933 
	$sys_x√t_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

1934 
HAVE_PROT_SENDTO_1
 
s
;

1935 
HAVE_PROT_SENDTO_2
 
msg
;

1936 
HAVE_PROT_SENDTO_3
 
Àn
;

1937 
HAVE_PROT_SENDTO_4
 
Êags
;

1938 
HAVE_PROT_SENDTO_5
 
to
;

1939 
HAVE_PROT_SENDTO_6
 
tﬁí
;

1941 
ssize_t
 
rc
;

1942 
	`HAVE_PROT_SENDTO_0
 (*
	tSENDTO_FUNC_T
)(
	tHAVE_PROT_SENDTO_1
,

1943 
	tHAVE_PROT_SENDTO_2
,

1944 
	tHAVE_PROT_SENDTO_3
,

1945 
	tHAVE_PROT_SENDTO_4
,

1946 
	tHAVE_PROT_SENDTO_5
,

1947 
	tHAVE_PROT_SENDTO_6
);

1948 
SENDTO_FUNC_T
 
fun˘i⁄
 = (SENDTO_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_XNET_SENDTO
);

1949 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

1951 i‡(
ègged
)

1952 
	`socks_sysˇŒ_°¨t
(
s
);

1954 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

1956 i‡(
ègged
)

1957 
	`socks_sysˇŒ_íd
(
s
);

1959  
rc
;

1960 
	}
}

1962 
HAVE_PROT_SENDTO_0


1963 
	$__x√t_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

1964 
HAVE_PROT_SENDTO_1
 
s
;

1965 
HAVE_PROT_SENDTO_2
 
msg
;

1966 
HAVE_PROT_SENDTO_3
 
Àn
;

1967 
HAVE_PROT_SENDTO_4
 
Êags
;

1968 
HAVE_PROT_SENDTO_5
 
to
;

1969 
HAVE_PROT_SENDTO_6
 
tﬁí
;

1971 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_XNET_SENDTO
))

1972  
	`sys_x√t_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

1973  
	`R£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

1974 
	}
}

1978 #ifde‡
__FªeBSD__


1979 
HAVE_PROT_ACCEPT_0


1980 
	$_ac˚±
(
s
, 
addr
, 
addæí
)

1981 
HAVE_PROT_ACCEPT_1
 
s
;

1982 
HAVE_PROT_ACCEPT_2
 
addr
;

1983 
HAVE_PROT_ACCEPT_3
 
addæí
;

1985 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_ACCEPT
))

1986  
	`sys_ac˚±
(
s
, 
addr
, 
addæí
);

1987  
	`Rac˚±
(
s
, 
addr
, (
sockÀn_t
 *)
addæí
);

1988 
	}
}

1990 
HAVE_PROT_BIND_0


1991 
	$_böd
(
s
, 
«me
, 
«mñí
)

1992 
HAVE_PROT_BIND_1
 
s
;

1993 
HAVE_PROT_BIND_2
 
«me
;

1994 
HAVE_PROT_BIND_3
 
«mñí
;

1996 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_BIND
))

1997  
	`sys_böd
(
s
, 
«me
, 
«mñí
);

1998  
	`Rböd
(
s
, 
«me
, 
«mñí
);

1999 
	}
}

2001 
HAVE_PROT_CONNECT_0


2002 
	$_c⁄√˘
(
s
, 
«me
, 
«mñí
)

2003 
HAVE_PROT_CONNECT_1
 
s
;

2004 
HAVE_PROT_CONNECT_2
 
«me
;

2005 
HAVE_PROT_CONNECT_3
 
«mñí
;

2007 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_CONNECT
))

2008  
	`sys_c⁄√˘
(
s
, 
«me
, 
«mñí
);

2009  
	`Rc⁄√˘
(
s
, 
«me
, 
«mñí
);

2010 
	}
}

2012 
HAVE_PROT_GETPEERNAME_0


2013 
	$_gë≥î«me
(
s
, 
«me
, 
«mñí
)

2014 
HAVE_PROT_GETPEERNAME_1
 
s
;

2015 
HAVE_PROT_GETPEERNAME_2
 
«me
;

2016 
HAVE_PROT_GETPEERNAME_3
 
«mñí
;

2018 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_GETPEERNAME
))

2019  
	`sys_gë≥î«me
(
s
, 
«me
, 
«mñí
);

2020  
	`Rgë≥î«me
(
s
, 
«me
, 
«mñí
);

2021 
	}
}

2023 
HAVE_PROT_GETSOCKNAME_0


2024 
	$_gësock«me
(
s
, 
«me
, 
«mñí
)

2025 
HAVE_PROT_GETSOCKNAME_1
 
s
;

2026 
HAVE_PROT_GETSOCKNAME_2
 
«me
;

2027 
HAVE_PROT_GETSOCKNAME_3
 
«mñí
;

2029 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_GETSOCKNAME
))

2030  
	`sys_gësock«me
(
s
, 
«me
, 
«mñí
);

2031  
	`Rgësock«me
(
s
, 
«me
, 
«mñí
);

2032 
	}
}

2034 
HAVE_PROT_LISTEN_0


2035 
	$_li°í
(
s
, 
backlog
)

2036 
HAVE_PROT_LISTEN_1
 
s
;

2037 
HAVE_PROT_LISTEN_2
 
backlog
;

2039 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_LISTEN
))

2040  
	`sys_li°í
(
s
, 
backlog
);

2041  
	`Rli°í
(
s
, 
backlog
);

2042 
	}
}

2044 
HAVE_PROT_READ_0


2045 
	$_ªad
(
d
, 
buf
, 
nbyãs
)

2046 
HAVE_PROT_READ_1
 
d
;

2047 
HAVE_PROT_READ_2
 
buf
;

2048 
HAVE_PROT_READ_3
 
nbyãs
;

2050 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_READ
))

2051  
	`sys_ªad
(
d
, 
buf
, 
nbyãs
);

2052  
	`Rªad
(
d
, 
buf
, 
nbyãs
);

2053 
	}
}

2055 
HAVE_PROT_READV_0


2056 
	$_ªadv
(
d
, 
iov
, 
iov˙t
)

2057 
HAVE_PROT_READV_1
 
d
;

2058 
HAVE_PROT_READV_2
 
iov
;

2059 
HAVE_PROT_READV_3
 
iov˙t
;

2061 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_READV
))

2062  
	`sys_ªadv
(
d
, 
iov
, 
iov˙t
);

2063  
	`Rªadv
(
d
, 
iov
, 
iov˙t
);

2064 
	}
}

2066 
HAVE_PROT_RECV_0


2067 
	$_ªcv
(
s
, 
msg
, 
Àn
, 
Êags
)

2068 
HAVE_PROT_RECV_1
 
s
;

2069 
HAVE_PROT_RECV_2
 
msg
;

2070 
HAVE_PROT_RECV_3
 
Àn
;

2071 
HAVE_PROT_RECV_4
 
Êags
;

2073 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_RECV
))

2074  
	`sys_ªcv
(
s
, 
msg
, 
Àn
, 
Êags
);

2075  
	`Rªcv
(
s
, 
msg
, 
Àn
, 
Êags
);

2076 
	}
}

2078 
HAVE_PROT_RECVFROM_0


2079 
	$_ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

2080 
HAVE_PROT_RECVFROM_1
 
s
;

2081 
HAVE_PROT_RECVFROM_2
 
buf
;

2082 
HAVE_PROT_RECVFROM_3
 
Àn
;

2083 
HAVE_PROT_RECVFROM_4
 
Êags
;

2084 
HAVE_PROT_RECVFROM_5
 
‰om
;

2085 
HAVE_PROT_RECVFROM_6
 
‰omÀn
;

2087 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_RECVFROM
))

2088  
	`sys_ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

2089  
	`Rªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

2090 
	}
}

2092 
HAVE_PROT_RECVMSG_0


2093 
	$_ªcvmsg
(
s
, 
msg
, 
Êags
)

2094 
HAVE_PROT_RECVMSG_1
 
s
;

2095 
HAVE_PROT_RECVMSG_2
 
msg
;

2096 
HAVE_PROT_RECVMSG_3
 
Êags
;

2098 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_RECVMSG
))

2099  
	`sys_ªcvmsg
(
s
, 
msg
, 
Êags
);

2100  
	`Rªcvmsg
(
s
, 
msg
, 
Êags
);

2101 
	}
}

2103 
HAVE_PROT_WRITE_0


2104 
	$_wrôe
(
d
, 
buf
, 
nbyãs
)

2105 
HAVE_PROT_WRITE_1
 
d
;

2106 
HAVE_PROT_WRITE_2
 
buf
;

2107 
HAVE_PROT_WRITE_3
 
nbyãs
;

2109 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_WRITE
))

2110  
	`sys_wrôe
(
d
, 
buf
, 
nbyãs
);

2111  
	`Rwrôe
(
d
, 
buf
, 
nbyãs
);

2112 
	}
}

2114 
HAVE_PROT_WRITEV_0


2115 
	$_wrôev
(
d
, 
iov
, 
iov˙t
)

2116 
HAVE_PROT_WRITEV_1
 
d
;

2117 
HAVE_PROT_WRITEV_2
 
iov
;

2118 
HAVE_PROT_WRITEV_3
 
iov˙t
;

2120 i‡(
	`socks_issysˇŒ
(
d
, 
SYMBOL_WRITEV
))

2121  
	`sys_wrôev
(
d
, 
iov
, 
iov˙t
);

2122  
	`Rwrôev
(
d
, 
iov
, 
iov˙t
);

2123 
	}
}

2125 
HAVE_PROT_SEND_0


2126 
	$_£nd
(
s
, 
msg
, 
Àn
, 
Êags
)

2127 
HAVE_PROT_SEND_1
 
s
;

2128 
HAVE_PROT_SEND_2
 
msg
;

2129 
HAVE_PROT_SEND_3
 
Àn
;

2130 
HAVE_PROT_SEND_4
 
Êags
;

2132 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_SEND
))

2133  
	`sys_£nd
(
s
, 
msg
, 
Àn
, 
Êags
);

2134  
	`R£nd
(
s
, 
msg
, 
Àn
, 
Êags
);

2135 
	}
}

2137 
HAVE_PROT_SENDMSG_0


2138 
	$_£ndmsg
(
s
, 
msg
, 
Êags
)

2139 
HAVE_PROT_SENDMSG_1
 
s
;

2140 
HAVE_PROT_SENDMSG_2
 
msg
;

2141 
HAVE_PROT_SENDMSG_3
 
Êags
;

2143 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_SENDMSG
))

2144  
	`sys_£ndmsg
(
s
, 
msg
, 
Êags
);

2145  
	`R£ndmsg
(
s
, 
msg
, 
Êags
);

2146 
	}
}

2148 
HAVE_PROT_SENDTO_0


2149 
	$_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

2150 
HAVE_PROT_SENDTO_1
 
s
;

2151 
HAVE_PROT_SENDTO_2
 
msg
;

2152 
HAVE_PROT_SENDTO_3
 
Àn
;

2153 
HAVE_PROT_SENDTO_4
 
Êags
;

2154 
HAVE_PROT_SENDTO_5
 
to
;

2155 
HAVE_PROT_SENDTO_6
 
tﬁí
;

2157 i‡(
	`socks_issysˇŒ
(
s
, 
SYMBOL_SENDTO
))

2158  
	`sys_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

2159  
	`R£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

2160 
	}
}

2165 #i‡!
SOCKS_CLIENT


2172 
ho°ít
 *

2173 
	$sys_gëho°byaddr
(
addr
, 
Àn
, 
af
)

2174 c⁄° *
addr
;

2175 
sockÀn_t
 
Àn
;

2176 
af
;

2178 
ho°ít
 *(*
	tGETHOSTBYADDR_FUNC_T
)(const *, , );

2179 
GETHOSTBYADDR_FUNC_T
 
fun˘i⁄


2180 (
GETHOSTBYADDR_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_GETHOSTBYADDR
);

2182  
	`fun˘i⁄
(
addr
, 
Àn
, 
af
);

2183 
	}
}

2185 
HAVE_PROT_GETHOSTBYADDR_0


2186 
	$gëho°byaddr
(
addr
, 
Àn
, 
af
)

2187 
HAVE_PROT_GETHOSTBYADDR_1
 
addr
;

2188 
HAVE_PROT_GETHOSTBYADDR_2
 
Àn
;

2189 
HAVE_PROT_GETHOSTBYADDR_3
 
af
;

2192 i‡(
	`socks_shouldˇŒa¢©ive
(
SYMBOL_GETHOSTBYADDR
))

2193  
	`sys_gëho°byaddr
(
addr
, 
Àn
, 
af
);

2194  
	`cgëho°byaddr
(
addr
, 
Àn
, 
af
);

2195 
	}
}

2199 
ho°ít
 *

2200 
	$sys_gëho°by«me
(
«me
)

2201 c⁄° *
«me
;

2203 
ho°ít
 *
rc
;

2204 
ho°ít
 *(*
	tGETHOSTBYNAME_FUNC_T
)(const *);

2205 
GETHOSTBYNAME_FUNC_T
 
fun˘i⁄


2206 (
GETHOSTBYNAME_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_GETHOSTBYNAME
);

2208 
	`DNSCODE_START
();

2209 
rc
 = 
	`fun˘i⁄
(
«me
);

2210 
	`DNSCODE_END
();

2212  
rc
;

2213 
	}
}

2215 
ho°ít
 *

2216 
	$gëho°by«me
(
«me
)

2217 c⁄° *
«me
;

2219 #i‡!
SOCKS_CLIENT


2220  
	`cgëho°by«me
(
«me
);

2223 i‡(
	`socks_shouldˇŒa¢©ive
(
SYMBOL_GETHOSTBYNAME
)) {

2224 
ho°ít
 *
rc
;

2226 
	`DNSCODE_START
();

2227 
rc
 = 
	`sys_gëho°by«me
(
«me
);

2228 
	`DNSCODE_END
();

2230  
rc
;

2233  
	`Rgëho°by«me
(
«me
);

2235 
	}
}

2237 #i‡
SOCKS_CLIENT


2239 #i‡
HAVE_GETADDRINFO


2241 
	$sys_gëaddröfo
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
)

2242 c⁄° *
nodíame
;

2243 c⁄° *
£rv«me
;

2244 c⁄° 
addröfo
 *
höts
;

2245 
addröfo
 **
ªs
;

2247 (*
	tGETADDRINFO_FUNC_T
)(const *, const *,

2248 c⁄° 
	taddröfo
 *,

2249 
	taddröfo
 **);

2250 
GETADDRINFO_FUNC_T
 
fun˘i⁄


2251 (
GETADDRINFO_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_GETADDRINFO
);

2252 
rc
;

2254 
	`DNSCODE_START
();

2255 
rc
 = 
	`fun˘i⁄
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
);

2256 
	`DNSCODE_END
();

2258  
rc
;

2259 
	}
}

2262 
	$gëaddröfo
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
)

2263 c⁄° *
nodíame
;

2264 c⁄° *
£rv«me
;

2265 c⁄° 
addröfo
 *
höts
;

2266 
addröfo
 **
ªs
;

2268 
rc
;

2270 i‡(
	`socks_shouldˇŒa¢©ive
(
SYMBOL_GETADDRINFO
)) {

2271 
	`DNSCODE_START
();

2272 
rc
 = 
	`sys_gëaddröfo
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
);

2273 
	`DNSCODE_END
();

2275  
rc
;

2278  
	`Rgëaddröfo
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
);

2279 
	}
}

2283 #i‡
HAVE_GETNAMEINFO
 && !
SOCKS_CLIENT


2284 
HAVE_PROT_GETNAMEINFO_0


2285 
	$sys_gë«meöfo
(
ß
, 
ßÀn
, 
ho°
, 
ho°Àn
, 
£rv
, 
£rvÀn
, 
Êags
)

2286 
HAVE_PROT_GETNAMEINFO_1
 
ß
;

2287 
HAVE_PROT_GETNAMEINFO_2
 
ßÀn
;

2288 
HAVE_PROT_GETNAMEINFO_3
 
ho°
;

2289 
HAVE_PROT_GETNAMEINFO_4
 
ho°Àn
;

2290 
HAVE_PROT_GETNAMEINFO_5
 
£rv
;

2291 
HAVE_PROT_GETNAMEINFO_6
 
£rvÀn
;

2292 
HAVE_PROT_GETNAMEINFO_7
 
Êags
;

2294 
	`HAVE_PROT_GETNAMEINFO_0
 (*
	tGETNAMEINFO_FUNC_T
)(

2295 
	tHAVE_PROT_GETNAMEINFO_1
,

2296 
	tHAVE_PROT_GETNAMEINFO_2
,

2297 
	tHAVE_PROT_GETNAMEINFO_3
,

2298 
	tHAVE_PROT_GETNAMEINFO_4
,

2299 
	tHAVE_PROT_GETNAMEINFO_5
,

2300 
	tHAVE_PROT_GETNAMEINFO_6
,

2301 
	tHAVE_PROT_GETNAMEINFO_7
);

2302 
GETNAMEINFO_FUNC_T
 
fun˘i⁄


2303 (
GETNAMEINFO_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_GETNAMEINFO
);

2304 
rc
;

2306 
	`DNSCODE_START
();

2307 
rc
 = 
	`fun˘i⁄
(
ß
, 
ßÀn
, 
ho°
, 
ho°Àn
, 
£rv
, 
£rvÀn
, 
Êags
);

2308 
	`DNSCODE_END
();

2310  
rc
;

2311 
	}
}

2313 
HAVE_PROT_GETNAMEINFO_0


2314 
	$gë«meöfo
(
ß
, 
ßÀn
, 
ho°
, 
ho°Àn
, 
£rv
, 
£rvÀn
, 
Êags
)

2315 
HAVE_PROT_GETNAMEINFO_1
 
ß
;

2316 
HAVE_PROT_GETNAMEINFO_2
 
ßÀn
;

2317 
HAVE_PROT_GETNAMEINFO_3
 
ho°
;

2318 
HAVE_PROT_GETNAMEINFO_4
 
ho°Àn
;

2319 
HAVE_PROT_GETNAMEINFO_5
 
£rv
;

2320 
HAVE_PROT_GETNAMEINFO_6
 
£rvÀn
;

2321 
HAVE_PROT_GETNAMEINFO_7
 
Êags
;

2323 i‡(
	`socks_shouldˇŒa¢©ive
(
SYMBOL_GETNAMEINFO
)) {

2324 
rc
;

2326 
	`DNSCODE_START
();

2327 
rc
 = 
	`sys_gë«meöfo
(
ß
, 
ßÀn
, 
ho°
, 
ho°Àn
, 
£rv
, 
£rvÀn
,

2328 
Êags
);

2329 
	`DNSCODE_END
();

2331  
rc
;

2334  
	`Rgë«meöfo
(
ß
, 
ßÀn
, 
ho°
, 
ho°Àn
, 
£rv
, 
£rvÀn
, 
Êags
);

2335 
	}
}

2339 
ho°ít
 *

2340 
	$sys_gëho°by«me2
(
«me
, 
af
)

2341 c⁄° *
«me
;

2342 
af
;

2344 
ho°ít
 *
rc
;

2345 
ho°ít
 *(*
	tGETHOSTBYNAME2_FUNC_T
)(const *, );

2346 
GETHOSTBYNAME2_FUNC_T
 
fun˘i⁄


2347 (
GETHOSTBYNAME2_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_GETHOSTBYNAME2
);

2349 
	`DNSCODE_START
();

2350 
rc
 = 
	`fun˘i⁄
(
«me
, 
af
);

2351 
	`DNSCODE_END
();

2353  
rc
;

2354 
	}
}

2356 
ho°ít
 *

2357 
	$gëho°by«me2
(
«me
, 
af
)

2358 c⁄° *
«me
;

2359 
af
;

2361 i‡(
	`socks_shouldˇŒa¢©ive
(
SYMBOL_GETHOSTBYNAME2
)) {

2362 
ho°ít
 *
rc
;

2364 
	`DNSCODE_START
();

2365 
rc
 = 
	`sys_gëho°by«me2
(
«me
, 
af
);

2366 
	`DNSCODE_END
();

2368  
rc
;

2371  
	`Rgëho°by«me2
(
«me
, 
af
);

2372 
	}
}

2374 #i‡
HAVE_GETIPNODEBYNAME


2376 
ho°ít
 *

2377 
	$sys_gëùnodeby«me
(
«me
, 
af
, 
Êags
, 
îr‹_num
)

2378 c⁄° *
«me
;

2379 
af
;

2380 
Êags
;

2381 *
îr‹_num
;

2383 
ho°ít
 *
rc
;

2384 
ho°ít
 *(*
	tGETIPNODEBYNAME_FUNC_T
)(const *, , ,

2386 
GETIPNODEBYNAME_FUNC_T
 
fun˘i⁄


2387 (
GETIPNODEBYNAME_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_GETIPNODEBYNAME
);

2389 
	`DNSCODE_START
();

2390 
rc
 = 
	`fun˘i⁄
(
«me
, 
af
, 
Êags
, 
îr‹_num
);

2391 
	`DNSCODE_END
();

2393  
rc
;

2395 
	}
}

2397 
ho°ít
 *

2398 
	$gëùnodeby«me
(
«me
, 
af
, 
Êags
, 
îr‹_num
)

2399 c⁄° *
«me
;

2400 
af
;

2401 
Êags
;

2402 *
îr‹_num
;

2405 i‡(
	`socks_shouldˇŒa¢©ive
(
SYMBOL_GETIPNODEBYNAME
)) {

2406 
ho°ít
 *
rc
;

2408 
	`DNSCODE_START
();

2409 
rc
 = 
	`sys_gëùnodeby«me
(
«me
, 
af
, 
Êags
, 
îr‹_num
);

2410 
	`DNSCODE_END
();

2412  
rc
;

2415  
	`Rgëùnodeby«me
(
«me
, 
af
, 
Êags
, 
îr‹_num
);

2416 
	}
}

2419 
	$sys_‰ìho°ít
(
±r
)

2420 
ho°ít
 *
±r
;

2422 
ho°ít
 *(*
	tFREEHOSTENT_FUNC_T
)(
	tho°ít
 *);

2424 
FREEHOSTENT_FUNC_T
 
fun˘i⁄


2425 (
FREEHOSTENT_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_FREEHOSTENT
);

2427 
	`fun˘i⁄
(
±r
);

2428 
	}
}

2431 
	$‰ìho°ít
(
±r
)

2432 
ho°ít
 *
±r
;

2435 i‡(
	`socks_shouldˇŒa¢©ive
(
SYMBOL_FREEHOSTENT
))

2436 
	`sys_‰ìho°ít
(
±r
);

2438 
	`R‰ìho°ít
(
±r
);

2439 
	}
}

2443 #i‡
HAVE_GSSAPI
 && 
HAVE_LINUX_GLIBC_WORKAROUND


2445 #ifde‡
gëc


2446 #unde‡
gëc


2448 
HAVE_PROT_GETC_0


2449 
	$gëc
(
°ªam
)

2450 
HAVE_PROT_GETC_1
 
°ªam
;

2452 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2454 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_GETC
))

2455  
	`sys_gëc
(
°ªam
);

2456  
	`Rfgëc
(
°ªam
);

2457 
	}
}

2459 #i‡
HAVE__IO_GETC


2460 
HAVE_PROT__IO_GETC_0


2461 
	$_IO_gëc
(
°ªam
)

2462 
HAVE_PROT__IO_GETC_1
 
°ªam
;

2464 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2466 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL__IO_GETC
))

2467  
	`sys_gëc
(
°ªam
);

2468  
	`Rfgëc
(
°ªam
);

2469 
	}
}

2472 
HAVE_PROT_FGETC_0


2473 
	$fgëc
(
°ªam
)

2474 
HAVE_PROT_FGETC_1
 
°ªam
;

2476 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2478 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_FGETC
))

2479  
	`sys_gëc
(
°ªam
);

2480  
	`Rfgëc
(
°ªam
);

2481 
	}
}

2483 
HAVE_PROT_GETS_0


2484 
	$gës
(
buf
)

2485 
HAVE_PROT_GETS_1
 
buf
;

2487 c⁄° 
d
 = 
	`fûío
(
°dö
);

2489 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_GETS
))

2490  
	`sys_gës
(
buf
);

2491  
	`Rgës
(
buf
);

2492 
	}
}

2494 
HAVE_PROT_FGETS_0


2495 
	$fgës
(
buf
, 
size
, 
°ªam
)

2496 
HAVE_PROT_FGETS_1
 
buf
;

2497 
HAVE_PROT_FGETS_2
 
size
;

2498 
HAVE_PROT_FGETS_3
 
°ªam
;

2500 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2502 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_FGETS
))

2503  
	`sys_fgës
(
buf
, 
size
, 
°ªam
);

2504  
	`Rfgës
(
buf
, 
size
, 
°ªam
);

2505 
	}
}

2507 
HAVE_PROT_PUTC_0


2508 
	$putc
(
c
, 
°ªam
)

2509 
HAVE_PROT_PUTC_1
 
c
;

2510 
HAVE_PROT_PUTC_2
 
°ªam
;

2512 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2514 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_PUTC
))

2515  
	`sys_putc
(
c
, 
°ªam
);

2516  
	`RÂutc
(
c
, 
°ªam
);

2517 
	}
}

2519 #i‡
HAVE__IO_PUTC


2520 
HAVE_PROT__IO_PUTC_0


2521 
	$_IO_putc
(
c
, 
°ªam
)

2522 
HAVE_PROT__IO_PUTC_1
 
c
;

2523 
HAVE_PROT__IO_PUTC_2
 
°ªam
;

2525 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2527 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL__IO_PUTC
))

2528  
	`sys_putc
(
c
, 
°ªam
);

2529  
	`RÂutc
(
c
, 
°ªam
);

2530 
	}
}

2533 
HAVE_PROT_FPUTC_0


2534 
	$Âutc
(
c
, 
°ªam
)

2535 
HAVE_PROT_FPUTC_1
 
c
;

2536 
HAVE_PROT_FPUTC_2
 
°ªam
;

2538 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2540 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_FPUTC
))

2541  
	`sys_Âutc
(
c
, 
°ªam
);

2542  
	`RÂutc
(
c
, 
°ªam
);

2543 
	}
}

2545 
HAVE_PROT_PUTS_0


2546 
	$puts
(
buf
)

2547 
HAVE_PROT_PUTS_1
 
buf
;

2549 c⁄° 
d
 = 
	`fûío
(
°dout
);

2551 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_PUTS
))

2552  
	`sys_puts
(
buf
);

2553  
	`RÂuts
(
buf
, 
°dout
);

2554 
	}
}

2556 
HAVE_PROT_FPUTS_0


2557 
	$Âuts
(
buf
, 
°ªam
)

2558 
HAVE_PROT_FPUTS_1
 
buf
;

2559 
HAVE_PROT_FPUTS_2
 
°ªam
;

2561 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2563 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_FPUTS
))

2564  
	`sys_Âuts
(
buf
, 
°ªam
);

2565  
	`RÂuts
(
buf
, 
°ªam
);

2566 
	}
}

2568 
HAVE_PROT_FFLUSH_0


2569 
	$fÊush
(
°ªam
)

2570 
HAVE_PROT_FFLUSH_1
 
°ªam
;

2573 i‡(!
sockscf
.
°©e
.
havegsßpisockës


2574 || 
°ªam
 =
NULL


2575 || 
	`socks_issysˇŒ
(
	`fûío
(
°ªam
), 
SYMBOL_FFLUSH
))

2576  
	`sys_fÊush
(
°ªam
);

2577  
	`RfÊush
(
°ªam
);

2578 
	}
}

2580 
HAVE_PROT_FCLOSE_0


2581 
	$f˛o£
(
°ªam
)

2582 
HAVE_PROT_FCLOSE_1
 
°ªam
;

2584 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2586 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_FCLOSE
))

2587  
	`sys_f˛o£
(
°ªam
);

2588  
	`Rf˛o£
(
°ªam
);

2589 
	}
}

2591 
HAVE_PROT_PRINTF_0


2592 
	$¥ötf
(
HAVE_PROT_PRINTF_1
 
f‹m©
, ...)

2594 c⁄° 
d
 = 
	`fûío
(
°dout
);

2595 
va_li°
 
≠
;

2596 
rc
;

2598 
	`va_°¨t
(
≠
, 
f‹m©
);

2600 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_PRINTF
)) {

2601 
rc
 = 
	`sys_v¥ötf
(
f‹m©
, 
≠
);

2602 
	`va_íd
(
≠
);

2603  
rc
;

2606 
rc
 = 
	`RvÂrötf
(
°dout
, 
f‹m©
, 
≠
);

2607 
	`va_íd
(
≠
);

2609  
rc
;

2610 
	}
}

2612 
HAVE_PROT_FPRINTF_0


2613 
	$Ârötf
(
HAVE_PROT_FPRINTF_1
 
°ªam
, 
HAVE_PROT_FPRINTF_2
 
f‹m©
, ...)

2615 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2616 
va_li°
 
≠
;

2617 
rc
;

2619 
	`va_°¨t
(
≠
, 
f‹m©
);

2621 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_FPRINTF
)) {

2622 
rc
 = 
	`sys_vÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

2623 
	`va_íd
(
≠
);

2624  
rc
;

2627 
rc
 = 
	`RvÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

2628 
	`va_íd
(
≠
);

2629  
rc
;

2630 
	}
}

2632 #i‡
HAVE___FPRINTF_CHK


2633 
HAVE_PROT_FPRINTF_0


2634 
	$__Ârötf_chk
(
HAVE_PROT_FPRINTF_1
 
°ªam
, 
dummy
,

2635 
HAVE_PROT_FPRINTF_2
 
f‹m©
, ...)

2637 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2638 
va_li°
 
≠
;

2639 
rc
;

2641 
	`va_°¨t
(
≠
, 
f‹m©
);

2643 i‡(!
sockscf
.
°©e
.
havegsßpisockës


2644 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL___FPRINTF_CHK
)) {

2645 
rc
 = 
	`sys_vÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

2646 
	`va_íd
(
≠
);

2647  
rc
;

2650 
rc
 = 
	`RvÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

2651 
	`va_íd
(
≠
);

2652  
rc
;

2653 
	}
}

2656 
HAVE_PROT_VPRINTF_0


2657 
	$v¥ötf
(
f‹m©
, 
≠
)

2658 
HAVE_PROT_VPRINTF_1
 
f‹m©
;

2659 
HAVE_PROT_VPRINTF_2
 
≠
;

2661 c⁄° 
d
 = 
	`fûío
(
°dout
);

2663 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_VPRINTF
))

2664  
	`sys_v¥ötf
(
f‹m©
, 
≠
);

2665  
	`RvÂrötf
(
°dout
, 
f‹m©
, 
≠
);

2666 
	}
}

2668 
HAVE_PROT_VFPRINTF_0


2669 
	$vÂrötf
(
°ªam
, 
f‹m©
, 
≠
)

2670 
HAVE_PROT_VFPRINTF_1
 
°ªam
;

2671 
HAVE_PROT_VFPRINTF_2
 
f‹m©
;

2672 
HAVE_PROT_VFPRINTF_3
 
≠
;

2674 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2676 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_VFPRINTF
))

2677  
	`sys_vÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

2678  
	`RvÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

2679 
	}
}

2681 #i‡
HAVE___VFPRINTF_CHK


2682 
HAVE_PROT_VFPRINTF_0


2683 
	$__vÂrötf_chk
(
°ªam
, 
dummy
, 
f‹m©
, 
≠
)

2684 
HAVE_PROT_VFPRINTF_1
 
°ªam
;

2685 
dummy
;

2686 
HAVE_PROT_VFPRINTF_2
 
f‹m©
;

2687 
HAVE_PROT_VFPRINTF_3
 
≠
;

2689 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2691 i‡(!
sockscf
.
°©e
.
havegsßpisockës


2692 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL___VFPRINTF_CHK
))

2693  
	`sys_vÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

2694  
	`RvÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

2695 
	}
}

2698 
HAVE_PROT_FWRITE_0


2699 
	$fwrôe
(
±r
, 
size
, 
nmb
, 
°ªam
)

2700 
HAVE_PROT_FWRITE_1
 
±r
;

2701 
HAVE_PROT_FWRITE_2
 
size
;

2702 
HAVE_PROT_FWRITE_3
 
nmb
;

2703 
HAVE_PROT_FWRITE_4
 
°ªam
;

2705 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2707 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_FWRITE
))

2708  
	`sys_fwrôe
(
±r
, 
size
, 
nmb
, 
°ªam
);

2709  
	`Rfwrôe
(
±r
, 
size
, 
nmb
, 
°ªam
);

2710 
	}
}

2712 
HAVE_PROT_FREAD_0


2713 
	$‰ód
(
±r
, 
size
, 
nmb
, 
°ªam
)

2714 
HAVE_PROT_FREAD_1
 
±r
;

2715 
HAVE_PROT_FREAD_2
 
size
;

2716 
HAVE_PROT_FREAD_3
 
nmb
;

2717 
HAVE_PROT_FREAD_4
 
°ªam
;

2719 c⁄° 
d
 = 
	`fûío
(
°ªam
);

2721 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_FREAD
))

2722  
	`sys_‰ód
(
±r
, 
size
, 
nmb
, 
°ªam
);

2723  
	`R‰ód
(
±r
, 
size
, 
nmb
, 
°ªam
);

2724 
	}
}

2726 #i‡
HAVE___READ_CHK


2727 
HAVE_PROT__READ_CHK_0


2728 
	$__ªad_chk
(
d
, 
buf
, 
nbyãs
, 
buÊí
)

2729 
HAVE_PROT__READ_CHK_1
 
d
;

2730 
HAVE_PROT__READ_CHK_2
 
buf
;

2731 
HAVE_PROT__READ_CHK_3
 
nbyãs
;

2732 
HAVE_PROT__READ_CHK_4
 
buÊí
;

2734 
	`SASSERTX
(
nbyãs
 <
buÊí
);

2736 i‡(!
sockscf
.
°©e
.
havegsßpisockës
 ||

2737 
	`socks_issysˇŒ
(
d
, 
SYMBOL___READ_CHK
))

2738  
	`sys_ªad
(
d
, 
buf
, 
nbyãs
);

2740  
	`Rªad
(
d
, 
buf
, 
nbyãs
);

2741 
	}
}

2746 #i‡
HAVE_DARWIN


2748 
HAVE_PROT_READ_0


2749 
	$sys_ªad_noˇn˚l
(
d
, 
buf
, 
nbyãs
)

2750 
HAVE_PROT_READ_1
 
d
;

2751 
HAVE_PROT_READ_2
 
buf
;

2752 
HAVE_PROT_READ_3
 
nbyãs
;

2754 
ssize_t
 
rc
;

2755 
	`HAVE_PROT_READ_0
 (*
	tREAD_FUNC_T
)(
	tHAVE_PROT_READ_1
,

2756 
	tHAVE_PROT_READ_2
,

2757 
	tHAVE_PROT_READ_3
);

2758 
READ_FUNC_T
 
fun˘i⁄
 = (READ_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_READ_NOCANCEL
);

2759 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

2761 i‡(
ègged
)

2762 
	`socks_sysˇŒ_°¨t
(
d
);

2764 
rc
 = 
	`fun˘i⁄
(
d
, 
buf
, 
nbyãs
);

2766 i‡(
ègged
)

2767 
	`socks_sysˇŒ_íd
(
d
);

2769  
rc
;

2770 
	}
}

2772 
HAVE_PROT_CONNECT_0


2773 
	$sys_c⁄√˘_noˇn˚l
(
s
, 
«me
, 
«mñí
)

2774 
HAVE_PROT_CONNECT_1
 
s
;

2775 
HAVE_PROT_CONNECT_2
 
«me
;

2776 
HAVE_PROT_CONNECT_3
 
«mñí
;

2778 
rc
;

2779 
	`HAVE_PROT_CONNECT_0
 (*
	tCONNECT_FUNC_T
)(
	tHAVE_PROT_CONNECT_1
,

2780 
	tHAVE_PROT_CONNECT_2
,

2781 
	tHAVE_PROT_CONNECT_3
);

2782 
CONNECT_FUNC_T
 
fun˘i⁄
 =

2783 (
CONNECT_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_CONNECT_NOCANCEL
);

2784 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

2786 i‡(
ègged
)

2787 
	`socks_sysˇŒ_°¨t
(
s
);

2789 
rc
 = 
	`fun˘i⁄
(
s
, 
«me
, 
«mñí
);

2791 i‡(
ègged
)

2792 
	`socks_sysˇŒ_íd
(
s
);

2794  
rc
;

2795 
	}
}

2797 
HAVE_PROT_RECVFROM_0


2798 
	$sys_ªcv‰om_noˇn˚l
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

2799 
HAVE_PROT_RECVFROM_1
 
s
;

2800 
HAVE_PROT_RECVFROM_2
 
buf
;

2801 
HAVE_PROT_RECVFROM_3
 
Àn
;

2802 
HAVE_PROT_RECVFROM_4
 
Êags
;

2803 
HAVE_PROT_RECVFROM_5
 
‰om
;

2804 
HAVE_PROT_RECVFROM_6
 
‰omÀn
;

2806 
rc
;

2807 
	`HAVE_PROT_RECVFROM_0
 (*
	tRECVFROM_FUNC_T
)(
	tHAVE_PROT_RECVFROM_1
,

2808 
	tHAVE_PROT_RECVFROM_2
,

2809 
	tHAVE_PROT_RECVFROM_3
,

2810 
	tHAVE_PROT_RECVFROM_4
,

2811 
	tHAVE_PROT_RECVFROM_5
,

2812 
	tHAVE_PROT_RECVFROM_6
);

2813 
RECVFROM_FUNC_T
 
fun˘i⁄
 =

2814 (
RECVFROM_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_RECVFROM_NOCANCEL
);

2815 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

2817 i‡(
ègged
)

2818 
	`socks_sysˇŒ_°¨t
(
s
);

2820 
rc
 = 
	`fun˘i⁄
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

2822 i‡(
ègged
)

2823 
	`socks_sysˇŒ_íd
(
s
);

2825  
rc
;

2826 
	}
}

2828 
HAVE_PROT_SENDTO_0


2829 
	$sys_£ndto_noˇn˚l
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

2830 
HAVE_PROT_SENDTO_1
 
s
;

2831 
HAVE_PROT_SENDTO_2
 
msg
;

2832 
HAVE_PROT_SENDTO_3
 
Àn
;

2833 
HAVE_PROT_SENDTO_4
 
Êags
;

2834 
HAVE_PROT_SENDTO_5
 
to
;

2835 
HAVE_PROT_SENDTO_6
 
tﬁí
;

2837 
ssize_t
 
rc
;

2838 
	`HAVE_PROT_SENDTO_0
 (*
	tSENDTO_FUNC_T
)(
	tHAVE_PROT_SENDTO_1
,

2839 
	tHAVE_PROT_SENDTO_2
,

2840 
	tHAVE_PROT_SENDTO_3
,

2841 
	tHAVE_PROT_SENDTO_4
,

2842 
	tHAVE_PROT_SENDTO_5
,

2843 
	tHAVE_PROT_SENDTO_6
);

2844 
SENDTO_FUNC_T
 
fun˘i⁄
 =

2845 (
SENDTO_FUNC_T
)
	`symbﬁfun˘i⁄
(
SYMBOL_SENDTO_NOCANCEL
);

2846 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

2848 i‡(
ègged
)

2849 
	`socks_sysˇŒ_°¨t
(
s
);

2851 
rc
 = 
	`fun˘i⁄
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

2853 i‡(
ègged
)

2854 
	`socks_sysˇŒ_íd
(
s
);

2856  
rc
;

2857 
	}
}

2859 
HAVE_PROT_WRITE_0


2860 
	$sys_wrôe_noˇn˚l
(
s
, 
buf
, 
nbyãs
)

2861 
HAVE_PROT_WRITE_1
 
s
;

2862 
HAVE_PROT_WRITE_2
 
buf
;

2863 
HAVE_PROT_WRITE_3
 
nbyãs
;

2865 
ssize_t
 
rc
;

2866 
	`HAVE_PROT_WRITE_0
 (*
	tWRITE_FUNC_T
)(
	tHAVE_PROT_WRITE_1
,

2867 
	tHAVE_PROT_WRITE_2
,

2868 
	tHAVE_PROT_WRITE_3
);

2869 
WRITE_FUNC_T
 
fun˘i⁄
 = (WRITE_FUNC_T)
	`symbﬁfun˘i⁄
(
SYMBOL_WRITE_NOCANCEL
);

2870 c⁄° 
ègged
 = (
doög_addröô
 ? 0 : 1);

2872 i‡(
ègged
)

2873 
	`socks_sysˇŒ_°¨t
(
s
);

2875 
rc
 = 
	`fun˘i⁄
(
s
, 
buf
, 
nbyãs
);

2877 i‡(
ègged
)

2878 
	`socks_sysˇŒ_íd
(
s
);

2880  
rc
;

2881 
	}
}

2883 
HAVE_PROT_CONNECT_0


2884 
	$c⁄√˘$NOCANCEL
(
s
, 
«me
, 
«mñí
)

2885 
HAVE_PROT_CONNECT_1
 
s
;

2886 
HAVE_PROT_CONNECT_2
 
«me
;

2887 
HAVE_PROT_CONNECT_3
 
«mñí
;

2889 i‡(!
sockscf
.
°©e
.
havegsßpisockës


2890 || 
	`socks_issysˇŒ
(
s
, 
SYMBOL_CONNECT_NOCANCEL
))

2891  
	`sys_c⁄√˘_noˇn˚l
(
s
, 
«me
, 
«mñí
);

2893  
	`Rc⁄√˘
(
s
, 
«me
, 
«mñí
);

2894 
	}
}

2897 
HAVE_PROT_READ_0


2898 
	$ªad$NOCANCEL
(
d
, 
buf
, 
nbyãs
)

2899 
HAVE_PROT_READ_1
 
d
;

2900 
HAVE_PROT_READ_2
 
buf
;

2901 
HAVE_PROT_READ_3
 
nbyãs
;

2903 i‡(!
sockscf
.
°©e
.
havegsßpisockës


2904 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_READ_NOCANCEL
))

2905  
	`sys_ªad_noˇn˚l
(
d
, 
buf
, 
nbyãs
);

2907  
	`Rªad
(
d
, 
buf
, 
nbyãs
);

2908 
	}
}

2911 
HAVE_PROT_RECVFROM_0


2912 
	$ªcv‰om$NOCANCEL
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

2913 
HAVE_PROT_RECVFROM_1
 
s
;

2914 
HAVE_PROT_RECVFROM_2
 
buf
;

2915 
HAVE_PROT_RECVFROM_3
 
Àn
;

2916 
HAVE_PROT_RECVFROM_4
 
Êags
;

2917 
HAVE_PROT_RECVFROM_5
 
‰om
;

2918 
HAVE_PROT_RECVFROM_6
 
‰omÀn
;

2920 i‡(!
sockscf
.
°©e
.
havegsßpisockës


2921 || 
	`socks_issysˇŒ
(
s
, 
SYMBOL_RECVFROM_NOCANCEL
))

2922  
	`sys_ªcv‰om_noˇn˚l
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

2924  
	`Rªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

2925 
	}
}

2927 
HAVE_PROT_SENDTO_0


2928 
	$£ndto$NOCANCEL
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

2929 
HAVE_PROT_SENDTO_1
 
s
;

2930 
HAVE_PROT_SENDTO_2
 
msg
;

2931 
HAVE_PROT_SENDTO_3
 
Àn
;

2932 
HAVE_PROT_SENDTO_4
 
Êags
;

2933 
HAVE_PROT_SENDTO_5
 
to
;

2934 
HAVE_PROT_SENDTO_6
 
tﬁí
;

2936 i‡(!
sockscf
.
°©e
.
havegsßpisockës


2937 || 
	`socks_issysˇŒ
(
s
, 
SYMBOL_SENDTO_NOCANCEL
))

2938  
	`sys_£ndto_noˇn˚l
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

2940  
	`R£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
);

2941 
	}
}

2944 
HAVE_PROT_WRITE_0


2945 
	$wrôe$NOCANCEL
(
d
, 
buf
, 
nbyãs
)

2946 
HAVE_PROT_WRITE_1
 
d
;

2947 
HAVE_PROT_WRITE_2
 
buf
;

2948 
HAVE_PROT_WRITE_3
 
nbyãs
;

2950 i‡(!
sockscf
.
°©e
.
havegsßpisockës


2951 || 
	`socks_issysˇŒ
(
d
, 
SYMBOL_WRITE_NOCANCEL
))

2952  
	`sys_wrôe_noˇn˚l
(
d
, 
buf
, 
nbyãs
);

2954  
	`Rwrôe
(
d
, 
buf
, 
nbyãs
);

2955 
	}
}

2962 
libsymbﬁ_t
 *

2963 
	$libsymbﬁ
(
symbﬁ
)

2964 c⁄° *
symbﬁ
;

2967 
size_t
 
i
;

2969 
i
 = 0; i < 
	`ELEMENTS
(
libsymbﬁv
); ++i)

2970 i‡(
	`°rcmp
(
libsymbﬁv
[
i
].
symbﬁ
, symbol) == 0)

2971  &
libsymbﬁv
[
i
];

2973 
	`SERRX
(0);

2976  
NULL
;

2977 
	}
}

2980 
	$idßªequÆ
(
a
, 
b
)

2981 c⁄° 
socks_id_t
 *
a
;

2982 c⁄° 
socks_id_t
 *
b
;

2985 
a
->
whichid
) {

2986 
pid
:

2987 i‡(
a
->
id
.
pid
 =
b
->id.pid)

2992 #i‡
SOCKS_CLIENT


2993 
thªad
:

2995 i‡(
	`memcmp
(&
a
->
id
.
thªad
, &
b
->id.thread, (a->id.thread)) == 0)

3001 
	`SERRX
(
a
->
whichid
);

3005 
	}
}

3009 
	$addtﬁi°
(
fun˘i⁄«me
, 
id
)

3010 c⁄° *
fun˘i⁄«me
;

3011 c⁄° 
socks_id_t
 *
id
;

3013 c⁄° *
fun˘i⁄
 = "addtolist()";

3014 
libsymbﬁ_t
 *
lib
;

3015 
socks_id_t
 *
√wid
;

3017 #i‡
SOCKS_CLIENT


3018 
addæock›aque_t
 
›aque
;

3021 
socks_id_t
 
√widmem
;

3025 
lib
 = 
	`libsymbﬁ
(
fun˘i⁄«me
);

3026 
	`SASSERTX
(
lib
 !
NULL
);

3028 #i‡
SOCKS_CLIENT


3030 i‡((
√wid
 = 
	`mÆloc
((*√wid))Ë=
NULL
)

3031 
	`£º
("%s: failedÅo malloc %lu bytes",

3032 
fun˘i⁄
, ()(*
√wid
));

3037 
√wid
 = &
√widmem
;

3041 *
√wid
 = *
id
;

3043 #i‡
SOCKS_CLIENT


3045 
	`socks_addæock
(
F_WRLCK
, &
›aque
);

3049 
	`SASSERTX
(
lib
->
dosysˇŒ
 =
NULL
);

3053 i‡(
lib
->
dosysˇŒ
 =
NULL
) {

3054 
lib
->
dosysˇŒ
 = 
√wid
;

3055 
lib
->
dosysˇŒ
->
√xt
 = 
NULL
;

3058 
√wid
->
√xt
 = 
lib
->
dosysˇŒ
->next;

3059 
lib
->
dosysˇŒ
->
√xt
 = 
√wid
;

3062 #i‡
SOCKS_CLIENT


3063 
	`socks_addru∆ock
(&
›aque
);

3065 
	}
}

3068 
	$ªmove‰omli°
(
fun˘i⁄«me
, 
ªmoveid
)

3069 c⁄° *
fun˘i⁄«me
;

3070 c⁄° 
socks_id_t
 *
ªmoveid
;

3073 
libsymbﬁ_t
 *
lib
;

3074 
socks_id_t
 *
id
, *
¥evious
;

3075 #i‡
SOCKS_CLIENT


3076 
addæock›aque_t
 
›aque
;

3079 
lib
 = 
	`libsymbﬁ
(
fun˘i⁄«me
);

3080 
	`SASSERTX
(
lib
 !
NULL
);

3081 
	`SASSERTX
(
lib
->
dosysˇŒ
 !
NULL
);

3083 #i‡
SOCKS_CLIENT


3085 
	`socks_addæock
(
F_WRLCK
, &
›aque
);

3089 
	`SASSERTX
(
	`idßªequÆ
(
lib
->
dosysˇŒ
, 
ªmoveid
));

3093 
¥evious
 = 
lib
->
dosysˇŒ
;

3095 i‡(
	`idßªequÆ
(
lib
->
dosysˇŒ
, 
ªmoveid
)) {

3096 
lib
->
dosysˇŒ
 =Üib->dosysˇŒ->
√xt
;

3098 #i‡
SOCKS_CLIENT


3099 
	`‰ì
(
¥evious
);

3103 
	`SASSERTX
(
SOCKS_CLIENT
);

3105 
id
 = 
¥evious
->
√xt
; id !
NULL
;Örevious = id, id = id->next) {

3106 i‡(
	`idßªequÆ
(
id
, 
ªmoveid
)) {

3107 
¥evious
->
√xt
 = 
id
->next;

3109 #i‡
SOCKS_CLIENT


3110 
	`‰ì
(
id
);

3117 
	`SASSERTX
(
id
 !
NULL
);

3120 #i‡
SOCKS_CLIENT


3121 
	`socks_addru∆ock
(&
›aque
);

3123 
	}
}

	@include/autoconf.h

5 #ifde‡
HAVE_ANDROID_OS


6 #unde‡ 
HAVE_SCHED_SETSCHEDULER


7 #unde‡ 
HAVE_MALLOC_H


12 
	#BAREFOOTD
 0

	)

15 
	#COVENANT
 0

	)

18 
	#DANTE_BUILD
 "m⁄-d©®m⁄-disc⁄√˘ sess2"

	)

21 
	#DANTE_COMPATFILES
 "is£tugid së¥o˘ôÀ sål˝y såvis"

	)

24 
	#DANTE_SOCKOPTS_IPV4
 "IP_FREEBIND IP_MINTTL IP_MTU_DISCOVER IP_TOS IP_TTL"

	)

27 
	#DANTE_SOCKOPTS_IPV6
 "IPV6_ADDRFORM IPV6_UNICAST_HOPS IPV6_2292DSTOPTS IPV6_2292HOPLIMIT IPV6_2292HOPOPTS IPV6_2292PKTINFO IPV6_2292PKTOPTIONS IPV6_2292RTHDR IPV6_ADDRFORM IPV6_AUTHHDR IPV6_CHECKSUM IPV6_DSTOPTS IPV6_DSTOPTS IPV6_HOPLIMIT IPV6_HOPLIMIT IPV6_HOPOPTS IPV6_HOPOPTS IPV6_IPSEC_POLICY IPV6_JOIN_ANYCAST IPV6_JOIN_GROUP IPV6_LEAVE_ANYCAST IPV6_LEAVE_GROUP IPV6_MTU IPV6_MTU_DISCOVER IPV6_NEXTHOP IPV6_PKTINFO IPV6_ROUTER_ALERT IPV6_RTHDR IPV6_RTHDRDSTOPTS IPV6_TCLASS IPV6_UNICAST_HOPS IPV6_V6ONLY IPV6_XFRM_POLICY"

	)

30 
	#DANTE_SOCKOPTS_SO
 "SO_BROADCAST SO_DEBUG SO_DONTROUTE SO_KEEPALIVE SO_LINGER SO_OOBINLINE SO_PRIORITY SO_RCVBUF SO_RCVBUFFORCE SO_RCVLOWAT SO_RCVTIMEO SO_SNDBUF SO_SNDBUFFORCE SO_SNDLOWAT SO_SNDTIMEO SO_TIMESTAMP"

	)

33 
	#DANTE_SOCKOPTS_TCP
 "TCP_CORK TCP_KEEPCNT TCP_KEEPIDLE TCP_KEEPINTVL TCP_LINGER2 TCP_MAXSEG TCP_MD5SIG TCP_NODELAY TCP_SYNCNT TCP_WINDOW_CLAMP"

	)

36 
	#DANTE_SOCKOPTS_UDP
 "UDP_CORK"

	)

39 
	#DIAGNOSTIC
 0

	)

42 
	#DL_LAZY
 
RTLD_LAZY


	)

45 
	#FD_SETSIZE_LIMITS_SELECT
 0

	)

48 
	#HAVE_ARPA_NAMESER_H
 1

	)

51 
	#HAVE_BACKTRACE
 1

	)

54 
	#HAVE_BINDRESVPORT
 1

	)

66 
	#HAVE_BZERO
 1

	)

69 
	#HAVE_CLOCK_GETTIME_MONOTONIC
 1

	)

72 
	#HAVE_CMSGHDR
 1

	)

75 
	#HAVE_CMSG_LEN
 1

	)

78 
	#HAVE_CMSG_SPACE
 1

	)

99 
	#HAVE_CPU_EQUAL
 1

	)

102 
	#HAVE_CRYPT_H
 1

	)

105 
	#HAVE_DAEMON
 1

	)

111 
	#HAVE_DECL_ATTRIBUTE
 1

	)

117 
	#HAVE_DECL_FORMAT
 1

	)

130 
	#HAVE_DIFFTIME
 1

	)

133 
	#HAVE_DLFCN_H
 1

	)

139 
	#HAVE_DUPSOCKOPT_MAX
 25

	)

142 
	#HAVE_ENABLED_PIDFILE
 1

	)

151 
	#HAVE_ERR_EAI_AGAIN
 1

	)

160 
	#HAVE_ERR_EAI_BADFLAGS
 1

	)

169 
	#HAVE_ERR_EAI_FAIL
 1

	)

172 
	#HAVE_ERR_EAI_FAMILY
 1

	)

184 
	#HAVE_ERR_EAI_MEMORY
 1

	)

190 
	#HAVE_ERR_EAI_NONAME
 1

	)

196 
	#HAVE_ERR_EAI_OVERFLOW
 1

	)

202 
	#HAVE_ERR_EAI_SERVICE
 1

	)

205 
	#HAVE_ERR_EAI_SOCKTYPE
 1

	)

208 
	#HAVE_ERR_EAI_SYSTEM
 1

	)

214 
	#HAVE_EXECINFO_H
 1

	)

220 
	#HAVE_FCNTL_H
 1

	)

223 
	#HAVE_FDMASK
 1

	)

226 
	#HAVE_FREEADDRINFO
 1

	)

229 
	#HAVE_FREEIFADDRS
 1

	)

232 
	#HAVE_GETADDRINFO
 1

	)

235 
	#HAVE_GETHOSTBYNAME2
 1

	)

238 
	#HAVE_GETIFADDRS
 1

	)

244 
	#HAVE_GETNAMEINFO
 1

	)

247 
	#HAVE_GETPASS
 1

	)

253 
	#HAVE_GETSPNAM
 1

	)

286 
	#HAVE_HSTRERROR
 1

	)

289 
	#HAVE_IFADDRS_H
 1

	)

292 
	#HAVE_IN6_ADDR
 1

	)

295 
	#HAVE_INET_PTON
 1

	)

298 
	#HAVE_INT16_T
 1

	)

301 
	#HAVE_INT32_T
 1

	)

304 
	#HAVE_INT8_T
 1

	)

307 
	#HAVE_INTTYPES_H
 1

	)

310 
	#HAVE_IN_ADDR_T
 1

	)

313 
	#HAVE_IN_PORT_T
 1

	)

316 
	#HAVE_IPV6_2292DSTOPTS
 1

	)

319 
	#HAVE_IPV6_2292HOPLIMIT
 1

	)

322 
	#HAVE_IPV6_2292HOPOPTS
 1

	)

325 
	#HAVE_IPV6_2292PKTINFO
 1

	)

328 
	#HAVE_IPV6_2292PKTOPTIONS
 1

	)

331 
	#HAVE_IPV6_2292RTHDR
 1

	)

334 
	#HAVE_IPV6_ADDRFORM
 1

	)

340 
	#HAVE_IPV6_ADD_MEMBERSHIP
 1

	)

346 
	#HAVE_IPV6_AUTHHDR
 1

	)

355 
	#HAVE_IPV6_CHECKSUM
 1

	)

361 
	#HAVE_IPV6_DROP_MEMBERSHIP
 1

	)

364 
	#HAVE_IPV6_DSTOPTS
 1

	)

382 
	#HAVE_IPV6_HOPLIMIT
 1

	)

385 
	#HAVE_IPV6_HOPOPTS
 1

	)

391 
	#HAVE_IPV6_IPSEC_POLICY
 1

	)

394 
	#HAVE_IPV6_JOIN_ANYCAST
 1

	)

397 
	#HAVE_IPV6_JOIN_GROUP
 1

	)

400 
	#HAVE_IPV6_LEAVE_ANYCAST
 1

	)

403 
	#HAVE_IPV6_LEAVE_GROUP
 1

	)

412 
	#HAVE_IPV6_MTU
 1

	)

415 
	#HAVE_IPV6_MTU_DISCOVER
 1

	)

418 
	#HAVE_IPV6_MULTICAST_HOPS
 1

	)

421 
	#HAVE_IPV6_MULTICAST_IF
 1

	)

424 
	#HAVE_IPV6_MULTICAST_LOOP
 1

	)

427 
	#HAVE_IPV6_NEXTHOP
 1

	)

442 
	#HAVE_IPV6_PKTINFO
 1

	)

454 
	#HAVE_IPV6_RECVDSTOPTS
 1

	)

457 
	#HAVE_IPV6_RECVERR
 1

	)

460 
	#HAVE_IPV6_RECVHOPLIMIT
 1

	)

463 
	#HAVE_IPV6_RECVHOPOPTS
 1

	)

481 
	#HAVE_IPV6_RECVPKTINFO
 1

	)

487 
	#HAVE_IPV6_RECVRTHDR
 1

	)

493 
	#HAVE_IPV6_RECVTCLASS
 1

	)

499 
	#HAVE_IPV6_ROUTER_ALERT
 1

	)

502 
	#HAVE_IPV6_RTHDR
 1

	)

505 
	#HAVE_IPV6_RTHDRDSTOPTS
 1

	)

511 
	#HAVE_IPV6_TCLASS
 1

	)

517 
	#HAVE_IPV6_UNICAST_HOPS
 1

	)

523 
	#HAVE_IPV6_V6ONLY
 1

	)

526 
	#HAVE_IPV6_XFRM_POLICY
 1

	)

532 
	#HAVE_IP_ADD_MEMBERSHIP
 1

	)

535 
	#HAVE_IP_ADD_SOURCE_MEMBERSHIP
 1

	)

541 
	#HAVE_IP_BLOCK_SOURCE
 1

	)

553 
	#HAVE_IP_DROP_MEMBERSHIP
 1

	)

556 
	#HAVE_IP_DROP_SOURCE_MEMBERSHIP
 1

	)

568 
	#HAVE_IP_FREEBIND
 1

	)

571 
	#HAVE_IP_HDRINCL
 1

	)

577 
	#HAVE_IP_MINTTL
 1

	)

580 
	#HAVE_IP_MTU_DISCOVER
 1

	)

586 
	#HAVE_IP_MULTICAST_IF
 1

	)

589 
	#HAVE_IP_MULTICAST_LOOP
 1

	)

592 
	#HAVE_IP_MULTICAST_TTL
 1

	)

595 
	#HAVE_IP_OPTIONS
 1

	)

619 
	#HAVE_IP_RECVTOS
 1

	)

622 
	#HAVE_IP_RECVTTL
 1

	)

628 
	#HAVE_IP_TOS
 1

	)

631 
	#HAVE_IP_TTL
 1

	)

634 
	#HAVE_IP_UNBLOCK_SOURCE
 1

	)

706 
	#HAVE_LIBC_ENABLE_SECURE
 1

	)

775 
	#HAVE_LIMITS_H
 1

	)

778 
	#HAVE_LINUX_BUGS
 1

	)

784 
	#HAVE_MALLOC_H
 1

	)

793 
	#HAVE_MEMMOVE
 1

	)

796 
	#HAVE_MEMORY_H
 1

	)

811 
	#HAVE_MONCONTROL
 1

	)

820 
	#HAVE_MSG_WAITALL
 1

	)

823 
	#HAVE_NETINET_IN_H
 1

	)

826 
	#HAVE_NETINET_IP_H
 1

	)

841 
	#HAVE_NONULL_FREE
 1

	)

847 
	#HAVE_NO_SYMBOL_UNDERSCORE
 1

	)

856 
	#HAVE_OPENLOG_LOG_PERROR
 1

	)

859 
	#HAVE_PATHS_H
 1

	)

865 
	#HAVE_PIPEBUFFER_SEND_BASED
 1

	)

871 
	#HAVE_PRAGMA_SUPPORT
 1

	)

886 
	#HAVE_PROGNAME
 1

	)

889 
	#HAVE_PROT_ACCEPT_0
 

	)

892 
	#HAVE_PROT_ACCEPT_1
 

	)

895 
	#HAVE_PROT_ACCEPT_2
 
sockaddr
 *

	)

898 
	#HAVE_PROT_ACCEPT_3
 
sockÀn_t
 *

	)

901 
	#HAVE_PROT_BIND_0
 

	)

904 
	#HAVE_PROT_BIND_1
 

	)

907 
	#HAVE_PROT_BIND_2
 c⁄° 
sockaddr
 *

	)

910 
	#HAVE_PROT_BIND_3
 
sockÀn_t


	)

913 
	#HAVE_PROT_CONNECT_0
 

	)

916 
	#HAVE_PROT_CONNECT_1
 

	)

919 
	#HAVE_PROT_CONNECT_2
 c⁄° 
sockaddr
 *

	)

922 
	#HAVE_PROT_CONNECT_3
 
sockÀn_t


	)

925 
	#HAVE_PROT_FCLOSE_0
 

	)

928 
	#HAVE_PROT_FCLOSE_1
 
FILE
 *

	)

931 
	#HAVE_PROT_FFLUSH_0
 

	)

934 
	#HAVE_PROT_FFLUSH_1
 
FILE
 *

	)

937 
	#HAVE_PROT_FGETC_0
 

	)

940 
	#HAVE_PROT_FGETC_1
 
FILE
 *

	)

943 
	#HAVE_PROT_FGETS_0
 *

	)

946 
	#HAVE_PROT_FGETS_1
 *

	)

949 
	#HAVE_PROT_FGETS_2
 

	)

952 
	#HAVE_PROT_FGETS_3
 
FILE
 *

	)

955 
	#HAVE_PROT_FPRINTF_0
 

	)

958 
	#HAVE_PROT_FPRINTF_1
 
FILE
 *

	)

961 
	#HAVE_PROT_FPRINTF_2
 c⁄° *

	)

964 
	#HAVE_PROT_FPRINTF_3
 ...

	)

967 
	#HAVE_PROT_FPUTC_0
 

	)

970 
	#HAVE_PROT_FPUTC_1
 

	)

973 
	#HAVE_PROT_FPUTC_2
 
FILE
 *

	)

976 
	#HAVE_PROT_FPUTS_0
 

	)

979 
	#HAVE_PROT_FPUTS_1
 c⁄° *

	)

982 
	#HAVE_PROT_FPUTS_2
 
FILE
 *

	)

985 
	#HAVE_PROT_FREAD_0
 
size_t


	)

988 
	#HAVE_PROT_FREAD_1
 *

	)

991 
	#HAVE_PROT_FREAD_2
 
size_t


	)

994 
	#HAVE_PROT_FREAD_3
 
size_t


	)

997 
	#HAVE_PROT_FREAD_4
 
FILE
 *

	)

1000 
	#HAVE_PROT_FWRITE_0
 
size_t


	)

1003 
	#HAVE_PROT_FWRITE_1
 c⁄° *

	)

1006 
	#HAVE_PROT_FWRITE_2
 
size_t


	)

1009 
	#HAVE_PROT_FWRITE_3
 
size_t


	)

1012 
	#HAVE_PROT_FWRITE_4
 
FILE
 *

	)

1015 
	#HAVE_PROT_GETC_0
 

	)

1018 
	#HAVE_PROT_GETC_1
 
FILE
 *

	)

1021 
	#HAVE_PROT_GETHOSTBYADDR_0
 
ho°ít
 *

	)

1024 
	#HAVE_PROT_GETHOSTBYADDR_1
 c⁄° *

	)

1027 
	#HAVE_PROT_GETHOSTBYADDR_2
 
sockÀn_t


	)

1030 
	#HAVE_PROT_GETHOSTBYADDR_3
 

	)

1033 
	#HAVE_PROT_GETNAMEINFO_0
 

	)

1036 
	#HAVE_PROT_GETNAMEINFO_1
 c⁄° 
sockaddr
 *

	)

1039 
	#HAVE_PROT_GETNAMEINFO_2
 
sockÀn_t


	)

1042 
	#HAVE_PROT_GETNAMEINFO_3
 *

	)

1045 
	#HAVE_PROT_GETNAMEINFO_4
 
sockÀn_t


	)

1048 
	#HAVE_PROT_GETNAMEINFO_5
 *

	)

1051 
	#HAVE_PROT_GETNAMEINFO_6
 
sockÀn_t


	)

1054 
	#HAVE_PROT_GETNAMEINFO_7
 

	)

1057 
	#HAVE_PROT_GETPEERNAME_0
 

	)

1060 
	#HAVE_PROT_GETPEERNAME_1
 

	)

1063 
	#HAVE_PROT_GETPEERNAME_2
 
sockaddr
 *

	)

1066 
	#HAVE_PROT_GETPEERNAME_3
 
sockÀn_t
 *

	)

1069 
	#HAVE_PROT_GETSOCKNAME_0
 

	)

1072 
	#HAVE_PROT_GETSOCKNAME_1
 

	)

1075 
	#HAVE_PROT_GETSOCKNAME_2
 
sockaddr
 *

	)

1078 
	#HAVE_PROT_GETSOCKNAME_3
 
sockÀn_t
 *

	)

1081 
	#HAVE_PROT_GETSOCKOPT_0
 

	)

1084 
	#HAVE_PROT_GETSOCKOPT_1
 

	)

1087 
	#HAVE_PROT_GETSOCKOPT_2
 

	)

1090 
	#HAVE_PROT_GETSOCKOPT_3
 

	)

1093 
	#HAVE_PROT_GETSOCKOPT_4
 *

	)

1096 
	#HAVE_PROT_GETSOCKOPT_5
 
sockÀn_t
 *

	)

1099 
	#HAVE_PROT_GETS_0
 *

	)

1102 
	#HAVE_PROT_GETS_1
 *

	)

1105 
	#HAVE_PROT_LISTEN_0
 

	)

1108 
	#HAVE_PROT_LISTEN_1
 

	)

1111 
	#HAVE_PROT_LISTEN_2
 

	)

1114 
	#HAVE_PROT_PRINTF_0
 

	)

1117 
	#HAVE_PROT_PRINTF_1
 c⁄° *

	)

1120 
	#HAVE_PROT_PRINTF_2
 ...

	)

1123 
	#HAVE_PROT_PUTC_0
 

	)

1126 
	#HAVE_PROT_PUTC_1
 

	)

1129 
	#HAVE_PROT_PUTC_2
 
FILE
 *

	)

1132 
	#HAVE_PROT_PUTS_0
 

	)

1135 
	#HAVE_PROT_PUTS_1
 c⁄° *

	)

1138 
	#HAVE_PROT_READV_0
 
ssize_t


	)

1141 
	#HAVE_PROT_READV_1
 

	)

1144 
	#HAVE_PROT_READV_2
 c⁄° 
iovec
 *

	)

1147 
	#HAVE_PROT_READV_3
 

	)

1150 
	#HAVE_PROT_READ_0
 
ssize_t


	)

1153 
	#HAVE_PROT_READ_1
 

	)

1156 
	#HAVE_PROT_READ_2
 *

	)

1159 
	#HAVE_PROT_READ_3
 
size_t


	)

1162 
	#HAVE_PROT_RECVFROM_0
 
ssize_t


	)

1165 
	#HAVE_PROT_RECVFROM_1
 

	)

1168 
	#HAVE_PROT_RECVFROM_2
 *

	)

1171 
	#HAVE_PROT_RECVFROM_3
 
size_t


	)

1174 
	#HAVE_PROT_RECVFROM_4
 

	)

1177 
	#HAVE_PROT_RECVFROM_5
 
sockaddr
 *

	)

1180 
	#HAVE_PROT_RECVFROM_6
 
sockÀn_t
 *

	)

1183 
	#HAVE_PROT_RECVMSG_0
 
ssize_t


	)

1186 
	#HAVE_PROT_RECVMSG_1
 

	)

1189 
	#HAVE_PROT_RECVMSG_2
 
msghdr
 *

	)

1192 
	#HAVE_PROT_RECVMSG_3
 

	)

1195 
	#HAVE_PROT_RECV_0
 
ssize_t


	)

1198 
	#HAVE_PROT_RECV_1
 

	)

1201 
	#HAVE_PROT_RECV_2
 *

	)

1204 
	#HAVE_PROT_RECV_3
 
size_t


	)

1207 
	#HAVE_PROT_RECV_4
 

	)

1210 
	#HAVE_PROT_SENDMSG_0
 
ssize_t


	)

1213 
	#HAVE_PROT_SENDMSG_1
 

	)

1216 
	#HAVE_PROT_SENDMSG_2
 c⁄° 
msghdr
 *

	)

1219 
	#HAVE_PROT_SENDMSG_3
 

	)

1222 
	#HAVE_PROT_SENDTO_0
 
ssize_t


	)

1225 
	#HAVE_PROT_SENDTO_1
 

	)

1228 
	#HAVE_PROT_SENDTO_2
 c⁄° *

	)

1231 
	#HAVE_PROT_SENDTO_3
 
size_t


	)

1234 
	#HAVE_PROT_SENDTO_4
 

	)

1237 
	#HAVE_PROT_SENDTO_5
 c⁄° 
sockaddr
 *

	)

1240 
	#HAVE_PROT_SENDTO_6
 
sockÀn_t


	)

1243 
	#HAVE_PROT_SEND_0
 
ssize_t


	)

1246 
	#HAVE_PROT_SEND_1
 

	)

1249 
	#HAVE_PROT_SEND_2
 c⁄° *

	)

1252 
	#HAVE_PROT_SEND_3
 
size_t


	)

1255 
	#HAVE_PROT_SEND_4
 

	)

1258 
	#HAVE_PROT_VFPRINTF_0
 

	)

1261 
	#HAVE_PROT_VFPRINTF_1
 
FILE
 *

	)

1264 
	#HAVE_PROT_VFPRINTF_2
 c⁄° *

	)

1267 
	#HAVE_PROT_VFPRINTF_3
 
va_li°


	)

1270 
	#HAVE_PROT_VPRINTF_0
 

	)

1273 
	#HAVE_PROT_VPRINTF_1
 c⁄° *

	)

1276 
	#HAVE_PROT_VPRINTF_2
 
va_li°


	)

1279 
	#HAVE_PROT_WRITEV_0
 
ssize_t


	)

1282 
	#HAVE_PROT_WRITEV_1
 

	)

1285 
	#HAVE_PROT_WRITEV_2
 c⁄° 
iovec
 *

	)

1288 
	#HAVE_PROT_WRITEV_3
 

	)

1291 
	#HAVE_PROT_WRITE_0
 
ssize_t


	)

1294 
	#HAVE_PROT_WRITE_1
 

	)

1297 
	#HAVE_PROT_WRITE_2
 c⁄° *

	)

1300 
	#HAVE_PROT_WRITE_3
 
size_t


	)

1303 
	#HAVE_PROT__IO_GETC_0
 

	)

1306 
	#HAVE_PROT__IO_GETC_1
 
FILE
 *

	)

1309 
	#HAVE_PROT__IO_PUTC_0
 

	)

1312 
	#HAVE_PROT__IO_PUTC_1
 

	)

1315 
	#HAVE_PROT__IO_PUTC_2
 
FILE
 *

	)

1318 
	#HAVE_PROT__READ_CHK_0
 
ssize_t


	)

1321 
	#HAVE_PROT__READ_CHK_1
 

	)

1324 
	#HAVE_PROT__READ_CHK_2
 *

	)

1327 
	#HAVE_PROT__READ_CHK_3
 
size_t


	)

1330 
	#HAVE_PROT__READ_CHK_4
 
size_t


	)

1333 
	#HAVE_PSELECT
 1

	)

1336 
	#HAVE_PTHREAD_H
 1

	)

1339 
	#HAVE_RECVBUF_IOCTL
 1

	)

1342 
	#HAVE_RESOLV_H
 1

	)

1348 
	#HAVE_ROUTEINFO_LINUX
 1

	)

1351 
	#HAVE_ROUTE_SOURCE
 1

	)

1354 
	#HAVE_RPC_RPC_H
 1

	)

1357 
	#HAVE_RRESVPORT
 1

	)

1360 
	#HAVE_RTLD_NEXT
 1

	)

1375 
	#HAVE_SCHED_H
 1

	)

1378 
	#HAVE_SCHED_SETAFFINITY
 1

	)

1381 
	#HAVE_SCHED_SETSCHEDULER
 1

	)

1387 
	#HAVE_SELECT_MAXTIMEOUT
 0

	)

1390 
	#HAVE_SENDBUF_IOCTL
 
TIOCOUTQ


	)

1396 
	#HAVE_SETEGID
 1

	)

1399 
	#HAVE_SETEUID
 1

	)

1405 
	#HAVE_SHADOW_H
 1

	)

1411 
	#HAVE_SIG_ATOMIC_T
 1

	)

1414 
	#HAVE_SIOCGIFHWADDR
 1

	)

1423 
	#HAVE_SOCKATMARK
 1

	)

1426 
	#HAVE_SOCKOPTVALSYM_MAX
 32

	)

1429 
	#HAVE_SOCKOPTVAL_MAX
 102

	)

1438 
	#HAVE_SO_ACCEPTCONN
 1

	)

1447 
	#HAVE_SO_BROADCAST
 1

	)

1453 
	#HAVE_SO_DEBUG
 1

	)

1456 
	#HAVE_SO_DONTROUTE
 1

	)

1459 
	#HAVE_SO_ERROR
 1

	)

1465 
	#HAVE_SO_KEEPALIVE
 1

	)

1471 
	#HAVE_SO_LINGER
 1

	)

1480 
	#HAVE_SO_OOBINLINE
 1

	)

1486 
	#HAVE_SO_PRIORITY
 1

	)

1489 
	#HAVE_SO_RCVBUF
 1

	)

1492 
	#HAVE_SO_RCVBUFFORCE
 1

	)

1495 
	#HAVE_SO_RCVLOWAT
 1

	)

1498 
	#HAVE_SO_RCVTIMEO
 1

	)

1501 
	#HAVE_SO_REUSEADDR
 1

	)

1504 
	#HAVE_SO_REUSEPORT
 1

	)

1507 
	#HAVE_SO_SNDBUF
 1

	)

1510 
	#HAVE_SO_SNDBUFFORCE
 1

	)

1513 
	#HAVE_SO_SNDLOWAT
 1

	)

1516 
	#HAVE_SO_SNDTIMEO
 1

	)

1519 
	#HAVE_SO_TIMESTAMP
 1

	)

1522 
	#HAVE_SO_TYPE
 1

	)

1531 
	#HAVE_STDDEF_H
 1

	)

1534 
	#HAVE_STDINT_H
 1

	)

1537 
	#HAVE_STDLIB_H
 1

	)

1540 
	#HAVE_STRFTIME
 1

	)

1543 
	#HAVE_STRINGS_H
 1

	)

1546 
	#HAVE_STRING_H
 1

	)

1561 
	#HAVE_SYSLOG_H
 1

	)

1567 
	#HAVE_SYS_FILE_H
 1

	)

1570 
	#HAVE_SYS_IOCTL_H
 1

	)

1573 
	#HAVE_SYS_IPC_H
 1

	)

1582 
	#HAVE_SYS_SEM_H
 1

	)

1585 
	#HAVE_SYS_SHM_H
 1

	)

1591 
	#HAVE_SYS_STAT_H
 1

	)

1594 
	#HAVE_SYS_TIME_H
 1

	)

1597 
	#HAVE_SYS_TYPES_H
 1

	)

1600 
	#HAVE_SYS_WAIT_H
 1

	)

1606 
	#HAVE_TCP_CORK
 1

	)

1618 
	#HAVE_TCP_INFO
 1

	)

1621 
	#HAVE_TCP_INFO_TCPI_ADVMSS
 1

	)

1624 
	#HAVE_TCP_INFO_TCPI_ATO
 1

	)

1627 
	#HAVE_TCP_INFO_TCPI_BACKOFF
 1

	)

1630 
	#HAVE_TCP_INFO_TCPI_CA_STATE
 1

	)

1633 
	#HAVE_TCP_INFO_TCPI_FACKETS
 1

	)

1636 
	#HAVE_TCP_INFO_TCPI_LAST_ACK_RECV
 1

	)

1639 
	#HAVE_TCP_INFO_TCPI_LAST_ACK_SENT
 1

	)

1642 
	#HAVE_TCP_INFO_TCPI_LAST_DATA_RECV
 1

	)

1645 
	#HAVE_TCP_INFO_TCPI_LAST_DATA_SENT
 1

	)

1648 
	#HAVE_TCP_INFO_TCPI_LOST
 1

	)

1651 
	#HAVE_TCP_INFO_TCPI_PMTU
 1

	)

1654 
	#HAVE_TCP_INFO_TCPI_PROBES
 1

	)

1657 
	#HAVE_TCP_INFO_TCPI_RCV_RTT
 1

	)

1660 
	#HAVE_TCP_INFO_TCPI_RCV_SPACE
 1

	)

1663 
	#HAVE_TCP_INFO_TCPI_RCV_SSTHRESH
 1

	)

1666 
	#HAVE_TCP_INFO_TCPI_REORDERING
 1

	)

1669 
	#HAVE_TCP_INFO_TCPI_RETRANS
 1

	)

1672 
	#HAVE_TCP_INFO_TCPI_RETRANSMITS
 1

	)

1675 
	#HAVE_TCP_INFO_TCPI_SACKED
 1

	)

1678 
	#HAVE_TCP_INFO_TCPI_TOTAL_RETRANS
 1

	)

1681 
	#HAVE_TCP_INFO_TCPI_UNACKED
 1

	)

1690 
	#HAVE_TCP_KEEPCNT
 1

	)

1693 
	#HAVE_TCP_KEEPIDLE
 1

	)

1696 
	#HAVE_TCP_KEEPINTVL
 1

	)

1699 
	#HAVE_TCP_LINGER2
 1

	)

1705 
	#HAVE_TCP_MAXSEG
 1

	)

1708 
	#HAVE_TCP_MD5SIG
 1

	)

1711 
	#HAVE_TCP_NODELAY
 1

	)

1741 
	#HAVE_TCP_SYNCNT
 1

	)

1744 
	#HAVE_TCP_WINDOW_CLAMP
 1

	)

1750 
	#HAVE_TIMER_MACROS
 1

	)

1753 
	#HAVE_UDP_CORK
 1

	)

1756 
	#HAVE_UINT16_T
 1

	)

1759 
	#HAVE_UINT32_T
 1

	)

1762 
	#HAVE_UINT8_T
 1

	)

1765 
	#HAVE_UNIFIED_BUFFERCACHE
 1

	)

1768 
	#HAVE_UNISTD_H
 1

	)

1771 
	#HAVE_UTIME_H
 1

	)

1774 
	#HAVE_UTIME_NULL
 1

	)

1783 
	#HAVE_VPRINTF
 1

	)

1786 
	#HAVE_VSYSLOG
 1

	)

1792 
	#HAVE__IO_GETC
 1

	)

1795 
	#HAVE__IO_PUTC
 1

	)

1798 
	#HAVE___FPRINTF_CHK
 1

	)

1801 
	#HAVE___READ_CHK
 1

	)

1804 
	#HAVE___VFPRINTF_CHK
 1

	)

1807 
	#LCPRODUCT
 "d™ã"

	)

1852 
	#LIBRARY_LIBC
 "libc.so.6"

	)

1870 
	#LIBRARY_PTHREAD
 "lib±hªad.so.0"

	)

1895 
	#LT_OBJDIR
 ".libs/"

	)

1898 
	#MAX_ERRNO_VALUES_FOR_SYMBOL
 124

	)

1901 
	#MAX_GAIERR_VALUES_FOR_SYMBOL
 10

	)

1919 
	#PACKAGE
 "d™ã"

	)

1922 
	#PACKAGE_BUGREPORT
 ""

	)

1925 
	#PACKAGE_NAME
 ""

	)

1928 
	#PACKAGE_STRING
 ""

	)

1931 
	#PACKAGE_TARNAME
 ""

	)

1934 
	#PACKAGE_URL
 ""

	)

1937 
	#PACKAGE_VERSION
 ""

	)

1940 
	#PRERELEASE
 0

	)

1943 
	#PRODUCT
 "D™ã"

	)

1946 
	#RECVBUF_IOCTLVAL
 
FIONREAD


	)

1949 
	#RETSIGTYPE
 

	)

1952 
	#SENDBUF_IOCTLVAL
 
TIOCOUTQ


	)

1955 
	#SIZEOF_CHAR
 1

	)

1958 
	#SIZEOF_INT
 4

	)

1961 
	#SIZEOF_LONG
 8

	)

1964 
	#SIZEOF_SHORT
 2

	)

1967 
	#SOCKD_CONFIGFILE
 "/ëc/sockd.c⁄f"

	)

1970 
	#SOCKD_PIDFILE
 "/v¨/run/sockd.pid"

	)

1973 
	#SOCKOPTNAME_MAXLEN
 26

	)

1976 
	#SOCKS_CONFIGFILE
 "/ëc/socks.c⁄f"

	)

1979 
	#SOCKS_DIRECTROUTE_FALLBACK
 0

	)

1985 
	#SOCKS_HOSTID_TYPE
 
SOCKS_HOSTID_TYPE_NONE


	)

1988 
	#SOCKS_IPV6_2292DSTOPTS_IPV4
 0

	)

1991 
	#SOCKS_IPV6_2292DSTOPTS_IPV6
 1

	)

1994 
	#SOCKS_IPV6_2292DSTOPTS_LVL
 
IPPROTO_IPV6


	)

1997 
	#SOCKS_IPV6_2292DSTOPTS_NAME
 "ùv6_2292d°›ts"

	)

2000 
	#SOCKS_IPV6_2292HOPLIMIT_IPV4
 0

	)

2003 
	#SOCKS_IPV6_2292HOPLIMIT_IPV6
 1

	)

2006 
	#SOCKS_IPV6_2292HOPLIMIT_LVL
 
IPPROTO_IPV6


	)

2009 
	#SOCKS_IPV6_2292HOPLIMIT_NAME
 "ùv6_2292h›limô"

	)

2012 
	#SOCKS_IPV6_2292HOPOPTS_IPV4
 0

	)

2015 
	#SOCKS_IPV6_2292HOPOPTS_IPV6
 1

	)

2018 
	#SOCKS_IPV6_2292HOPOPTS_LVL
 
IPPROTO_IPV6


	)

2021 
	#SOCKS_IPV6_2292HOPOPTS_NAME
 "ùv6_2292h››ts"

	)

2024 
	#SOCKS_IPV6_2292PKTINFO_IPV4
 0

	)

2027 
	#SOCKS_IPV6_2292PKTINFO_IPV6
 1

	)

2030 
	#SOCKS_IPV6_2292PKTINFO_LVL
 
IPPROTO_IPV6


	)

2033 
	#SOCKS_IPV6_2292PKTINFO_NAME
 "ùv6_2292pktöfo"

	)

2036 
	#SOCKS_IPV6_2292PKTOPTIONS_IPV4
 0

	)

2039 
	#SOCKS_IPV6_2292PKTOPTIONS_IPV6
 1

	)

2042 
	#SOCKS_IPV6_2292PKTOPTIONS_LVL
 
IPPROTO_IPV6


	)

2045 
	#SOCKS_IPV6_2292PKTOPTIONS_NAME
 "ùv6_2292pkt›ti⁄s"

	)

2048 
	#SOCKS_IPV6_2292RTHDR_IPV4
 0

	)

2051 
	#SOCKS_IPV6_2292RTHDR_IPV6
 1

	)

2054 
	#SOCKS_IPV6_2292RTHDR_LVL
 
IPPROTO_IPV6


	)

2057 
	#SOCKS_IPV6_2292RTHDR_NAME
 "ùv6_2292πhdr"

	)

2060 
	#SOCKS_IPV6_ADDRFORM_IPV4
 0

	)

2063 
	#SOCKS_IPV6_ADDRFORM_IPV6
 1

	)

2066 
	#SOCKS_IPV6_ADDRFORM_LVL
 
IPPROTO_IPV6


	)

2069 
	#SOCKS_IPV6_ADDRFORM_NAME
 "ùv6_addrf‹m"

	)

2084 
	#SOCKS_IPV6_ADD_MEMBERSHIP_IPV4
 0

	)

2087 
	#SOCKS_IPV6_ADD_MEMBERSHIP_IPV6
 1

	)

2090 
	#SOCKS_IPV6_ADD_MEMBERSHIP_LVL
 
IPPROTO_IPV6


	)

2093 
	#SOCKS_IPV6_ADD_MEMBERSHIP_NAME
 "ùv6_add_membîshù"

	)

2108 
	#SOCKS_IPV6_AUTHHDR_IPV4
 0

	)

2111 
	#SOCKS_IPV6_AUTHHDR_IPV6
 1

	)

2114 
	#SOCKS_IPV6_AUTHHDR_LVL
 
IPPROTO_IPV6


	)

2117 
	#SOCKS_IPV6_AUTHHDR_NAME
 "ùv6_authhdr"

	)

2144 
	#SOCKS_IPV6_CHECKSUM_IPV4
 0

	)

2147 
	#SOCKS_IPV6_CHECKSUM_IPV6
 1

	)

2150 
	#SOCKS_IPV6_CHECKSUM_LVL
 
IPPROTO_IPV6


	)

2153 
	#SOCKS_IPV6_CHECKSUM_NAME
 "ùv6_checksum"

	)

2168 
	#SOCKS_IPV6_DROP_MEMBERSHIP_IPV4
 0

	)

2171 
	#SOCKS_IPV6_DROP_MEMBERSHIP_IPV6
 1

	)

2174 
	#SOCKS_IPV6_DROP_MEMBERSHIP_LVL
 
IPPROTO_IPV6


	)

2177 
	#SOCKS_IPV6_DROP_MEMBERSHIP_NAME
 "ùv6_dr›_membîshù"

	)

2180 
	#SOCKS_IPV6_DSTOPTS_IPV4
 0

	)

2183 
	#SOCKS_IPV6_DSTOPTS_IPV6
 1

	)

2186 
	#SOCKS_IPV6_DSTOPTS_LVL
 
IPPROTO_IPV6


	)

2189 
	#SOCKS_IPV6_DSTOPTS_NAME
 "ùv6_d°›ts"

	)

2252 
	#SOCKS_IPV6_HOPLIMIT_IPV4
 0

	)

2255 
	#SOCKS_IPV6_HOPLIMIT_IPV6
 1

	)

2258 
	#SOCKS_IPV6_HOPLIMIT_LVL
 
IPPROTO_IPV6


	)

2261 
	#SOCKS_IPV6_HOPLIMIT_NAME
 "ùv6_h›limô"

	)

2264 
	#SOCKS_IPV6_HOPOPTS_IPV4
 0

	)

2267 
	#SOCKS_IPV6_HOPOPTS_IPV6
 1

	)

2270 
	#SOCKS_IPV6_HOPOPTS_LVL
 
IPPROTO_IPV6


	)

2273 
	#SOCKS_IPV6_HOPOPTS_NAME
 "ùv6_h››ts"

	)

2288 
	#SOCKS_IPV6_IPSEC_POLICY_IPV4
 0

	)

2291 
	#SOCKS_IPV6_IPSEC_POLICY_IPV6
 1

	)

2294 
	#SOCKS_IPV6_IPSEC_POLICY_LVL
 
IPPROTO_IPV6


	)

2297 
	#SOCKS_IPV6_IPSEC_POLICY_NAME
 "ùv6_ù£c_pﬁicy"

	)

2300 
	#SOCKS_IPV6_JOIN_ANYCAST_IPV4
 0

	)

2303 
	#SOCKS_IPV6_JOIN_ANYCAST_IPV6
 1

	)

2306 
	#SOCKS_IPV6_JOIN_ANYCAST_LVL
 
IPPROTO_IPV6


	)

2309 
	#SOCKS_IPV6_JOIN_ANYCAST_NAME
 "ùv6_joö_™yˇ°"

	)

2312 
	#SOCKS_IPV6_JOIN_GROUP_IPV4
 0

	)

2315 
	#SOCKS_IPV6_JOIN_GROUP_IPV6
 1

	)

2318 
	#SOCKS_IPV6_JOIN_GROUP_LVL
 
IPPROTO_IPV6


	)

2321 
	#SOCKS_IPV6_JOIN_GROUP_NAME
 "ùv6_joö_group"

	)

2324 
	#SOCKS_IPV6_LEAVE_ANYCAST_IPV4
 0

	)

2327 
	#SOCKS_IPV6_LEAVE_ANYCAST_IPV6
 1

	)

2330 
	#SOCKS_IPV6_LEAVE_ANYCAST_LVL
 
IPPROTO_IPV6


	)

2333 
	#SOCKS_IPV6_LEAVE_ANYCAST_NAME
 "ùv6_Àave_™yˇ°"

	)

2336 
	#SOCKS_IPV6_LEAVE_GROUP_IPV4
 0

	)

2339 
	#SOCKS_IPV6_LEAVE_GROUP_IPV6
 1

	)

2342 
	#SOCKS_IPV6_LEAVE_GROUP_LVL
 
IPPROTO_IPV6


	)

2345 
	#SOCKS_IPV6_LEAVE_GROUP_NAME
 "ùv6_Àave_group"

	)

2372 
	#SOCKS_IPV6_MTU_DISCOVER_IPV4
 0

	)

2375 
	#SOCKS_IPV6_MTU_DISCOVER_IPV6
 1

	)

2378 
	#SOCKS_IPV6_MTU_DISCOVER_LVL
 
IPPROTO_IPV6


	)

2381 
	#SOCKS_IPV6_MTU_DISCOVER_NAME
 "ùv6_mtu_discovî"

	)

2384 
	#SOCKS_IPV6_MTU_IPV4
 0

	)

2387 
	#SOCKS_IPV6_MTU_IPV6
 1

	)

2390 
	#SOCKS_IPV6_MTU_LVL
 
IPPROTO_IPV6


	)

2393 
	#SOCKS_IPV6_MTU_NAME
 "ùv6_mtu"

	)

2396 
	#SOCKS_IPV6_MULTICAST_HOPS_IPV4
 0

	)

2399 
	#SOCKS_IPV6_MULTICAST_HOPS_IPV6
 1

	)

2402 
	#SOCKS_IPV6_MULTICAST_HOPS_LVL
 
IPPROTO_IPV6


	)

2405 
	#SOCKS_IPV6_MULTICAST_HOPS_NAME
 "ùv6_mu…iˇ°_h›s"

	)

2408 
	#SOCKS_IPV6_MULTICAST_IF_IPV4
 0

	)

2411 
	#SOCKS_IPV6_MULTICAST_IF_IPV6
 1

	)

2414 
	#SOCKS_IPV6_MULTICAST_IF_LVL
 
IPPROTO_IPV6


	)

2417 
	#SOCKS_IPV6_MULTICAST_IF_NAME
 "ùv6_mu…iˇ°_if"

	)

2420 
	#SOCKS_IPV6_MULTICAST_LOOP_IPV4
 0

	)

2423 
	#SOCKS_IPV6_MULTICAST_LOOP_IPV6
 1

	)

2426 
	#SOCKS_IPV6_MULTICAST_LOOP_LVL
 
IPPROTO_IPV6


	)

2429 
	#SOCKS_IPV6_MULTICAST_LOOP_NAME
 "ùv6_mu…iˇ°_lo›"

	)

2432 
	#SOCKS_IPV6_NEXTHOP_IPV4
 0

	)

2435 
	#SOCKS_IPV6_NEXTHOP_IPV6
 1

	)

2438 
	#SOCKS_IPV6_NEXTHOP_LVL
 
IPPROTO_IPV6


	)

2441 
	#SOCKS_IPV6_NEXTHOP_NAME
 "ùv6_√xth›"

	)

2492 
	#SOCKS_IPV6_PKTINFO_IPV4
 0

	)

2495 
	#SOCKS_IPV6_PKTINFO_IPV6
 1

	)

2498 
	#SOCKS_IPV6_PKTINFO_LVL
 
IPPROTO_IPV6


	)

2501 
	#SOCKS_IPV6_PKTINFO_NAME
 "ùv6_pktöfo"

	)

2540 
	#SOCKS_IPV6_RECVDSTOPTS_IPV4
 0

	)

2543 
	#SOCKS_IPV6_RECVDSTOPTS_IPV6
 1

	)

2546 
	#SOCKS_IPV6_RECVDSTOPTS_LVL
 
IPPROTO_IPV6


	)

2549 
	#SOCKS_IPV6_RECVDSTOPTS_NAME
 "ùv6_ªcvd°›ts"

	)

2552 
	#SOCKS_IPV6_RECVERR_IPV4
 0

	)

2555 
	#SOCKS_IPV6_RECVERR_IPV6
 1

	)

2558 
	#SOCKS_IPV6_RECVERR_LVL
 
IPPROTO_IPV6


	)

2561 
	#SOCKS_IPV6_RECVERR_NAME
 "ùv6_ªcvîr"

	)

2564 
	#SOCKS_IPV6_RECVHOPLIMIT_IPV4
 0

	)

2567 
	#SOCKS_IPV6_RECVHOPLIMIT_IPV6
 1

	)

2570 
	#SOCKS_IPV6_RECVHOPLIMIT_LVL
 
IPPROTO_IPV6


	)

2573 
	#SOCKS_IPV6_RECVHOPLIMIT_NAME
 "ùv6_ªcvh›limô"

	)

2576 
	#SOCKS_IPV6_RECVHOPOPTS_IPV4
 0

	)

2579 
	#SOCKS_IPV6_RECVHOPOPTS_IPV6
 1

	)

2582 
	#SOCKS_IPV6_RECVHOPOPTS_LVL
 
IPPROTO_IPV6


	)

2585 
	#SOCKS_IPV6_RECVHOPOPTS_NAME
 "ùv6_ªcvh››ts"

	)

2648 
	#SOCKS_IPV6_RECVPKTINFO_IPV4
 0

	)

2651 
	#SOCKS_IPV6_RECVPKTINFO_IPV6
 1

	)

2654 
	#SOCKS_IPV6_RECVPKTINFO_LVL
 
IPPROTO_IPV6


	)

2657 
	#SOCKS_IPV6_RECVPKTINFO_NAME
 "ùv6_ªcvpktöfo"

	)

2672 
	#SOCKS_IPV6_RECVRTHDR_IPV4
 0

	)

2675 
	#SOCKS_IPV6_RECVRTHDR_IPV6
 1

	)

2678 
	#SOCKS_IPV6_RECVRTHDR_LVL
 
IPPROTO_IPV6


	)

2681 
	#SOCKS_IPV6_RECVRTHDR_NAME
 "ùv6_ªcvπhdr"

	)

2696 
	#SOCKS_IPV6_RECVTCLASS_IPV4
 0

	)

2699 
	#SOCKS_IPV6_RECVTCLASS_IPV6
 1

	)

2702 
	#SOCKS_IPV6_RECVTCLASS_LVL
 
IPPROTO_IPV6


	)

2705 
	#SOCKS_IPV6_RECVTCLASS_NAME
 "ùv6_ªcvt˛ass"

	)

2720 
	#SOCKS_IPV6_ROUTER_ALERT_IPV4
 0

	)

2723 
	#SOCKS_IPV6_ROUTER_ALERT_IPV6
 1

	)

2726 
	#SOCKS_IPV6_ROUTER_ALERT_LVL
 
IPPROTO_IPV6


	)

2729 
	#SOCKS_IPV6_ROUTER_ALERT_NAME
 "ùv6_rouãr_Æît"

	)

2732 
	#SOCKS_IPV6_RTHDRDSTOPTS_IPV4
 0

	)

2735 
	#SOCKS_IPV6_RTHDRDSTOPTS_IPV6
 1

	)

2738 
	#SOCKS_IPV6_RTHDRDSTOPTS_LVL
 
IPPROTO_IPV6


	)

2741 
	#SOCKS_IPV6_RTHDRDSTOPTS_NAME
 "ùv6_πhdrd°›ts"

	)

2744 
	#SOCKS_IPV6_RTHDR_IPV4
 0

	)

2747 
	#SOCKS_IPV6_RTHDR_IPV6
 1

	)

2750 
	#SOCKS_IPV6_RTHDR_LVL
 
IPPROTO_IPV6


	)

2753 
	#SOCKS_IPV6_RTHDR_NAME
 "ùv6_πhdr"

	)

2768 
	#SOCKS_IPV6_TCLASS_IPV4
 0

	)

2771 
	#SOCKS_IPV6_TCLASS_IPV6
 1

	)

2774 
	#SOCKS_IPV6_TCLASS_LVL
 
IPPROTO_IPV6


	)

2777 
	#SOCKS_IPV6_TCLASS_NAME
 "ùv6_t˛ass"

	)

2792 
	#SOCKS_IPV6_UNICAST_HOPS_IPV4
 0

	)

2795 
	#SOCKS_IPV6_UNICAST_HOPS_IPV6
 1

	)

2798 
	#SOCKS_IPV6_UNICAST_HOPS_LVL
 
IPPROTO_IPV6


	)

2801 
	#SOCKS_IPV6_UNICAST_HOPS_NAME
 "ùv6_uniˇ°_h›s"

	)

2816 
	#SOCKS_IPV6_V6ONLY_IPV4
 0

	)

2819 
	#SOCKS_IPV6_V6ONLY_IPV6
 1

	)

2822 
	#SOCKS_IPV6_V6ONLY_LVL
 
IPPROTO_IPV6


	)

2825 
	#SOCKS_IPV6_V6ONLY_NAME
 "ùv6_v6⁄ly"

	)

2828 
	#SOCKS_IPV6_XFRM_POLICY_IPV4
 0

	)

2831 
	#SOCKS_IPV6_XFRM_POLICY_IPV6
 1

	)

2834 
	#SOCKS_IPV6_XFRM_POLICY_LVL
 
IPPROTO_IPV6


	)

2837 
	#SOCKS_IPV6_XFRM_POLICY_NAME
 "ùv6_x‰m_pﬁicy"

	)

2852 
	#SOCKS_IP_ADD_MEMBERSHIP_IPV4
 1

	)

2855 
	#SOCKS_IP_ADD_MEMBERSHIP_IPV6
 0

	)

2858 
	#SOCKS_IP_ADD_MEMBERSHIP_LVL
 
IPPROTO_IP


	)

2861 
	#SOCKS_IP_ADD_MEMBERSHIP_NAME
 "ù_add_membîshù"

	)

2864 
	#SOCKS_IP_ADD_SOURCE_MEMBERSHIP_IPV4
 1

	)

2867 
	#SOCKS_IP_ADD_SOURCE_MEMBERSHIP_IPV6
 0

	)

2870 
	#SOCKS_IP_ADD_SOURCE_MEMBERSHIP_LVL
 
IPPROTO_IP


	)

2873 
	#SOCKS_IP_ADD_SOURCE_MEMBERSHIP_NAME
 "ù_add_sour˚_membîshù"

	)

2888 
	#SOCKS_IP_BLOCK_SOURCE_IPV4
 1

	)

2891 
	#SOCKS_IP_BLOCK_SOURCE_IPV6
 0

	)

2894 
	#SOCKS_IP_BLOCK_SOURCE_LVL
 
IPPROTO_IP


	)

2897 
	#SOCKS_IP_BLOCK_SOURCE_NAME
 "ù_block_sour˚"

	)

2936 
	#SOCKS_IP_DROP_MEMBERSHIP_IPV4
 1

	)

2939 
	#SOCKS_IP_DROP_MEMBERSHIP_IPV6
 0

	)

2942 
	#SOCKS_IP_DROP_MEMBERSHIP_LVL
 
IPPROTO_IP


	)

2945 
	#SOCKS_IP_DROP_MEMBERSHIP_NAME
 "ù_dr›_membîshù"

	)

2948 
	#SOCKS_IP_DROP_SOURCE_MEMBERSHIP_IPV4
 1

	)

2951 
	#SOCKS_IP_DROP_SOURCE_MEMBERSHIP_IPV6
 0

	)

2954 
	#SOCKS_IP_DROP_SOURCE_MEMBERSHIP_LVL
 
IPPROTO_IP


	)

2957 
	#SOCKS_IP_DROP_SOURCE_MEMBERSHIP_NAME
 "ù_dr›_sour˚_membîshù"

	)

2996 
	#SOCKS_IP_FREEBIND_IPV4
 1

	)

2999 
	#SOCKS_IP_FREEBIND_IPV6
 0

	)

3002 
	#SOCKS_IP_FREEBIND_LVL
 
IPPROTO_IP


	)

3005 
	#SOCKS_IP_FREEBIND_NAME
 "ù_‰ìböd"

	)

3008 
	#SOCKS_IP_HDRINCL_IPV4
 1

	)

3011 
	#SOCKS_IP_HDRINCL_IPV6
 0

	)

3014 
	#SOCKS_IP_HDRINCL_LVL
 
IPPROTO_IP


	)

3017 
	#SOCKS_IP_HDRINCL_NAME
 "ù_hdrö˛"

	)

3032 
	#SOCKS_IP_MINTTL_IPV4
 1

	)

3035 
	#SOCKS_IP_MINTTL_IPV6
 0

	)

3038 
	#SOCKS_IP_MINTTL_LVL
 
IPPROTO_IP


	)

3041 
	#SOCKS_IP_MINTTL_NAME
 "ù_möâl"

	)

3044 
	#SOCKS_IP_MTU_DISCOVER_IPV4
 1

	)

3047 
	#SOCKS_IP_MTU_DISCOVER_IPV6
 0

	)

3050 
	#SOCKS_IP_MTU_DISCOVER_LVL
 
IPPROTO_IP


	)

3053 
	#SOCKS_IP_MTU_DISCOVER_NAME
 "ù_mtu_discovî"

	)

3068 
	#SOCKS_IP_MULTICAST_IF_IPV4
 1

	)

3071 
	#SOCKS_IP_MULTICAST_IF_IPV6
 0

	)

3074 
	#SOCKS_IP_MULTICAST_IF_LVL
 
IPPROTO_IP


	)

3077 
	#SOCKS_IP_MULTICAST_IF_NAME
 "ù_mu…iˇ°_if"

	)

3080 
	#SOCKS_IP_MULTICAST_LOOP_IPV4
 1

	)

3083 
	#SOCKS_IP_MULTICAST_LOOP_IPV6
 0

	)

3086 
	#SOCKS_IP_MULTICAST_LOOP_LVL
 
IPPROTO_IP


	)

3089 
	#SOCKS_IP_MULTICAST_LOOP_NAME
 "ù_mu…iˇ°_lo›"

	)

3092 
	#SOCKS_IP_MULTICAST_TTL_IPV4
 1

	)

3095 
	#SOCKS_IP_MULTICAST_TTL_IPV6
 0

	)

3098 
	#SOCKS_IP_MULTICAST_TTL_LVL
 
IPPROTO_IP


	)

3101 
	#SOCKS_IP_MULTICAST_TTL_NAME
 "ù_mu…iˇ°_âl"

	)

3104 
	#SOCKS_IP_OPTIONS_IPV4
 1

	)

3107 
	#SOCKS_IP_OPTIONS_IPV6
 0

	)

3110 
	#SOCKS_IP_OPTIONS_LVL
 
IPPROTO_IP


	)

3113 
	#SOCKS_IP_OPTIONS_NAME
 "ù_›ti⁄s"

	)

3209 
	#SOCKS_IP_RECVTOS_IPV4
 1

	)

3212 
	#SOCKS_IP_RECVTOS_IPV6
 0

	)

3215 
	#SOCKS_IP_RECVTOS_LVL
 
IPPROTO_IP


	)

3218 
	#SOCKS_IP_RECVTOS_NAME
 "ù_ªcvtos"

	)

3221 
	#SOCKS_IP_RECVTTL_IPV4
 1

	)

3224 
	#SOCKS_IP_RECVTTL_IPV6
 0

	)

3227 
	#SOCKS_IP_RECVTTL_LVL
 
IPPROTO_IP


	)

3230 
	#SOCKS_IP_RECVTTL_NAME
 "ù_ªcvâl"

	)

3245 
	#SOCKS_IP_TOS_DSCP_NAME
 "ù_tos.ds˝"

	)

3248 
	#SOCKS_IP_TOS_IPV4
 1

	)

3251 
	#SOCKS_IP_TOS_IPV6
 0

	)

3254 
	#SOCKS_IP_TOS_LVL
 
IPPROTO_IP


	)

3257 
	#SOCKS_IP_TOS_NAME
 "ù_tos"

	)

3260 
	#SOCKS_IP_TOS_PREC_NAME
 "ù_tos.¥ec"

	)

3263 
	#SOCKS_IP_TOS_TOS_NAME
 "ù_tos.tos"

	)

3266 
	#SOCKS_IP_TTL_IPV4
 1

	)

3269 
	#SOCKS_IP_TTL_IPV6
 0

	)

3272 
	#SOCKS_IP_TTL_LVL
 
IPPROTO_IP


	)

3275 
	#SOCKS_IP_TTL_NAME
 "ù_âl"

	)

3278 
	#SOCKS_IP_UNBLOCK_SOURCE_IPV4
 1

	)

3281 
	#SOCKS_IP_UNBLOCK_SOURCE_IPV6
 0

	)

3284 
	#SOCKS_IP_UNBLOCK_SOURCE_LVL
 
IPPROTO_IP


	)

3287 
	#SOCKS_IP_UNBLOCK_SOURCE_NAME
 "ù_unblock_sour˚"

	)

3302 
	#SOCKS_NSIG
 128

	)

3305 
	#SOCKS_SO_ACCEPTCONN_IPV4
 1

	)

3308 
	#SOCKS_SO_ACCEPTCONN_IPV6
 1

	)

3311 
	#SOCKS_SO_ACCEPTCONN_LVL
 
SOL_SOCKET


	)

3314 
	#SOCKS_SO_ACCEPTCONN_NAME
 "so_ac˚±c⁄n"

	)

3341 
	#SOCKS_SO_BROADCAST_IPV4
 1

	)

3344 
	#SOCKS_SO_BROADCAST_IPV6
 1

	)

3347 
	#SOCKS_SO_BROADCAST_LVL
 
SOL_SOCKET


	)

3350 
	#SOCKS_SO_BROADCAST_NAME
 "so_brﬂdˇ°"

	)

3365 
	#SOCKS_SO_DEBUG_IPV4
 1

	)

3368 
	#SOCKS_SO_DEBUG_IPV6
 1

	)

3371 
	#SOCKS_SO_DEBUG_LVL
 
SOL_SOCKET


	)

3374 
	#SOCKS_SO_DEBUG_NAME
 "so_debug"

	)

3377 
	#SOCKS_SO_DONTROUTE_IPV4
 1

	)

3380 
	#SOCKS_SO_DONTROUTE_IPV6
 1

	)

3383 
	#SOCKS_SO_DONTROUTE_LVL
 
SOL_SOCKET


	)

3386 
	#SOCKS_SO_DONTROUTE_NAME
 "so_d⁄åouã"

	)

3389 
	#SOCKS_SO_ERROR_IPV4
 1

	)

3392 
	#SOCKS_SO_ERROR_IPV6
 1

	)

3395 
	#SOCKS_SO_ERROR_LVL
 
SOL_SOCKET


	)

3398 
	#SOCKS_SO_ERROR_NAME
 "so_îr‹"

	)

3413 
	#SOCKS_SO_KEEPALIVE_IPV4
 1

	)

3416 
	#SOCKS_SO_KEEPALIVE_IPV6
 1

	)

3419 
	#SOCKS_SO_KEEPALIVE_LVL
 
SOL_SOCKET


	)

3422 
	#SOCKS_SO_KEEPALIVE_NAME
 "so_kì∑live"

	)

3437 
	#SOCKS_SO_LINGER_IPV4
 1

	)

3440 
	#SOCKS_SO_LINGER_IPV6
 1

	)

3443 
	#SOCKS_SO_LINGER_LVL
 
SOL_SOCKET


	)

3446 
	#SOCKS_SO_LINGER_NAME
 "so_lögî"

	)

3473 
	#SOCKS_SO_OOBINLINE_IPV4
 1

	)

3476 
	#SOCKS_SO_OOBINLINE_IPV6
 1

	)

3479 
	#SOCKS_SO_OOBINLINE_LVL
 
SOL_SOCKET


	)

3482 
	#SOCKS_SO_OOBINLINE_NAME
 "so_oobölöe"

	)

3497 
	#SOCKS_SO_PRIORITY_IPV4
 1

	)

3500 
	#SOCKS_SO_PRIORITY_IPV6
 1

	)

3503 
	#SOCKS_SO_PRIORITY_LVL
 
SOL_SOCKET


	)

3506 
	#SOCKS_SO_PRIORITY_NAME
 "so_¥i‹ôy"

	)

3509 
	#SOCKS_SO_RCVBUFFORCE_IPV4
 1

	)

3512 
	#SOCKS_SO_RCVBUFFORCE_IPV6
 1

	)

3515 
	#SOCKS_SO_RCVBUFFORCE_LVL
 
SOL_SOCKET


	)

3518 
	#SOCKS_SO_RCVBUFFORCE_NAME
 "so_rcvbuff‹˚"

	)

3521 
	#SOCKS_SO_RCVBUF_IPV4
 1

	)

3524 
	#SOCKS_SO_RCVBUF_IPV6
 1

	)

3527 
	#SOCKS_SO_RCVBUF_LVL
 
SOL_SOCKET


	)

3530 
	#SOCKS_SO_RCVBUF_NAME
 "so_rcvbuf"

	)

3533 
	#SOCKS_SO_RCVLOWAT_IPV4
 1

	)

3536 
	#SOCKS_SO_RCVLOWAT_IPV6
 1

	)

3539 
	#SOCKS_SO_RCVLOWAT_LVL
 
SOL_SOCKET


	)

3542 
	#SOCKS_SO_RCVLOWAT_NAME
 "so_rcvlow©"

	)

3545 
	#SOCKS_SO_RCVTIMEO_IPV4
 1

	)

3548 
	#SOCKS_SO_RCVTIMEO_IPV6
 1

	)

3551 
	#SOCKS_SO_RCVTIMEO_LVL
 
SOL_SOCKET


	)

3554 
	#SOCKS_SO_RCVTIMEO_NAME
 "so_rcvtimeo"

	)

3557 
	#SOCKS_SO_REUSEADDR_IPV4
 1

	)

3560 
	#SOCKS_SO_REUSEADDR_IPV6
 1

	)

3563 
	#SOCKS_SO_REUSEADDR_LVL
 
SOL_SOCKET


	)

3566 
	#SOCKS_SO_REUSEADDR_NAME
 "so_ªu£addr"

	)

3569 
	#SOCKS_SO_REUSEPORT_IPV4
 1

	)

3572 
	#SOCKS_SO_REUSEPORT_IPV6
 1

	)

3575 
	#SOCKS_SO_REUSEPORT_LVL
 
SOL_SOCKET


	)

3578 
	#SOCKS_SO_REUSEPORT_NAME
 "so_ªu£p‹t"

	)

3581 
	#SOCKS_SO_SNDBUFFORCE_IPV4
 1

	)

3584 
	#SOCKS_SO_SNDBUFFORCE_IPV6
 1

	)

3587 
	#SOCKS_SO_SNDBUFFORCE_LVL
 
SOL_SOCKET


	)

3590 
	#SOCKS_SO_SNDBUFFORCE_NAME
 "so_¢dbuff‹˚"

	)

3593 
	#SOCKS_SO_SNDBUF_IPV4
 1

	)

3596 
	#SOCKS_SO_SNDBUF_IPV6
 1

	)

3599 
	#SOCKS_SO_SNDBUF_LVL
 
SOL_SOCKET


	)

3602 
	#SOCKS_SO_SNDBUF_NAME
 "so_¢dbuf"

	)

3605 
	#SOCKS_SO_SNDLOWAT_IPV4
 1

	)

3608 
	#SOCKS_SO_SNDLOWAT_IPV6
 1

	)

3611 
	#SOCKS_SO_SNDLOWAT_LVL
 
SOL_SOCKET


	)

3614 
	#SOCKS_SO_SNDLOWAT_NAME
 "so_¢dlow©"

	)

3617 
	#SOCKS_SO_SNDTIMEO_IPV4
 1

	)

3620 
	#SOCKS_SO_SNDTIMEO_IPV6
 1

	)

3623 
	#SOCKS_SO_SNDTIMEO_LVL
 
SOL_SOCKET


	)

3626 
	#SOCKS_SO_SNDTIMEO_NAME
 "so_¢dtimeo"

	)

3629 
	#SOCKS_SO_TIMESTAMP_IPV4
 1

	)

3632 
	#SOCKS_SO_TIMESTAMP_IPV6
 1

	)

3635 
	#SOCKS_SO_TIMESTAMP_LVL
 
SOL_SOCKET


	)

3638 
	#SOCKS_SO_TIMESTAMP_NAME
 "so_time°amp"

	)

3641 
	#SOCKS_SO_TYPE_IPV4
 1

	)

3644 
	#SOCKS_SO_TYPE_IPV6
 1

	)

3647 
	#SOCKS_SO_TYPE_LVL
 
SOL_SOCKET


	)

3650 
	#SOCKS_SO_TYPE_NAME
 "so_ty≥"

	)

3677 
	#SOCKS_TCP_CORK_IPV4
 1

	)

3680 
	#SOCKS_TCP_CORK_IPV6
 1

	)

3683 
	#SOCKS_TCP_CORK_LVL
 
IPPROTO_TCP


	)

3686 
	#SOCKS_TCP_CORK_NAME
 "t˝_c‹k"

	)

3749 
	#SOCKS_TCP_KEEPCNT_IPV4
 1

	)

3752 
	#SOCKS_TCP_KEEPCNT_IPV6
 1

	)

3755 
	#SOCKS_TCP_KEEPCNT_LVL
 
IPPROTO_TCP


	)

3758 
	#SOCKS_TCP_KEEPCNT_NAME
 "t˝_kìp˙t"

	)

3761 
	#SOCKS_TCP_KEEPIDLE_IPV4
 1

	)

3764 
	#SOCKS_TCP_KEEPIDLE_IPV6
 1

	)

3767 
	#SOCKS_TCP_KEEPIDLE_LVL
 
IPPROTO_TCP


	)

3770 
	#SOCKS_TCP_KEEPIDLE_NAME
 "t˝_kìpidÀ"

	)

3773 
	#SOCKS_TCP_KEEPINTVL_IPV4
 1

	)

3776 
	#SOCKS_TCP_KEEPINTVL_IPV6
 1

	)

3779 
	#SOCKS_TCP_KEEPINTVL_LVL
 
IPPROTO_TCP


	)

3782 
	#SOCKS_TCP_KEEPINTVL_NAME
 "t˝_kìpötvl"

	)

3785 
	#SOCKS_TCP_LINGER2_IPV4
 1

	)

3788 
	#SOCKS_TCP_LINGER2_IPV6
 1

	)

3791 
	#SOCKS_TCP_LINGER2_LVL
 
IPPROTO_TCP


	)

3794 
	#SOCKS_TCP_LINGER2_NAME
 "t˝_lögî2"

	)

3809 
	#SOCKS_TCP_MAXSEG_IPV4
 1

	)

3812 
	#SOCKS_TCP_MAXSEG_IPV6
 1

	)

3815 
	#SOCKS_TCP_MAXSEG_LVL
 
IPPROTO_TCP


	)

3818 
	#SOCKS_TCP_MAXSEG_NAME
 "t˝_max£g"

	)

3821 
	#SOCKS_TCP_MD5SIG_IPV4
 1

	)

3824 
	#SOCKS_TCP_MD5SIG_IPV6
 1

	)

3827 
	#SOCKS_TCP_MD5SIG_LVL
 
IPPROTO_TCP


	)

3830 
	#SOCKS_TCP_MD5SIG_NAME
 "t˝_md5sig"

	)

3845 
	#SOCKS_TCP_NODELAY_IPV4
 1

	)

3848 
	#SOCKS_TCP_NODELAY_IPV6
 1

	)

3851 
	#SOCKS_TCP_NODELAY_LVL
 
IPPROTO_TCP


	)

3854 
	#SOCKS_TCP_NODELAY_NAME
 "t˝_nodñay"

	)

3953 
	#SOCKS_TCP_SYNCNT_IPV4
 1

	)

3956 
	#SOCKS_TCP_SYNCNT_IPV6
 1

	)

3959 
	#SOCKS_TCP_SYNCNT_LVL
 
IPPROTO_TCP


	)

3962 
	#SOCKS_TCP_SYNCNT_NAME
 "t˝_syn˙t"

	)

3965 
	#SOCKS_TCP_WINDOW_CLAMP_IPV4
 1

	)

3968 
	#SOCKS_TCP_WINDOW_CLAMP_IPV6
 1

	)

3971 
	#SOCKS_TCP_WINDOW_CLAMP_LVL
 
IPPROTO_TCP


	)

3974 
	#SOCKS_TCP_WINDOW_CLAMP_NAME
 "t˝_wödow_˛amp"

	)

3977 
	#SOCKS_UDP_CORK_IPV4
 1

	)

3980 
	#SOCKS_UDP_CORK_IPV6
 1

	)

3983 
	#SOCKS_UDP_CORK_LVL
 
IPPROTO_UDP


	)

3986 
	#SOCKS_UDP_CORK_NAME
 "udp_c‹k"

	)

3989 
	#SPT_TYPE
 
SPT_REUSEARGV


	)

3992 
	#STDC_HEADERS
 1

	)

3995 
	#TIME_WITH_SYS_TIME
 1

	)

3998 
	#UNIQUE_ERRNO_VALUES
 119

	)

4001 
	#UNIQUE_GAIERR_VALUES
 10

	)

4004 
	#VERSION
 "1.4.1"

	)

4036 #i‚de‡
__˝lu•lus


4047 
	#ªs_›ti⁄s_ty≥_t
 
u_l⁄g


	)

4050 
	#ß_Àn_ty≥
 
sockÀn_t


	)

4065 
	~"ªdeÁc.h
"

	@include/common.h

47 #i‚de‡
_COMMON_H_


48 
	#_COMMON_H_


	)

51 #ifde‡
HAVE_CONFIG_H


52 
	~"autoc⁄f.h
"

55 #i‚de‡
NO_OSDEP


56 
	~"osdï.h
"

59 
	~"yacc⁄fig.h
"

61 
	~"c⁄fig.h
"

64 
c⁄fig
 
sockscf
;

65 *
__¥og«me
;

78 #i‡
STANDALONE_UNIT_TEST


79 
	#UNIT_TEST_STATIC_SCOPE


	)

81 
	#UNIT_TEST_STATIC_SCOPE
 

	)

84 #i‡
DIAGNOSTIC


91 
	#DO_SHMEMCHECK
 (0)

	)

93 
	#DO_SHMEMCHECK
 (0)

	)

100 
	#MAXLOGLEVELS
 (8)

	)

103 
	#PIPEBUFFER_IS_SEND_BASED
 (0)

	)

104 
	#PIPEBUFFER_IS_RECV_BASED
 (1)

	)

105 
	#PIPEBUFFER_IS_UNKNOWN_BASED
 (0)

	)

107 #i‡
HAVE_SOLARIS_BUGS


108 
	#HAVE_UNIQUE_SOCKET_INODES
 (0)

	)

110 
	#HAVE_UNIQUE_SOCKET_INODES
 (1)

	)

113 
	#SOCKS_IGNORE_SIGNALSAFETY
 (0)

	)

115 #i‡
PRERELEASE


124 #unde‡
HAVE_SENDMSG_DEADLOCK


125 
	#HAVE_SENDMSG_DEADLOCK
 1

	)

129 
	#TOIN
(
addr
Ë((
sockaddr_ö
 *)◊ddr))

	)

130 
	#TOCIN
(
addr
Ë((c⁄° 
sockaddr_ö
 *)◊ddr))

	)

132 
	#TOIN6
(
addr
Ë((
sockaddr_ö6
 *)◊ddr))

	)

133 
	#TOCIN6
(
addr
Ë((c⁄° 
sockaddr_ö6
 *)◊ddr))

	)

135 
	#TOSA
(
addr
Ë((
sockaddr
 *Ôddr)

	)

136 
	#TOCSA
(
addr
Ë((c⁄° 
sockaddr
 *Ôddr)

	)

137 
	#TOSS
(
addr
Ë((
sockaddr_°‹age
 *Ôddr)

	)

138 
	#TOCSS
(
addr
Ë((c⁄° 
sockaddr_°‹age
 *Ôddr)

	)

140 
	#IP_MAXPORT
 (65535Ë

	)

149 #ifde‡ 
MAXHOSTNAMELEN


150 #unde‡
MAXHOSTNAMELEN


152 
	#MAXHOSTNAMELEN
 (255 + 1Ë

	)

154 #i‚de‡ 
MAXSERVICELEN


155 
	#MAXSERVICELEN
 (255 + 1Ë

	)

159 #ifde‡ 
MAXURLLEN


160 #unde‡
MAXURLLEN


162 
	#MAXURLLEN
 (255 + 1Ë

	)

164 #ifde‡ 
MAXNAMELEN


165 #unde‡
MAXNAMELEN


167 
	#MAXNAMELEN
 (255 + 1Ë

	)

169 #ifde‡ 
MAXPWLEN


170 #unde‡
MAXPWLEN


172 
	#MAXPWLEN
 (255 + 1Ë

	)

174 
	#MAXTCPINFOLEN
 (2048)

	)

176 #i‡
HAVE_GSSAPI


177 #ifde‡
MAXGSSAPITOKENLEN


178 #unde‡
MAXGSSAPITOKENLEN


180 
	#MAXGSSAPITOKENLEN
 (1024 * 64 - 1Ë

	)

187 
	#GSSAPI_HLEN
 (4)

	)

193 
	#MAX_GSS_STATE
 (2000)

	)

198 
	#MAX_EXTERNAL_SOCKETOPTIONS
 (5)

	)

200 
	#MAXIFNAMELEN
 (255)

	)

202 
	#MAXSOCKADDRSTRING
 \

203 (("0000:0000:0000:0000:0000:0000:0000:0000.65535"))

	)

206 
	#MAXSOCKSHOSTSTRING
 (
MAXHOSTNAMELEN
 + 1 + 5)

	)

207 
	#MINSOCKSHOSTLEN
 ( 1 \

209 + 2 )

	)

211 
	#MAXSOCKSHOSTLEN
 ( 1 \

213 + 
MAXHOSTNAMELEN
 \

214 + 2 )

	)

216 
	#MINSOCKSUDPHLEN
 ( 2 \

218 + 
MINSOCKSHOSTLEN
)

	)

220 
	#MAXSOCKSUDPHLEN
 ( 2 \

222 + 
MAXSOCKSHOSTLEN
)

	)

224 
	#MAXRULEADDRSTRING
 (
MAXSOCKSHOSTSTRING
 * 2 + 32 )

	)

225 
	#MAXGWSTRING
 (
MAXSOCKSHOSTSTRING
)

	)

228 
	#MAXSUBDOMAINS
 (10Ë

	)

231 
	#MAXAUTHINFOLEN
 (((("("Ë- 1Ë+ 
MAXMETHODSTRING
) \

232 + ((")"Ë- 1Ë+ (("@"Ë- 1Ë+ 
MAXNAMELEN
)

	)

235 
	#MAXFACILITYNAMELEN
 (8 + 1Ë

	)

237 #i‚de‡
NUL


238 
	#NUL
 '\0'

	)

241 
	#CONFIGTYPE_SERVER
 1

	)

242 
	#CONFIGTYPE_CLIENT
 2

	)

244 
	#PROTOCOL_TCPs
 "t˝"

	)

245 
	#PROTOCOL_UDPs
 "udp"

	)

246 
	#PROTOCOL_UNKNOWNs
 "unknown"

	)

248 
	#SOCKS_TCP
 (1)

	)

249 
	#SOCKS_UDP
 (2)

	)

251 
	#RESOLVEPROTOCOL_UDP
 (
SOCKS_UDP
)

	)

252 
	#RESOLVEPROTOCOL_TCP
 (
SOCKS_TCP
)

	)

253 
	#RESOLVEPROTOCOL_FAKE
 (3)

	)

255 
	#LOGTYPE_SYSLOG
 0x1

	)

256 
	#LOGTYPE_FILE
 0x2

	)

262 #i‡
SOCKS_CLIENT


263 
	#LOG_NEGOTIATE
 (
LOG_INFO
)

	)

265 
	#LOG_NEGOTIATE
 (
LOG_DEBUG
)

	)

269 
	#NOMEM
 "<mem‹yÉxhau°ed>"

	)

272 
	#ENV_HTTP_PROXY
 "HTTP_CONNECT_PROXY"

	)

273 
	#ENV_SOCKS4_SERVER
 "SOCKS4_SERVER"

	)

274 
	#ENV_SOCKS5_PASSWD
 "SOCKS5_PASSWD"

	)

275 
	#ENV_SOCKS5_SERVER
 "SOCKS5_SERVER"

	)

276 
	#ENV_SOCKS5_USER
 "SOCKS5_USER"

	)

277 
	#ENV_SOCKS_BINDLOCALONLY
 "SOCKS_BINDLOCALONLY"

	)

278 
	#ENV_SOCKS_CONF
 "SOCKS_CONF"

	)

279 
	#ENV_SOCKS_DEBUG
 "SOCKS_DEBUG"

	)

280 
	#ENV_SOCKS_DIRECTROUTE_FALLBACK
 "SOCKS_DIRECTROUTE_FALLBACK"

	)

281 
	#ENV_SOCKS_DISABLE_THREADLOCK
 "SOCKS_DISABLE_THREADLOCK"

	)

282 
	#ENV_SOCKS_ERRLOGOUTPUT
 "SOCKS_ERRLOGOUTPUT"

	)

283 
	#ENV_SOCKS_LOGOUTPUT
 "SOCKS_LOGOUTPUT"

	)

284 
	#ENV_SOCKS_PASSWD
 "SOCKS_PASSWD"

	)

285 
	#ENV_SOCKS_PASSWORD
 "SOCKS_PASSWORD"

	)

286 
	#ENV_SOCKS_ROUTE_
 "SOCKS_ROUTE_"

	)

287 
	#ENV_SOCKS_SERVER
 "SOCKS_SERVER"

	)

288 
	#ENV_SOCKS_USER
 "SOCKS_USER"

	)

289 
	#ENV_SOCKS_USERNAME
 "SOCKS_USERNAME"

	)

290 
	#ENV_TMPDIR
 "TMPDIR"

	)

291 
	#ENV_UPNP_IGD
 "UPNP_IGD"

	)

292 
	#ENV_SOCKS_AUTOADD_LANROUTES
 "SOCKS_AUTOADD_LANROUTES"

	)

293 
	#ENV_SOCKS_REDIRECT_FROM
 "SOCKS_REDIRECT_FROM"

	)

303 
	#CTASSERT
(
exp
) \

305 íum { 
as£π_°©ic__
 = 1/(
exp
) }; \

306 }  0)

	)

312 #i‡
HAVE_LIVEDEBUG


314 #i‡
SOCKS_CLIENT


315 
	#SET_INTERNAL_ERROR
() do { \

316 
sockscf
.
°©e
.
öã∫Æîr‹dëe˘ed
 = 1; \

317 }  0)

	)

320 
	#SET_INTERNAL_ERROR
(Ëdÿ{ }  0)

	)

323 
	#HANDLE_RINGBUFFER
() \

325 
	`SET_INTERNAL_ERROR
(); \

327 i‡(!
sockscf
.
›ti⁄
.
debug
) \

328 
	`socks_Êushrb
(); \

329 }  0)

	)

332 
	#HANDLE_RINGBUFFER
(Ëdÿ{ }  0)

	)

336 
	#SASSERT_STARTSTRING
 "™ i¡î«»îr‹ wa†dëe˘edáà"

	)

337 
	#SASSERT_ENDSTRING
 \

338 "PÀa£Ñï‹àthi†tÿIn„∫ÿNëtvîk A/Sáà\"" 
LCPRODUCT
 "-bugs@inet.no\"."\

339 " PÀa£ check f‹á c‹edum∞too."

	)

341 
	#SIGNALSLOG_WITH_ERRNO
(
vÆue
, 
exp°r
, 
îr
) \

343 
_b
[10][32]; \

344 c⁄° *
_msgv
[] \

345 { 
SASSERT_STARTSTRING
, \

346 
__FILE__
, \

348 
	`…ﬂ
(
__LINE__
, 
_b
[0], (_b[0])), \

350 
	`…ﬂ
((
vÆue
), 
_b
[1], (_b[1])), \

352 (
exp°r
), \

354 
	`…ﬂ
(
îr
, 
_b
[2], (_b[2])), \

356 
	`°ªº‹
(
î∫o
), \

358 
rcsid
, \

360 
SASSERT_ENDSTRING
, \

361 
NULL
 \

364 
	`sig«l¶og
(
LOG_WARNING
, 
_msgv
); \

366 

	)

367 
	#SIGNALSLOG_WITHOUT_ERRNO
(
vÆue
, 
exp°r
) \

369 
_b
[10][32]; \

370 c⁄° *
_msgv
[] \

371 { 
SASSERT_STARTSTRING
, \

372 
__FILE__
, \

374 
	`…ﬂ
(
__LINE__
, 
_b
[0], (_b[0])), \

376 
	`…ﬂ
((
vÆue
), 
_b
[1], (_b[1])), \

378 (
exp°r
), \

381 
rcsid
, \

383 
SASSERT_ENDSTRING
, \

384 
NULL
 \

387 
	`sig«l¶og
(
LOG_WARNING
, 
_msgv
); \

388 }  0)

	)

390 
	#SIGNALSLOG_WITH_ERRNO_FAD
(
_vÆue
, 
exp°r
, 
îr
) \

392 
_b
[10][32]; \

393 c⁄° *
_msgv
[] \

394 { 
SASSERT_STARTSTRING
, \

395 
__FILE__
, \

397 
	`…ﬂ
(
__LINE__
, 
_b
[0], (_b[0])), \

399 
	`…ﬂ
(
	`gëµid
(), 
_b
[1], (_b[1])), \

401 
	`…ﬂ
((
_vÆue
), 
_b
[2], (_b[2])), \

403 (
exp°r
), \

405 
	`…ﬂ
(
îr
, 
_b
[3], (_b[3])), \

407 
	`°ªº‹
(
î∫o
), \

409 
rcsid
, \

411 
SASSERT_ENDSTRING
, \

412 
NULL
 \

415 
	`sig«l¶og
(
LOG_WARNING
, 
_msgv
); \

417 

	)

418 
	#SIGNALSLOG_WITHOUT_ERRNO_FAD
(
_vÆue
, 
exp°r
) \

420 
_b
[10][32]; \

421 c⁄° *
_msgv
[] \

422 { 
SASSERT_STARTSTRING
, \

423 
__FILE__
, \

425 
	`…ﬂ
(
__LINE__
, 
_b
[0], (_b[0])), \

427 
	`…ﬂ
(
	`gëµid
(), 
_b
[1], (_b[1])), \

429 
	`…ﬂ
((
_vÆue
), 
_b
[2], (_b[2])), \

431 (
exp°r
), \

434 
rcsid
, \

436 
SASSERT_ENDSTRING
, \

437 
NULL
 \

440 
	`sig«l¶og
(
LOG_WARNING
, 
_msgv
); \

441 }  0)

	)

443 
	#SERR_BODY
(
_vÆue
, 
exp°r
, 
_îr
) \

445 c⁄° 
îr
 = (
_îr
); \

447 
	`SIGNALSLOG_WITH_ERRNO
(
_vÆue
, 
exp°r
, 
îr
); \

448 
	`HANDLE_RINGBUFFER
(); \

449 
	`ab‹t
(); \

450 }  0)

	)

453 
	#SERRX_BODY
(
_vÆue
, 
exp°r
) \

455 
	`SIGNALSLOG_WITHOUT_ERRNO
(
_vÆue
, 
exp°r
); \

456 
	`HANDLE_RINGBUFFER
(); \

457 
	`ab‹t
(); \

458 }  0)

	)

461 
	#SWARN_BODY
(
_vÆue
, 
exp°r
, 
_îr
) \

463 
pid_t
 
f‹ked
; \

464 c⁄° 
îr
 = (
_îr
); \

466 (
f‹ked
 = 
	`f‹k
())) { \

468 
	`SIGNALSLOG_WITH_ERRNO
(
_vÆue
, 
exp°r
, 
îr
); \

472 
	`√w¥ocöô
(); \

473 
	`SIGNALSLOG_WITH_ERRNO_FAD
(
_vÆue
, 
exp°r
, 
îr
); \

474 
	`HANDLE_RINGBUFFER
(); \

475 
	`ab‹t
(); \

479 
	`SIGNALSLOG_PARENT_CONTINUING
(
f‹ked
); \

481 }  0)

	)

483 
	#SWARNX_BODY
(
_vÆue
, 
exp°r
) \

485 
pid_t
 
f‹ked
; \

487 (
f‹ked
 = 
	`f‹k
())) { \

489 
	`SIGNALSLOG_WITHOUT_ERRNO
(
_vÆue
, 
exp°r
); \

493 
	`√w¥ocöô
(); \

494 
	`SIGNALSLOG_WITHOUT_ERRNO_FAD
(
_vÆue
, 
exp°r
); \

495 
	`HANDLE_RINGBUFFER
(); \

496 
	`ab‹t
(); \

500 
	`SIGNALSLOG_PARENT_CONTINUING
(
f‹ked
); \

502 }  0)

	)

504 
	#SIGNALSLOG_PARENT_CONTINUING
(
chûdpid
) \

506 
_b
[10][32]; \

507 c⁄° *
_msgv
[] \

510 
	`…ﬂ
(
	`gëpid
(), 
_b
[0], (_b[0])), \

512 
	`…ﬂ
((
chûdpid
), 
_b
[1], (_b[1])), \

514 
NULL
 \

517 
	`sig«l¶og
(
LOG_WARNING
, 
_msgv
); \

518 }  0)

	)

521 
	#SWARN
(
ex¥essi⁄
) \

523 c⁄° 
_vÆue
 = (c⁄° )(
ex¥essi⁄
); \

524 c⁄° *
exp°r
 = #expression; \

526 
	`SWARN_BODY
(
_vÆue
, 
exp°r
, 
î∫o
); \

527 }  0)

	)

529 
	#SWARNX
(
ex¥essi⁄
) \

531 c⁄° 
_vÆue
 = (c⁄° )(
ex¥essi⁄
); \

532 c⁄° *
exp°r
 = #expression; \

534 
	`SWARNX_BODY
(
_vÆue
, 
exp°r
); \

535 }  0)

	)

537 
	#SERR
(
ex¥essi⁄
) \

539 c⁄° 
_vÆue
 = (c⁄° )(
ex¥essi⁄
); \

540 c⁄° *
exp°r
 = #expression; \

542 
	`SERR_BODY
(
_vÆue
, 
exp°r
, 
î∫o
); \

543 }  0)

	)

545 
	#SERRX
(
ex¥essi⁄
) \

547 c⁄° 
_vÆue
 = (c⁄° )(
ex¥essi⁄
); \

548 c⁄° *
exp°r
 = #expression; \

550 
	`SERRX_BODY
(
_vÆue
, 
exp°r
); \

551 }  0)

	)

553 
	#SASSERT
(
ex¥essi⁄
) \

555 c⁄° 
_vÆue
 = (c⁄° )(
ex¥essi⁄
); \

556 c⁄° *
exp°r
 = #expression; \

558 i‡(
_vÆue
 == 0) \

559 
	`SERR_BODY
(
_vÆue
, 
exp°r
, 
î∫o
); \

560 }  0)

	)

562 
	#SASSERTX
(
ex¥essi⁄
) \

564 c⁄° 
_vÆue
 = (c⁄° )(
ex¥essi⁄
); \

565 c⁄° *
exp°r
 = #expression; \

567 i‡(
_vÆue
 == 0) \

568 
	`SERRX_BODY
(
_vÆue
, 
exp°r
); \

569 }  0)

	)

573 
	#ab‹t
(Ëdÿ{ 
	`¶ìp
(60); } 1)

	)

580 
	#STRCPY_ASSERTLEN
(
__d°
, 
__§c
) \

582 c⁄° *
_§c
 = (
__§c
); \

583 c⁄° 
size_t
 
_Àn
 = 
	`°æí
((c⁄° *)
_§c
); \

584 *
_d°
 = (
__d°
); \

586 
	`SASSERTX
(
_Àn
 <(((
__d°
)) - 1)); \

587 
	`mem˝y
((
_d°
), (
_§c
), 
_Àn
 + 1); \

588 }  0)

	)

594 
	#timevÆ2£c⁄ds
(
tvÆ
) \

595 ((
tvÆ
)->
tv_£c
 + (—vÆ)->
tv_u£c
 >500000 ? 1 : 0))

	)

601 
	#STRCPY_CHECKLEN
(
__d°
, 
__§c
, 
_maxÀn
, 
_fun˘i⁄
) \

603 c⁄° *
_§c
 = (
__§c
); \

604 c⁄° 
size_t
 
_Àn
 = 
	`°æí
((c⁄° *)
_§c
); \

605 *
_d°
 = (
__d°
); \

607 i‡(
_Àn
 >(
_maxÀn
) - 1) { \

608 
	`_fun˘i⁄
("the value given is %lu bytesÜong, butÅhe maximumÜength, " \

610 ()(
_Àn
), \

611 ()((
_maxÀn
))); \

615 
	`mem˝y
((
_d°
), (
_§c
), 
_Àn
 + 1); \

616 }  0)

	)

619 
	#STRCPY_ASSERTSIZE
(
__d°
, 
__§c
) \

621 c⁄° *
_§c
 = (
__§c
); \

622 c⁄° 
size_t
 
_Àn
 = 
	`°æí
((c⁄° *)
_§c
); \

623 *
_d°
 = (
__d°
); \

625 
	`CTASSERT
(((
__d°
)Ë>((
__§c
))); \

626 
	`SASSERTX
(
_Àn
 + 1 <((
__d°
))); \

627 
	`SASSERTX
(
_Àn
 + 1 <((
__§c
))); \

629 
	`mem˝y
((
_d°
), (
_§c
), 
_Àn
 + 1); \

630 } 0 )

	)

633 
	#STRCPY_CHECKUTFLEN
(
__d°
, 
__§c
, 
_maxÀn
, 
_fun˘i⁄
) \

635 c⁄° *
_§c
 = (
__§c
); \

636 c⁄° 
size_t
 
_Àn
 = 
	`°æí
((c⁄° *)
__§c
); \

637 *
_d°
 = (
__d°
); \

638 *
utf§c
; \

640 i‡(
_Àn
 / 2 >((
_maxÀn
) - 1)) { \

641 
	`_fun˘i⁄
("the value given is %lu bytesÜong, butÅhe maximumÜength, " \

643 ()(
_Àn
 / 2), \

644 ()((
_maxÀn
) - 1)); \

648 i‡((
utf§c
 = 
	`hextoutf8
((c⁄° *)
_§c
, 2)Ë=
NULL
) \

649 
	`_fun˘i⁄
("failedÅo convert string \"%s\"Åo UTF-8", \

650 (c⁄° *)
_§c
); \

652 
	`°∫˝y
((*)
_d°
, 
utf§c
, (
_maxÀn
) - 1); \

653 ((*)(
_d°
))[(
_maxÀn
Ë- 1] = 
NUL
; \

654 }  0)

	)

657 
	#TVMIN
(
a
, 
b
) \

658 (
	`timîcmp
((
a
), (
b
), <Ë? (aË: (b))

	)

660 
	#TVMAX
(
a
, 
b
) \

661 (
	`timîcmp
((
a
), (
b
), >Ë? (aË: (b))

	)

670 
	#socksho°2sockaddr2
(
ho°
, 
addr
, 
gaõº
, 
emsg
, 
emsgÀn
) \

671 
	`öt_socksho°2sockaddr2
((
ho°
), \

672 (
addr
), \

673 ((*
addr
)), \

674 (
gaõº
), \

675 (
emsg
), \

676 (
emsgÀn
)) \

677 

	)

678 
	#socksho°2sockaddr
(
ho°
, 
addr
) \

679 
	`öt_socksho°2sockaddr
((
ho°
), 
addr
, ((*addr)))

	)

681 
	#Ákesocksho°2sockaddr
(
ho°
, 
addr
) \

682 
	`öt_Ákesocksho°2sockaddr
((
ho°
), (
addr
), ((*addr)))

	)

684 
	#uæ°rög2sockaddr
(
°rög
, 
addr
, 
gaõº
, 
emsg
, 
ñí
) \

685 
	`öt_uæ°rög2sockaddr
((
°rög
), \

686 (
addr
), \

687 ((*
addr
)), \

688 (
gaõº
), \

689 (
emsg
), \

690 (
ñí
))

	)

692 
	#ruÀaddr2sockaddr
(
ruÀaddr
, 
addr
, 
¥Ÿocﬁ
) \

693 
	`öt_ruÀaddr2sockaddr
((
ruÀaddr
), (
addr
), ((*addr)), (
¥Ÿocﬁ
))

	)

695 
	#ruÀaddr2sockaddr2
(
ruÀaddr
, 
addr
, 
¥Ÿocﬁ
, 
gaõº
, 
emsg
, 
emsgÀn
) \

696 
	`öt_ruÀaddr2sockaddr2
((
ruÀaddr
), \

697 (
addr
), \

698 (((*
addr
))), \

699 (
¥Ÿocﬁ
), \

700 (
gaõº
), \

701 (
emsg
), \

702 (
emsgÀn
))

	)

704 
	#ho°«me2sockaddr
(
«me
, 
ödex
, 
addr
) \

705 
	`öt_ho°«me2sockaddr
((
«me
), (
ödex
), 
addr
, ((*addr)))

	)

707 
	#ho°«me2sockaddr2
(
«me
, 
ödex
, 
addr
, 
gaõº
, 
emsg
, 
emsgÀn
) \

708 
	`öt_ho°«me2sockaddr2
(
«me
, \

709 
ödex
, \

710 
addr
, \

711 ((*
addr
)), \

712 
gaõº
, \

713 
emsg
, \

714 
emsgÀn
)

	)

716 
	#i‚ame2sockaddr
(
i‚ame
, 
ödex
, 
addr
, 
mask
) \

717 
	`öt_i‚ame2sockaddr
((
i‚ame
), \

718 (
ödex
), \

719 (
addr
), \

720 ((*
addr
)), \

721 (
mask
), \

722 ((*
mask
)))

	)

725 #i‡
HAVE_GSSAPI


726 
	#GSSAPI_OVERHEAD
(
gsßpi°©e
) \

727 ((
MAXGSSAPITOKENLEN
 - 
GSSAPI_HLEN
Ë- (
gsßpi°©e
)->
maxgssd©a
)

	)

729 
	#GSSERR_IS_OK
(
e
) \

730 –(
e
Ë=
GSS_S_CONTEXT_EXPIRED
 \

731 || (
e
Ë=
GSS_S_CREDENTIALS_EXPIRED
)

	)

739 
	#DEBUG_NORMAL
 (1)

	)

740 
	#DEBUG_VERBOSE
 (2)

	)

741 
	#DEBUG_DEBUG
 (9Ë

	)

749 #i‡
SOCKS_CLIENT


751 
	#SOCKS_SIGBLOCK_IF_CLIENT
(
sig
, 
ﬁd£t
) \

752 dÿ{ 
	`socks_sigblock
(
sig
, 
ﬁd£t
); }  0)

	)

754 
	#SOCKS_SIGUNBLOCK_IF_CLIENT
(
ﬁd£t
) \

755 dÿ{ 
	`socks_sigunblock
(
ﬁd£t
); }  0)

	)

757 
	#SIGSET_ALLOCATE
(
«me
Ë
sig£t_t
 
	)
name

760 
	#SIGSET_ALLOCATE
(
«me
)

	)

761 
	#SOCKS_SIGBLOCK_IF_CLIENT
(
sig
, 
ﬁd£t
)

	)

762 
	#SOCKS_SIGUNBLOCK_IF_CLIENT
(
ﬁd£t
)

	)

766 
	#FD_IS_RESERVED_EXTERNAL
(
fd
) \

767 ((
fd
Ë=
STDOUT_FILENO
 || (fdË=
STDERR_FILENO
)

	)

781 
	#socks_dif·ime
(
t1
, 
t2
Ë(—1Ë- (t2))

	)

787 
	#˛o£
(
n
Ë
	`˛o£n
(“))

	)

788 
	#sockë
(
d
, 
t
, 
p
Ë
	`socks_sockë
((d), (t), (p))

	)

789 
	#°ªº‹
(
e
Ë
	`socks_°ªº‹
(”))

	)

790 
	#gëiÁddrs
(
iÁp
Ë
	`socks_gëiÁddrs
((iÁp))

	)

791 
	#gai_°ªº‹
(
îrcode
Ë
	`socks_gai_°ªº‹
(”ºcode))

	)

793 #unde‡
¢¥ötf


794 
	#¢¥ötf
 
¢¥öt‚


	)

800 
	#STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù
) \

802 
ssize_t
 
i
; \

804 
i
 = (
ssize_t
)(
°ru£d
) - 1; i > 0; --i) \

805 i‡(
	`°rchr
((
°rù
), 
°r
[
i
]Ë!
NULL
) \

806 (
°r
)[
i
] = 
NUL
; \

809 }  0)

	)

811 
	#SKIPLEADING
(
°r
, 
°rù
) \

813 *(
°r
Ë!
NUL
) \

814 i‡(
	`°rchr
((
°rù
), *(
°r
))) \

815 ++(
°r
); \

818 }  0)

	)

827 #i‚de‡
howm™y


828 
	#howm™y
(
x
, 
y
Ë(((xË+ ((yË- 1)Ë/ (y))

	)

831 
	#SOCKD_FD_SIZE
() \

832 ((
size_t
)(
	`howm™y
((
sockscf
.
°©e
.
max›ífûes
 + 1), 
NFDBITS
Ë* (
fd_mask
)))

	)

834 #ifde‡
FD_ZERO


835 #unde‡
FD_ZERO


838 
	#FD_ZERO
(
p
) \

840 
	`mem£t
((
p
), 0, 
	`SOCKD_FD_SIZE
()); \

841 }  0)

	)

843 #ifde‡
FD_CMP


844 #unde‡
FD_CMP


847 
	#FD_CMP
(
a
, 
b
Ë(
	`memcmp
(◊), (b), 
	`SOCKD_FD_SIZE
()))

	)

849 #ifde‡
FD_COPY


850 #unde‡
FD_COPY


853 
	#FD_COPY
(
d°
, 
§c
) \

855 
	`mem˝y
((
d°
), (
§c
), 
	`SOCKD_FD_SIZE
()); \

856 }  0)

	)

860 
	#ERRNOISNOFILE
(
î∫o
) \

861 ((
î∫o
Ë=
EMFILE
 || (î∫oË=
ENFILE
)

	)

863 
	#ERRNOISRST
(
î∫o
) \

864 ((
î∫o
Ë=
ECONNREFUSED
 || (î∫oË=
ECONNRESET
)

	)

866 
	#ERRNOISPREVIOUSPACKET
(
î∫o
) \

867 –
	`ERRNOISRST
(
î∫o
) \

868 || 
	`ERRNOISNOROUTE
(
î∫o
) \

869 || 
	`ERRNOISACCES
(
î∫o
) \

870 || (
î∫o
Ë=
EMSGSIZE
 \

871 || (
î∫o
Ë=
ETIMEDOUT
 \

872 )

	)

874 
	#ERRNOISTMP
(
î∫o
) \

875 –(
î∫o
Ë=
EAGAIN
 \

876 || (
î∫o
Ë=
EWOULDBLOCK
 \

877 || (
î∫o
Ë=
EINTR
 \

878 || (
î∫o
Ë=
ENOBUFS
 \

879 || (
î∫o
Ë=
ENOMEM
 \

880 || (
î∫o
Ë=
ENOMSG
)

	)

882 
	#ERRNOISACCES
(
î∫o
Ë(”ºnoË=
EPERM
 || (î∫oË=
EACCES
)

	)

884 
	#ERRNOISNOROUTE
(
î∫o
) \

885 ((
î∫o
Ë=
ENETUNREACH
 || (î∫oË=
EHOSTUNREACH
 || (î∫oË=
ENETDOWN
)

	)

887 
	#ERRNOISNETWORK
(
î∫o
) (\

888 
	`ERRNOISNOROUTE
(
î∫o
) \

889 || 
	`ERRNOISRST
(
î∫o
) \

890 )

	)

892 
	#PORTISRESERVED
(
p‹t
) \

893 (
	`¡ohs
((
p‹t
)Ë!0 &&Çtohs(’‹t)Ë< 
IPPORT_RESERVED
)

	)

895 
	#IPADDRISBOUND
(
addr
) \

896 (
	`TOSA
((
addr
))->
ß_Ámûy
 =
AF_UNSPEC
 ? \

897 0 : (
	`TOSA
((
addr
))->
ß_Ámûy
 =
AF_INET
 ? \

898 (
	`TOIN
((
addr
))->
sö_addr
.
s_addr
 !
	`ht⁄l
(
INADDR_ANY
)) \

899 : (
	`memcmp
(
	`TOIN6
((
addr
))->
sö6_addr
.
s6_addr
, \

900 &
ö6addr_™y
, \

901 (
ö6addr_™y
)) != 0)) \

902 )

	)

904 
	#PORTISBOUND
(
addr
) \

905 (
	`TOSA
((
addr
))->
ß_Ámûy
 =
AF_UNSPEC
 ? \

906 0 : (
	`TOSA
((
addr
))->
ß_Ámûy
 =
AF_INET
 ? \

907 (
	`¡ohs
(
	`TOIN
((
addr
))->
sö_p‹t
) != 0) \

908 : (
	`¡ohs
(
	`TOIN6
((
addr
))->
sö6_p‹t
)) != 0) \

909 )

	)

911 
	#ADDRISBOUND
(
addr
) \

912 (
	`IPADDRISBOUND
((
addr
)Ë&& 
	`PORTISBOUND
(◊ddr)))

	)

914 
	#SOCKSHOSTISNOTBOUND
(
ho°
) \

915 ((
ho°
)->
p‹t
 =
	`ht⁄s
(0Ë|| !
	`SOCKSHOST_ADDRISBOUND
(ho°))

	)

917 
	#SOCKSHOSTISBOUND
(
ho°
Ë(!(
	`SOCKSHOSTISNOTBOUND
((ho°))))

	)

919 
	#SOCKSHOST_ADDRISBOUND
(
ho°
) \

920 –((
ho°
)->
©y≥
 =
SOCKS_ADDR_DOMAIN
 && *ho°->
addr
.
domaö
 !
NUL
) \

921 || ((
ho°
)->
©y≥
 =
SOCKS_ADDR_IPV4
 \

922 && (
ho°
)->
addr
.
ùv4
.
s_addr
 !
	`ht⁄l
(
INADDR_ANY
)) \

923 || ((
ho°
)->
©y≥
 =
SOCKS_ADDR_IPV6
 \

924 && 
	`memcmp
(&(
ho°
)->
addr
.
ùv6
, &
ö6addr_™y
, (ö6addr_™y))Ë!0)

	)

926 
	#RULEPORT_START
(
addr
, 
¥Ÿocﬁ
) ( \

927 ((
¥Ÿocﬁ
Ë=
SOCKS_TCP
 ? (
addr
)->
p‹t
.
t˝
 : (addr)->p‹t.
udp
))

	)

929 #i‡
HAVE_SOCKADDR_STORAGE_SS_LEN


931 
	#SET_SOCKADDRLEN
(
ss
, 
Àn
) \

933 ((
ss
)->
ss_Àn
 = (
Àn
)); \

934 }  0)

	)

938 
	#SET_SOCKADDRLEN
(
ss
, 
Àn
)

	)

942 
	#SET_SOCKADDR
(
ß
, 
Ámûy
) \

944 ((
ß
)->
ss_Ámûy
 = (
Ámûy
)); \

945 
	`SET_SOCKADDRLEN
((
ß
), 
	`ßÀn
((
Ámûy
))); \

946 }  0)

	)

948 
	#SET_SOCKADDRPORT
(
ß
, 
p‹t
) \

950 (
ß
)->
ss_Ámûy
) { \

951 
AF_INET
: \

952 (
	`TOIN
(
ß
))->
sö_p‹t
 = (
p‹t
); \

955 
AF_INET6
: \

956 (
	`TOIN6
(
ß
))->
sö6_p‹t
 = (
p‹t
); \

960 
	`SERRX
((
ß
)->
ss_Ámûy
); \

962 }  0)

	)

965 
	#GET_SOCKADDRPORT
(
ß
) \

966 (((
ß
)->
ss_Ámûy
Ë=
AF_INET
 ? \

967 
	`TOCIN
(
ß
)->
sö_p‹t
 : 
	`TOCIN6
(ß)->
sö6_p‹t
) \

968 

	)

969 
	#SET_SOCKADDRADDR
(
ß
, 
addr
) \

971 (
ß
)->
ss_Ámûy
) { \

972 
AF_INET
: \

973 
	`mem˝y
(&(
	`TOIN
(
ß
))->
sö_addr
, 
addr
, (TOIN(sa))->sin_addr); \

976 
AF_INET6
: \

977 
	`mem˝y
(&(
	`TOIN6
(
ß
))->
sö6_addr
, 
addr
, (TOIN6(sa))->sin6_addr); \

981 
	`SERRX
((
ß
)->
ss_Ámûy
); \

983 }  0)

	)

986 
	#GET_SOCKADDRADDR
(
ß
) \

987 (((
ß
)->
ss_Ámûy
Ë=
AF_INET
 ? \

988 ((c⁄° *)&(
	`TOCIN
(
ß
)->
sö_addr
)) \

989 : ((c⁄° *)&(
	`TOCIN6
(
ß
)->
sö6_addr
))) \

990 

	)

993 
	#ELEMENTS
(
¨øy
Ë(◊ºayË/ ◊ºay[0]))

	)

995 
	#OCTETIFY
(
a
Ë(◊Ë&0xff)

	)

1006 
	#SENDMSG_PADBYTES
 ((Ë* 64Ë

	)

1018 #i‡
HAVE_CMSGHDR


1020 #i‡!
HAVE_CMSG_LEN


1021 
	#CMSG_LEN
(
Àn
Ë((
cmsghdr
Ë+ (Àn))

	)

1024 #i‡!
HAVE_CMSG_SPACE


1025 
	#CMSG_SPACE
(
Àn
Ë((
cmsghdr
Ë+ (Àn))

	)

1030 #i‡!
HAVE_CMSG_LEN


1031 
	#CMSG_LEN
(
Àn
Ë÷í)

	)

1034 #i‡!
HAVE_CMSG_SPACE


1035 
	#CMSG_SPACE
(
Àn
Ë÷í)

	)

1044 #i‡
HAVE_CMSGHDR


1046 
	#CMSG_AALLOC
(
«me
, 
size
) \

1048 
cmsgmem
[
	`CMSG_SPACE
(
size
)]; \

1049 
cmsghdr
 
Æign
; \

1050 } 
	`__CONCAT3
(
_
, 
«me
, 
mem
) = { { 0 } }; \

1051 
cmsghdr
 *
«me
 = (cmsghd∏*)
	`__CONCAT3
(
_
,Çame, 
mem
).
cmsgmem
;

	)

1055 
	#CMSG_AALLOC
(
«me
, 
size
) \

1056 

	)

1057 
	g«me
[(
size
)] = 
NUL
;

1066 #i‡
HAVE_CMSGHDR


1067 
	#CMSG_MEMSIZE
(
«me
Ë((
	`__CONCAT3
(
_
,Çame, 
mem
)))

	)

1069 
	#CMSG_MEMSIZE
(
«me
Ë((“ame)))

	)

1078 
	#CMSG_RCPTLEN_ISOK
(
msg
, 
d©Æí
) \

1079 ((
d©Æí
Ë=0 ? ((
size_t
)(
	`CMSG_TOTLEN
(
msg
) == 0)) \

1080 : ((
size_t
)
	`CMSG_TOTLEN
((
msg
)Ë=(size_t)(
	`CMSG_SPACE
((
d©Æí
))) \

1081 || (
size_t
)
	`CMSG_TOTLEN
((
msg
)Ë=(size_t)(
	`CMSG_LEN
((
d©Æí
)))))

	)

1086 #i‡
HAVE_CMSGHDR


1091 
	#CMSG_CONTROLDATA
(
msg
Ë((msg).
msg_c⁄åﬁ
)

	)

1093 
	#CMSG_CONTROLDATA
(
msg
Ë((msg).
msg_ac¸ights
)

	)

1100 #i‡
HAVE_CMSGHDR


1101 
	#CMSG_ADDOBJECT
(
obje˘
, 
d©a
, 
off£t
) \

1103 
	`mem˝y
(
	`CMSG_DATA
(
d©a
Ë+ (
off£t
), &(
obje˘
), (object)); \

1104  0)

	)

1106 
	#CMSG_ADDOBJECT
(
obje˘
, 
d©a
, 
off£t
) \

1108 
	`mem˝y
(
d©a
 + (
off£t
), &(
obje˘
), ((object))); \

1109  0)

	)

1117 #i‡
HAVE_CMSGHDR


1118 
	#CMSG_GETOBJECT
(
obje˘
, 
d©a
, 
off£t
) \

1120 
	`mem˝y
(&(
obje˘
), 
	`CMSG_DATA
((
d©a
)Ë+ (
off£t
), ((object))); \

1121  0)

	)

1123 
	#CMSG_GETOBJECT
(
obje˘
, 
d©a
, 
off£t
) \

1125 
	`mem˝y
(&(
obje˘
), ((
d©a
Ë+ (
off£t
)), ((object))); \

1126  0)

	)

1136 #i‡
HAVE_CMSGHDR


1137 
	#CMSG_SETHDR_SEND
(
obje˘
, 
c⁄åﬁmem
, 
size
) \

1139 i‡(
size
 == 0) { \

1140 
obje˘
.
msg_c⁄åﬁ
 = 
NULL
; \

1141 
obje˘
.
msg_c⁄åﬁÀn
 = 0; \

1144 
	`bzîo
(
c⁄åﬁmem
, (*controlmem)); \

1146 
c⁄åﬁmem
->
cmsg_Àvñ
 = 
SOL_SOCKET
; \

1147 
c⁄åﬁmem
->
cmsg_ty≥
 = 
SCM_RIGHTS
; \

1148 
c⁄åﬁmem
->
cmsg_Àn
 = 
	`CMSG_LEN
(
size
); \

1150 
obje˘
.
msg_c⁄åﬁ
 = (
ˇddr_t
)
c⁄åﬁmem
; \

1151 
obje˘
.
msg_c⁄åﬁÀn
 = (
size
Ë=0 ? 0 : 
	`CMSG_SPACE
((size)); \

1153 }  0)

	)

1155 
	#CMSG_SETHDR_SEND
(
obje˘
, 
c⁄åﬁmem
, 
size
) \

1157 
obje˘
.
msg_ac¸ights
 = (
ˇddr_t
)
c⁄åﬁmem
; \

1158 
obje˘
.
msg_ac¸ight¶í
 = (
size
); \

1159 }  0)

	)

1166 #i‡
HAVE_CMSGHDR


1167 
	#CMSG_SETHDR_RECV
(
obje˘
, 
c⁄åﬁmem
, 
size
) \

1169 
obje˘
.
msg_c⁄åﬁ
 = (
ˇddr_t
)
c⁄åﬁmem
; \

1170 
obje˘
.
msg_c⁄åﬁÀn
 = (
size
); \

1171 }  0)

	)

1173 
	#CMSG_SETHDR_RECV
(
obje˘
, 
c⁄åﬁmem
, 
size
) \

1175 
obje˘
.
msg_ac¸ights
 = (
ˇddr_t
)
c⁄åﬁmem
; \

1176 
obje˘
.
msg_ac¸ight¶í
 = (
size
); \

1177 }  0)

	)

1181 #i‡
HAVE_CMSGHDR


1182 
	#CMSG_GETLEN
(
msg
Ë((msg).
msg_c⁄åﬁÀn
 - 
	`CMSG_LEN
(0))

	)

1184 
	#CMSG_GETLEN
(
msg
Ë((msg).
msg_ac¸ight¶í
)

	)

1187 #i‡
HAVE_CMSGHDR


1188 
	#CMSG_TOTLEN
(
msg
Ë((msg).
msg_c⁄åﬁÀn
)

	)

1190 
	#CMSG_TOTLEN
(
msg
Ë((msg).
msg_ac¸ight¶í
)

	)

1195 
	#HEADERSIZE_UDP
(
∑ckë
) ( \

1196 ((
∑ckë
)->
Êag
Ë+ (’ackë)->
‰ag
) \

1197 + ((
∑ckë
)->
ho°
.
©y≥
Ë+ (’ackë)->ho°.
p‹t
) \

1198 + (
	`ADDRESSIZE_V5
(
∑ckë
)))

	)

1205 
	#ADDRESSIZE
(
∑ckë
) ( \

1206 ((
∑ckë
)->
vîsi⁄
 =
SOCKS_V4
 ? \

1207 (
	`ADDRESSIZE_V4
(
∑ckë
)Ë: (
	`ADDRESSIZE_V5
’ackë))))

	)

1212 
	#ADDRESSIZE_V5
(
∑ckë
) ( \

1213 (
∑ckë
)->
ho°
.
©y≥
 =
SOCKS_ADDR_IPV4
 ? \

1214 ((
∑ckë
)->
ho°
.
addr
.
ùv4
) \

1215 : (
∑ckë
)->
ho°
.
©y≥
 =()
SOCKS_ADDR_IPV6
 ? \

1216 ((
∑ckë
)->
ho°
.
addr
.
ùv6
.
ù
) \

1217 : (
	`°æí
((
∑ckë
)->
ho°
.
addr
.
domaö
Ë+ 1))

	)

1219 
	#ADDRESSIZE_V4
(
∑ckë
) ( \

1220 (
∑ckë
)->
©y≥
 =
SOCKS_ADDR_IPV4
 ? \

1221 ((
∑ckë
)->
addr
.
ùv4
Ë: (
	`°æí
(’ackë)->addr.
ho°
Ë+ 1))

	)

1234 
	#FAKEIP_START
 0x00000001

	)

1235 
	#FAKEIP_END
 0x000000ff

	)

1237 
	#PROXY_UPNP
 3

	)

1238 
	#PROXY_UPNPs
 "UPNP"

	)

1239 
	#PROXY_BROADCASTs
 "brﬂdˇ°"

	)

1240 
	#PROXY_SOCKS_V4
 4

	)

1241 
	#PROXY_SOCKS_V4s
 "socks_v4"

	)

1242 
	#PROXY_SOCKS_V4REPLY_VERSION
 0

	)

1243 
	#PROXY_SOCKS_V5
 5

	)

1244 
	#PROXY_SOCKS_V5s
 "socks_v5"

	)

1245 
	#PROXY_DIRECT
 6

	)

1246 
	#PROXY_DIRECTs
 "dúe˘"

	)

1247 
	#PROXY_HTTP_10
 7

	)

1248 
	#PROXY_HTTP_10s
 "HTTP/1.0"

	)

1249 
	#PROXY_HTTP_11
 8

	)

1250 
	#PROXY_HTTP_11s
 "HTTP/1.1"

	)

1253 
	#SOCKS_UNAMEVERSION
 1

	)

1254 
	#SOCKS_GSSAPI_VERSION
 1

	)

1255 
	#SOCKS_GSSAPI_AUTHENTICATION
 1

	)

1256 
	#SOCKS_GSSAPI_ENCRYPTION
 2

	)

1257 
	#SOCKS_GSSAPI_PACKET
 3

	)

1258 
	#SOCKS_GSSAPI_CLEAR
 0

	)

1259 
	#SOCKS_GSSAPI_INTEGRITY
 1

	)

1260 
	#SOCKS_GSSAPI_CONFIDENTIALITY
 2

	)

1261 
	#SOCKS_GSSAPI_PERMESSAGE
 3

	)

1264 
	#AUTHMETHOD_NOTSET
 -1

	)

1265 
	#AUTHMETHOD_NOTSETs
 "nŸ£t"

	)

1266 
	#AUTHMETHOD_NONE
 0

	)

1267 
	#AUTHMETHOD_NONEs
 "n⁄e"

	)

1268 
	#AUTHMETHOD_GSSAPI
 1

	)

1269 
	#AUTHMETHOD_GSSAPIs
 "gsßpi"

	)

1270 
	#AUTHMETHOD_UNAME
 2

	)

1271 
	#AUTHMETHOD_UNAMEs
 "u£∫ame"

	)

1277 
	#AUTHMETHOD_NOACCEPT
 255

	)

1278 
	#AUTHMETHOD_NOACCEPTs
 "<nÿac˚±abÀ mëhod>"

	)

1281 
	#AUTHMETHOD_RFC931
 (
AUTHMETHOD_NOACCEPT
 + 1)

	)

1282 
	#AUTHMETHOD_RFC931s
 "rfc931"

	)

1284 
	#AUTHMETHOD_PAM_ANY
 (
AUTHMETHOD_RFC931
 + 1)

	)

1285 
	#AUTHMETHOD_PAM_ANYs
 "∑m.™y"

	)

1287 
	#AUTHMETHOD_PAM_ADDRESS
 (
AUTHMETHOD_PAM_ANY
 + 1)

	)

1288 
	#AUTHMETHOD_PAM_ADDRESSs
 "∑m.addªss"

	)

1290 
	#AUTHMETHOD_PAM_USERNAME
 (
AUTHMETHOD_PAM_ADDRESS
 + 1)

	)

1291 
	#AUTHMETHOD_PAM_USERNAMEs
 "∑m.u£∫ame"

	)

1293 
	#AUTHMETHOD_BSDAUTH
 (
AUTHMETHOD_PAM_USERNAME
 + 1)

	)

1294 
	#AUTHMETHOD_BSDAUTHs
 "bsdauth"

	)

1296 
	#AUTHMETHOD_MAX
 (
AUTHMETHOD_BSDAUTH
)

	)

1298 
	#MAXMETHODSTRING
 (
	`MAX
((
AUTHMETHOD_NONEs
), \

1299 
	`MAX
((
AUTHMETHOD_GSSAPIs
), \

1300 
	`MAX
((
AUTHMETHOD_UNAMEs
), \

1301 
	`MAX
((
AUTHMETHOD_RFC931s
), \

1302 
	`MAX
((
AUTHMETHOD_PAM_ANYs
), \

1303 
	`MAX
((
AUTHMETHOD_PAM_ADDRESSs
), \

1304 
	`MAX
((
AUTHMETHOD_PAM_USERNAMEs
), \

1305 (
AUTHMETHOD_BSDAUTHs
)))))))))

	)

1308 
	#METHODS_KNOWN
 ( 1 \

1313 + 1Ë

	)

1315 
	#MAXMETHODS
 (255Ë

	)

1323 
	#SOCKS_CONNECT
 1

	)

1324 
	#SOCKS_CONNECTs
 "c⁄√˘"

	)

1325 
	#SOCKS_BIND
 2

	)

1326 
	#SOCKS_BINDs
 "böd"

	)

1327 
	#SOCKS_UDPASSOCIATE
 3

	)

1328 
	#SOCKS_UDPASSOCIATEs
 "ud∑ssocüã"

	)

1332 
	#SOCKS_COMMANDEND
 0xff

	)

1334 
	#SOCKS_BINDREPLY
 (
SOCKS_COMMANDEND
 + 1)

	)

1335 
	#SOCKS_BINDREPLYs
 "bödª∂y"

	)

1337 
	#SOCKS_UDPREPLY
 (
SOCKS_BINDREPLY
 + 1)

	)

1338 
	#SOCKS_UDPREPLYs
 "ud¥ïly"

	)

1341 
	#SOCKS_ACCEPT
 (
SOCKS_UDPREPLY
 + 1)

	)

1342 
	#SOCKS_ACCEPTs
 "ac˚±"

	)

1344 
	#SOCKS_DISCONNECT
 (
SOCKS_ACCEPT
 + 1)

	)

1345 
	#SOCKS_DISCONNECTs
 "disc⁄√˘"

	)

1347 
	#SOCKS_BOUNCETO
 (
SOCKS_DISCONNECT
 + 1)

	)

1348 
	#SOCKS_BOUNCETOs
 "boun˚-to"

	)

1350 
	#SOCKS_HOSTID
 (
SOCKS_BOUNCETO
 + 1)

	)

1351 
	#SOCKS_HOSTIDs
 "ho°id"

	)

1353 
	#SOCKS_UNKNOWN
 (
SOCKS_HOSTID
 + 1)

	)

1354 
	#SOCKS_UNKNOWNs
 "unknown"

	)

1358 
	#SOCKS_SUCCESS
 0x00

	)

1359 
	#SOCKS_FAILURE
 0x01

	)

1360 
	#SOCKS_NOTALLOWED
 0x02

	)

1361 
	#SOCKS_NETUNREACH
 0x03

	)

1362 
	#SOCKS_HOSTUNREACH
 0x04

	)

1363 
	#SOCKS_CONNREFUSED
 0x05

	)

1364 
	#SOCKS_TTLEXPIRED
 0x06

	)

1365 
	#SOCKS_CMD_UNSUPP
 0x07

	)

1366 
	#SOCKS_ADDR_UNSUPP
 0x08

	)

1369 
	#SOCKSV4_SUCCESS
 90

	)

1370 
	#SOCKSV4_FAIL
 91

	)

1371 
	#SOCKSV4_NO_IDENTD
 92

	)

1372 
	#SOCKSV4_BAD_ID
 93

	)

1375 
	#HTTP_SUCCESS
 200

	)

1376 
	#HTTP_NOTALLOWED
 401

	)

1377 
	#HTTP_FORBIDDEN
 403

	)

1378 
	#HTTP_PROXYAUTHREQUIRED
 407

	)

1379 
	#HTTP_HOSTUNREACH
 504

	)

1380 
	#HTTP_FAILURE
 501

	)

1381 
	#SOCKD_HTTP_PORT
 80

	)

1384 
	#UPNP_DISCOVERYTIME_MS
 (1000)

	)

1385 
	#DEFAULT_SSDP_BROADCAST_IPV4ADDR
 "239.255.255.250"

	)

1386 
	#DEFAULT_SSDP_PORT
 (1900)

	)

1389 
	#UPNP_NO_IGD
 (0)

	)

1390 
	#UPNP_CONNECTED_IGD
 (1)

	)

1391 
	#UPNP_DISCONNECTED_IGD
 (2)

	)

1392 
	#UPNP_UNKNOWN_DEVICE
 (3)

	)

1394 
	#UPNP_SUCCESS
 (1)

	)

1395 
	#UPNP_FAILURE
 (2)

	)

1398 
	#SOCKS_INTERFACEREQUEST
 0x01

	)

1399 
	#SOCKS_USECLIENTPORT
 0x04

	)

1402 
	#SOCKS_INTERFACEDATA
 0x01

	)

1404 
	#SOCKS_RECV
 0

	)

1405 
	#SOCKS_SEND
 1

	)

1408 
	#AUTH_VERSION
 (0Ë

	)

1411 
	#AUTH_NMETHODS
 (1Ë

	)

1412 
	#AUTH_FIRSTMETHOD
 (2Ë

	)

1415 
	#AUTH_SELECTEDMETHOD
 (1Ë

	)

1418 
	#UNAME_VERSION
 (0)

	)

1419 
	#UNAME_STATUS
 (1)

	)

1423 
	#UNAME_STATUS_ISOK
 (0)

	)

1424 
	#UNAME_STATUS_ISNOK
 (1)

	)

1427 
	#GSSAPI_VERSION
 0

	)

1428 
	#GSSAPI_STATUS
 1

	)

1429 
	#GSSAPI_TOKEN_LENGTH
 2

	)

1430 
	#GSSAPI_TOKEN
 4

	)

1433 
	#GSSAPI_CLEAR
 0

	)

1434 
	#GSSAPI_INTEGRITY
 1

	)

1435 
	#GSSAPI_CONFIDENTIALITY
 2

	)

1437 
	#GSS_REQ_INT
 0

	)

1438 
	#GSS_REQ_CONF
 1

	)

1440 
	#SOCKS_IPV6_ALEN
 16

	)

1441 
	#IPV6_NETMASKBITS
 (128)

	)

1442 
	#IPV4_NETMASKBITS
 (32)

	)

1443 
	#IPV4_FULLNETMASK
 (0xffffffff)

	)

1445 
	#IP6_ELEMENTS
(
ù6
) \

1446 (
ù6
)->
s6_addr
[0], \

1447 (
ù6
)->
s6_addr
[1], \

1448 (
ù6
)->
s6_addr
[2], \

1449 (
ù6
)->
s6_addr
[3], \

1450 (
ù6
)->
s6_addr
[4], \

1451 (
ù6
)->
s6_addr
[5], \

1452 (
ù6
)->
s6_addr
[6], \

1453 (
ù6
)->
s6_addr
[7], \

1454 (
ù6
)->
s6_addr
[8], \

1455 (
ù6
)->
s6_addr
[9], \

1456 (
ù6
)->
s6_addr
[10], \

1457 (
ù6
)->
s6_addr
[11], \

1458 (
ù6
)->
s6_addr
[12], \

1459 (
ù6
)->
s6_addr
[13], \

1460 (
ù6
)->
s6_addr
[14], \

1461 (
ù6
)->
s6_addr
[15]

	)

1463 
	#IP6_FMTSTR
 "%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x:%02x"

	)

1465 
	#BINDEXTENSION_IPADDR
 (0xffffffff)

	)

1474 
	#SOCKS_HOSTID_TYPE_NONE
 0

	)

1475 
	#SOCKS_HOSTID_TYPE_TCP_IPA
 1

	)

1477 #i‡
SOCKS_HOSTID_TYPE
 =
SOCKS_HOSTID_TYPE_NONE


1478 
	#HAVE_SOCKS_HOSTID
 (0)

	)

1480 
	#HAVE_SOCKS_HOSTID
 (1)

	)

1484 
	#SOCKS_HOSTID_NONE
 0

	)

1485 
	#SOCKS_HOSTID_NONE_SYMNAME
 "n⁄e"

	)

1486 
	#SOCKS_HOSTID_PASS
 1

	)

1487 
	#SOCKS_HOSTID_PASS_SYMNAME
 "∑ss"

	)

1488 
	#SOCKS_HOSTID_ADDCLIENT
 2

	)

1489 
	#SOCKS_HOSTID_ADDCLIENT_SYMNAME
 "add-˛õ¡"

	)

1490 
	#SOCKS_HOSTID_SETCLIENT
 3

	)

1491 
	#SOCKS_HOSTID_SETCLIENT_SYMNAME
 "£t-˛õ¡"

	)

1493 íum { 
	mNONESETIF
 = 0, 
	mINTERNALIF
, 
	mEXTERNALIF
 } 
	töãrÁ˚side_t
;

1495 
	e›î©‹_t
 { 
	mn⁄e
 = 0, 
	meq
, 
	m√q
, 
	mge
, 
	mÀ
, 
	mgt
, 
	m…
, 
	mønge
 };

1496 íum { 
	md⁄tˇª
, 
	mi°rue
, 
	misÁl£
 } 
	tvÆue_t
;

1497 íum { 
	mu£∫ame
, 
	mud¥ïlõs
, 
	mt˝ª∂õs
, 
	mª∂õs
 } 
	tmëhodöfo_t
;

1498 íum { 
	mso·limô
, 
	mh¨dlimô
 } 
	tlimôty≥_t
;

1499 íum { 
	mty≥_globÆ
, 
	mty≥_ruÀ
, 
	mty≥_rouã
 } 
	t›ây≥_t
;

1502 
	#SOCKS_ADDR_NOTSET
 (0)

	)

1503 
	#SOCKS_ADDR_IPV4
 (1)

	)

1504 
	#SOCKS_ADDR_IFNAME
 (2)

	)

1505 
	#SOCKS_ADDR_DOMAIN
 (3)

	)

1506 
	#SOCKS_ADDR_IPV6
 (4)

	)

1507 
	#SOCKS_ADDR_URL
 (5)

	)

1508 
	#SOCKS_ADDR_IPVANY
 (6Ë

	)

1510 íum { 
	mobje˘_n⁄e
 = 0,

1511 
	mobje˘_sockaddr
,

1512 
	mobje˘_socksho°
,

1513 
	mobje˘_¸uÀ
,

1514 
	mobje˘_hruÀ
,

1515 
	mobje˘_§uÀ
,

1516 
	mobje˘_rouã
,

1517 
	mobje˘_m⁄ô‹
 } 
	tobje˘ty≥_t
;

1520 
	#MAXLOGLEVELLEN
 (("w¨nög"))

	)

1522 c⁄° 
	m«me
[
MAXLOGLEVELLEN
];

1523 c⁄° 
	mvÆue
;

1524 } 
	tlogÀvñ_t
;

1533 
time_t
 
	mbadexpúe
;

1539 
size_t
 
	mmaxÁû
;

1540 } 
	trouã›ti⁄s_t
;

1543 
	mty≥
;

1545 **
	m‚amev
;

1546 *
	m¸óãdv
;

1547 *
	mfûíov
;

1548 
size_t
 
	mfûíoc
;

1550 
	mÁcûôy
;

1551 
	mÁcûôy«me
[
MAXFACILITYNAMELEN
];

1552 } 
	tlogty≥_t
;

1558 
	mböd
;

1559 } 
	texãnsi⁄_t
;

1561 íum { 
	mTIMEOUT_NOTSET
 = 0,

1562 
	mTIMEOUT_NEGOTIATE
,

1563 
	mTIMEOUT_CONNECT
,

1564 
	mTIMEOUT_IO
,

1565 
	mTIMEOUT_TCP_FIN_WAIT
,

1566 
	mTIMEOUT_NETWORKTEST


1567 } 
	ttimeouây≥_t
;

1575 
time_t
 
	mc⁄√˘
;

1576 #i‡!
SOCKS_CLIENT


1577 
time_t
 
	m√gŸüã
;

1578 
time_t
 
	mt˝io
;

1579 
time_t
 
	mudpio
;

1581 
time_t
 
	mt˝_fö_waô
;

1583 } 
	ttimeout_t
;

1587 
	m«me
[
MAXNAMELEN
];

1588 } 
	tauthmëhod_rfc931_t
;

1592 
	m£rvi˚«me
[
MAXNAMELEN
];

1593 
	m«me
[
MAXNAMELEN
];

1594 
	m∑ssw‹d
[
MAXPWLEN
];

1595 } 
	tauthmëhod_∑m_t
;

1599 
	m°yÀ
[
MAXNAMELEN
];

1600 
	m«me
[
MAXNAMELEN
];

1601 
	m∑ssw‹d
[
MAXPWLEN
];

1602 } 
	tauthmëhod_bsd_t
;

1606 
	mvîsi⁄
;

1607 
	m«me
[
MAXNAMELEN
];

1608 
	m∑ssw‹d
[
MAXPWLEN
];

1609 } 
	tauthmëhod_u«me_t
;

1611 #i‡
HAVE_GSSAPI


1613 
	m√c
;

1614 
	m˛ór
;

1615 
	möãgrôy
;

1616 
	mc⁄fidítülôy
;

1617 
	m≥rmesßge
;

1618 } 
	tgsßpi_íc_t
;

1620 #i‚de‡
BUFSIZ


1621 
	#BUFSIZ
 1024

	)

1624 
	mªad
;

1625 
	mΩos
;

1626 
	mwpos
;

1627 
	misbuf„ªd
;

1628 
	mrbuf„r
[
GSSAPI_HLEN
 + 
MAXGSSAPITOKENLEN
];

1629 
	mwbuf„r
[
BUFSIZ
];

1630 } 
	tgsßpi_buf_t
;

1633 
	mwøp
;

1634 
gss_˘x_id_t
 
	mid
;

1635 
	m¥Ÿe˘i⁄
;

1637 
OM_uöt32
 
	mmaxgssd©a
;

1638 
size_t
 
	mgssovîhód
;

1645 } 
	tgsßpi_°©e_t
;

1649 
	m£rvi˚«me
[
MAXNAMELEN
];

1650 
	mkeyèb
[
MAXNAMELEN
];

1651 
	m«me
[
MAXNAMELEN
];

1652 
gsßpi_íc_t
 
	mí¸y±i⁄
;

1653 
gsßpi_°©e_t
 
	m°©e
;

1654 } 
	tauthmëhod_gsßpi_t
;

1661 
	mmëhod
;

1666 
	mmëhodv
[
METHODS_KNOWN
];

1667 
size_t
 
	mmëhodc
;

1672 
	mbadmëhodv
[
METHODS_KNOWN
];

1673 
size_t
 
	mbadmëhodc
;

1676 
authmëhod_u«me_t
 
	mu«me
;

1678 #i‡
HAVE_GSSAPI


1679 
authmëhod_gsßpi_t
 
	mgsßpi
;

1681 #i‡
HAVE_LIBWRAP


1682 
authmëhod_rfc931_t
 
	mrfc931
;

1684 #i‡
HAVE_PAM


1685 
authmëhod_∑m_t
 
	m∑m
;

1687 #i‡
HAVE_BSDAUTH


1688 
authmëhod_bsd_t
 
	mbsd
;

1690 } 
	mmd©a
;

1691 } 
	tauthmëhod_t
;

1694 
	möt_vÆ
;

1695 
lögî
 
	mlögî_vÆ
;

1696 
timevÆ
 
	mtimevÆ_vÆ
;

1697 
ö_addr
 
	mö_addr_vÆ
;

1698 
	much¨_vÆ
;

1699 
sockaddr_°‹age
 
	msockaddr_vÆ
;

1700 
ù›ti⁄
 
	mù›ti⁄_vÆ
;

1702 #i‡
HAVE_TCP_IPA


1703 
t˝_ùa
 
	m›ti⁄28_vÆ
;

1705 } 
	tsockë›tvÆue_t
;

1711 íum { 
	möt_vÆ
 = 1, 
	mlögî_vÆ
, 
	mtimevÆ_vÆ
, 
	mö_addr_vÆ
, 
	much¨_vÆ
,

1712 
	msockaddr_vÆ
, 
	mù›ti⁄_vÆ
, 
	m›ti⁄28_vÆ
 } 
	tsockë›tvÆue_ty≥_t
;

1714 #i‡
HAVE_TCP_IPA


1715 
	#SOCKETOPTVALUETYPE2SIZE
(
ty≥
) \

1716 ((
ty≥
Ë=
öt_vÆ
 ? () : \

1717 (
ty≥
Ë=
lögî_vÆ
 ? (
lögî
) : \

1718 (
ty≥
Ë=
timevÆ_vÆ
 ? (
timevÆ
) : \

1719 (
ty≥
Ë=
ö_addr_vÆ
 ? (
ö_addr
) : \

1720 (
ty≥
Ë=
uch¨_vÆ
 ? (
u_ch¨
) : \

1721 (
ty≥
Ë=
sockaddr_vÆ
 ? (
sockaddr_°‹age
) : \

1722 (
ty≥
Ë=
ù›ti⁄_vÆ
 ? (
ù›ti⁄
) : \

1723 (
ty≥
Ë=
›ti⁄28_vÆ
 ? (
t˝_ùa
) : \

1724 0)

	)

1727 
	#SOCKETOPTVALUETYPE2SIZE
(
ty≥
) \

1728 ((
ty≥
Ë=
öt_vÆ
 ? () : \

1729 (
ty≥
Ë=
lögî_vÆ
 ? (
lögî
) : \

1730 (
ty≥
Ë=
timevÆ_vÆ
 ? (
timevÆ
) : \

1731 (
ty≥
Ë=
ö_addr_vÆ
 ? (
ö_addr
) : \

1732 (
ty≥
Ë=
uch¨_vÆ
 ? (
u_ch¨
) : \

1733 (
ty≥
Ë=
sockaddr_vÆ
 ? (
sockaddr_°‹age
) : \

1734 (
ty≥
Ë=
ù›ti⁄_vÆ
 ? (
ù›ti⁄
) : \

1735 0)

	)

1738 
	#SOCKETOPT_PRE
 (0x1)

	)

1739 
	#SOCKETOPT_POST
 (0x2)

	)

1740 
	#SOCKETOPT_ANYTIME
 (0x4)

	)

1741 
	#SOCKETOPT_ALL
 (
SOCKETOPT_PRE
 | 
SOCKETOPT_POST
 | 
SOCKETOPT_ANYTIME
)

	)

1743 íum { 
	m¥e⁄ly
 = 1, 
	m™ytime
, 
	mpo°⁄ly
, 
	mövÆid
 } 
	tsock›t_ˇŒty≥_t
;

1745 
size_t
 
	m›tid
;

1746 
sockë›tvÆue_ty≥_t
 
	m›ây≥
;

1747 
	mvÆue
;

1748 
	mÀvñ
;

1750 
	mùv4_⁄
;

1751 
	mùv6_⁄
;

1757 
sock›t_ˇŒty≥_t
 
	mˇŒty≥
;

1758 
	mshi·
;

1759 
	mmask
;

1760 
	mdodup
;

1761 
	m√ed¥iv
;

1762 
	m«me
[
SOCKOPTNAME_MAXLEN
];

1763 } 
	tsock›t_t
;

1766 
size_t
 
	m›tid
;

1767 
sockë›tvÆue_t
 
	msymvÆ
;

1768 *
	m«me
;

1769 } 
	tsock›tvÆsym_t
;

1772 c⁄° 
sock›t_t
 *
	möfo
;

1773 
	mÀvñ
;

1785 
	m›äame
;

1786 
sockë›tvÆue_t
 
	m›tvÆ
;

1787 
sockë›tvÆue_ty≥_t
 
	m›ây≥
;

1789 
	misöã∫Æside
;

1790 } 
	tsockë›ti⁄_t
;

1793 
	usockßddr_t
 {

1794 
	mdomaö
[
MAXHOSTNAMELEN
];

1795 
	muæ«me
[
MAXURLLEN
];

1796 
	mi‚ame
[
MAXIFNAMELEN
];

1797 
ö_addr
 
	mùv4
;

1799 
ö6_addr
 
	mù
;

1800 
uöt32_t
 
	msc›eid
;

1801 } 
	mùv6
;

1804 
	ssocksho°_t
 {

1805 
	m©y≥
;

1806 
sockßddr_t
 
	maddr
;

1807 
ö_p‹t_t
 
	mp‹t
;

1808 } 
	tsocksho°_t
;

1811 
	mhâpc⁄√˘
;

1812 } 
	tªque°Êags_t
;

1814 
	sªque°_t
 {

1815 
authmëhod_t
 *
	mauth
;

1816 
	mcomm™d
;

1817 
	mÊag
;

1818 
socksho°_t
 
	mho°
;

1819 
	m¥Ÿocﬁ
;

1820 
	mvîsi⁄
;

1822 
ªque°Êags_t
 
	mÊags
;

1823 } 
	tªque°_t
;

1827 
	mvîsi⁄
;

1830 
	msocks
;

1831 
	mu≤p
;

1832 
	mhâp
;

1833 } 
	mª∂y
;

1835 
	mÊag
;

1836 
socksho°_t
 
	mho°
;

1837 
authmëhod_t
 *
	mauth
;

1838 } 
	tª•⁄£_t
;

1842 
	mÊag
[2];

1843 
	m‰ag
;

1844 
socksho°_t
 
	mho°
;

1845 } 
	tudphódî_t
;

1848 
	mt˝
;

1849 
	mudp
;

1850 } 
	t¥Ÿocﬁ_t
;

1854 
	mböd
;

1855 
	mc⁄√˘
;

1856 
	mud∑ssocüã
;

1859 
	mbödª∂y
;

1860 
	mud¥ïly
;

1861 } 
	tcomm™d_t
;

1865 
	mdúe˘
;

1866 
	msocks_v4
;

1867 
	msocks_v5
;

1868 
	mhâp
;

1869 
	mu≤p
;

1870 } 
	t¥oxy¥Ÿocﬁ_t
 ;

1874 
	mac˚±≥ndög
;

1875 
authmëhod_t
 
	mauth
;

1876 
	mcomm™d
;

1877 
	mîr
;

1878 #i‡
HAVE_GSSAPI


1879 
	mgssimp‹äìded
;

1880 
gss_buf„r_desc
 
	mgsßpi°©e
;

1881 
	mgsßpi°©emem
[
MAX_GSS_STATE
];

1883 
	mö¥ogªss
;

1884 
	missysˇŒ
;

1885 
¥Ÿocﬁ_t
 
	m¥Ÿocﬁ
;

1886 
	mudpc⁄√˘
;

1887 
	msysˇŒdïth
;

1888 
	mvîsi⁄
;

1889 } 
	tsocks°©e_t
;

1891 
	sruÀaddr_t
 {

1892 
	m©y≥
;

1894 
	mdomaö
[
MAXHOSTNAMELEN
];

1896 
	mi‚ame
[
MAXIFNAMELEN
];

1899 
ö_addr
 
	mù
;

1900 
ö_addr
 
	mmask
;

1901 } 
	mùv4
;

1904 
ö6_addr
 
	mù
;

1905 
	mmaskbôs
;

1906 
uöt32_t
 
	msc›eid
;

1907 } 
	mùv6
;

1914 
ö_addr
 
	mù
;

1915 
ö_addr
 
	mmask
;

1916 } 
	mùv™y
;

1918 } 
	maddr
;

1921 
ö_p‹t_t
 
	mt˝
;

1922 
ö_p‹t_t
 
	mudp
;

1923 } 
	mp‹t
;

1924 
ö_p‹t_t
 
	mp‹ãnd
;

1925 
›î©‹_t
 
	m›î©‹
;

1926 } 
	truÀaddr_t
;

1928 #i‚de‡
MINIUPNPC_URL_MAXSIZE


1929 
	#MINIUPNPC_URL_MAXSIZE
 (128)

	)

1933 
	mc⁄åﬁuæ
[
MINIUPNPC_URL_MAXSIZE
];

1934 
	m£rvi˚ty≥
[
MINIUPNPC_URL_MAXSIZE
];

1935 } 
	mu≤p
;

1936 } 
	t¥oxy°©e_t
;

1938 
	slöked«me_t
 {

1939 *
	m«me
;

1940 
löked«me_t
 *
	m√xt
;

1941 } 
	tlöked«me_t
;

1944 #i‡
HAVE_LDAP


1946 
löked«me_t
 *
	mld≠uæ
;

1947 
löked«me_t
 *
	mld≠ba£dn
;

1948 
	m©åibuã
[
MAXNAMELEN
];

1949 
	m©åibuã_AD
[
MAXNAMELEN
];

1950 
	m˚πfûe
[
MAXURLLEN
];

1951 
	m˚π∑th
[
MAXURLLEN
];

1952 
	mdebug
;

1953 
	mmdïth
;

1954 
	mdomaö
[
MAXNAMELEN
];

1955 
	mfûãr
[
MAXNAMELEN
];

1956 
	mfûãr_AD
[
MAXNAMELEN
];

1957 
	mkeyèb
[
MAXNAMELEN
];

1958 
	mp‹t
;

1959 
	mp‹ts¶
;

1961 
	mauto_off
;

1962 
	ms¶
;

1963 
	m˚πcheck
;

1964 
	mkì¥ólm
;

1965 } 
	tld≠_t
;

1971 
comm™d_t
 
	mcomm™d
;

1972 
exãnsi⁄_t
 
	mexãnsi⁄
;

1973 
¥Ÿocﬁ_t
 
	m¥Ÿocﬁ
;

1975 
	mcmëhodv
[
METHODS_KNOWN
];

1976 
size_t
 
	mcmëhodc
;

1977 
	msmëhodv
[
METHODS_KNOWN
];

1978 
size_t
 
	msmëhodc
;

1980 
¥oxy¥Ÿocﬁ_t
 
	m¥oxy¥Ÿocﬁ
;

1982 #i‡
HAVE_PAM


1983 
	m∑m£rvi˚«me
[
MAXNAMELEN
];

1986 #i‡
HAVE_BSDAUTH


1987 
	mbsdauth°yÀ«me
[
MAXNAMELEN
];

1990 #i‡
HAVE_GSSAPI


1991 
	mgsßpi£rvi˚«me
[
MAXNAMELEN
];

1992 
	mgsßpikeyèb
[
MAXNAMELEN
];

1993 
gsßpi_íc_t
 
	mgsßpõn¸y±i⁄
;

1996 #i‡
HAVE_LDAP


1997 
ld≠_t
 
	mld≠
;

2000 #i‡
HAVE_LIBMINIUPNP


2001 
¥oxy°©e_t
 
	md©a
;

2003 } 
	t£rvî°©e_t
;

2006 
socksho°_t
 
	maddr
;

2007 
£rvî°©e_t
 
	m°©e
;

2008 } 
	tg©eway_t
;

2012 
	mvîsi⁄
;

2020 
ªque°_t
 
	mªq
;

2021 
ª•⁄£_t
 
	mªs
;

2022 
g©eway_t
 
	mgw
;

2023 
socks°©e_t
 
	m°©e
;

2024 } 
	tsocks_t
;

2026 
	ep‹tcmp
 { 
	me_…
 = 1, 
	me_gt
, 
	me_eq
, 
	me_√q
, 
	me_À
, 
	me_ge
, 
	me_nû
 };

2034 
	#SOCKS_REQUEST
 0x1

	)

2035 
	#SOCKS_RESPONSE
 0x2

	)

2096 íum { 
	mREAD_BUF
 = 0 ,

2097 
	mWRITE_BUF
 = 1 } 
	twhichbuf_t
;

2100 
	mÆloˇãd
;

2101 
	ms
;

2103 #i‡
HAVE_GSSAPI


2104 #i‡(
SOCKD_BUFSIZE
Ë< (2 * (
MAXGSSAPITOKENLEN
 + 
GSSAPI_HLEN
))

2109 
	mbuf
[2][
SOCKD_BUFSIZE
];

2112 
size_t
 
	mÀn
;

2113 
size_t
 
	mí˛í
;

2115 
	mmode
;

2116 
ssize_t
 
	msize
;

2121 #i‡
SOCKS_CLIENT


2122 
size_t
 
	mªadÆªady
;

2127 } 
	möfo
[2];

2129 
	m°y≥
;

2130 } 
	tiobuf„r_t
;

2132 
	srouã_t
 {

2133 
	mnumbî
;

2136 
	mautﬂdded
;

2137 
size_t
 
	mÁûed
;

2138 
time_t
 
	mbadtime
;

2139 } 
	m°©e
;

2141 
sockë›ti⁄_t
 *
	msockë›ti⁄v
;

2142 
size_t
 
	msockë›ti⁄c
;

2144 
ruÀaddr_t
 
	m§c
;

2145 
ruÀaddr_t
 
	md°
;

2146 
g©eway_t
 
	mgw
;

2148 
ruÀaddr_t
 
	mrdr_‰om
;

2150 
rouã_t
 *
	m√xt
;

2151 } 
	trouã_t
;

2154 
	mÆloˇãd
;

2155 
	mc⁄åﬁ
;

2156 
socks°©e_t
 
	m°©e
;

2158 
sockaddr_°‹age
 
	mloˇl
;

2161 
sockaddr_°‹age
 
	m£rvî
;

2162 
sockaddr_°‹age
 
	mªmŸe
;

2163 
sockaddr_°‹age
 
	mª∂y
;

2169 
socksho°_t
 
	mac˚±ed
;

2170 
socksho°_t
 
	mc⁄√˘ed
;

2171 } 
	mf‹us
;

2173 
rouã_t
 *
	mrouã
;

2174 } 
	tsocksfd_t
;

2192 
	#MAX_ADDRINFO_NEXT
 (10)

	)

2194 íum { 
	mid_«me
 = 1, 
	mid_addr
 } 
	tho°ít_id_t
;

2197 
	mÆloˇãd
:1;

2198 
time_t
 
	mwrôãn
;

2201 
	mgai_rc
;

2209 
ho°ít_id_t
 
	mkey
;

2211 
	m«me
[
MAXHOSTNAMELEN
];

2212 
sockaddr_°‹age
 
	maddr
;

2213 } 
	mid
;

2216 
	m£rvi˚
[
MAXSERVICELEN
];

2220 
addröfo
 
	maddröfo
;

2230 
	mai_ˇn⁄«me_mem
[
MAXHOSTNAMELEN
];

2233 
sockaddr_°‹age
 
	mai_addr_mem
[
MAX_ADDRINFO_NEXT
];

2235 
addröfo
 
	mai_√xt_mem
[
MAX_ADDRINFO_NEXT
];

2237 
addröfo
 *
	mhöts
;

2238 
addröfo
 
	mhöts_mem
;

2239 } 
	mgëaddr
;

2242 
	m«me
[
MAXHOSTNAMELEN
];

2243 
	mÊags
;

2244 } 
	mgë«me
;

2245 } 
	md©a
;

2246 } 
	tdnsöfo_t
;

2249 
	#HOSTENT_MAX_ALIASES
 (5)

	)

2251 
	mÆloˇãd
:1;

2252 
	mnŸfound
:1;

2253 
time_t
 
	mwrôãn
;

2262 
ho°ít_id_t
 
	mkey
;

2264 
	m«me
[
MAXHOSTNAMELEN
];

2265 
ö_addr
 
	mùv4
;

2266 } 
	mid
;

2268 
ho°ít
 
	mho°ít
;

2276 
	mh_«me
[
MAXHOSTNAMELEN
];

2277 *
	mh_Æü£s
[
HOSTENT_MAX_ALIASES
 + 1];

2278 *
	mh_addr_li°
[
HOSTENT_MAX_ALIASES
 + 1];

2281 
	mh_Æü£smem
[
HOSTENT_MAX_ALIASES
 + 1][
MAXHOSTNAMELEN
];

2282 
	mh_addr_li°mem
[
HOSTENT_MAX_ALIASES
 + 1][
MAX
((
ö_addr
),

2283 (
ö6_addr
))];

2285 } 
	tho°íåy_t
;

2288 #i‡!
SOCKS_CLIENT


2289 
öãrÁ˚side_t
 
	mside
;

2290 
sockaddr_°‹age
 
	m≥î
;

2293 
	mty≥
;

2294 
	mÊags
;

2296 
size_t
 
	m‰omsockë
;

2309 
timevÆ
 
	mts
;

2310 } 
	tªcv‰om_öfo_t
;

2313 
öãrÁ˚side_t
 
	mside
;

2318 
size_t
 
	mtosockë
;

2327 } 
	t£ndto_öfo_t
;

2336 
	$£º
(c⁄° *
fmt
, ...)

2337 
	`__ATTRIBUTE__
((
n‹ëu∫
)Ë__ATTRIBUTE__((
	`FORMAT
(
¥ötf
, 1, 2)));

2339 
	$£ºx
(c⁄° *
fmt
, ...)

2340 
	`__ATTRIBUTE__
((
n‹ëu∫
)Ë__ATTRIBUTE__((
	`FORMAT
(
¥ötf
, 1, 2)));

2342 
	$sw¨n
(c⁄° *
fmt
, ...)

2343 
	`__ATTRIBUTE__
((
	`FORMAT
(
¥ötf
, 1, 2)));

2345 
	$sw¨nx
(c⁄° *
fmt
, ...)

2346 
	`__ATTRIBUTE__
((
	`FORMAT
(
¥ötf
, 1, 2)));

2350 
	`ru√nvcheck
();

2356 
	`maxvÆueo·y≥
(c⁄° 
size_t
 
ty≥Àn
);

2363 
	`mövÆueo·y≥
(c⁄° 
size_t
 
ty≥Àn
);

2370 
	`umaxvÆueo·y≥
(c⁄° 
size_t
 
ty≥Àn
);

2377 
	`umövÆueo·y≥
(c⁄° 
size_t
 
ty≥Àn
);

2385 
	`gíîicöô
();

2391 
	`›ti⁄öô
();

2397 
	`po°c⁄figlﬂdöô
();

2403 
	`socks_öôu≤p
(
g©eway_t
 *
gw
, *
emsg
, c⁄° 
size_t
 
emsgÀn
);

2416 
	`√w¥ocöô
();

2424 
	`udphódî_add
(c⁄° 
socksho°_t
 *
ho°
, *
msg
, 
size_t
 *
Àn
,

2425 c⁄° 
size_t
 
msgsize
);

2445 
	`fdis›í
(c⁄° 
fd
);

2452 
	`fdisblockög
(c⁄° 
fd
);

2458 
	`˛o£v
(
size_t
 
ic
, *
iv
);

2464 c⁄° 
logÀvñ_t
 *

2465 
	`logÀvñ
(c⁄° *
«me
);

2473 
	`socks_logm©ch
(
d
, c⁄° 
logty≥_t
 *
log
);

2479 
sockaddr_°‹age
 *

2480 
	`öt_socksho°2sockaddr2
(c⁄° 
socksho°_t
 *
sho°
, 
sockaddr_°‹age
 *
addr
,

2481 
size_t
 
addæí
, *
gaõº
,

2482 *
emsg
, 
size_t
 
emsgÀn
);

2498 
sockaddr_°‹age
 *

2499 
	`öt_socksho°2sockaddr
(c⁄° 
socksho°_t
 *
sho°
, 
sockaddr_°‹age
 *
addr
,

2500 
size_t
 
addæí
);

2506 
sockaddr_°‹age
 *

2507 
	`öt_Ákesocksho°2sockaddr
(c⁄° 
socksho°_t
 *
ho°
,

2508 
sockaddr_°‹age
 *
addr
, 
size_t
 
addæí
);

2514 
sockaddr_°‹age
 *

2515 
	`öt_uæ°rög2sockaddr
(c⁄° *
°rög
, 
sockaddr_°‹age
 *
addr
,

2516 
size_t
 
addæí
, *
gaõº
,

2517 *
emsg
, 
size_t
 
emsgÀn
);

2529 
socksho°_t
 *

2530 
	`sockaddr2socksho°
(c⁄° 
sockaddr_°‹age
 *
addr
, 
socksho°_t
 *
ho°
);

2539 
	`sockaddr2ho°«me
(c⁄° 
sockaddr_°‹age
 *
ß
, *
ho°«me
,

2540 c⁄° 
size_t
 
ho°«mñí
);

2550 
socksho°_t
 *

2551 
	`ruÀaddr2socksho°
(c⁄° 
ruÀaddr_t
 *
addªss
, 
socksho°_t
 *
ho°
, 
¥Ÿocﬁ
);

2558 
sockaddr_°‹age
 *

2559 
	`öt_ruÀaddr2sockaddr
(c⁄° 
ruÀaddr_t
 *
addªss
, 
sockaddr_°‹age
 *
ß
,

2560 
size_t
 
ßÀn
, c⁄° 
¥Ÿocﬁ
);

2568 
sockaddr_°‹age
 *

2569 
	`öt_ruÀaddr2sockaddr2
(c⁄° 
ruÀaddr_t
 *
addªss
, 
sockaddr_°‹age
 *
ß
,

2570 
size_t
 
ßÀn
, c⁄° 
¥Ÿocﬁ
, *
gaõº
,

2571 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

2583 
ruÀaddr_t
 *

2584 
	`socksho°2ruÀaddr
(c⁄° 
socksho°_t
 *
ho°
, 
ruÀaddr_t
 *
addr
);

2591 
ruÀaddr_t
 *

2592 
	`sockaddr2ruÀaddr
(c⁄° 
sockaddr_°‹age
 *
addr
, 
ruÀaddr_t
 *
ruÀaddr
);

2599 
sockaddr_°‹age
 *

2600 
	`öt_ho°«me2sockaddr
(c⁄° *
«me
, 
size_t
 
ödex
,

2601 
sockaddr_°‹age
 *
addr
, 
size_t
 
addæí
);

2609 
sockaddr_°‹age
 *

2610 
	`öt_ho°«me2sockaddr2
(c⁄° *
«me
, 
size_t
 
ödex
,

2611 
sockaddr_°‹age
 *
addr
, 
size_t
 
addæí
,

2612 *
gaõº
, *
emsg
, c⁄° 
size_t
 
emsgÀn
);

2623 
sockaddr_°‹age
 *

2624 
	`öt_i‚ame2sockaddr
(c⁄° *
i‚ame
, 
size_t
 
ödex
,

2625 
sockaddr_°‹age
 *
addr
, 
size_t
 
addæí
,

2626 
sockaddr_°‹age
 *
mask
, 
size_t
 
maskÀn
);

2638 
	`sockaddr2i‚ame
(
sockaddr_°‹age
 *
addr
, *
i‚ame
, 
size_t
 
iÊí
);

2651 
	`sock©m¨k
(
s
);

2657 
ssize_t


2658 
	`ªcvmsgn
(
s
, 
msghdr
 *
msg
, 
Êags
);

2663 
ssize_t


2664 
	`£ndmsgn
(
s
, c⁄° 
msghdr
 *
msg
, 
Êags
, c⁄° 
time_t
 
timeoutms
);

2673 
ssize_t


2674 
	$ªadn
(, *, 
size_t
, c⁄° size_à
möªad
, 
authmëhod_t
 *
auth
)

2675 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

2682 
ssize_t


2683 
	$wrôí
(, c⁄° *, 
size_t
, c⁄° size_à
möwrôe
,

2684 
authmëhod_t
 *
auth
)

2685 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

2692 
ssize_t


2693 
	$socks_ªcv‰om
(
s
, *
buf
, 
size_t
 
Àn
, 
Êags
,

2694 
sockaddr_°‹age
 *
‰om
,

2695 
sockÀn_t
 *
‰omÀn
, 
ªcv‰om_öfo_t
 *
ªcvÊags
,

2696 
authmëhod_t
 *
auth
)

2697 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

2704 
ssize_t


2705 
	$socks_ªcv‰omn
(c⁄° 
s
, *
buf
, 
size_t
 
Àn
, c⁄° size_à
möªad
,

2706 c⁄° 
Êags
, 
sockaddr_°‹age
 *
‰om
,

2707 
sockÀn_t
 *
‰omÀn
, 
ªcv‰om_öfo_t
 *
ªcvÊags
,

2708 
authmëhod_t
 *
auth
)

2709 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

2714 
ssize_t


2715 
	$socks_£ndto
(
s
, c⁄° *
msg
, 
size_t
 
Àn
, 
Êags
,

2716 c⁄° 
sockaddr_°‹age
 *, 
sockÀn_t
,

2717 
£ndto_öfo_t
 *
£ndÊags
, 
authmëhod_t
 *
auth
)

2718 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

2724 
ssize_t


2725 
	$socks_£ndt⁄
(
s
, c⁄° *
buf
, 
size_t
 
Àn
, c⁄° size_à
möwrôe
,

2726 
Êags
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
,

2727 
£ndto_öfo_t
 *
£ndÊags
, 
authmëhod_t
 *
auth
)

2728 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

2734 
	`˛o£n
();

2739 
timevÆ
 *

2740 
	`gëtimeofday_m⁄Ÿ⁄ic
(
timevÆ
 *
tv
);

2746 
time_t


2747 
	`time_m⁄Ÿ⁄ic
(
time_t
 *
éoc
);

2753 
	`tv2us
(c⁄° 
timevÆ
 *
tv
);

2758 
timevÆ
 *

2759 
	`us2tv
(c⁄° 
us
, 
timevÆ
 *
tv
);

2767 
	`£À˘n
(
nfds
, 
fd_£t
 *
r£t
, fd_£à*
bu‰£t
, fd_£à*
buffw£t
,

2768 
fd_£t
 *
w£t
, fd_£à*
x£t
, 
timevÆ
 *);

2782 
	`ac˚±n
(, 
sockaddr_°‹age
 *, 
sockÀn_t
 *);

2788 
	`socks_sockë
(c⁄° 
domaö
, c⁄° 
ty≥
, c⁄° 
¥Ÿocﬁ
);

2795 
	`£tblockög
(c⁄° 
fd
, c⁄° *
c⁄ãxt
);

2807 
	`£ä⁄blockög
(c⁄° 
fd
, c⁄° *
c⁄ãxt
);

2819 
	`socks_sockëisf‹œn
(c⁄° 
s
);

2825 
sockaddr_°‹age
 *

2826 
	`sockëisc⁄√˘ed
(c⁄° 
s
, 
sockaddr_°‹age
 *
addr
, 
sockÀn_t
 
Æí
);

2837 
	`fdisdup
(c⁄° 
fd1
, c⁄° 
fd2
);

2845 
	`socks_ªböd
(
s
, 
¥Ÿocﬁ
, 
sockaddr_°‹age
 *
‰om
,

2846 c⁄° 
ruÀaddr_t
 *
to
, *
emsg
, c⁄° 
size_t
 
emsgÀn
);

2856 
	`socks_bödöønge
(
s
, 
sockaddr_°‹age
 *
addr
,

2857 
ö_p‹t_t
 
fú°
, in_p‹t_à
œ°
, c⁄° 
›î©‹_t
 
›
);

2865 
	`socks_böd
(
s
, 
sockaddr_°‹age
 *
addr
, 
size_t
 
ªåõs
);

2880 c⁄° 
ö_addr
 *

2881 
	`ùv4_addrisöli°
(c⁄° 
ö_addr
 *
addr
, c⁄° ö_add∏*
mask
,

2882 c⁄° 
addröfo
 *
aûi°
);

2884 c⁄° 
ö6_addr
 *

2885 
	`ùv6_addrisöli°
(c⁄° 
ö6_addr
 *
addr
, c⁄° 
maskbôs
,

2886 c⁄° 
addröfo
 *
aûi°
);

2900 
	`sockaddøªeq
(c⁄° 
sockaddr_°‹age
 *
a
,

2901 c⁄° 
sockaddr_°‹age
 *
b
, c⁄° 
size_t
 
nocom∑ª
);

2914 
	`u§sockaddr˝y
(
sockaddr_°‹age
 *
d°
, c⁄° sockaddr_°‹agê*
§c
,

2915 c⁄° 
size_t
 
Àn
);

2923 
	`sockaddr˝y
(
sockaddr_°‹age
 *
d°
, c⁄° sockaddr_°‹agê*
§c
,

2924 c⁄° 
size_t
 
Àn
);

2929 
ß_Àn_ty≥


2930 
	`ßÀn
(c⁄° 
ß_Ámûy_t
 
Ámûy
);

2935 
ß_Àn_ty≥


2936 
	`öaddæí
(c⁄° 
ß_Ámûy_t
 
Ámûy
);

2943 
	`ßÁmûy_issuµ‹ãd
(c⁄° 
ß_Ámûy_t
 
Ámûy
);

2949 
ß_Ámûy_t


2950 
	`©y≥2ßÁmûy
(c⁄° 
©y≥
);

2957 
	`ßÁmûy2©y≥
(c⁄° 
ß_Ámûy_t
 
ßÁmûy
);

2964 
	`addröfo_issuµ‹ãd
(c⁄° 
addröfo
 *
ai
);

2974 c⁄° *
	`socks_°ªº‹
(c⁄° 
îr
);

2975 c⁄° *
	`socks_gai_°ªº‹
(c⁄° 
îr
);

2977 
size_t


2978 
	$¢¥öt‚
(*
°r
, 
size_t
 
size
, c⁄° *
f‹m©
, ...)

2979 
	`__ATTRIBUTE__
((
	$FORMAT
(
¥ötf
, 3, 4)))

2980 
	`__ATTRIBUTE__
((
	$__NONNULL__
(3)))

2981 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 1, 2)));

2990 
	`socks_sigblock
(c⁄° 
sig
, 
sig£t_t
 *
ﬁd£t
);

2999 
	`socks_sigunblock
(c⁄° 
sig£t_t
 *
ﬁd£t
);

3006 
	`°rcheck
(c⁄° *
°rög
);

3013 
	`socksho°2mem
(c⁄° 
socksho°_t
 *
ho°
, *
mem
, 
vîsi⁄
);

3022 
	$mem2socksho°
(
socksho°_t
 *
ho°
, c⁄° *
mem
, 
size_t
 
Àn
,

3023 
vîsi⁄
)

3024 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

3034 
	`socks_gë_ª•⁄£vÆue
(c⁄° 
ª•⁄£_t
 *
ª•⁄£
);

3035 
	`socks_£t_ª•⁄£vÆue
(
ª•⁄£_t
 *
ª•⁄£
, 
vÆue
);

3042 
	`ch¨mëhod2ötmëhod
(c⁄° 
size_t
 
mëhodc
,

3043 c⁄° 
ch¨mëhodv
[], 
ötmëhodv
[]);

3053 
	`¥oxy¥Ÿocﬁisknown
(c⁄° 
vîsi⁄
);

3059 
	`authmëhodisknown
(c⁄° 
mëhod
);

3065 
	`socks_addlogfûe
(
logty≥_t
 *
logcf
, c⁄° *
logfûe
);

3073 
	$¶og
(
¥i‹ôy
, c⁄° *
fmt
, ...)

3074 
	`__ATTRIBUTE__
((
	`FORMAT
(
¥ötf
, 2, 3)));

3081 
	$v¶og
(
¥i‹ôy
, c⁄° *
fmt
, 
va_li°
 
≠
, va_li° 
≠c›y
)

3082 
	`__ATTRIBUTE__
((
	`FORMAT
(
¥ötf
, 2, 0)));

3089 
	`sig«l¶og
(c⁄° 
¥i‹ôy
, c⁄° *
msgv
[]);

3104 
	`∑r£c⁄fig
(c⁄° *
fûíame
);

3115 
	`ª£tc⁄fig
(
c⁄fig
 *c⁄fig, c⁄° 
exôög
);

3124 
	`addrm©ch
(c⁄° 
ruÀaddr_t
 *
ruÀ
, c⁄° 
socksho°_t
 *
addªss
,

3125 
socksho°_t
 *
addrm©ched
, 
¥Ÿocﬁ
, 
ùÆüs
);

3142 
	`socks_c⁄√˘ho°
(
s
,

3143 #i‡!
SOCKS_CLIENT


3144 c⁄° 
öãrÁ˚side_t
 
side
,

3146 c⁄° 
socksho°_t
 *
ho°
,

3147 
sockaddr_°‹age
 *
œddr
,

3148 
sockaddr_°‹age
 *
øddr
,

3149 c⁄° 
timeout
, *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3175 
rouã_t
 *

3176 
	`socks_c⁄√˘rouã
(c⁄° 
s
, 
socks_t
 *
∑ckë
,

3177 c⁄° 
socksho°_t
 *
§c
, c⁄° socksho°_à*
d°
,

3178 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3196 
rouã_t
 *

3197 
	`socks_ªque°pﬁish
(
ªque°_t
 *
ªq
, c⁄° 
socksho°_t
 *
§c
,

3198 c⁄° 
socksho°_t
 *
d°
);

3209 
	`socks_rouã£tup
(c⁄° 
c⁄åﬁ
, c⁄° 
d©a
, c⁄° 
rouã_t
 *
rouã
,

3210 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3222 
	`show°©e
(c⁄° 
£rvî°©e_t
 *
°©e
);

3228 
	`showmëhod
(
obje˘ty≥_t
 
ty≥
, 
size_t
 
mëhodc
, c⁄° *
mëhodv
);

3236 
	`showtimeout
(c⁄° 
timeout_t
 *
timeout
);

3243 
	`‰ìrouãli°
(
rouã_t
 *
rouãhód
);

3248 
rouã_t
 *

3249 
	`socks_addrouã
(c⁄° 
rouã_t
 *
rouã
, c⁄° 
œ°
);

3259 
rouã_t
 *

3260 
	`socks_autﬂdd_dúe˘rouã
(c⁄° 
comm™d_t
 *
comm™ds
,

3261 c⁄° 
¥Ÿocﬁ_t
 *
¥Ÿocﬁs
,

3262 c⁄° 
sockaddr_°‹age
 *
ßddr
,

3263 c⁄° 
sockaddr_°‹age
 *
√tmask
);

3273 
	`socks_showrouã
(c⁄° 
rouã_t
 *
rouã
);

3278 
rouã_t
 *

3279 
	`socks_gërouã
(c⁄° 
ªque°_t
 *
ªq
, c⁄° 
socksho°_t
 *
§c
,

3280 c⁄° 
socksho°_t
 *
d°
);

3296 
	`sockscode
(c⁄° 
vîsi⁄
, c⁄° 
code
);

3303 
	`î∫o2ª∂y
(
î∫um
, 
vîsi⁄
);

3309 
	$°r2vis
(c⁄° *
°rög
, 
size_t
 
Àn
, *
vis°rög
, size_à
vi¶í
)

3310 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 3, 4)));

3321 
ö_addr_t


3322 
	`socks_addÁkeù
(c⁄° *
«me
);

3331 
	`socks_gëÁkeho°
(
ö_addr_t
 
addr
);

3339 
	`socks_gëÁkeù
(c⁄° *
ho°
, 
ö_addr
 *
addr
);

3348 
socksho°_t
 *

3349 
	`Ákesockaddr2socksho°
(c⁄° 
sockaddr_°‹age
 *
addr
, 
socksho°_t
 *
ho°
);

3356 
	`socksho°¨ìq
(c⁄° 
socksho°_t
 *
a
, c⁄° socksho°_à*
b
);

3365 
	`fd£t›
(
highe°fd
, 
›
, c⁄° 
fd_£t
 *
a
, c⁄° fd_£à*
b
,

3366 
fd_£t
 *
ªsu…
);

3380 
	`mëhodis£t
(
mëhod
, c⁄° *
mëhodv
, 
size_t
 
mëhodc
);

3388 
	`gë_t˝öfo
(c⁄° 
size_t
 
fdc
, 
fdv
[], *
buf
, size_à
buÊí
);

3403 
	`sockë›tdup
(
s
, 
√w_s
);

3414 
	`sockë›ti⁄check
(c⁄° 
sockë›ti⁄_t
 *
›ti⁄
);

3420 
	`addedsockë›ti⁄
(
size_t
 *
›tc
, 
sockë›ti⁄_t
 **
›tv
,

3421 c⁄° 
sockë›ti⁄_t
 *
√w›ti⁄
);

3429 
	`£tc⁄fsock›ti⁄s
(c⁄° 
èrgë
, c⁄° 
ö
, c⁄° 
¥Ÿocﬁ
,

3430 c⁄° 
is˛õ¡side
,

3431 c⁄° 
size_t
 
›tc
, c⁄° 
sockë›ti⁄_t
 *
›tv
,

3432 c⁄° 
whichloˇls
, c⁄° 
whichglobÆs
);

3452 
	`socks_mklock
(c⁄° *
ãm∂©e
, *
√w«me
, c⁄° 
size_t
 
√w«mñí
);

3466 
	`socks_lock
(c⁄° 
fd
, c⁄° 
off_t
 
off£t
, c⁄° off_à
Àn
,

3467 c⁄° 
ex˛usive
, c⁄° 
waô
);

3482 
	`socks_u∆ock
(
d
, c⁄° 
off_t
 
off£t
, c⁄° off_à
Àn
);

3489 
	`bôcou¡
(
numbî
);

3495 
	`bôcou¡_ö6addr
(c⁄° 
ö6_addr
 *
ö6addr
);

3501 #i‡
SOCKSLIBRARY_DYNAMIC


3507 
ho°ít
 *
	`sys_gëho°byaddr
(c⁄° *
addr
, 
sockÀn_t
 
Àn
, 
af
);

3508 
ho°ít
 *
	`sys_gëho°by«me
(const *);

3509 
ho°ít
 *
	`sys_gëho°by«me2
(const *, );

3511 #i‡
HAVE_GETADDRINFO


3512 
	`sys_gëaddröfo
(c⁄° *
nodíame
, c⁄° *
£rv«me
,

3513 c⁄° 
addröfo
 *
höts
, addröfÿ**
ªs
);

3516 #i‡
HAVE_GETIPNODEBYNAME


3517 
ho°ít
 *
	`sys_gëùnodeby«me
(c⁄° *
«me
, 
af
, 
Êags
,

3518 *
îr‹_num
);

3521 #i‡
SOCKS_CLIENT


3522 #i‡
HAVE___FPRINTF_CHK


3523 
HAVE_PROT_FPRINTF_0
 
	`__Ârötf_chk
(
HAVE_PROT_FPRINTF_1
 
°ªam
, 
dummy
,

3524 
HAVE_PROT_FPRINTF_2
 
f‹m©
, ...);

3527 #i‡
HAVE___VFPRINTF_CHK


3528 
HAVE_PROT_VFPRINTF_0
 
	`__vÂrötf_chk
(
HAVE_PROT_VFPRINTF_1
 
°ªam
,

3529 
dummy
, 
HAVE_PROT_VFPRINTF_2
 
f‹m©
, 
HAVE_PROT_VFPRINTF_3
 
≠
);

3536 
	`hâµroxy_√gŸüã
(
c⁄åﬁ
, 
socks_t
 *
∑ckë
,

3537 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3549 
	`u≤p_√gŸüã
(c⁄° 
s
, 
socks_t
 *
∑ckë
, 
g©eway_t
 *
gw
,

3550 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3573 
	`socks_√gŸüã
(
s
, 
c⁄åﬁ
, 
socks_t
 *
∑ckë
, 
rouã_t
 *
rouã
,

3574 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3588 
	`£rvîª∂yisok
(c⁄° 
vîsi⁄
, c⁄° 
comm™d
,

3589 c⁄° 
ª∂y
, 
rouã_t
 *
rouã
,

3590 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3602 
rouã_t
 *

3603 
	`socks_nbc⁄√˘rouã
(
s
, 
c⁄åﬁ
, 
socks_t
 *
∑ckë
,

3604 c⁄° 
socksho°_t
 *
§c
, c⁄° socksho°_à*
d°
,

3605 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3613 
	`socks_bœckli°
(
rouã_t
 *
rouã
, c⁄° *
ªas⁄
);

3620 
	`socks_˛órbœckli°
(
rouã_t
 *
rouã
);

3626 
	`mëhodisvÆid
(c⁄° 
mëhod
, 
obje˘ty≥_t
 
ruÀty≥
);

3633 
	`√gŸüã_mëhod
(
s
, 
socks_t
 *
∑ckë
, 
rouã_t
 *
rouã
,

3634 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3649 
	`˛õ¡mëhod_u«me
(
s
, c⁄° 
socksho°_t
 *
ho°
, 
vîsi⁄
,

3650 *
«me
, *
∑ssw‹d
,

3651 *
emsg
, 
size_t
 
emsgÀn
);

3664 #i‡
HAVE_GSSAPI


3666 
	`˛õ¡mëhod_gsßpi
(
s
, 
¥Ÿocﬁ
, c⁄° 
g©eway_t
 *
gw
,

3667 
vîsi⁄
, 
authmëhod_t
 *
auth
,

3668 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3681 
	`gsßpi_ícode
(c⁄° 
gss_buf„r_t
 
ö
, 
gsßpi_°©e_t
 *
gs
, gss_buf„r_à
out
);

3695 
	`gsßpi_decode
(c⁄° 
gss_buf„r_t
 
ö
, 
gsßpi_°©e_t
 *
gs
, gss_buf„r_à
out
);

3711 
	`socks_yy∑r£
();

3712 
	`socks_yyÀx
();

3715 
	`socks_£ndªque°
(
s
, c⁄° 
ªque°_t
 *
ªque°
,

3716 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3725 
	`socks_ªcvª•⁄£
(
s
, 
ª•⁄£_t
 *
ª•⁄£
, 
vîsi⁄
,

3726 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3737 
iobuf„r_t
 *

3738 
	`socks_Ælocbuf„r
(c⁄° 
s
, c⁄° 
ty≥
);

3749 
	`socks_öôbuf„r
(c⁄° 
fd
, c⁄° 
°y≥
, 
iobuf„r_t
 *
iobuf
);

3751 
iobuf„r_t
 *

3752 
	`socks_gëbuf„r
(c⁄° 
s
);

3758 
	`socks_‰ìbuf„r
(c⁄° 
s
);

3765 
	`socks_ªÆlocbuf„r
(c⁄° 
ﬁd
, c⁄° 
√w
);

3772 
	`socks_˛órbuf„r
(c⁄° 
s
, c⁄° 
whichbuf_t
 
ty≥
);

3778 
	`socks_Êushbuf„r
(c⁄° 
s
, c⁄° 
ssize_t
 
Àn
,

3779 
£ndto_öfo_t
 *
£ndtoÊags
);

3794 
	`socks_£tbuf„r
(
iobuf„r_t
 *
iobuf
, c⁄° 
mode
, 
ssize_t
 
bufsize
);

3797 
	`socks_£tbuf„rfd
(c⁄° 
fd
, c⁄° 
mode
, 
ssize_t
 
bufsize
);

3815 
size_t
 
	$socks_addtobuf„r
(c⁄° 
s
, c⁄° 
whichbuf_t
 
which
,

3816 c⁄° 
ícoded
, c⁄° *
d©a
,

3817 c⁄° 
size_t
 
d©Æí
)

3818 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 4, 5)));

3829 
size_t


3830 
	$socks_gë‰ombuf„r
(c⁄° 
s
, c⁄° 
size_t
 
Êags
, c⁄° 
whichbuf_t
 
which
,

3831 c⁄° 
ícoded
, *
d©a
, 
size_t
 
d©Æí
)

3832 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 5, 6)));

3846 
size_t


3847 
	`socks_byãsöbuf„r
(c⁄° 
s
, c⁄° 
whichbuf_t
 
which
, c⁄° 
ícoded
);

3853 
	`socks_buf„rhasbyãs
(c⁄° 
s
, c⁄° 
whichbuf_t
 
which
);

3861 
size_t


3862 
	`socks_‰ìöbuf„r
(c⁄° 
s
, c⁄° 
whichbuf_t
 
which
);

3867 
size_t


3868 
	`socks_buf„rsize
(c⁄° 
s
, c⁄° 
whichbuf_t
 
which
);

3874 #i‡
HAVE_LIVEDEBUG


3877 
	`socks_Êushrb
();

3885 
fd_£t
 *

3886 
	`Æloˇã_maxsize_fd£t
();

3893 
æim_t


3894 
	`gëmaxofûes
(
limôty≥_t
 
ty≥
);

3902 
	$socks_gëu£∫ame
(c⁄° 
socksho°_t
 *
ho°
, *
buf
, 
size_t
 
buÊí
)

3903 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

3915 
	`socks_gë∑ssw‹d
(c⁄° 
socksho°_t
 *
ho°
, c⁄° *
u£r
,

3916 *
buf
, 
size_t
 
buÊí
);

3928 
	`socks_gëív
(c⁄° *
«me
, 
vÆue_t
 
vÆue
);

3944 
	`socks_msgha£º‹s
(c⁄° *
¥efix
, c⁄° 
msghdr
 *
msg
);

3954 
	`£c⁄ds2days
(*
£c⁄ds
, *
days
,

3955 *
hours
, *
möuãs
);

3964 
	`showc⁄fig
(c⁄° 
c⁄fig
 *config);

3970 
	`sock›ts_dump
();

3975 c⁄° 
sock›t_t
 *

3976 
	`›äame2sock›t
(*
›äame
);

3981 c⁄° 
sock›t_t
 *

3982 
	`›tvÆ2sock›t
(
Àvñ
, 
›tvÆ
);

3989 c⁄° 
sock›t_t
 *

3990 
	`›tid2sock›t
(
size_t
 
›tid
);

3995 c⁄° 
sock›tvÆsym_t
 *

3996 
	`›tvÆ2vÆsym
(
size_t
 
›tid
, *
«me
);

4003 #i‡
HAVE_SOCKS_HOSTID


4005 
	`gësockëho°id
(c⁄° 
s
, c⁄° 
size_t
 
addrc
, 
ö_addr
 
addrv
[]);

4015 
	`£tsockëho°id
(c⁄° 
s
, c⁄° 
size_t
 
addrc
, 
ö_addr
 
addrv
[]);

4025 #i‡
COVENANT


4026 *
	`socks_decode_ba£64
(*
ö
, *
out
, 
size_t
 
ouéí
);

4027 *
	`socks_°rˇ£°r
(c⁄° *
a
, c⁄° *
b
);

4030 #i‡
SOCKSLIBRARY_DYNAMIC


4031 
	~"öãΩosôi⁄.h
"

4034 #i‡
SOCKS_CLIENT


4035 
	~"socks.h
"

4037 
	~"sockd.h
"

4040 
	~"to°rög.h
"

4041 
	~"fmt.h
"

4043 #i‡
HAVE_GSSAPI


4044 
	~"socks_gsßpi.h
"

4048 
	`¶og°ack
();

4054 
	`socks_gëiÁddrs
(
iÁddrs
 **
iÁp
);

4062 
	`socks_öë_±⁄
(c⁄° 
af
, c⁄° *
§c
, *
d°
, 
uöt32_t
 *
d°sc›e
);

4072 
	`£t_höts_ai_Ámûy
(*
ai_Ámûy
);

4080 
	`makedummyfd
(c⁄° 
ß_Ámûy_t
 
ßÁmûy
, c⁄° 
sockty≥
);

4091 #i‡
DEBUG


4094 
	`¥ötsockë›ts
(c⁄° 
s
);

4100 
	`fd_is£t
(
fd
, 
fd_£t
 *
fd£t
);

	@include/config.h

47 #i‚de‡
_CONFIG_H_


48 
	#_CONFIG_H_


	)

69 
	#SOCKS_LOCKFILE
 ".sock¶ockXXXXXXXXXX"

	)

76 
	#SOCKD_SHMEMFILE
 ".sockdshmemXXXXXXXXXX"

	)

78 #i‡
COVENANT


81 
	#MAXREQLEN
 (2048)

	)

83 
	#DEFAULT_REALMNAME
 "nŸÅhêIn„∫ÿNëtvîk A/SÑólm"

	)

85 #ñi‡
SOCKS_SERVER


88 
	#MAXREQLEN
 ((
ªque°_t
))

	)

94 
	#SOCKS_PROFILEDIR
 "./.¥of"

	)

102 
	#LOG_ALARM
 (
LOG_WARNING
)

	)

109 #i‡
HAVE_LIBWRAP


110 
	#LIBWRAPBUF
 (200)

	)

117 #i‡
SOCKS_SERVER


118 
	#DEFAULT_PAMSERVICENAME
 "sockd"

	)

119 #ñi‡
BAREFOOTD


120 
	#DEFAULT_PAMSERVICENAME
 "b¨efoŸd"

	)

122 
	#DEFAULT_PAMSERVICENAME
 "coví™td"

	)

129 
	#DEFAULT_BSDAUTHSTYLENAME
 ""

	)

135 
	#DEFAULT_GSSAPISERVICENAME
 "rcmd"

	)

136 
	#DEFAULT_GSSAPIKEYTAB
 "FILE:/ëc/sockd.keyèb"

	)

139 
	#DEFAULT_PAM_USER
 "rho°u§"

	)

145 
	#DEFAULT_PAM_RUSER
 "rho°u§"

	)

148 
	#SOCKD_PORT
 (1080)

	)

156 #i‚de‡
SOCKD_BUFSIZE


157 #i‡
HAVE_GSSAPI


163 
	#SOCKD_BUFSIZE
 (2 * (
MAXGSSAPITOKENLEN
 + 
GSSAPI_HLEN
))

	)

169 
	#SOCKD_BUFSIZE
 (1024 * 64 * 1)

	)

179 
	#SOCKD_MAXCLIENTQUEUE
 (511)

	)

182 
	#ROUTEBLACKLIST_SECONDS
 (60 * 5)

	)

190 
	#SOCKD_HOSTCACHE
 (512)

	)

193 
	#SOCKD_CACHETIMEOUT
 (60 * 5)

	)

196 
	#SOCKD_LDAPCACHE_STAT
 (0)

	)

214 #i‚de‡
SOCKD_NEGOTIATEMAX


215 #i‡
PRERELEASE


216 
	#SOCKD_NEGOTIATEMAX
 (2)

	)

218 
	#SOCKD_NEGOTIATEMAX
 (96)

	)

231 #i‚de‡
SOCKD_IOMAX


232 #i‡
PRERELEASE


233 
	#SOCKD_IOMAX
 (2)

	)

235 
	#SOCKD_IOMAX
 (32)

	)

239 #i‡
SOCKD_NEGOTIATEMAX
 < 1 || 
SOCKD_IOMAX
 < 1

247 
	#SOCKD_FREESLOTS_NEGOTIATE
 (
	`MAX
(
SOCKD_NEGOTIATEMAX
, 8))

	)

249 
	#SOCKD_FREESLOTS_REQUEST
 1

	)

250 
	#SOCKD_FREESLOTS_IO
 (
	`MAX
(
SOCKD_IOMAX
, 32))

	)

252 #i‡
SOCKD_FREESLOTS_NEGOTIATE
 < 1

253 || 
	gSOCKD_FREESLOTS_REQUEST
 < 1

254 || 
	gSOCKD_FREESLOTS_IO
 < 1

267 
	#SOCKD_LDAPCACHE
 (512)

	)

270 
	#SOCKD_LDAPCACHE_TIMEOUT
 (60 * 15)

	)

276 
	#DEFAULT_LDAP_FILTER
 "(membîuid=%s)"

	)

277 
	#DEFAULT_LDAP_ATTRIBUTE
 "˙"

	)

282 
	#DEFAULT_LDAP_FILTER_AD
 "(ßmaccou¡«me=%s)"

	)

283 
	#DEFAULT_LDAP_ATTRIBUTE_AD
 "membîof"

	)

288 
	#DEFAULT_LDAP_CACERTFILE
 "/ëc/s¶/˚πs/˚π.≥m"

	)

289 
	#DEFAULT_LDAP_CERTDBPATH
 "/ëc/˚πs"

	)

297 #i‡
BAREFOOTD


304 
	#MIN_UDPCLIENTS
 (512)

	)

	@include/errorsymbols.h

46 #i‚de‡
_ERRORSYMBOLS_H_


47 
	#_ERRORSYMBOLS_H_


	)

50 c⁄° *
	m«me
;

51 c⁄° 
	mvÆue
;

52 } 
	tîr‹symbﬁèbÀ_t
;

57 
	~"îr‹symbﬁs_gí.h
"

	@include/errorsymbols_gen.h

3 c⁄° 
îr‹symbﬁèbÀ_t
 
	gî∫osymbﬁv
[] = {

4 { "E2BIG", 
E2BIG
 },

5 { "EACCES", 
EACCES
 },

6 { "EADDRINUSE", 
EADDRINUSE
 },

7 { "EADDRNOTAVAIL", 
EADDRNOTAVAIL
 },

8 { "EADV", 
EADV
 },

9 { "EAFNOSUPPORT", 
EAFNOSUPPORT
 },

10 { "EAGAIN", 
EAGAIN
 },

11 { "EALREADY", 
EALREADY
 },

12 { "EBADE", 
EBADE
 },

13 { "EBADF", 
EBADF
 },

14 { "EBADFD", 
EBADFD
 },

15 { "EBADMSG", 
EBADMSG
 },

16 { "EBADR", 
EBADR
 },

17 { "EBADRQC", 
EBADRQC
 },

18 { "EBADSLT", 
EBADSLT
 },

19 { "EBFONT", 
EBFONT
 },

20 { "EBUSY", 
EBUSY
 },

21 { "ECANCELED", 
ECANCELED
 },

22 { "ECHILD", 
ECHILD
 },

23 { "ECHRNG", 
ECHRNG
 },

24 { "ECOMM", 
ECOMM
 },

25 { "ECONNABORTED", 
ECONNABORTED
 },

26 { "ECONNREFUSED", 
ECONNREFUSED
 },

27 { "ECONNRESET", 
ECONNRESET
 },

28 { "EDEADLK", 
EDEADLK
 },

29 { "EDEADLOCK", 
EDEADLOCK
 },

30 { "EDESTADDRREQ", 
EDESTADDRREQ
 },

31 { "EDOM", 
EDOM
 },

32 { "EDQUOT", 
EDQUOT
 },

33 { "EEXIST", 
EEXIST
 },

34 { "EFAULT", 
EFAULT
 },

35 { "EFBIG", 
EFBIG
 },

36 { "EHOSTDOWN", 
EHOSTDOWN
 },

37 { "EHOSTUNREACH", 
EHOSTUNREACH
 },

38 { "EIDRM", 
EIDRM
 },

39 { "EILSEQ", 
EILSEQ
 },

40 { "EINPROGRESS", 
EINPROGRESS
 },

41 { "EINTR", 
EINTR
 },

42 { "EINVAL", 
EINVAL
 },

43 { "EIO", 
EIO
 },

44 { "EISCONN", 
EISCONN
 },

45 { "EISDIR", 
EISDIR
 },

46 { "EL2HLT", 
EL2HLT
 },

47 { "EL2NSYNC", 
EL2NSYNC
 },

48 { "EL3HLT", 
EL3HLT
 },

49 { "EL3RST", 
EL3RST
 },

50 { "ELIBACC", 
ELIBACC
 },

51 { "ELIBBAD", 
ELIBBAD
 },

52 { "ELIBEXEC", 
ELIBEXEC
 },

53 { "ELIBMAX", 
ELIBMAX
 },

54 { "ELIBSCN", 
ELIBSCN
 },

55 { "ELNRNG", 
ELNRNG
 },

56 { "ELOOP", 
ELOOP
 },

57 { "EMEDIUMTYPE", 
EMEDIUMTYPE
 },

58 { "EMFILE", 
EMFILE
 },

59 { "EMLINK", 
EMLINK
 },

60 { "EMSGSIZE", 
EMSGSIZE
 },

61 { "EMULTIHOP", 
EMULTIHOP
 },

62 { "ENAMETOOLONG", 
ENAMETOOLONG
 },

63 { "ENETDOWN", 
ENETDOWN
 },

64 { "ENETRESET", 
ENETRESET
 },

65 { "ENETUNREACH", 
ENETUNREACH
 },

66 { "ENFILE", 
ENFILE
 },

67 { "ENOANO", 
ENOANO
 },

68 { "ENOBUFS", 
ENOBUFS
 },

69 { "ENOCSI", 
ENOCSI
 },

70 { "ENODATA", 
ENODATA
 },

71 { "ENODEV", 
ENODEV
 },

72 { "ENOENT", 
ENOENT
 },

73 { "ENOEXEC", 
ENOEXEC
 },

74 { "ENOLCK", 
ENOLCK
 },

75 { "ENOLINK", 
ENOLINK
 },

76 { "ENOMEDIUM", 
ENOMEDIUM
 },

77 { "ENOMEM", 
ENOMEM
 },

78 { "ENOMSG", 
ENOMSG
 },

79 { "ENONET", 
ENONET
 },

80 { "ENOPKG", 
ENOPKG
 },

81 { "ENOPROTOOPT", 
ENOPROTOOPT
 },

82 { "ENOSPC", 
ENOSPC
 },

83 { "ENOSR", 
ENOSR
 },

84 { "ENOSTR", 
ENOSTR
 },

85 { "ENOSYS", 
ENOSYS
 },

86 { "ENOTBLK", 
ENOTBLK
 },

87 { "ENOTCONN", 
ENOTCONN
 },

88 { "ENOTDIR", 
ENOTDIR
 },

89 { "ENOTEMPTY", 
ENOTEMPTY
 },

90 { "ENOTRECOVERABLE", 
ENOTRECOVERABLE
 },

91 { "ENOTSOCK", 
ENOTSOCK
 },

92 { "ENOTSUP", 
ENOTSUP
 },

93 { "ENOTTY", 
ENOTTY
 },

94 { "ENOTUNIQ", 
ENOTUNIQ
 },

95 { "ENXIO", 
ENXIO
 },

96 { "EOPNOTSUPP", 
EOPNOTSUPP
 },

97 { "EOVERFLOW", 
EOVERFLOW
 },

98 { "EOWNERDEAD", 
EOWNERDEAD
 },

99 { "EPERM", 
EPERM
 },

100 { "EPFNOSUPPORT", 
EPFNOSUPPORT
 },

101 { "EPIPE", 
EPIPE
 },

102 { "EPROTO", 
EPROTO
 },

103 { "EPROTONOSUPPORT", 
EPROTONOSUPPORT
 },

104 { "EPROTOTYPE", 
EPROTOTYPE
 },

105 { "ERANGE", 
ERANGE
 },

106 { "EREMCHG", 
EREMCHG
 },

107 { "EREMOTE", 
EREMOTE
 },

108 { "ERESTART", 
ERESTART
 },

109 { "EROFS", 
EROFS
 },

110 { "ESHUTDOWN", 
ESHUTDOWN
 },

111 { "ESOCKTNOSUPPORT", 
ESOCKTNOSUPPORT
 },

112 { "ESPIPE", 
ESPIPE
 },

113 { "ESRCH", 
ESRCH
 },

114 { "ESRMNT", 
ESRMNT
 },

115 { "ESTALE", 
ESTALE
 },

116 { "ESTRPIPE", 
ESTRPIPE
 },

117 { "ETIME", 
ETIME
 },

118 { "ETIMEDOUT", 
ETIMEDOUT
 },

119 { "ETOOMANYREFS", 
ETOOMANYREFS
 },

120 { "ETXTBSY", 
ETXTBSY
 },

121 { "EUNATCH", 
EUNATCH
 },

122 { "EUSERS", 
EUSERS
 },

123 { "EWOULDBLOCK", 
EWOULDBLOCK
 },

124 { "EXDEV", 
EXDEV
 },

125 { "EXFULL", 
EXFULL
 },

126 { "ENOTEMPTY", 
ENOTEMPTY
 },

127 { "EWOULDBLOCK", 
EWOULDBLOCK
 },

128 { "no-rouã", 
ENETUNREACH
 },

129 { "no-rouã", 
EHOSTUNREACH
 },

130 { "no-rouã", 
ENETDOWN
 },

131 { "no-rouã", 
ETIMEDOUT
 },

132 { "sy°em-™y", 
E2BIG
 },

133 { "sy°em-™y", 
EACCES
 },

134 { "sy°em-™y", 
EADDRINUSE
 },

135 { "sy°em-™y", 
EADDRNOTAVAIL
 },

136 { "sy°em-™y", 
EADV
 },

137 { "sy°em-™y", 
EAFNOSUPPORT
 },

138 { "sy°em-™y", 
EAGAIN
 },

139 { "sy°em-™y", 
EALREADY
 },

140 { "sy°em-™y", 
EBADE
 },

141 { "sy°em-™y", 
EBADF
 },

142 { "sy°em-™y", 
EBADFD
 },

143 { "sy°em-™y", 
EBADMSG
 },

144 { "sy°em-™y", 
EBADR
 },

145 { "sy°em-™y", 
EBADRQC
 },

146 { "sy°em-™y", 
EBADSLT
 },

147 { "sy°em-™y", 
EBFONT
 },

148 { "sy°em-™y", 
EBUSY
 },

149 { "sy°em-™y", 
ECANCELED
 },

150 { "sy°em-™y", 
ECHILD
 },

151 { "sy°em-™y", 
ECHRNG
 },

152 { "sy°em-™y", 
ECOMM
 },

153 { "sy°em-™y", 
ECONNABORTED
 },

154 { "sy°em-™y", 
ECONNREFUSED
 },

155 { "sy°em-™y", 
ECONNRESET
 },

156 { "sy°em-™y", 
EDEADLK
 },

157 { "sy°em-™y", 
EDEADLOCK
 },

158 { "sy°em-™y", 
EDESTADDRREQ
 },

159 { "sy°em-™y", 
EDOM
 },

160 { "sy°em-™y", 
EDQUOT
 },

161 { "sy°em-™y", 
EEXIST
 },

162 { "sy°em-™y", 
EFAULT
 },

163 { "sy°em-™y", 
EFBIG
 },

164 { "sy°em-™y", 
EHOSTDOWN
 },

165 { "sy°em-™y", 
EHOSTUNREACH
 },

166 { "sy°em-™y", 
EIDRM
 },

167 { "sy°em-™y", 
EILSEQ
 },

168 { "sy°em-™y", 
EINPROGRESS
 },

169 { "sy°em-™y", 
EINTR
 },

170 { "sy°em-™y", 
EINVAL
 },

171 { "sy°em-™y", 
EIO
 },

172 { "sy°em-™y", 
EISCONN
 },

173 { "sy°em-™y", 
EISDIR
 },

174 { "sy°em-™y", 
EL2HLT
 },

175 { "sy°em-™y", 
EL2NSYNC
 },

176 { "sy°em-™y", 
EL3HLT
 },

177 { "sy°em-™y", 
EL3RST
 },

178 { "sy°em-™y", 
ELIBACC
 },

179 { "sy°em-™y", 
ELIBBAD
 },

180 { "sy°em-™y", 
ELIBEXEC
 },

181 { "sy°em-™y", 
ELIBMAX
 },

182 { "sy°em-™y", 
ELIBSCN
 },

183 { "sy°em-™y", 
ELNRNG
 },

184 { "sy°em-™y", 
ELOOP
 },

185 { "sy°em-™y", 
EMEDIUMTYPE
 },

186 { "sy°em-™y", 
EMFILE
 },

187 { "sy°em-™y", 
EMLINK
 },

188 { "sy°em-™y", 
EMSGSIZE
 },

189 { "sy°em-™y", 
EMULTIHOP
 },

190 { "sy°em-™y", 
ENAMETOOLONG
 },

191 { "sy°em-™y", 
ENETDOWN
 },

192 { "sy°em-™y", 
ENETRESET
 },

193 { "sy°em-™y", 
ENETUNREACH
 },

194 { "sy°em-™y", 
ENFILE
 },

195 { "sy°em-™y", 
ENOANO
 },

196 { "sy°em-™y", 
ENOBUFS
 },

197 { "sy°em-™y", 
ENOCSI
 },

198 { "sy°em-™y", 
ENODATA
 },

199 { "sy°em-™y", 
ENODEV
 },

200 { "sy°em-™y", 
ENOENT
 },

201 { "sy°em-™y", 
ENOEXEC
 },

202 { "sy°em-™y", 
ENOLCK
 },

203 { "sy°em-™y", 
ENOLINK
 },

204 { "sy°em-™y", 
ENOMEDIUM
 },

205 { "sy°em-™y", 
ENOMEM
 },

206 { "sy°em-™y", 
ENOMSG
 },

207 { "sy°em-™y", 
ENONET
 },

208 { "sy°em-™y", 
ENOPKG
 },

209 { "sy°em-™y", 
ENOPROTOOPT
 },

210 { "sy°em-™y", 
ENOSPC
 },

211 { "sy°em-™y", 
ENOSR
 },

212 { "sy°em-™y", 
ENOSTR
 },

213 { "sy°em-™y", 
ENOSYS
 },

214 { "sy°em-™y", 
ENOTBLK
 },

215 { "sy°em-™y", 
ENOTCONN
 },

216 { "sy°em-™y", 
ENOTDIR
 },

217 { "sy°em-™y", 
ENOTEMPTY
 },

218 { "sy°em-™y", 
ENOTRECOVERABLE
 },

219 { "sy°em-™y", 
ENOTSOCK
 },

220 { "sy°em-™y", 
ENOTSUP
 },

221 { "sy°em-™y", 
ENOTTY
 },

222 { "sy°em-™y", 
ENOTUNIQ
 },

223 { "sy°em-™y", 
ENXIO
 },

224 { "sy°em-™y", 
EOPNOTSUPP
 },

225 { "sy°em-™y", 
EOVERFLOW
 },

226 { "sy°em-™y", 
EOWNERDEAD
 },

227 { "sy°em-™y", 
EPERM
 },

228 { "sy°em-™y", 
EPFNOSUPPORT
 },

229 { "sy°em-™y", 
EPIPE
 },

230 { "sy°em-™y", 
EPROTO
 },

231 { "sy°em-™y", 
EPROTONOSUPPORT
 },

232 { "sy°em-™y", 
EPROTOTYPE
 },

233 { "sy°em-™y", 
ERANGE
 },

234 { "sy°em-™y", 
EREMCHG
 },

235 { "sy°em-™y", 
EREMOTE
 },

236 { "sy°em-™y", 
ERESTART
 },

237 { "sy°em-™y", 
EROFS
 },

238 { "sy°em-™y", 
ESHUTDOWN
 },

239 { "sy°em-™y", 
ESOCKTNOSUPPORT
 },

240 { "sy°em-™y", 
ESPIPE
 },

241 { "sy°em-™y", 
ESRCH
 },

242 { "sy°em-™y", 
ESRMNT
 },

243 { "sy°em-™y", 
ESTALE
 },

244 { "sy°em-™y", 
ESTRPIPE
 },

245 { "sy°em-™y", 
ETIME
 },

246 { "sy°em-™y", 
ETIMEDOUT
 },

247 { "sy°em-™y", 
ETOOMANYREFS
 },

248 { "sy°em-™y", 
ETXTBSY
 },

249 { "sy°em-™y", 
EUNATCH
 },

250 { "sy°em-™y", 
EUSERS
 },

251 { "sy°em-™y", 
EWOULDBLOCK
 },

252 { "sy°em-™y", 
EXDEV
 },

253 { "sy°em-™y", 
EXFULL
 },

254 { "sy°em-™y", 
ENOTEMPTY
 },

255 { "sy°em-™y", 
EWOULDBLOCK
 },

258 c⁄° 
îr‹symbﬁèbÀ_t
 
	ggaõºsymbﬁv
[] = {

259 { "EAI_AGAIN", 
EAI_AGAIN
 },

260 { "EAI_BADFLAGS", 
EAI_BADFLAGS
 },

261 { "EAI_FAIL", 
EAI_FAIL
 },

262 { "EAI_FAMILY", 
EAI_FAMILY
 },

263 { "EAI_MEMORY", 
EAI_MEMORY
 },

264 { "EAI_NONAME", 
EAI_NONAME
 },

265 { "EAI_OVERFLOW", 
EAI_OVERFLOW
 },

266 { "EAI_SERVICE", 
EAI_SERVICE
 },

267 { "EAI_SOCKTYPE", 
EAI_SOCKTYPE
 },

268 { "EAI_SYSTEM", 
EAI_SYSTEM
 },

269 { "dns-™y", 
EAI_AGAIN
 },

270 { "dns-™y", 
EAI_BADFLAGS
 },

271 { "dns-™y", 
EAI_FAIL
 },

272 { "dns-™y", 
EAI_FAMILY
 },

273 { "dns-™y", 
EAI_MEMORY
 },

274 { "dns-™y", 
EAI_NONAME
 },

275 { "dns-™y", 
EAI_OVERFLOW
 },

276 { "dns-™y", 
EAI_SERVICE
 },

277 { "dns-™y", 
EAI_SOCKTYPE
 },

278 { "dns-™y", 
EAI_SYSTEM
 },

	@include/fmt.h

46 #i‚de‡
_FMT_H_


47 
	#_FMT_H_


	)

56 
fmåe•⁄£îr‹
(c⁄° 
ssize_t
 
ª˚ived
, c⁄° 
size_t
 
ex≥˘ed
,

57 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

67 
fmtvîsi⁄îr‹
(c⁄° 
ex≥˘ed
, c⁄° 
ª˚ived
,

68 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

78 
log_wrôeÁûed
(c⁄° 
öãrÁ˚side_t
 
side
, c⁄° 
s
,

79 c⁄° 
sockaddr_°‹age
 *
d°
);

87 
log_c⁄√˘Áûed
(c⁄° 
öãrÁ˚side_t
 
side
, c⁄° *
d°°r
);

93 
log_ªsﬁveÁûed
(c⁄° *
ho°«me
, c⁄° 
öãrÁ˚side_t
 
side
,

94 c⁄° 
gaõº
);

104 
log_ªvî£m≠Áûed
(c⁄° 
sockaddr_°‹age
 *
addr
,

105 c⁄° 
öãrÁ˚side_t
 
side
, c⁄° 
gaõº
);

114 #i‡
SOCKS_CLIENT


120 
log_gësock›t_Áûed
(c⁄° *
fun˘i⁄
, c⁄° *
›ti⁄
, c⁄° 
fd
,

121 c⁄° 
öãrÁ˚side_t
 
öãrÁ˚side
);

129 
log_£tsock›t_Áûed
(c⁄° *
fun˘i⁄
, c⁄° *
›ti⁄
,

130 c⁄° 
vÆue
, c⁄° 
fd
,

131 c⁄° 
öãrÁ˚side_t
 
öãrÁ˚side
);

139 
log_öãrÁ˚¥Ÿocﬁ_£t_too_œã
(c⁄° 
öãrÁ˚side_t
 
side
);

145 
log_addchûd_Áûed
();

151 
log_˛õ¡dr›≥d
(c⁄° 
sockaddr_°‹age
 *
˛õ¡
);

157 
log_˛õ¡£nd
(c⁄° 
sockaddr_°‹age
 *
˛õ¡
,

158 c⁄° 
sockd_chûd_t
 *
chûd
, c⁄° 
i§e£nd
);

165 
log_£ndÁûed
(c⁄° 
sockaddr_°‹age
 *
˛õ¡
, c⁄° 
s
,

166 c⁄° 
sockd_chûd_t
 *
chûd
, c⁄° 
isfú°time
);

177 
log_no˛õ¡ªcv
(c⁄° 
sockd_chûd_t
 *
chûd
);

184 
log_¥obablytimedout
(c⁄° 
sockaddr_°‹age
 *
˛õ¡
,

185 c⁄° 
sockd_chûd_t
 *
chûd
);

192 
log_åunˇãdudp
(c⁄° *
fun˘i⁄
, c⁄° 
sockaddr_°‹age
 *
‰om
,

193 c⁄° 
ssize_t
 
Àn
);

200 
sockd_ªadmŸhîsc⁄åﬁsockë
(c⁄° *
¥efix
, c⁄° 
s
);

208 
log_ruÀöfo_shmid
(c⁄° 
ruÀ_t
 *
ruÀ
, c⁄° *
fun˘i⁄
,

209 c⁄° *
c⁄ãxt
);

217 
log_boundexã∫Æaddªss
(c⁄° *
fun˘i⁄
,

218 c⁄° 
sockaddr_°‹age
 *
addr
);

225 
log_u√x≥˘ed_ud¥ecv_îr‹
(c⁄° *
fun˘i⁄
, c⁄° 
fd
,

226 c⁄° 
îr‹
, c⁄° 
öãrÁ˚side_t
 
side
);

232 
log_böd_Áûed
(c⁄° *
fun˘i⁄
, c⁄° 
¥Ÿocﬁ
,

233 c⁄° 
sockaddr_°‹age
 *
addªss
);

240 
log_mtu¥obÀm
(c⁄° 
s
, c⁄° 
öãrÁ˚side_t
 
side
, c⁄° 
‰omus
);

	@include/interposition.h

47 #i‚de‡
_INTERPOSITION_H_


48 
	#_INTERPOSITION_H_


	)

50 
	~"symbﬁs.h
"

52 íum { 
	mpid
 = 0, 
	mthªad
 } 
	twhich_id_t
;

53 
	ssocks_id_t
 {

54 
which_id_t
 
	mwhichid
;

56 
pid_t
 
	mpid
;

57 #i‡
HAVE_PTHREAD_H


58 
±hªad_t
 
	mthªad
;

60 } 
	mid
;

62 
socks_id_t
 *
	m√xt
;

63 } 
	tsocks_id_t
;

66 *
	msymbﬁ
;

67 *
	mlibøry
;

68 *
	mh™dÀ
;

69 *
	mfun˘i⁄
;

71 
socks_id_t
 *
	mdosysˇŒ
;

80 } 
	tlibsymbﬁ_t
;

82 #i‡
SOCKS_CLIENT


84 
socks_m¨k_io_as_«tive
();

85 
socks_m¨k_io_as_n‹mÆ
();

91 
socks_sysˇŒ_°¨t
(c⁄° 
s
);

97 
socks_sysˇŒ_íd
(c⁄° 
s
);

104 
socks_issysˇŒ
(c⁄° 
s
, c⁄° *
«me
);

112 
socks_id_t
 *

113 
socks_whﬂmi
(
socks_id_t
 *
id
);

124 
	#socks_sysˇŒ_°¨t
(
s
)

	)

125 
	#socks_sysˇŒ_íd
(
s
)

	)

127 
	#socks_whﬂmi
(
_id
) \

129 (
_id
)->
whichid
 = 
pid
; \

130 (
_id
)->
id
.
pid
 = 
sockscf
.
°©e
.pid; \

131 (
_id
)->
√xt
 = 
NULL
; \

132 }  0)

	)

138 
socks_shouldˇŒa¢©ive
(c⁄° *
fun˘i⁄«me
);

147 
socks_m¨ka¢©ive
(c⁄° *
fun˘i⁄«me
);

155 
socks_m¨ka¢‹mÆ
(c⁄° *
fun˘i⁄«me
);

164 
symbﬁfun˘i⁄
(c⁄° *
symbﬁ
);

172 
symbﬁcheck
();

	@include/monitor.h

46 #i‚de‡
_MONITOR_H_


47 
	#_MONITOR_H_


	)

53 
	#TEST_MTU_TCP_KEEPIDLE
 (10Ë

	)

54 
	#TEST_MTU_ACKWAIT
 (10Ë

	)

55 íum { 
	mTEST_MTU
 = 1 } 
	tm⁄ô‹_ã°_ty≥_t
;

58 
	ms
;

59 
iocou¡_t
 
	m£nd
;

60 
iocou¡_t
 
	mªcv
;

61 } 
	tm⁄ô‹_ã°_d©a_t
;

64 
m⁄ô‹_ã°_d©a_t
 
	möã∫Æ
;

65 
m⁄ô‹_ã°_d©a_t
 
	mexã∫Æ
;

71 
√tw‹kã°_t
 
	möã∫Æ
;

72 
√tw‹kã°_t
 
	mexã∫Æ
;

73 } 
	mã°
;

79 
timevÆ
 
	mts_£¡
;

80 
timevÆ
 
	mts_ª˚ived
;

81 } 
	tm⁄ô‹_ã°_t
;

86 
	möã∫Æ_ªcv
;

87 
	möã∫Æ_£nd
;

88 
	mexã∫Æ_ªcv
;

89 
	mexã∫Æ_£nd
;

91 
	möã∫Æ_disc⁄√˘
;

92 
	mexã∫Æ_disc⁄√˘
;

93 } 
	mevít
;

94 } 
	tm⁄ô‹_ã°s_t
;

97 
check√tw‹kã°s
(c⁄° 
timevÆ
 *
äow
);

103 
time_t


104 
time_tûl_√tw‹kã°_°¨t
(c⁄° 
sockd_io_t
 *
io
, c⁄° 
timevÆ
 *
äow
,

105 
√tw‹kã°_t
 *
öã∫Æ
,Çëw‹kã°_à*
exã∫Æ
);

122 
time_t


123 
time_tûl_mtu_ã°_°¨t
(c⁄° 
timevÆ
 *
äow
,

124 c⁄° 
timevÆ
 *
œ°io
);

132 
mtuã°
(c⁄° 
s
, c⁄° 
öãrÁ˚side_t
 
side
, c⁄° 
timevÆ
 *
äow
,

133 
mtuã°_t
 *
mtu
);

149 
öômtu©å
(c⁄° 
s
, c⁄° 
öãrÁ˚side_t
 
side
, 
mtu_ã°_°©e_t
 *
°©e
);

158 
√tw‹kã°_add
(
√tw‹kã°_ã°ed_t
 *
ã°ed
, c⁄° 
√tw‹kã°_t
 *
scheduÀd
);

166 
m⁄ô‹_ha°imedout
(c⁄° 
timevÆ
 *
äow
, c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
,

167 
m⁄ô‹_ã°s_t
 *
ã°s
);

178 
timevÆ
 *

179 
gë_√tw‹kã°timeout
(c⁄° 
timevÆ
 *
äow
, timevÆ *
timeout
);

187 
timevÆ
 *

188 
gë_m⁄ô‹_evíâimeout
(c⁄° 
timevÆ
 *
äow
, timevÆ *
timeout
);

197 
ªcv_m⁄ô‹
(c⁄° 
s
, 
m⁄ô‹_ã°_t
 *
obje˘
);

206 
£nd_m⁄ô‹
(c⁄° 
s
, c⁄° 
m⁄ô‹_ã°_t
 *
m⁄ô‹
);

215 
add_m⁄ô‹_ã°
(c⁄° 
m⁄ô‹_ã°_t
 *
m⁄ô‹
);

223 
ªmove_m⁄ô‹_ã°
(c⁄° 
size_t
 
ödex
);

229 c⁄° 
m⁄ô‹_t
 *

230 
m⁄ô‹m©ch
(c⁄° 
socksho°_t
 *
‰om
, c⁄° socksho°_à*
to
,

231 c⁄° 
authmëhod_t
 *
auth
, c⁄° 
c⁄√˘i⁄°©e_t
 *
°©e
);

244 
m⁄ô‹_move
(
m⁄ô‹_t
 *
ﬁdm⁄ô‹
, m⁄ô‹_à*
√wm⁄ô‹
,

245 c⁄° 
°ay©èched
, c⁄° 
size_t
 
sidesc⁄√˘ed
,

246 c⁄° 
˛õ¡öfo_t
 *
cöfo
,

247 c⁄° 
lock
);

258 
m⁄ô‹_t
 *

259 
addm⁄ô‹
(c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
);

265 
m⁄ô‹_dëach‰omli°
(
m⁄ô‹_t
 *
hód
);

271 c⁄° 
m⁄ô‹_t
 *

272 
shmid2m⁄ô‹
(c⁄° 
shmid
);

	@include/osdep.h

51 #i‡
HAVE_COND_PAM
 && !
SOCKS_CLIENT


52 
	#HAVE_PAM
 (1)

	)

54 
	#HAVE_PAM
 (0)

	)

57 #i‡
HAVE_COND_LIBWRAP
 && !
SOCKS_CLIENT


58 
	#HAVE_LIBWRAP
 (1)

	)

60 
	#HAVE_LIBWRAP
 (0)

	)

64 #i‡
HAVE_COND_LIVEDEBUG


65 
	#HAVE_LIVEDEBUG
 (1)

	)

67 
	#HAVE_LIVEDEBUG
 (0)

	)

71 
	~<sys/ty≥s.h
>

72 #i‡
HAVE_SYS_TIME_H


73 
	~<sys/time.h
>

75 #i‡
HAVE_SYS_FILE_H


76 
	~<sys/fûe.h
>

78 
	~<sys/ªsour˚.h
>

79 
	~<sys/io˘l.h
>

80 #i‡
HAVE_SYS_IPC_H


81 
	~<sys/ùc.h
>

83 #i‡
HAVE_SYS_SEM_H


84 
	~<sys/£m.h
>

86 #i‡(
deföed
 
__sun
Ë&& (deföed 
_NO_SUN_PRAGMA
)

88 #unde‡
__PRAGMA_REDEFINE_EXTNAME


90 
	~<sys/sockë.h
>

91 #i‡(
deföed
 
__sun
Ë&& (deföed 
_NO_SUN_PRAGMA
)

93 #unde‡
böd


94 #unde‡
c⁄√˘


96 
	~<√t/if.h
>

97 #i‡
NEED_SYS_SOCKIO_H


98 
	~<sys/sockio.h
>

100 
	~<sys/mm™.h
>

101 
	~<sys/un.h
>

102 
	~<sys/°©.h
>

103 #ifde‡
SOCKS_DLIB_OSF


104 #unde‡
__DECC


106 
	~<sys/uio.h
>

107 #ifde‡
SOCKS_DLIB_OSF


108 
	#__DECC


	)

110 
	~<sys/waô.h
>

111 #ifde‡
HAVE_SYS_SELECT_H


112 
	~<sys/£À˘.h
>

114 
	~<√töë/ö.h
>

115 
	~<√töë/ö_sy°m.h
>

116 #i‡
HAVE_NETINET_IP_H


117 
	~<√töë/ù.h
>

119 #i‡
HAVE_NETINET_IP_VAR_H


120 
	~<√töë/ù_v¨.h
>

122 
	~<¨∑/öë.h
>

123 #i‡
HAVE_ARPA_NAMESER_H


124 
	~<¨∑/«me£r.h
>

127 
	~<√töë/t˝.h
>

129 #i‡
HAVE_RPC_RPC_H


130 
	~<Ωc/Ωc.h
>

133 #i‡!
HAVE_TIMER_MACROS


134 
	~"timîs.h
"

137 
	~<√töë/ù_icmp.h
>

138 
	~<√töë/udp.h
>

140 
	~<öây≥s.h
>

142 
	~<as£π.h
>

143 #i‡
HAVE_CRYPT_H


144 
	~<¸y±.h
>

147 
	~<˘y≥.h
>

148 
	~<î∫o.h
>

149 
	~<f˙é.h
>

150 #i‡
HAVE_LIMITS_H


151 
	~<limôs.h
>

153 
	~<√tdb.h
>

154 
	~<pwd.h
>

155 
	~<£tjmp.h
>

156 
	~<sig«l.h
>

157 
	~<°d¨g.h
>

158 
	~<°dio.h
>

159 
	~<°dlib.h
>

161 #i‡
HAVE_STRINGS_H


162 
	~<°rögs.h
>

164 
	~<°rög.h
>

166 
	~<sy¶og.h
>

167 #i‡
HAVE_LIBWRAP
 && 
HAVE_TCPD_H


168 
	~<t˝d.h
>

170 #i‡
TIME_WITH_SYS_TIME
 || (!TIME_WITH_SYS_TIME && !
HAVE_SYS_TIME_H
)

171 
	~<time.h
>

173 #i‡
HAVE_UNISTD_H


174 #ifde‡
HAVE_DEC_PROTO


175 #unde‡
_XOPEN_SOURCE_EXTENDED


177 
	~<uni°d.h
>

178 #ifde‡
HAVE_DEC_PROTO


179 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

182 #i‡
HAVE_RESOLV_H


183 
	~<ªsﬁv.h
>

185 #i‡
HAVE_PAM


186 
	~<£curôy/∑m_≠∂.h
>

188 
	~<gΩ.h
>

190 #i‡
HAVE_GSSAPI


192 #i‡
HAVE_GSSAPI_GSSAPI_H


193 
	~<gsßpi/gsßpi.h
>

194 #ñi‡
HAVE_GSSAPI_H


195 
	~<gsßpi.h
>

198 #i‡!
HAVE_HEIMDAL_KERBEROS


199 #i‡
HAVE_GSSAPI_GSSAPI_EXT_H


200 
	~<gsßpi/gsßpi_ext.h
>

202 #i‡
HAVE_GSSAPI_GSSAPI_KRB5_H


203 
	~<gsßpi/gsßpi_krb5.h
>

205 #i‡
HAVE_GSSAPI_GSSAPI_GENERIC_H


206 
	~<gsßpi/gsßpi_gíîic.h
>

211 #i‡
HAVE_STDDEF_H


212 
	~<°ddef.h
>

215 #i‡
HAVE_PTHREAD_H


216 
	~<±hªad.h
>

219 #i‡
HAVE_GETIFADDRS
 && 
HAVE_IFADDRS_H


220 
	~<iÁddrs.h
>

222 
	~"iÁddrs.h
"

225 #i‡
HAVE_VALGRIND_VALGRIND_H


226 
	~<vÆgröd/vÆgröd.h
>

234 #i‡
HAVE_LIBCFAIL
 && !
SOCKS_CLIENT


235 
	~"cÁû.h
"

238 #i‡
HAVE_PRAGMA_SUPPORT


239 
	#NOWARN_ADDRESS_PRAGMA
(Ë
	`_Pøgma
("GCC dügno°i¯ign‹ed \"-Waddªss\"")

	)

241 
	#NOWARN_ADDRESS_PRAGMA
()

	)

244 #i‡
HAVE_DECL_ATTRIBUTE
 && !
deföed
 
löt


245 
	#__ATTRIBUTE__
(
x
Ë
	`__©åibuã__
(x)

	)

247 
	#__ATTRIBUTE__
(
x
)

	)

250 #i‡
HAVE_DECL_NONNULL


251 
	#__NONNULL__
(
x
Ë
	`__n⁄nuŒ__
(x)

	)

253 
	#__NONNULL__
(
x
)

	)

256 #i‡
HAVE_DECL_FORMAT


257 
	#FORMAT
(
x
, 
y
, 
z
Ë
	`f‹m©
(x, y, z)

	)

259 
	#FORMAT
(
x
, 
y
, 
z
)

	)

262 #i‡
HAVE_DECL_BOUNDED


263 
	#__BOUNDED__
(
x
, 
y
, 
z
Ë
	`__bounded__
(x, y, z)

	)

265 
	#__BOUNDED__
(
x
, 
y
, 
z
)

	)

268 #i‡
HAVE_LINUX_BUGS


269 #i‡(
deföed
 
__bsw≠_16
Ë&& (!deföed 
__bsw≠_32
)

270 #unde‡
¡ohl


271 #unde‡
¡ohs


272 #unde‡
ht⁄l


273 #unde‡
ht⁄s


277 #i‚de‡
RLIMIT_OFILE


278 
	#RLIMIT_OFILE
 
RLIMIT_NOFILE


	)

281 #i‚de‡
WAIT_ANY


282 
	#WAIT_ANY
 -1

	)

287 #i‡!
HAVE_SETPROCTITLE


288 
	$£çro˘ôÀ
(c⁄° *
fmt
, ...)

289 
	`__ATTRIBUTE__
((
	`FORMAT
(
__¥ötf__
, 1, 2)));

290 
	`öô£çro˘ôÀ
(, **);

293 #i‡!
HAVE_SOCKATMARK


294 
	`sock©m¨k
();

297 #i‡!
HAVE_STRLCPY


298 
size_t
 
	`°æ˝y
(*
d°
, c⁄° *
§c
, size_à
size
);

299 
size_t
 
	`°æˇt
(*
d°
, c⁄° *
§c
, size_à
size
);

302 #i‡!
HAVE_HSTRERROR


303 c⁄° *
	`h°ªº‹
();

306 #i‡!
HAVE_MEMMOVE


307 * 
	`memmove
(*, c⁄° *, 
size_t
);

310 #i‡!
HAVE_INET_PTON


311 
	`öë_±⁄
(
af
, c⁄° *
§c
, *
d°
);

314 #i‡!
HAVE_ISSETUGID


315 
	`is£tugid
();

318 #i‡!
HAVE_PSELECT


319 
ölöe
 
	`p£À˘
(
nfds
, 
fd_£t
 *
r£t
, fd_£à*
w£t
, fd_£à*
x£t
,

320 c⁄° 
time•ec
 *
ts
, c⁄° 
sig£t_t
 *
sigmask
);

323 #i‡!
HAVE_VSYSLOG


324 
	`vsy¶og
(, c⁄° *, 
va_li°
);

327 #i‡
NEED_GETSOCKOPT_CAST


328 
	#gësock›t
(
a
,
b
,
c
,
d
,
e
Ë
	`gësock›t
(◊),(b),(c),(*)(d),”))

	)

329 
	#£tsock›t
(
a
,
b
,
c
,
d
,
e
Ë
	`£tsock›t
(◊),(b),(c),(*)(d),”))

	)

332 #i‡!
HAVE_SIG_ATOMIC_T


333 
	tsig_©omic_t
;

336 
	#BYTEWIDTH_8BITS
 1

	)

337 
	#BYTEWIDTH_16BITS
 2

	)

338 
	#BYTEWIDTH_32BITS
 4

	)

340 #i‡
SIZEOF_CHAR
 =
BYTEWIDTH_8BITS


341 
	tubôs_8
;

342 
	tsbôs_8
;

347 #i‡
SIZEOF_SHORT
 =
BYTEWIDTH_16BITS


348 
	tubôs_16
;

349 
	tsbôs_16
;

351 #i‡
SIZEOF_INT
 =
BYTEWIDTH_16BITS


352 
	tubôs_16
;

353 
	tsbôs_16
;

359 #i‡
SIZEOF_INT
 =
BYTEWIDTH_32BITS


360 
	tubôs_32
;

361 
	tsbôs_32
;

363 #i‡
SIZEOF_SHORT
 =
BYTEWIDTH_32BITS


364 
	tubôs_32
;

365 
	tsbôs_32
;

367 #i‡
SIZEOF_LONG
 =
BYTEWIDTH_32BITS


368 
	tubôs_32
;

369 
	tsbôs_32
;

376 #i‡!
HAVE_INT8_T


377 
	#öt8_t
 
sbôs_8


	)

380 #i‡!
HAVE_INT16_T


381 
	#öt16_t
 
sbôs_16


	)

384 #i‡!
HAVE_INT32_T


385 
	#öt32_t
 
sbôs_32


	)

388 #i‡!
HAVE_UINT8_T


389 
	#uöt8_t
 
ubôs_8


	)

392 #i‡!
HAVE_UINT16_T


393 
	#uöt16_t
 
ubôs_16


	)

396 #i‡!
HAVE_UINT32_T


397 
	#uöt32_t
 
ubôs_32


	)

400 #i‡!
HAVE_IN_PORT_T


401 
	#ö_p‹t_t
 
ubôs_16


	)

404 #i‡!
HAVE_IN_ADDR_T


405 
	#ö_addr_t
 
ubôs_32


	)

408 #i‚de‡
INADDR_NONE


409 
	#INADDR_NONE
 (
ubôs_32
)0xffffffff

	)

412 #i‚de‡
MAX


413 
	#MAX
(
a
,
b
Ë(◊Ë> (bË? (aË: (b))

	)

416 #i‚de‡
MIN


417 
	#MIN
(
a
,
b
Ë(◊Ë< (bË? (aË: (b))

	)

420 #i‡
NEED_EXIT_FAILURE


422 
	#EXIT_SUCCESS
 0

	)

423 
	#EXIT_FAILURE
 1

	)

426 #i‡
NEED_SA_RESTART


427 
	#SA_RESTART
 
SV_INTERRUPT


	)

430 #i‡
NEED_AF_LOCAL


431 
	#AF_LOCAL
 
AF_UNIX


	)

434 #i‡
HAVE_NOMALLOC_REALLOC


435 
	#ªÆloc
(
p
,
s
Ë((’Ë=
NULL
Ë? (
	`mÆloc
(s)Ë: (
	`ªÆloc
(’),(s))))

	)

438 #i‡
HAVE_NONULL_FREE


439 
	#‰ì
(
p
) \

441 i‡((
p
Ë!
NULL
) \

442 
	`‰ì
((
p
)); \

443 
	}
}  0)

	)

446 #i‚de‡
__CONCAT


447 
	#__CONCAT
(
x
,
y
Ëx ## 
	)
y

450 #i‚de‡
__CONCAT3


451 
	#__CONCAT3
(
x
,
y
,
z
Ëx ## y ## 
	)
z

454 #i‚de‡
ROUNDDOWN


455 
	#ROUNDDOWN
(
x
, 
size
Ë(((xË/ (sizeËË* (size))

	)

458 #i‚de‡
ROUNDUP


459 
	#ROUNDUP
(
x
, 
size
Ë((((xË+ (sizeË- 1Ë/ (size)Ë* (size))

	)

462 
	#ROUNDFLOAT
(
x
Ë((xË>0 ? ()((xË+ 0.5Ë: ()((xË- 0.5))

	)

464 #i‚de‡
EPROTO


465 
	#EPROTO
 
EPROTOTYPE


	)

468 #i‚de‡
ETHER_ADDR_LEN


469 
	#ETHER_ADDR_LEN
 (6)

	)

472 #i‡!
HAVE_STRUCT_IPOPTS


473 
	#MAX_IPOPTLEN
 40

	)

474 
	sù›ti⁄
 {

475 
ö_addr
 
	mù›t_d°
;

476 
sbôs_8
 
	mù›t_li°
[
MAX_IPOPTLEN
];

480 #i‡!
HAVE_FDMASK


481 
	tfd_mask
;

484 #i‡!
HAVE_IN6_ADDR


486 
	sö6_addr
 {

488 
u_öt8_t
 
	m__u6_addr8
[16];

489 
u_öt16_t
 
	m__u6_addr16
[8];

490 
u_öt32_t
 
	m__u6_addr32
[4];

491 } 
	m__u6_addr
;

493 
	#s6_addr
 
__u6_addr
.
__u6_addr8


	)

501 #i‡!
HAVE_DAEMON


502 
d´m⁄
(, );

505 #i‡!
HAVE_DIFFTIME


506 
dif·ime
(c⁄° 
time_t
 
time1
, c⁄°Åime_à
time0
);

509 
	~"ö_cksum.h
"

	@include/qos.h

46 #i‚de‡
_QOS_H_


47 
	#_QOS_H_


	)

66 
	#SOCKS_IP_TOS_DSCP_DEFAULT
 0

	)

68 
	#SOCKS_IP_TOS_DSCP_AF11
 10

	)

69 
	#SOCKS_IP_TOS_DSCP_AF12
 12

	)

70 
	#SOCKS_IP_TOS_DSCP_AF13
 14

	)

71 
	#SOCKS_IP_TOS_DSCP_AF21
 18

	)

72 
	#SOCKS_IP_TOS_DSCP_AF22
 20

	)

73 
	#SOCKS_IP_TOS_DSCP_AF23
 22

	)

74 
	#SOCKS_IP_TOS_DSCP_AF31
 26

	)

75 
	#SOCKS_IP_TOS_DSCP_AF32
 28

	)

76 
	#SOCKS_IP_TOS_DSCP_AF33
 30

	)

77 
	#SOCKS_IP_TOS_DSCP_AF41
 34

	)

78 
	#SOCKS_IP_TOS_DSCP_AF42
 36

	)

79 
	#SOCKS_IP_TOS_DSCP_AF43
 38

	)

81 
	#SOCKS_IP_TOS_DSCP_CS0
 0

	)

82 
	#SOCKS_IP_TOS_DSCP_CS1
 8

	)

83 
	#SOCKS_IP_TOS_DSCP_CS2
 16

	)

84 
	#SOCKS_IP_TOS_DSCP_CS3
 24

	)

85 
	#SOCKS_IP_TOS_DSCP_CS4
 32

	)

86 
	#SOCKS_IP_TOS_DSCP_CS5
 40

	)

87 
	#SOCKS_IP_TOS_DSCP_CS6
 48

	)

88 
	#SOCKS_IP_TOS_DSCP_CS7
 56

	)

90 
	#SOCKS_IP_TOS_DSCP_EF
 46

	)

94 
	#SOCKS_IP_TOS_DSCP_DEFAULT_SYMNAME
 "deÁu…"

	)

96 
	#SOCKS_IP_TOS_DSCP_AF11_SYMNAME
 "af11"

	)

97 
	#SOCKS_IP_TOS_DSCP_AF12_SYMNAME
 "af12"

	)

98 
	#SOCKS_IP_TOS_DSCP_AF13_SYMNAME
 "af13"

	)

99 
	#SOCKS_IP_TOS_DSCP_AF21_SYMNAME
 "af21"

	)

100 
	#SOCKS_IP_TOS_DSCP_AF22_SYMNAME
 "af22"

	)

101 
	#SOCKS_IP_TOS_DSCP_AF23_SYMNAME
 "af23"

	)

102 
	#SOCKS_IP_TOS_DSCP_AF31_SYMNAME
 "af31"

	)

103 
	#SOCKS_IP_TOS_DSCP_AF32_SYMNAME
 "af32"

	)

104 
	#SOCKS_IP_TOS_DSCP_AF33_SYMNAME
 "af33"

	)

105 
	#SOCKS_IP_TOS_DSCP_AF41_SYMNAME
 "af41"

	)

106 
	#SOCKS_IP_TOS_DSCP_AF42_SYMNAME
 "af42"

	)

107 
	#SOCKS_IP_TOS_DSCP_AF43_SYMNAME
 "af43"

	)

109 
	#SOCKS_IP_TOS_DSCP_CS0_SYMNAME
 "cs0"

	)

110 
	#SOCKS_IP_TOS_DSCP_CS1_SYMNAME
 "cs1"

	)

111 
	#SOCKS_IP_TOS_DSCP_CS2_SYMNAME
 "cs2"

	)

112 
	#SOCKS_IP_TOS_DSCP_CS3_SYMNAME
 "cs3"

	)

113 
	#SOCKS_IP_TOS_DSCP_CS4_SYMNAME
 "cs4"

	)

114 
	#SOCKS_IP_TOS_DSCP_CS5_SYMNAME
 "cs5"

	)

115 
	#SOCKS_IP_TOS_DSCP_CS6_SYMNAME
 "cs6"

	)

116 
	#SOCKS_IP_TOS_DSCP_CS7_SYMNAME
 "cs7"

	)

118 
	#SOCKS_IP_TOS_DSCP_EF_SYMNAME
 "ef"

	)

126 
	#SOCKS_IP_TOS_PREC_NETCONTROL
 0x07

	)

127 
	#SOCKS_IP_TOS_PREC_INTERNETCONTROL
 0x06

	)

128 
	#SOCKS_IP_TOS_PREC_CRITIC_ECP
 0x05

	)

129 
	#SOCKS_IP_TOS_PREC_FLASHOVERRIDE
 0x04

	)

130 
	#SOCKS_IP_TOS_PREC_FLASH
 0x03

	)

131 
	#SOCKS_IP_TOS_PREC_IMMEDIATE
 0x02

	)

132 
	#SOCKS_IP_TOS_PREC_PRIORITY
 0x01

	)

133 
	#SOCKS_IP_TOS_PREC_ROUTINE
 0x00

	)

135 
	#SOCKS_IP_TOS_PREC_NETCONTROL_SYMNAME
 "√tc⁄åﬁ"

	)

136 
	#SOCKS_IP_TOS_PREC_INTERNETCONTROL_SYMNAME
 "öã∫ëc⁄åﬁ"

	)

137 
	#SOCKS_IP_TOS_PREC_CRITIC_ECP_SYMNAME
 "¸ôic_e˝"

	)

138 
	#SOCKS_IP_TOS_PREC_FLASHOVERRIDE_SYMNAME
 "Êashovîride"

	)

139 
	#SOCKS_IP_TOS_PREC_FLASH_SYMNAME
 "Êash"

	)

140 
	#SOCKS_IP_TOS_PREC_IMMEDIATE_SYMNAME
 "immedüã"

	)

141 
	#SOCKS_IP_TOS_PREC_PRIORITY_SYMNAME
 "¥i‹ôy"

	)

142 
	#SOCKS_IP_TOS_PREC_ROUTINE_SYMNAME
 "routöe"

	)

150 
	#SOCKS_IP_TOS_TOS_LOWDELAY
 0x08

	)

151 
	#SOCKS_IP_TOS_TOS_THROUGHPUT
 0x04

	)

152 
	#SOCKS_IP_TOS_TOS_RELIABILITY
 0x02

	)

155 
	#SOCKS_IP_TOS_TOS_LOWDELAY_SYMNAME
 "lowdñay"

	)

156 
	#SOCKS_IP_TOS_TOS_THROUGHPUT_SYMNAME
 "throughput"

	)

157 
	#SOCKS_IP_TOS_TOS_RELIABILITY_SYMNAME
 "ªlübûôy"

	)

	@include/redefac.h

3 #i‚de‡
BAREFOOTD


4 
	#BAREFOOTD
 0

	)

7 #i‚de‡
HAVE_ARPA_NAMESER_H


8 
	#HAVE_ARPA_NAMESER_H
 0

	)

11 #i‚de‡
HAVE_BACKTRACE


12 
	#HAVE_BACKTRACE
 0

	)

15 #i‚de‡
HAVE_BINDRESVPORT


16 
	#HAVE_BINDRESVPORT
 0

	)

19 #i‚de‡
HAVE_BROKEN_INET_NTOA


20 
	#HAVE_BROKEN_INET_NTOA
 0

	)

23 #i‚de‡
HAVE_BSDAUTH


24 
	#HAVE_BSDAUTH
 0

	)

27 #i‚de‡
HAVE_BSD_AUTH_H


28 
	#HAVE_BSD_AUTH_H
 0

	)

31 #i‚de‡
HAVE_BZERO


32 
	#HAVE_BZERO
 0

	)

35 #i‚de‡
HAVE_CLOCK_GETTIME_MONOTONIC


36 
	#HAVE_CLOCK_GETTIME_MONOTONIC
 0

	)

39 #i‚de‡
HAVE_CMSGHDR


40 
	#HAVE_CMSGHDR
 0

	)

43 #i‚de‡
HAVE_CMSG_LEN


44 
	#HAVE_CMSG_LEN
 0

	)

47 #i‚de‡
HAVE_CMSG_SPACE


48 
	#HAVE_CMSG_SPACE
 0

	)

51 #i‚de‡
HAVE_COM_ERR_H


52 
	#HAVE_COM_ERR_H
 0

	)

55 #i‚de‡
HAVE_COM_ERR_IN_KRB5


56 
	#HAVE_COM_ERR_IN_KRB5
 0

	)

59 #i‚de‡
HAVE_COND_LIBWRAP


60 
	#HAVE_COND_LIBWRAP
 0

	)

63 #i‚de‡
HAVE_COND_LIVEDEBUG


64 
	#HAVE_COND_LIVEDEBUG
 0

	)

67 #i‚de‡
HAVE_COND_PAM


68 
	#HAVE_COND_PAM
 0

	)

71 #i‚de‡
HAVE_CONFENV_DISABLE


72 
	#HAVE_CONFENV_DISABLE
 0

	)

75 #i‚de‡
HAVE_CPU_EQUAL


76 
	#HAVE_CPU_EQUAL
 0

	)

79 #i‚de‡
HAVE_CRYPT_H


80 
	#HAVE_CRYPT_H
 0

	)

83 #i‚de‡
HAVE_DAEMON


84 
	#HAVE_DAEMON
 0

	)

87 #i‚de‡
HAVE_DARWIN


88 
	#HAVE_DARWIN
 0

	)

91 #i‚de‡
HAVE_DECL_ATTRIBUTE


92 
	#HAVE_DECL_ATTRIBUTE
 0

	)

95 #i‚de‡
HAVE_DECL_BOUNDED


96 
	#HAVE_DECL_BOUNDED
 0

	)

99 #i‚de‡
HAVE_DECL_FORMAT


100 
	#HAVE_DECL_FORMAT
 0

	)

103 #i‚de‡
HAVE_DECL_KRB5_KT_FREE_ENTRY


104 
	#HAVE_DECL_KRB5_KT_FREE_ENTRY
 0

	)

107 #i‚de‡
HAVE_DECL_NONNULL


108 
	#HAVE_DECL_NONNULL
 0

	)

111 #i‚de‡
HAVE_DEC_PROTO


112 
	#HAVE_DEC_PROTO
 0

	)

115 #i‚de‡
HAVE_DIFFTIME


116 
	#HAVE_DIFFTIME
 0

	)

119 #i‚de‡
HAVE_DLFCN_H


120 
	#HAVE_DLFCN_H
 0

	)

123 #i‚de‡
HAVE_DOPRNT


124 
	#HAVE_DOPRNT
 0

	)

127 #i‚de‡
HAVE_DUPSOCKOPT_MAX


128 
	#HAVE_DUPSOCKOPT_MAX
 0

	)

131 #i‚de‡
HAVE_ENABLED_PIDFILE


132 
	#HAVE_ENABLED_PIDFILE
 0

	)

135 #i‚de‡
HAVE_ERROR_MESSAGE


136 
	#HAVE_ERROR_MESSAGE
 0

	)

139 #i‚de‡
HAVE_ERR_EAI_ADDRFAMILY


140 
	#HAVE_ERR_EAI_ADDRFAMILY
 0

	)

143 #i‚de‡
HAVE_ERR_EAI_AGAIN


144 
	#HAVE_ERR_EAI_AGAIN
 0

	)

147 #i‚de‡
HAVE_ERR_EAI_ALLDONE


148 
	#HAVE_ERR_EAI_ALLDONE
 0

	)

151 #i‚de‡
HAVE_ERR_EAI_BADEXTFLAGS


152 
	#HAVE_ERR_EAI_BADEXTFLAGS
 0

	)

155 #i‚de‡
HAVE_ERR_EAI_BADFLAGS


156 
	#HAVE_ERR_EAI_BADFLAGS
 0

	)

159 #i‚de‡
HAVE_ERR_EAI_BADHINTS


160 
	#HAVE_ERR_EAI_BADHINTS
 0

	)

163 #i‚de‡
HAVE_ERR_EAI_CANCELED


164 
	#HAVE_ERR_EAI_CANCELED
 0

	)

167 #i‚de‡
HAVE_ERR_EAI_FAIL


168 
	#HAVE_ERR_EAI_FAIL
 0

	)

171 #i‚de‡
HAVE_ERR_EAI_FAMILY


172 
	#HAVE_ERR_EAI_FAMILY
 0

	)

175 #i‚de‡
HAVE_ERR_EAI_IDN_ENCODE


176 
	#HAVE_ERR_EAI_IDN_ENCODE
 0

	)

179 #i‚de‡
HAVE_ERR_EAI_INPROGRESS


180 
	#HAVE_ERR_EAI_INPROGRESS
 0

	)

183 #i‚de‡
HAVE_ERR_EAI_INTR


184 
	#HAVE_ERR_EAI_INTR
 0

	)

187 #i‚de‡
HAVE_ERR_EAI_MEMORY


188 
	#HAVE_ERR_EAI_MEMORY
 0

	)

191 #i‚de‡
HAVE_ERR_EAI_NODATA


192 
	#HAVE_ERR_EAI_NODATA
 0

	)

195 #i‚de‡
HAVE_ERR_EAI_NONAME


196 
	#HAVE_ERR_EAI_NONAME
 0

	)

199 #i‚de‡
HAVE_ERR_EAI_NOTCANCELED


200 
	#HAVE_ERR_EAI_NOTCANCELED
 0

	)

203 #i‚de‡
HAVE_ERR_EAI_OVERFLOW


204 
	#HAVE_ERR_EAI_OVERFLOW
 0

	)

207 #i‚de‡
HAVE_ERR_EAI_PROTOCOL


208 
	#HAVE_ERR_EAI_PROTOCOL
 0

	)

211 #i‚de‡
HAVE_ERR_EAI_SERVICE


212 
	#HAVE_ERR_EAI_SERVICE
 0

	)

215 #i‚de‡
HAVE_ERR_EAI_SOCKTYPE


216 
	#HAVE_ERR_EAI_SOCKTYPE
 0

	)

219 #i‚de‡
HAVE_ERR_EAI_SYSTEM


220 
	#HAVE_ERR_EAI_SYSTEM
 0

	)

223 #i‚de‡
HAVE_ET_COM_ERR_H


224 
	#HAVE_ET_COM_ERR_H
 0

	)

227 #i‚de‡
HAVE_EXECINFO_H


228 
	#HAVE_EXECINFO_H
 0

	)

231 #i‚de‡
HAVE_EXTRA_OSF_SYMBOLS


232 
	#HAVE_EXTRA_OSF_SYMBOLS
 0

	)

235 #i‚de‡
HAVE_FCNTL_H


236 
	#HAVE_FCNTL_H
 0

	)

239 #i‚de‡
HAVE_FDMASK


240 
	#HAVE_FDMASK
 0

	)

243 #i‚de‡
HAVE_FREEADDRINFO


244 
	#HAVE_FREEADDRINFO
 0

	)

247 #i‚de‡
HAVE_FREEIFADDRS


248 
	#HAVE_FREEIFADDRS
 0

	)

251 #i‚de‡
HAVE_GETADDRINFO


252 
	#HAVE_GETADDRINFO
 0

	)

255 #i‚de‡
HAVE_GETHOSTBYNAME2


256 
	#HAVE_GETHOSTBYNAME2
 0

	)

259 #i‚de‡
HAVE_GETIFADDRS


260 
	#HAVE_GETIFADDRS
 0

	)

263 #i‚de‡
HAVE_GETIPNODEBYNAME


264 
	#HAVE_GETIPNODEBYNAME
 0

	)

267 #i‚de‡
HAVE_GETNAMEINFO


268 
	#HAVE_GETNAMEINFO
 0

	)

271 #i‚de‡
HAVE_GETPASS


272 
	#HAVE_GETPASS
 0

	)

275 #i‚de‡
HAVE_GETPRPWNAM


276 
	#HAVE_GETPRPWNAM
 0

	)

279 #i‚de‡
HAVE_GETSPNAM


280 
	#HAVE_GETSPNAM
 0

	)

283 #i‚de‡
HAVE_GET_INIT_CREDS_KEYTAB


284 
	#HAVE_GET_INIT_CREDS_KEYTAB
 0

	)

287 #i‚de‡
HAVE_GET_INIT_CREDS_OPT_ALLOC


288 
	#HAVE_GET_INIT_CREDS_OPT_ALLOC
 0

	)

291 #i‚de‡
HAVE_GET_INIT_CREDS_OPT_FREE_CTX


292 
	#HAVE_GET_INIT_CREDS_OPT_FREE_CTX
 0

	)

295 #i‚de‡
HAVE_GSSAPI


296 
	#HAVE_GSSAPI
 0

	)

299 #i‚de‡
HAVE_GSSAPI_GSSAPI_EXT_H


300 
	#HAVE_GSSAPI_GSSAPI_EXT_H
 0

	)

303 #i‚de‡
HAVE_GSSAPI_GSSAPI_GENERIC_H


304 
	#HAVE_GSSAPI_GSSAPI_GENERIC_H
 0

	)

307 #i‚de‡
HAVE_GSSAPI_GSSAPI_H


308 
	#HAVE_GSSAPI_GSSAPI_H
 0

	)

311 #i‚de‡
HAVE_GSSAPI_GSSAPI_KRB5_H


312 
	#HAVE_GSSAPI_GSSAPI_KRB5_H
 0

	)

315 #i‚de‡
HAVE_GSSAPI_H


316 
	#HAVE_GSSAPI_H
 0

	)

319 #i‚de‡
HAVE_HEIMDAL_KERBEROS


320 
	#HAVE_HEIMDAL_KERBEROS
 0

	)

323 #i‚de‡
HAVE_HSTRERROR


324 
	#HAVE_HSTRERROR
 0

	)

327 #i‚de‡
HAVE_IFADDRS_H


328 
	#HAVE_IFADDRS_H
 0

	)

331 #i‚de‡
HAVE_IN6_ADDR


332 
	#HAVE_IN6_ADDR
 0

	)

335 #i‚de‡
HAVE_INET_PTON


336 
	#HAVE_INET_PTON
 0

	)

339 #i‚de‡
HAVE_INT16_T


340 
	#HAVE_INT16_T
 0

	)

343 #i‚de‡
HAVE_INT32_T


344 
	#HAVE_INT32_T
 0

	)

347 #i‚de‡
HAVE_INT8_T


348 
	#HAVE_INT8_T
 0

	)

351 #i‚de‡
HAVE_INTTYPES_H


352 
	#HAVE_INTTYPES_H
 0

	)

355 #i‚de‡
HAVE_IN_ADDR_T


356 
	#HAVE_IN_ADDR_T
 0

	)

359 #i‚de‡
HAVE_IN_PORT_T


360 
	#HAVE_IN_PORT_T
 0

	)

363 #i‚de‡
HAVE_IPV6_2292DSTOPTS


364 
	#HAVE_IPV6_2292DSTOPTS
 0

	)

367 #i‚de‡
HAVE_IPV6_2292HOPLIMIT


368 
	#HAVE_IPV6_2292HOPLIMIT
 0

	)

371 #i‚de‡
HAVE_IPV6_2292HOPOPTS


372 
	#HAVE_IPV6_2292HOPOPTS
 0

	)

375 #i‚de‡
HAVE_IPV6_2292PKTINFO


376 
	#HAVE_IPV6_2292PKTINFO
 0

	)

379 #i‚de‡
HAVE_IPV6_2292PKTOPTIONS


380 
	#HAVE_IPV6_2292PKTOPTIONS
 0

	)

383 #i‚de‡
HAVE_IPV6_2292RTHDR


384 
	#HAVE_IPV6_2292RTHDR
 0

	)

387 #i‚de‡
HAVE_IPV6_ADDRFORM


388 
	#HAVE_IPV6_ADDRFORM
 0

	)

391 #i‚de‡
HAVE_IPV6_ADDR_PREFERENCES


392 
	#HAVE_IPV6_ADDR_PREFERENCES
 0

	)

395 #i‚de‡
HAVE_IPV6_ADD_MEMBERSHIP


396 
	#HAVE_IPV6_ADD_MEMBERSHIP
 0

	)

399 #i‚de‡
HAVE_IPV6_AIXRAWSOCKET


400 
	#HAVE_IPV6_AIXRAWSOCKET
 0

	)

403 #i‚de‡
HAVE_IPV6_AUTHHDR


404 
	#HAVE_IPV6_AUTHHDR
 0

	)

407 #i‚de‡
HAVE_IPV6_AUTH_LEVEL


408 
	#HAVE_IPV6_AUTH_LEVEL
 0

	)

411 #i‚de‡
HAVE_IPV6_AUTOFLOWLABEL


412 
	#HAVE_IPV6_AUTOFLOWLABEL
 0

	)

415 #i‚de‡
HAVE_IPV6_CHECKSUM


416 
	#HAVE_IPV6_CHECKSUM
 0

	)

419 #i‚de‡
HAVE_IPV6_DONTFRAG


420 
	#HAVE_IPV6_DONTFRAG
 0

	)

423 #i‚de‡
HAVE_IPV6_DROP_MEMBERSHIP


424 
	#HAVE_IPV6_DROP_MEMBERSHIP
 0

	)

427 #i‚de‡
HAVE_IPV6_DSTOPTS


428 
	#HAVE_IPV6_DSTOPTS
 0

	)

431 #i‚de‡
HAVE_IPV6_ESP_NETWORK_LEVEL


432 
	#HAVE_IPV6_ESP_NETWORK_LEVEL
 0

	)

435 #i‚de‡
HAVE_IPV6_ESP_TRANS_LEVEL


436 
	#HAVE_IPV6_ESP_TRANS_LEVEL
 0

	)

439 #i‚de‡
HAVE_IPV6_FLOWINFO


440 
	#HAVE_IPV6_FLOWINFO
 0

	)

443 #i‚de‡
HAVE_IPV6_FLOWINFO_SEND


444 
	#HAVE_IPV6_FLOWINFO_SEND
 0

	)

447 #i‚de‡
HAVE_IPV6_FLOWLABEL_MGR


448 
	#HAVE_IPV6_FLOWLABEL_MGR
 0

	)

451 #i‚de‡
HAVE_IPV6_HOPLIMIT


452 
	#HAVE_IPV6_HOPLIMIT
 0

	)

455 #i‚de‡
HAVE_IPV6_HOPOPTS


456 
	#HAVE_IPV6_HOPOPTS
 0

	)

459 #i‚de‡
HAVE_IPV6_IPCOMP_LEVEL


460 
	#HAVE_IPV6_IPCOMP_LEVEL
 0

	)

463 #i‚de‡
HAVE_IPV6_IPSEC_POLICY


464 
	#HAVE_IPV6_IPSEC_POLICY
 0

	)

467 #i‚de‡
HAVE_IPV6_JOIN_ANYCAST


468 
	#HAVE_IPV6_JOIN_ANYCAST
 0

	)

471 #i‚de‡
HAVE_IPV6_JOIN_GROUP


472 
	#HAVE_IPV6_JOIN_GROUP
 0

	)

475 #i‚de‡
HAVE_IPV6_LEAVE_ANYCAST


476 
	#HAVE_IPV6_LEAVE_ANYCAST
 0

	)

479 #i‚de‡
HAVE_IPV6_LEAVE_GROUP


480 
	#HAVE_IPV6_LEAVE_GROUP
 0

	)

483 #i‚de‡
HAVE_IPV6_MINHOPCOUNT


484 
	#HAVE_IPV6_MINHOPCOUNT
 0

	)

487 #i‚de‡
HAVE_IPV6_MIPDSTOPTS


488 
	#HAVE_IPV6_MIPDSTOPTS
 0

	)

491 #i‚de‡
HAVE_IPV6_MTU


492 
	#HAVE_IPV6_MTU
 0

	)

495 #i‚de‡
HAVE_IPV6_MTU_DISCOVER


496 
	#HAVE_IPV6_MTU_DISCOVER
 0

	)

499 #i‚de‡
HAVE_IPV6_MULTICAST_HOPS


500 
	#HAVE_IPV6_MULTICAST_HOPS
 0

	)

503 #i‚de‡
HAVE_IPV6_MULTICAST_IF


504 
	#HAVE_IPV6_MULTICAST_IF
 0

	)

507 #i‚de‡
HAVE_IPV6_MULTICAST_LOOP


508 
	#HAVE_IPV6_MULTICAST_LOOP
 0

	)

511 #i‚de‡
HAVE_IPV6_NEXTHOP


512 
	#HAVE_IPV6_NEXTHOP
 0

	)

515 #i‚de‡
HAVE_IPV6_NOPROBE


516 
	#HAVE_IPV6_NOPROBE
 0

	)

519 #i‚de‡
HAVE_IPV6_ORIGDSTADDR


520 
	#HAVE_IPV6_ORIGDSTADDR
 0

	)

523 #i‚de‡
HAVE_IPV6_PATHMTU


524 
	#HAVE_IPV6_PATHMTU
 0

	)

527 #i‚de‡
HAVE_IPV6_PIPEX


528 
	#HAVE_IPV6_PIPEX
 0

	)

531 #i‚de‡
HAVE_IPV6_PKTINFO


532 
	#HAVE_IPV6_PKTINFO
 0

	)

535 #i‚de‡
HAVE_IPV6_PKTOPTIONS


536 
	#HAVE_IPV6_PKTOPTIONS
 0

	)

539 #i‚de‡
HAVE_IPV6_PORTRANGE


540 
	#HAVE_IPV6_PORTRANGE
 0

	)

543 #i‚de‡
HAVE_IPV6_RECVDSTADDR


544 
	#HAVE_IPV6_RECVDSTADDR
 0

	)

547 #i‚de‡
HAVE_IPV6_RECVDSTOPTS


548 
	#HAVE_IPV6_RECVDSTOPTS
 0

	)

551 #i‚de‡
HAVE_IPV6_RECVERR


552 
	#HAVE_IPV6_RECVERR
 0

	)

555 #i‚de‡
HAVE_IPV6_RECVHOPLIMIT


556 
	#HAVE_IPV6_RECVHOPLIMIT
 0

	)

559 #i‚de‡
HAVE_IPV6_RECVHOPOPTS


560 
	#HAVE_IPV6_RECVHOPOPTS
 0

	)

563 #i‚de‡
HAVE_IPV6_RECVHOPS


564 
	#HAVE_IPV6_RECVHOPS
 0

	)

567 #i‚de‡
HAVE_IPV6_RECVIF


568 
	#HAVE_IPV6_RECVIF
 0

	)

571 #i‚de‡
HAVE_IPV6_RECVOPTS


572 
	#HAVE_IPV6_RECVOPTS
 0

	)

575 #i‚de‡
HAVE_IPV6_RECVORIGDSTADDR


576 
	#HAVE_IPV6_RECVORIGDSTADDR
 0

	)

579 #i‚de‡
HAVE_IPV6_RECVPATHMTU


580 
	#HAVE_IPV6_RECVPATHMTU
 0

	)

583 #i‚de‡
HAVE_IPV6_RECVPKTINFO


584 
	#HAVE_IPV6_RECVPKTINFO
 0

	)

587 #i‚de‡
HAVE_IPV6_RECVRETOPTS


588 
	#HAVE_IPV6_RECVRETOPTS
 0

	)

591 #i‚de‡
HAVE_IPV6_RECVRTHDR


592 
	#HAVE_IPV6_RECVRTHDR
 0

	)

595 #i‚de‡
HAVE_IPV6_RECVSRCRT


596 
	#HAVE_IPV6_RECVSRCRT
 0

	)

599 #i‚de‡
HAVE_IPV6_RECVTCLASS


600 
	#HAVE_IPV6_RECVTCLASS
 0

	)

603 #i‚de‡
HAVE_IPV6_RETOPTS


604 
	#HAVE_IPV6_RETOPTS
 0

	)

607 #i‚de‡
HAVE_IPV6_ROUTER_ALERT


608 
	#HAVE_IPV6_ROUTER_ALERT
 0

	)

611 #i‚de‡
HAVE_IPV6_RTHDR


612 
	#HAVE_IPV6_RTHDR
 0

	)

615 #i‚de‡
HAVE_IPV6_RTHDRDSTOPTS


616 
	#HAVE_IPV6_RTHDRDSTOPTS
 0

	)

619 #i‚de‡
HAVE_IPV6_SENDIF


620 
	#HAVE_IPV6_SENDIF
 0

	)

623 #i‚de‡
HAVE_IPV6_TCLASS


624 
	#HAVE_IPV6_TCLASS
 0

	)

627 #i‚de‡
HAVE_IPV6_TRANSPARENT


628 
	#HAVE_IPV6_TRANSPARENT
 0

	)

631 #i‚de‡
HAVE_IPV6_UNICAST_HOPS


632 
	#HAVE_IPV6_UNICAST_HOPS
 0

	)

635 #i‚de‡
HAVE_IPV6_USE_MIN_MTU


636 
	#HAVE_IPV6_USE_MIN_MTU
 0

	)

639 #i‚de‡
HAVE_IPV6_V6ONLY


640 
	#HAVE_IPV6_V6ONLY
 0

	)

643 #i‚de‡
HAVE_IPV6_XFRM_POLICY


644 
	#HAVE_IPV6_XFRM_POLICY
 0

	)

647 #i‚de‡
HAVE_IP_ADDRFORM


648 
	#HAVE_IP_ADDRFORM
 0

	)

651 #i‚de‡
HAVE_IP_ADD_MEMBERSHIP


652 
	#HAVE_IP_ADD_MEMBERSHIP
 0

	)

655 #i‚de‡
HAVE_IP_ADD_SOURCE_MEMBERSHIP


656 
	#HAVE_IP_ADD_SOURCE_MEMBERSHIP
 0

	)

659 #i‚de‡
HAVE_IP_AUTH_LEVEL


660 
	#HAVE_IP_AUTH_LEVEL
 0

	)

663 #i‚de‡
HAVE_IP_BLOCK_SOURCE


664 
	#HAVE_IP_BLOCK_SOURCE
 0

	)

667 #i‚de‡
HAVE_IP_BROADCAST_IF


668 
	#HAVE_IP_BROADCAST_IF
 0

	)

671 #i‚de‡
HAVE_IP_DHCPMODE


672 
	#HAVE_IP_DHCPMODE
 0

	)

675 #i‚de‡
HAVE_IP_DONTFRAG


676 
	#HAVE_IP_DONTFRAG
 0

	)

679 #i‚de‡
HAVE_IP_DROP_MEMBERSHIP


680 
	#HAVE_IP_DROP_MEMBERSHIP
 0

	)

683 #i‚de‡
HAVE_IP_DROP_SOURCE_MEMBERSHIP


684 
	#HAVE_IP_DROP_SOURCE_MEMBERSHIP
 0

	)

687 #i‚de‡
HAVE_IP_ESP_NETWORK_LEVEL


688 
	#HAVE_IP_ESP_NETWORK_LEVEL
 0

	)

691 #i‚de‡
HAVE_IP_ESP_TRANS_LEVEL


692 
	#HAVE_IP_ESP_TRANS_LEVEL
 0

	)

695 #i‚de‡
HAVE_IP_FINDPMTU


696 
	#HAVE_IP_FINDPMTU
 0

	)

699 #i‚de‡
HAVE_IP_FREEBIND


700 
	#HAVE_IP_FREEBIND
 0

	)

703 #i‚de‡
HAVE_IP_HDRINCL


704 
	#HAVE_IP_HDRINCL
 0

	)

707 #i‚de‡
HAVE_IP_IPCOMP_LEVEL


708 
	#HAVE_IP_IPCOMP_LEVEL
 0

	)

711 #i‚de‡
HAVE_IP_MINTTL


712 
	#HAVE_IP_MINTTL
 0

	)

715 #i‚de‡
HAVE_IP_MTU_DISCOVER


716 
	#HAVE_IP_MTU_DISCOVER
 0

	)

719 #i‚de‡
HAVE_IP_MULTICAST_HOPS


720 
	#HAVE_IP_MULTICAST_HOPS
 0

	)

723 #i‚de‡
HAVE_IP_MULTICAST_IF


724 
	#HAVE_IP_MULTICAST_IF
 0

	)

727 #i‚de‡
HAVE_IP_MULTICAST_LOOP


728 
	#HAVE_IP_MULTICAST_LOOP
 0

	)

731 #i‚de‡
HAVE_IP_MULTICAST_TTL


732 
	#HAVE_IP_MULTICAST_TTL
 0

	)

735 #i‚de‡
HAVE_IP_OPTIONS


736 
	#HAVE_IP_OPTIONS
 0

	)

739 #i‚de‡
HAVE_IP_PMTUAGE


740 
	#HAVE_IP_PMTUAGE
 0

	)

743 #i‚de‡
HAVE_IP_PORTRANGE


744 
	#HAVE_IP_PORTRANGE
 0

	)

747 #i‚de‡
HAVE_IP_RECVDSTADDR


748 
	#HAVE_IP_RECVDSTADDR
 0

	)

751 #i‚de‡
HAVE_IP_RECVIF


752 
	#HAVE_IP_RECVIF
 0

	)

755 #i‚de‡
HAVE_IP_RECVIFINFO


756 
	#HAVE_IP_RECVIFINFO
 0

	)

759 #i‚de‡
HAVE_IP_RECVINTERFACE


760 
	#HAVE_IP_RECVINTERFACE
 0

	)

763 #i‚de‡
HAVE_IP_RECVMACHDR


764 
	#HAVE_IP_RECVMACHDR
 0

	)

767 #i‚de‡
HAVE_IP_RECVTOS


768 
	#HAVE_IP_RECVTOS
 0

	)

771 #i‚de‡
HAVE_IP_RECVTTL


772 
	#HAVE_IP_RECVTTL
 0

	)

775 #i‚de‡
HAVE_IP_SOURCE_FILTER


776 
	#HAVE_IP_SOURCE_FILTER
 0

	)

779 #i‚de‡
HAVE_IP_TOS


780 
	#HAVE_IP_TOS
 0

	)

783 #i‚de‡
HAVE_IP_TTL


784 
	#HAVE_IP_TTL
 0

	)

787 #i‚de‡
HAVE_IP_UNBLOCK_SOURCE


788 
	#HAVE_IP_UNBLOCK_SOURCE
 0

	)

791 #i‚de‡
HAVE_IP_UNICAST_HOPS


792 
	#HAVE_IP_UNICAST_HOPS
 0

	)

795 #i‚de‡
HAVE_ISSETUGID


796 
	#HAVE_ISSETUGID
 0

	)

799 #i‚de‡
HAVE_KRB5


800 
	#HAVE_KRB5
 0

	)

803 #i‚de‡
HAVE_KRB5_GET_ERROR_MESSAGE


804 
	#HAVE_KRB5_GET_ERROR_MESSAGE
 0

	)

807 #i‚de‡
HAVE_KRB5_GET_ERR_TEXT


808 
	#HAVE_KRB5_GET_ERR_TEXT
 0

	)

811 #i‚de‡
HAVE_KRB5_H


812 
	#HAVE_KRB5_H
 0

	)

815 #i‚de‡
HAVE_KRB5_KT_FREE_ENTRY


816 
	#HAVE_KRB5_KT_FREE_ENTRY
 0

	)

819 #i‚de‡
HAVE_KRB5_MEMORY_CACHE


820 
	#HAVE_KRB5_MEMORY_CACHE
 0

	)

823 #i‚de‡
HAVE_LBER_H


824 
	#HAVE_LBER_H
 0

	)

827 #i‚de‡
HAVE_LDAP


828 
	#HAVE_LDAP
 0

	)

831 #i‚de‡
HAVE_LDAPSSL_CLIENT_INIT


832 
	#HAVE_LDAPSSL_CLIENT_INIT
 0

	)

835 #i‚de‡
HAVE_LDAP_H


836 
	#HAVE_LDAP_H
 0

	)

839 #i‚de‡
HAVE_LDAP_REBINDPROC_CALLBACK


840 
	#HAVE_LDAP_REBINDPROC_CALLBACK
 0

	)

843 #i‚de‡
HAVE_LDAP_REBIND_FUNCTION


844 
	#HAVE_LDAP_REBIND_FUNCTION
 0

	)

847 #i‚de‡
HAVE_LDAP_REBIND_PROC


848 
	#HAVE_LDAP_REBIND_PROC
 0

	)

851 #i‚de‡
HAVE_LDAP_SCOPE_DEFAULT


852 
	#HAVE_LDAP_SCOPE_DEFAULT
 0

	)

855 #i‚de‡
HAVE_LDAP_URL_DESC2STR


856 
	#HAVE_LDAP_URL_DESC2STR
 0

	)

859 #i‚de‡
HAVE_LDAP_URL_LUD_SCHEME


860 
	#HAVE_LDAP_URL_LUD_SCHEME
 0

	)

863 #i‚de‡
HAVE_LDAP_URL_PARSE


864 
	#HAVE_LDAP_URL_PARSE
 0

	)

867 #i‚de‡
HAVE_LIBASN1


868 
	#HAVE_LIBASN1
 0

	)

871 #i‚de‡
HAVE_LIBCFAIL


872 
	#HAVE_LIBCFAIL
 0

	)

875 #i‚de‡
HAVE_LIBCOM_ERR


876 
	#HAVE_LIBCOM_ERR
 0

	)

879 #i‚de‡
HAVE_LIBCRYPT


880 
	#HAVE_LIBCRYPT
 0

	)

883 #i‚de‡
HAVE_LIBC_ENABLE_SECURE


884 
	#HAVE_LIBC_ENABLE_SECURE
 0

	)

887 #i‚de‡
HAVE_LIBC_ENABLE_SECURE_DISABLED


888 
	#HAVE_LIBC_ENABLE_SECURE_DISABLED
 0

	)

891 #i‚de‡
HAVE_LIBDES


892 
	#HAVE_LIBDES
 0

	)

895 #i‚de‡
HAVE_LIBDES425


896 
	#HAVE_LIBDES425
 0

	)

899 #i‚de‡
HAVE_LIBGSS


900 
	#HAVE_LIBGSS
 0

	)

903 #i‚de‡
HAVE_LIBGSSAPI


904 
	#HAVE_LIBGSSAPI
 0

	)

907 #i‚de‡
HAVE_LIBGSSAPI_KRB5


908 
	#HAVE_LIBGSSAPI_KRB5
 0

	)

911 #i‚de‡
HAVE_LIBK5CRYPTO


912 
	#HAVE_LIBK5CRYPTO
 0

	)

915 #i‚de‡
HAVE_LIBKRB5


916 
	#HAVE_LIBKRB5
 0

	)

919 #i‚de‡
HAVE_LIBKSVC


920 
	#HAVE_LIBKSVC
 0

	)

923 #i‚de‡
HAVE_LIBLBER


924 
	#HAVE_LIBLBER
 0

	)

927 #i‚de‡
HAVE_LIBLDAP


928 
	#HAVE_LIBLDAP
 0

	)

931 #i‚de‡
HAVE_LIBLDAP60


932 
	#HAVE_LIBLDAP60
 0

	)

935 #i‚de‡
HAVE_LIBMINIUPNP


936 
	#HAVE_LIBMINIUPNP
 0

	)

939 #i‚de‡
HAVE_LIBMINIUPNP13


940 
	#HAVE_LIBMINIUPNP13
 0

	)

943 #i‚de‡
HAVE_LIBMINIUPNP14


944 
	#HAVE_LIBMINIUPNP14
 0

	)

947 #i‚de‡
HAVE_LIBMINIUPNP17


948 
	#HAVE_LIBMINIUPNP17
 0

	)

951 #i‚de‡
HAVE_LIBPRLDAP60


952 
	#HAVE_LIBPRLDAP60
 0

	)

955 #i‚de‡
HAVE_LIBPTHREAD


956 
	#HAVE_LIBPTHREAD
 0

	)

959 #i‚de‡
HAVE_LIBRESOLV


960 
	#HAVE_LIBRESOLV
 0

	)

963 #i‚de‡
HAVE_LIBROKEN


964 
	#HAVE_LIBROKEN
 0

	)

967 #i‚de‡
HAVE_LIBSASL2


968 
	#HAVE_LIBSASL2
 0

	)

971 #i‚de‡
HAVE_LIBSSLDAP60


972 
	#HAVE_LIBSSLDAP60
 0

	)

975 #i‚de‡
HAVE_LIMITS_H


976 
	#HAVE_LIMITS_H
 0

	)

979 #i‚de‡
HAVE_LINUX_BUGS


980 
	#HAVE_LINUX_BUGS
 0

	)

983 #i‚de‡
HAVE_LINUX_GLIBC_WORKAROUND


984 
	#HAVE_LINUX_GLIBC_WORKAROUND
 0

	)

987 #i‚de‡
HAVE_MALLOC_H


988 
	#HAVE_MALLOC_H
 0

	)

991 #i‚de‡
HAVE_MALLOC_OPTIONS


992 
	#HAVE_MALLOC_OPTIONS
 0

	)

995 #i‚de‡
HAVE_MAX_HOSTIDS


996 
	#HAVE_MAX_HOSTIDS
 0

	)

999 #i‚de‡
HAVE_MEMMOVE


1000 
	#HAVE_MEMMOVE
 0

	)

1003 #i‚de‡
HAVE_MEMORY_H


1004 
	#HAVE_MEMORY_H
 0

	)

1007 #i‚de‡
HAVE_MODULE_BANDWIDTH


1008 
	#HAVE_MODULE_BANDWIDTH
 0

	)

1011 #i‚de‡
HAVE_MODULE_CHECKMODULE


1012 
	#HAVE_MODULE_CHECKMODULE
 0

	)

1015 #i‚de‡
HAVE_MODULE_LDAP


1016 
	#HAVE_MODULE_LDAP
 0

	)

1019 #i‚de‡
HAVE_MODULE_REDIRECT


1020 
	#HAVE_MODULE_REDIRECT
 0

	)

1023 #i‚de‡
HAVE_MONCONTROL


1024 
	#HAVE_MONCONTROL
 0

	)

1027 #i‚de‡
HAVE_MOZILLA_LDAP_SDK


1028 
	#HAVE_MOZILLA_LDAP_SDK
 0

	)

1031 #i‚de‡
HAVE_MOZLDAP_LDAP_H


1032 
	#HAVE_MOZLDAP_LDAP_H
 0

	)

1035 #i‚de‡
HAVE_MSG_WAITALL


1036 
	#HAVE_MSG_WAITALL
 0

	)

1039 #i‚de‡
HAVE_NETINET_IN_H


1040 
	#HAVE_NETINET_IN_H
 0

	)

1043 #i‚de‡
HAVE_NETINET_IP_H


1044 
	#HAVE_NETINET_IP_H
 0

	)

1047 #i‚de‡
HAVE_NETINET_IP_VAR_H


1048 
	#HAVE_NETINET_IP_VAR_H
 0

	)

1051 #i‚de‡
HAVE_NETINET_TCP_FSM_H


1052 
	#HAVE_NETINET_TCP_FSM_H
 0

	)

1055 #i‚de‡
HAVE_NET_IF_DL_H


1056 
	#HAVE_NET_IF_DL_H
 0

	)

1059 #i‚de‡
HAVE_NOMALLOC_REALLOC


1060 
	#HAVE_NOMALLOC_REALLOC
 0

	)

1063 #i‚de‡
HAVE_NONULL_FREE


1064 
	#HAVE_NONULL_FREE
 0

	)

1067 #i‚de‡
HAVE_NO_RESOLVESTUFF


1068 
	#HAVE_NO_RESOLVESTUFF
 0

	)

1071 #i‚de‡
HAVE_NO_SYMBOL_UNDERSCORE


1072 
	#HAVE_NO_SYMBOL_UNDERSCORE
 0

	)

1075 #i‚de‡
HAVE_OPENBSD_BUGS


1076 
	#HAVE_OPENBSD_BUGS
 0

	)

1079 #i‚de‡
HAVE_OPENLDAP


1080 
	#HAVE_OPENLDAP
 0

	)

1083 #i‚de‡
HAVE_OPENLOG_LOG_PERROR


1084 
	#HAVE_OPENLOG_LOG_PERROR
 0

	)

1087 #i‚de‡
HAVE_PATHS_H


1088 
	#HAVE_PATHS_H
 0

	)

1091 #i‚de‡
HAVE_PIPEBUFFER_RECV_BASED


1092 
	#HAVE_PIPEBUFFER_RECV_BASED
 0

	)

1095 #i‚de‡
HAVE_PIPEBUFFER_SEND_BASED


1096 
	#HAVE_PIPEBUFFER_SEND_BASED
 0

	)

1099 #i‚de‡
HAVE_PIPEBUFFER_UNKNOWN


1100 
	#HAVE_PIPEBUFFER_UNKNOWN
 0

	)

1103 #i‚de‡
HAVE_PRAGMA_SUPPORT


1104 
	#HAVE_PRAGMA_SUPPORT
 0

	)

1107 #i‚de‡
HAVE_PRIVILEGES


1108 
	#HAVE_PRIVILEGES
 0

	)

1111 #i‚de‡
HAVE_PRIV_H


1112 
	#HAVE_PRIV_H
 0

	)

1115 #i‚de‡
HAVE_PROCESSOR_BIND


1116 
	#HAVE_PROCESSOR_BIND
 0

	)

1119 #i‚de‡
HAVE_PROFILING


1120 
	#HAVE_PROFILING
 0

	)

1123 #i‚de‡
HAVE_PROGNAME


1124 
	#HAVE_PROGNAME
 0

	)

1127 #i‚de‡
HAVE_PROT_ACCEPT_0


1128 
	#HAVE_PROT_ACCEPT_0
 0

	)

1131 #i‚de‡
HAVE_PROT_ACCEPT_1


1132 
	#HAVE_PROT_ACCEPT_1
 0

	)

1135 #i‚de‡
HAVE_PROT_ACCEPT_2


1136 
	#HAVE_PROT_ACCEPT_2
 0

	)

1139 #i‚de‡
HAVE_PROT_ACCEPT_3


1140 
	#HAVE_PROT_ACCEPT_3
 0

	)

1143 #i‚de‡
HAVE_PROT_BIND_0


1144 
	#HAVE_PROT_BIND_0
 0

	)

1147 #i‚de‡
HAVE_PROT_BIND_1


1148 
	#HAVE_PROT_BIND_1
 0

	)

1151 #i‚de‡
HAVE_PROT_BIND_2


1152 
	#HAVE_PROT_BIND_2
 0

	)

1155 #i‚de‡
HAVE_PROT_BIND_3


1156 
	#HAVE_PROT_BIND_3
 0

	)

1159 #i‚de‡
HAVE_PROT_CONNECT_0


1160 
	#HAVE_PROT_CONNECT_0
 0

	)

1163 #i‚de‡
HAVE_PROT_CONNECT_1


1164 
	#HAVE_PROT_CONNECT_1
 0

	)

1167 #i‚de‡
HAVE_PROT_CONNECT_2


1168 
	#HAVE_PROT_CONNECT_2
 0

	)

1171 #i‚de‡
HAVE_PROT_CONNECT_3


1172 
	#HAVE_PROT_CONNECT_3
 0

	)

1175 #i‚de‡
HAVE_PROT_FCLOSE_0


1176 
	#HAVE_PROT_FCLOSE_0
 0

	)

1179 #i‚de‡
HAVE_PROT_FCLOSE_1


1180 
	#HAVE_PROT_FCLOSE_1
 0

	)

1183 #i‚de‡
HAVE_PROT_FFLUSH_0


1184 
	#HAVE_PROT_FFLUSH_0
 0

	)

1187 #i‚de‡
HAVE_PROT_FFLUSH_1


1188 
	#HAVE_PROT_FFLUSH_1
 0

	)

1191 #i‚de‡
HAVE_PROT_FGETC_0


1192 
	#HAVE_PROT_FGETC_0
 0

	)

1195 #i‚de‡
HAVE_PROT_FGETC_1


1196 
	#HAVE_PROT_FGETC_1
 0

	)

1199 #i‚de‡
HAVE_PROT_FGETS_0


1200 
	#HAVE_PROT_FGETS_0
 0

	)

1203 #i‚de‡
HAVE_PROT_FGETS_1


1204 
	#HAVE_PROT_FGETS_1
 0

	)

1207 #i‚de‡
HAVE_PROT_FGETS_2


1208 
	#HAVE_PROT_FGETS_2
 0

	)

1211 #i‚de‡
HAVE_PROT_FGETS_3


1212 
	#HAVE_PROT_FGETS_3
 0

	)

1215 #i‚de‡
HAVE_PROT_FPRINTF_0


1216 
	#HAVE_PROT_FPRINTF_0
 0

	)

1219 #i‚de‡
HAVE_PROT_FPRINTF_1


1220 
	#HAVE_PROT_FPRINTF_1
 0

	)

1223 #i‚de‡
HAVE_PROT_FPRINTF_2


1224 
	#HAVE_PROT_FPRINTF_2
 0

	)

1227 #i‚de‡
HAVE_PROT_FPRINTF_3


1228 
	#HAVE_PROT_FPRINTF_3
 0

	)

1231 #i‚de‡
HAVE_PROT_FPUTC_0


1232 
	#HAVE_PROT_FPUTC_0
 0

	)

1235 #i‚de‡
HAVE_PROT_FPUTC_1


1236 
	#HAVE_PROT_FPUTC_1
 0

	)

1239 #i‚de‡
HAVE_PROT_FPUTC_2


1240 
	#HAVE_PROT_FPUTC_2
 0

	)

1243 #i‚de‡
HAVE_PROT_FPUTS_0


1244 
	#HAVE_PROT_FPUTS_0
 0

	)

1247 #i‚de‡
HAVE_PROT_FPUTS_1


1248 
	#HAVE_PROT_FPUTS_1
 0

	)

1251 #i‚de‡
HAVE_PROT_FPUTS_2


1252 
	#HAVE_PROT_FPUTS_2
 0

	)

1255 #i‚de‡
HAVE_PROT_FREAD_0


1256 
	#HAVE_PROT_FREAD_0
 0

	)

1259 #i‚de‡
HAVE_PROT_FREAD_1


1260 
	#HAVE_PROT_FREAD_1
 0

	)

1263 #i‚de‡
HAVE_PROT_FREAD_2


1264 
	#HAVE_PROT_FREAD_2
 0

	)

1267 #i‚de‡
HAVE_PROT_FREAD_3


1268 
	#HAVE_PROT_FREAD_3
 0

	)

1271 #i‚de‡
HAVE_PROT_FREAD_4


1272 
	#HAVE_PROT_FREAD_4
 0

	)

1275 #i‚de‡
HAVE_PROT_FWRITE_0


1276 
	#HAVE_PROT_FWRITE_0
 0

	)

1279 #i‚de‡
HAVE_PROT_FWRITE_1


1280 
	#HAVE_PROT_FWRITE_1
 0

	)

1283 #i‚de‡
HAVE_PROT_FWRITE_2


1284 
	#HAVE_PROT_FWRITE_2
 0

	)

1287 #i‚de‡
HAVE_PROT_FWRITE_3


1288 
	#HAVE_PROT_FWRITE_3
 0

	)

1291 #i‚de‡
HAVE_PROT_FWRITE_4


1292 
	#HAVE_PROT_FWRITE_4
 0

	)

1295 #i‚de‡
HAVE_PROT_GETC_0


1296 
	#HAVE_PROT_GETC_0
 0

	)

1299 #i‚de‡
HAVE_PROT_GETC_1


1300 
	#HAVE_PROT_GETC_1
 0

	)

1303 #i‚de‡
HAVE_PROT_GETHOSTBYADDR_0


1304 
	#HAVE_PROT_GETHOSTBYADDR_0
 0

	)

1307 #i‚de‡
HAVE_PROT_GETHOSTBYADDR_1


1308 
	#HAVE_PROT_GETHOSTBYADDR_1
 0

	)

1311 #i‚de‡
HAVE_PROT_GETHOSTBYADDR_2


1312 
	#HAVE_PROT_GETHOSTBYADDR_2
 0

	)

1315 #i‚de‡
HAVE_PROT_GETHOSTBYADDR_3


1316 
	#HAVE_PROT_GETHOSTBYADDR_3
 0

	)

1319 #i‚de‡
HAVE_PROT_GETNAMEINFO_0


1320 
	#HAVE_PROT_GETNAMEINFO_0
 0

	)

1323 #i‚de‡
HAVE_PROT_GETNAMEINFO_1


1324 
	#HAVE_PROT_GETNAMEINFO_1
 0

	)

1327 #i‚de‡
HAVE_PROT_GETNAMEINFO_2


1328 
	#HAVE_PROT_GETNAMEINFO_2
 0

	)

1331 #i‚de‡
HAVE_PROT_GETNAMEINFO_3


1332 
	#HAVE_PROT_GETNAMEINFO_3
 0

	)

1335 #i‚de‡
HAVE_PROT_GETNAMEINFO_4


1336 
	#HAVE_PROT_GETNAMEINFO_4
 0

	)

1339 #i‚de‡
HAVE_PROT_GETNAMEINFO_5


1340 
	#HAVE_PROT_GETNAMEINFO_5
 0

	)

1343 #i‚de‡
HAVE_PROT_GETNAMEINFO_6


1344 
	#HAVE_PROT_GETNAMEINFO_6
 0

	)

1347 #i‚de‡
HAVE_PROT_GETNAMEINFO_7


1348 
	#HAVE_PROT_GETNAMEINFO_7
 0

	)

1351 #i‚de‡
HAVE_PROT_GETPEERNAME_0


1352 
	#HAVE_PROT_GETPEERNAME_0
 0

	)

1355 #i‚de‡
HAVE_PROT_GETPEERNAME_1


1356 
	#HAVE_PROT_GETPEERNAME_1
 0

	)

1359 #i‚de‡
HAVE_PROT_GETPEERNAME_2


1360 
	#HAVE_PROT_GETPEERNAME_2
 0

	)

1363 #i‚de‡
HAVE_PROT_GETPEERNAME_3


1364 
	#HAVE_PROT_GETPEERNAME_3
 0

	)

1367 #i‚de‡
HAVE_PROT_GETSOCKNAME_0


1368 
	#HAVE_PROT_GETSOCKNAME_0
 0

	)

1371 #i‚de‡
HAVE_PROT_GETSOCKNAME_1


1372 
	#HAVE_PROT_GETSOCKNAME_1
 0

	)

1375 #i‚de‡
HAVE_PROT_GETSOCKNAME_2


1376 
	#HAVE_PROT_GETSOCKNAME_2
 0

	)

1379 #i‚de‡
HAVE_PROT_GETSOCKNAME_3


1380 
	#HAVE_PROT_GETSOCKNAME_3
 0

	)

1383 #i‚de‡
HAVE_PROT_GETSOCKOPT_0


1384 
	#HAVE_PROT_GETSOCKOPT_0
 0

	)

1387 #i‚de‡
HAVE_PROT_GETSOCKOPT_1


1388 
	#HAVE_PROT_GETSOCKOPT_1
 0

	)

1391 #i‚de‡
HAVE_PROT_GETSOCKOPT_2


1392 
	#HAVE_PROT_GETSOCKOPT_2
 0

	)

1395 #i‚de‡
HAVE_PROT_GETSOCKOPT_3


1396 
	#HAVE_PROT_GETSOCKOPT_3
 0

	)

1399 #i‚de‡
HAVE_PROT_GETSOCKOPT_4


1400 
	#HAVE_PROT_GETSOCKOPT_4
 0

	)

1403 #i‚de‡
HAVE_PROT_GETSOCKOPT_5


1404 
	#HAVE_PROT_GETSOCKOPT_5
 0

	)

1407 #i‚de‡
HAVE_PROT_GETS_0


1408 
	#HAVE_PROT_GETS_0
 0

	)

1411 #i‚de‡
HAVE_PROT_GETS_1


1412 
	#HAVE_PROT_GETS_1
 0

	)

1415 #i‚de‡
HAVE_PROT_LISTEN_0


1416 
	#HAVE_PROT_LISTEN_0
 0

	)

1419 #i‚de‡
HAVE_PROT_LISTEN_1


1420 
	#HAVE_PROT_LISTEN_1
 0

	)

1423 #i‚de‡
HAVE_PROT_LISTEN_2


1424 
	#HAVE_PROT_LISTEN_2
 0

	)

1427 #i‚de‡
HAVE_PROT_PRINTF_0


1428 
	#HAVE_PROT_PRINTF_0
 0

	)

1431 #i‚de‡
HAVE_PROT_PRINTF_1


1432 
	#HAVE_PROT_PRINTF_1
 0

	)

1435 #i‚de‡
HAVE_PROT_PRINTF_2


1436 
	#HAVE_PROT_PRINTF_2
 0

	)

1439 #i‚de‡
HAVE_PROT_PUTC_0


1440 
	#HAVE_PROT_PUTC_0
 0

	)

1443 #i‚de‡
HAVE_PROT_PUTC_1


1444 
	#HAVE_PROT_PUTC_1
 0

	)

1447 #i‚de‡
HAVE_PROT_PUTC_2


1448 
	#HAVE_PROT_PUTC_2
 0

	)

1451 #i‚de‡
HAVE_PROT_PUTS_0


1452 
	#HAVE_PROT_PUTS_0
 0

	)

1455 #i‚de‡
HAVE_PROT_PUTS_1


1456 
	#HAVE_PROT_PUTS_1
 0

	)

1459 #i‚de‡
HAVE_PROT_READV_0


1460 
	#HAVE_PROT_READV_0
 0

	)

1463 #i‚de‡
HAVE_PROT_READV_1


1464 
	#HAVE_PROT_READV_1
 0

	)

1467 #i‚de‡
HAVE_PROT_READV_2


1468 
	#HAVE_PROT_READV_2
 0

	)

1471 #i‚de‡
HAVE_PROT_READV_3


1472 
	#HAVE_PROT_READV_3
 0

	)

1475 #i‚de‡
HAVE_PROT_READ_0


1476 
	#HAVE_PROT_READ_0
 0

	)

1479 #i‚de‡
HAVE_PROT_READ_1


1480 
	#HAVE_PROT_READ_1
 0

	)

1483 #i‚de‡
HAVE_PROT_READ_2


1484 
	#HAVE_PROT_READ_2
 0

	)

1487 #i‚de‡
HAVE_PROT_READ_3


1488 
	#HAVE_PROT_READ_3
 0

	)

1491 #i‚de‡
HAVE_PROT_RECVFROM_0


1492 
	#HAVE_PROT_RECVFROM_0
 0

	)

1495 #i‚de‡
HAVE_PROT_RECVFROM_1


1496 
	#HAVE_PROT_RECVFROM_1
 0

	)

1499 #i‚de‡
HAVE_PROT_RECVFROM_2


1500 
	#HAVE_PROT_RECVFROM_2
 0

	)

1503 #i‚de‡
HAVE_PROT_RECVFROM_3


1504 
	#HAVE_PROT_RECVFROM_3
 0

	)

1507 #i‚de‡
HAVE_PROT_RECVFROM_4


1508 
	#HAVE_PROT_RECVFROM_4
 0

	)

1511 #i‚de‡
HAVE_PROT_RECVFROM_5


1512 
	#HAVE_PROT_RECVFROM_5
 0

	)

1515 #i‚de‡
HAVE_PROT_RECVFROM_6


1516 
	#HAVE_PROT_RECVFROM_6
 0

	)

1519 #i‚de‡
HAVE_PROT_RECVMSG_0


1520 
	#HAVE_PROT_RECVMSG_0
 0

	)

1523 #i‚de‡
HAVE_PROT_RECVMSG_1


1524 
	#HAVE_PROT_RECVMSG_1
 0

	)

1527 #i‚de‡
HAVE_PROT_RECVMSG_2


1528 
	#HAVE_PROT_RECVMSG_2
 0

	)

1531 #i‚de‡
HAVE_PROT_RECVMSG_3


1532 
	#HAVE_PROT_RECVMSG_3
 0

	)

1535 #i‚de‡
HAVE_PROT_RECV_0


1536 
	#HAVE_PROT_RECV_0
 0

	)

1539 #i‚de‡
HAVE_PROT_RECV_1


1540 
	#HAVE_PROT_RECV_1
 0

	)

1543 #i‚de‡
HAVE_PROT_RECV_2


1544 
	#HAVE_PROT_RECV_2
 0

	)

1547 #i‚de‡
HAVE_PROT_RECV_3


1548 
	#HAVE_PROT_RECV_3
 0

	)

1551 #i‚de‡
HAVE_PROT_RECV_4


1552 
	#HAVE_PROT_RECV_4
 0

	)

1555 #i‚de‡
HAVE_PROT_SENDMSG_0


1556 
	#HAVE_PROT_SENDMSG_0
 0

	)

1559 #i‚de‡
HAVE_PROT_SENDMSG_1


1560 
	#HAVE_PROT_SENDMSG_1
 0

	)

1563 #i‚de‡
HAVE_PROT_SENDMSG_2


1564 
	#HAVE_PROT_SENDMSG_2
 0

	)

1567 #i‚de‡
HAVE_PROT_SENDMSG_3


1568 
	#HAVE_PROT_SENDMSG_3
 0

	)

1571 #i‚de‡
HAVE_PROT_SENDTO_0


1572 
	#HAVE_PROT_SENDTO_0
 0

	)

1575 #i‚de‡
HAVE_PROT_SENDTO_1


1576 
	#HAVE_PROT_SENDTO_1
 0

	)

1579 #i‚de‡
HAVE_PROT_SENDTO_2


1580 
	#HAVE_PROT_SENDTO_2
 0

	)

1583 #i‚de‡
HAVE_PROT_SENDTO_3


1584 
	#HAVE_PROT_SENDTO_3
 0

	)

1587 #i‚de‡
HAVE_PROT_SENDTO_4


1588 
	#HAVE_PROT_SENDTO_4
 0

	)

1591 #i‚de‡
HAVE_PROT_SENDTO_5


1592 
	#HAVE_PROT_SENDTO_5
 0

	)

1595 #i‚de‡
HAVE_PROT_SENDTO_6


1596 
	#HAVE_PROT_SENDTO_6
 0

	)

1599 #i‚de‡
HAVE_PROT_SEND_0


1600 
	#HAVE_PROT_SEND_0
 0

	)

1603 #i‚de‡
HAVE_PROT_SEND_1


1604 
	#HAVE_PROT_SEND_1
 0

	)

1607 #i‚de‡
HAVE_PROT_SEND_2


1608 
	#HAVE_PROT_SEND_2
 0

	)

1611 #i‚de‡
HAVE_PROT_SEND_3


1612 
	#HAVE_PROT_SEND_3
 0

	)

1615 #i‚de‡
HAVE_PROT_SEND_4


1616 
	#HAVE_PROT_SEND_4
 0

	)

1619 #i‚de‡
HAVE_PROT_VFPRINTF_0


1620 
	#HAVE_PROT_VFPRINTF_0
 0

	)

1623 #i‚de‡
HAVE_PROT_VFPRINTF_1


1624 
	#HAVE_PROT_VFPRINTF_1
 0

	)

1627 #i‚de‡
HAVE_PROT_VFPRINTF_2


1628 
	#HAVE_PROT_VFPRINTF_2
 0

	)

1631 #i‚de‡
HAVE_PROT_VFPRINTF_3


1632 
	#HAVE_PROT_VFPRINTF_3
 0

	)

1635 #i‚de‡
HAVE_PROT_VPRINTF_0


1636 
	#HAVE_PROT_VPRINTF_0
 0

	)

1639 #i‚de‡
HAVE_PROT_VPRINTF_1


1640 
	#HAVE_PROT_VPRINTF_1
 0

	)

1643 #i‚de‡
HAVE_PROT_VPRINTF_2


1644 
	#HAVE_PROT_VPRINTF_2
 0

	)

1647 #i‚de‡
HAVE_PROT_WRITEV_0


1648 
	#HAVE_PROT_WRITEV_0
 0

	)

1651 #i‚de‡
HAVE_PROT_WRITEV_1


1652 
	#HAVE_PROT_WRITEV_1
 0

	)

1655 #i‚de‡
HAVE_PROT_WRITEV_2


1656 
	#HAVE_PROT_WRITEV_2
 0

	)

1659 #i‚de‡
HAVE_PROT_WRITEV_3


1660 
	#HAVE_PROT_WRITEV_3
 0

	)

1663 #i‚de‡
HAVE_PROT_WRITE_0


1664 
	#HAVE_PROT_WRITE_0
 0

	)

1667 #i‚de‡
HAVE_PROT_WRITE_1


1668 
	#HAVE_PROT_WRITE_1
 0

	)

1671 #i‚de‡
HAVE_PROT_WRITE_2


1672 
	#HAVE_PROT_WRITE_2
 0

	)

1675 #i‚de‡
HAVE_PROT_WRITE_3


1676 
	#HAVE_PROT_WRITE_3
 0

	)

1679 #i‚de‡
HAVE_PROT__IO_GETC_0


1680 
	#HAVE_PROT__IO_GETC_0
 0

	)

1683 #i‚de‡
HAVE_PROT__IO_GETC_1


1684 
	#HAVE_PROT__IO_GETC_1
 0

	)

1687 #i‚de‡
HAVE_PROT__IO_PUTC_0


1688 
	#HAVE_PROT__IO_PUTC_0
 0

	)

1691 #i‚de‡
HAVE_PROT__IO_PUTC_1


1692 
	#HAVE_PROT__IO_PUTC_1
 0

	)

1695 #i‚de‡
HAVE_PROT__IO_PUTC_2


1696 
	#HAVE_PROT__IO_PUTC_2
 0

	)

1699 #i‚de‡
HAVE_PROT__READ_CHK_0


1700 
	#HAVE_PROT__READ_CHK_0
 0

	)

1703 #i‚de‡
HAVE_PROT__READ_CHK_1


1704 
	#HAVE_PROT__READ_CHK_1
 0

	)

1707 #i‚de‡
HAVE_PROT__READ_CHK_2


1708 
	#HAVE_PROT__READ_CHK_2
 0

	)

1711 #i‚de‡
HAVE_PROT__READ_CHK_3


1712 
	#HAVE_PROT__READ_CHK_3
 0

	)

1715 #i‚de‡
HAVE_PROT__READ_CHK_4


1716 
	#HAVE_PROT__READ_CHK_4
 0

	)

1719 #i‚de‡
HAVE_PSELECT


1720 
	#HAVE_PSELECT
 0

	)

1723 #i‚de‡
HAVE_PTHREAD_H


1724 
	#HAVE_PTHREAD_H
 0

	)

1727 #i‚de‡
HAVE_RECVBUF_IOCTL


1728 
	#HAVE_RECVBUF_IOCTL
 0

	)

1731 #i‚de‡
HAVE_RESOLV_H


1732 
	#HAVE_RESOLV_H
 0

	)

1735 #i‚de‡
HAVE_ROUTEINFO_BSD


1736 
	#HAVE_ROUTEINFO_BSD
 0

	)

1739 #i‚de‡
HAVE_ROUTEINFO_LINUX


1740 
	#HAVE_ROUTEINFO_LINUX
 0

	)

1743 #i‚de‡
HAVE_ROUTE_SOURCE


1744 
	#HAVE_ROUTE_SOURCE
 0

	)

1747 #i‚de‡
HAVE_RPC_RPC_H


1748 
	#HAVE_RPC_RPC_H
 0

	)

1751 #i‚de‡
HAVE_RRESVPORT


1752 
	#HAVE_RRESVPORT
 0

	)

1755 #i‚de‡
HAVE_RTLD_NEXT


1756 
	#HAVE_RTLD_NEXT
 0

	)

1759 #i‚de‡
HAVE_SASL


1760 
	#HAVE_SASL
 0

	)

1763 #i‚de‡
HAVE_SASL_DARWIN


1764 
	#HAVE_SASL_DARWIN
 0

	)

1767 #i‚de‡
HAVE_SASL_H


1768 
	#HAVE_SASL_H
 0

	)

1771 #i‚de‡
HAVE_SASL_SASL_H


1772 
	#HAVE_SASL_SASL_H
 0

	)

1775 #i‚de‡
HAVE_SCHED_H


1776 
	#HAVE_SCHED_H
 0

	)

1779 #i‚de‡
HAVE_SCHED_SETAFFINITY


1780 
	#HAVE_SCHED_SETAFFINITY
 0

	)

1783 #i‚de‡
HAVE_SCHED_SETSCHEDULER


1784 
	#HAVE_SCHED_SETSCHEDULER
 0

	)

1787 #i‚de‡
HAVE_SECURITY_PAM_APPL_H


1788 
	#HAVE_SECURITY_PAM_APPL_H
 0

	)

1791 #i‚de‡
HAVE_SELECT_MAXTIMEOUT


1792 
	#HAVE_SELECT_MAXTIMEOUT
 0

	)

1795 #i‚de‡
HAVE_SENDBUF_IOCTL


1796 
	#HAVE_SENDBUF_IOCTL
 0

	)

1799 #i‚de‡
HAVE_SENDMSG_DEADLOCK


1800 
	#HAVE_SENDMSG_DEADLOCK
 0

	)

1803 #i‚de‡
HAVE_SETEGID


1804 
	#HAVE_SETEGID
 0

	)

1807 #i‚de‡
HAVE_SETEUID


1808 
	#HAVE_SETEUID
 0

	)

1811 #i‚de‡
HAVE_SETPROCTITLE


1812 
	#HAVE_SETPROCTITLE
 0

	)

1815 #i‚de‡
HAVE_SHADOW_H


1816 
	#HAVE_SHADOW_H
 0

	)

1819 #i‚de‡
HAVE_SIGNAL_SIGINFO


1820 
	#HAVE_SIGNAL_SIGINFO
 0

	)

1823 #i‚de‡
HAVE_SIG_ATOMIC_T


1824 
	#HAVE_SIG_ATOMIC_T
 0

	)

1827 #i‚de‡
HAVE_SIOCGIFHWADDR


1828 
	#HAVE_SIOCGIFHWADDR
 0

	)

1831 #i‚de‡
HAVE_SOCKADDR_SA_LEN


1832 
	#HAVE_SOCKADDR_SA_LEN
 0

	)

1835 #i‚de‡
HAVE_SOCKADDR_STORAGE_SS_LEN


1836 
	#HAVE_SOCKADDR_STORAGE_SS_LEN
 0

	)

1839 #i‚de‡
HAVE_SOCKATMARK


1840 
	#HAVE_SOCKATMARK
 0

	)

1843 #i‚de‡
HAVE_SOCKOPTVALSYM_MAX


1844 
	#HAVE_SOCKOPTVALSYM_MAX
 0

	)

1847 #i‚de‡
HAVE_SOCKOPTVAL_MAX


1848 
	#HAVE_SOCKOPTVAL_MAX
 0

	)

1851 #i‚de‡
HAVE_SOLARIS_BUGS


1852 
	#HAVE_SOLARIS_BUGS
 0

	)

1855 #i‚de‡
HAVE_SOLARIS_PRIVS


1856 
	#HAVE_SOLARIS_PRIVS
 0

	)

1859 #i‚de‡
HAVE_SO_ACCEPTCONN


1860 
	#HAVE_SO_ACCEPTCONN
 0

	)

1863 #i‚de‡
HAVE_SO_AUDIT


1864 
	#HAVE_SO_AUDIT
 0

	)

1867 #i‚de‡
HAVE_SO_BINDANY


1868 
	#HAVE_SO_BINDANY
 0

	)

1871 #i‚de‡
HAVE_SO_BROADCAST


1872 
	#HAVE_SO_BROADCAST
 0

	)

1875 #i‚de‡
HAVE_SO_CKSUMRECV


1876 
	#HAVE_SO_CKSUMRECV
 0

	)

1879 #i‚de‡
HAVE_SO_DEBUG


1880 
	#HAVE_SO_DEBUG
 0

	)

1883 #i‚de‡
HAVE_SO_DONTROUTE


1884 
	#HAVE_SO_DONTROUTE
 0

	)

1887 #i‚de‡
HAVE_SO_ERROR


1888 
	#HAVE_SO_ERROR
 0

	)

1891 #i‚de‡
HAVE_SO_JUMBO


1892 
	#HAVE_SO_JUMBO
 0

	)

1895 #i‚de‡
HAVE_SO_KEEPALIVE


1896 
	#HAVE_SO_KEEPALIVE
 0

	)

1899 #i‚de‡
HAVE_SO_KERNACCEPT


1900 
	#HAVE_SO_KERNACCEPT
 0

	)

1903 #i‚de‡
HAVE_SO_LINGER


1904 
	#HAVE_SO_LINGER
 0

	)

1907 #i‚de‡
HAVE_SO_NOMULTIPATH


1908 
	#HAVE_SO_NOMULTIPATH
 0

	)

1911 #i‚de‡
HAVE_SO_NOREUSEADDR


1912 
	#HAVE_SO_NOREUSEADDR
 0

	)

1915 #i‚de‡
HAVE_SO_OOBINLINE


1916 
	#HAVE_SO_OOBINLINE
 0

	)

1919 #i‚de‡
HAVE_SO_PEERID


1920 
	#HAVE_SO_PEERID
 0

	)

1923 #i‚de‡
HAVE_SO_PRIORITY


1924 
	#HAVE_SO_PRIORITY
 0

	)

1927 #i‚de‡
HAVE_SO_RCVBUF


1928 
	#HAVE_SO_RCVBUF
 0

	)

1931 #i‚de‡
HAVE_SO_RCVBUFFORCE


1932 
	#HAVE_SO_RCVBUFFORCE
 0

	)

1935 #i‚de‡
HAVE_SO_RCVLOWAT


1936 
	#HAVE_SO_RCVLOWAT
 0

	)

1939 #i‚de‡
HAVE_SO_RCVTIMEO


1940 
	#HAVE_SO_RCVTIMEO
 0

	)

1943 #i‚de‡
HAVE_SO_REUSEADDR


1944 
	#HAVE_SO_REUSEADDR
 0

	)

1947 #i‚de‡
HAVE_SO_REUSEPORT


1948 
	#HAVE_SO_REUSEPORT
 0

	)

1951 #i‚de‡
HAVE_SO_SNDBUF


1952 
	#HAVE_SO_SNDBUF
 0

	)

1955 #i‚de‡
HAVE_SO_SNDBUFFORCE


1956 
	#HAVE_SO_SNDBUFFORCE
 0

	)

1959 #i‚de‡
HAVE_SO_SNDLOWAT


1960 
	#HAVE_SO_SNDLOWAT
 0

	)

1963 #i‚de‡
HAVE_SO_SNDTIMEO


1964 
	#HAVE_SO_SNDTIMEO
 0

	)

1967 #i‚de‡
HAVE_SO_TIMESTAMP


1968 
	#HAVE_SO_TIMESTAMP
 0

	)

1971 #i‚de‡
HAVE_SO_TYPE


1972 
	#HAVE_SO_TYPE
 0

	)

1975 #i‚de‡
HAVE_SO_USELOOPBACK


1976 
	#HAVE_SO_USELOOPBACK
 0

	)

1979 #i‚de‡
HAVE_SO_USE_IFBUFS


1980 
	#HAVE_SO_USE_IFBUFS
 0

	)

1983 #i‚de‡
HAVE_STDDEF_H


1984 
	#HAVE_STDDEF_H
 0

	)

1987 #i‚de‡
HAVE_STDINT_H


1988 
	#HAVE_STDINT_H
 0

	)

1991 #i‚de‡
HAVE_STDLIB_H


1992 
	#HAVE_STDLIB_H
 0

	)

1995 #i‚de‡
HAVE_STRFTIME


1996 
	#HAVE_STRFTIME
 0

	)

1999 #i‚de‡
HAVE_STRINGS_H


2000 
	#HAVE_STRINGS_H
 0

	)

2003 #i‚de‡
HAVE_STRING_H


2004 
	#HAVE_STRING_H
 0

	)

2007 #i‚de‡
HAVE_STRLCPY


2008 
	#HAVE_STRLCPY
 0

	)

2011 #i‚de‡
HAVE_STRUCT_IPOPTS


2012 
	#HAVE_STRUCT_IPOPTS
 0

	)

2015 #i‚de‡
HAVE_STRVIS


2016 
	#HAVE_STRVIS
 0

	)

2019 #i‚de‡
HAVE_SUN_LDAP_SDK


2020 
	#HAVE_SUN_LDAP_SDK
 0

	)

2023 #i‚de‡
HAVE_SYSLOG_H


2024 
	#HAVE_SYSLOG_H
 0

	)

2027 #i‚de‡
HAVE_SYSTEM_XMSG_MAGIC


2028 
	#HAVE_SYSTEM_XMSG_MAGIC
 0

	)

2031 #i‚de‡
HAVE_SYS_FILE_H


2032 
	#HAVE_SYS_FILE_H
 0

	)

2035 #i‚de‡
HAVE_SYS_IOCTL_H


2036 
	#HAVE_SYS_IOCTL_H
 0

	)

2039 #i‚de‡
HAVE_SYS_IPC_H


2040 
	#HAVE_SYS_IPC_H
 0

	)

2043 #i‚de‡
HAVE_SYS_PSTAT_H


2044 
	#HAVE_SYS_PSTAT_H
 0

	)

2047 #i‚de‡
HAVE_SYS_SELECT_H


2048 
	#HAVE_SYS_SELECT_H
 0

	)

2051 #i‚de‡
HAVE_SYS_SEM_H


2052 
	#HAVE_SYS_SEM_H
 0

	)

2055 #i‚de‡
HAVE_SYS_SHM_H


2056 
	#HAVE_SYS_SHM_H
 0

	)

2059 #i‚de‡
HAVE_SYS_SOCKIO_H


2060 
	#HAVE_SYS_SOCKIO_H
 0

	)

2063 #i‚de‡
HAVE_SYS_STAT_H


2064 
	#HAVE_SYS_STAT_H
 0

	)

2067 #i‚de‡
HAVE_SYS_TIME_H


2068 
	#HAVE_SYS_TIME_H
 0

	)

2071 #i‚de‡
HAVE_SYS_TYPES_H


2072 
	#HAVE_SYS_TYPES_H
 0

	)

2075 #i‚de‡
HAVE_SYS_WAIT_H


2076 
	#HAVE_SYS_WAIT_H
 0

	)

2079 #i‚de‡
HAVE_TCPD_H


2080 
	#HAVE_TCPD_H
 0

	)

2083 #i‚de‡
HAVE_TCP_CORK


2084 
	#HAVE_TCP_CORK
 0

	)

2087 #i‚de‡
HAVE_TCP_CWND


2088 
	#HAVE_TCP_CWND
 0

	)

2091 #i‚de‡
HAVE_TCP_CWND_DF


2092 
	#HAVE_TCP_CWND_DF
 0

	)

2095 #i‚de‡
HAVE_TCP_CWND_IF


2096 
	#HAVE_TCP_CWND_IF
 0

	)

2099 #i‚de‡
HAVE_TCP_INFO


2100 
	#HAVE_TCP_INFO
 0

	)

2103 #i‚de‡
HAVE_TCP_INFO_TCPI_ADVMSS


2104 
	#HAVE_TCP_INFO_TCPI_ADVMSS
 0

	)

2107 #i‚de‡
HAVE_TCP_INFO_TCPI_ATO


2108 
	#HAVE_TCP_INFO_TCPI_ATO
 0

	)

2111 #i‚de‡
HAVE_TCP_INFO_TCPI_BACKOFF


2112 
	#HAVE_TCP_INFO_TCPI_BACKOFF
 0

	)

2115 #i‚de‡
HAVE_TCP_INFO_TCPI_CA_STATE


2116 
	#HAVE_TCP_INFO_TCPI_CA_STATE
 0

	)

2119 #i‚de‡
HAVE_TCP_INFO_TCPI_FACKETS


2120 
	#HAVE_TCP_INFO_TCPI_FACKETS
 0

	)

2123 #i‚de‡
HAVE_TCP_INFO_TCPI_LAST_ACK_RECV


2124 
	#HAVE_TCP_INFO_TCPI_LAST_ACK_RECV
 0

	)

2127 #i‚de‡
HAVE_TCP_INFO_TCPI_LAST_ACK_SENT


2128 
	#HAVE_TCP_INFO_TCPI_LAST_ACK_SENT
 0

	)

2131 #i‚de‡
HAVE_TCP_INFO_TCPI_LAST_DATA_RECV


2132 
	#HAVE_TCP_INFO_TCPI_LAST_DATA_RECV
 0

	)

2135 #i‚de‡
HAVE_TCP_INFO_TCPI_LAST_DATA_SENT


2136 
	#HAVE_TCP_INFO_TCPI_LAST_DATA_SENT
 0

	)

2139 #i‚de‡
HAVE_TCP_INFO_TCPI_LOST


2140 
	#HAVE_TCP_INFO_TCPI_LOST
 0

	)

2143 #i‚de‡
HAVE_TCP_INFO_TCPI_PMTU


2144 
	#HAVE_TCP_INFO_TCPI_PMTU
 0

	)

2147 #i‚de‡
HAVE_TCP_INFO_TCPI_PROBES


2148 
	#HAVE_TCP_INFO_TCPI_PROBES
 0

	)

2151 #i‚de‡
HAVE_TCP_INFO_TCPI_RCV_RTT


2152 
	#HAVE_TCP_INFO_TCPI_RCV_RTT
 0

	)

2155 #i‚de‡
HAVE_TCP_INFO_TCPI_RCV_SPACE


2156 
	#HAVE_TCP_INFO_TCPI_RCV_SPACE
 0

	)

2159 #i‚de‡
HAVE_TCP_INFO_TCPI_RCV_SSTHRESH


2160 
	#HAVE_TCP_INFO_TCPI_RCV_SSTHRESH
 0

	)

2163 #i‚de‡
HAVE_TCP_INFO_TCPI_REORDERING


2164 
	#HAVE_TCP_INFO_TCPI_REORDERING
 0

	)

2167 #i‚de‡
HAVE_TCP_INFO_TCPI_RETRANS


2168 
	#HAVE_TCP_INFO_TCPI_RETRANS
 0

	)

2171 #i‚de‡
HAVE_TCP_INFO_TCPI_RETRANSMITS


2172 
	#HAVE_TCP_INFO_TCPI_RETRANSMITS
 0

	)

2175 #i‚de‡
HAVE_TCP_INFO_TCPI_SACKED


2176 
	#HAVE_TCP_INFO_TCPI_SACKED
 0

	)

2179 #i‚de‡
HAVE_TCP_INFO_TCPI_TOTAL_RETRANS


2180 
	#HAVE_TCP_INFO_TCPI_TOTAL_RETRANS
 0

	)

2183 #i‚de‡
HAVE_TCP_INFO_TCPI_UNACKED


2184 
	#HAVE_TCP_INFO_TCPI_UNACKED
 0

	)

2187 #i‚de‡
HAVE_TCP_INIT_CWND


2188 
	#HAVE_TCP_INIT_CWND
 0

	)

2191 #i‚de‡
HAVE_TCP_IPA


2192 
	#HAVE_TCP_IPA
 0

	)

2195 #i‚de‡
HAVE_TCP_KEEPCNT


2196 
	#HAVE_TCP_KEEPCNT
 0

	)

2199 #i‚de‡
HAVE_TCP_KEEPIDLE


2200 
	#HAVE_TCP_KEEPIDLE
 0

	)

2203 #i‚de‡
HAVE_TCP_KEEPINTVL


2204 
	#HAVE_TCP_KEEPINTVL
 0

	)

2207 #i‚de‡
HAVE_TCP_LINGER2


2208 
	#HAVE_TCP_LINGER2
 0

	)

2211 #i‚de‡
HAVE_TCP_MAXRT


2212 
	#HAVE_TCP_MAXRT
 0

	)

2215 #i‚de‡
HAVE_TCP_MAXSEG


2216 
	#HAVE_TCP_MAXSEG
 0

	)

2219 #i‚de‡
HAVE_TCP_MD5SIG


2220 
	#HAVE_TCP_MD5SIG
 0

	)

2223 #i‚de‡
HAVE_TCP_NODELAY


2224 
	#HAVE_TCP_NODELAY
 0

	)

2227 #i‚de‡
HAVE_TCP_NODELAYACK


2228 
	#HAVE_TCP_NODELAYACK
 0

	)

2231 #i‚de‡
HAVE_TCP_NOOPT


2232 
	#HAVE_TCP_NOOPT
 0

	)

2235 #i‚de‡
HAVE_TCP_NOPUSH


2236 
	#HAVE_TCP_NOPUSH
 0

	)

2239 #i‚de‡
HAVE_TCP_NOREDUCE_CWND_EXIT_FRXMT


2240 
	#HAVE_TCP_NOREDUCE_CWND_EXIT_FRXMT
 0

	)

2243 #i‚de‡
HAVE_TCP_NOREDUCE_CWND_IN_FRXMT


2244 
	#HAVE_TCP_NOREDUCE_CWND_IN_FRXMT
 0

	)

2247 #i‚de‡
HAVE_TCP_NOTENTER_SSTART


2248 
	#HAVE_TCP_NOTENTER_SSTART
 0

	)

2251 #i‚de‡
HAVE_TCP_RFC1323


2252 
	#HAVE_TCP_RFC1323
 0

	)

2255 #i‚de‡
HAVE_TCP_SACK_ENABLE


2256 
	#HAVE_TCP_SACK_ENABLE
 0

	)

2259 #i‚de‡
HAVE_TCP_STDURG


2260 
	#HAVE_TCP_STDURG
 0

	)

2263 #i‚de‡
HAVE_TCP_SYNCNT


2264 
	#HAVE_TCP_SYNCNT
 0

	)

2267 #i‚de‡
HAVE_TCP_WINDOW_CLAMP


2268 
	#HAVE_TCP_WINDOW_CLAMP
 0

	)

2271 #i‚de‡
HAVE_THREADS_EINTR_PROBLEMS


2272 
	#HAVE_THREADS_EINTR_PROBLEMS
 0

	)

2275 #i‚de‡
HAVE_TIMER_MACROS


2276 
	#HAVE_TIMER_MACROS
 0

	)

2279 #i‚de‡
HAVE_UDP_CORK


2280 
	#HAVE_UDP_CORK
 0

	)

2283 #i‚de‡
HAVE_UINT16_T


2284 
	#HAVE_UINT16_T
 0

	)

2287 #i‚de‡
HAVE_UINT32_T


2288 
	#HAVE_UINT32_T
 0

	)

2291 #i‚de‡
HAVE_UINT8_T


2292 
	#HAVE_UINT8_T
 0

	)

2295 #i‚de‡
HAVE_UNIFIED_BUFFERCACHE


2296 
	#HAVE_UNIFIED_BUFFERCACHE
 0

	)

2299 #i‚de‡
HAVE_UNISTD_H


2300 
	#HAVE_UNISTD_H
 0

	)

2303 #i‚de‡
HAVE_UTIME_H


2304 
	#HAVE_UTIME_H
 0

	)

2307 #i‚de‡
HAVE_UTIME_NULL


2308 
	#HAVE_UTIME_NULL
 0

	)

2311 #i‚de‡
HAVE_VALGRIND_VALGRIND_H


2312 
	#HAVE_VALGRIND_VALGRIND_H
 0

	)

2315 #i‚de‡
HAVE_VOLATILE_SIG_ATOMIC_T


2316 
	#HAVE_VOLATILE_SIG_ATOMIC_T
 0

	)

2319 #i‚de‡
HAVE_VPRINTF


2320 
	#HAVE_VPRINTF
 0

	)

2323 #i‚de‡
HAVE_VSYSLOG


2324 
	#HAVE_VSYSLOG
 0

	)

2327 #i‚de‡
HAVE_WORKING_GETPWNAM


2328 
	#HAVE_WORKING_GETPWNAM
 0

	)

2331 #i‚de‡
HAVE__IO_GETC


2332 
	#HAVE__IO_GETC
 0

	)

2335 #i‚de‡
HAVE__IO_PUTC


2336 
	#HAVE__IO_PUTC
 0

	)

2339 #i‚de‡
HAVE___FPRINTF_CHK


2340 
	#HAVE___FPRINTF_CHK
 0

	)

2343 #i‚de‡
HAVE___READ_CHK


2344 
	#HAVE___READ_CHK
 0

	)

2347 #i‚de‡
HAVE___VFPRINTF_CHK


2348 
	#HAVE___VFPRINTF_CHK
 0

	)

2351 #i‚de‡
NEED_AF_LOCAL


2352 
	#NEED_AF_LOCAL
 0

	)

2355 #i‚de‡
NEED_EXIT_FAILURE


2356 
	#NEED_EXIT_FAILURE
 0

	)

2359 #i‚de‡
NEED_GETSOCKOPT_CAST


2360 
	#NEED_GETSOCKOPT_CAST
 0

	)

2363 #i‚de‡
NEED_SA_RESTART


2364 
	#NEED_SA_RESTART
 0

	)

2367 #i‚de‡
NEED_SYS_SOCKIO_H


2368 
	#NEED_SYS_SOCKIO_H
 0

	)

2371 #i‚de‡
SOCKS_DIRECTROUTE_FALLBACK


2372 
	#SOCKS_DIRECTROUTE_FALLBACK
 0

	)

	@include/sockd.h

47 #i‚de‡
_SOCKD_H_


48 
	#_SOCKD_H_


	)

50 #i‡
HAVE_SCHED_H


51 
	~<sched.h
>

54 #i‡
HAVE_SOLARIS_PRIVS


55 
	~<¥iv.h
>

58 
	~<sys/ty≥s.h
>

59 
	~<sys/ùc.h
>

60 #i‡
HAVE_SYS_SHM_H


61 
	~<sys/shm.h
>

64 
	~<ªgex.h
>

71 
	#SOCKD_ALARMTESTS_DELAY
 (60)

	)

77 
	#SOCKD_CONNECTTIMEOUT
 (30)

	)

84 
	#SOCKD_NEGOTIATETIMEOUT
 (30)

	)

90 
	#SOCKD_IOTIMEOUT_TCP
 (0Ë

	)

92 #i‡
SOCKS_SERVER


93 
	#SOCKD_IOTIMEOUT_UDP
 (86400Ë

	)

95 
	#SOCKD_IOTIMEOUT_UDP
 (3600Ë

	)

118 
	#SOCKD_FIN_WAIT_2_TIMEOUT
 (0Ë

	)

130 
	#SOCKD_MIN_CLIENTS_HANDLED_NEGOTIATE
 (
	`MAX
(
SOCKD_NEGOTIATEMAX
 * 10, 5000))

	)

131 
	#SOCKD_MIN_CLIENTS_HANDLED_REQUEST
 (
	`MAX
(
SOCKD_REQUESTMAX
 * 10, 5000))

	)

132 
	#SOCKD_MIN_CLIENTS_HANDLED_IO
 (
	`MAX
(
SOCKD_IOMAX
 * 10, 5000))

	)

134 
	#SOCKD_MIN_LIFETIME_SECONDS
 (60 * 1)

	)

138 
	#SOCKD_SINGLEAUTH_LINGERTIMEOUT
 (60Ë

	)

140 
	#SOCKD_CACHESTAT
 (1000Ë

	)

142 
	#SOCKD_EXPLICIT_LDAP_PORT
 (389)

	)

143 
	#SOCKD_EXPLICIT_LDAPS_PORT
 (636)

	)

145 
	#SOCKD_LDAP_DEADTIME
 (30)

	)

146 
	#SOCKD_LDAP_SEARCHTIME
 (30)

	)

147 
	#SOCKD_LDAP_TIMEOUT
 (2)

	)

160 #i‡
BAREFOOTD


161 
	#HAVE_NEGOTIATE_PHASE
 (0)

	)

163 
	#HAVE_CONTROL_CONNECTION
 (0)

	)

164 
	#HAVE_SOCKS_RULES
 (0)

	)

165 
	#HAVE_TCP_SUPPORT
 (1)

	)

166 
	#HAVE_UDP_SUPPORT
 (1)

	)

168 #ñi‡
SOCKS_SERVER


169 
	#HAVE_NEGOTIATE_PHASE
 (1)

	)

170 
	#HAVE_CONTROL_CONNECTION
 (1)

	)

171 
	#HAVE_SOCKS_RULES
 (1)

	)

172 
	#HAVE_TCP_SUPPORT
 (1)

	)

173 
	#HAVE_UDP_SUPPORT
 (1)

	)

175 #ñi‡
COVENANT


176 
	#HAVE_NEGOTIATE_PHASE
 (1)

	)

177 
	#HAVE_CONTROL_CONNECTION
 (0)

	)

178 
	#HAVE_SOCKS_RULES
 (1)

	)

179 
	#HAVE_TCP_SUPPORT
 (1)

	)

180 
	#HAVE_UDP_SUPPORT
 (0)

	)

192 #i‚de‡
DISABLE_GETHOSTBYNAME_CACHE


194 #unde‡
gëho°by«me


195 
	#gëho°by«me
(
«me
Ë(
	`cgëho°by«me
(“ame)))

	)

197 #unde‡
gëho°byaddr


198 
	#gëho°byaddr
(
addr
, 
Àn
, 
ty≥
Ë(
	`cgëho°byaddr
(◊ddr), (Àn), (ty≥)))

	)

200 #unde‡
gë«meöfo


201 
	#gë«meöfo
(
ß
, 
ßÀn
, 
ho°
, 
ho°Àn
, 
£rv
, 
£rvÀn
, 
Êags
) \

202 
	`cgë«meöfo
(
ß
, 
ßÀn
, 
ho°
, 
ho°Àn
, 
£rv
, 
£rvÀn
, 
Êags
)

	)

207 
	#DEFAULT_LDAP_FILTER_GROUP
 "(&(membîuid=%s)(obje˘˛assıosixgroup))"

	)

209 
	#DEFAULT_LDAP_FILTER_GROUP_AD
 "(&(˙=%s)(obje˘˛ass=group))"

	)

221 
	#INIT
(
Àngth
) \

222 c⁄° 
size_t
 
°¨t
 = 
°©e
->start; \

223 c⁄° 
size_t
 
íd
 = 
°¨t
 + (
Àngth
); \

224 
î∫o
 = 0

	)

233 
	#CHECK
(
obje˘
, 
auth
, 
√xtfun˘i⁄
) \

235 
	`SASSERTX
(
°©e
->
ªqªad
 <
íd
); \

237 
î∫o
 = 0; \

239 i‡(
	`LEFT
()) { \

240 
ssize_t
 
p
; \

242 
	`SASSERT
(
	`LEFT
() > 0); \

244 i‡(
	`LEFT
(Ë> 
	`MEMLEFT
()) \

245 
	`OUTOFMEM
(); \

247 i‡((
p
 = 
	`READ
(
s
, 
	`LEFT
(), 
auth
)) <= 0) { \

248 i‡(
	`ERRNOISTMP
(
î∫o
)) \

249  
NEGOTIATE_CONTINUE
; \

250 i‡(
p
 == 0) \

251  
NEGOTIATE_EOF
; \

253  
NEGOTIATE_ERROR
; \

256 
°©e
->
ªqªad
 +
p
; \

258 i‡(
	`LEFT
()) { \

259 
î∫o
 = 
EWOULDBLOCK
; \

260  
NEGOTIATE_CONTINUE
; \

264 
	`OBJECTFILL
((
obje˘
)); \

266 
°©e
->
°¨t
 = 
íd
; \

267 
°©e
->
rcuºít
 = 
√xtfun˘i⁄
; \

269 i‡(
°©e
->
rcuºít
 !
NULL
) \

270  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state); \

271 }  0)

	)

273 
	#MEMLEFT
(Ë((
°©e
->
mem
Ë- sèã->
ªqªad
)

	)

275 
	#LEFT
(Ë((
íd
Ë- 
°©e
->
ªqªad
)

	)

280 
	#READ
(
s
, 
Àngth
, 
auth
) \

281 (
	`socks_ªcv‰omn
((
s
), \

282 &
°©e
->
mem
[°©e->
ªqªad
], \

283 (
Àngth
), \

286 
NULL
, \

287 
NULL
, \

288 
NULL
, \

289 (
auth
))) \

290 

	)

298 
	#OBJECTFILL
(
obje˘
Ë(
	`mem˝y
((obje˘), &
°©e
->
mem
[
°¨t
], 
íd
 - sèπ))

	)

310 #i‡
SOCKS_SERVER


311 
	#OUTOFMEM
() \

313 
	`SERRX
(
	`LEFT
()); \

314 }  0)

	)

316 
	#OUTOFMEM
() \

318 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg), \

322 ()
°©e
->
ªqªad
); \

324  
NEGOTIATE_ERROR
; \

325 }  0)

	)

336 
	#DO_IOCOUNT
(
_§c_ªad
, 
_§c_wrôãn
, 
_d°_ªad
, 
_d°_wrôãn
, 
_io
) \

338 
	`SASSERTX
((
_§c_ªad
)->
byãs
 <(
_io
)->
§c
.
ªad
.bytes); \

339 
	`SASSERTX
((
_§c_ªad
)->
∑ckës
 <(
_io
)->
§c
.
ªad
.packets); \

341 
	`SASSERTX
((
_§c_wrôãn
)->
byãs
 <(
_io
)->
§c
.
wrôãn
.bytes); \

342 
	`SASSERTX
((
_§c_wrôãn
)->
∑ckës
 <(
_io
)->
§c
.
wrôãn
.packets); \

344 
	`SASSERTX
((
_d°_ªad
)->
byãs
 <(
_io
)->
d°
.
ªad
.bytes); \

345 
	`SASSERTX
((
_d°_ªad
)->
∑ckës
 <(
_io
)->
d°
.
ªad
.packets); \

347 
	`SASSERTX
((
_d°_wrôãn
)->
byãs
 <(
_io
)->
d°
.
wrôãn
.bytes); \

348 
	`SASSERTX
((
_d°_wrôãn
)->
∑ckës
 <(
_io
)->
d°
.
wrôãn
.packets); \

350 (
_§c_ªad
)->
byãs
 = (
_io
)->
§c
.
ªad
.bytes - (_src_read)->bytes; \

351 (
_§c_ªad
)->
∑ckës
 = (
_io
)->
§c
.
ªad
.packets - (_src_read)->packets; \

353 (
_§c_wrôãn
)->
byãs
 = (
_io
)->
§c
.
wrôãn
.bytes - (_src_written)->bytes; \

354 (
_§c_wrôãn
)->
∑ckës
 \

355 (
_io
)->
§c
.
wrôãn
.
∑ckës
 - (
_§c_wrôãn
)->packets; \

357 (
_d°_ªad
)->
byãs
 = (
_io
)->
d°
.
ªad
.bytes - (_dst_read)->bytes; \

358 (
_d°_ªad
)->
∑ckës
 = (
_io
)->
d°
.
ªad
.packets - (_dst_read)->packets; \

360 (
_d°_wrôãn
)->
byãs
 = (
_io
)->
d°
.
wrôãn
.bytes - (_dst_written)->bytes; \

361 (
_d°_wrôãn
)->
∑ckës
 \

362 (
_io
)->
d°
.
wrôãn
.
∑ckës
 - (
_d°_wrôãn
)->packets; \

363 }  0)

	)

366 
	#RESET_THROTTLE
(
obje˘
, 
timíow
) \

368 (
obje˘
)->
°¨âime
 = (
timíow
); \

369 (
obje˘
)->
√w˛õ¡s
 = (0); \

370 }  0)

	)

374 
	#COPY_MONITORFIELDS
(
‰om
, 
to
) \

376 (
to
)->
m°©s
 = (
‰om
)->mstats; \

377 (
to
)->
m°©s_shmid
 = (
‰om
)->mstats_shmid; \

378 (
to
)->
m°©s_isöhîôabÀ
 = (
‰om
)->mstats_isinheritable; \

379 (
to
)->
Æ¨msc⁄figuªd
 = (
‰om
)->alarmsconfigured; \

380 }  0)

	)

384 
	#CLEAR_MONITORFIELDS
(
obje˘
) \

386 (
obje˘
)->
m°©s
 = 
NULL
; \

387 (
obje˘
)->
m°©s_shmid
 = 0; \

388 (
obje˘
)->
m°©s_isöhîôabÀ
 = 1; \

390 }  0)

	)

404 
	#SHMID_ISSET
(
obje˘
) \

405 ((
obje˘
)->
bw_shmid
 || (obje˘)->
m°©s_shmid
 || (obje˘)->
ss_shmid
)

	)

407 
	#SHMID_ISATTACHED
(
obje˘
) \

408 ((
obje˘
)->
bw
 !
NULL
 || (obje˘)->
m°©s
 !NULL || (obje˘)->
ss
 !NULL)

	)

410 
	#INIT_MSTATES
(
obje˘
, 
_ty≥
, 
_numbî
) \

412 i‡((
obje˘
)->
bw
 !
NULL
) \

413 
	`INIT_MSTATE
(&((
obje˘
)->
bw
->
m°©e
), (
_ty≥
), (
_numbî
)); \

415 i‡((
obje˘
)->
ss
 !
NULL
) \

416 
	`INIT_MSTATE
(&((
obje˘
)->
ss
->
m°©e
), (
_ty≥
), (
_numbî
)); \

418 i‡((
obje˘
)->
m°©s
 !
NULL
) \

419 
	`INIT_MSTATE
(&((
obje˘
)->
m°©s
->
m°©e
), (
_ty≥
), (
_numbî
)); \

420 }  0)

	)

422 
	#INIT_MSTATE
(
m°©e
, 
_∑ª¡ty≥
, 
_numbî
) \

424 (
m°©e
)->
numbî
 = (
_numbî
); \

425 (
m°©e
)->
∑ª¡ty≥
 = (
_∑ª¡ty≥
); \

426 }  0)

	)

429 #i‡
DO_SHMEMCHECK


431 
	#MPROTECT_SHMEMHEADER
(
shmemobje˘
) \

433 
	`SASSERTX
((
shmemobje˘
)->
m°©e
.
shmid
 != 0); \

435 
	`¶og
(
LOG_DEBUG
, \

436 "%s: doög m¥Ÿe˘ o¿addªs†%p", 
fun˘i⁄
, (
shmemobje˘
)); \

438 
	`SASSERT
(
	`m¥Ÿe˘
((
shmemobje˘
), \

439 (
shmemobje˘
)->
m°©e
, \

440 
PROT_READ
) == 0); \

442 
	`SASSERTX
((
shmemobje˘
)->
m°©e
.
shmid
 != 0); \

443 }  0)

	)

445 
	#MUNPROTECT_SHMEMHEADER
(
shmemobje˘
) \

447 
	`SASSERTX
((
shmemobje˘
)->
m°©e
.
shmid
 != 0); \

449 
	`¶og
(
LOG_DEBUG
, \

450 "%s: doög mu≈rŸe˘ o¿addªs†%p", 
fun˘i⁄
, (
shmemobje˘
)); \

452 
	`SASSERT
(
	`m¥Ÿe˘
((
shmemobje˘
), \

453 (
shmemobje˘
)->
m°©e
, \

454 
PROT_READ
 | 
PROT_WRITE
) == 0); \

456 
	`SASSERTX
((
shmemobje˘
)->
m°©e
.
shmid
 != 0); \

457 }  0)

	)

462 
	#MPROTECT_SHMEMHEADER
(
shmemobje˘
Ëdÿ{ }  0)

	)

463 
	#MUNPROTECT_SHMEMHEADER
(
shmemobje˘
Ëdÿ{ }  0)

	)

467 #i‡
DEBUG
 || 
DIAGNOSTIC


471 
	#SHMEM_COPYOBJECT
(
§c
, 
d°
Ë
	`shmem_obje˘_t
 (d°Ë(*§c)

	)

475 
	#SHMEM_COPYOBJECT
(
§c
, 
d°
) \

477 
	`SASSERTX
(
§c
 !
NULL
); \

478 }  0)

	)

486 
	#SHMEM_MOVE
(
§c
, 
d°
, 
obje˘s
) \

488 
	`SHMEM_COPY
(
§c
, 
d°
, 
obje˘s
); \

489 
	`SHMEM_CLEAR
(
§c
, 
obje˘s
, 1); \

490 }  0)

	)

495 
	#SHMEM_COPY
(
§c
, 
d°
, 
obje˘s
) \

497 i‡(
obje˘s
 & 
SHMEM_BW
) { \

498 (
d°
)->
bw
 = (
§c
)->bw; \

499 (
d°
)->
bw_shmid
 = (
§c
)->bw_shmid; \

502 i‡(
obje˘s
 & 
SHMEM_MONITOR
) { \

503 
	`COPY_MONITORFIELDS
((
§c
), (
d°
)); \

506 i‡(
obje˘s
 & 
SHMEM_SS
) { \

507 (
d°
)->
ss
 = (
§c
)->ss; \

508 (
d°
)->
ss_shmid
 = (
§c
)->ss_shmid; \

510 }  0)

	)

514 
	#HANDLE_SHMAT
(
obje˘
, 
memfõld
, 
idfõld
) \

516 *
‚ame
; \

517 
fd
; \

519 
	`SASSERTX
((
obje˘
)->
memfõld
 =
NULL
); \

521 i‡((
obje˘
)->
idfõld
 == 0) \

524 
‚ame
 = 
	`sockd_gëshmem«me
((
obje˘
)->
idfõld
, 
key_un£t
); \

525 i‡((
fd
 = 
	`›í
(
‚ame
, 
O_RDWR
)) == -1) { \

526 
Áûuªisok
; \

528 i‡(
sockscf
.
°©e
.
mŸhî
.
s
 =-1 || 
	`sockd_mŸhîexi°s
() == 0) \

529 
Áûuªisok
 = 1; \

531 
Áûuªisok
 = 0; \

533 
	`¶og
(
Áûuªisok
 ? 
LOG_DEBUG
: 
LOG_WARNING
, \

535 
fun˘i⁄
, 
‚ame
, (
obje˘
)->
idfõld
, 
	`°ªº‹
(
î∫o
)); \

537 (
obje˘
)->
memfõld
 = 
NULL
; \

538 (
obje˘
)->
idfõld
 = 0; \

542 (
obje˘
)->
memfõld
 = 
	`sockd_mm≠
(
NULL
, \

543 (*(
obje˘
)->
memfõld
), \

544 
PROT_READ
 | 
PROT_WRITE
, \

545 
MAP_SHARED
, \

546 
fd
, \

549 
	`˛o£
(
fd
); \

551 i‡((
obje˘
)->
memfõld
 =
MAP_FAILED
) { \

552 
	`sw¨n
("%s: failedÅo mmap " #idfield " shmem segment %ld of size %ld " \

554 
fun˘i⁄
, \

555 (
obje˘
)->
idfõld
, \

556 ()(*(
obje˘
)->
memfõld
), \

557 
‚ame
); \

559 (
obje˘
)->
memfõld
 = 
NULL
; \

560 (
obje˘
)->
idfõld
 = 0; \

564 
	`MPROTECT_SHMEMHEADER
((
obje˘
)->
memfõld
); \

566 
	`SHMEM_COPYOBJECT
((
obje˘
)->
memfõld
, 
_shmem
); \

568 
	`¶og
(
LOG_DEBUG
, \

571 
fun˘i⁄
, \

572 (
obje˘
)->
idfõld
, \

573 ()(*(
obje˘
)->
memfõld
), \

574 (
obje˘
)->
memfõld
, \

575 ()(
obje˘
)->
memfõld
->
m°©e
.
˛õ¡s
, 
‚ame
); \

577 
	`SASSERTX
((
obje˘
)->
idfõld
 =(obje˘)->
memfõld
->
m°©e
.
shmid
); \

578 }  0)

	)

580 
	#HANDLE_SHMDT
(
obje˘
, 
memfõld
, 
idfõld
) \

582 
	`SASSERTX
((
obje˘
)->
idfõld
 != 0); \

583 
	`SASSERTX
((
obje˘
)->
memfõld
 !
NULL
); \

585 
	`SHMEM_COPYOBJECT
((
obje˘
)->
memfõld
, 
_shmem
); \

587 
	`SASSERTX
((
obje˘
)->
idfõld
 =(obje˘)->
memfõld
->
m°©e
.
shmid
); \

589 
	`¶og
(
LOG_DEBUG
, \

591 
fun˘i⁄
, \

592 (
obje˘
)->
idfõld
, \

593 (
obje˘
)->
memfõld
, \

594 ()(
obje˘
)->
memfõld
->
m°©e
.
˛õ¡s
); \

596 i‡(
	`munm≠
((
obje˘
)->
memfõld
, (*(object)->memfield)) != 0) \

597 
	`sw¨n
("%s: munmap of " #idfield " shmem segment %ld (%p) failed", \

598 
fun˘i⁄
, (
obje˘
)->
idfõld
, (obje˘)->
memfõld
); \

600 (
obje˘
)->
memfõld
 = 
NULL
; \

601 }  0)

	)

611 
	#SHMEM_UNUSE
(
ruÀ
, 
cöfo
, 
lock
, 
obje˘s
) \

613 
√ed_©èch
 = 
SHMEM_NONE
, 
dëach_‰om
 = SHMEM_NONE; \

619 i‡(((
obje˘s
Ë& 
SHMEM_BW
Ë&& (
ruÀ
)->
bw_shmid
 != 0) { \

620 i‡((
ruÀ
)->
bw
 =
NULL
) \

621 
√ed_©èch
 |
SHMEM_BW
; \

623 
dëach_‰om
 |
SHMEM_BW
; \

626 i‡(((
obje˘s
Ë& 
SHMEM_MONITOR
Ë&& (
ruÀ
)->
m°©s_shmid
 != 0) { \

627 i‡((
ruÀ
)->
m°©s
 =
NULL
) \

628 
√ed_©èch
 |
SHMEM_MONITOR
; \

630 
dëach_‰om
 |
SHMEM_MONITOR
; \

633 i‡(((
obje˘s
Ë& 
SHMEM_SS
Ë&& (
ruÀ
)->
ss_shmid
 != 0) { \

634 i‡((
ruÀ
)->
ss
 =
NULL
) \

635 
√ed_©èch
 |
SHMEM_SS
; \

637 
dëach_‰om
 |
SHMEM_SS
; \

640 i‡(
√ed_©èch
 !
SHMEM_NONE
) \

641 ()
	`sockd_shm©
((
ruÀ
), 
√ed_©èch
); \

647 i‡(((
obje˘s
Ë& 
SHMEM_BW
Ë&& (
ruÀ
)->
bw_shmid
 != 0) { \

648 
	`SASSERTX
((
ruÀ
)->
bw
 !
NULL
); \

650 
	`¶og
(
LOG_DEBUG
, "%s: unusing bw_shmid %luát %p, cinfo %s, clients %lu", \

651 
fun˘i⁄
, \

652 ()(
ruÀ
)->
bw_shmid
, \

653 (
ruÀ
)->
bw
, \

654 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0), \

655 ()(
ruÀ
)->
bw
->
m°©e
.
˛õ¡s
); \

657 
	`bw_unu£
((
ruÀ
)->
bw
, 
cöfo
, 
lock
); \

660 i‡(((
obje˘s
Ë& 
SHMEM_MONITOR
Ë&& (
ruÀ
)->
m°©s_shmid
 != 0) { \

661 
	`SASSERTX
((
ruÀ
)->
m°©s
 !
NULL
); \

663 
	`¶og
(
LOG_DEBUG
, \

665 
fun˘i⁄
, \

666 ()(
ruÀ
)->
m°©s_shmid
, \

667 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0), \

668 ()(
ruÀ
)->
m°©s
->
m°©e
.
˛õ¡s
); \

670 
	`m⁄ô‹_unu£
((
ruÀ
)->
m°©s
, 
cöfo
, 
lock
); \

673 i‡(((
obje˘s
Ë& 
SHMEM_SS
Ë&& (
ruÀ
)->
ss_shmid
 != 0) { \

674 
	`SASSERTX
((
ruÀ
)->
ss
 !
NULL
); \

676 
	`¶og
(
LOG_DEBUG
, "%s: unusing ss_shmid %lu, cinfo %s, clients %lu", \

677 
fun˘i⁄
, \

678 ()(
ruÀ
)->
ss_shmid
, \

679 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0), \

680 ()(
ruÀ
)->
ss
->
m°©e
.
˛õ¡s
); \

682 
	`£ssi⁄_unu£
((
ruÀ
)->
ss
, 
cöfo
, 
lock
); \

685 i‡((
√ed_©èch
 | 
dëach_‰om
Ë!
SHMEM_NONE
) \

686 
	`sockd_shmdt
((
ruÀ
), 
√ed_©èch
 | 
dëach_‰om
); \

687 }  0)

	)

692 
	#SHMEM_CLEAR
(
ruÀ
, 
obje˘s
, 
idtoo
) \

694 i‡(
obje˘s
 & 
SHMEM_BW
) { \

695 (
ruÀ
)->
bw
 = 
NULL
; \

697 i‡(
idtoo
) \

698 (
ruÀ
)->
bw_shmid
 = 0; \

701 i‡(
obje˘s
 & 
SHMEM_MONITOR
) { \

702 c⁄° 
shmid
 = (
ruÀ
)->
m°©s_shmid
; \

703 c⁄° 
size_t
 
Æ¨msc⁄figuªd
 = (
ruÀ
)->alarmsconfigured; \

705 
	`CLEAR_MONITORFIELDS
((
ruÀ
)); \

707 i‡(!
idtoo
) { \

708 (
ruÀ
)->
m°©s_shmid
 = 
shmid
; \

709 (
ruÀ
)->
Æ¨msc⁄figuªd
 =álarmsconfigured; \

713 i‡(
obje˘s
 & 
SHMEM_SS
) { \

714 (
ruÀ
)->
ss
 = 
NULL
; \

716 i‡(
idtoo
) \

717 (
ruÀ
)->
ss_shmid
 = 0; \

719 }  0)

	)

721 
	#UNLOCK
(
lock
) \

723 i‡(
lock
 != -1) \

724 
	`socks_u∆ock
(
lock
); \

725 }  0)

	)

727 #i‡
BAREFOOTD


728 
	#ALL_UDP_BOUNCED
() \

729 –
sockscf
.
°©e
.
Æludpboun˚d
 \

730 || 
	`pidismŸhî
(
sockscf
.
°©e
.
pid
Ë!1 )

	)

738 
	#MAX_IOLOGADDR
 \

739 (
MAXSOCKADDRSTRING
 + (" ") \

740 + 
MAXAUTHINFOLEN
 + 
MAXSOCKSHOSTSTRING
 + (" ") \

741 + 
MAXSOCKSHOSTSTRING
 + (" ") \

742 + 
MAXAUTHINFOLEN
 + 
MAXSOCKSHOSTSTRING
 + (" ") \

743 + (
MAXSOCKADDRSTRING
 + (" "Ë* 
HAVE_MAX_HOSTIDS
))

	)

745 #i‡
HAVE_SOCKS_HOSTID


746 
	#CRULE_OR_HRULE
(
obje˘
) \

747 ((
obje˘
)->
hruÀ_is£t
 ? &((obje˘)->
hruÀ
Ë: &((obje˘)->
¸uÀ
))

	)

749 #i‡
HAVE_MAX_HOSTIDS
 == 0

753 
	#DEFAULT_HOSTINDEX
 (1)

	)

755 
	#HOSTIDCOPY
(
§c
, 
d°
) do { \

756 
	`SASSERTX
(
	`ELEMENTS
((
d°
)->
ho°idv
Ë>(
§c
)->
ho°idc
); \

758 (
d°
)->
ho°idc
 = (
§c
)->hostidc; \

759 
	`mem˝y
((
d°
)->
ho°idv
, \

760 (
§c
)->
ho°idv
, \

761 (*(
§c
)->
ho°idv
Ë* (§c)->
ho°idc
); \

762 }  0)

	)

764 
	#HOSTIDZERO
(
cöfo
) \

766 (
cöfo
)->
ho°idc
 = 0; \

767 
	`bzîo
((
cöfo
)->
ho°idv
, ((cinfo)->hostidv)); \

768 }  0)

	)

771 
	#GET_HOSTIDV
(
obje˘
) \

773 (((
obje˘
Ë=
NULL
 || (obje˘)->
ho°idc
 =0Ë? NULL : (obje˘)->
ho°idv
)

	)

775 
	#GET_HOSTIDC
(
obje˘
) \

777 ((
obje˘
Ë=
NULL
 ? 0 : (obje˘)->
ho°idc
)

	)

781 
	#CRULE_OR_HRULE
(
obje˘
Ë(&((obje˘)->
¸uÀ
))

	)

782 
	#GET_HOSTIDV
(
obje˘
Ë((
ö_addr
 *)
NULL
)

	)

783 
	#GET_HOSTIDC
(
obje˘
Ë(0)

	)

784 
	#HOSTIDCOPY
(
§c
, 
d°
)

	)

785 
	#HOSTIDZERO
(
cöfo
)

	)

797 #i‡
HAVE_SOCKS_RULES


798 
	#SHMEMRULE
(
io
Ë(&((io)->
§uÀ
))

	)

801 
	#SHMEMRULE
(
io
Ë
	`CRULE_OR_HRULE
((io))

	)

805 
	#IORULE
(
io
Ë
	`SHMEMRULE
(io)

	)

812 
	#CONTROLIO
(
io
Ë((io)->
c⁄åﬁ
.
s
 != -1 ? \

813 &((
io
)->
c⁄åﬁ
) \

814 : (((
io
)->
°©e
.
comm™d
 =
SOCKS_BINDREPLY
Ë? &((io)->
d°
Ë: &((io)->
§c
)))

	)

816 
	#INTERNALIO
(
io
) \

817 (((
io
)->
°©e
.
comm™d
 =
SOCKS_BINDREPLY
Ë? &((io)->
d°
Ë: &((io)->
§c
))

	)

819 
	#CLIENTIO
(
io
Ë
	`INTERNALIO
(io)

	)

821 
	#EXTERNALIO
(
io
) \

822 (((
io
)->
°©e
.
comm™d
 =
SOCKS_BINDREPLY
Ë? &((io)->
§c
Ë: &((io)->
d°
))

	)

824 
	#TARGETIO
(
io
Ë
	`EXTERNALIO
(io)

	)

829 
	#SOCKD_NOP
 (0Ë

	)

830 
	#SOCKD_FREESLOT_TCP
 (1Ë

	)

831 
	#SOCKD_FREESLOT_UDP
 (2Ë

	)

836 
	#SOCKD_EXITNORMALLY
 (1)

	)

842 
	#SOCKD_REQUESTMAX
 1

	)

847 
	#MAX_TESTS_QUEUED
 (256)

	)

852 
	#PROC_MOTHER
 (0Ë

	)

853 
	#PROC_MONITOR
 (1)

	)

854 
	#PROC_NEGOTIATE
 (2)

	)

855 
	#PROC_REQUEST
 (3)

	)

856 
	#PROC_IO
 (4)

	)

857 
	#PROC_NOTOURS
 (255)

	)

859 #i‡
SOCKS_SERVER


860 
	#FDPASS_MAX
 3

	)

862 
	#FDPASS_MAX
 2

	)

869 
	#MAX_ADDCHILD_SECONDS
 (10)

	)

873 
	#DEFAULT_ALARM_PERIOD
 (5)

	)

878 
	#ALARM_INTERNAL
 (1)

	)

879 
	#ALARM_INTERNAL_RECV
 (2)

	)

880 
	#ALARM_INTERNAL_SEND
 (4)

	)

881 
	#ALARM_EXTERNAL
 (8)

	)

882 
	#ALARM_EXTERNAL_RECV
 (16)

	)

883 
	#ALARM_EXTERNAL_SEND
 (32)

	)

884 
	#ALARM_RECV
 (64)

	)

885 
	#ALARM_SEND
 (128)

	)

888 
	#ALARM_DATA
 (1)

	)

889 
	#ALARM_DISCONNECT
 (2)

	)

890 
	#ALARM_TEST
 (4)

	)

891 
	#ALARM_PROTOCOL
 (8)

	)

898 
	#VERDICT_BLOCKs
 "block"

	)

899 
	#VERDICT_PASSs
 "∑ss"

	)

902 
	#ROTATION_NOTSET
 0

	)

903 
	#ROTATION_NONE
 1

	)

904 
	#ROTATION_ROUTE
 2

	)

905 
	#ROTATION_SAMESAME
 3

	)

907 
	#SOCKS_LOG_CONNECTs
 "c⁄√˘"

	)

908 
	#SOCKS_LOG_DISCONNECTs
 "disc⁄√˘"

	)

909 
	#SOCKS_LOG_DATAs
 "d©a"

	)

910 
	#SOCKS_LOG_ERRORs
 "îr‹"

	)

911 
	#SOCKS_LOG_IOOPERATIONs
 "io›î©i⁄"

	)

912 
	#SOCKS_LOG_TCPINFOs
 "t˝öfo"

	)

914 íum { 
	maddrsc›e_globÆ
,

915 
	maddrsc›e_nodñoˇl
,

916 
	maddrsc›e_lökloˇl
 } 
	tùv6_addrsc›e_t
;

922 #i‡!
HAVE_PRIVILEGES


923 íum { 
	mPRIV_ON
, 
	mPRIV_OFF
 } 
	t¥iv_›_t
;

926 íum { 
	mSOCKD_PRIV_NOTSET
 = 0,

927 
	mSOCKD_PRIV_FILE_READ
,

928 
	mSOCKD_PRIV_FILE_WRITE
,

929 
	mSOCKD_PRIV_NET_ADDR
,

930 
	mSOCKD_PRIV_NET_ICMPACCESS
,

931 
	mSOCKD_PRIV_NET_ROUTESOCKET
,

932 
	mSOCKD_PRIV_PRIVILEGED
,

933 
	mSOCKD_PRIV_UNPRIVILEGED
,

934 
	mSOCKD_PRIV_LIBWRAP
,

935 
	mSOCKD_PRIV_PAM
,

936 
	mSOCKD_PRIV_BSDAUTH
,

937 
	mSOCKD_PRIV_GSSAPI


938 } 
	t¥ivûege_t
;

940 íum { 
	mIO_NOERROR
,

941 
	mIO_TMPERROR
,

942 
	mIO_IOERROR
,

943 
	mIO_ERROR
,

944 
	mIO_EAGAIN
,

945 
	mIO_TIMEOUT
,

946 
	mIO_CLOSE
,

947 
	mIO_BLOCK
,

948 
	mIO_TMPBLOCK
,

949 
	mIO_ADMINTERMINATION


950 } 
	tio°©us_t
;

952 
	#IOSTATUS_FATALERROR
(
îr‹
) \

953 (! ( (
îr‹
Ë=
IO_NOERROR
 \

954 || (
îr‹
Ë=
IO_TMPERROR
 \

955 || (
îr‹
Ë=
IO_TMPBLOCK
 \

956 || (
îr‹
Ë=
IO_EAGAIN
))

	)

958 #i‡
SOCKS_SERVER


960 
	#IOSTATUS_UDP_SEND_FAILED
(
e
) \

961 (
IO_TMPERROR
)

	)

965 
	#IOSTATUS_UDP_SEND_FAILED
(
e
) \

966 (((
e
Ë=
EMSGSIZE
 || 
	`ERRNOISTMP
”)Ë? 
IO_TMPERROR
 : 
IO_ERROR
)

	)

971 
	mOPERATION_ACCEPT
,

972 
	mOPERATION_BLOCK
,

973 
	mOPERATION_TMPBLOCK
,

974 
	mOPERATION_CONNECT
,

975 
	mOPERATION_DISCONNECT
,

976 
	mOPERATION_ERROR
,

977 
	mOPERATION_TMPERROR
,

978 
	mOPERATION_HOSTID
,

979 
	mOPERATION_IO


980 } 
	t›î©i⁄_t
;

982 íum { 
	mKEY_IPV4
, 
	mKEY_IPV6
, 
	mKEY_MAC
 } 
	tkeyty≥_t
;

983 íum { 
	mACKPIPE
, 
	mDATAPIPE
 } 
	twhichpùe_t
;

984 íum { 
	mNEGOTIATE_EOF
,

985 
	mNEGOTIATE_ERROR
,

986 
	mNEGOTIATE_CONTINUE
,

987 
	mNEGOTIATE_FINISHED


988 } 
	t√gŸüã_ªsu…_t
;

990 
	#Ákesockaddr2socksho°
 
sockaddr2socksho°


	)

993 #i‡
HAVE_SIGNAL_SIGINFO


994 
	#SIGNALISOK
(
sig
) \

995 –(
sig
Ë=
SIGHUP
 \

996 || (
sig
Ë=
SIGINT
 \

997 || (
sig
Ë=
SIGUSR1
 \

998 || (
sig
Ë=
SIGINFO
 \

999 || (
sig
Ë=
SIGQUIT
 \

1000 || (
sig
Ë=
SIGTERM
 \

1001 || (
sig
Ë=
SIGHUP
)

	)

1003 
	#SIGNALISOK
(
sig
) \

1004 –(
sig
Ë=
SIGHUP
 \

1005 || (
sig
Ë=
SIGINT
 \

1006 || (
sig
Ë=
SIGUSR1
 \

1007 || (
sig
Ë=
SIGQUIT
 \

1008 || (
sig
Ë=
SIGTERM
 \

1009 || (
sig
Ë=
SIGHUP
)

	)

1016 
	#SIGNAL_PROLOGUE
(
sig
, 
si
, 
ßved_î∫o
) \

1018 
_b
[1][32]; \

1019 c⁄° *
_msgv
[] \

1020 { 
	`sig«l2°rög
(-
sig
), \

1022 
	`…ﬂ
((-
sig
), 
_b
[0], (_b[0])), \

1023 
NULL
 \

1026 i‡((
sig
) > 0) { \

1027 c⁄° 
ﬁd_ösig«l
 = 
sockscf
.
°©e
.
ösig«l
; \

1029 
sockscf
.
°©e
.
ösig«l
 = (
sig
); \

1030 
	`sockd_pushsig«l
(
sig
, 
si
); \

1031 
sockscf
.
°©e
.
ösig«l
 = 
ﬁd_ösig«l
; \

1033 
î∫o
 = (
ßved_î∫o
); \

1037 (
sig
) = -(sig); \

1038 
	`sig«l¶og
(
LOG_DEBUG
, 
_msgv
); \

1039 }  0)

	)

1041 
	#SIGNAL_EPILOGUE
(
sig
, 
si
, 
ßved_î∫o
) \

1043 
_b
[1][32]; \

1044 c⁄° *
_msgv
[] \

1045 { 
	`sig«l2°rög
(
sig
), \

1047 
	`…ﬂ
((
sig
), 
_b
[0], (_b[0])), \

1048 
NULL
 \

1051 
	`sig«l¶og
(
LOG_DEBUG
, 
_msgv
); \

1053 
î∫o
 = (
ßved_î∫o
); \

1054 }  0)

	)

1056 #i‡
HAVE_UDP_SUPPORT


1058 
	#MIN_IPHLEN
 (20)

	)

1059 
	#MAX_IPHLEN
 (60)

	)

1061 
	#MIN_UDPLEN
 (8)

	)

1063 
	#MAX_ICMPUNREACHLEN
 (8 + 
MAX_IPHLEN
 + 
MIN_UDPLEN
)

	)

1064 
	#MIN_ICMPUNREACHLEN
 (8 + 
MIN_IPHLEN
 + 
MIN_UDPLEN
)

	)

1066 
	#ICMP_TYPE_TTLEXCEEDED
 (11)

	)

1067 
	#ICMP_CODE_TTLEXCEEDED_TRANSIT
 (1)

	)

1069 
	#ICMP_TYPE_UNREACHABLE
 (3)

	)

1070 
	#ICMP_CODE_UNREACHABLE_HOST
 (1)

	)

1071 
	#ICMP_CODE_UNREACHABLE_PORT
 (3)

	)

1072 
	#ICMP_CODE_UNREACHABLE_DESTHOSTUNKNOWN
 (7)

	)

1073 
	#ICMP_CODE_UNREACHABLE_HOSTPROHIBITED
 (13)

	)

1075 
	#IOOP
(
isblocked
, 
io°©us
) \

1077 ((
isblocked
) ? \

1078 (
SOCKS_SERVER
 ? 
OPERATION_TMPBLOCK
 : 
OPERATION_BLOCK
) \

1080 : ((
io°©us
Ë=
IO_TMPERROR
 ? 
OPERATION_TMPERROR
 : 
OPERATION_ERROR
))

	)

1084 íum { 
	mRAWSOCKET_NOP
,

1085 
	mRAWSOCKET_IO_DELETED


1086 } 
	tøwsockë°©us_t
;

1089 
	#SOCKD_IO_PACKETSTATS
 (128)

	)

1091 
timevÆ
 
	mœãncyv
[
SOCKD_IO_PACKETSTATS
];

1092 
size_t
 
	mœ°œãncyi
;

1094 
size_t
 
	mœãncyc
;

1097 
	mmö_us
;

1098 
	mmax_us
;

1099 
	mœ°_us
;

1100 
	mavîage_us
;

1101 
	mmedün_us
;

1102 
	m°ddev_us
;

1103 } 
	tio°©_t
;

1107 íum { 
	mTEST_MTU__WAITING_FOR_KEEPALIVE_ACK1
 = 1,

1108 
	mTEST_MTU__WAITING_FOR_KEEPALIVE_ACK2


1109 } 
	tmtu_îr‹_ã°_°©e_t
;

1112 
	mt˝_kì∑live
;

1113 
	mt˝_kìpidÀ
;

1115 #i‡
HAVE_TCP_INFO


1116 
t˝_öfo
 
	mt˝öfo
;

1118 } 
	tmtu_ã°_°©e_d©a_t
;

1121 
timevÆ
 
	m°¨t
;

1123 
mtu_îr‹_ã°_°©e_t
 
	m°©e
;

1124 
timevÆ
 
	m√xtcheck
;

1126 
mtu_ã°_°©e_d©a_t
 
	möôül
;

1127 
mtu_ã°_°©e_d©a_t
 
	mcuºít
;

1128 } 
	tmtu_ã°_°©e_t
;

1131 
	mdŸe°
;

1132 
mtu_ã°_°©e_t
 
	m°©e
;

1133 } 
	tmtuã°_t
;

1136 
mtuã°_t
 
	mmtu
;

1137 } 
	t√tw‹kã°_t
;

1144 
	mã°ed
;

1145 } 
	mmtu
;

1146 } 
	t√tw‹kã°_ã°ed_t
;

1150 
	mßmï‹t
;

1151 
	mdø·_5_05
;

1152 } 
	tcom∑t_t
;

1155 
	mc⁄√˘
;

1156 
	mdisc⁄√˘
;

1157 
	md©a
;

1158 
	mîr‹
;

1159 
	mio›î©i⁄
;

1160 
	mt˝öfo
;

1161 } 
	tlog_t
;

1164 
sockaddr_°‹age
 
	m‰om
;

1166 #i‡
HAVE_SOCKS_HOSTID


1167 
ö_addr
 
	mho°idv
[
HAVE_MAX_HOSTIDS
];

1168 
	mho°idc
;

1170 } 
	t˛õ¡öfo_t
;

1172 íum { 
	mkey_un£t
 = 0, 
	mkey_‰om
, 
	mkey_ho°id
 } 
	t°©ekey_t
;

1179 
	mshmid
;

1180 
size_t
 
	mnumbî
;

1181 
obje˘ty≥_t
 
	m∑ª¡ty≥
;

1186 
size_t
 
	m˛õ¡s
;

1187 } 
	tshmem_hódî_t
;

1190 
size_t
 
	mbyãs
;

1191 
timevÆ
 
	miŸime
;

1193 
	mmaxbps_is£t
;

1194 
size_t
 
	mmaxbps
;

1195 } 
	tbw_t
;

1199 
size_t
 
	m˛õ¡s
;

1200 
time_t
 
	m£c⁄ds
;

1201 } 
	t£ssi⁄thrŸée_t
;

1204 
	mmax_is£t
;

1205 
size_t
 
	mmax
;

1211 
	mthrŸée_is£t
;

1213 
£ssi⁄thrŸée_t
 
	mlimô
;

1214 
timevÆ
 
	m°¨âime
;

1215 
size_t
 
	m√w˛õ¡s
;

1216 } 
	mthrŸée
;

1222 
size_t
 
	mmax_≥r°©e
;

1223 
	mmax_≥r°©e_is£t
;

1225 
	mthrŸée_≥r°©e_is£t
;

1227 
£ssi⁄thrŸée_t
 
	mlimô
;

1228 } 
	mthrŸée_≥r°©e
;

1229 } 
	t£ssi⁄_t
;

1232 
°©ekey_t
 
	mkey
;

1238 
time_t
 
	mœ°expúesˇn
;

1242 
	mho°ödex
;

1243 } 
	mkeyöfo
;

1258 
ß_Ámûy_t
 
	mßÁmûy
;

1260 
ö_addr
 
	mùv4
;

1261 
ö6_addr
 
	mùv6
;

1262 } 
	maddr
;

1264 
size_t
 
	maddrc
;

1265 } 
	m‰om
;

1268 
ö_addr
 
	mùv4
;

1269 
size_t
 
	maddrc
;

1270 } 
	mho°id
;

1271 } 
	md©a
;

1275 
timevÆ
 
	m°¨âime
;

1276 
size_t
 
	m√w˛õ¡s
;

1277 } 
	mss
;

1278 } 
	möfo
;

1280 } *
	mkeyv
;

1281 
size_t
 
	mkeyc
;

1282 } 
	tkey°©e_t
;

1286 
size_t
 
	mbyãs
;

1287 
time_t
 
	m£c⁄ds
;

1288 } 
	tÆ¨m_d©a_limô_t
;

1291 
	misc⁄figuªd
;

1293 
	mis⁄
;

1295 
timevÆ
 
	mÆ¨mch™ge
;

1297 
size_t
 
	mbyãs
;

1298 
timevÆ
 
	mœ°io
;

1300 
timevÆ
 
	mœ°ª£t
;

1302 
Æ¨m_d©a_limô_t
 
	mlimô
;

1303 } 
	tÆ¨m_d©a_side_t
;

1306 
Æ¨m_d©a_side_t
 
	mªcv
;

1307 
Æ¨m_d©a_side_t
 
	m£nd
;

1308 } 
	tÆ¨m_d©a_t
;

1317 
size_t
 
	m£ssi⁄c
;

1318 
size_t
 
	mdisc⁄√˘c
;

1319 
time_t
 
	m£c⁄ds
;

1320 } 
	tÆ¨m_disc⁄√˘_limô_t
;

1323 
	misc⁄figuªd
;

1325 
timevÆ
 
	mœ°ª£t
;

1326 
size_t
 
	m£ssi⁄c
;

1332 
size_t
 
	m≥î_disc⁄√˘c
;

1333 
size_t
 
	m£lf_disc⁄√˘c
;

1335 
Æ¨m_disc⁄√˘_limô_t
 
	mlimô
;

1336 } 
	tÆ¨m_disc⁄√˘_t
;

1340 
Æ¨m_d©a_t
 
	md©a
;

1341 
Æ¨m_disc⁄√˘_t
 
	mdisc⁄√˘
;

1346 
√tw‹kã°_t
 
	mã°
;

1347 } 
	mÆ¨m
;

1348 } 
	tm⁄ô‹_if_t
;

1350 
	#SOCKD_MAX_CLIENTS
 (10000)

	)

1353 
uöt32_t
 
	muid
;

1354 
uöt32_t
 
	m£ss_˙t
;

1355 
uöt64_t
 
	mu∂ﬂds
;

1356 
uöt64_t
 
	mdow∆ﬂds
;

1357 
uöt32_t
 
	mdù
[10];

1358 } 
	mÆ¨m
[
SOCKD_MAX_CLIENTS
];

1359 
uöt32_t
 
	mu£r_˙t
;

1360 } 
	tu£r_öfo_t
;

1363 
m⁄ô‹_if_t
 
	möã∫Æ
;

1364 
m⁄ô‹_if_t
 
	mexã∫Æ
;

1365 
u£r_öfo_t
 
	mu£r_öfo
;

1366 } 
	tm⁄ô‹_°©s_t
;

1369 
	#SHMEM_NONE
 (0x0)

	)

1370 
	#SHMEM_BW
 (0x1)

	)

1371 
	#SHMEM_MONITOR
 (0x2)

	)

1372 
	#SHMEM_SS
 (0x4)

	)

1373 
	#SHMEM_ALL
 (
SHMEM_BW
 | 
SHMEM_MONITOR
 | 
SHMEM_SS
)

	)

1376 
shmem_hódî_t
 
	mm°©e
;

1377 
key°©e_t
 
	mkey°©e
;

1379 
size_t
 
	mty≥
;

1381 
bw_t
 
	mbw
;

1382 
£ssi⁄_t
 
	mss
;

1383 
m⁄ô‹_°©s_t
 
	mm⁄ô‹
;

1384 } 
	mobje˘
;

1385 } 
	tshmem_obje˘_t
;

1389 
keyty≥_t
 
	mkey
;

1392 
ö_addr
 
	mùv4
;

1393 
ö6_addr
 
	mùv6
;

1394 
	mmaˇddr
[
ETHER_ADDR_LEN
];

1395 } 
	mvÆue
;

1396 } 
	tli˚n£key_t
;

1398 
	sm⁄ô‹_t
 {

1399 
obje˘ty≥_t
 
	mty≥
;

1401 
shmem_obje˘_t
 *
	mm°©s
;

1402 
	mm°©s_shmid
;

1403 
	mm°©s_isöhîôabÀ
;

1408 
size_t
 
	mÆ¨m_d©a_aggªg©e
;

1409 
size_t
 
	mÆ¨m_disc⁄√˘_aggªg©e
;

1416 
size_t
 
	mÆ¨msc⁄figuªd
;

1418 
ruÀaddr_t
 
	m§c
;

1419 
ruÀaddr_t
 
	md°
;

1421 
	mho°id›ti⁄_is£t
;

1422 #i‡
HAVE_SOCKS_HOSTID


1423 
ruÀaddr_t
 
	mho°id
;

1428 
	mho°ödex
;

1434 
size_t
 
	mnumbî
;

1435 
size_t
 
	mlöíumbî
;

1437 
£rvî°©e_t
 
	m°©e
;

1439 
m⁄ô‹_t
 *
	m√xt
;

1440 } 
	tm⁄ô‹_t
;

1443 
	misc⁄figuªd
;

1445 
	me˙
;

1446 
	me˙_logÀvñ
;

1448 
	mßck
;

1449 
	mßck_logÀvñ
;

1451 
	mtime°amps
;

1452 
	mtime°amps_logÀvñ
;

1454 
	mwsˇÀ
;

1455 
	mwsˇÀ_logÀvñ
;

1456 } 
	tw¨n_¥Ÿocﬁ_t˝_›ti⁄s_t
;

1460 
w¨n_¥Ÿocﬁ_t˝_›ti⁄s_t
 
	míabÀd
;

1461 
w¨n_¥Ÿocﬁ_t˝_›ti⁄s_t
 
	mdißbÀd
;

1462 } 
	mt˝
;

1463 } 
	tw¨n_¥Ÿocﬁ_t
;

1473 
	mî∫o_logÀvñv
[
MAXLOGLEVELS
][
UNIQUE_ERRNO_VALUES
];

1474 
size_t
 
	mî∫o_logÀvñc
[
MAXLOGLEVELS
];

1479 
	mgaõº_logÀvñv
[
MAXLOGLEVELS
][
UNIQUE_GAIERR_VALUES
];

1480 
size_t
 
	mgaõº_logÀvñc
[
MAXLOGLEVELS
];

1485 
w¨n_¥Ÿocﬁ_t
 
	m¥Ÿocﬁ
;

1486 } 
	tlog•ecül_t
;

1488 
	sruÀ_t
 {

1489 
obje˘ty≥_t
 
	mty≥
;

1490 
	mvîdi˘
;

1492 
sockë›ti⁄_t
 *
	msockë›ti⁄v
;

1493 
size_t
 
	msockë›ti⁄c
;

1495 #i‡
COVENANT


1498 
	mmissög¥oxyauth
;

1499 } 
	mwhyblock
;

1503 
ruÀaddr_t
 
	m§c
;

1504 
ruÀaddr_t
 
	md°
;

1506 
ruÀaddr_t
 
	mrdr_‰om
;

1507 
ruÀaddr_t
 
	mrdr_to
;

1509 
	mho°id›ti⁄_is£t
;

1510 #i‡
HAVE_SOCKS_HOSTID


1511 
ruÀaddr_t
 
	mho°id
;

1516 
	mho°ödex
;

1525 #i‡
BAREFOOTD


1526 
	mboun˚d
;

1537 
ruÀaddr_t
 
	mboun˚to
;

1538 } 
	mexåa
;

1541 
log_t
 
	mlog
;

1544 
log•ecül_t
 
	mlog
;

1545 } 
	möã∫Æ
;

1548 
log•ecül_t
 
	mlog
;

1549 } 
	mexã∫Æ
;

1552 
size_t
 
	mnumbî
;

1553 
size_t
 
	mlöíumbî
;

1555 
£rvî°©e_t
 
	m°©e
;

1556 
timeout_t
 
	mtimeout
;

1558 
löked«me_t
 *
	mu£r
;

1559 
löked«me_t
 *
	mgroup
;

1562 
ö_p‹t_t
 
	m°¨t
;

1563 
ö_p‹t_t
 
	míd
;

1564 
›î©‹_t
 
	m›
;

1565 } 
	mud¥™ge
;

1567 #i‡
HAVE_LDAP


1568 
löked«me_t
 *
	mld≠group
;

1569 
löked«me_t
 *
	mld≠£rvî
;

1570 
	mld≠£âögs‰omu£r
;

1573 #i‡
HAVE_LIBWRAP


1574 
	mlibwøp
[
LIBWRAPBUF
];

1577 
shmem_obje˘_t
 *
	mm°©s
;

1578 
	mm°©s_shmid
;

1579 
	mm°©s_isöhîôabÀ
;

1580 
size_t
 
	mÆ¨msc⁄figuªd
;

1582 
shmem_obje˘_t
 *
	mbw
;

1583 
	mbw_shmid
;

1584 
	mbw_isöhîôabÀ
;

1589 
shmem_obje˘_t
 *
	mss
;

1590 
	mss_shmid
;

1591 
	mss_isöhîôabÀ
;

1596 
ruÀ_t
 *
	m√xt
;

1597 } 
	truÀ_t
;

1600 
	mvÆue
;

1601 *
	m«me
;

1602 } 
	t˝upﬁicy_t
;

1607 
	mschedulög_is£t
;

1609 #i‡
HAVE_SCHED_SETSCHEDULER


1610 
	mpﬁicy
;

1611 
sched_∑øm
 
	m∑øm
;

1615 
	mafföôy_is£t
;

1617 #i‡
HAVE_SCHED_SETAFFINITY


1618 
˝u_£t_t
 
	mmask
;

1621 } 
	t˝u£âög_t
;

1624 
	mnodnsmism©ch
;

1625 
	mnodnsunknown
;

1626 
	mcheckª∂yauth
;

1627 } 
	t§cho°_t
;

1634 *
	mc⁄figfûe
;

1636 
	md´m⁄
;

1638 
	mdebug
;

1639 
	mdebug_is£t
;

1641 
	mho°s_ac˚ss
;

1643 
	mdúe˘ÁŒback
;

1645 
	mkì∑live
;

1647 *
	mpidfûe
;

1648 
	mpidfûewrôãn
;

1650 
size_t
 
	m£rvîc
;

1652 
	mvîify⁄ly
;

1653 
	mvîsi⁄⁄ly
;

1654 } 
	t›ti⁄_t
;

1657 #i‡
HAVE_PRIVILEGES


1659 
¥iv_£t_t
 *
	mu≈rivûeged
;

1660 
¥iv_£t_t
 *
	m¥ivûeged
;

1661 } 
	t¥ivûeges_t
;

1665 
	m¥ivûeged_is£t
;

1666 
uid_t
 
	m¥ivûeged_uid
;

1667 
gid_t
 
	m¥ivûeged_gid
;

1669 
	mu≈rivûeged_is£t
;

1670 
uid_t
 
	mu≈rivûeged_uid
;

1671 
gid_t
 
	mu≈rivûeged_gid
;

1673 
	mlibwøp_is£t
;

1674 
uid_t
 
	mlibwøp_uid
;

1675 
gid_t
 
	mlibwøp_gid
;

1678 } 
	tu£rid_t
;

1682 
	mack
;

1683 
	ms
;

1684 } 
	tsockd_mŸhî_t
;

1688 
	möôed
;

1690 
sig_©omic_t
 
	mösig«l
;

1692 
sig_©omic_t
 
	msig«l
;

1693 
sigöfo_t
 
	msigöfo
;

1694 } 
	msig«lv
[
SOCKS_NSIG
];

1695 
sig_©omic_t
 
	msig«lc
;

1700 
size_t
 
	mu√x≥˘ed_dóths
;

1701 
time_t
 
	mfú°dóth_time
;

1702 
time_t
 
	mœ°dóth_time
;

1709 
rußge
 
	mrußge_m⁄ô‹
;

1710 
rußge
 
	mrußge_√gŸüã
;

1711 
rußge
 
	mrußge_ªque°
;

1712 
rußge
 
	mrußge_io
;

1714 
˝u£âög_t
 
	m˝u
;

1716 
pid_t
 *
	mmŸhîpidv
;

1717 
pid_t
 
	mpid
;

1719 
	mª£rvedfdv
[1];

1727 
	mhavïrivs
;

1732 
uid_t
 
	meuid
;

1733 
gid_t
 
	megid
;

1735 
	mhighe°fdöu£
;

1736 
æim_t
 
	mmax›ífûes
;

1737 
sockd_mŸhî_t
 
	mmŸhî
;

1738 
	m∑gesize
;

1739 
	mty≥
;

1741 
	mm⁄ô‹_ack
;

1742 
	mm⁄ô‹_s
;

1743 
time_t
 
	mm⁄ô‹_£¡
;

1748 #i‡
BAREFOOTD


1749 
	mÆludpboun˚d
;

1752 #i‡
HAVE_PAM


1758 
	m∑m£rvi˚«me
[
MAXNAMELEN
];

1761 #i‡
HAVE_BSDAUTH


1767 
	mbsdauth°yÀ«me
[
MAXNAMELEN
];

1770 #i‡
HAVE_GSSAPI


1776 
	mgsßpi£rvi˚«me
[
MAXNAMELEN
];

1777 
	mgsßpikeyèb
[
MAXNAMELEN
];

1780 
	#MAXLDAPLEN
 (255 + 1)

	)

1781 #i‡
HAVE_LDAP


1782 
	mld≠©åibuã
[
MAXLDAPLEN
];

1783 
	mld≠©åibuã_AD
[
MAXLDAPLEN
];

1784 
	mld≠˚πfûe
[
MAXLDAPLEN
];

1785 
	mld≠˚π∑th
[
MAXLDAPLEN
];

1786 
	mld≠fûãr
[
MAXLDAPLEN
];

1787 
	mld≠fûãr_AD
[
MAXLDAPLEN
];

1788 
	mld≠keyèb
[
MAXLDAPLEN
];

1791 } 
	tc⁄fig°©e_t
;

1797 
	mùv4
;

1798 
	mùv6
;

1803 
	mhasùv4
;

1804 
	mhasùv6
;

1807 
	mhasùv6_globÆsc›e
;

1808 } 
	töãrÁ˚¥Ÿocﬁ_t
;

1811 
	ms
;

1812 
sockaddr_°‹age
 
	maddr
;

1814 
	m¥Ÿocﬁ
;

1818 } 
	tli°íaddªss_t
;

1821 
öãrÁ˚¥Ÿocﬁ_t
 
	m¥Ÿocﬁ
;

1823 
li°íaddªss_t
 *
	maddrv
;

1824 
size_t
 
	maddrc
;

1826 
log•ecül_t
 
	mlog
;

1827 } 
	töã∫Æaddªss_t
;

1830 
öãrÁ˚¥Ÿocﬁ_t
 
	m¥Ÿocﬁ
;

1832 
ruÀaddr_t
 *
	maddrv
;

1833 
size_t
 
	maddrc
;

1835 
	mrŸ©i⁄
;

1837 
log•ecül_t
 
	mlog
;

1838 } 
	texã∫Æaddªss_t
;

1841 
size_t
 
	mac˚±ed
;

1842 
time_t
 
	mboŸ
;

1843 
time_t
 
	mc⁄figlﬂd
;

1846 
size_t
 
	m£ndt
;

1847 
size_t
 
	mª˚ived
;

1848 } 
	m√gŸüã
;

1851 
size_t
 
	m£ndt
;

1852 
size_t
 
	mª˚ived
;

1853 } 
	mªque°
;

1856 
size_t
 
	m£ndt
;

1857 
size_t
 
	mª˚ived
;

1858 } 
	mio
;

1859 } 
	t°©i°ic_t
;

1862 #ifde‡
HAVE_VOLATILE_SIG_ATOMIC_T


1863 
sig_©omic_t
 
	mnﬂddchûd
;

1864 
sig_©omic_t
 
	mnﬂddchûd_î∫o
;

1866 vﬁ©ûê
sig_©omic_t
 
	mnﬂddchûd
;

1867 vﬁ©ûê
sig_©omic_t
 
	mnﬂddchûd_î∫o
;

1869 c⁄° *
	mnﬂddchûd_ªas⁄
;

1871 
size_t
 
	mmaxªque°s
;

1875 } 
	tchûd°©e_t
;

1878 
	mid
;

1879 
°©ekey_t
 
	mkey
;

1880 
size_t
 
	mty≥
;

1881 } 
	tﬁdshmemöfo_t
;

1892 
	sc⁄fig
 {

1894 
›ti⁄_t
 
	mcmdlöe
;

1895 
˝u£âög_t
 
	m˝u
;

1897 #i‡!
HAVE_PRIVILEGES


1898 
uid_t
 
	meuid
;

1899 
gid_t
 
	megid
;

1902 
ªs_›ti⁄s_ty≥_t
 
	mªs_›ti⁄s
;

1903 } 
	möôül
;

1905 
öã∫Æaddªss_t
 
	möã∫Æ
;

1906 
exã∫Æaddªss_t
 
	mexã∫Æ
;

1909 
˝u£âög_t
 
	mmŸhî
;

1910 
˝u£âög_t
 
	m√gŸüã
;

1911 
˝u£âög_t
 
	mªque°
;

1912 
˝u£âög_t
 
	mio
;

1913 
˝u£âög_t
 
	mm⁄ô‹
;

1914 } 
	m˝u
;

1916 
ruÀ_t
 *
	m¸uÀ
;

1917 
ruÀ_t
 *
	mhruÀ
;

1918 
ruÀ_t
 *
	m§uÀ
;

1920 
rouã›ti⁄s_t
 
	mrouã›ti⁄s
;

1921 
rouã_t
 *
	mrouã
;

1923 
m⁄ô‹_t
 *
	mm⁄ô‹
;

1929 
time_t
 
	mmtu_timeout
;

1930 } 
	mm⁄ô‹•ec
;

1932 
sockë›ti⁄_t
 *
	msockë›ti⁄v
;

1933 
size_t
 
	msockë›ti⁄c
;

1935 
	mho°fd
;

1940 #i‡
HAVE_LDAP


1941 
	mld≠fd
;

1947 
	mshmemfd
;

1953 
	mshmemc⁄figfd
;

1965 
c⁄fig
 *
	mc⁄fig
;

1968 
size_t
 
	mc⁄figsize
;

1969 } *
	mshmemöfo
;

1970 
	mshmem_‚ameba£
[
PATH_MAX
];

1972 
ﬁdshmemöfo_t
 *
	mﬁdshmemv
;

1973 
size_t
 
	mﬁdshmemc
;

1975 
com∑t_t
 
	mcom∑t
;

1976 
exãnsi⁄_t
 
	mexãnsi⁄
;

1978 
logty≥_t
 
	mîæog
;

1979 
logty≥_t
 
	mlog
;

1980 
	mloglock
;

1982 
›ti⁄_t
 
	m›ti⁄
;

1988 
	mªsﬁvïrŸocﬁ
;

1989 
§cho°_t
 
	m§cho°
;

1990 
°©i°ic_t
 
	m°©
;

1991 
c⁄fig°©e_t
 
	m°©e
;

1992 
timeout_t
 
	mtimeout
;

1994 #i‡
HAVE_PRIVILEGES


1995 
¥ivûeges_t
 
	m¥ivûeges
;

1997 
u£rid_t
 
	muid
;

2000 
chûd°©e_t
 
	mchûd
;

2002 
	mcmëhodv
[
METHODS_KNOWN
];

2003 
size_t
 
	mcmëhodc
;

2005 
	msmëhodv
[
METHODS_KNOWN
];

2006 
size_t
 
	msmëhodc
;

2008 
	mudpc⁄√˘d°
;

2010 #i‡
HAVE_LIBWRAP


2011 *
	mho°s_Ælow_‹igöÆ
;

2012 *
	mho°s_díy_‹igöÆ
;

2014 #i‡
COVENANT


2015 
	mªÆm«me
[256];

2020 
	m¥oxy¥Ÿocﬁ
;

2021 
socksho°_t
 
	mexèddr
;

2022 } 
	t¥oxychaööfo_t
;

2026 
	mcomm™d
;

2027 
	m¥Ÿocﬁ
;

2028 
	m¥oxy¥Ÿocﬁ
;

2030 #i‡
HAVE_SOCKS_HOSTID


2036 
ö_addr
 
	mho°idv
[
HAVE_MAX_HOSTIDS
];

2037 
	mho°idc
;

2040 
¥oxychaööfo_t
 
	m¥oxychaö
;

2041 
exãnsi⁄_t
 
	mexãnsi⁄
;

2044 
timevÆ
 
	mac˚±ed
;

2045 
timevÆ
 
	m√gŸüã°¨t
;

2046 
timevÆ
 
	m√gŸüãíd
;

2047 
timevÆ
 
	mªque°íd
;

2048 
timevÆ
 
	me°ablished
;

2049 
timevÆ
 
	mfú°io
;

2050 } 
	mtime
;

2052 c⁄° *
	mt˝öfo
;

2053 } 
	tc⁄√˘i⁄°©e_t
;

2056 
uöt64_t
 
	mbyãs
;

2062 
uöt64_t
 
	m∑ckës
;

2064 
timevÆ
 
	mœ°io
;

2065 } 
	tiocou¡_t
;

2070 
	mcomm™d
;

2075 } 
	tªqöfo_t
;

2078 
	ms
;

2080 
sockaddr_°‹age
 
	mœddr
;

2081 
sockaddr_°‹age
 
	møddr
;

2082 
socksho°_t
 
	møddrho°
;

2084 #i‡
BAREFOOTD


2085 
sockaddr_°‹age
 
	m˛õ¡
;

2086 
socksho°_t
 
	m˛õ¡ho°
;

2091 
ruÀ_t
 
	m¸uÀ
;

2094 
	misc⁄√˘ed
;

2099 
iocou¡_t
 
	m˛õ¡_ªad
;

2100 
iocou¡_t
 
	m˛õ¡_wrôãn
;

2105 
iocou¡_t
 
	mèrgë_ªad
;

2106 
iocou¡_t
 
	mèrgë_wrôãn
;

2108 
timevÆ
 
	mfú°io
;

2109 
timevÆ
 
	mœ°io
;

2110 } 
	tud±¨gë_t
;

2114 
	ms
;

2115 
sockaddr_°‹age
 
	mœddr
;

2116 
sockaddr_°‹age
 
	møddr
;

2118 
authmëhod_t
 
	mauth
;

2119 
socksho°_t
 
	mho°
;

2133 
iocou¡_t
 
	mªad
;

2134 
iocou¡_t
 
	mwrôãn
;

2136 
	mÊags
;

2137 
	mis˛õ¡side
;

2140 
	mÆ¨mdisc⁄√˘d⁄e
;

2141 
	misc⁄√˘ed
;

2142 
	mîr
;

2143 
	mfö_ª˚ived
;

2144 
	mu£_ßved_§uÀ
;

2149 } 
	m°©e
;

2151 #i‡
HAVE_UDP_SUPPORT


2184 
ud±¨gë_t
 *
	md°v
;

2185 
size_t
 
	md°cmax
;

2186 
size_t
 
	md°c
;

2188 } 
	tsockd_io_dúe˘i⁄_t
;

2195 *
	mgsßpid©a
;

2196 
size_t
 
	mgsßpid©Æí
;

2198 *
	msockë›ti⁄d©a
;

2199 
size_t
 
	msockë›td©Æí
;

2200 } 
	tdy«micd©a_t
;

2202 
	#MAX_DYNAMICDATA
() \

2204 
MAX_GSS_STATE
 \

2205 + (
sockë›ti⁄_t
Ë* 
MAX_EXTERNAL_SOCKETOPTIONS
 \

2206 )

	)

2209 
	ssockd_io_t
 {

2210 
	mÆloˇãd
;

2212 
ªqöfo_t
 
	mªqöfo
;

2214 
c⁄√˘i⁄°©e_t
 
	m°©e
;

2215 
authmëhod_t
 
	mˇuth
;

2216 
ªque°Êags_t
 
	mªqÊags
;

2218 
sockd_io_dúe˘i⁄_t
 
	mc⁄åﬁ
;

2219 
sockd_io_dúe˘i⁄_t
 
	m§c
;

2220 
sockd_io_dúe˘i⁄_t
 
	md°
;

2222 
dy«micd©a_t
 
	md©a
;

2228 #i‡
HAVE_NEGOTIATE_PHASE


2229 
	m˛õ¡d©a
[
MAXREQLEN
];

2230 
size_t
 
	m˛õ¡d©Æí
;

2234 
ruÀ_t
 
	m¸uÀ
;

2236 #i‡
HAVE_SOCKS_HOSTID


2237 
	mhruÀ_is£t
;

2238 
ruÀ_t
 
	mhruÀ
;

2241 
ruÀ_t
 
	m§uÀ
;

2243 
sockë›ti⁄_t
 
	mextsockë›ti⁄v
[
MAX_EXTERNAL_SOCKETOPTIONS
];

2244 
size_t
 
	mextsockë›ti⁄c
;

2258 
ruÀ_t
 *
	msfwdruÀ
;

2259 
ruÀ_t
 *
	m§ïlyruÀ
;

2260 } 
	mudp
;

2262 #i‡
SOCKS_SERVER


2269 
socksho°_t
 
	mho°
;

2270 
ruÀ_t
 
	mruÀ
;

2271 } 
	mböd
;

2273 } 
	mcmd
;

2275 
timevÆ
 
	mœ°io
;

2279 
√tw‹kã°_ã°ed_t
 
	möã∫Æ
;

2280 
√tw‹kã°_ã°ed_t
 
	mexã∫Æ
;

2281 } 
	mã°ed
;

2283 
sockd_io_t
 *
	m√xt
;

2284 } 
	tsockd_io_t
;

2288 
ªqöfo_t
 
	mªqöfo
;

2289 
timevÆ
 
	mac˚±ed
;

2291 
	ms
;

2292 
sockaddr_°‹age
 
	m‰om
;

2293 
sockaddr_°‹age
 
	mto
;

2296 #i‡
COVENANT


2304 
	m˛õ¡d©a
[
MAXREQLEN
];

2305 
size_t
 
	m˛õ¡d©Æí
;

2307 
authmëhod_t
 
	mauth
;

2308 
ªque°_t
 
	mªque°
;

2310 } 
	tsockd_˛õ¡_t
;

2312 
	s√gŸüã_°©e_t
 {

2313 
	mcom∂ëe
;

2315 #i‡
SOCKS_SERVER


2316 
	mmem
[ 1

2318 + (
AUTHMETHOD_MAX
 + 1)

2319 #i‡
HAVE_GSSAPI


2320 + 
MAXGSSAPITOKENLEN


2322 + (
ªque°_t
)

2323 + (
authmëhod_t
)

2333 #ñi‡
COVENANT


2335 
	mmem
[
MAXREQLEN
];

2337 
	mhavîeque°ed¥oxyauth
;

2338 
	mhaved⁄îuÀ•îmô
;

2341 
size_t
 
	mªqªad
;

2342 
size_t
 
	m°¨t
;

2343 
	memsg
[512];

2344 
√gŸüã_ªsu…_t
 (*
rcuºít
)(
	ms
,

2345 
ªque°_t
 *
	mªque°
,

2346 
√gŸüã_°©e_t
 *
	m°©e
);

2348 
socksho°_t
 
	m§c
;

2349 
socksho°_t
 
	md°
;

2351 
ruÀ_t
 *
	m¸uÀ
;

2352 #i‡
HAVE_GSSAPI


2353 
	mgsßpôokí_Àn
;

2355 } 
	t√gŸüã_°©e_t
;

2358 
	mÆloˇãd
;

2361 
ªque°_t
 
	mªq
;

2362 
√gŸüã_°©e_t
 
	m√g°©e
;

2364 
ruÀ_t
 
	m¸uÀ
;

2365 
authmëhod_t
 
	mˇuth
;

2367 #i‡
HAVE_SOCKS_HOSTID


2368 
	mhruÀ_is£t
;

2369 
ruÀ_t
 
	mhruÀ
;

2372 #i‡
COVENANT


2373 
ruÀ_t
 
	m§uÀ
;

2375 
authmëhod_t
 
	mßuth
;

2377 
	ms
;

2378 
c⁄√˘i⁄°©e_t
 
	m°©e
;

2379 } 
	tsockd_√gŸüã_t
;

2381 
	ssockd_ªque°_t
 {

2382 
ªqöfo_t
 
	mªqöfo
;

2383 
sockaddr_°‹age
 
	m‰om
;

2384 
sockaddr_°‹age
 
	mto
;

2386 
ªque°_t
 
	mªq
;

2388 
ruÀ_t
 
	m¸uÀ
;

2389 
authmëhod_t
 
	mˇuth
;

2391 #i‡
HAVE_SOCKS_HOSTID


2392 
ruÀ_t
 
	mhruÀ
;

2393 
	mhruÀ_is£t
;

2397 
ruÀ_t
 
	m§uÀ
;

2398 
	m§uÀ_is£t
;

2400 
authmëhod_t
 
	mßuth
;

2402 
	ms
;

2403 
c⁄√˘i⁄°©e_t
 
	m°©e
;

2405 #i‡
HAVE_NEGOTIATE_PHASE


2406 
	m˛õ¡d©a
[
MAXREQLEN
];

2407 
size_t
 
	m˛õ¡d©Æí
;

2409 } 
	tsockd_ªque°_t
;

2413 
	mwaôögf‹exô
;

2423 
	mexôögn‹mÆly
;

2425 
	mack
;

2426 
	ms
;

2428 
pid_t
 
	mpid
;

2429 
	mty≥
;

2431 
time_t
 
	m¸óãd
;

2432 
size_t
 
	m‰ìc
;

2433 
size_t
 
	m£¡c
;

2435 #i‡
BAREFOOTD


2436 
	mhasudp£ssi⁄
;

2441 } 
	tsockd_chûd_t
;

2451 
	mloˇl_is£t
;

2452 
socksho°_t
 
	mloˇl
;

2454 
	m≥î_is£t
;

2455 
socksho°_t
 
	m≥î
;

2460 
	mauth_is£t
;

2461 
authmëhod_t
 
	mauth
;

2463 #i‡
HAVE_SOCKS_HOSTID


2469 
ö_addr
 
	mho°idv
[
HAVE_MAX_HOSTIDS
];

2470 
	mho°idc
;

2472 } 
	tiﬁogaddr_t
;

2475 
io_upd©em⁄ô‹
(
sockd_io_t
 *
io
);

2481 
io_add_Æ¨mdisc⁄√˘s
(
sockd_io_t
 *
io
, c⁄° *
ªas⁄
);

2489 
io_upd©e
(c⁄° 
timevÆ
 *
timíow
, c⁄° 
size_t
 
bwu£d
,

2490 c⁄° 
iocou¡_t
 *
öã∫Æ_ªad
, c⁄° iocou¡_à*
öã∫Æ_wrôãn
,

2491 c⁄° 
iocou¡_t
 *
exã∫Æ_ªad
, c⁄° iocou¡_à*
exã∫Æ_wrôãn
,

2492 
ruÀ_t
 *
ruÀ
,ÑuÀ_à*
∑ckëruÀ
, c⁄° 
lock
, c⁄° 
uöt32_t
 
uid
);

2508 
io°©us_t


2509 
doio_t˝
(
sockd_io_t
 *
io
, 
fd_£t
 *
r£t
, fd_£à*
w£t
,

2510 c⁄° 
Êags
, *
badfd
);

2525 #i‡
HAVE_UDP_SUPPORT


2527 
io°©us_t


2528 
doio_udp
(
sockd_io_t
 *
io
, 
fd_£t
 *
r£t
, *
badfd
);

2537 
io°©us_t


2538 
io_∑ckë_ª˚ived
(c⁄° 
ªcv‰om_öfo_t
 *
ªcvÊags
,

2539 c⁄° 
size_t
 
byã§e˚ived
,

2540 c⁄° 
sockaddr_°‹age
 *
‰om
,

2541 c⁄° 
sockaddr_°‹age
 *
ª˚ived⁄
);

2555 
io°©us_t


2556 
io_∑ckë_£¡
(c⁄° 
size_t
 
byã°o£nd
,

2557 c⁄° 
size_t
 
byãs£¡
,

2558 c⁄° 
timevÆ
 *
t§e˚ived
,

2559 c⁄° 
sockaddr_°‹age
 *
‰om
,

2560 c⁄° 
sockaddr_°‹age
 *
to
,

2561 *
emsg
, 
size_t
 
emsgÀn
);

2579 
ö_p‹t_t
 *
udphdr_uh_dp‹t
(
udphdr
 *
udp
);

2580 
ö_p‹t_t
 *
udphdr_uh_•‹t
(
udphdr
 *
udp
);

2581 
uöt16_t
 *
udphdr_uh_uÀn
(
udphdr
 *
udp
);

2582 
uöt16_t
 *
udphdr_uh_sum
(
udphdr
 *
udp
);

2590 
ud±¨gë_t
 *

2591 
˛õ¡ofsockë
(c⁄° 
s
, c⁄° 
size_t
 
udp˛õ¡c
,

2592 
ud±¨gë_t
 *
udp˛õ¡v
);

2599 
io_syncudp
(
sockd_io_t
 *
io
, 
ud±¨gë_t
 *
udp˛õ¡
);

2609 
io_syncudpd°
(
sockd_io_dúe˘i⁄_t
 *
d°
, c⁄° 
ud±¨gë_t
 *
ud±¨gë
);

2616 
io_syncudp§c
(
sockd_io_dúe˘i⁄_t
 *
§c
, c⁄° 
ud±¨gë_t
 *
udp˛õ¡
);

2621 #i‡
BAREFOOTD


2623 
øwsockë°©us_t


2624 
øwsockë_ªcv
(c⁄° 
s
, c⁄° 
size_t
 
ioc
, 
sockd_io_t
 
iov
[]);

2631 
ªmove˛õ¡
(c⁄° 
s
, 
size_t
 *
˛õ¡c
, 
ud±¨gë_t
 *
˛õ¡v
);

2640 
ud±¨gë_t
 *

2641 
˛õ¡of˛õ¡addr
(c⁄° 
sockaddr_°‹age
 *
addr
,

2642 c⁄° 
size_t
 
udp˛õ¡c
, 
ud±¨gë_t
 *
udp˛õ¡v
);

2650 
size_t


2651 
io_udp˛õ¡s
(c⁄° 
size_t
 
ioc
, c⁄° 
sockd_io_t
 
iov
[], c⁄° 
ssize_t
 
möcou¡
);

2661 #i‡
HAVE_SO_TIMESTAMP


2663 
io_addts
(c⁄° 
timevÆ
 *
ts
, c⁄° 
sockaddr_°‹age
 *
‰om
,

2664 c⁄° 
sockaddr_°‹age
 *
to
);

2674 
timevÆ
 *

2675 
io_ˇlcuœãœãncy
(c⁄° 
timevÆ
 *
ts_ªcv
, c⁄° timevÆ *
äow
,

2676 
timevÆ
 *
œãncy
);

2688 
io°©_t
 *
io_gë_ro_°©s
();

2689 
io°©_t
 *
io_gë_io_°©s
();

2698 
£nd_icm≥º‹
(c⁄° 
s
, c⁄° 
sockaddr_°‹age
 *
ª˚ived⁄addr
,

2699 c⁄° 
sockaddr_°‹age
 *
‹igöÆ∑ckë§c
,

2700 c⁄° 
sockaddr_°‹age
 *
∑ckëèrgë
,

2701 c⁄° 
ùÀn
, c⁄° 
ud∂í
,

2702 c⁄° 
ty≥
, c⁄° 
code
);

2727 
ud±¨gë_t
 *

2728 
öô˛õ¡
(c⁄° 
c⁄åﬁ
,

2729 c⁄° 
sockaddr_°‹age
 *
˛õ¡_œddr
,

2730 c⁄° 
sockaddr_°‹age
 *
˛õ¡_øddr
,

2731 c⁄° 
socksho°_t
 *
toho°
,

2732 c⁄° 
sockaddr_°‹age
 *
tﬂddr
, c⁄° 
ruÀ_t
 *
ruÀ
,

2733 *
emsg
, c⁄° 
size_t
 
emsgÀn
, 
ud±¨gë_t
 *
˛õ¡
);

2757 
ud±¨gë_t
 *

2758 
add˛õ¡
(c⁄° 
sockaddr_°‹age
 *
˛õ¡œddr
,

2759 c⁄° 
ud±¨gë_t
 *
˛õ¡
,

2760 
size_t
 *
˛õ¡c
, size_à*
max˛õ¡c
, 
ud±¨gë_t
 **
˛õ¡v
,

2761 c⁄° 
c⁄√˘i⁄°©e_t
 *
°©e
, c⁄° 
ruÀ_t
 *
ruÀ
);

2778 
‰ìdes¸ùt‹s
(c⁄° *
mesßge
, *
highe°fdöu£
);

2789 
sockd_unc⁄√˘
(c⁄° 
s
, c⁄° 
sockaddr_°‹age
 *
ﬁd≥î
);

2802 
sockd_r°⁄˛o£
(c⁄° 
s
);

2811 
bödöã∫Æ
(c⁄° 
¥Ÿocﬁ
);

2819 
pidismŸhî
(
pid_t
 
pid
);

2827 
pidismaömŸhî
(
pid_t
 
pid
);

2834 
sockd_mŸhîexi°s
();

2844 
des¸ùt‹i§e£rved
(
d
);

2851 
size_t


2852 
chûdcheck
(
ty≥
);

2867 
chûdty≥
(c⁄° 
pid_t
 
pid
);

2873 
ªmovechûd
(c⁄° 
pid_t
 
chûdpid
);

2880 
˛o£chûd
(c⁄° 
pid_t
 
chûdpid
, c⁄° 
i¢‹mÆexô
);

2895 
£tcomm™d¥Ÿocﬁ
(c⁄° 
obje˘ty≥_t
 
ty≥
, 
comm™d_t
 *
comm™ds
,

2896 
¥Ÿocﬁ_t
 *
¥Ÿocﬁs
);

2903 
ruÀ_t
 *

2904 
add˛õ¡ruÀ
(c⁄° 
ruÀ_t
 *
ruÀ
);

2910 #i‡
HAVE_SOCKS_HOSTID


2912 
ho°idm©ches
(c⁄° 
size_t
 
ho°idc
, c⁄° 
ö_addr
 *
ho°idv
,

2913 c⁄° 
ho°ödex
, c⁄° 
ruÀaddr_t
 *
addr
,

2914 c⁄° 
obje˘ty≥_t
 
ty≥
, c⁄° 
size_t
 
numbî
);

2921 
ruÀ_t
 *

2922 
addho°idruÀ
(c⁄° 
ruÀ_t
 *
ruÀ
);

2930 
ruÀ_t
 *

2931 
addsock§uÀ
(c⁄° 
ruÀ_t
 *
ruÀ
);

2938 
‰ìruÀli°
(
ruÀ_t
 *
ruÀhód
);

2945 
addöã∫Æ
(c⁄° 
ruÀaddr_t
 *
addr
, c⁄° 
¥Ÿocﬁ
);

2952 
addexã∫Æ
(c⁄° 
ruÀaddr_t
 *
addr
);

2959 
exã∫Æ_£t_ßÁmûy
(*
hasùv4
, *
hasùv6
,

2960 *
hasùv6_globÆ_sc›e
);

2985 
ö_addr
 *

2986 
ùv4_m≠≥d_to_ªguœr
(c⁄° 
ö6_addr
 *
ùv4_m≠≥d
,

2987 
ö_addr
 *
ùv4_ªguœr
);

2996 
add_öã∫Æ_ßÁmûy
(c⁄° 
ß_Ámûy_t
 
ßÁmûy
);

3003 
öã∫Æ_has_ßÁmûy
(c⁄° 
ß_Ámûy_t
 
ßÁmûy
);

3012 
add_exã∫Æ_ßÁmûy
(c⁄° 
ß_Ámûy_t
 
ßÁmûy
, c⁄° 
globÆsc›e
);

3022 
exã∫Æ_has_ßÁmûy
(c⁄° 
ß_Ámûy_t
 
ßÁmûy
);

3031 
exã∫Æ_has_⁄ly_ßÁmûy
(c⁄° 
ß_Ámûy_t
 
ßÁmûy
);

3041 
exã∫Æ_has_globÆ_ßÁmûy
(c⁄° 
ß_Ámûy_t
 
ßÁmûy
);

3052 
addrisbödabÀ
(c⁄° 
ruÀaddr_t
 *
addr
);

3061 
i§ïlycomm™d⁄ly
(c⁄° 
comm™d_t
 *
comm™d
);

3068 
ha§ïlycomm™ds
(c⁄° 
comm™d_t
 *
comm™d
);

3076 
löked«me_t
 *

3077 
addlöked«me
(
löked«me_t
 **
löked«me
, c⁄° *
«me
);

3086 
‰ìlöked«me
(
löked«me_t
 *
lök
);

3092 
showruÀ
(c⁄° 
ruÀ_t
 *
ruÀ
, c⁄° 
obje˘ty≥_t
 
ruÀty≥
);

3099 
ruÀ_dëach‰omli°
(
ruÀ_t
 *
hód
);

3105 
showm⁄ô‹
(c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
);

3111 
showli°
(c⁄° 
löked«me_t
 *
li°
, c⁄° *
¥efix
);

3117 
showlog•ecül
(c⁄° 
log•ecül_t
 *
log
, c⁄° 
öãrÁ˚side_t
 
isöã∫Æside
);

3125 
auth«me
(c⁄° 
authmëhod_t
 *
auth
);

3131 
	$authöfo
(c⁄° 
authmëhod_t
 *
auth
, *
öfo
, 
size_t
 
öfﬁí
)

3132 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

3139 
	`ruÀ_öhîô‹u£
(
ruÀ_t
 *
‰om
, c⁄° 
˛õ¡öfo_t
 *
cöfo_‰om
,

3140 
ruÀ_t
 *
to
, c⁄° 
˛õ¡öfo_t
 *
cöfo
,

3141 c⁄° 
size_t
 
sidesc⁄√˘ed
,

3142 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

3165 
	$ruÀ•îmô
(
s
, c⁄° 
sockaddr_°‹age
 *
≥î
,

3166 c⁄° 
sockaddr_°‹age
 *
loˇl
,

3167 c⁄° 
authmëhod_t
 *
˛õ¡auth
,áuthmëhod_à*
§ˇuth
,

3168 
ruÀ_t
 *
ruÀ
, 
c⁄√˘i⁄°©e_t
 *
°©e
,

3169 c⁄° 
socksho°_t
 *
§c
, c⁄° socksho°_à*
d°
,

3170 
socksho°_t
 *
d°m©ched
,

3171 *
msg
, 
size_t
 
msgsize
)

3172 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 11, 12)));

3215 
	`comm™d_m©ches
(c⁄° 
comm™d
, c⁄° 
comm™d_t
 *
comm™ds
);

3222 
	`¥Ÿocﬁ_m©ches
(c⁄° 
¥Ÿocﬁ
, c⁄° 
¥Ÿocﬁ_t
 *
¥Ÿocﬁs
);

3229 
	`¥oxy¥Ÿocﬁ_m©ches
(c⁄° 
¥Ÿocﬁ
, c⁄° 
¥oxy¥Ÿocﬁ_t
 *
¥Ÿocﬁs
);

3237 
	`sockd_c⁄√˘
(
s
, c⁄° 
socksho°_t
 *
d°
);

3246 
	`shmem2c⁄fig
(c⁄° 
c⁄fig
 *
ﬁd
, c⁄fig *
√w
);

3260 
	`poöãr_‰ì
(
c⁄fig
 *config);

3265 
size_t


3266 
	`poöãr_size
(
c⁄fig
 *config);

3278 
	`poöãr_c›y
(
c⁄fig
 *
§c
, c⁄° 
±rdiff_t
 
§˝åoff£t
,

3279 
c⁄fig
 *
d°
, *
mem
, c⁄° 
size_t
 
memsize
);

3301 
size_t


3302 
	`com∑ªc⁄figs
(c⁄° 
c⁄fig
 *
a
, c⁄° c⁄fig *
b
);

3315 
	`£nd_ªq
(
s
, 
sockd_ªque°_t
 *
ªq
);

3324 
	`£nd_˛õ¡
(
s
, c⁄° 
sockd_˛õ¡_t
 *
˛õ¡
,

3325 c⁄° *
ªq
, c⁄° 
size_t
 
ªqÀn
);

3342 
	`£À˘mëhod
(c⁄° *
mëhodv
, c⁄° 
size_t
 
mëhodc
,

3343 c⁄° *
of„ªdv
, c⁄° 
size_t
 
of„ªdc
);

3353 
√gŸüã_ªsu…_t


3354 
	`mëhod_u«me
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

3367 #i‡
HAVE_GSSAPI


3368 
√gŸüã_ªsu…_t


3369 
	`mëhod_gsßpi
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

3391 
	`sockd_‰ìlogobje˘
(
logty≥_t
 *
logobje˘
, c⁄° 
˛o£too
);

3398 
	`sockd_ª›ílogfûes
(
logty≥_t
 *
log
, c⁄° 
do˛o£ﬁd
);

3405 
	`logÀvñ_î∫o
(c⁄° 
e
, c⁄° 
öãrÁ˚side_t
 
side
);

3406 
	`logÀvñ_gaõº
(c⁄° 
e
, c⁄° 
öãrÁ˚side_t
 
side
);

3418 
	`î∫ovÆue
(c⁄° *
symbﬁ
);

3431 
	`gaivÆue
(c⁄° *
symbﬁ
);

3444 
iﬁogaddr_t
 *

3445 
	`öô_iﬁogaddr
(
iﬁogaddr_t
 *
addr
,

3446 c⁄° 
obje˘ty≥_t
 
loˇl_ty≥
, c⁄° *
loˇl
,

3447 c⁄° 
obje˘ty≥_t
 
≥î_ty≥
, c⁄° *
≥î
,

3448 c⁄° 
authmëhod_t
 *
auth
,

3449 c⁄° 
ö_addr
 *
ho°idv
, c⁄° 
ho°idc
);

3460 
	`iﬁog
(c⁄° 
ruÀ_t
 *
ruÀ
, c⁄° 
c⁄√˘i⁄°©e_t
 *
°©e
, c⁄° 
›î©i⁄_t
 
›
,

3461 c⁄° 
iﬁogaddr_t
 *
§c
, c⁄° iﬁogaddr_à*
d°
,

3462 c⁄° 
iﬁogaddr_t
 *
to§c_¥oxy
, c⁄° iﬁogaddr_à*
tod°_¥oxy
,

3463 c⁄° *
d©a
, 
size_t
 
d©Æí
);

3483 
	`buûd_addr°r_§c
(c⁄° 
ö_addr
 *
ho°idv
, c⁄° 
ho°idc
,

3484 c⁄° 
socksho°_t
 *
≥î
, c⁄° socksho°_à*
¥oxy_ext
,

3485 c⁄° 
socksho°_t
 *
¥oxy
, c⁄° socksho°_à*
loˇl
,

3486 c⁄° 
authmëhod_t
 *
≥îauth
, c⁄°áuthmëhod_à*
¥oxyauth
,

3487 *
°r
, 
size_t
 
°rsize
);

3490 
	`buûd_addr°r_d°
(c⁄° 
socksho°_t
 *
loˇl
, c⁄° socksho°_à*
¥oxy
,

3491 c⁄° 
socksho°_t
 *
¥oxy_ext
, c⁄° socksho°_à*
≥î
,

3492 c⁄° 
authmëhod_t
 *
≥îauth
, c⁄°áuthmëhod_à*
¥oxyauth
,

3493 c⁄° 
ö_addr
 *
ho°idv
, c⁄° 
ho°idc
,

3494 *
°r
, 
size_t
 
°rsize
);

3497 
	`io_dñëe
(
mŸhî
, 
sockd_io_t
 *
io
, 
fd
, c⁄° 
io°©us_t
 
°©us
);

3507 
	`˛o£_iodes¸ùt‹s
(c⁄° 
sockd_io_t
 *
io
);

3514 
	`sockd√gŸüã
(
s
);

3523 
	`run_m⁄ô‹
();

3529 
	`run_io
();

3538 
	`run_√gŸüã
();

3546 
	`run_ªque°
();

3553 
	`mŸhî_¥ec⁄figlﬂd
();

3554 
	`m⁄ô‹_¥ec⁄figlﬂd
();

3555 
	`√gŸüã_¥ec⁄figlﬂd
();

3556 
	`ªque°_¥ec⁄figlﬂd
();

3557 
	`io_¥ec⁄figlﬂd
();

3559 
	`mŸhî_po°c⁄figlﬂd
();

3560 
	`m⁄ô‹_po°c⁄figlﬂd
();

3561 
	`√gŸüã_po°c⁄figlﬂd
();

3562 
	`ªque°_po°c⁄figlﬂd
();

3563 
	`io_po°c⁄figlﬂd
();

3568 
	`dëach_‰om_shmem
();

3575 
	`mŸhî_ív£tup
(
¨gc
, *
¨gv
[]);

3582 
	`mŸhî_gëlimôöfo
();

3588 
	`log_rußge
(c⁄° 
chûdty≥
, c⁄° 
pid_t
 
pid
, c⁄° 
rußge
 *rusage);

3598 
	`checkc⁄fig
();

3606 
	`£nd_io
(
s
, 
sockd_io_t
 *
io
);

3616 
	`ªcv_io
(
mŸhî
, 
sockd_io_t
 *
io
);

3626 
	`ªcv_ªq
(
s
, 
sockd_ªque°_t
 *
ªq
);

3634 
√gŸüã_ªsu…_t


3635 
	`ªcv_˛õ¡ªque°
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

3644 
√gŸüã_ªsu…_t


3645 
	`ªcv_sock•ackë
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

3652 
	`dißbÀ_chûd¸óã
(
îr
, c⁄° *
ªas⁄
);

3659 
	`íabÀ_chûd¸óã
();

3665 
sockd_chûd_t
 *

3666 
	`gëchûd
(
pid_t
 
pid
);

3675 
	`sigchûdbrﬂdˇ°
(
sig
);

3681 
	`fûl£t
(
fd_£t
 *
£t
, 
size_t
 *
√gc
, size_à*
ªqc
, size_à*
ioc
);

3691 
	`˛ór£t
(
whichpùe_t
 
ty≥
, c⁄° 
sockd_chûd_t
 *
chûd
, 
fd_£t
 *
£t
);

3698 
	`˛órchûdty≥
(c⁄° 
chûdty≥
, 
whichpùe_t
 
pùëy≥
,

3699 c⁄° 
nfds
, 
fd_£t
 *
£t
);

3704 
sockd_chûd_t
 *

3705 
	`gë£t
(
whichpùe_t
 
ty≥
, 
fd_£t
 *
£t
);

3714 
sockd_chûd_t
 *

3715 
	`√xtchûd
(c⁄° 
ty≥
, c⁄° 
¥Ÿocﬁ
);

3723 #i‡
HAVE_SCHED_SETAFFINITY


3728 
size_t


3729 
	`˝u_gë_£tsize
();

3732 
	`˝u_£t
(c⁄° 
˝u
, 
˝u_£t_t
 *
£t
);

3735 
	`˝u_zîo
(
˝u_£t_t
 *
£t
);

3738 
	`˝u_is£t
(c⁄° 
˝u
, c⁄° 
˝u_£t_t
 *
£t
);

3741 
	`˝u_equÆ
(c⁄° 
˝u_£t_t
 *
£t1
, c⁄° cpu_£t_à*
£t2
);

3744 
	`˝u_gëafföôy
(
pid_t
 
pid
, 
size_t
 
˝u£tsize
, 
˝u_£t_t
 *
mask
);

3747 
	`˝u_£èfföôy
(
pid_t
 
pid
, 
size_t
 
˝u£tsize
, c⁄° 
˝u_£t_t
 *
mask
);

3750 
	`sockd_˝u£t_isok
(c⁄° 
˝u_£t_t
 *
£t
);

3757 #i‡
HAVE_SCHED_SETSCHEDULER


3760 
	`˝upﬁicy2numîic
(*
«me
);

3766 
	`numîic2˝upﬁicy
(
vÆue
);

3774 
	`sockd_£t˝u£âögs
(c⁄° 
˝u£âög_t
 *
ﬁd
, c⁄° cpu£âög_à*
√w
);

3784 
	`£tsock›ti⁄s
(c⁄° 
s
, c⁄° 
ß_Ámûy_t
 
Ámûy
, c⁄° 
ty≥
,

3785 c⁄° 
is˛õ¡side
);

3796 
	$sockdexô
(c⁄° 
exôcode
)

3797 
	`__ATTRIBUTE__
((
n‹ëu∫
));

3808 
ho°ít
 *

3809 
	`cgëho°by«me
(c⁄° *
«me
);

3811 
ho°ít
 *

3812 
	`cgëho°byaddr
(c⁄° *
addr
, 
sockÀn_t
 
Àn
, 
ty≥
);

3815 
	`cgë«meöfo
(c⁄° 
sockaddr
 *
addr
, c⁄° 
sockÀn_t
 
addæí
,

3816 *
ho°
, c⁄° 
sockÀn_t
 
ho°Àn
, *
£rvi˚
,

3817 c⁄° 
sockÀn_t
 
£rvi˚Àn
, c⁄° 
Êags
);

3820 
	`cgëaddröfo
(c⁄° *
«me
, c⁄° *
£rvi˚
,

3821 c⁄° 
addröfo
 *
höts
, addröfÿ**
ªs
,

3822 
dnsöfo_t
 *
ªsmem
);

3830 #i‡!
HAVE_PRIVILEGES


3832 
	`sockd_£ãugid
(c⁄° 
uid_t
 
uid
, c⁄° 
gid_t
 
gid
);

3842 
	`sockd_öô¥ivs
();

3849 
	`sockd_¥iv
(c⁄° 
¥ivûege_t
 
¥ivûege
, c⁄° 
¥iv_›_t
 
›
);

3858 
	`ª£çrivûeges
();

3866 
	`u£rm©ch
(c⁄° 
authmëhod_t
 *
auth
, c⁄° 
löked«me_t
 *
u£æi°
);

3876 
	`groupm©ch
(c⁄° 
authmëhod_t
 *
auth
, c⁄° 
löked«me_t
 *
grou∂i°
);

3884 #i‡
HAVE_LDAP


3886 
	`ld≠groupm©ch
(c⁄° 
authmëhod_t
 *
auth
, c⁄° 
ruÀ_t
 *
ruÀ
);

3896 
	`ld≠groupm©ches
(c⁄° *
u£∫ame
, c⁄° *
u£rdomaö
,

3897 c⁄° *
group
, c⁄° *
groupdomaö
,

3898 c⁄° 
ruÀ_t
 *
ruÀ
);

3906 
	`ˇche_ld≠_u£r
(c⁄° *
u£∫ame
, 
ªsu…
);

3914 
	`ld≠_u£r_is_ˇched
(c⁄° *
u£∫ame
);

3923 *
	`asciôoutf8
(*
öput
);

3929 *
	`hextoutf8
(c⁄° *
öput
, 
Êag
);

3941 
	`medtv
(
timevÆ
 *
tv¨r
, 
size_t
 
tvsize
);

3948 
	`avgtv
(
timevÆ
 *
tv¨r
, 
size_t
 
tvsize
);

3955 
	`°ddevtv
(
timevÆ
 *
tv¨r
, 
size_t
 
tvsize
, 
avg
);

3962 
	$ac˚sscheck
(
s
, 
authmëhod_t
 *
auth
, c⁄° 
sockaddr_°‹age
 *
§c
,

3963 c⁄° 
sockaddr_°‹age
 *
d°
, *
emsg
, 
size_t
 
emsgsize
)

3964 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 5, 6)));

3980 
	$∑ssw‹dcheck
(c⁄° *
«me
, c⁄° *
˛óπexçassw‹d
,

3981 *
emsg
, 
size_t
 
emsgÀn
)

3982 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 3, 4)));

3997 
	$∑m_∑ssw‹dcheck
(
s
,

3998 c⁄° 
sockaddr_°‹age
 *
§c
, c⁄° sockaddr_°‹agê*
d°
,

3999 c⁄° 
authmëhod_∑m_t
 *
auth
, *
emsg
, 
size_t
 
emsgÀn
)

4000 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 5, 6)));

4012 
	$bsdauth_∑ssw‹dcheck
(
s
,

4013 c⁄° 
sockaddr_°‹age
 *
§c
, c⁄° sockaddr_°‹agê*
d°
,

4014 
authmëhod_bsd_t
 *
auth
, *
emsg
, 
size_t
 
emsgsize
)

4015 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 5, 6)));

4027 
	`ªdúe˘£tup
();

4034 
	`ªdúe˘
(
s
, 
sockaddr_°‹age
 *
addr
,

4035 #i‡!
BAREFOOTD


4036 
socksho°_t
 *
ho°
,

4038 
comm™d
, c⁄° 
ruÀaddr_t
 *
‰om


4039 #i‡!
BAREFOOTD


4040 , c⁄° 
ruÀaddr_t
 *
to


4082 
	`ho°ˇche£tup
();

4089 
	`ho°ˇcheövÆid©e
();

4095 
	`ld≠ˇche£tup
();

4102 
	`sockd_gëshmem«me
(c⁄° 
id
, c⁄° 
°©ekey_t
 
key
);

4108 
	`sockd_shmdt
(
ruÀ_t
 *
ruÀ
, c⁄° 
which
);

4115 
	`sockd_shm©
(
ruÀ_t
 *
ruÀ
, 
which
);

4129 
	`shmem_£tup
();

4135 
	`shmem_idupd©e
(
c⁄fig
 *config);

4143 
	`shmem_Æloc
(c⁄° 
size_t
 
Àn
, c⁄° 
key_t
 
key
);

4150 
	`shmem_unu£
(
shmem_obje˘_t
 *
obje˘
, c⁄° 
˛õ¡öfo_t
 *
cöfo
, 
lock
);

4159 
	`shmem_u£
(
shmem_obje˘_t
 *
obje˘
, c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
,

4160 c⁄° 
m≠is›í
);

4173 
	`shmem_u£ruÀ
(
ruÀ_t
 *
ruÀ
, c⁄° 
˛õ¡öfo_t
 *
cöfo
, *
emsg
,

4174 c⁄° 
size_t
 
emsgÀn
);

4182 
	`m⁄ô‹_u£
(
shmem_obje˘_t
 *
°©s
, c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
);

4189 
	`m⁄ô‹_unu£
(
shmem_obje˘_t
 *
°©s
, c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
);

4197 
	`m⁄ô‹_sync
(
shmem_obje˘_t
 *
Æ¨m
, c⁄° 
shmid
,

4198 c⁄° 
size_t
 
Æ¨msc⁄figuªd
, c⁄° size_à
sidesc⁄√˘ed
,

4199 c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
);

4209 
	`Æ¨m_öhîô
(
ruÀ_t
 *
‰om
, c⁄° 
˛õ¡öfo_t
 *
cöfo_‰om
,

4210 
ruÀ_t
 *
to
, c⁄° 
˛õ¡öfo_t
 *
cöfo_to
,

4211 c⁄° 
size_t
 
sidesc⁄√˘ed
);

4220 
	`Æ¨m_add_c⁄√˘
(
ruÀ_t
 *
Æ¨m
, c⁄° 
size_t
 
sides
,

4221 c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
, c⁄° 
sockd_io_t
 *
io
);

4229 
	`Æ¨m_add_disc⁄√˘
(c⁄° 
we˛o£dfú°
, 
ruÀ_t
 *
Æ¨m
,

4230 c⁄° 
size_t
 
sides
, c⁄° 
˛õ¡öfo_t
 *
cöfo
,

4231 c⁄° *
ªas⁄
, c⁄° 
lock
);

4243 
	`Æ¨m_ªmove_£ssi⁄
(
ruÀ_t
 *
Æ¨m
, c⁄° 
size_t
 
sides
,

4244 c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
);

4255 
	`sockd_mm≠
(*
ﬁdm≠
, 
size_t
 
size
, c⁄° 
¥Ÿ
, c⁄° 
Êags
,

4256 c⁄° 
fd
, c⁄° 
do¸óã
);

4272 
ssize_t


4273 
	`key°©e_ödex
(
shmem_obje˘_t
 *
shmem
, c⁄° 
˛õ¡öfo_t
 *
cöfo
,

4274 c⁄° 
expúeﬁdtoo
);

4283 
	`key°©e_›ím≠
(c⁄° 
id
, 
key°©e_t
 *
key°©e
,

4284 
size_t
 *
sizem≠≥d
);

4298 
	`key°©e_˛o£m≠
(c⁄° 
id
, 
key°©e_t
 *
key°©e
,

4299 c⁄° 
size_t
 
m≠≥dsize
, c⁄° 
ssize_t
 
ch™gedödex
);

4310 
	`key°©e_ha£xpúed
(c⁄° 
shmem_obje˘_t
 *
shmem
, c⁄° 
size_t
 
keyödex
,

4311 c⁄° 
timevÆ
 *
timíow
);

4321 
	`disc⁄√˘Æ¨m_u£
(
shmem_obje˘_t
 *
disc⁄√˘Æ¨m
, c⁄° 
˛õ¡öfo_t
 *
cöfo
,

4322 c⁄° 
lock
);

4329 
	`disc⁄√˘Æ¨m_unu£
(
shmem_obje˘_t
 *
disc⁄√˘Æ¨m
,

4330 c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
);

4336 
	`bw_u£
(
shmem_obje˘_t
 *
bw
, c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
);

4342 
	`bw_unu£
(
shmem_obje˘_t
 *
bw
, c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
);

4348 
ssize_t


4349 
	`bw_À·
(c⁄° 
shmem_obje˘_t
 *
bw
, c⁄° 
lock
);

4356 
	`bw_upd©e
(
shmem_obje˘_t
 *
bw
, 
size_t
 
bwu£d
, c⁄° 
timevÆ
 *
bwu£dtime
,

4357 c⁄° 
lock
);

4364 
	`bw_ruÀhasovîÊown
(c⁄° 
ruÀ_t
 *
ruÀ
, c⁄° 
timevÆ
 *
äow
,

4365 
timevÆ
 *
ovîÊowok
);

4377 
	`£ssi⁄_u£
(
shmem_obje˘_t
 *
ss
, c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
,

4378 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

4387 
	`£ssi⁄_unu£
(
shmem_obje˘_t
 *
ss
, c⁄° 
˛õ¡öfo_t
 *
cöfo
, c⁄° 
lock
);

4395 
	`checkmoduÀ
(c⁄° *
«me
);

4402 
	`li˚n£key2°rög
(c⁄° 
li˚n£key_t
 *
key
);

4410 
	`sockd_h™dÀdsig«ls
();

4419 
sockaddr_°‹age
 *

4420 
	`gëouèddr
(
sockaddr_°‹age
 *
œddr
,

4421 c⁄° 
sockaddr_°‹age
 *
˛õ¡_œddr
,

4422 c⁄° 
sockaddr_°‹age
 *
˛õ¡_øddr
,

4423 c⁄° 
comm™d
, c⁄° 
socksho°_t
 *
ªque°
,

4424 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

4441 
sockaddr_°‹age
 *

4442 
	`gëöaddr
(
sockaddr_°‹age
 *
œddr
,

4443 c⁄° 
sockaddr_°‹age
 *
˛õ¡
,

4444 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

4459 
	`sig£rvîbrﬂdˇ°
(
sig
);

4466 
	`sockd_pushsig«l
(c⁄° 
sig
, c⁄° 
sigöfo_t
 *
sigöfo
);

4473 
	`sockd_p›sig«l
(
sigöfo_t
 *
sigöfo
);

4479 
ùv6_addrsc›e_t


4480 
	`ùv6_addrsc›e
(c⁄° 
ö6_addr
 *
addr
);

4486 
	`sockd_gëmaˇddr
(c⁄° *
i‚ame
, *
maˇddr
);

4494 
ssize_t


4495 
	`addrödex_⁄_li°íli°
(c⁄° 
size_t
 
li°c
, c⁄° 
li°íaddªss_t
 *
li°v
,

4496 c⁄° 
sockaddr_°‹age
 *
addr
,

4497 c⁄° 
¥Ÿocﬁ
);

4506 
ssize_t


4507 
	`addrödex_⁄_exã∫Æli°
(c⁄° 
exã∫Æaddªss_t
 *
exã∫Æ
,

4508 c⁄° 
sockaddr_°‹age
 *
addr
);

4517 
size_t


4518 
	`max‰ì¶Ÿs
(c⁄° 
chûdty≥
);

4525 
	`sockd_¥öt_chûd_ªady_mesßge
(c⁄° 
size_t
 
‰ìfds
);

4532 
	`mëhodˇ≈rovide
(c⁄° 
mëhod
, c⁄° 
mëhodöfo_t
 
wh©
);

4540 
	`mëhodw‹kswôh
(c⁄° 
mëhod
, c⁄° 
mëhodöfo_t
 
wh©
);

4547 
	`ruÀªquúes
(c⁄° 
ruÀ_t
 *
ruÀ
, c⁄° 
mëhodöfo_t
 
wh©
);

4555 
	`sighup_chûd
(
sig
, 
sigöfo_t
 *
si
, *
sc
);

4561 
	`io_h™dÀsighup
();

4567 
	`sockd_check_ù˛©ícy
(c⁄° *
des¸ùti⁄
,

4568 c⁄° 
timevÆ
 *
t£¡
,

4569 c⁄° 
timevÆ
 *
åe˚ived
,

4570 c⁄° 
timevÆ
 *
äow
);

4598 
size_t
 
‰ìfds
;

4604 
havec⁄√˘ö¥ogªss
;

4606 } 
	tio°©e_t
;

4609 #i‡
BAREFOOTD


4612 
	`upd©e_˛õ¡poöãrs
(c⁄° 
size_t
 
d°c
, 
ud±¨gë_t
 *
d°v
);

4618 
	`io_ªmove_£ssi⁄
(c⁄° 
size_t
 
ioc
, 
sockd_io_t
 *
iov
,

4619 c⁄° 
sockaddr_°‹age
 *
œddr
, c⁄° 
¥Ÿocﬁ
,

4620 c⁄° 
io°©us_t
 
ªas⁄
);

4633 
io°©us_t


4634 
	`io_udp_˛õ¡2èrgë
(
sockd_io_dúe˘i⁄_t
 *
ö
, sockd_io_dúe˘i⁄_à*
out
,

4635 c⁄° 
authmëhod_t
 *
ˇuth
, 
c⁄√˘i⁄°©e_t
 *
°©e
,

4636 
iﬁogaddr_t
 *
§c
, iﬁogaddr_à*
d°
,

4637 *
bad
, 
ruÀ_t
 *
∑ckëruÀ
, 
size_t
 *
bwu£d
);

4659 
io°©us_t


4660 
	`io_udp_èrgë2˛õ¡
(
sockd_io_dúe˘i⁄_t
 *
ö
,

4661 
sockd_io_dúe˘i⁄_t
 *
out
,

4662 c⁄° 
authmëhod_t
 *
ˇuth
,

4663 
c⁄√˘i⁄°©e_t
 *
°©e
,

4664 
iﬁogaddr_t
 *
§c
, iﬁogaddr_à*
d°
,

4665 *
bad
, 
ruÀ_t
 *
∑ckëruÀ
, 
size_t
 *
bwu£d
);

4671 #ñi‡
SOCKS_SERVER


4673 
io°©us_t


4674 
	`io_udp_˛õ¡2èrgë
(
sockd_io_dúe˘i⁄_t
 *
c⁄åﬁ
, sockd_io_dúe˘i⁄_à*
ö
,

4675 
sockd_io_dúe˘i⁄_t
 *
out
, c⁄° 
authmëhod_t
 *
ˇuth
,

4676 
c⁄√˘i⁄°©e_t
 *
°©e
, 
iﬁogaddr_t
 *
˛og
,

4677 
iﬁogaddr_t
 *
dlog
, *
bad
,

4678 
ruÀ_t
 *
∑ckëruÀ
, 
size_t
 *
bwu£d
);

4698 
io°©us_t


4699 
	`io_udp_èrgë2˛õ¡
(
sockd_io_dúe˘i⁄_t
 *
c⁄åﬁ
,

4700 
sockd_io_dúe˘i⁄_t
 *
ö
, sockd_io_dúe˘i⁄_à*
out
,

4701 
c⁄√˘i⁄°©e_t
 *
°©e
,

4702 
iﬁogaddr_t
 *
˛og
, iﬁogaddr_à*
dlog
, *
bad
,

4703 
ruÀ_t
 *
∑ckëruÀ
, 
size_t
 *
bwu£d
);

4710 #i‡
COVENANT


4713 
	`ª£nd_˛õ¡
(
sockd_io_t
 *
io
);

4723 
	`ªcv_ª£¡˛õ¡
(
s
, 
sockd_˛õ¡_t
 *
˛õ¡
);

4731 
√gŸüã_ªsu…_t


4732 
	`ªcv_hâ¥eque°
(
s
, 
ªque°_t
 *
ªque°
,

4733 
√gŸüã_°©e_t
 *
°©e
);

4747 
	`∑r£_hâ¥eque°
(
ªque°_t
 *
ªqöfo
, c⁄° *
ªq
,

4748 *
emsg
, 
size_t
 
emsgÀn
);

4757 
size_t


4758 
	`hâ¥e•⁄£2mem
(c⁄° 
s
, c⁄° 
ª•⁄£_t
 *
ª•⁄£
,

4759 *
buf
, c⁄° 
size_t
 
buÊí
);

4763 #i‡
HAVE_NEGOTIATE_PHASE


4765 
	`£nd_c⁄√˘ª•⁄£
(c⁄° 
s
, c⁄° 
îr‹
, 
sockd_io_t
 *
io
);

4778 
ª•⁄£_t
 *

4779 
	`¸óã_ª•⁄£
(c⁄° 
socksho°_t
 *
ho°
, 
authmëhod_t
 *
auth
,

4780 c⁄° 
¥oxy¥Ÿocﬁ
, c⁄° 
ª•⁄£code
,

4781 
ª•⁄£_t
 *
ª•⁄£
);

4791 
	`£nd_Áûuª
(c⁄° 
s
, 
ª•⁄£_t
 *
ª•⁄£
, c⁄° 
Áûuª
);

4802 
	`£nd_ª•⁄£
(
s
, c⁄° 
ª•⁄£_t
 *
ª•⁄£
);

4811 
	#£nd_Áûuª
(
s
, 
ª•⁄£
, 
Áûuª
)

	)

4812 
	#£nd_ª•⁄£
(
s
, 
ª•⁄£
Ë(0)

	)

4816 #i‡
DIAGNOSTIC


4817 
	`doc⁄figã°
();

4818 
	`shmemcheck
();

4825 
	`checksock›ti⁄s
(c⁄° 
s
, c⁄° 
ß_Ámûy_t
 
Ámûy
, c⁄° 
ty≥
,

4826 c⁄° 
is˛õ¡side
);

	@include/socks.h

47 #i‚de‡
_SOCKS_H_


48 
	#_SOCKS_H_


	)

50 
	#HAVE_SOCKS_RULES
 (0)

	)

52 #i‚de‡
HAVE_OSF_OLDSTYLE


53 
	#HAVE_OSF_OLDSTYLE
 0

	)

56 #i‡
SOCKSLIBRARY_DYNAMIC


58 #ifde‡
__COVERITY__


66 
	#sys_ac˚±
 
ac˚±


	)

67 
	#sys_böd
 
böd


	)

68 
	#sys_bödªsvp‹t
 
bödªsvp‹t


	)

69 
	#sys_c⁄√˘
 
c⁄√˘


	)

70 
	#sys_gëho°by«me
 
gëho°by«me


	)

71 
	#sys_gëho°by«me2
 
gëho°by«me2


	)

72 
	#sys_gëaddröfo
 
gëaddröfo


	)

73 
	#sys_gëùnodeby«me
 
gëùnodeby«me


	)

74 
	#sys_gë≥î«me
 
gë≥î«me


	)

75 
	#sys_gësock«me
 
gësock«me


	)

76 
	#sys_gësock›t
 
gësock›t


	)

77 
	#sys_li°í
 
li°í


	)

78 
	#sys_ªad
 
ªad


	)

79 
	#sys_ªadv
 
ªadv


	)

80 
	#sys_ªcv
 
ªcv


	)

81 
	#sys_ªcv‰om
 
ªcv‰om


	)

82 
	#sys_ªcv‰om
 
ªcv‰om


	)

83 
	#sys_ªcvmsg
 
ªcvmsg


	)

84 
	#sys_ºesvp‹t
 
ºesvp‹t


	)

85 
	#sys_£nd
 
£nd


	)

86 
	#sys_£ndmsg
 
£ndmsg


	)

87 
	#sys_£ndto
 
£ndto


	)

88 
	#sys_wrôe
 
wrôe


	)

89 
	#sys_wrôev
 
wrôev


	)

96 #ifde‡
ªcvmsg


97 
	#ªcvmsg_sy°em
 
ªcvmsg


	)

98 #unde‡
ªcvmsg


101 #i‡
HAVE_SYSTEM_XMSG_MAGIC


102 #unde‡
ªcvmsg_sy°em


103 
	#ªcvmsg_sy°em
 
ƒecvmsg


	)

106 #ifde‡
£ndmsg


107 
	#£ndmsg_sy°em
 
£ndmsg


	)

108 #unde‡
£ndmsg


111 #i‡
HAVE_SYSTEM_XMSG_MAGIC


112 #unde‡
£ndmsg_sy°em


113 
	#£ndmsg_sy°em
 
n£ndmsg


	)

117 #ifde‡
ac˚±


118 #unde‡
ac˚±


120 #i‡
HAVE_EXTRA_OSF_SYMBOLS


121 
	#ac˚±
(
s
, 
addr
, 
addæí
Ë
	`sys_Eac˚±
(s,áddr,áddæí)

	)

123 
	#ac˚±
(
s
, 
addr
, 
addæí
Ë
	`sys_ac˚±
(s,áddr,áddæí)

	)

126 #ifde‡
böd


127 #unde‡
böd


129 #i‡(
deföed
 
__sun
Ë&& (deföed 
_XPG4_2
)

130 
	#böd
(
s
, 
«me
, 
«mñí
Ë
	`sys_x√t_böd
(s,Çame,Çamñí)

	)

132 
	#böd
(
s
, 
«me
, 
«mñí
Ë
	`sys_böd
(s,Çame,Çamñí)

	)

135 #ifde‡
bödªsvp‹t


136 #unde‡
bödªsvp‹t


138 
	#bödªsvp‹t
(
sd
, 
sö
Ë
	`sys_bödªsvp‹t
(sd, sö)

	)

140 #ifde‡
c⁄√˘


141 #unde‡
c⁄√˘


143 #i‡(
deföed
 
__sun
Ë&& (deföed 
_XPG4_2
)

144 
	#c⁄√˘
(
s
, 
«me
, 
«mñí
Ë
	`sys_x√t_c⁄√˘
(s,Çame,Çamñí)

	)

146 
	#c⁄√˘
(
s
, 
«me
, 
«mñí
Ë
	`sys_c⁄√˘
(s,Çame,Çamñí)

	)

150 #ifde‡
gëho°by«me


151 #unde‡
gëho°by«me


154 #i‡
HAVE_GETHOSTBYNAME2


159 
	#gëho°by«me
(
«me
Ë
	`sys_gëho°by«me2
“ame, 
AF_INET
)

	)

161 
	#gëho°by«me
(
«me
Ë
	`sys_gëho°by«me
“ame)

	)

164 #ifde‡
gëho°by«me2


165 #unde‡
gëho°by«me2


167 
	#gëho°by«me2
(
«me
, 
af
Ë
	`sys_gëho°by«me2
“ame,áf)

	)

169 #ifde‡
gëaddröfo


170 #unde‡
gëaddröfo


172 
	#gëaddröfo
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
) \

173 
	`sys_gëaddröfo
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
)

	)

175 #ifde‡
gëùnodeby«me


176 #unde‡
gëùnodeby«me


178 
	#gëùnodeby«me
(
«me
, 
af
, 
Êags
, 
îr‹_num
) \

179 
	`sys_gëùnodeby«me
(
«me
, 
af
, 
Êags
, 
îr‹_num
)

	)

181 #ifde‡
‰ìho°ít


182 #unde‡
‰ìho°ít


184 
	#‰ìho°ít
(
±r
Ë
	`sys_‰ìho°ít
’å)

	)

188 #ifde‡
gë≥î«me


189 #unde‡
gë≥î«me


192 #i‡
HAVE_EXTRA_OSF_SYMBOLS


193 
	#gë≥î«me
(
s
, 
«me
, 
«mñí
Ë
	`sys_Egë≥î«me
(s,Çame,Çamñí)

	)

195 
	#gë≥î«me
(
s
, 
«me
, 
«mñí
Ë
	`sys_gë≥î«me
(s,Çame,Çamñí)

	)

198 #ifde‡
gësock«me


199 #unde‡
gësock«me


201 #i‡
HAVE_EXTRA_OSF_SYMBOLS


202 
	#gësock«me
(
s
, 
«me
, 
«mñí
Ë
	`sys_Egësock«me
(s,Çame,Çamñí)

	)

204 
	#gësock«me
(
s
, 
«me
, 
«mñí
Ë
	`sys_gësock«me
(s,Çame,Çamñí)

	)

207 #ifde‡
gësock›t


208 #unde‡
gësock›t


210 #i‡
HAVE_EXTRA_OSF_SYMBOLS


211 
	#gësock›t
(
a
, 
b
, 
c
, 
d
, 
e
Ë
	`sys_Egësock›t
◊, b, c, d,É)

	)

213 
	#gësock›t
(
a
, 
b
, 
c
, 
d
, 
e
Ë
	`sys_gësock›t
◊, b, c, d,É)

	)

216 #ifde‡
li°í


217 #unde‡
li°í


219 #i‡(
deföed
 
__sun
Ë&& (deföed 
_XPG4_2
)

220 
	#li°í
(
s
, 
backlog
Ë
	`sys_x√t_li°í
(s, backlog)

	)

222 
	#li°í
(
s
, 
backlog
Ë
	`sys_li°í
(s, backlog)

	)

225 #ifde‡
ªad


226 #unde‡
ªad


228 
	#ªad
(
d
, 
buf
, 
nbyãs
Ë
	`sys_ªad
(d, buf,Çbyãs)

	)

230 #ifde‡
ªadv


231 #unde‡
ªadv


233 #i‡
HAVE_EXTRA_OSF_SYMBOLS


234 
	#ªadv
(
d
, 
iov
, 
iov˙t
Ë
	`sys_Eªadv
(d, iov, iov˙t)

	)

236 
	#ªadv
(
d
, 
iov
, 
iov˙t
Ë
	`sys_ªadv
(d, iov, iov˙t)

	)

239 #ifde‡
ªcv


240 #unde‡
ªcv


242 
	#ªcv
(
s
, 
msg
, 
Àn
, 
Êags
Ë
	`sys_ªcv
(s, msg,Üí, fœgs)

	)

244 #ifde‡
ªcv‰om


245 #unde‡
ªcv‰om


247 #i‡
HAVE_EXTRA_OSF_SYMBOLS


248 
	#ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
) \

249 
	`sys_Eªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

	)

251 
	#ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
) \

252 
	`sys_ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

	)

256 #ifde‡
ªcvmsg


257 #unde‡
ªcvmsg


259 #i‡(
deföed
 
__sun
Ë&& (deföed 
_XPG4_2
)

260 
	#ªcvmsg
(
s
, 
msg
, 
Êags
Ë
	`sys_x√t_ªcvmsg
(s, msg, fœgs)

	)

262 
	#ªcvmsg
(
s
, 
msg
, 
Êags
Ë
	`sys_ªcvmsg
(s, msg, fœgs)

	)

265 #i‡
HAVE_RRESVPORT


266 #ifde‡
ºesvp‹t


267 #unde‡
ºesvp‹t


269 
	#ºesvp‹t
(
p‹t
Ë
	`sys_ºesvp‹t
’‹t)

	)

272 #ifde‡
£ndto


273 #unde‡
£ndto


275 #i‡(
deföed
 
__sun
Ë&& (deföed 
_XPG4_2
)

276 
	#£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
) \

277 
	`sys_x√t_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

	)

279 
	#£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
) \

280 
	`sys_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
)

	)

283 #ifde‡
wrôe


284 #unde‡
wrôe


286 
	#wrôe
(
d
, 
buf
, 
nbyãs
Ë
	`sys_wrôe
(d, buf,Çbyãs)

	)

288 #ifde‡
wrôev


289 #unde‡
wrôev


291 #i‡
HAVE_EXTRA_OSF_SYMBOLS


292 
	#wrôev
(
d
, 
iov
, 
iov˙t
Ë
	`sys_Ewrôev
(d, iov, iov˙t)

	)

294 
	#wrôev
(
d
, 
iov
, 
iov˙t
Ë
	`sys_wrôev
(d, iov, iov˙t)

	)

297 #ifde‡
£nd


298 #unde‡
£nd


300 
	#£nd
(
s
, 
msg
, 
Àn
, 
Êags
Ë
	`sys_£nd
(s, msg,Üí, fœgs)

	)

302 #unde‡
£ndmsg


303 #i‡
HAVE_EXTRA_OSF_SYMBOLS


304 
	#£ndmsg
(
s
, 
msg
, 
Êags
Ë
	`sys_E£ndmsg
(s, msg, fœgs)

	)

306 #i‡(
deföed
 
__sun
Ë&& (deföed 
_XPG4_2
)

307 
	#£ndmsg
(
s
, 
msg
, 
Êags
Ë
	`sys_x√t_£ndmsg
(s, msg, fœgs)

	)

309 
	#£ndmsg
(
s
, 
msg
, 
Êags
Ë
	`sys_£ndmsg
(s, msg, fœgs)

	)

313 #unde‡
ªcvmsg


314 #i‡
HAVE_EXTRA_OSF_SYMBOLS


315 
	#ªcvmsg
(
s
, 
msg
, 
Êags
Ë
	`sys_Eªcvmsg
(s, msg, fœgs)

	)

317 #i‡(
deföed
 
__sun
Ë&& (deföed 
_XPG4_2
)

318 
	#ªcvmsg
(
s
, 
msg
, 
Êags
Ë
	`sys_x√t_ªcvmsg
(s, msg, fœgs)

	)

320 
	#ªcvmsg
(
s
, 
msg
, 
Êags
Ë
	`sys_ªcvmsg
(s, msg, fœgs)

	)

324 #i‡
HAVE_GSSAPI
 && 
HAVE_LINUX_GLIBC_WORKAROUND


325 #ifde‡
gëc


326 #unde‡
gëc


328 
	#gëc
(
s
Ë
	`sys_gëc
(s)

	)

330 #ifde‡
fgëc


331 #unde‡
fgëc


333 
	#fgëc
(
s
Ë
	`sys_fgëc
(s)

	)

335 #ifde‡
gës


336 #unde‡
gës


338 
	#gës
(
s
Ë
	`sys_gës
(s)

	)

340 #ifde‡
fgës


341 #unde‡
fgës


343 
	#fgës
(
c
, 
i
, 
s
Ë
	`sys_fgës
(c, i, s)

	)

345 #ifde‡
putc


346 #unde‡
putc


348 
	#putc
(
c
, 
s
Ë
	`sys_putc
(c, s)

	)

350 #ifde‡
Âutc


351 #unde‡
Âutc


353 
	#Âutc
(
c
, 
s
Ë
	`sys_Âutc
(c, s)

	)

355 #ifde‡
puts


356 #unde‡
pus


358 
	#puts
(
b
Ë
	`sys_puts
(b)

	)

360 #ifde‡
Âuts


361 #unde‡
Âuts


363 
	#Âuts
(
b
, 
s
Ë
	`sys_Âuts
(b, s)

	)

365 #ifde‡
fÊush


366 #unde‡
fÊush


368 
	#fÊush
(
s
Ë
	`sys_fÊush
(s)

	)

370 #ifde‡
f˛o£


371 #unde‡
f˛o£


373 
	#f˛o£
(
s
Ë
	`sys_f˛o£
(s)

	)

375 #ifde‡
¥ötf


376 #unde‡
¥ötf


378 
	#¥ötf
(
f
, ...Ë
	`sys_¥ötf
(f, 
__VA_ARGS__
 )

	)

380 #ifde‡
v¥ötf


381 #unde‡
v¥ötf


383 
	#v¥ötf
(
f
, 
v
Ë
	`sys_vÂrötf
(f, v)

	)

385 #ifde‡
Ârötf


386 #unde‡
Ârötf


388 
	#Ârötf
(
s
, ...Ë
	`sys_Ârötf
(s, 
__VA_ARGS__
 )

	)

390 #ifde‡
vÂrötf


391 #unde‡
vÂrötf


393 
	#vÂrötf
(
s
, 
f
, 
v
Ë
	`sys_vÂrötf
(s, f, v)

	)

395 #ifde‡
fwrôe


396 #unde‡
fwrôe


398 
	#fwrôe
(
p
, 
i
, 
n
, 
s
Ë
	`sys_fwrôe
’, i,Ç, s)

	)

400 #ifde‡
‰ód


401 #unde‡
‰ód


403 
	#‰ód
(
p
, 
i
, 
n
, 
s
Ë
	`sys_‰ód
’, i,Ç, s)

	)

410 
	#logÀvñ_î∫o
(
e
, 
side
Ë(
LOG_DEBUG
)

	)

411 
	#logÀvñ_gaõº
(
e
, 
side
Ë(
LOG_DEBUG
)

	)

413 
	#FDPASS_MAX
 2

	)

416 
	möôed
;

418 
	mhavegsßpisockës
;

419 
	mthªadlockíabÀd
;

421 
ssize_t
 
	mexecutögdnscode
;

422 
	möã∫Æîr‹dëe˘ed
;

423 
sig_©omic_t
 
	mösig«l
;

424 
sig_©omic_t
 
	mh™dÀdsig«l
;

430 
socksho°_t
 
	mœ°c⁄√˘
;

431 
pid_t
 
	mpid
;

432 
æim_t
 
	mmax›ífûes
;

433 } 
	tc⁄fig°©e_t
;

436 
	mdebug
;

437 
	mdúe˘ÁŒback
;

438 *
	mc⁄figfûe
;

439 } 
	t›ti⁄_t
;

441 
	sc⁄fig
 {

442 
pid_t
 
	mc⁄√˘chûd
;

443 
	mchûd_d©a
;

444 
	mchûd_ack
;

446 
	mdomaö
[
MAXHOSTNAMELEN
];

448 
logty≥_t
 
	mîæog
;

449 
logty≥_t
 
	mlog
;

450 
	mloglock
;

452 
›ti⁄_t
 
	m›ti⁄
;

453 
	mªsﬁvïrŸocﬁ
;

455 
rouã›ti⁄s_t
 
	mrouã›ti⁄s
;

456 
rouã_t
 *
	mrouã
;

459 
sockë›ti⁄_t
 *
	msockë›ti⁄v
;

460 
size_t
 
	msockë›ti⁄c
;

462 
c⁄fig°©e_t
 
	m°©e
;

463 
timeout_t
 
	mtimeout
;

467 
	ms
;

468 
socks_t
 
	m∑ckë
;

469 } 
	tchûd∑ckë_t
;

471 
sig£t_t
 
	taddæock›aque_t
;

478 
˛õ¡öô
();

483 #i‡!
HAVE_OSF_OLDSTYLE


484 
Rac˚±
(, 
sockaddr
 *, 
sockÀn_t
 *);

485 
Rc⁄√˘
(, c⁄° 
sockaddr
 *, 
sockÀn_t
);

486 
Rgësock«me
(, 
sockaddr
 *, 
sockÀn_t
 *);

487 
Rgësock›t
(, , , *, 
sockÀn_t
 *);

488 
Rgë≥î«me
(, 
sockaddr
 *, 
sockÀn_t
 *);

489 
ssize_t
 
	$R£ndto
(
s
, c⁄° *
msg
, 
size_t
 
Àn
, 
Êags
,

490 c⁄° 
sockaddr
 *
to
, 
sockÀn_t
 
tﬁí
)

491 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

492 
ssize_t
 
	$Rªcv‰om
(
s
, *
buf
, 
size_t
 
Àn
, 
Êags
,

493 
sockaddr
 * 
‰om
, 
sockÀn_t
 *
‰omÀn
)

494 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

495 
ssize_t
 
	`R£ndmsg
(
s
, c⁄° 
msghdr
 *
msg
, 
Êags
);

496 
ssize_t
 
	`Rªcvmsg
(
s
, 
msghdr
 *
msg
, 
Êags
);

497 
	`Rböd
(, c⁄° 
sockaddr
 *, 
sockÀn_t
);

500 
	`Rbödªsvp‹t
(, 
sockaddr_ö
 *);

501 
	`Rºesvp‹t
(*);

502 
ho°ít
 *
	`Rgëho°by«me
(const *);

503 
ho°ít
 *
	`Rgëho°by«me2
(c⁄° *, 
af
);

505 #i‡
HAVE_GETADDRINFO


506 
	`Rgëaddröfo
(c⁄° *
nodíame
, c⁄° *
£rv«me
,

507 c⁄° 
addröfo
 *
höts
, addröfÿ**
ªs
);

510 #i‡
HAVE_GETIPNODEBYNAME


511 
ho°ít
 *
	`Rgëùnodeby«me
(const *, , , *);

512 
	`R‰ìho°ít
(
ho°ít
 *);

515 
ssize_t
 
	$Rwrôe
(
d
, c⁄° *
buf
, 
size_t
 
nbyãs
)

516 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

517 
ssize_t
 
	`Rwrôev
(
d
, c⁄° 
iovec
 *
iov
, 
iov˙t
);

518 
ssize_t
 
	$R£nd
(
s
, c⁄° *
msg
, 
size_t
 
Àn
, 
Êags
)

519 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

520 
ssize_t
 
	$Rªad
(
d
, *
buf
, 
size_t
 
nbyãs
)

521 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

522 
ssize_t
 
	`Rªadv
(
d
, c⁄° 
iovec
 *
iov
, 
iov˙t
);

523 
ssize_t
 
	$Rªcv
(
s
, *
msg
, 
size_t
 
Àn
, 
Êags
)

524 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

526 #i‡
HAVE_GSSAPI
 && 
HAVE_LINUX_GLIBC_WORKAROUND


527 
	`Rfgëc
(
FILE
 *
Â
);

528 *
	`Rgës
(*
s
);

529 *
	`Rfgës
(*
s
, 
size
, 
FILE
 *
Â
);

530 
	`RÂutc
(
c
, 
FILE
 *
Â
);

531 
	`RÂuts
(c⁄° *
s
, 
FILE
 *
Â
);

532 
	`RfÊush
(
FILE
 *
Â
);

533 
	`Rf˛o£
(
FILE
 *
Â
);

534 
	`RÂrötf
(
FILE
 *
°ªam
, c⁄° *
f‹m©
, ...);

535 
	`RvÂrötf
(
FILE
 *
°ªam
, c⁄° *
f‹m©
, 
va_li°
 
≠
);

536 
size_t
 
	`R‰ód
(*
±r
, size_à
size
, size_à
nmemb
, 
FILE
 *
s
);

537 
size_t
 
	`Rfwrôe
(c⁄° *
±r
, size_à
size
, size_à
nmemb
, 
FILE
 *
s
);

541 
	`SOCKSöô
(*);

542 
	`Rli°í
(, );

543 
	`R£À˘
(, 
fd_£t
 *, fd_£à*, fd_£à*, 
timevÆ
 *);

553 
	`cgëaddröfo
(c⁄° *
«me
, c⁄° *
£rvi˚
,

554 c⁄° 
addröfo
 *
höts
, addröfÿ**
ªs
,

555 
dnsöfo_t
 *
ªsmem
);

562 
rouã_t
 *

563 
	`udp£tup
(
s
, c⁄° 
sockaddr_°‹age
 *
to
, 
ty≥
, 
shouldc⁄√˘
,

564 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

582 
	`socks_addröô
();

587 
	`socks_addæock
(c⁄° 
lockty≥
, 
addæock›aque_t
 *
›aque
);

588 
	`socks_addru∆ock
(c⁄° 
addæock›aque_t
 *
›aque
);

596 
socksfd_t
 *

597 
	`socks_addrdup
(c⁄° 
socksfd_t
 *
ﬁd
, socksfd_à*
√w
);

605 
socksfd_t
 *

606 
	`socks_addaddr
(c⁄° 
˛õ¡fd
, c⁄° 
socksfd_t
 *
sockßddªss
,

607 c⁄° 
èkñock
);

625 
socksfd_t
 *

626 
	`socks_gëaddr
(c⁄° 
fd
, 
socksfd_t
 *
socksfd
, c⁄° 
èkñock
);

641 
	`socks_rmaddr
(c⁄° 
s
, c⁄° 
èkñock
);

651 
	`socks_addrc⁄åﬁ
(c⁄° 
c⁄åﬁ£¡
, c⁄° 
c⁄åﬁª˚ived
,

652 c⁄° 
èkñock
);

671 
	`socks_addrm©ch
(c⁄° 
sockaddr_°‹age
 *
loˇl
,

672 c⁄° 
sockaddr_°‹age
 *
ªmŸe
,

673 c⁄° 
socks°©e_t
 *
°©e
, c⁄° 
èkñock
);

688 
	`socks_addrisours
(c⁄° 
s
, 
socksfd_t
 *
socksfd
, c⁄° 
èkñock
);

705 
	`upd©e_a·î_√gŸüã
(c⁄° 
socks_t
 *
∑ckë
, 
socksfd_t
 *
socksfd
);

712 
	`fdis›í
(
fd
);

719 #i‡
DIAGNOSTIC


721 
	`cc_socksfdv
(
sig
);

728 #i‡
SOCKSLIBRARY_DYNAMIC


730 
	`sys_ºesvp‹t
(*);

731 
	`sys_bödªsvp‹t
(, 
sockaddr_ö
 *);

732 
	`sys_‰ìho°ít
(
ho°ít
 *);

734 
HAVE_PROT_READ_0


735 
	`sys_ªad
(
HAVE_PROT_READ_1
, 
HAVE_PROT_READ_2
, 
HAVE_PROT_READ_3
);

736 
HAVE_PROT_LISTEN_0


737 
	`sys_li°í
(
HAVE_PROT_LISTEN_1
, 
HAVE_PROT_LISTEN_2
);

738 
HAVE_PROT_READV_0


739 
	`sys_ªadv
(
HAVE_PROT_READV_1
, 
HAVE_PROT_READV_2
, 
HAVE_PROT_READV_3
);

740 
HAVE_PROT_RECV_0


741 
	`sys_ªcv
(
HAVE_PROT_RECV_1
, 
HAVE_PROT_RECV_2
, 
HAVE_PROT_RECV_3
,

742 
HAVE_PROT_RECV_4
);

743 
HAVE_PROT_RECVMSG_0


744 
	`sys_ªcvmsg
(
HAVE_PROT_RECVMSG_1
, 
HAVE_PROT_RECVMSG_2
, 
HAVE_PROT_RECVMSG_3
);

745 
HAVE_PROT_SEND_0


746 
	`sys_£nd
(
HAVE_PROT_SEND_1
, 
HAVE_PROT_SEND_2
, 
HAVE_PROT_SEND_3
,

747 
HAVE_PROT_SEND_4
);

748 
HAVE_PROT_WRITE_0


749 
	`sys_wrôe
(
HAVE_PROT_WRITE_1
, 
HAVE_PROT_WRITE_2
, 
HAVE_PROT_WRITE_3
);

751 #i‡
HAVE_OSF_OLDSTYLE


752 
	`sys_ac˚±
(, 
sockaddr
 *, *);

754 
HAVE_PROT_ACCEPT_0


755 
	`sys_ac˚±
(
HAVE_PROT_ACCEPT_1
, 
HAVE_PROT_ACCEPT_2
, 
HAVE_PROT_ACCEPT_3
);

758 #i‡
HAVE_OSF_OLDSTYLE


759 
	`sys_böd
(, c⁄° 
sockaddr
 *, );

761 
HAVE_PROT_BIND_0


762 
	`sys_böd
(
HAVE_PROT_BIND_1
, 
HAVE_PROT_BIND_2
, 
HAVE_PROT_BIND_3
);

765 #i‡
HAVE_OSF_OLDSTYLE


766 
	`sys_c⁄√˘
(, c⁄° 
sockaddr
 *, );

768 
HAVE_PROT_CONNECT_0


769 
	`sys_c⁄√˘
(
HAVE_PROT_CONNECT_1
, 
HAVE_PROT_CONNECT_2
, 
HAVE_PROT_CONNECT_3
);

772 #i‡
HAVE_OSF_OLDSTYLE


773 
	`sys_gë≥î«me
(, 
sockaddr
 *, *);

775 
HAVE_PROT_GETPEERNAME_0


776 
	`sys_gë≥î«me
(
HAVE_PROT_GETPEERNAME_1
, 
HAVE_PROT_GETPEERNAME_2
,

777 
HAVE_PROT_GETPEERNAME_3
);

780 #i‡
HAVE_OSF_OLDSTYLE


781 
	`sys_gësock«me
(, 
sockaddr
 *, *);

783 
HAVE_PROT_GETSOCKNAME_0


784 
	`sys_gësock«me
(
HAVE_PROT_GETSOCKNAME_1
, 
HAVE_PROT_GETSOCKNAME_2
,

785 
HAVE_PROT_GETSOCKNAME_3
);

788 
HAVE_PROT_GETSOCKOPT_0


789 
	`sys_gësock›t
(
HAVE_PROT_GETSOCKOPT_1
, 
HAVE_PROT_GETSOCKOPT_2
,

790 
HAVE_PROT_GETSOCKOPT_3
, 
HAVE_PROT_GETSOCKOPT_4
, 
HAVE_PROT_GETSOCKOPT_5
);

792 #i‡
HAVE_OSF_OLDSTYLE


793 
	`sys_ªcv‰om
(, *, , , 
sockaddr
 *, *);

795 
HAVE_PROT_RECVFROM_0


796 
	`sys_ªcv‰om
(
HAVE_PROT_RECVFROM_1
, 
HAVE_PROT_RECVFROM_2
, 
HAVE_PROT_RECVFROM_3
,

797 
HAVE_PROT_RECVFROM_4
, 
HAVE_PROT_RECVFROM_5
, 
HAVE_PROT_RECVFROM_6
);

800 #i‡
HAVE_OSF_OLDSTYLE


801 
ssize_t
 
	`sys_wrôev
(, c⁄° 
iovec
 *, );

803 
HAVE_PROT_WRITEV_0


804 
	`sys_wrôev
(
HAVE_PROT_WRITEV_1
, 
HAVE_PROT_WRITEV_2
, 
HAVE_PROT_WRITEV_3
);

807 #i‡
HAVE_OSF_OLDSTYLE


808 
ssize_t
 
	`sys_£ndmsg
(, 
msghdr
 *, );

810 
HAVE_PROT_SENDMSG_0


811 
	`sys_£ndmsg
(
HAVE_PROT_SENDMSG_1
, 
HAVE_PROT_SENDMSG_2
, 
HAVE_PROT_SENDMSG_3
);

814 #i‡
HAVE_OSF_OLDSTYLE


815 
	`sys_£ndto
(, c⁄° *, , , c⁄° 
sockaddr
 *,

816 
sockÀn_t
);

818 
HAVE_PROT_SENDTO_0


819 
	`sys_£ndto
(
HAVE_PROT_SENDTO_1
, 
HAVE_PROT_SENDTO_2
, 
HAVE_PROT_SENDTO_3
,

820 
HAVE_PROT_SENDTO_4
, 
HAVE_PROT_SENDTO_5
, 
HAVE_PROT_SENDTO_6
);

823 #i‡
HAVE_EXTRA_OSF_SYMBOLS


824 
	`sys_Eac˚±
(, 
sockaddr
 *, 
sockÀn_t
 *);

825 
	`sys_Egë≥î«me
(, 
sockaddr
 *, 
sockÀn_t
 *);

826 
	`sys_Egësock«me
(, 
sockaddr
 *, 
sockÀn_t
 *);

827 
ssize_t
 
	`sys_Eªadv
(, c⁄° 
iovec
 *, );

828 
	$sys_Eªcv‰om
(, *, 
size_t
, , 
sockaddr
 *, size_t *)

829 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

830 
ssize_t
 
	`sys_Eªcvmsg
(, 
msghdr
 *, );

831 
ssize_t
 
	`sys_E£ndmsg
(, c⁄° 
msghdr
 *, );

832 
ssize_t
 
	`sys_Ewrôev
(, c⁄° 
iovec
 *, );

834 
	`sys_«c˚±
(, 
sockaddr
 *, 
sockÀn_t
 *);

835 
	`sys_ngë≥î«me
(, 
sockaddr
 *, 
sockÀn_t
 *);

836 
	`sys_ngësock«me
(, 
sockaddr
 *, 
sockÀn_t
 *);

837 
	$sys_ƒecv‰om
(, *, 
size_t
, , 
sockaddr
 *, size_t *)

838 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__buf„r__
, 2, 3)));

839 
ssize_t
 
	`sys_ƒecvmsg
(, 
msghdr
 *, );

840 
ssize_t
 
	`sys_n£ndmsg
(, c⁄° 
msghdr
 *, );

843 #ifde‡
__sun


844 
HAVE_PROT_BIND_0


845 
	`sys_x√t_böd
(
HAVE_PROT_BIND_1
, 
HAVE_PROT_BIND_2
, 
HAVE_PROT_BIND_3
);

846 
HAVE_PROT_LISTEN_0


847 
	`sys_x√t_li°í
(
HAVE_PROT_LISTEN_1
, 
HAVE_PROT_LISTEN_2
);

848 
HAVE_PROT_RECVMSG_0


849 
	`sys_x√t_ªcvmsg
(
HAVE_PROT_RECVMSG_1
, 
HAVE_PROT_RECVMSG_2
, 
HAVE_PROT_RECVMSG_3
);

850 
HAVE_PROT_SENDMSG_0


851 
	`sys_x√t_£ndmsg
(
HAVE_PROT_SENDMSG_1
, 
HAVE_PROT_SENDMSG_2
, 
HAVE_PROT_SENDMSG_3
);

852 
HAVE_PROT_SENDTO_0


853 
	`sys_x√t_£ndto
(
HAVE_PROT_SENDTO_1
, 
HAVE_PROT_SENDTO_2
, 
HAVE_PROT_SENDTO_3
,

854 
HAVE_PROT_SENDTO_4
, 
HAVE_PROT_SENDTO_5
, 
HAVE_PROT_SENDTO_6
);

855 
HAVE_PROT_CONNECT_0


856 
	`sys_x√t_c⁄√˘
(
HAVE_PROT_CONNECT_1
, 
HAVE_PROT_CONNECT_2
, 
HAVE_PROT_CONNECT_3
);

859 #ifde‡
__FªeBSD__


860 
HAVE_PROT_ACCEPT_0


861 
	`_ac˚±
(
HAVE_PROT_ACCEPT_1
, 
HAVE_PROT_ACCEPT_2
, 
HAVE_PROT_ACCEPT_3
);

862 
HAVE_PROT_BIND_0


863 
	`_böd
(
HAVE_PROT_BIND_1
, 
HAVE_PROT_BIND_2
, 
HAVE_PROT_BIND_3
);

864 
HAVE_PROT_CONNECT_0


865 
	`_c⁄√˘
(
HAVE_PROT_CONNECT_1
, 
HAVE_PROT_CONNECT_2
, 
HAVE_PROT_CONNECT_3
);

866 
HAVE_PROT_GETPEERNAME_0


867 
	`_gë≥î«me
(
HAVE_PROT_GETPEERNAME_1
, 
HAVE_PROT_GETPEERNAME_2
,

868 
HAVE_PROT_GETPEERNAME_3
);

869 
HAVE_PROT_GETSOCKNAME_0


870 
	`_gësock«me
(
HAVE_PROT_GETSOCKNAME_1
, 
HAVE_PROT_GETSOCKNAME_2
,

871 
HAVE_PROT_GETSOCKNAME_3
);

872 
HAVE_PROT_GETSOCKOPT_0


873 
	`_gësock›t
(
HAVE_PROT_GETSOCKOPT_1
, 
HAVE_PROT_GETSOCKOPT_2
,

874 
HAVE_PROT_GETSOCKOPT_3
, 
HAVE_PROT_GETSOCKOPT_4
, 
HAVE_PROT_GETSOCKOPT_5
);

875 
HAVE_PROT_LISTEN_0


876 
	`_li°í
(
HAVE_PROT_LISTEN_1
, 
HAVE_PROT_LISTEN_2
);

877 
HAVE_PROT_READ_0


878 
	`_ªad
(
HAVE_PROT_READ_1
, 
HAVE_PROT_READ_2
, 
HAVE_PROT_READ_3
);

879 
HAVE_PROT_READV_0


880 
	`_ªadv
(
HAVE_PROT_READV_1
, 
HAVE_PROT_READV_2
, 
HAVE_PROT_READV_3
);

881 
HAVE_PROT_RECV_0


882 
	`_ªcv
(
HAVE_PROT_RECV_1
, 
HAVE_PROT_RECV_2
, 
HAVE_PROT_RECV_3
, 
HAVE_PROT_RECV_4
);

883 
HAVE_PROT_RECVFROM_0


884 
	`_ªcv‰om
(
HAVE_PROT_RECVFROM_1
, 
HAVE_PROT_RECVFROM_2
, 
HAVE_PROT_RECVFROM_3
,

885 
HAVE_PROT_RECVFROM_4
, 
HAVE_PROT_RECVFROM_5
, 
HAVE_PROT_RECVFROM_6
);

886 
HAVE_PROT_RECVMSG_0


887 
	`_ªcvmsg
(
HAVE_PROT_RECVMSG_1
, 
HAVE_PROT_RECVMSG_2
, 
HAVE_PROT_RECVMSG_3
);

888 
HAVE_PROT_WRITE_0


889 
	`_wrôe
(
HAVE_PROT_WRITE_1
, 
HAVE_PROT_WRITE_2
, 
HAVE_PROT_WRITE_3
);

890 
HAVE_PROT_WRITEV_0


891 
	`_wrôev
(
HAVE_PROT_WRITEV_1
, 
HAVE_PROT_WRITEV_2
, 
HAVE_PROT_WRITEV_3
);

892 
HAVE_PROT_SEND_0


893 
	`_£nd
(
HAVE_PROT_SEND_1
, 
HAVE_PROT_SEND_2
, 
HAVE_PROT_SEND_3
, 
HAVE_PROT_SEND_4
);

894 
HAVE_PROT_SENDMSG_0


895 
	`_£ndmsg
(
HAVE_PROT_SENDMSG_1
, 
HAVE_PROT_SENDMSG_2
, 
HAVE_PROT_SENDMSG_3
);

896 
HAVE_PROT_SENDTO_0


897 
	`_£ndto
(
HAVE_PROT_SENDTO_1
, 
HAVE_PROT_SENDTO_2
, 
HAVE_PROT_SENDTO_3
,

898 
HAVE_PROT_SENDTO_4
, 
HAVE_PROT_SENDTO_5
, 
HAVE_PROT_SENDTO_6
);

901 #i‡
HAVE_GSSAPI
 && 
HAVE_LINUX_GLIBC_WORKAROUND


902 
HAVE_PROT_GETC_0


903 
	`sys_gëc
(
HAVE_PROT_GETC_1
);

904 
HAVE_PROT_FGETC_0


905 
	`sys_fgëc
(
HAVE_PROT_FGETC_1
);

906 
HAVE_PROT_GETS_0


907 
	`sys_gës
(
HAVE_PROT_GETS_1
);

908 
HAVE_PROT_FGETS_0


909 
	`sys_fgës
(
HAVE_PROT_FGETS_1
, 
HAVE_PROT_FGETS_2
, 
HAVE_PROT_FGETS_3
);

910 
HAVE_PROT_PUTC_0


911 
	`sys_putc
(
HAVE_PROT_PUTC_1
, 
HAVE_PROT_PUTC_2
);

912 
HAVE_PROT_FPUTC_0


913 
	`sys_Âutc
(
HAVE_PROT_FPUTC_1
, 
HAVE_PROT_FPUTC_2
);

914 
HAVE_PROT_PUTS_0


915 
	`sys_puts
(
HAVE_PROT_PUTS_1
);

916 
HAVE_PROT_FPUTS_0


917 
	`sys_Âuts
(
HAVE_PROT_FPUTS_1
, 
HAVE_PROT_FPUTS_2
);

918 
HAVE_PROT_FFLUSH_0


919 
	`sys_fÊush
(
HAVE_PROT_FFLUSH_1
);

920 
HAVE_PROT_FCLOSE_0


921 
	`sys_f˛o£
(
HAVE_PROT_FCLOSE_1
);

922 
HAVE_PROT_PRINTF_0


923 
	`sys_¥ötf
(
HAVE_PROT_PRINTF_1
, ...);

924 
HAVE_PROT_VPRINTF_0


925 
	`sys_v¥ötf
(
HAVE_PROT_VPRINTF_1
, 
HAVE_PROT_VPRINTF_2
);

926 
HAVE_PROT_FPRINTF_0


927 
	`sys_Ârötf
(
HAVE_PROT_FPRINTF_1
, 
HAVE_PROT_FPRINTF_2
, ...);

928 
HAVE_PROT_VFPRINTF_0


929 
	`sys_vÂrötf
(
HAVE_PROT_VFPRINTF_1
, 
HAVE_PROT_VFPRINTF_2
, 
HAVE_PROT_VFPRINTF_3
);

930 
HAVE_PROT_FWRITE_0


931 
	`sys_fwrôe
(
HAVE_PROT_FWRITE_1
, 
HAVE_PROT_FWRITE_2
, 
HAVE_PROT_FWRITE_3
,

932 
HAVE_PROT_FWRITE_4
);

933 
HAVE_PROT_FREAD_0


934 
	`sys_‰ód
(
HAVE_PROT_FREAD_1
, 
HAVE_PROT_FREAD_2
, 
HAVE_PROT_FREAD_3
,

935 
HAVE_PROT_FREAD_4
);

938 #i‡
HAVE_DARWIN


940 
HAVE_PROT_READ_0


941 
	`sys_ªad_noˇn˚l
(
HAVE_PROT_READ_1
, 
HAVE_PROT_READ_2
, 
HAVE_PROT_READ_3
);

942 
HAVE_PROT_CONNECT_0


943 
	`sys_c⁄√˘_noˇn˚l
(
HAVE_PROT_CONNECT_1
, 
HAVE_PROT_CONNECT_2
,

944 
HAVE_PROT_CONNECT_3
 
«mñí
);

945 
HAVE_PROT_RECVFROM_0


946 
	`sys_ªcv‰om_noˇn˚l
(
HAVE_PROT_RECVFROM_1
, 
HAVE_PROT_RECVFROM_2
,

947 
HAVE_PROT_RECVFROM_3
, 
HAVE_PROT_RECVFROM_4
, 
HAVE_PROT_RECVFROM_5
,

948 
HAVE_PROT_RECVFROM_6
);

949 
HAVE_PROT_SENDTO_0


950 
	`sys_£ndto_noˇn˚l
(
HAVE_PROT_SENDTO_1
, 
HAVE_PROT_SENDTO_2
, 
HAVE_PROT_SENDTO_3
,

951 
HAVE_PROT_SENDTO_4
, 
HAVE_PROT_SENDTO_5
, 
HAVE_PROT_SENDTO_6
);

952 
HAVE_PROT_WRITE_0


953 
	`sys_wrôe_noˇn˚l
(
HAVE_PROT_WRITE_1
, 
HAVE_PROT_WRITE_2
, 
HAVE_PROT_WRITE_3
);

	@include/socks_gssapi.h

49 #i‡
HAVE_GSSAPI


51 
gsßpi_°©e_t
 *

52 
socks_gë_gsßpi_°©e
(c⁄° 
fd
, c⁄° 
havñock
);

62 
ssize_t


63 
gsßpi_decode_ªad
(
s
, *
buf
, 
size_t
 
Àn
, 
Êags
,

64 
sockaddr_°‹age
 *
‰om
, 
sockÀn_t
 *
‰omÀn
,

65 
ªcv‰om_öfo_t
 *
ªcvÊags
, 
gsßpi_°©e_t
 *
gs
);

74 
ssize_t


75 
gsßpi_ícode_wrôe
(
s
, c⁄° *
msg
, 
size_t
 
Àn
, 
Êags
,

76 c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
,

77 
£ndto_öfo_t
 *
£ndtoÊags
, 
gsßpi_°©e_t
 *
gs
);

86 
gsßpi_i£n¸y±ed
(
s
);

93 
gss_îr_is£t
(
OM_uöt32
 
maj‹_°©us
, OM_uöt32 
mö‹_°©us
,

94 *
buf
, 
size_t
 
buÊí
);

97 
gsßpi_exp‹t_°©e
(
gss_˘x_id_t
 *
id
, 
gss_buf„r_desc
 *
°©e
);

104 
gsßpi_imp‹t_°©e
(
gss_˘x_id_t
 *
id
, 
gss_buf„r_desc
 *
°©e
);

112 
	#CLEAN_GSS_TOKEN
(
tokí
) do { \

113 
OM_uöt32
 
maj‹_°©us
, 
mö‹_°©us
; \

114 
	`SIGSET_ALLOCATE
(
ﬁd£t
); \

115 
buf
[1024]; \

117 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
); \

119 
maj‹_°©us
 = 
	`gss_ªÀa£_buf„r
(&
mö‹_°©us
, &(
tokí
)); \

120 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, (buf))) \

121 
	`sw¨nx
("%s: gss_release_buffer()át %s:%d failed: %s", \

122 
fun˘i⁄
, 
__FILE__
, 
__LINE__
, 
buf
); \

124 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
); \

125 }  0)

	)

127 
	#CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
) do { \

128 
OM_uöt32
 
maj‹_°©us
, 
mö‹_°©us
; \

129 
	`SIGSET_ALLOCATE
(
ﬁd£t
); \

130 
buf
[1024]; \

132 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
); \

134 i‡((
˛õ¡_«me
Ë!
GSS_C_NO_NAME
) { \

135 
maj‹_°©us
 = 
	`gss_ªÀa£_«me
(&
mö‹_°©us
, &(
˛õ¡_«me
)); \

136 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, (buf))) \

137 
	`sw¨nx
("%s: gss_release_name()át %s:%d failed: %s", \

138 
fun˘i⁄
, 
__FILE__
, 
__LINE__
, 
buf
); \

141 i‡((
£rvî_«me
Ë!
GSS_C_NO_NAME
) { \

142 
maj‹_°©us
 = 
	`gss_ªÀa£_«me
(&
mö‹_°©us
, &(
£rvî_«me
)); \

143 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, (buf))) \

144 
	`sw¨nx
("%s: gss_release_name()át %s:%d failed: %s", \

145 
fun˘i⁄
, 
__FILE__
, 
__LINE__
, 
buf
); \

148 i‡((
£rvî_¸eds
Ë!
GSS_C_NO_CREDENTIAL
) { \

149 
maj‹_°©us
 = 
	`gss_ªÀa£_¸ed
(&
mö‹_°©us
, &(
£rvî_¸eds
)); \

150 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, (buf))) \

151 
	`sw¨nx
("%s: gss_release_name()át %s:%d failed: %s", \

152 
fun˘i⁄
, 
__FILE__
, 
__LINE__
, 
buf
); \

155 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
); \

156 }  0)

	)

	@include/symbols.h

47 #i‚de‡
LIBRARY_PATH


48 
	#LIBRARY_PATH
 ""

	)

51 #i‚de‡
LIBRARY_LIBC


52 
	#LIBRARY_LIBC
 
	`__CONCAT
(
LIBRARY_PATH
, "libc.so")

	)

55 #i‡
HAVE_NO_SYMBOL_UNDERSCORE


56 
	#SYMBOLPREFIX
 ""

	)

58 
	#SYMBOLPREFIX
 "_"

	)

61 
	#SYMBOL_ACCEPT
 
SYMBOLPREFIX
 "ac˚±"

	)

62 
	#SYMBOL_BIND
 
SYMBOLPREFIX
 "böd"

	)

63 
	#SYMBOL_BINDRESVPORT
 
SYMBOLPREFIX
 "bödªsvp‹t"

	)

64 
	#SYMBOL_CONNECT
 
SYMBOLPREFIX
 "c⁄√˘"

	)

65 
	#SYMBOL_FREEHOSTENT
 
SYMBOLPREFIX
 "‰ìho°ít"

	)

66 
	#SYMBOL_GETADDRINFO
 
SYMBOLPREFIX
 "gëaddröfo"

	)

67 
	#SYMBOL_GETNAMEINFO
 
SYMBOLPREFIX
 "gë«meöfo"

	)

68 
	#SYMBOL_GETHOSTBYADDR
 
SYMBOLPREFIX
 "gëho°byaddr"

	)

69 
	#SYMBOL_GETHOSTBYNAME
 
SYMBOLPREFIX
 "gëho°by«me"

	)

70 
	#SYMBOL_GETHOSTBYNAME2
 
SYMBOLPREFIX
 "gëho°by«me2"

	)

71 
	#SYMBOL_GETIPNODEBYNAME
 
SYMBOLPREFIX
 "gëùnodeby«me"

	)

72 
	#SYMBOL_GETPEERNAME
 
SYMBOLPREFIX
 "gë≥î«me"

	)

73 
	#SYMBOL_GETSOCKNAME
 
SYMBOLPREFIX
 "gësock«me"

	)

74 
	#SYMBOL_GETSOCKOPT
 
SYMBOLPREFIX
 "gësock›t"

	)

75 
	#SYMBOL_LISTEN
 
SYMBOLPREFIX
 "li°í"

	)

76 
	#SYMBOL_READ
 
SYMBOLPREFIX
 "ªad"

	)

77 
	#SYMBOL_READV
 
SYMBOLPREFIX
 "ªadv"

	)

78 
	#SYMBOL_RECV
 
SYMBOLPREFIX
 "ªcv"

	)

79 
	#SYMBOL_RECVFROM
 
SYMBOLPREFIX
 "ªcv‰om"

	)

80 
	#SYMBOL_RECVMSG
 
SYMBOLPREFIX
 "ªcvmsg"

	)

81 
	#SYMBOL_RRESVPORT
 
SYMBOLPREFIX
 "ºesvp‹t"

	)

82 
	#SYMBOL_SEND
 
SYMBOLPREFIX
 "£nd"

	)

83 
	#SYMBOL_SENDMSG
 
SYMBOLPREFIX
 "£ndmsg"

	)

84 
	#SYMBOL_SENDTO
 
SYMBOLPREFIX
 "£ndto"

	)

85 
	#SYMBOL_WRITE
 
SYMBOLPREFIX
 "wrôe"

	)

86 
	#SYMBOL_WRITEV
 
SYMBOLPREFIX
 "wrôev"

	)

88 #i‚de‡
LIBRARY_ACCEPT


89 
	#LIBRARY_ACCEPT
 
LIBRARY_LIBC


	)

92 #i‚de‡
LIBRARY_BIND


93 
	#LIBRARY_BIND
 
LIBRARY_LIBC


	)

96 #i‚de‡
LIBRARY_BINDRESVPORT


97 
	#LIBRARY_BINDRESVPORT
 
LIBRARY_LIBC


	)

100 #i‚de‡
LIBRARY_CONNECT


101 
	#LIBRARY_CONNECT
 
LIBRARY_LIBC


	)

104 #i‚de‡
LIBRARY_GETHOSTBYADDR


105 
	#LIBRARY_GETHOSTBYADDR
 
LIBRARY_LIBC


	)

108 #i‚de‡
LIBRARY_GETHOSTBYNAME


109 
	#LIBRARY_GETHOSTBYNAME
 
LIBRARY_LIBC


	)

112 #i‚de‡
LIBRARY_GETHOSTBYNAME2


113 
	#LIBRARY_GETHOSTBYNAME2
 
LIBRARY_LIBC


	)

116 #i‚de‡
LIBRARY_GETADDRINFO


117 
	#LIBRARY_GETADDRINFO
 
LIBRARY_LIBC


	)

120 #i‚de‡
LIBRARY_GETNAMEINFO


121 
	#LIBRARY_GETNAMEINFO
 
LIBRARY_LIBC


	)

124 #i‚de‡
LIBRARY_GETIPNODEBYNAME


125 
	#LIBRARY_GETIPNODEBYNAME
 
LIBRARY_LIBC


	)

128 #i‚de‡
LIBRARY_FREEHOSTENT


129 
	#LIBRARY_FREEHOSTENT
 
LIBRARY_LIBC


	)

132 #i‚de‡
LIBRARY_GETPEERNAME


133 
	#LIBRARY_GETPEERNAME
 
LIBRARY_LIBC


	)

136 #i‚de‡
LIBRARY_GETSOCKNAME


137 
	#LIBRARY_GETSOCKNAME
 
LIBRARY_LIBC


	)

140 #i‚de‡
LIBRARY_GETSOCKOPT


141 
	#LIBRARY_GETSOCKOPT
 
LIBRARY_LIBC


	)

144 #i‚de‡
LIBRARY_LISTEN


145 
	#LIBRARY_LISTEN
 
LIBRARY_LIBC


	)

148 #i‚de‡
LIBRARY_READ


149 
	#LIBRARY_READ
 
LIBRARY_LIBC


	)

152 #i‚de‡
LIBRARY_READV


153 
	#LIBRARY_READV
 
LIBRARY_LIBC


	)

156 #i‚de‡
LIBRARY_RECV


157 
	#LIBRARY_RECV
 
LIBRARY_LIBC


	)

160 #i‚de‡
LIBRARY_RECVFROM


161 
	#LIBRARY_RECVFROM
 
LIBRARY_LIBC


	)

164 #i‚de‡
LIBRARY_RECVMSG


165 
	#LIBRARY_RECVMSG
 
LIBRARY_LIBC


	)

168 #i‚de‡
LIBRARY_RRESVPORT


169 
	#LIBRARY_RRESVPORT
 
LIBRARY_LIBC


	)

172 #i‚de‡
LIBRARY_SEND


173 
	#LIBRARY_SEND
 
LIBRARY_LIBC


	)

176 #i‚de‡
LIBRARY_SENDMSG


177 
	#LIBRARY_SENDMSG
 
LIBRARY_LIBC


	)

180 #i‚de‡
LIBRARY_SENDTO


181 
	#LIBRARY_SENDTO
 
LIBRARY_LIBC


	)

184 #i‚de‡
LIBRARY_WRITE


185 
	#LIBRARY_WRITE
 
LIBRARY_LIBC


	)

188 #i‚de‡
LIBRARY_WRITEV


189 
	#LIBRARY_WRITEV
 
LIBRARY_LIBC


	)

197 #i‡
HAVE_GSSAPI
 && 
HAVE_LINUX_GLIBC_WORKAROUND


199 
	#SYMBOL_GETC
 
SYMBOLPREFIX
 "gëc"

	)

200 
	#SYMBOL_FGETC
 
SYMBOLPREFIX
 "fgëc"

	)

201 
	#SYMBOL_GETS
 
SYMBOLPREFIX
 "gës"

	)

202 
	#SYMBOL_FGETS
 
SYMBOLPREFIX
 "fgës"

	)

203 
	#SYMBOL_PUTC
 
SYMBOLPREFIX
 "putc"

	)

204 
	#SYMBOL_FPUTC
 
SYMBOLPREFIX
 "Âutc"

	)

205 
	#SYMBOL_PUTS
 
SYMBOLPREFIX
 "puts"

	)

206 
	#SYMBOL_FPUTS
 
SYMBOLPREFIX
 "Âuts"

	)

207 
	#SYMBOL_FFLUSH
 
SYMBOLPREFIX
 "fÊush"

	)

208 
	#SYMBOL_FCLOSE
 
SYMBOLPREFIX
 "f˛o£"

	)

209 
	#SYMBOL_PRINTF
 
SYMBOLPREFIX
 "¥ötf"

	)

210 
	#SYMBOL_VPRINTF
 
SYMBOLPREFIX
 "v¥ötf"

	)

211 
	#SYMBOL_FPRINTF
 
SYMBOLPREFIX
 "Ârötf"

	)

212 
	#SYMBOL_VFPRINTF
 
SYMBOLPREFIX
 "vÂrötf"

	)

213 
	#SYMBOL_FWRITE
 
SYMBOLPREFIX
 "fwrôe"

	)

214 
	#SYMBOL_FREAD
 
SYMBOLPREFIX
 "‰ód"

	)

216 #i‚de‡
LIBRARY_GETC


217 
	#LIBRARY_GETC
 
LIBRARY_LIBC


	)

220 #i‚de‡
LIBRARY_FGETC


221 
	#LIBRARY_FGETC
 
LIBRARY_LIBC


	)

224 #i‚de‡
LIBRARY_GETS


225 
	#LIBRARY_GETS
 
LIBRARY_LIBC


	)

228 #i‚de‡
LIBRARY_FGETS


229 
	#LIBRARY_FGETS
 
LIBRARY_LIBC


	)

232 #i‚de‡
LIBRARY_PUTC


233 
	#LIBRARY_PUTC
 
LIBRARY_LIBC


	)

236 #i‚de‡
LIBRARY_FPUTC


237 
	#LIBRARY_FPUTC
 
LIBRARY_LIBC


	)

240 #i‚de‡
LIBRARY_PUTS


241 
	#LIBRARY_PUTS
 
LIBRARY_LIBC


	)

244 #i‚de‡
LIBRARY_FPUTS


245 
	#LIBRARY_FPUTS
 
LIBRARY_LIBC


	)

248 #i‚de‡
LIBRARY_FFLUSH


249 
	#LIBRARY_FFLUSH
 
LIBRARY_LIBC


	)

252 #i‚de‡
LIBRARY_FCLOSE


253 
	#LIBRARY_FCLOSE
 
LIBRARY_LIBC


	)

256 #i‚de‡
LIBRARY_PRINTF


257 
	#LIBRARY_PRINTF
 
LIBRARY_LIBC


	)

260 #i‚de‡
LIBRARY_VPRINTF


261 
	#LIBRARY_VPRINTF
 
LIBRARY_LIBC


	)

264 #i‚de‡
LIBRARY_FPRINTF


265 
	#LIBRARY_FPRINTF
 
LIBRARY_LIBC


	)

268 #i‚de‡
LIBRARY_VFPRINTF


269 
	#LIBRARY_VFPRINTF
 
LIBRARY_LIBC


	)

272 #i‚de‡
LIBRARY_FWRITE


273 
	#LIBRARY_FWRITE
 
LIBRARY_LIBC


	)

276 #i‚de‡
LIBRARY_FREAD


277 
	#LIBRARY_FREAD
 
LIBRARY_LIBC


	)

280 #i‡
HAVE___FPRINTF_CHK


281 
	#SYMBOL___FPRINTF_CHK
 
SYMBOLPREFIX
 "__Ârötf_chk"

	)

284 #i‡
HAVE___VFPRINTF_CHK


285 
	#SYMBOL___VFPRINTF_CHK
 
SYMBOLPREFIX
 "__vÂrötf_chk"

	)

288 #i‡
HAVE___READ_CHK


289 
	#SYMBOL___READ_CHK
 
SYMBOLPREFIX
 "__ªad_chk"

	)

292 #i‡
HAVE__IO_GETC


293 
	#SYMBOL__IO_GETC
 
SYMBOLPREFIX
 "_IO_gëc"

	)

296 #i‡
HAVE__IO_PUTC


297 
	#SYMBOL__IO_PUTC
 
SYMBOLPREFIX
 "_IO_putc"

	)

300 #i‡
HAVE___FPRINTF_CHK


301 #i‚de‡
LIBRARY___FPRINTF_CHK


302 
	#LIBRARY___FPRINTF_CHK
 
LIBRARY_LIBC


	)

306 #i‡
HAVE___VFPRINTF_CHK


307 #i‚de‡
LIBRARY___VFPRINTF_CHK


308 
	#LIBRARY___VFPRINTF_CHK
 
LIBRARY_LIBC


	)

312 #i‡
HAVE___READ_CHK


313 #i‚de‡
LIBRARY___READ_CHK


314 
	#LIBRARY___READ_CHK
 
LIBRARY_LIBC


	)

318 #i‡
HAVE__IO_GETC


319 #i‚de‡
LIBRARY__IO_GETC


320 
	#LIBRARY__IO_GETC
 
LIBRARY_LIBC


	)

324 #i‡
HAVE__IO_PUTC


325 #i‚de‡
LIBRARY__IO_PUTC


326 
	#LIBRARY__IO_PUTC
 
LIBRARY_LIBC


	)

337 #i‡
HAVE_EXTRA_OSF_SYMBOLS


339 
	#SYMBOL_EACCEPT
 "_Eac˚±"

	)

340 
	#SYMBOL_EGETPEERNAME
 "_Egë≥î«me"

	)

341 
	#SYMBOL_EGETSOCKNAME
 "_Egësock«me"

	)

342 
	#SYMBOL_EREADV
 "_Eªadv"

	)

343 
	#SYMBOL_ERECVFROM
 "_Eªcv‰om"

	)

344 
	#SYMBOL_ERECVMSG
 "_Eªcvmsg"

	)

345 
	#SYMBOL_ESENDMSG
 "_E£ndmsg"

	)

346 
	#SYMBOL_EWRITEV
 "_Ewrôev"

	)

348 #i‚de‡
LIBRARY_EACCEPT


349 
	#LIBRARY_EACCEPT
 
LIBRARY_LIBC


	)

352 #i‚de‡
LIBRARY_EGETPEERNAME


353 
	#LIBRARY_EGETPEERNAME
 
LIBRARY_LIBC


	)

356 #i‚de‡
LIBRARY_EGETSOCKNAME


357 
	#LIBRARY_EGETSOCKNAME
 
LIBRARY_LIBC


	)

360 #i‚de‡
LIBRARY_EREADV


361 
	#LIBRARY_EREADV
 
LIBRARY_LIBC


	)

364 #i‚de‡
LIBRARY_ERECVFROM


365 
	#LIBRARY_ERECVFROM
 
LIBRARY_LIBC


	)

368 #i‚de‡
LIBRARY_ERECVMSG


369 
	#LIBRARY_ERECVMSG
 
LIBRARY_LIBC


	)

372 #i‚de‡
LIBRARY_ESENDMSG


373 
	#LIBRARY_ESENDMSG
 
LIBRARY_LIBC


	)

376 #i‚de‡
LIBRARY_EWRITEV


377 
	#LIBRARY_EWRITEV
 
LIBRARY_LIBC


	)

382 
	#SYMBOL_NACCEPT
 "«c˚±"

	)

383 
	#SYMBOL_NGETPEERNAME
 "ngë≥î«me"

	)

384 
	#SYMBOL_NGETSOCKNAME
 "ngësock«me"

	)

385 
	#SYMBOL_NRECVFROM
 "ƒecv‰om"

	)

386 
	#SYMBOL_NRECVMSG
 "ƒecvmsg"

	)

387 
	#SYMBOL_NSENDMSG
 "n£ndmsg"

	)

389 #i‚de‡
LIBRARY_NACCEPT


390 
	#LIBRARY_NACCEPT
 
LIBRARY_LIBC


	)

393 #i‚de‡
LIBRARY_NGETPEERNAME


394 
	#LIBRARY_NGETPEERNAME
 
LIBRARY_LIBC


	)

397 #i‚de‡
LIBRARY_NGETSOCKNAME


398 
	#LIBRARY_NGETSOCKNAME
 
LIBRARY_LIBC


	)

401 #i‚de‡
LIBRARY_NRECVFROM


402 
	#LIBRARY_NRECVFROM
 
LIBRARY_LIBC


	)

405 #i‚de‡
LIBRARY_NRECVMSG


406 
	#LIBRARY_NRECVMSG
 
LIBRARY_LIBC


	)

409 #i‚de‡
LIBRARY_NSENDMSG


410 
	#LIBRARY_NSENDMSG
 
LIBRARY_LIBC


	)

420 #ifde‡
__sun


421 
	#SYMBOL_XNET_BIND
 "__x√t_böd"

	)

422 
	#SYMBOL_XNET_CONNECT
 "__x√t_c⁄√˘"

	)

423 
	#SYMBOL_XNET_LISTEN
 "__x√t_li°í"

	)

424 
	#SYMBOL_XNET_RECVMSG
 "__x√t_ªcvmsg"

	)

425 
	#SYMBOL_XNET_SENDMSG
 "__x√t_£ndmsg"

	)

426 
	#SYMBOL_XNET_SENDTO
 "__x√t_£ndto"

	)

434 #i‡
HAVE_DARWIN


436 
	#SYMBOL_CONNECT_NOCANCEL
 "c⁄√˘$NOCANCEL"

	)

437 
	#SYMBOL_READ_NOCANCEL
 "ªad$NOCANCEL"

	)

438 
	#SYMBOL_RECVFROM_NOCANCEL
 "ªcv‰om$NOCANCEL"

	)

439 
	#SYMBOL_SENDTO_NOCANCEL
 "£ndto$NOCANCEL"

	)

440 
	#SYMBOL_WRITE_NOCANCEL
 "wrôe$NOCANCEL"

	)

449 #i‡
HAVE_PTHREAD_H


451 
	#SYMBOL_PT_INIT
 
SYMBOLPREFIX
 "±hªad_muãx_öô"

	)

452 
	#SYMBOL_PT_ATTRINIT
 
SYMBOLPREFIX
 "±hªad_muãx©å_öô"

	)

453 
	#SYMBOL_PT_SETTYPE
 
SYMBOLPREFIX
 "±hªad_muãx©å_£ây≥"

	)

454 
	#SYMBOL_PT_LOCK
 
SYMBOLPREFIX
 "±hªad_muãx_lock"

	)

455 
	#SYMBOL_PT_UNLOCK
 
SYMBOLPREFIX
 "±hªad_muãx_u∆ock"

	)

456 
	#SYMBOL_PT_SELF
 
SYMBOLPREFIX
 "±hªad_£lf"

	)

458 #i‚de‡
LIBRARY_PTHREAD


459 
	#LIBRARY_PTHREAD
 
LIBRARY_LIBC


	)

	@include/tostring.h

47 #i‚de‡
_TOSTRING_H_


48 
	#_TOSTRING_H_


	)

50 
	#QUOTE
(
a
Ë
	)
a

51 
	#QUOTE0
(Ë""

	)

54 
aihöts2°rög
(c⁄° 
addröfo
 *
höts
, *
°rög
, 
size_t
 
Àn
);

64 
fd£t2°rög
(c⁄° 
nfds
, c⁄° 
fd_£t
 *
£t
, c⁄° 
docheck
,

65 *
buf
, 
size_t
 
buÊí
);

74 
öt32_t


75 
°rög2p‹äumbî
(c⁄° *
°rög
, *
emsg
, 
size_t
 
emsgÀn
);

82 
›î©‹_t


83 
°rög2›î©‹
(c⁄° *
›î©‹
);

90 
›î©‹2°rög
(
›î©‹_t
 
›î©‹
);

100 
	#ADDRINFO_PORT
 (1)

	)

101 
	#ADDRINFO_ATYPE
 (2)

	)

102 
	#ADDRINFO_SCOPEID
 (4)

	)

105 
	$ruÀaddr2°rög
(c⁄° 
ruÀaddr_t
 *
ruÀ
, c⁄° 
size_t
 
ö˛udeöfo
,

106 *
°rög
, 
size_t
 
Àn
)

107 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 3, 4)));

122 
	`comm™d2°rög
(
comm™d
);

129 
	$comm™ds2°rög
(c⁄° 
comm™d_t
 *
comm™d
, *
°r
, 
size_t
 
°rsize
)

130 
	`__ATTRIBUTE__
((
	$__NONNULL__
(2)))

131 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

141 
	$mëhods2°rög
(
size_t
 
mëhodc
, c⁄° *
mëhodv
, *
°r
, size_à
°rsize
)

142 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 3, 4)));

153 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
);

160 
	$¥Ÿocﬁs2°rög
(c⁄° 
¥Ÿocﬁ_t
 *
¥Ÿocﬁs
, *
°r
, 
size_t
 
°rsize
)

161 
	`__ATTRIBUTE__
((
	$__NONNULL__
(2)))

162 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

172 
	$¥oxy¥Ÿocﬁs2°rög
(c⁄° 
¥oxy¥Ÿocﬁ_t
 *
¥oxy¥Ÿocﬁs
, *
°r
,

173 
size_t
 
°rsize
)

174 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

187 
	`mëhod2°rög
(
mëhod
);

193 
	`gsßpùrŸe˘i⁄2°rög
(c⁄° 
¥Ÿe˘i⁄
);

199 
	`°rög2mëhod
(c⁄° *
mëhod«me
);

207 
	$socksho°2°rög2
(c⁄° 
socksho°_t
 *
ho°
, c⁄° 
size_t
 
ö˛udeöfo
,

208 *
°rög
, 
size_t
 
Àn
)

209 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 3, 4)));

223 
	$socksho°2°rög
(c⁄° 
socksho°_t
 *
ho°
, *
°rög
, 
size_t
 
Àn
)

224 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

231 
	$sockaddr2°rög2
(c⁄° 
sockaddr_°‹age
 *
addr
, c⁄° 
size_t
 
ö˛udeöfo
,

232 *
°rög
, 
size_t
 
Àn
)

233 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 3, 4)));

251 
	$sockaddr2°rög
(c⁄° 
sockaddr_°‹age
 *
addr
, *
°rög
, 
size_t
 
Àn
)

252 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

259 
	`addr2hex°rög
(c⁄° *
addr
, c⁄° 
ß_Ámûy_t
 
ßÁmûy
,

260 *
°rög
, 
size_t
 
Àn
);

270 
udphódî_t
 *

271 
	$°rög2udphódî
(c⁄° *
d©a
, 
size_t
 
Àn
, 
udphódî_t
 *
hódî
)

272 
	`__ATTRIBUTE__
((
	$__NONNULL__
(1)))

273 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 1, 2)));

285 
	`socks_∑ckë2°rög
(c⁄° *
∑ckë
, 
i§eque°
);

297 
	$exãnsi⁄s2°rög
(c⁄° 
exãnsi⁄_t
 *
exãnsi⁄s
, *
°r
,

298 
size_t
 
°rsize
)

299 
	`__ATTRIBUTE__
((
	$__NONNULL__
(2)))

300 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

310 
	`ªsﬁvïrŸocﬁ2°rög
(
ªsﬁvïrŸocﬁ
);

316 
	`°r2uµî
(*
°rög
);

323 
	$sock«me2°rög
(c⁄° 
s
, *
buf
, 
size_t
 
buÊí
)

324 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

331 
	$≥î«me2°rög
(c⁄° 
s
, *
buf
, 
size_t
 
buÊí
)

332 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

339 
	$sockë2°rög
(c⁄° 
s
, *
buf
, 
size_t
 
buÊí
)

340 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

351 
	`¥oxy¥Ÿocﬁ2°rög
(
vîsi⁄
);

357 
	`©y≥2°rög
(c⁄° 
©y≥
);

363 
	`ßÁmûy2°rög
(c⁄° 
ß_Ámûy_t
 
af
);

369 
	`sockty≥2°rög
(c⁄° 
sockty≥
);

375 
	`rouã›ti⁄s2°rög
(c⁄° 
rouã›ti⁄s_t
 *
›ti⁄s
, *
°r
, 
size_t
 
°rsize
);

384 
	`logÀvñ2°rög
(c⁄° 
logÀvñ
);

390 
	`sig«l2°rög
(c⁄° 
sig
);

397 
	$logty≥s2°rög
(c⁄° 
logty≥_t
 *
logty≥s
, *
°r
, 
size_t
 
°rsize
)

398 
	`__ATTRIBUTE__
((
	$__NONNULL__
(2)))

399 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

409 
	`sock›tvÆ2°rög
(
sockë›tvÆue_t
 
vÆue
, 
sockë›tvÆue_ty≥_t
 
ty≥
,

410 *
°r
, 
size_t
 
°rsize
);

417 
	`sock›éevñ2°rög
(
Àvñ
);

423 
	`sock›tvÆty≥2°rög
(
sockë›tvÆue_ty≥_t
 
ty≥
);

429 
	`sock›t2°rög
(c⁄° 
sockë›ti⁄_t
 *
›t
, *
°r
, 
size_t
 
°rsize
);

435 
	`…ﬂ
(
l
, *
buf
, 
size_t
 
buÊí
);

444 
	`sockë£âime2°rög
(c⁄° 
whichtime
);

451 #i‡!
SOCKS_CLIENT


453 
	`öãrÁ˚side2°rög
(c⁄° 
öãrÁ˚side_t
 
side
);

459 
	`öãrÁ˚¥Ÿocﬁ2°rög
(c⁄° 
öãrÁ˚¥Ÿocﬁ_t
 *
iÂrŸo
,

460 *
°r
, 
size_t
 
°rsize
);

466 
	`√tw‹kã°2°rög
(c⁄° 
√tw‹kã°_t
 *
ã°
, *
°r
, 
size_t
 
°æí
);

472 
	`addrsc›e2°rög
(c⁄° 
ùv6_addrsc›e_t
 
sc›e
);

478 
	`Æ¨mside2°rög
(c⁄° 
size_t
 
Æ¨mside
);

484 
	`˛õ¡öfo2°rög
(c⁄° 
˛õ¡öfo_t
 *
cöfo
, *
°r
, 
size_t
 
°rsize
);

490 
	`°©ekey2°rög
(c⁄° 
°©ekey_t
 
key
);

495 
°©ekey_t


496 
	`°rög2°©ekey
(c⁄° *
°rög
);

503 
	`obje˘ty≥2°rög
(c⁄° 
obje˘ty≥_t
 
obje˘ty≥
);

509 
	$timeouts2°rög
(c⁄° 
timeout_t
 *
timeouts
, c⁄° *
¥efix
,

510 *
°r
, 
size_t
 
°rsize
)

511 
	`__ATTRIBUTE__
((
	$__NONNULL__
(3)))

512 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 3, 4)));

524 
	`timeouây≥2°rög
(c⁄° 
timeouây≥_t
 
ty≥
);

530 
	$logs2°rög
(c⁄° 
log_t
 *
logs
, *
°r
, 
size_t
 
°rsize
)

531 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

540 #i‡!
HAVE_PRIVILEGES


542 
	$u£rids2°rög
(c⁄° 
u£rid_t
 *
u£rids
, c⁄° *
¥efix
, *
°r
,

543 
size_t
 
°rsize
)

544 
	`__ATTRIBUTE__
((
	$__NONNULL__
(3)))

545 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 3, 4)));

557 
	$›ti⁄s2°rög
(c⁄° 
›ti⁄_t
 *
›ti⁄s
, c⁄° *
¥efix
,

558 *
°r
, 
size_t
 
°rsize
)

559 
	`__ATTRIBUTE__
((
	$__NONNULL__
(3)))

560 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 3, 4)));

570 
	$com∑ts2°rög
(c⁄° 
com∑t_t
 *
com∑ts
, *
°r
, 
size_t
 
°rsize
)

571 
	`__ATTRIBUTE__
((
	$__NONNULL__
(2)))

572 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

582 
	$li°2°rög
(c⁄° 
löked«me_t
 *
li°
, *
°r
, 
size_t
 
°rsize
)

583 
	`__ATTRIBUTE__
((
	$__NONNULL__
(2)))

584 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

594 
	`chûdty≥2°rög
(
ty≥
);

600 
	`vîdi˘2°rög
(
vîdi˘
);

606 
	$§cho°s2°rög
(c⁄° 
§cho°_t
 *
§cho°s
, c⁄° *
¥efix
,

607 *
°r
, 
size_t
 
°rsize
)

608 
	`__ATTRIBUTE__
((
	$__NONNULL__
(3)))

609 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 3, 4)));

620 
	`uid2«me
(
uid_t
 
uid
);

627 
	`rŸ©i⁄2°rög
(
rŸ©i⁄
);

633 
	`¥iv›2°rög
(c⁄° 
¥iv_›_t
 
›
);

638 #i‡
HAVE_SCHED_SETAFFINITY


641 
	$˝u£t2°rög
(c⁄° 
˝u_£t_t
 *
£t
, *
°r
, 
size_t
 
°rsize
)

642 
	`__ATTRIBUTE__
((
	`__BOUNDED__
(
__°rög__
, 2, 3)));

649 #i‡
COVENANT


650 c⁄° *
	`hâpcode2°rög
(c⁄° 
vîsi⁄
, c⁄° 
code
);

	@include/upnp.h

46 #i‡
HAVE_LIBMINIUPNP


47 
	~<möiu≤pc/möiu≤pc.h
>

48 
	~<möiu≤pc/u≤pcomm™ds.h
>

49 
	~<möiu≤pc/u≤≥º‹s.h
>

52 
u≤p˛ónup
(c⁄° 
s
);

59 #i‡!
HAVE_LIBMINIUPNP


60 
	#UPNPCOMMAND_SUCCESS
 0

	)

	@include/yacconfig.h

46 #i‚de‡
_YACCONFIG_H_


47 
	#_YACCONFIG_H_


	)

53 
	#yya˘
 
socks_yya˘


	)

54 
	#yych¨
 
socks_yych¨


	)

55 
	#yychk
 
socks_yychk


	)

56 
	#yydebug
 
socks_yydebug


	)

57 
	#yydef
 
socks_yydef


	)

58 
	#yyîrÊag
 
socks_yyîrÊag


	)

59 
	#yyîr‹
 
socks_yyîr‹


	)

60 
	#yyîr‹x
 
socks_yyîr‹x


	)

61 
	#yyw¨n
 
socks_yyw¨n


	)

62 
	#yyw¨nx
 
socks_yyw¨nx


	)

63 
	#yyexˇ
 
socks_yyexˇ


	)

64 
	#yyÀx
 
socks_yyÀx


	)

65 
	#yylvÆ
 
socks_yylvÆ


	)

66 
	#yy√ºs
 
socks_yy√ºs


	)

67 
	#yy∑˘
 
socks_yy∑˘


	)

68 
	#yy∑r£
 
socks_yy∑r£


	)

69 
	#yypgo
 
socks_yypgo


	)

70 
	#yyps
 
socks_yyps


	)

71 
	#yypv
 
socks_yypv


	)

72 
	#yyr1
 
socks_yyr1


	)

73 
	#yyr2
 
socks_yyr2


	)

74 
	#yyªds
 
socks_yyªds


	)

75 
	#yys
 
socks_yys


	)

76 
	#yy°©e
 
socks_yy°©e


	)

77 
	#yytmp
 
socks_yytmp


	)

78 
	#yytoks
 
socks_yytoks


	)

79 
	#yyv
 
socks_yyv


	)

80 
	#yyvÆ
 
socks_yyvÆ


	)

81 
	#yyback
 
socks_yyback


	)

82 
	#yybgö
 
socks_yybgö


	)

83 
	#yy¸™k
 
socks_yy¸™k


	)

84 
	#yye°©e
 
socks_yye°©e


	)

85 
	#yyexåa
 
socks_yyexåa


	)

86 
	#yy‚d
 
socks_yy‚d


	)

87 
	#yyö
 
socks_yyö


	)

88 
	#yyöput
 
socks_yyöput


	)

89 
	#yyÀng
 
socks_yyÀng


	)

90 
	#yyÀx
 
socks_yyÀx


	)

91 
	#yylöío
 
socks_yylöío


	)

92 
	#yylook
 
socks_yylook


	)

93 
	#yyl•
 
socks_yyl•


	)

94 
	#yyl°©e
 
socks_yyl°©e


	)

95 
	#yylvÆ
 
socks_yylvÆ


	)

96 
	#yym©ch
 
socks_yym©ch


	)

97 
	#yym‹fg
 
socks_yym‹fg


	)

98 
	#yyﬁ•
 
socks_yyﬁ•


	)

99 
	#yyout
 
socks_yyout


	)

100 
	#yyoutout
 
socks_yyoutout


	)

101 
	#yy¥evious
 
socks_yy¥evious


	)

102 
	#yysbuf
 
socks_yysbuf


	)

103 
	#yy•å
 
socks_yy•å


	)

104 
	#yysvec
 
socks_yysvec


	)

105 
	#yytch¨
 
socks_yytch¨


	)

106 
	#yyãxt
 
socks_yyãxt


	)

107 
	#yyt›
 
socks_yyt›


	)

108 
	#yyu≈ut
 
socks_yyu≈ut


	)

109 
	#yyv°›
 
socks_yyv°›


	)

111 
	#yy_¸óã_buf„r
 
socks_yy_¸óã_buf„r


	)

112 
	#yy_dñëe_buf„r
 
socks_yy_dñëe_buf„r


	)

113 
	#yy_öô_buf„r
 
socks_yy_öô_buf„r


	)

114 
	#yy_lﬂd_buf„r_°©e
 
socks_yy_lﬂd_buf„r_°©e


	)

115 
	#yy_swôch_to_buf„r
 
socks_yy_swôch_to_buf„r


	)

116 
	#yyÀng
 
socks_yyÀng


	)

117 
	#yyª°¨t
 
socks_yyª°¨t


	)

121 íum { 
	mVALUETYPE_ERRNO
 = 1, 
	mVALUETYPE_GAIERR
 } 
	tvÆuëy≥_t
;

124 
	$yyw¨n
(c⁄° *
fmt
, ...)

125 
	`__ATTRIBUTE__
((
	`FORMAT
(
¥ötf
, 1, 2)));

128 
	$yyw¨nx
(c⁄° *
fmt
, ...)

129 
	`__ATTRIBUTE__
((
	`FORMAT
(
¥ötf
, 1, 2)));

136 
	$yyîr‹
(c⁄° *
fmt
, ...)

137 
	`__ATTRIBUTE__
((
	`FORMAT
(
¥ötf
, 1, 2)));

140 
	$yyîr‹x
(c⁄° *
fmt
, ...)

141 
	`__ATTRIBUTE__
((
	`FORMAT
(
¥ötf
, 1, 2)));

149 
	$yylog
(c⁄° 
logÀvñ
, c⁄° *
fmt
, ...)

150 
	`__ATTRIBUTE__
((
	`FORMAT
(
¥ötf
, 2, 3)));

157 
	`yyîr‹x_nﬁib
(c⁄° *
libøry
);

158 
	`yyw¨nx_dïªˇãd
(c⁄° *
ﬁdkeyw‹d
, c⁄° *
√wkeyw‹d
);

159 
	`yyîr‹x_n⁄ëmask
();

160 
	`yyîr‹x_ha¢ëmask
();

	@lib/Raccept.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
addf‹w¨ded
(c⁄° 
loˇl
, c⁄° 
ªmŸe
,

52 c⁄° 
sockaddr_°‹age
 *
ªmŸóddr
,

53 c⁄° 
socksho°_t
 *
vútuÆªmŸóddr
);

65 
	$Rac˚±
(
s
, 
addr
, 
addæí
)

66 
s
;

67 
sockaddr
 *
addr
;

68 
sockÀn_t
 *
addæí
;

70 c⁄° *
fun˘i⁄
 = "Raccept()";

71 
fd_£t
 *
r£t
;

72 
socksfd_t
 
socksfd
;

73 
emsg
[256];

74 
sockaddr_°‹age
 
ac˚±ed
;

75 
socks_t
 
∑ckë
;

76 
fdbôs
, 
p
, 
ªmŸe
;

78 
	`˛õ¡öô
();

80 
	`¶og
(
LOG_DEBUG
, "%s, fd %d,áddrlen %lu",

81 
fun˘i⁄
, 
s
, ()*
addæí
);

84 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1)

85 || 
socksfd
.
°©e
.
comm™d
 !
SOCKS_BIND
) {

86 
sockaddr_°‹age
 
ss
;

88 
p
 = 
	`ac˚±
(
s
, 
addr
, 
addæí
);

90 i‡(
addr
 !
NULL
 && *
addæí
 >(
sockaddr_ö
))

91 
	`u§sockaddr˝y
(&
ss
, 
	`TOSS
(
addr
), (ss));

93 
	`¶og
(
LOG_DEBUG
,

95 
fun˘i⁄
,

96 
s
,

97 
p
,

98 
p
 >= 0

99 && 
addr
 !
NULL


100 && *
addæí
 >(
sockaddr_ö
) ?

101 
	`sockaddr2°rög
(&
ss
, 
NULL
, 0) : "N/A",

102 
	`°ªº‹
(
î∫o
));

104 
	`socks_rmaddr
(
s
, 1);

106  
p
;

109 
	`¶og
(
LOG_DEBUG
, "%s: fd %d is setup forÖroxyprotocol %s",

110 
fun˘i⁄
, 
s
, 
	`¥oxy¥Ÿocﬁ2°rög
(
socksfd
.
°©e
.
vîsi⁄
));

112 
	`bzîo
(&
∑ckë
, (packet));

113 
∑ckë
.
vîsi⁄
 = ()
socksfd
.
°©e
.version;

115 
	`SASSERTX
(
s
 =
socksfd
.
c⁄åﬁ
);

117 
∑ckë
.
vîsi⁄
) {

118 
PROXY_SOCKS_V4
:

119 
PROXY_SOCKS_V5
:

123 i‡(
socksfd
.
f‹us
.
ac˚±ed
.
©y≥
 !
SOCKS_ADDR_NOTSET


124 && !
socksfd
.
°©e
.
ac˚±≥ndög
) {

130 
	`¶og
(
LOG_INFO
,

135 
fun˘i⁄
,

136 
	`socksho°2°rög
(&
socksfd
.
f‹us
.
ac˚±ed
, 
NULL
, 0),

137 
s
);

139 
î∫o
 = 
EWOULDBLOCK
;

145 
PROXY_UPNP
: {

146 
sockaddr_°‹age
 
addøc˚±ed
;

147 
sockÀn_t
 
ac˚±edÀn
 = (
addøc˚±ed
);

148 
˛õ¡
;

150 
	`¶og
(
LOG_DEBUG
,

153 
fun˘i⁄
, 
s
);

155 
˛õ¡
 = 
	`ac˚±
(
s
, 
	`TOSA
(&
addøc˚±ed
), &
ac˚±edÀn
);

156 
	`mem˝y
(
addr
, &
addøc˚±ed
, 
	`MIN
(*
addæí
, 
ac˚±edÀn
));

158 i‡(
˛õ¡
 != -1) {

159 i‡(
	`addf‹w¨ded
(
s
,

160 
˛õ¡
,

161 &
addøc˚±ed
,

162 
	`sockaddr2socksho°
(&
addøc˚±ed
, 
NULL
))

167  
˛õ¡
;

171 
	`SERRX
(
∑ckë
.
vîsi⁄
);

174 
r£t
 = 
	`Æloˇã_maxsize_fd£t
();

176 
	`FD_ZERO
(
r£t
);

177 
fdbôs
 = -1;

179 
	`FD_SET
(
s
, 
r£t
);

180 
fdbôs
 = 
	`MAX
(fdbôs, 
s
);

182 
	`SASSERTX
(
fdbôs
 >= 0);

183 ++
fdbôs
;

185 i‡(
	`fdisblockög
(
socksfd
.
c⁄åﬁ
))

186 
p
 = 
	`£À˘n
(
fdbôs
, 
r£t
, 
NULL
, NULL, NULL, NULL, NULL);

188 
timevÆ
 
timeout
;

190 
timeout
.
tv_£c
 = 0;

191 
timeout
.
tv_u£c
 = 0;

193 i‡((
p
 = 
	`£À˘n
(
fdbôs
, 
r£t
, 
NULL
, NULL, NULL, NULL, &
timeout
)) == 0) {

194 
î∫o
 = 
EWOULDBLOCK
;

195 
p
 = -1;

199 i‡(
p
 == -1) {

200 
	`‰ì
(
r£t
);

204 
	`SASSERTX
(
p
 > 0);

205 
	`SASSERTX
(
	`FD_ISSET
(
s
, 
r£t
));

207 
	`‰ì
(
r£t
);

209 i‡(!
socksfd
.
°©e
.
ac˚±≥ndög
) {

214 
∑ckë
.
vîsi⁄
) {

215 
PROXY_SOCKS_V4
:

216 
PROXY_SOCKS_V5
: {

217 
socksfd_t
 
sfddup
, *
±r
;

218 
dummy
;

220 
∑ckë
.
ªs
.
auth
 = &
socksfd
.
°©e
.auth;

221 i‡(
	`socks_ªcvª•⁄£
(
socksfd
.
c⁄åﬁ
,

222 &
∑ckë
.
ªs
,

223 
∑ckë
.
vîsi⁄
,

224 
emsg
,

225 (
emsg
)) != 0) {

226 
	`¶og
(
LOG_INFO
, "%s: socks_recvresponse() failed: %s,Érrno: %d",

227 
fun˘i⁄
, 
emsg
, 
î∫o
);

232 
±r
 = 
	`socks_gëaddr
(
socksfd
.
c⁄åﬁ
, &socksfd, 1);

233 
	`SASSERTX
(
±r
 !
NULL
);

235 
socksfd
.
f‹us
.
ac˚±ed
 = 
∑ckë
.
ªs
.
ho°
;

236 
	`socks_addaddr
(
socksfd
.
c⁄åﬁ
, &socksfd, 1);

246 i‡((
ªmŸe
 = 
	`dup
(
socksfd
.
c⁄åﬁ
)) == -1) {

247 
	`sw¨n
("%s: dup(socksfd.c⁄åﬁËÁûed", 
fun˘i⁄
);

251 
sfddup
 = 
socksfd
;

252 
sfddup
.
c⁄åﬁ
 = 
ªmŸe
;

259 
	`socks_rmaddr
(
ªmŸe
, 1);

261 
	`socks_addaddr
(
ªmŸe
, &
sfddup
, 1);

262 
	`socks_Ælocbuf„r
(
ªmŸe
, 
SOCK_STREAM
);

270 i‡((
dummy
 = 
	`makedummyfd
(
AF_INET
, 
SOCK_STREAM
)) == -1) {

271 
	`sw¨n
("%s: couldÇot create dummy (AF_INET, SOCK_STREAM) socket",

272 
fun˘i⁄
);

277 
p
 = 
	`dup2
(
dummy
, 
socksfd
.
c⁄åﬁ
);

278 
	`˛o£
(
dummy
);

280 i‡(
p
 == -1) {

281 
	`sw¨n
("%s: dup2(socksfd.c⁄åﬁ, dummyËÁûed", 
fun˘i⁄
);

285 
	`socks_addaddr
(
socksfd
.
c⁄åﬁ
, &socksfd, 1);

290 
	`SERRX
(
∑ckë
.
vîsi⁄
);

293 
	`socksho°2sockaddr
(&
socksfd
.
f‹us
.
ac˚±ed
, &accepted);

295 
	`¶og
(
LOG_INFO
,

298 
fun˘i⁄
, 
	`sockaddr2°rög
(&
ac˚±ed
, 
NULL
, 0), 
s
, 
ªmŸe
);

304 
sockÀn_t
 
Àn
;

306 
Àn
 = (
ac˚±ed
);

307 i‡((
ªmŸe
 = 
	`ac˚±
(
s
, 
	`TOSA
(&
ac˚±ed
), &
Àn
)) == -1)

310 
	`¶og
(
LOG_INFO
, "%s:áccepted: %s",

311 
fun˘i⁄
, 
	`sockaddr2°rög
(&
ac˚±ed
, 
NULL
, 0));

313 i‡(
socksfd
.
°©e
.
ac˚±≥ndög
) {

319 i‡(
	`memcmp
(
	`GET_SOCKADDRADDR
(&
ac˚±ed
),

320 
	`GET_SOCKADDRADDR
(&
socksfd
.
ª∂y
),

321 
	`ßÀn
(
ac˚±ed
.
ss_Ámûy
)) == 0) {

326 
f‹w¨ded
;

328 
	`¶og
(
LOG_INFO
,

331 
fun˘i⁄
, 
	`sockaddr2°rög
(&
ac˚±ed
, 
NULL
, 0));

333 
socksfd
.
°©e
.
vîsi⁄
) {

334 
PROXY_SOCKS_V4
:

335 
PROXY_SOCKS_V5
: {

336 
authmëhod_t
 
auth
 = 
socksfd
.
°©e
.auth;

338 
∑ckë
.
ªq
.
vîsi⁄
 = ()
socksfd
.
°©e
.version;

339 
∑ckë
.
ªq
.
comm™d
 = 
SOCKS_BIND
;

340 
∑ckë
.
ªq
.
Êag
 = 0;

341 
	`sockaddr2socksho°
(&
ac˚±ed
, &
∑ckë
.
ªq
.
ho°
);

342 
∑ckë
.
ªq
.
auth
 = &auth;

344 i‡(
	`socks_£ndªque°
(
socksfd
.
c⁄åﬁ
,

345 &
∑ckë
.
ªq
,

346 
emsg
,

347 (
emsg
)) != 0) {

348 
	`sw¨nx
("%s: socks_sendrequest() failed: %s",

349 
fun˘i⁄
, 
emsg
);

351 
	`˛o£
(
ªmŸe
);

355 i‡(
	`socks_ªcvª•⁄£
(
socksfd
.
c⁄åﬁ
,

356 &
∑ckë
.
ªs
,

357 
∑ckë
.
ªq
.
vîsi⁄
,

358 
emsg
,

359 (
emsg
)) != 0) {

360 
	`sw¨nx
("%s: socks_recvresponse() failed: %s",

361 
fun˘i⁄
, 
emsg
);

363 
	`˛o£
(
ªmŸe
);

367 i‡(
∑ckë
.
ªs
.
ho°
.
©y≥
 !
SOCKS_ADDR_IPV4
) {

368 
	`sw¨nx
("%s: unexpectedátype in bindqueryÑesponse: %d",

369 
fun˘i⁄
, 
∑ckë
.
ªs
.
ho°
.
©y≥
);

370 
	`˛o£
(
ªmŸe
);

371 
î∫o
 = 
ECONNABORTED
;

375 i‡(
∑ckë
.
ªs
.
ho°
.
addr
.
ùv4
.
s_addr
 =
	`ht⁄l
(0))

376 
f‹w¨ded
 = 0;

378 
f‹w¨ded
 = 1;

383 
	`SERRX
(
socksfd
.
°©e
.
vîsi⁄
);

386 i‡(
f‹w¨ded
) {

387 i‡(
	`addf‹w¨ded
(
s
, 
ªmŸe
, &
ac˚±ed
, &
∑ckë
.
ªs
.
ho°
) != 0)

394 
	`SWARNX
(0);

397 i‡(
addr
 !
NULL
) {

398 *
addæí
 = 
	`MIN
(*addæí, (
sockÀn_t
)(
ac˚±ed
));

399 
	`sockaddr˝y
(
	`TOSS
(
addr
), &
ac˚±ed
, (
size_t
)*
addæí
);

402  
ªmŸe
;

403 
	}
}

406 
	$addf‹w¨ded
(
loˇl
, 
ªmŸe
, 
ªmŸóddr
, 
vútuÆªmŸóddr
)

407 c⁄° 
loˇl
;

408 c⁄° 
ªmŸe
;

409 c⁄° 
sockaddr_°‹age
 *
ªmŸóddr
;

410 c⁄° 
socksho°_t
 *
vútuÆªmŸóddr
;

412 c⁄° *
fun˘i⁄
 = "addforwarded()";

413 
sockÀn_t
 
Àn
;

414 
socksfd_t
 
socksfd
, 
rfd
, *
p
;

415 
øddr
[
MAXSOCKADDRSTRING
], 
vaddr
[
MAXSOCKSHOSTSTRING
];

417 
	`¶og
(
LOG_DEBUG
,

420 
fun˘i⁄
,

421 
ªmŸe
,

422 
loˇl
,

423 
	`sockaddr2°rög
(
ªmŸóddr
, 
øddr
, (raddr)),

424 
	`socksho°2°rög
(
vútuÆªmŸóddr
, 
vaddr
, (vaddr)));

427 
p
 = 
	`socks_gëaddr
(
loˇl
, &
socksfd
, 1);

428 
	`SASSERTX
(
p
 !
NULL
);

430 i‡(
	`socks_addrdup
(
p
, &
rfd
Ë=
NULL
) {

431 
	`sw¨n
("%s: socks_addrdup()", 
fun˘i⁄
);

433 i‡(
î∫o
 =
EBADF
)

434 
	`socks_rmaddr
(
loˇl
, 1);

444 
rfd
.
°©e
.
ac˚±≥ndög
 = 0;

445 
	`sockaddr˝y
(&
rfd
.
ªmŸe
, 
ªmŸóddr
, 
	`ßÀn
‘fd.ªmŸe.
ss_Ámûy
));

446 
rfd
.
f‹us
.
ac˚±ed
 = *
vútuÆªmŸóddr
;

449 i‡(!
	`ADDRISBOUND
(&
rfd
.
loˇl
)) {

450 
Àn
 = (
rfd
.
loˇl
);

451 i‡(
	`gësock«me
(
ªmŸe
, 
	`TOSA
(&
rfd
.
loˇl
), &
Àn
) != 0)

452 
	`sw¨n
("%s: gësock«me‘emŸe)", 
fun˘i⁄
);

455 
	`socks_addaddr
(
ªmŸe
, &
rfd
, 1);

458 
	}
}

	@lib/Rbind.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$Rböd
(
s
, 
_«me
, 
«mñí
)

52 
s
;

53 c⁄° 
sockaddr
 *
_«me
;

54 
sockÀn_t
 
«mñí
;

56 c⁄° *
fun˘i⁄
 = "Rbind()";

57 
sockaddr_°‹age
 
«memem
, *
«me
 = &namemem;

58 
authmëhod_t
 
auth
;

59 
socksfd_t
 
socksfd
;

60 
sockÀn_t
 
Àn
;

61 
socks_t
 
∑ckë
;

62 
emsg
[256];

63 
vÆ
, 
rc
, 
Êags
, 
î∫o_s
;

65 
	`˛õ¡öô
();

68 i‡(
	`socks_gëív
(
ENV_SOCKS_BINDLOCALONLY
, 
d⁄tˇª
Ë!
NULL
)

69  
	`böd
(
s
, 
_«me
, 
«mñí
);

71 i‡(
_«me
 =
NULL
) {

72 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, _name = %p",

73 
fun˘i⁄
, 
s
, 
_«me
);

75  
	`böd
(
s
, 
_«me
, 
«mñí
);

78 
	`u§sockaddr˝y
(
«me
, 
	`TOCSS
(
_«me
), 
	`ßÀn
(_«me->
ß_Ámûy
));

80 
	`¶og
(
LOG_DEBUG
, "%s, fd %d,áddress %s",

81 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(
	`TOSS
(
«me
), 
NULL
, 0));

86 
	`socks_rmaddr
(
s
, 1);

88 i‡(
	`TOSA
(
«me
)->
ß_Ámûy
 !
AF_INET
) {

89 
	`¶og
(
LOG_INFO
, "%s: fd %d, unsupportedáf %s, system fallback",

90 
fun˘i⁄
, 
s
, 
	`ßÁmûy2°rög
(
«me
->
ss_Ámûy
));

92  
	`böd
(
s
, 
_«me
, 
«mñí
);

95 i‡(
	`socks_sockëisf‹œn
(
s
)) {

96 
	`¶og
(
LOG_INFO
, "%s: fd %d is forÜan only, system bind fallback",

97 
fun˘i⁄
, 
s
);

99  
	`böd
(
s
, 
_«me
, 
«mñí
);

102 
	`bzîo
(&
auth
, (auth));

103 
auth
.
mëhod
 = 
AUTHMETHOD_NOTSET
;

105 
	`bzîo
(&
∑ckë
, (packet));

106 
∑ckë
.
ªq
.
vîsi⁄
 = 
PROXY_DIRECT
;

107 
∑ckë
.
ªq
.
comm™d
 = 
SOCKS_BIND
;

108 
∑ckë
.
ªq
.
ho°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

109 
∑ckë
.
ªq
.
ho°
.
addr
.
ùv4
 = 
	`TOIN
(&
sockscf
.
°©e
.
œ°c⁄√˘
)->
sö_addr
;

110 
∑ckë
.
ªq
.
ho°
.
p‹t
 = 
	`GET_SOCKADDRPORT
(
«me
);

111 
∑ckë
.
ªq
.
auth
 = &auth;

113 
Àn
 = (
vÆ
);

114 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
vÆ
, &
Àn
) != 0) {

115 
	`sw¨n
("%s: gësock›t(SO_TYPE)", 
fun˘i⁄
);

119 
vÆ
) {

120 
SOCK_DGRAM
:

121 
∑ckë
.
ªq
.
¥Ÿocﬁ
 = 
SOCKS_UDP
;

124 
SOCK_STREAM
:

125 
∑ckë
.
ªq
.
¥Ÿocﬁ
 = 
SOCKS_TCP
;

129 
	`sw¨nx
("%s: unknown socket-type %d, falling backÅo system bind(2)",

130 
fun˘i⁄
, 
vÆ
);

132  
	`böd
(
s
, 
_«me
, 
«mñí
);

135 
	`bzîo
(&
socksfd
, (socksfd));

137 i‡((
socksfd
.
rouã
 = 
	`socks_ªque°pﬁish
(&
∑ckë
.
ªq
, 
NULL
, NULL)) == NULL) {

173 
	`¶og
(
LOG_INFO
,

179 
fun˘i⁄
,

180 
	`¥Ÿocﬁ2°rög
(
∑ckë
.
ªq
.
¥Ÿocﬁ
),

181 
	`sockaddr2°rög
(
«me
, 
NULL
, 0));

183 
î∫o
 = 0;

187 
∑ckë
.
vîsi⁄
 =Öackë.
ªq
.version;

189 i‡(
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

190 
	`¶og
(
LOG_DEBUG
, "%s: usög sy°em böd(2Ëf‹ fd %d", 
fun˘i⁄
, 
s
);

191  
	`böd
(
s
, 
_«me
, 
«mñí
);

202 
socksfd
.
c⁄åﬁ
 = 
s
;

204 i‡(
	`socks_rouã£tup
(
socksfd
.
c⁄åﬁ
, 
s
, socksfd.
rouã
, 
emsg
, (emsg))

206 
	`sw¨nx
("%s: socks_rouã£tup(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

208 i‡(
socksfd
.
c⁄åﬁ
 !
s
)

209 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

219 
Êags
 = 
	`£tblockög
(
socksfd
.
c⁄åﬁ
, "socket used forÇegotiation");

221 
socksfd
.
rouã
 = 
	`socks_c⁄√˘rouã
(socksfd.
c⁄åﬁ
,

222 &
∑ckë
,

223 
NULL
,

224 
NULL
,

225 
emsg
,

226 (
emsg
));

228 i‡(
socksfd
.
rouã
 =
NULL
 || socksfd.rouã->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

229 i‡(
Êags
 != -1)

230 i‡(
	`f˙é
(
socksfd
.
c⁄åﬁ
, 
F_SETFL
, 
Êags
) == -1)

231 
	`sw¨n
("%s: f˙é(s)", 
fun˘i⁄
);

234 i‡(
socksfd
.
rouã
 =
NULL
) {

235 
	`sw¨nx
("%s: couldÇŸ c⁄√˘Ñouã: %s", 
fun˘i⁄
, 
emsg
);

237 
î∫o
 = 
EADDRNOTAVAIL
;

241 i‡(
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

242 
	`¶og
(
LOG_INFO
,

245 
fun˘i⁄
, 
s
);

247  
	`böd
(
s
, 
_«me
, 
«mñí
);

250 
rc
 = 
	`socks_√gŸüã
(
s
,

251 
socksfd
.
c⁄åﬁ
,

252 &
∑ckë
,

253 
socksfd
.
rouã
,

254 
emsg
,

255 (
emsg
));

257 
î∫o_s
 = 
î∫o
;

259 i‡(
Êags
 != -1)

260 i‡(
	`f˙é
(
socksfd
.
c⁄åﬁ
, 
F_SETFL
, 
Êags
) == -1)

261 
	`sw¨n
("%s: f˙é(s)", 
fun˘i⁄
);

263 i‡(
rc
 != 0) {

264 
î∫o
 = 
î∫o_s
;

266 
	`sw¨nx
("%s: socks_√gŸüã(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

268 
	`¶og
(
LOG_DEBUG
,

270 
fun˘i⁄
, 
î∫o
, 
	`°ªº‹
(errno));

275 
	`upd©e_a·î_√gŸüã
(&
∑ckë
, &
socksfd
);

277 i‡(
∑ckë
.
ªq
.
¥Ÿocﬁ
 =
SOCKS_TCP
)

278 
socksfd
.
°©e
.
¥Ÿocﬁ
.
t˝
 = 1;

279 i‡(
∑ckë
.
ªq
.
¥Ÿocﬁ
 =
SOCKS_UDP
)

280 
socksfd
.
°©e
.
¥Ÿocﬁ
.
udp
 = 1;

282 
socksfd
.
°©e
.
vîsi⁄
 = 
∑ckë
.
ªq
.version;

283 
	`socksho°2sockaddr
(&
∑ckë
.
ªs
.
ho°
, &
socksfd
.
ªmŸe
);

285 
∑ckë
.
ªq
.
vîsi⁄
) {

286 
PROXY_SOCKS_V4
:

287 i‡(
	`TOIN
(&
socksfd
.
ªmŸe
)->
sö_addr
.
s_addr
 =
	`ht⁄l
(0)) {

292 
sockaddr_ö
 
addr
;

294 
Àn
 = (
addr
);

295 i‡(
	`gë≥î«me
(
socksfd
.
c⁄åﬁ
, 
	`TOSA
(&
addr
), &
Àn
) != 0)

296 
	`SERR
(-1);

298 
	`TOIN
(&
socksfd
.
ªmŸe
)->
sö_addr
 = 
addr
.sin_addr;

302 
PROXY_SOCKS_V5
:

303 
socksfd
.
ª∂y
 = socksfd.
ªmŸe
;

304 
socksfd
.
°©e
.
ac˚±≥ndög
 = socksfd.
rouã
->
gw
.°©e.
exãnsi⁄
.
böd
;

307 
PROXY_UPNP
:

309 
socksfd
.
°©e
.
ac˚±≥ndög
 = 1;

313 
	`SERRX
(
∑ckë
.
ªq
.
vîsi⁄
);

317 i‡(
	`TOIN
(
«me
)->
sö_p‹t
 !
	`ht⁄s
(0)

318 && 
	`TOIN
(
«me
)->
sö_p‹t
 !TOIN(&
socksfd
.
ªmŸe
)->sin_port) {

319 
	`socks_‰ìbuf„r
(
socksfd
.
c⁄åﬁ
);

321 
	`¶og
(
LOG_INFO
,

324 
fun˘i⁄
,

325 
	`¡ohs
(
	`GET_SOCKADDRPORT
(
«me
)),

326 
	`¡ohs
(
	`GET_SOCKADDRPORT
(&
socksfd
.
ªmŸe
)));

328 
î∫o
 = 
EADDRINUSE
;

332 
Àn
 = (
socksfd
.
loˇl
);

333 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), &
Àn
) != 0) {

334 
	`sw¨n
("%s: gësock«me(Ëo‡fd %d faûed", 
fun˘i⁄
, 
s
);

338 
	`¶og
(
LOG_DEBUG
, "%s:áddress of fd %d is %s",

339 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
NULL
, 0));

342 i‡(
socksfd
.
c⁄åﬁ
 !
s
) {

343 
Àn
 = (
socksfd
.
£rvî
);

344 i‡(
	`gë≥î«me
(
socksfd
.
c⁄åﬁ
, 
	`TOSA
(&socksfd.
£rvî
), &
Àn
) != 0) {

349 i‡(
socksfd
.
°©e
.
ac˚±≥ndög
)

355 
	`socks_‰ìbuf„r
(
socksfd
.
c⁄åﬁ
);

357 
socksfd
.
°©e
.
vîsi⁄
) {

358 
PROXY_SOCKS_V4
:

359 
PROXY_SOCKS_V5
:

360 
PROXY_UPNP
:

361 
	`socks_addaddr
(
s
, &
socksfd
, 1);

365 
	`SERRX
(
socksfd
.
°©e
.
vîsi⁄
);

368 
	`¶og
(
LOG_INFO
, "%s: successfully boundáddress %s for fd %d",

369 
fun˘i⁄
, 
	`sockaddr2°rög
(&
socksfd
.
ªmŸe
, 
NULL
, 0), 
s
);

372 
	}
}

379 
socks_böd_udp
(c⁄° 
s
, 
sockaddr_°‹age
 *
addr
);

387 
	$socks_böd_udp
(
s
, 
addr
)

388 c⁄° 
s
;

389 
sockaddr_°‹age
 *
addr
;

401 c⁄° *
fun˘i⁄
 = "socks_bind_udp()";

402 c⁄° 
î∫o_s
 = 
î∫o
;

403 
sockaddr_°‹age
 
‰om
;

404 
socksfd_t
 
socksfd
;

405 
sockÀn_t
 
Àn
;

406 
ssize_t
 
rc
;

407 *
p
, 
emsg
[1024], 
buf
[256];

409 
î∫o
 = 
EADDRNOTAVAIL
;

411 
	`¶og
(
LOG_INFO
, "%s: fd %d,áddress %s",

412 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(
addr
, 
NULL
, 0));

420 
	`bzîo
(&
socksfd
, (socksfd));

422 
socksfd
.
°©e
.
comm™d
 = 
SOCKS_BIND
;

424 
Àn
 = (
socksfd
.
loˇl
);

425 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), &
Àn
) == -1)

428 
	`socks_addaddr
(
s
, &
socksfd
, 1);

430 
socksfd
.
rouã
 = 
	`udp£tup
(
s
,

431 &
socksfd
.
loˇl
,

432 
SOCKS_SEND
,

434 
emsg
,

435 (
emsg
));

437 i‡(
socksfd
.
rouã
 =
NULL
) {

438 
	`¶og
(
LOG_INFO
, "%s: udpsetup() for udp bind on fd %d failed: %s",

439 
fun˘i⁄
, 
s
, 
emsg
);

444 i‡(
	`socks_gëaddr
(
s
, &
socksfd
, 1) == 0) {

445 
	`sw¨nx
("%s: strange, socks_getaddr() on fd %d failedáfter udpsetup()",

446 
fun˘i⁄
, 
s
);

451 
	`¶og
(
LOG_INFO
,

454 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
NULL
, 0));

456 
p
 = "I just wantÅo know whatáddress youáre using on my behalf";

457 i‡(
	`R£ndto
(
s
, 
p
, 
	`°æí
’), 0, 
	`TOSA
(&
socksfd
.
loˇl
), (socksfd.local))

458 !(
ssize_t
)
	`°æí
(
p
)) {

459 
	`¶og
(
LOG_INFO
,

462 
fun˘i⁄
, 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
NULL
, 0), 
s
);

467 
	`¶og
(
LOG_DEBUG
,

470 
fun˘i⁄
, 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
NULL
, 0));

472 
Àn
 = (
‰om
);

473 i‡((
rc
 = 
	`ªcv‰om
(
s
, 
buf
, (buf), 0, 
	`TOSA
(&
‰om
), &
Àn
))

474 !(
ssize_t
)
	`°æí
(
p
)) {

475 
	`sw¨n
("%s:ÉxpectedÅoÑeceive our own udpÖacket ofÜength %lu back, "

477 
fun˘i⁄
,

478 ()
	`°æí
(
p
),

479 ()
rc
,

480 
rc
 == 1 ? "" : "s");

485 i‡(
	`°rcmp
(
buf
, 
p
) == 0)

486 
	`¶og
(
LOG_INFO
, "%s:Ñeceived our own %lu bytes from %s:állásÉxpected",

487 
fun˘i⁄
, 
rc
, 
	`sockaddr2°rög
(&
‰om
, 
NULL
, 0));

489 
visbuf
[(
buf
) * 4];

491 
	`sw¨nx
("%s: bytesÑeceived from %sÇot what weÉxpected. "

493 
fun˘i⁄
,

494 
	`sockaddr2°rög
(&
‰om
, 
NULL
, 0),

495 
p
,

496 
	`°r2vis
(
buf
, 
rc
, 
visbuf
, (visbuf)));

503 
î∫o
 = 
î∫o_s
;;

505 
	}
}

	@lib/Rbindresvport.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

55 
	$Rbödªsvp‹t
(
s
, 
_sö
)

56 
s
;

57 
sockaddr_ö
 *
_sö
;

59 c⁄° *
fun˘i⁄
 = "Rbindresvport()";

60 
sockaddr_°‹age
 
sö
;

61 
sockÀn_t
 
söÀn
;

62 
rc
;

64 
	`˛õ¡öô
();

66 
	`¶og
(
LOG_DEBUG
, "%s, fd %d", 
fun˘i⁄
, 
s
);

71 
	`socks_rmaddr
(
s
, 1);

73 i‡(
_sö
 =
NULL
) {

74 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, _sö = %p", 
fun˘i⁄
, 
s
, 
_sö
);

75  
	`bödªsvp‹t
(
s
, 
_sö
);

78 
	`u§sockaddr˝y
(&
sö
, 
	`TOSS
(
_sö
), (*_sin));

79 i‡(
	`bödªsvp‹t
(
s
, 
	`TOIN
(&
sö
)) != 0) {

80 
	`¶og
(
LOG_DEBUG
, "%s: bindresvport(%d, %s) failed: %s",

81 
fun˘i⁄
,

82 
s
,

83 
	`sockaddr2°rög
(&
sö
, 
NULL
, 0),

84 
	`°ªº‹
(
î∫o
));

90 
söÀn
 = 
	`ßÀn
(
sö
.
ss_Ámûy
);

91 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
sö
), &
söÀn
) != 0)

99 i‡((
rc
 = 
	`Rböd
(
s
, 
	`TOSA
(&
sö
), 
söÀn
)) == -1)

102 
	`sockaddr˝y
(
	`TOSS
(
_sö
), &
sö
, 
	`ßÀn
(sö.
ss_Ámûy
));

104  
rc
;

105 
	}
}

	@lib/Rcompat.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$R£À˘
(
nfds
, 
ªadfds
, 
wrôefds
, 
ex˚±fds
, 
timeout
)

52 
nfds
;

53 
fd_£t
 *
ªadfds
;

54 
fd_£t
 *
wrôefds
;

55 
fd_£t
 *
ex˚±fds
;

56 
timevÆ
 *
timeout
;

58  
	`£À˘
(
nfds
, 
ªadfds
, 
wrôefds
, 
ex˚±fds
, 
timeout
);

59 
	}
}

61 
ssize_t


62 
	$Rwrôe
(
d
, 
buf
, 
nbyãs
)

63 
d
;

64 c⁄° *
buf
;

65 
size_t
 
nbyãs
;

67 c⁄° *
fun˘i⁄
 = "Rwrite()";

69 
	`˛õ¡öô
();

71 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, byã†%lu", 
fun˘i⁄
, 
d
, ()
nbyãs
);

73  
	`R£nd
(
d
, 
buf
, 
nbyãs
, 0);

74 
	}
}

76 
ssize_t


77 
	$Rwrôev
(
d
, 
iov
, 
iov˙t
)

78 
d
;

79 c⁄° 
iovec
 *
iov
;

80 
iov˙t
;

82 
msghdr
 
msg
;

83 c⁄° *
fun˘i⁄
 = "Rwritev()";

85 
	`˛õ¡öô
();

87 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, iov˙à%d", 
fun˘i⁄
, 
d
, 
iov˙t
);

89 
	`bzîo
(&
msg
, (msg));

90 
msg
.
msg_iov
 = 
iov
;

91 
msg
.
msg_iovÀn
 = 
iov˙t
;

93  
	`R£ndmsg
(
d
, &
msg
, 0);

94 
	}
}

96 
ssize_t


97 
	$R£nd
(
s
, 
msg
, 
Àn
, 
Êags
)

98 
s
;

99 c⁄° *
msg
;

100 
size_t
 
Àn
;

101 
Êags
;

103 c⁄° *
fun˘i⁄
 = "Rsend()";

104 
msghdr
 msghdr;

106 
iovec
 
iov
 = { 
msg
, 
Àn
 };

108 
	`˛õ¡öô
();

110 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, bytes %lu, flags %d",

111 
fun˘i⁄
, 
s
, ()
Àn
, 
Êags
);

113 
	`bzîo
(&
msghdr
, (msghdr));

114 
msghdr
.
msg_iov
 = &
iov
;

115 
msghdr
.
msg_iovÀn
 = 1;

117  
	`R£ndmsg
(
s
, &
msghdr
, 
Êags
);

118 
	}
}

120 
ssize_t


121 
	$R£ndmsg
(
s
, 
msg
, 
Êags
)

122 
s
;

123 c⁄° 
msghdr
 *
msg
;

124 
Êags
;

126 c⁄° 
î∫o_s
 = 
î∫o
;

127 
size_t
 
£¡
, 
ioc
;

128 
ssize_t
 
rc
;

129 
sockaddr_°‹age
 
«me
;

130 
sockÀn_t
 
«mñí
;

131 c⁄° *
fun˘i⁄
 = "Rsendmsg()";

133 
	`˛õ¡öô
();

135 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, msg %p, flags %d",

136 
fun˘i⁄
, 
s
, 
msg
, 
Êags
);

138 i‡(
msg
 =
NULL
)

139  
	`wrôe
(
s
, 
NULL
, 0);

141 
«mñí
 = (
«me
);

142 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
«me
), &
«mñí
) == -1) {

143 
î∫o
 = 
î∫o_s
;

144  
	`wrôev
(
s
, 
msg
->
msg_iov
, ()msg->
msg_iovÀn
);

147 
	`TOSA
(&
«me
)->
ß_Ámûy
) {

148 
AF_INET
:

151 
AF_INET6
:

155  
	`£ndmsg
(
s
, 
msg
, 
Êags
);

158 
£¡
 = 
ioc
 = 
rc
 = 0; io¯< (
size_t
)
msg
->
msg_iovÀn
; ++ioc) {

159 i‡((
rc
 = 
	`R£ndto
(
s
,

160 
msg
->
msg_iov
[
ioc
].
iov_ba£
,

161 
msg
->
msg_iov
[
ioc
].
iov_Àn
,

162 
Êags
,

163 
	`TOSA
(
msg
->
msg_«me
),

164 
msg
->
msg_«mñí
)) == -1)

167 
£¡
 +
rc
;

169 i‡(
rc
 !(
ssize_t
)
msg
->
msg_iov
[
ioc
].
iov_Àn
)

173 i‡(
£¡
 <= 0)

174  
rc
;

176  
£¡
;

177 
	}
}

179 
ssize_t


180 
	$Rªad
(
d
, 
buf
, 
nbyãs
)

181 
d
;

182 *
buf
;

183 
size_t
 
nbyãs
;

185 c⁄° *
fun˘i⁄
 = "Rread()";

187 
	`˛õ¡öô
();

189 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, bytes %lu",

190 
fun˘i⁄
, 
d
, ()
nbyãs
);

192  
	`Rªcv
(
d
, 
buf
, 
nbyãs
, 0);

193 
	}
}

195 
ssize_t


196 
	$Rªadv
(
d
, 
_iov
, 
iov˙t
)

197 
d
;

198 c⁄° 
iovec
 *
_iov
;

199 
iov˙t
;

201 c⁄° *
fun˘i⁄
 = "Rreadv()";

202 
iovec
 
iov
[1] = { { 
_iov
->
iov_ba£
, _iov->
iov_Àn
 } };

203 
msghdr
 
msg
;

205 
	`˛õ¡öô
();

207 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, iov˙à%d", 
fun˘i⁄
, 
d
, 
iov˙t
);

209 
	`bzîo
(&
msg
, (msg));

211 
msg
.
msg_iov
 = 
iov
;

212 
msg
.
msg_iovÀn
 = 
iov˙t
;

214  
	`Rªcvmsg
(
d
, &
msg
, 0);

215 
	}
}

217 
ssize_t


218 
	$Rªcv
(
s
, 
msg
, 
Àn
, 
Êags
)

219 
s
;

220 *
msg
;

221 
size_t
 
Àn
;

222 
Êags
;

224 
msghdr
 msghdr;

225 
iovec
 
iov
;

226 c⁄° *
fun˘i⁄
 = "Rrecv()";

228 
	`˛õ¡öô
();

230 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Üen %lu, flags %d",

231 
fun˘i⁄
, 
s
, ()
Àn
, 
Êags
);

234 
	`bzîo
(&
iov
, (iov));

235 
iov
.
iov_ba£
 = (*)
msg
;

236 
iov
.
iov_Àn
 = 
Àn
;

238 
	`bzîo
(&
msghdr
, (msghdr));

239 
msghdr
.
msg_iov
 = &
iov
;

240 
msghdr
.
msg_iovÀn
 = 1;

242  
	`Rªcvmsg
(
s
, &
msghdr
, 
Êags
);

243 
	}
}

245 
ssize_t


246 
	$Rªcvmsg
(
s
, 
msg
, 
Êags
)

247 
s
;

248 
msghdr
 *
msg
;

249 
Êags
;

251 c⁄° 
î∫o_s
 = 
î∫o
;

252 
size_t
 
ª˚ived
, 
ioc
;

253 
ssize_t
 
rc
;

254 
sockaddr_°‹age
 
«me
;

255 
sockÀn_t
 
«mñí
;

256 c⁄° *
fun˘i⁄
 = "Rrecvmsg()";

258 
	`˛õ¡öô
();

260 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, msg %p, flags %d",

261 
fun˘i⁄
, 
s
, 
msg
, 
Êags
);

263 i‡(
msg
 =
NULL
) {

264 
rc
 = 
	`ªcvmsg
(
s
, 
msg
, 
Êags
);

265 
	`¶og
(
LOG_DEBUG
, "%s:Ñ¯%ld", 
fun˘i⁄
, ()
rc
);

267  
rc
;

270 
«mñí
 = (
«me
);

271 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
«me
), &
«mñí
) == -1) {

272 
î∫o
 = 
î∫o_s
;

275 
rc
 = 
	`ªadv
(
s
, 
msg
->
msg_iov
, ()msg->
msg_iovÀn
);

276 
	`¶og
(
LOG_DEBUG
, "%s:Ñ¯%ld", 
fun˘i⁄
, ()
rc
);

278  
rc
;

281 
	`TOSA
(&
«me
)->
ß_Ámûy
) {

282 
AF_INET
:

285 #ifde‡
AF_INET6


286 
AF_INET6
:

291  
	`ªcvmsg
(
s
, 
msg
, 
Êags
);

295 
	`CMSG_TOTLEN
(*
msg
) = 0;

296 
	`CMSG_CONTROLDATA
(*
msg
Ë
NULL
;

298 
ª˚ived
 = 
ioc
 = 
rc
 = 0; io¯< (
size_t
)
msg
->
msg_iovÀn
; ++ioc) {

299 i‡((
rc
 = 
	`Rªcv‰om
(
s
,

300 
msg
->
msg_iov
[
ioc
].
iov_ba£
,

301 
msg
->
msg_iov
[
ioc
].
iov_Àn
,

302 
Êags
,

303 
	`TOSA
(
msg
->
msg_«me
),

304 &
msg
->
msg_«mñí
)) == -1)

307 
ª˚ived
 +
rc
;

309 i‡(
rc
 !(
ssize_t
)
msg
->
msg_iov
[
ioc
].
iov_Àn
)

313 
	`¶og
(
LOG_DEBUG
, "%s: bytesÑeceived on fd %d: %ld (%s)",

314 
fun˘i⁄
, 
s
, ()
rc
, 
	`°ªº‹
(
î∫o
));

316 i‡(
ª˚ived
 <= 0)

317  
rc
;

319  
ª˚ived
;

320 
	}
}

322 #i‡
HAVE_GSSAPI
 && 
HAVE_LINUX_GLIBC_WORKAROUND


329 
	$RÂutc
(
c
, 
°ªam
)

330 
c
;

331 
FILE
 *
°ªam
;

333 c⁄° *
fun˘i⁄
 = "Rfputc()";

334 c⁄° 
d
 = 
	`fûío
(
°ªam
);

336 
	`˛õ¡öô
();

338 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

340 i‡(!
	`gsßpi_i£n¸y±ed
(
d
))

341  
	`Âutc
(
c
, 
°ªam
);

343 
	`socks_£tbuf„rfd
(
d
, 
_IOFBF
, -1);

345  
	`R£nd
(
d
, &
c
, (), 0);

346 
	}
}

349 
	$RÂuts
(
buf
, 
°ªam
)

350 c⁄° *
buf
;

351 
FILE
 *
°ªam
;

353 c⁄° *
fun˘i⁄
 = "Rfputs()";

354 c⁄° 
d
 = 
	`fûío
(
°ªam
);

356 
	`˛õ¡öô
();

358 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

360 i‡(!
	`gsßpi_i£n¸y±ed
(
d
))

361  
	`Âuts
(
buf
,
°ªam
);

363 
	`socks_£tbuf„rfd
(
d
, 
_IOFBF
, -1);

365  
	`R£nd
(
d
, 
buf
, 
	`°æí
(buf), 0);

366 
	}
}

368 
size_t


369 
	$Rfwrôe
(
±r
, 
size
, 
nmb
, 
°ªam
)

370 c⁄° *
±r
;

371 
size_t
 
size
; size_à
nmb
;

372 
FILE
 *
°ªam
;

374 c⁄° *
fun˘i⁄
 = "Rfwrite()";

375 c⁄° *
buf
=
±r
;

376 c⁄° 
d
 = 
	`fûío
(
°ªam
);

377 
size_t
 
i
;

379 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

381 i‡(!
	`gsßpi_i£n¸y±ed
(
d
))

382  
	`fwrôe
(
±r
, 
size
, 
nmb
, 
°ªam
);

384 
	`socks_£tbuf„rfd
(
d
, 
_IOFBF
, -1);

386 
i
 = 0; i < 
nmb
; ++i)

387 i‡(
	`Rwrôe
(
d
,
buf
+
i
*
size
,size) <= 0)

388  
i
;

390  
nmb
;

391 
	}
}

394 
	$RÂrötf
(
FILE
 *
°ªam
, c⁄° *
f‹m©
, ...)

396 c⁄° 
d
 = 
	`fûío
(
°ªam
);

397 c⁄° *
fun˘i⁄
 = "Rfprintf()";

398 
va_li°
 
≠
;

399 
rc
;

401 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

403 
	`va_°¨t
(
≠
, 
f‹m©
);

405 
	`socks_£tbuf„rfd
(
d
, 
_IOFBF
, -1);

407 
rc
 = 
	`RvÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

409 
	`va_íd
(
≠
);

411  
rc
;

412 
	}
}

415 
	$RvÂrötf
(
°ªam
, 
f‹m©
, 
≠
)

416 
FILE
 *
°ªam
;

417 c⁄° *
f‹m©
;

418 
va_li°
 
≠
;

420 c⁄° *
fun˘i⁄
 = "Rvfprintf()";

421 c⁄° 
d
 = 
	`fûío
(
°ªam
);

422 
ssize_t
 
Àn
;

423 
buf
[8 * 
BUFSIZ
];

425 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

427 i‡(!
	`gsßpi_i£n¸y±ed
(
d
))

428  
	`vÂrötf
(
°ªam
, 
f‹m©
, 
≠
);

430 
Àn
 = 
	`v¢¥ötf
(
buf
, (buf), 
f‹m©
, 
≠
);

431 i‡(
Àn
 > (
ssize_t
)(
buf
))

432 
Àn
 = (
ssize_t
)(
buf
);

434 
	`socks_£tbuf„rfd
(
d
, 
_IOFBF
, -1);

436  
	`Rwrôe
(
d
, 
buf
, 
Àn
);

437 
	}
}

440 
	$RfÊush
(
s
)

441 
FILE
 *
s
;

443 c⁄° *
fun˘i⁄
 = "Rfflush()";

444 
d
;

446 i‡(
s
 =
NULL
) {

447 ()
	`socks_Êushbuf„r
(-1, -1, 
NULL
);

448  
	`fÊush
(
s
);

451 
d
 = 
	`fûío
(
s
);

453 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

455 i‡(!
	`gsßpi_i£n¸y±ed
(
d
))

456  
	`fÊush
(
s
);

458 ()
	`socks_Êushbuf„r
(
d
, -1, 
NULL
);

460 
	}
}

463 
	$Rf˛o£
(
s
)

464 
FILE
 *
s
;

466 c⁄° *
fun˘i⁄
 = "Rfclose()";

467 c⁄° 
d
 = 
	`fûío
(
s
);

469 
	`˛õ¡öô
();

471 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

473 i‡(
	`gsßpi_i£n¸y±ed
(
d
))

474 ()
	`socks_Êushbuf„r
(
d
, -1, 
NULL
);

476  
	`f˛o£
(
s
);

477 
	}
}

479 
	$Rfgëc
(
°ªam
)

480 
FILE
 *
°ªam
;

482 c⁄° *
fun˘i⁄
 = "Rfgetc()";

483 
c
;

484 c⁄° 
d
 = 
	`fûío
(
°ªam
);

486 
	`˛õ¡öô
();

488 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

490 i‡(!
	`gsßpi_i£n¸y±ed
(
d
))

491  
	`fgëc
(
°ªam
);

493 i‡(
	`Rªad
(
d
, &
c
, 1) != 1)

494  
EOF
;

496  ()
c
;

497 
	}
}

500 
	$Rgës
(
buf
)

501 *
buf
;

503 c⁄° *
fun˘i⁄
 = "Rgets()";

504 c⁄° 
d
 = 
	`fûío
(
°dö
);

505 
size_t
 
i
;

507 
	`˛õ¡öô
();

509 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

511 i‡(!
	`gsßpi_i£n¸y±ed
(
d
))

512  
	`gës
(
buf
);

514 
i
 = 0;

515 
	`Rªad
(
d
, 
buf
 + 
i
, 1) == 1 && buf[i] != '\n')

516 ++
i
;

517 
buf
[
i
] = 
NUL
;

519  
buf
;

520 
	}
}

523 
	$Rfgës
(
buf
, 
size
, 
°ªam
)

524 *
buf
;

525 
size
;

526 
FILE
 *
°ªam
;

528 c⁄° *
fun˘i⁄
 = "Rfgets()";

529 c⁄° 
d
 = 
	`fûío
(
°ªam
);

530 
i
;

532 
	`˛õ¡öô
();

534 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

536 i‡(!
	`gsßpi_i£n¸y±ed
(
d
))

537  
	`fgës
(
buf
, 
size
, 
°ªam
);

539 
i
 = 0;

540 
	`Rªad
(
d
, 
buf
 + 
i
, 1Ë=1 && i < 
size
 - 1 && buf[i] != '\n')

541 ++
i
;

543 i‡(
size
 >= 1)

544 
buf
[
i
 !0 ? i + 1 : i] = 
NUL
;

546  
buf
;

547 
	}
}

549 
size_t


550 
	$R‰ód
(*
±r
, 
size_t
 
size
, size_à
nmb
, 
FILE
 *
°ªam
)

552 c⁄° *
fun˘i⁄
 = "Rfread()";

553 *
buf
=(*)
±r
;

554 
size_t
 
i
;

555 c⁄° 
d
 = 
	`fûío
(
°ªam
);

557 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
d
);

559 i‡(!
	`gsßpi_i£n¸y±ed
(
d
))

560  
	`‰ód
(
±r
, 
size
, 
nmb
, 
°ªam
);

562 
i
 = 0; i < 
nmb
; ++i)

563 i‡(
	`Rªad
(
d
, 
buf
 + (
i
 * 
size
), size) <= 0)

564  
i
;

566  
nmb
;

567 
	}
}

	@lib/Rconnect.c

45 
	~"comm⁄.h
"

47 
	~"u≤p.h
"

49 c⁄° 
	grcsid
[] =

53 
	$Rc⁄√˘
(
s
, 
_«me
, 
«mñí
)

54 
s
;

55 c⁄° 
sockaddr
 *
_«me
;

56 
sockÀn_t
 
«mñí
;

58 c⁄° *
fun˘i⁄
 = "Rconnect()";

59 
sockaddr_°‹age
 
«me
;

60 
socksfd_t
 
socksfd
;

61 
socksho°_t
 
§c
, 
d°
;

62 
authmëhod_t
 
auth
;

63 
socks_t
 
∑ckë
;

64 
sockÀn_t
 
Àn
;

65 
«me°r
[
MAXSOCKADDRSTRING
], 
emsg
[256];

66 
ty≥
, 
rc
, 
nbc⁄√˘
, 
ßvedî∫o
;

68 
	`˛õ¡öô
();

70 i‡(
_«me
 =
NULL
) {

71 
rc
 = 
	`c⁄√˘
(
s
, 
_«me
, 
«mñí
);

73 
	`¶og
(
LOG_DEBUG
,

75 
fun˘i⁄
, 
rc
);

77  
rc
;

80 i‡(
_«me
->
ß_Ámûy
 !
AF_INET
) {

81 
rc
 = 
	`c⁄√˘
(
s
, 
_«me
, 
«mñí
);

83 
	`¶og
(
LOG_DEBUG
,

86 
fun˘i⁄
,

87 
_«me
->
ß_Ámûy
,

88 
	`sockaddr2°rög
(
	`TOCSS
(
_«me
), 
NULL
, 0),

89 
rc
);

91  
rc
;

94 
	`u§sockaddr˝y
(&
«me
, 
	`TOCSS
(
_«me
), 
	`MIN
(“ame), 
«mñí
));

96 i‡(
	`socks_sockëisf‹œn
(
s
)) {

97 
	`¶og
(
LOG_DEBUG
, "%s: fd %d wantingÅo connectÅo %s isáÜan-only "

99 
fun˘i⁄
,

100 
s
,

101 
	`sockaddr2°rög
(&
«me
, 
«me°r
, (namestr)));

103  
	`c⁄√˘
(
s
, 
_«me
, 
«mñí
);

107 
	`¶og
(
LOG_INFO
, "%s: fd %d,áddress %s",

108 
fun˘i⁄
,

109 
s
,

110 
	`sockaddr2°rög
(&
«me
, 
«me°r
, (namestr)));

112 i‡(
	`socks_addrisours
(
s
, &
socksfd
, 1)) {

113 
	`¶og
(
LOG_DEBUG
, "%s: socket isá %s socket,Érr = %d, inprogress = %d",

114 
fun˘i⁄
, 
	`¥oxy¥Ÿocﬁ2°rög
(
socksfd
.
°©e
.
vîsi⁄
),

115 
socksfd
.
°©e
.
îr
, socksfd.°©e.
ö¥ogªss
);

117 
socksfd
.
°©e
.
comm™d
) {

118 
SOCKS_BIND
:

119 i‡(
socksfd
.
°©e
.
¥Ÿocﬁ
.
t˝
) {

135 
tmp_s
;

137 
	`¶og
(
LOG_DEBUG
,

139 
fun˘i⁄
, 
s
);

141 i‡(
socksfd
.
°©e
.
vîsi⁄
 =
PROXY_UPNP
)

142 
	`u≤p˛ónup
(
s
);

149 i‡((
tmp_s
 = 
	`sockë›tdup
(
s
, -1)) == -1)

152 i‡(
	`dup2
(
tmp_s
, 
s
) == -1) {

153 
	`˛o£
(
tmp_s
);

157 
	`˛o£
(
tmp_s
);

158 
	`socks_rmaddr
(
s
, 1);

161 i‡(
socksfd
.
°©e
.
¥Ÿocﬁ
.
udp
) {

171 
	`SERRX
(0);

175 
SOCKS_CONNECT
:

176 i‡(
socksfd
.
°©e
.
vîsi⁄
 =
PROXY_UPNP
) {

177 
rc
 = 
	`c⁄√˘
(
s
, 
	`TOSA
(&
«me
), 
«mñí
);

179 
	`¶og
(
LOG_DEBUG
, "%s: connect(2) calledágain on upnp socket "

181 
fun˘i⁄
, 
rc
, 
î∫o
, 
	`°ªº‹
(errno));

183  
rc
;

186 i‡(
socksfd
.
°©e
.
îr
 != 0)

187 
î∫o
 = 
socksfd
.
°©e
.
îr
;

189 i‡(
socksfd
.
°©e
.
ö¥ogªss
)

190 
î∫o
 = 
EALREADY
;

192 
î∫o
 = 
EISCONN
;

197 
SOCKS_UDPASSOCIATE
:

206 
	`SERRX
(
socksfd
.
°©e
.
comm™d
);

210 
	`¶og
(
LOG_DEBUG
,

212 
fun˘i⁄
, 
s
);

214 
	`socks_rmaddr
(
s
, 1);

217 
Àn
 = (
ty≥
);

218 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
ty≥
, &
Àn
) != 0) {

219 
	`sw¨n
("%s: gësock›t(SO_TYPE)", 
fun˘i⁄
);

223 
	`bzîo
(&
∑ckë
, (packet));

225 
ty≥
) {

226 
SOCK_DGRAM
:

227 
socksfd
.
rouã
 = 
	`udp£tup
(
s
, &
«me
, 
SOCKS_SEND
, 1, 
emsg
, (emsg));

228 i‡(
socksfd
.
rouã
 =
NULL
) {

229 
	`¶og
(
LOG_INFO
,

231 
fun˘i⁄
,

232 
	`sockaddr2°rög
(&
«me
, 
NULL
, 0),

233 
s
,

234 
emsg
);

236 
î∫o
 = 
ENETUNREACH
;

240 
	`¶og
(
LOG_INFO
, "%s:Ñoute set up for fd %dÅo %s isá %sÑoute",

241 
fun˘i⁄
,

242 
s
,

243 
	`sockaddr2°rög
(&
«me
, 
NULL
, 0),

244 
	`¥oxy¥Ÿocﬁs2°rög
(&
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
,

245 
NULL
,

248 i‡(
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

249 c⁄° 
ssize_t
 
rc
 = 
	`c⁄√˘
(
s
, 
	`TOSA
(&
«me
), 
«mñí
);

251 
	`¶og
(
LOG_DEBUG
,

253 
fun˘i⁄
,

254 
s
,

255 
	`sockaddr2°rög
(&
«me
, 
NULL
, 0),

256 ()
rc
,

257 
	`°ªº‹
(
î∫o
));

259  ()
rc
;

264 
SOCK_STREAM
:

265 
∑ckë
.
ªq
.
¥Ÿocﬁ
 = 
SOCKS_TCP
;

269 
	`sw¨nx
("%s: unknownÖrotocolÅype %d, falling backÅo system connect",

270 
fun˘i⁄
, 
ty≥
);

271  
	`c⁄√˘
(
s
, 
	`TOSA
(&
«me
), 
«mñí
);

274 
	`bzîo
(&
socksfd
, (socksfd));

275 
Àn
 = (
socksfd
.
loˇl
);

276 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), &
Àn
) != 0)

279 
	`¶og
(
LOG_DEBUG
, "%s:Üocaláddress of fd %d is %s",

280 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
NULL
, 0));

282 
	`bzîo
(&
§c
, (src));

283 
§c
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

284 
§c
.
addr
.
ùv4
 = 
	`TOIN
(&
socksfd
.
loˇl
)->
sö_addr
;

285 
§c
.
p‹t
 = 
	`TOIN
(&
socksfd
.
loˇl
)->
sö_p‹t
;

287 
	`bzîo
(&
d°
, (dst));

288 
	`Ákesockaddr2socksho°
(&
«me
, &
d°
);

290 
	`bzîo
(&
auth
, (auth));

291 
auth
.
mëhod
 = 
AUTHMETHOD_NOTSET
;

293 
∑ckë
.
ªq
.
vîsi⁄
 = 
PROXY_DIRECT
;

294 
∑ckë
.
ªq
.
comm™d
 = 
SOCKS_CONNECT
;

295 
∑ckë
.
ªq
.
ho°
 = 
d°
;

296 
∑ckë
.
ªq
.
auth
 = &auth;

298 i‡((
socksfd
.
rouã
 = 
	`socks_ªque°pﬁish
(&
∑ckë
.
ªq
, &
§c
, &
d°
)Ë=
NULL
)

301 i‡(
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
)

302  
	`c⁄√˘
(
s
, 
_«me
, 
«mñí
);

304 i‡(
	`socks_rouã£tup
(
s
, s, 
socksfd
.
rouã
, 
emsg
, (emsg)) != 0) {

305 
	`sw¨nx
("%s: socks_rouã£tup(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

310 
Àn
 = (
socksfd
.
loˇl
);

311 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), &
Àn
) != 0)

314 
	`¶og
(
LOG_DEBUG
, "%s:Üocaláddress of fd %d is %s",

315 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
NULL
, 0));

317 
§c
.
addr
.
ùv4
 = 
	`TOIN
(&
socksfd
.
loˇl
)->
sö_addr
;

318 
§c
.
p‹t
 = 
	`TOIN
(&
socksfd
.
loˇl
)->
sö_p‹t
;

320 
	`¶og
(
LOG_DEBUG
, "%s:ÑouteÖrepared for fd %d isá %sÑoute",

321 
fun˘i⁄
, 
s
, 
	`¥oxy¥Ÿocﬁ2°rög
(
∑ckë
.
ªq
.
vîsi⁄
));

323 i‡(
∑ckë
.
ªq
.
vîsi⁄
 =
PROXY_DIRECT
) {

324 c⁄° 
rc
 = 
	`c⁄√˘
(
s
, 
	`TOSA
(&
«me
), 
«mñí
);

326 
	`¶og
(
LOG_DEBUG
, "%s: direct connect on fd %dÅo %sÑeturned %d: (%s)",

327 
fun˘i⁄
,

328 
s
,

329 
	`sockaddr2°rög
(&
«me
, 
NULL
, 0),

330 
rc
,

331 
	`°ªº‹
(
î∫o
));

333  
rc
;

336 
∑ckë
.
vîsi⁄
 =Öackë.
ªq
.version) {

337 
PROXY_SOCKS_V4
:

338 
PROXY_SOCKS_V5
:

339 
PROXY_HTTP_10
:

340 
PROXY_HTTP_11
:

341 
PROXY_UPNP
:

342 
socksfd
.
c⁄åﬁ
 = 
s
;

346 
	`SERRX
(
∑ckë
.
ªq
.
vîsi⁄
);

349 i‡(
∑ckë
.
vîsi⁄
 =
PROXY_UPNP
)

354 
nbc⁄√˘
 = 0;

362 
nbc⁄√˘
 = !
	`fdisblockög
(
s
);

364 
î∫o
 = 0;

365 i‡(
nbc⁄√˘
) {

366 
socksfd
.
rouã
 = 
	`socks_nbc⁄√˘rouã
(
s
,

367 
socksfd
.
c⁄åﬁ
,

368 &
∑ckë
,

369 &
§c
,

370 &
d°
,

371 
emsg
,

372 (
emsg
));

374 i‡(
socksfd
.
rouã
 =
NULL
)

375 
	`SASSERTX
(
î∫o
 != 0);

378 
socksfd
.
rouã
 = 
	`socks_c⁄√˘rouã
(socksfd.
c⁄åﬁ
,

379 &
∑ckë
,

380 &
§c
,

381 &
d°
,

382 
emsg
,

383 (
emsg
));

385 
	`¶og
(
LOG_INFO
, "%s: %sá %sÑoute for fd %d,Érrno = %d",

386 
fun˘i⁄
,

387 
socksfd
.
rouã
 =
NULL
 ? "couldÇotÉstablish" : "established",

388 
	`¥oxy¥Ÿocﬁ2°rög
(
∑ckë
.
ªq
.
vîsi⁄
),

389 
s
,

390 
î∫o
);

392 i‡(
socksfd
.
rouã
 =
NULL
) {

393 i‡(
s
 !
socksfd
.
c⁄åﬁ
)

394 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

396 
î∫o
) {

397 
EADDRINUSE
: {

413 
tmp_s
;

415 
	`sw¨n
("%s: server socksified?ÅryingÅo workároundÖroblem...",

416 
fun˘i⁄
);

418 i‡((
tmp_s
 = 
	`sockë›tdup
(
s
, -1)) == -1)

420 i‡(
	`dup2
(
tmp_s
, 
s
) == -1)

422 
	`˛o£
(
tmp_s
);

429 i‡(
	`PORTISRESERVED
(
	`TOIN
(&
socksfd
.
loˇl
)->
sö_p‹t
)) {

431 
	`TOIN
(&
socksfd
.
loˇl
)->
sö_p‹t
 = 
	`ht⁄s
(0);

434 
	`bödªsvp‹t
(
s
, 
	`TOIN
(&
socksfd
.
loˇl
));

437  
	`Rc⁄√˘
(
s
, 
	`TOSA
(&
«me
), 
«mñí
);

441 
	`sw¨nx
("%s: couldÇŸ c⁄√˘Ñouã: %s", 
fun˘i⁄
, 
emsg
);

445 i‡(
nbc⁄√˘
) {

446 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1)) {

447 
	`sw¨n
("%s: something went wrong when setting upÇon-blocking connect",

448 
fun˘i⁄
);

453 i‡(
socksfd
.
°©e
.
ö¥ogªss
) {

454 
	`¶og
(
LOG_DEBUG
, "%s: gotÑoute,Çon-blocking connect inÖrogress",

455 
fun˘i⁄
);

457 
î∫o
 = 
EINPROGRESS
;

461 i‡(
socksfd
.
°©e
.
îr
 != 0) {

462 
	`¶og
(
LOG_INFO
,

464 
fun˘i⁄
,

465 
	`sockaddr2°rög
(&
«me
, 
NULL
, 0),

466 
socksfd
.
°©e
.
îr
,

467 
	`°ªº‹
(
socksfd
.
°©e
.
îr
));

469 
î∫o
 = 
socksfd
.
°©e
.
îr
;

473 
	`¶og
(
LOG_INFO
,

475 
fun˘i⁄
, 
	`sockaddr2°rög
(&
«me
, 
NULL
, 0));

482 i‡(
	`socks_√gŸüã
(
s
,

483 
socksfd
.
c⁄åﬁ
,

484 &
∑ckë
,

485 
socksfd
.
rouã
,

486 
emsg
,

487 (
emsg
)) != 0) {

488 
	`sw¨nx
("%s: socks_√gŸüã(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

492 
ßvedî∫o
 = 
î∫o
;

494 
	`upd©e_a·î_√gŸüã
(&
∑ckë
, &
socksfd
);

496 
	`¶og
(
LOG_DEBUG
,

498 
fun˘i⁄
, 
ßvedî∫o
, 
socksfd
.
°©e
.
vîsi⁄
);

500 
	`SASSERTX
(
ty≥
 =
SOCK_STREAM
);

501 
socksfd
.
°©e
.
¥Ÿocﬁ
.
t˝
 = 1;

503 
	`socksho°2sockaddr
(&
∑ckë
.
ªs
.
ho°
, &
socksfd
.
ªmŸe
);

504 
	`sockaddr2socksho°
(&
«me
, &
socksfd
.
f‹us
.
c⁄√˘ed
);

507 i‡(
	`TOIN
(&
socksfd
.
loˇl
)->
sö_p‹t
 !
	`ht⁄s
(0)

508 && 
	`TOIN
(&
socksfd
.
loˇl
)->
sö_p‹t
 !TOIN(&socksfd.
ªmŸe
)->sin_port) {

516 
	`¶og
(
LOG_DEBUG
,

518 
fun˘i⁄
,

519 
	`¡ohs
(
	`TOIN
(&
socksfd
.
loˇl
)->
sö_p‹t
),

520 
	`¡ohs
(
	`TOIN
(&
socksfd
.
ªmŸe
)->
sö_p‹t
));

523 
Àn
 = (
socksfd
.
£rvî
);

524 i‡(
	`gë≥î«me
(
s
, 
	`TOSA
(&
socksfd
.
£rvî
), &
Àn
) == 0)

525 
	`¶og
(
LOG_DEBUG
, "%s: getpeername(fd %d) = %s",

526 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(&
socksfd
.
£rvî
, 
NULL
, 0));

528 
	`¶og
(
LOG_DEBUG
, "%s: getpeername(fd %d): %s",

529 
fun˘i⁄
, 
s
, 
	`°ªº‹
(
î∫o
));

531 
Àn
 = (
socksfd
.
loˇl
);

532 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), &
Àn
) != 0)

533 
	`¶og
(
LOG_DEBUG
, "%s: gësock«me(s): %s", 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

535 
	`socks_addaddr
(
s
, &
socksfd
, 1);

537 
	`sockaddr2socksho°
(&
«me
, &
sockscf
.
°©e
.
œ°c⁄√˘
);

539 
	`¶og
(
LOG_DEBUG
, "%s:Ñeturning. CurrentÉrrno is %d (%s), saved is %d",

540 
fun˘i⁄
, 
î∫o
, 
	`°ªº‹
”ºno), 
ßvedî∫o
);

542 
î∫o
 = 
ßvedî∫o
;

544 i‡(
î∫o
 != 0)

548 
	}
}

	@lib/Rgethostbyname.c

50 
	~"comm⁄.h
"

52 c⁄° 
	grcsid
[] =

55 
ho°ít
 *

56 
	$Rgëho°by«me2
(
«me
, 
af
)

57 c⁄° *
«me
;

58 
af
;

60 c⁄° *
fun˘i⁄
 = "Rgethostbyname2()";

61 
ho°ít
 
ho°ítmem
;

62 *
Æü£s
[] = { 
NULL
 };

63 
ö_addr
 
ùödex
;

64 
ho°ít
 *hostent;

66 
	`˛õ¡öô
();

68 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
«me
);

70 
sockscf
.
ªsﬁvïrŸocﬁ
) {

71 
RESOLVEPROTOCOL_TCP
:

72 
RESOLVEPROTOCOL_UDP
:

73 i‡((
ho°ít
 = 
	`gëho°by«me
(
«me
)Ë!
NULL
)

74  
ho°ít
;

77 
RESOLVEPROTOCOL_FAKE
:

78 
ho°ít
 = 
NULL
;

82 
	`SERRX
(
sockscf
.
ªsﬁvïrŸocﬁ
);

85 i‡(
ho°ít
 !
NULL
)

86  
ho°ít
;

92 i‡(
sockscf
.
ªsﬁvïrŸocﬁ
 !
RESOLVEPROTOCOL_FAKE
)

93 
	`¶og
(
LOG_DEBUG
, "%s: gethostbyname(%s) failed: %s. WillÅryÅo fake it",

94 
fun˘i⁄
, 
«me
, 
	`h°ªº‹
(
h_î∫o
));

96 
ho°ít
 = &
ho°ítmem
;

102 
h_î∫o
 = 
TRY_AGAIN
;

104 
	`‰ì
(
ho°ít
->
h_«me
);

105 i‡((
ho°ít
->
h_«me
 = 
	`°rdup
(
«me
)Ë=
NULL
)

106  
NULL
;

108 
ho°ít
->
h_Æü£s
 = 
Æü£s
;

109 
ho°ít
->
h_addπy≥
 = 
af
;

111 i‡(
ho°ít
->
h_addr_li°
 =
NULL
) {

113 i‡((
ho°ít
->
h_addr_li°
 = 
	`mÆloc
((*hostent->h_addr_list) * 2))

114 =
NULL
)

115  
NULL
;

116 
ho°ít
->
h_addr_li°
[1] = 
NULL
;

119 
af
) {

120 
AF_INET
: {

121 
ùv4
[(
ö_addr
)];

123 
ho°ít
->
h_Àngth
 = (
ùv4
);

124 
ho°ít
->
h_addr_li°
[0] = 
ùv4
;

128 
AF_INET6
: {

129 
ùv6
[(
ö6_addr
)];

131 
ho°ít
->
h_Àngth
 = (
ùv6
);

132 
ho°ít
->
h_addr_li°
[0] = 
ùv6
;

137 
î∫o
 = 
ENOPROTOOPT
;

138  
NULL
;

141 i‡((
ùödex
.
s_addr
 = 
	`socks_addÁkeù
(
«me
)Ë=
	`ht⁄l
(
INADDR_NONE
))

142  
NULL
;

144 i‡(
	`socks_öë_±⁄
(
af
, 
	`öë_¡ﬂ
(
ùödex
), *
ho°ít
->
h_addr_li°
, 
NULL
)

146  
NULL
;

148 
	`¶og
(
LOG_INFO
, "%s:ádded fake ip %s for hostname %s",

149 
fun˘i⁄
, 
	`öë_¡ﬂ
(
ùödex
), 
«me
);

151  
ho°ít
;

152 
	}
}

154 
ho°ít
 *

155 
	$Rgëho°by«me
(
«me
)

156 c⁄° *
«me
;

159  
	`Rgëho°by«me2
(
«me
, 
AF_INET
);

160 
	}
}

162 #i‡
HAVE_GETADDRINFO


164 
	$Rgëaddröfo
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
)

165 c⁄° *
nodíame
;

166 c⁄° *
£rv«me
;

167 c⁄° 
addröfo
 *
höts
;

168 
addröfo
 **
ªs
;

170 c⁄° *
fun˘i⁄
 = "Rgetaddrinfo()";

171 
addröfo
 
Ákehöts
;

172 
ö_addr
 
ùödex
;

173 
addr°r
[
	`MAX
(
INET_ADDRSTRLEN
, 
INET6_ADDRSTRLEN
)],

174 
addrbuf
[(
ö6_addr
)],

175 
vbuf_nodíame
[
MAXHOSTNAMELEN
 * 4], 
vbuf_£rv«me
[
MAXSERVICELEN
 * 4];

176 
Ákeù_ˇ¡ry
, 
gaõº
, 
isùaddr
;

178 
	`˛õ¡öô
();

180 i‡(
nodíame
 =
NULL
)

181 
	`STRCPY_ASSERTSIZE
(
vbuf_nodíame
, "<null>");

183 
	`°r2vis
(
nodíame
, 
	`°æí
“odíame), 
vbuf_nodíame
, (vbuf_nodename));

185 i‡(
£rv«me
 =
NULL
)

186 
	`STRCPY_ASSERTSIZE
(
vbuf_£rv«me
, "<null>");

188 
	`°r2vis
(
£rv«me
, 
	`°æí
(£rv«me), 
vbuf_£rv«me
, (vbuf_servname));

190 
	`¶og
(
LOG_DEBUG
,

193 
fun˘i⁄
,

194 
	`ªsﬁvïrŸocﬁ2°rög
(
sockscf
.
ªsﬁvïrŸocﬁ
),

195 
vbuf_nodíame
,

196 
vbuf_£rv«me
,

197 
höts
,

198 
höts
 =
NULL
 ? 0 : höts->
ai_Ámûy
);

200 i‡((
nodíame
 =
NULL
 || *nodíamê=
NUL
)

201 || (
höts
 !
NULL
 && (höts->
ai_Êags
 & 
AI_NUMERICHOST
))) {

207 
gaõº
 = 
	`gëaddröfo
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
);

209 
	`¶og
(
LOG_DEBUG
, "%s: getaddrinfo(%s, %s)Ñeturned %d (%s)",

210 
fun˘i⁄
,

211 
vbuf_nodíame
,

212 
vbuf_£rv«me
,

213 
gaõº
,

214 
	`gai_°ªº‹
(
gaõº
));

216  
gaõº
;

226 
	`SASSERTX
(
nodíame
 !
NULL
);

228 i‡(
höts
 =
NULL
 || höts->
ai_¥Ÿocﬁ
 =
PF_UNSPEC
) {

229 i‡(
	`socks_öë_±⁄
(
AF_INET
, 
nodíame
, 
addrbuf
, 
NULL
) == 1

230 || 
	`socks_öë_±⁄
(
AF_INET6
, 
nodíame
, 
addrbuf
, 
NULL
) == 1)

231 
isùaddr
 = 1;

233 
isùaddr
 = 0;

236 
	`SASSERTX
(
höts
 !
NULL
);

238 i‡(
	`socks_öë_±⁄
(
höts
->
ai_Ámûy
, 
nodíame
, 
addrbuf
, 
NULL
) == 1)

239 
isùaddr
 = 1;

241 
isùaddr
 = 0;

244 i‡(
isùaddr
) {

245 
Ákeù_ˇ¡ry
 = 0;

247 
	`¶og
(
LOG_DEBUG
, "%s:ÇodenameÖassed (%s) isán ipaddress",

248 
fun˘i⁄
, 
vbuf_nodíame
);

251 
Ákeù_ˇ¡ry
 = 1;

254 
	`bzîo
(&
Ákehöts
, (fakehints));

255 i‡(
höts
 =
NULL
) {

256 
Ákehöts
.
ai_Êags
 = 
AI_NUMERICHOST
;

257 
Ákehöts
.
ai_sockty≥
 = 0;

258 
Ákehöts
.
ai_¥Ÿocﬁ
 = 0;

261 
Ákehöts
 = *
höts
;

262 
Ákehöts
.
ai_Êags
 = 
höts
->ai_Êag†| 
AI_NUMERICHOST
;

265 
Ákehöts
.
ai_Ámûy
 = 
AF_INET
;

266 
Ákehöts
.
ai_addæí
 = 0;

267 
Ákehöts
.
ai_ˇn⁄«me
 = 
NULL
;

268 
Ákehöts
.
ai_addr
 = 
NULL
;

269 
Ákehöts
.
ai_√xt
 = 
NULL
;

271 
sockscf
.
ªsﬁvïrŸocﬁ
) {

272 
RESOLVEPROTOCOL_FAKE
:

273 i‡(
isùaddr
) {

274 
	`SASSERTX
(
Ákehöts
.
ai_Êags
 & 
AI_NUMERICHOST
);

279 
gaõº
 = 
	`gëaddröfo
(
nodíame
, 
£rv«me
, &
Ákehöts
, 
ªs
);

281 
	`¶og
(
LOG_DEBUG
, "%s: getaddrinfo(%s, %s)Ñeturned %d (%s)",

282 
fun˘i⁄
,

283 
vbuf_nodíame
,

284 
vbuf_£rv«me
,

285 
gaõº
,

286 
	`gai_°ªº‹
(
gaõº
));

288  
gaõº
;

294 
	`SASSERTX
(
Ákeù_ˇ¡ry
);

297 
RESOLVEPROTOCOL_TCP
:

298 
RESOLVEPROTOCOL_UDP
: {

299 
gaõº
 = 
	`gëaddröfo
(
nodíame
, 
£rv«me
, 
höts
, 
ªs
);

301 
	`¶og
(
LOG_DEBUG
, "%s: getaddrinfo(%s, %s)Ñeturned %d (%s)",

302 
fun˘i⁄
,

303 
vbuf_nodíame
,

304 
vbuf_£rv«me
,

305 
gaõº
,

306 
	`gai_°ªº‹
(
gaõº
));

308 i‡(
gaõº
 == 0)

309  
gaõº
;

311 i‡(!
Ákeù_ˇ¡ry
)

312  
gaõº
;

314 
	`SASSERTX
(
Ákeù_ˇ¡ry
);

319 
	`SERRX
(
sockscf
.
ªsﬁvïrŸocﬁ
);

322 
	`SASSERTX
(
Ákeù_ˇ¡ry
);

323 
	`SASSERTX
(
nodíame
 !
NULL
);

338 
Ákehöts
.
ai_Ámûy
) {

343 
AF_INET
:

349 
AF_INET6
:

351 
	`sw¨nx
("%s: %sÇot supported forÑesolveprotocol %s yet",

352 
fun˘i⁄
,

353 
	`ßÁmûy2°rög
(
höts
->
ai_Ámûy
),

354 
	`ªsﬁvïrŸocﬁ2°rög
(
sockscf
.
ªsﬁvïrŸocﬁ
));

356  
EAI_FAIL
;

359 i‡((
ùödex
.
s_addr
 = 
	`socks_addÁkeù
(
nodíame
)Ë=
	`ht⁄l
(
INADDR_NONE
))

360  
EAI_MEMORY
;

362 
	`STRCPY_ASSERTLEN
(
addr°r
, 
	`öë_¡ﬂ
(
ùödex
));

364 
	`¶og
(
LOG_INFO
, "%s: faking ipáddress %s for host \"%s\", service \"%s\"",

365 
fun˘i⁄
, 
addr°r
, 
vbuf_nodíame
, 
vbuf_£rv«me
);

367 
gaõº
 = 
	`gëaddröfo
(
addr°r
, 
£rv«me
, &
Ákehöts
, 
ªs
);

369 
	`¶og
(
gaõº
 =0 ? 
LOG_DEBUG
 : 
LOG_WARNING
,

371 
fun˘i⁄
,

372 
vbuf_nodíame
,

373 
vbuf_£rv«me
,

374 
gaõº
,

375 
	`gai_°ªº‹
(
gaõº
));

377  
gaõº
;

378 
	}
}

381 #i‡
HAVE_GETIPNODEBYNAME


387 
ho°ít
 *

388 
	$Rgëùnodeby«me2
(
«me
, 
af
, 
Êags
, 
îr‹_num
)

389 c⁄° *
«me
;

390 
af
;

391 
Êags
;

392 *
îr‹_num
;

394 c⁄° *
fun˘i⁄
 = "Rgetipnodebyname2()";

395 
ö_addr
 
ùödex
;

396 
ho°ít
 *hostent;

397 **
addæi°
, 
vbuf_«me
[
MAXHOSTNAMELEN
 * 4];

398 
rc
;

401 
	`˛õ¡öô
();

403 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
vbuf_«me
, (vbuf_name));

405 
	`¶og
(
LOG_DEBUG
, "%s: %s: %s", 
fun˘i⁄
, 
	`ßÁmûy2°rög
(
af
), 
vbuf_«me
);

411 i‡(
	`socks_öë_±⁄
(
af
, 
«me
, &
ùödex
, 
NULL
) == 1) {

412 
ho°ít
 = 
	`gëùnodeby«me
(
«me
, 
af
, 
Êags
, 
îr‹_num
);

414 
	`¶og
(
LOG_DEBUG
,

417 
fun˘i⁄
, 
vbuf_«me
, 
ho°ít
, *
îr‹_num
);

419  
ho°ít
;

422 
sockscf
.
ªsﬁvïrŸocﬁ
) {

423 
RESOLVEPROTOCOL_TCP
:

424 
RESOLVEPROTOCOL_UDP
:

425 
	`¶og
(
LOG_INFO
,

427 
fun˘i⁄
, 
	`¥Ÿocﬁ2°rög
(
sockscf
.
ªsﬁvïrŸocﬁ
));

429 i‡((
ho°ít
 = 
	`gëùnodeby«me
(
«me
, 
af
, 
Êags
, 
îr‹_num
)Ë!
NULL
)

430  
ho°ít
;

434 
RESOLVEPROTOCOL_FAKE
:

435 
	`¶og
(
LOG_INFO
,

436 "%s: c⁄figuªd f‹ fakögÑesﬁvêo‡ho°«mes", 
fun˘i⁄
);

438 
ho°ít
 = 
NULL
;

439 
h_î∫o
 = 
NO_RECOVERY
;

443 
	`SERRX
(
sockscf
.
ªsﬁvïrŸocﬁ
);

446 i‡(
h_î∫o
 !
NO_RECOVERY
)

447  
ho°ít
;

449 i‡((
ho°ít
 = 
	`mÆloc
((ho°ít))Ë=
NULL
) {

450 
	`sw¨nx
("%s: mÆloc(3ËÁûed", 
fun˘i⁄
);

451  
NULL
;

457 
h_î∫o
 = 
TRY_AGAIN
;

459 i‡((
ho°ít
->
h_«me
 = 
	`°rdup
(
«me
)Ë=
NULL
) {

460 
	`‰ì
(
ho°ít
);

461  
NULL
;

464 
ho°ít
->
h_Æü£s
 = 
NULL
;

465 
ho°ít
->
h_addπy≥
 = 
af
;

468 i‡((
addæi°
 = 
	`mÆloc
((*addæi°Ë* 2)Ë=
NULL
) {

469 
	`sw¨nx
("%s: mÆloc(3ËÁûed", 
fun˘i⁄
);

471 
	`‰ì
(
ho°ít
->
h_«me
);

472 
	`‰ì
(
ho°ít
);

474  
NULL
;

477 
af
) {

478 
AF_INET
: {

479 
ùv4
[(
ö_addr
)];

481 
ho°ít
->
h_Àngth
 = (
ùv4
);

482 *
addæi°
 = 
ùv4
;

487 
AF_INET6
: {

488 
ùv6
[(
ö6_addr
)];

490 
ho°ít
->
h_Àngth
 = (
ùv6
);

491 *
addæi°
 = 
ùv6
;

497 
	`sw¨nx
("%s: unsuµ‹ãdáddªs†Ámûy: %d", 
fun˘i⁄
, 
af
);

500 
	`‰ì
(
ho°ít
->
h_«me
);

501 
	`‰ì
(
ho°ít
);

503 
î∫o
 = 
ENOPROTOOPT
;

504  
NULL
;

507 i‡((
ùödex
.
s_addr
 = 
	`socks_addÁkeù
(
«me
)Ë=
	`ht⁄l
(
INADDR_NONE
)) {

508 
	`‰ì
(
ho°ít
->
h_«me
);

509 
	`‰ì
(
ho°ít
);

510 
	`‰ì
(
addæi°
);

512  
NULL
;

515 
af
) {

516 
AF_INET
: {

517 
	`mem˝y
(*
addæi°
, &
ùödex
.
s_addr
, (
ö_addr
));

521 
AF_INET6
: {

522 
ff
[] = {0xff,0xff};

524 
	`mem£t
(*
addæi°
, 0, 10);

525 
	`mem˝y
(*
addæi°
 + 10, 
ff
, 2);

526 
	`mem˝y
(*
addæi°
 + 12, &
ùödex
.
s_addr
, (
ö_addr
));

531 
	`SERRX
(
af
);

534 
ho°ít
->
h_addr_li°
 = 
addæi°
++;

535 *
addæi°
 = 
NULL
;

537  
ho°ít
;

538 
	}
}

540 
ho°ít
 *

541 
	$Rgëùnodeby«me
(
«me
, 
af
, 
Êags
, 
îr‹_num
)

542 c⁄° *
«me
;

543 
af
;

544 
Êags
;

545 *
îr‹_num
;

547 
ho°ít
 *
hít
;

548 c⁄° *
fun˘i⁄
 = "Rgetipnodebyname()";

550 
	`¶og
(
LOG_DEBUG
, "%s: %s, %d", 
fun˘i⁄
, 
«me
, 
af
);

552 i‡((
hít
 = 
	`Rgëùnodeby«me2
(
«me
, 
af
, 
Êags
, 
îr‹_num
)Ë=
NULL
)

553 *
îr‹_num
 = 
h_î∫o
;

555  
hít
;

556 
	}
}

559 
	$R‰ìho°ít
(
±r
)

560 
ho°ít
 *
±r
;

562 
ö_addr
 
addr
;

564 i‡(
	`socks_gëÁkeù
(
±r
->
h_«me
, &
addr
)) {

565 
	`‰ì
(
±r
->
h_«me
);

566 
	`‰ì
(*(
±r
->
h_addr_li°
));

567 
	`‰ì
(
±r
->
h_addr_li°
);

568 
	`‰ì
(
±r
);

571 
	`‰ìho°ít
(
±r
);

572 
	}
}

	@lib/Rgetpeername.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$Rgë≥î«me
(
s
, 
«me
, 
«mñí
)

52 
s
;

53 
sockaddr
 *
«me
;

54 
sockÀn_t
 *
«mñí
;

56 c⁄° *
fun˘i⁄
 = "Rgetpeername()";

57 
socksfd_t
 
socksfd
;

58 
sockaddr_°‹age
 
addr
;

60 
	`˛õ¡öô
();

62 
	`¶og
(
LOG_DEBUG
, "%s, fd %d", 
fun˘i⁄
, 
s
);

64 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1)) {

65 
	`socks_rmaddr
(
s
, 1);

66  
	`gë≥î«me
(
s
, 
«me
, 
«mñí
);

69 
socksfd
.
°©e
.
comm™d
) {

70 
SOCKS_BIND
:

71 
	`Ákesocksho°2sockaddr
(&
socksfd
.
f‹us
.
ac˚±ed
, &
addr
);

74 
SOCKS_CONNECT
:

75 i‡(
socksfd
.
°©e
.
îr
 != 0) {

76 
î∫o
 = 
ENOTCONN
;

80 
	`Ákesocksho°2sockaddr
(&
socksfd
.
f‹us
.
c⁄√˘ed
, &
addr
);

83 
SOCKS_UDPASSOCIATE
:

84 i‡(!
socksfd
.
°©e
.
udpc⁄√˘
) {

85 
î∫o
 = 
ENOTCONN
;

89 
	`Ákesocksho°2sockaddr
(&
socksfd
.
f‹us
.
c⁄√˘ed
, &
addr
);

93 
	`SERRX
(
socksfd
.
°©e
.
comm™d
);

96 *
«mñí
 = 
	`MIN
(*«mñí, 
	`ßÀn
(
addr
.
ss_Ámûy
));

97 
	`sockaddr˝y
(
	`TOSS
(
«me
), &
addr
, (
size_t
)*
«mñí
);

100 
	}
}

	@lib/Rgetsockname.c

45 
	~"comm⁄.h
"

47 
	~"u≤p.h
"

49 c⁄° 
	grcsid
[] =

53 
	$Rgësock«me
(
s
, 
«me
, 
«mñí
)

54 
s
;

55 
sockaddr
 *
«me
;

56 
sockÀn_t
 *
«mñí
;

58 c⁄° *
fun˘i⁄
 = "Rgetsockname()";

59 
socksfd_t
 
socksfd
;

60 
sockaddr_°‹age
 
addr
;

62 
	`˛õ¡öô
();

64 
	`¶og
(
LOG_DEBUG
, "%s, fd %d", 
fun˘i⁄
, 
s
);

66 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1)) {

67 
	`socks_rmaddr
(
s
, 1);

68  
	`gësock«me
(
s
, 
«me
, 
«mñí
);

71 i‡(
socksfd
.
°©e
.
vîsi⁄
 =
PROXY_UPNP
) {

72 #i‡
HAVE_LIBMINIUPNP


73 i‡(
	`ADDRISBOUND
(&
socksfd
.
ªmŸe
))

74 
addr
 = 
socksfd
.
ªmŸe
;

76 
¥oxy°©e_t
 *
°©e
 = &
socksfd
.
rouã
->
gw
.°©e.
d©a
;

77 
socksfd_t
 *
p
;

78 
°øddr
[
INET_ADDRSTRLEN
], 
emsg
[1024];

79 
rc
;

81 
p
 = 
	`socks_gëaddr
(
s
, &
socksfd
, 1);

82 
	`SASSERTX
(
p
 !
NULL
);

84 i‡(
	`socks_öôu≤p
(&
socksfd
.
rouã
->
gw
, 
emsg
, (emsg)) != 0) {

85 
	`sw¨nx
("%s: socks_initupnp() failedÅo init upnp device: %s",

86 
fun˘i⁄
, 
emsg
);

88 
î∫o
 = 
EOPNOTSUPP
;

92 i‡((
rc
 = 
	`UPNP_GëExã∫ÆIPAddªss
(
°©e
->
u≤p
.
c⁄åﬁuæ
,

93 
°©e
->
u≤p
.
£rvi˚ty≥
,

94 
°øddr
)Ë!
UPNPCOMMAND_SUCCESS
) {

95 
	`sw¨nx
("%s: failedÅo getÉxternal ipáddress of upnp device: %s",

96 
fun˘i⁄
, 
	`°ru≤≥º‹
(
rc
));

98 
î∫o
 = 
EOPNOTSUPP
;

102 
	`¶og
(
LOG_INFO
, "%s: upnp controlÖoint'sÉxternal ipáddress is %s",

103 
fun˘i⁄
, 
°øddr
);

105 i‡(
	`socks_öë_±⁄
(
AF_INET
,

106 
°øddr
,

107 &
	`TOIN
(&
socksfd
.
ªmŸe
)->
sö_addr
,

108 
NULL
) == 1)

109 
	`SET_SOCKADDR
(
	`TOSS
(&
socksfd
.
ªmŸe
), 
AF_INET
);

110 i‡(
	`socks_öë_±⁄
(
AF_INET6
,

111 
°øddr
,

112 &
	`TOIN
(&
socksfd
.
ªmŸe
)->
sö_addr
,

113 &
	`TOIN6
(&
socksfd
.
ªmŸe
)->
sö6_sc›e_id
) == 1)

114 
	`SET_SOCKADDR
(
	`TOSS
(&
socksfd
.
ªmŸe
), 
AF_INET6
);

116 
	`sw¨n
("%s: couldÇot convert string %sÅoÇetworkáddress",

117 
fun˘i⁄
, 
°øddr
);

122 
addr
 = 
socksfd
.
ªmŸe
;

123 
	`socks_addaddr
(
s
, &
socksfd
, 1);

126 
	`SERRX
(
socksfd
.
°©e
.
vîsi⁄
);

130 
socksfd
.
°©e
.
comm™d
) {

131 
SOCKS_CONNECT
: {

132 
sig£t_t
 
£t
, 
o£t
;

135 ()
	`sigem±y£t
(&
£t
);

136 ()
	`sigadd£t
(&
£t
, 
SIGIO
);

137 i‡(
	`sig¥ocmask
(
SIG_BLOCK
, &
£t
, &
o£t
) != 0) {

138 
	`sw¨n
("%s: sig¥ocmask()", 
fun˘i⁄
);

142 i‡(
socksfd
.
°©e
.
ö¥ogªss
) {

150 i‡(
	`sigismembî
(&
o£t
, 
SIGIO
)) {

151 
	`sw¨nx
("%s: SIGIO i†beög blocked by clõ¡", 
fun˘i⁄
);

153 i‡(
	`sig¥ocmask
(
SIG_BLOCK
, &
o£t
, 
NULL
) != 0) {

154 
	`sw¨n
("%s: sig¥ocmask()", 
fun˘i⁄
);

158 
î∫o
 = 
ENOBUFS
;

163 
	`¶og
(
LOG_DEBUG
, "%s: waôög f‹ sig«»‰om chûd", 
fun˘i⁄
);

164 
	`sigsu•íd
(&
o£t
);

166 i‡(
	`sig¥ocmask
(
SIG_BLOCK
, &
o£t
, 
NULL
) != 0) {

167 
	`sw¨n
("%s: sig¥ocmask()", 
fun˘i⁄
);

171  
	`Rgësock«me
(
s
, 
«me
, 
«mñí
);

174 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
o£t
, 
NULL
) != 0)

175 
	`sw¨n
("%s: sig¥ocmask()", 
fun˘i⁄
);

176 
addr
 = 
socksfd
.
ªmŸe
;

180 
SOCKS_BIND
:

181 
addr
 = 
socksfd
.
ªmŸe
;

184 
SOCKS_UDPASSOCIATE
:

185 
	`sw¨nx
("%s: getsockname() on udp sockets isÇot supported byÅhe "

186 "sock†¥Ÿocﬁ,ÅryögÅÿÁkêô.", 
fun˘i⁄
);

194 
addr
 = 
socksfd
.
ªmŸe
;

195 
	`SET_SOCKADDR
(&
addr
, 
AF_INET
);

196 
	`TOIN
(&
addr
)->
sö_addr
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

197 
	`TOIN
(&
addr
)->
sö_p‹t
 = 
	`ht⁄s
(0);

201 
	`SERRX
(
socksfd
.
°©e
.
comm™d
);

205 *
«mñí
 = 
	`MIN
(*«mñí, 
	`ßÀn
(
addr
.
ss_Ámûy
));

206 
	`sockaddr˝y
(
	`TOSS
(
«me
), &
addr
, (
size_t
)*
«mñí
);

209 
	}
}

	@lib/Rgetsockopt.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

50 
	$Rgësock›t
(
s
, 
Àvñ
, 
›äame
, 
›tvÆ
, 
›éí
)

51 
s
;

52 
Àvñ
;

53 
›äame
;

54 *
›tvÆ
;

55 
sockÀn_t
 *
›éí
;

57 c⁄° *
fun˘i⁄
 = "Rgetsockopt()";

58 
socksfd_t
 
socksfd
;

60 i‡(
›äame
 !
SO_ERROR
)

61  
	`gësock›t
(
s
, 
Àvñ
, 
›äame
, 
›tvÆ
, 
›éí
);

63 
	`˛õ¡öô
();

65 
	`¶og
(
LOG_DEBUG
, "%s, fd %d", 
fun˘i⁄
, 
s
);

67 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1))

68  
	`gësock›t
(
s
, 
Àvñ
, 
›äame
, 
›tvÆ
, 
›éí
);

70 
	`¶og
(
LOG_DEBUG
, "%s, fd %d,Éº = %d", 
fun˘i⁄
, 
s
, 
socksfd
.
°©e
.
îr
);

71 
	`mem˝y
(
›tvÆ
, &
socksfd
.
°©e
.
îr
, *
›éí
);

78 
	}
}

	@lib/Rlisten.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

50 
	$Rli°í
(
s
, 
backlog
)

51 
s
;

52 
backlog
;

54 c⁄° *
fun˘i⁄
 = "Rlisten()";

55 
socksfd_t
 
socksfd
;

56 
rc
;

58 
	`˛õ¡öô
();

60 
	`¶og
(
LOG_DEBUG
, "%s, fd %d, backlog %d", 
fun˘i⁄
, 
s
, 
backlog
);

62 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1))

63 
rc
 = 
	`li°í
(
s
, 
backlog
);

64 i‡(
socksfd
.
°©e
.
comm™d
 !
SOCKS_BIND
) {

65 
	`sw¨nx
("%s: doingÜisten on socket, but command state is %d",

66 
fun˘i⁄
, 
socksfd
.
°©e
.
comm™d
);

68 
	`socks_rmaddr
(
s
, 1);

70 
rc
 = 
	`li°í
(
s
, 
backlog
);

72 i‡(
socksfd
.
°©e
.
ac˚±≥ndög
)

73 
rc
 = 
	`li°í
(
s
, 
backlog
);

82 
	`¶og
(
LOG_DEBUG
, "%s:Çÿsy°emÜi°í(2Ëtÿdÿ⁄ fd %d", 
fun˘i⁄
, 
s
);

86 
	`¶og
(
LOG_DEBUG
, "%s:Üi°í(2Ë⁄ fd %dÑëu∫ed %d", 
fun˘i⁄
, 
s
, 
rc
);

87  
rc
;

88 
	}
}

	@lib/Rrresvport.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

55 
	$Rºesvp‹t
(
p‹t
)

56 *
p‹t
;

58 #i‡
HAVE_RRESVPORT


59 c⁄° *
fun˘i⁄
 = "Rrresvport()";

60 
s
;

61 
sockaddr_°‹age
 
«me
;

62 
sockÀn_t
 
«mñí
;

64 
	`˛õ¡öô
();

66 
	`¶og
(
LOG_DEBUG
, "%s,Ö‹à%d", 
fun˘i⁄
, *
p‹t
);

68 i‡((
s
 = 
	`ºesvp‹t
(
p‹t
)) == -1)

71 
«mñí
 = (
«me
);

72 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
«me
), &
«mñí
) != 0) {

73 
	`˛o£
(
s
);

78 i‡(
	`Rböd
(
s
, 
	`TOSA
(&
«me
), 
«mñí
) != 0) {

79 
	`˛o£
(
s
);

83  
s
;

87 
	}
}

	@lib/address.c

45 
	~"comm⁄.h
"

47 
	~"öãΩosôi⁄.h
"

49 
	~"u≤p.h
"

51 #i‚de‡
__USE_GNU


52 
	#__USE_GNU


	)

54 
	~<dlf˙.h
>

56 c⁄° 
	grcsid
[] =

65 #ifde‡
HAVE_VOLATILE_SIG_ATOMIC_T


66 
sig_©omic_t
 
	gdoög_addröô
;

68 vﬁ©ûê
sig_©omic_t
 
	gdoög_addröô
;

79 **
	gùv
;

80 
ö_addr_t
 
	gùc
;

82 
	#FDV_INITSIZE
 64

	)

83 
socksfd_t
 
	gsocksfdöô
;

84 *
	gdv
;

85 
size_t
 
	gdc
;

86 
socksfd_t
 *
	gsocksfdv
;

87 
size_t
 
	gsocksfdc
;

89 #i‡
HAVE_PTHREAD_H


91 
socks_±hªad_muãx_öô
(
±hªad_muãx_t
 *
muãx
,

92 c⁄° 
±hªad_muãx©å_t
 *
©å
);

93 
socks_±hªad_muãx©å_öô
(
±hªad_muãx©å_t
 *
©å
);

94 
socks_±hªad_muãx©å_£ây≥
(
±hªad_muãx©å_t
 *
©å
, 
ty≥
);

95 
socks_±hªad_muãx_lock
(
±hªad_muãx_t
 *
muãx
);

96 
socks_±hªad_muãx_u∆ock
(
±hªad_muãx_t
 *
muãx
);

98 (*
	tPT_INIT_FUNC_T
)(
	t±hªad_muãx_t
 *
	tmuãx
,

99 c⁄° 
	t±hªad_muãx©å_t
 *
	t©å
);

100 
PT_INIT_FUNC_T
 
±_öô
;

102 (*
	tPT_ATTRINIT_FUNC_T
)(
	t±hªad_muãx©å_t
 *
	t©å
);

103 
PT_ATTRINIT_FUNC_T
 
±_©åöô
;

105 (*
	tPT_SETTYPE_FUNC_T
)(
	t±hªad_muãx©å_t
 *
	t©å
, 
	tty≥
);

106 
PT_SETTYPE_FUNC_T
 
±_£ây≥
;

108 (*
	tPT_LOCK_FUNC_T
)(
	t±hªad_muãx_t
 *
	tmuãx
);

109 
PT_LOCK_FUNC_T
 
±_lock
;

111 (*
	tPT_UNLOCK_FUNC_T
)(
	t±hªad_muãx_t
 *
	tmuãx
);

112 
PT_LOCK_FUNC_T
 
±_u∆ock
;

114 
	$±hªad_t
 (*
	tPT_SELF_FUNC_T
)();

115 
PT_SELF_FUNC_T
 
±_£lf
;

117 
±hªad_muãx_t
 
addrmuãx
;

121 
	`socks_ißddr
(c⁄° 
fd
, c⁄° 
èkñock
);

132 
	`socks_addfd
(c⁄° 
d
);

142 
	`socks_isfd
(c⁄° 
fd
);

148 
	`socks_rmfd
(c⁄° 
fd
);

153 
socksfd_t
 *

154 
	$socks_addaddr
(
˛õ¡fd
, 
socksfd
, 
èkñock
)

155 c⁄° 
˛õ¡fd
;

156 c⁄° 
socksfd_t
 *
socksfd
;

157 c⁄° 
èkñock
;

159 c⁄° *
fun˘i⁄
 = "socks_addaddr()";

160 
addæock›aque_t
 
lock
;

162 
	`˛õ¡öô
();

164 
	`SASSERTX
(
˛õ¡fd
 >= 0);

165 
	`SASSERTX
(!(
socksfd
->
°©e
.
¥Ÿocﬁ
.
t˝
 && socksfd->°©e.¥Ÿocﬁ.
udp
));

168 i‡(
socksfd
->
°©e
.
comm™d
 !-1 && !socksfd->°©e.
sy°em
)

169 
	`¶og
(
LOG_DEBUG
, "%s: %d", 
fun˘i⁄
, 
˛õ¡fd
);

172 
	`SASSERTX
(
socksfd
->
°©e
.
comm™d
 == -1

173 || 
socksfd
->
°©e
.
comm™d
 =
SOCKS_BIND


174 || 
socksfd
->
°©e
.
comm™d
 =
SOCKS_CONNECT


175 || 
socksfd
->
°©e
.
comm™d
 =
SOCKS_UDPASSOCIATE
);

177 i‡(
èkñock
)

178 
	`socks_addæock
(
F_WRLCK
, &
lock
);

180 i‡(
	`socks_addfd
(
˛õ¡fd
) != 0)

181 
	`£ºx
("%s:Éº‹áddög des¸ùt‹ %d", 
fun˘i⁄
, 
˛õ¡fd
);

183 i‡(
socksfdc
 < 
dc
) {

184 #i‡
HAVE_GSSAPI


185 
size_t
 
i
;

188 i‡(
socksfdöô
.
c⁄åﬁ
 == 0) {

189 
socksfdöô
.
c⁄åﬁ
 = -1;

193 i‡((
socksfdv
 = 
	`ªÆloc
(socksfdv, (*socksfdvË* 
dc
)Ë=
NULL
)

194 
	`£º
("%s: couldÇotállocate %lu bytes",

195 
fun˘i⁄
, ()((*
socksfdv
Ë* 
dc
));

197 #i‡
HAVE_GSSAPI


199 
i
 = 0; i < 
socksfdc
; ++i) {

200 
socksfd_t
 *
sfd
 = &
socksfdv
[
i
];

202 i‡(!
	`socks_ißddr
(
i
, 0))

205 
sfd
->
°©e
.
gsßpi°©e
.
vÆue
 = sfd->°©e.
gsßpi°©emem
;

210 
socksfdc
 < 
dc
)

211 
socksfdv
[
socksfdc
++] = 
socksfdöô
;

221 
	`memmove
(&
socksfdv
[
˛õ¡fd
], 
socksfd
, (*socksfd));

223 #i‡
HAVE_GSSAPI


224 
socksfdv
[
˛õ¡fd
].
°©e
.
gsßpi°©e
.
vÆue


225 
socksfdv
[
˛õ¡fd
].
°©e
.
gsßpi°©emem
;

227 
socksfdv
[
˛õ¡fd
].
Æloˇãd
 = 1;

229 i‡(
èkñock
)

230 
	`socks_addru∆ock
(&
lock
);

232 #ifde‡
THREAD_DEBUG


233 i‡(
sockscf
.
log
.
Âv
 !
NULL
) {

234 
buf
[80];

236 
	`¢¥ötf
(
buf
, (buf), "%s:állocating fd %d for command %d\n",

237 
fun˘i⁄
, 
˛õ¡fd
, 
socksfdv
[˛õ¡fd].
°©e
.
comm™d
);

239 
	`syssys_wrôe
(
	`fûío
(
sockscf
.
log
.
Âv
[0]), 
buf
, 
	`°æí
(buf) + 1);

243 i‡(
socksfd
->
°©e
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
)

244 
sockscf
.
°©e
.
havegsßpisockës
 = 1;

246  &
socksfdv
[
˛õ¡fd
];

247 
	}
}

249 
socksfd_t
 *

250 
	$socks_gëaddr
(
d
, 
socksfd
, 
èkñock
)

251 c⁄° 
d
;

252 
socksfd_t
 *
socksfd
;

253 c⁄° 
èkñock
;

255 #i‡
HAVE_GSSAPI


256 c⁄° *
fun˘i⁄
 = "socks_getaddr()";

258 
socksfd_t
 *
sfd
;

259 
addæock›aque_t
 
lock
;

261 i‡(
socksfd
 =
NULL
) {

262 
socksfd_t
 
i‚uŒsocksfd
;

264 
socksfd
 = &
i‚uŒsocksfd
;

267 i‡(
èkñock
)

268 
	`socks_addæock
(
F_RDLCK
, &
lock
);

270 i‡(
	`socks_ißddr
(
d
, 0)) {

271 
sfd
 = &
socksfdv
[
d
];

273 #i‡
HAVE_GSSAPI


274 i‡(
sfd
->
°©e
.
gssimp‹äìded
 && !
sockscf
.°©e.
ösig«l
) {

275 
	`¶og
(
LOG_DEBUG
, "%s: imp‹tög gsßpi°©êf‹ fd %d", 
fun˘i⁄
, 
d
);

277 i‡(
	`gsßpi_imp‹t_°©e
(&
sfd
->
°©e
.
auth
.
md©a
.
gsßpi
.°©e.
id
,

278 &
sfd
->
°©e
.
gsßpi°©e
) != 0) {

279 
	`sw¨nx
("%s: failedÅo import gssapi context ofÜength %lu, fd %d",

280 
fun˘i⁄
, ()
sfd
->
°©e
.
gsßpi°©e
.
Àngth
, 
d
);

282 
	`socks_rmaddr
(
d
, 0);

283 
sfd
 = 
NULL
;

286 
sfd
->
°©e
.
gssimp‹äìded
 = 0;

287 
	`¶og
(
LOG_DEBUG
,

289 
fun˘i⁄
, 
d
, ()
sfd
->
°©e
.
auth
.
md©a
.
gsßpi
.°©e.
id
);

295 
sfd
 = 
NULL
;

297 i‡(
èkñock
)

298 
	`socks_addru∆ock
(&
lock
);

300 i‡(
sfd
 =
NULL
)

301  
NULL
;

303 *
socksfd
 = *
sfd
;

304  
socksfd
;

305 
	}
}

308 
	$socks_rmaddr
(
d
, 
èkñock
)

309 c⁄° 
d
;

310 c⁄° 
èkñock
;

312 c⁄° *
fun˘i⁄
 = "socks_rmaddr()";

313 
addæock›aque_t
 
lock
;

315 i‡(
d
 < 0 || (
size_t
)d >
socksfdc
)

318 i‡(
èkñock
)

319 
	`socks_addæock
(
F_WRLCK
, &
lock
);

321 
	`socks_rmfd
(
d
);

323 i‡(!
socksfdv
[
d
].
°©e
.
issysˇŒ
)

324 
	`socks_‰ìbuf„r
(
d
);

326 
socksfdv
[
d
].
°©e
.
vîsi⁄
) {

327 
PROXY_SOCKS_V4
:

328 
PROXY_SOCKS_V5
:

329 i‡(
socksfdv
[
d
].
°©e
.
issysˇŒ
)

332 #i‡
HAVE_GSSAPI


333 i‡(
socksfdv
[
d
].
°©e
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI


334 && 
socksfdv
[
d
].
°©e
.
auth
.
md©a
.
gsßpi
.°©e.
id
 !
GSS_C_NO_CONTEXT
) {

335 
OM_uöt32
 
maj‹_°©us
, 
mö‹_°©us
;

336 
buf
[512];

338 i‡((
maj‹_°©us


339 
	`gss_dñëe_£c_c⁄ãxt
(&
mö‹_°©us
,

340 &
socksfdv
[
d
].
°©e
.
auth
.
md©a
.
gsßpi
.°©e.
id
,

341 
GSS_C_NO_BUFFER
)Ë!
GSS_S_COMPLETE
) {

342 i‡(!
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, (buf)))

343 *
buf
 = 
NUL
;

345 
	`sw¨nx
("%s: gss_delete_sec_context() for fd %d failed%s%s",

346 
fun˘i⁄
,

347 
d
,

348 *
buf
 =
NUL
 ? "" : ": ",

349 *
buf
 =
NUL
 ? "" : buf);

352 
	`¶og
(
LOG_DEBUG
, "%s: deleted GSSAPI context for fd %d",

353 
fun˘i⁄
, 
d
);

355 
	`SASSERTX
(
socksfdv
[
d
].
°©e
.
auth
.
md©a
.
gsßpi
.°©e.
id


356 =
GSS_C_NO_CONTEXT
);

361 
socksfdv
[
d
].
°©e
.
comm™d
) {

362 
SOCKS_BIND
:

363 i‡(
socksfdv
[
d
].
c⁄åﬁ
 == -1

364 || 
socksfdv
[
d
].
c⁄åﬁ
 == d)

373 i‡(
	`socks_addrc⁄åﬁ
(-1, 
d
, 0) != -1)

376 
	`˛o£
(
socksfdv
[
d
].
c⁄åﬁ
);

379 
SOCKS_CONNECT
:

382 
SOCKS_UDPASSOCIATE
:

383 i‡(
socksfdv
[
d
].
c⁄åﬁ
 != -1)

384 
	`˛o£
(
socksfdv
[
d
].
c⁄åﬁ
);

388 
	`SERRX
(
socksfdv
[
d
].
°©e
.
comm™d
);

392 
PROXY_UPNP
:

393 i‡(
socksfdv
[
d
].
°©e
.
issysˇŒ
)

396 
	`u≤p˛ónup
(
d
);

400 #ifde‡
THREAD_DEBUG


401 i‡(
sockscf
.
log
.
Âv
 !
NULL
) {

402 
buf
[80];

404 
	`¢¥ötf
(
buf
, (buf),

406 
fun˘i⁄
, 
d
, 
socksfdv
[d].
°©e
.
comm™d
);

408 
	`syssys_wrôe
(
	`fûío
(
sockscf
.
log
.
Âv
[0]), 
buf
, 
	`°æí
(buf) + 1);

412 
socksfdv
[
d
] = 
socksfdöô
;

414 #i‡
DIAGNOSTIC


415 
	`SASSERTX
(
	`socks_ißddr
(
d
, 0) == 0);

416 
	`SASSERTX
(
	`socks_gëaddr
(
d
, 
NULL
, 0) == NULL);

419 i‡(
èkñock
)

420 
	`socks_addru∆ock
(&
lock
);

421 
	}
}

424 
	$socks_ißddr
(
d
, 
èkñock
)

425 c⁄° 
d
;

426 c⁄° 
èkñock
;

429 i‡(
d
 < 0 || (
size_t
)d >
socksfdc
)

432  
socksfdv
[
d
].
Æloˇãd
;

433 
	}
}

436 
	$socks_addrisours
(
s
, 
socksfdm©ch
, 
èkñock
)

437 c⁄° 
s
;

438 
socksfd_t
 *
socksfdm©ch
;

439 c⁄° 
èkñock
;

441 c⁄° *
fun˘i⁄
 = "socks_addrisours()";

442 c⁄° *
bªakªas⁄
 = 
NULL
;

443 c⁄° 
î∫o_s
 = 
î∫o
;

444 
addæock›aque_t
 
lock
;

445 
sockaddr_°‹age
 
loˇl
, 
ªmŸe
;

446 
sockÀn_t
 
loˇŒí
, 
ªmŸñí
;

447 
m©ched
, 
ty≥
;

449 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
s
);

451 i‡(
èkñock
)

452 
	`socks_addæock
(
F_RDLCK
, &
lock
);

454 
loˇŒí
 = (
loˇl
);

455 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
loˇl
), &
loˇŒí
) != 0) {

456 
	`¶og
(
LOG_DEBUG
,

458 
fun˘i⁄
, 
s
, 
î∫o
, 
	`°ªº‹
(errno));

460 i‡(
èkñock
)

461 
	`socks_addru∆ock
(&
lock
);

463 
î∫o
 = 
î∫o_s
;

467 
	`¶og
(
LOG_DEBUG
, "%s:Üocaláddress of fd %d is %s",

468 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(&
loˇl
, 
NULL
, 0));

471 i‡(
loˇl
.
ss_Ámûy
 !
AF_INET


472 #ifde‡
AF_INET6


473 && 
loˇl
.
ss_Ámûy
 !
AF_INET6


476 
	`¶og
(
LOG_DEBUG
,

478 
fun˘i⁄
, 
s
);

480 i‡(
èkñock
)

481 
	`socks_addru∆ock
(&
lock
);

483 
î∫o
 = 
î∫o_s
;

487 
loˇŒí
 = (
ty≥
);

488 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
ty≥
, &
loˇŒí
) != 0) {

489 
	`¶og
(
LOG_DEBUG
,

492 
fun˘i⁄
, 
s
, 
î∫o
, 
	`°ªº‹
(errno));

494 i‡(
èkñock
)

495 
	`socks_addru∆ock
(&
lock
);

497 
î∫o
 = 
î∫o_s
;

501 i‡(
ty≥
 !
SOCK_DGRAM
 &&Åy≥ !
SOCK_STREAM
) {

502 
	`¶og
(
LOG_DEBUG
,

504 
fun˘i⁄
, 
s
);

506 i‡(
èkñock
)

507 
	`socks_addru∆ock
(&
lock
);

509 
î∫o
 = 
î∫o_s
;

513 
î∫o
 = 0;

514 
m©ched
 = 0;

517 
socksfd_t
 
socksfd
;

519 i‡(
	`socks_gëaddr
(
s
, &
socksfd
, 0Ë!
NULL
) {

520 i‡((
socksfd
.
°©e
.
¥Ÿocﬁ
.
udp
 && 
ty≥
 !
SOCK_DGRAM
)

521 || (
socksfd
.
°©e
.
¥Ÿocﬁ
.
t˝
 && 
ty≥
 !
SOCK_STREAM
)) {

522 
bªakªas⁄
 = "protocol mismatch betweenÑegisteredánd current";

526 i‡(
	`TOCIN
(&
socksfd
.
loˇl
)->
sö_addr
.
s_addr
 =
	`ht⁄l
(0)) {

533 
socksfd_t
 
nsocksfd
, *
socksfd±r
;

534 
du≥d
;

536 
ªmŸñí
 = (
ªmŸe
);

537 i‡(
	`gë≥î«me
(
s
, 
	`TOSA
(&
ªmŸe
), &
ªmŸñí
) == 0

538 && (
du≥d
 = 
	`socks_addrm©ch
(&
loˇl
, &
ªmŸe
, 
NULL
, 0)) != -1) {

539 i‡((
socksfd±r
 = 
	`socks_addrdup
(
	`socks_gëaddr
(
du≥d
, 
NULL
, 0),

540 &
nsocksfd
)Ë=
NULL
) {

541 
	`sw¨n
("%s: socks_addrdup()", 
fun˘i⁄
);

543 i‡(
î∫o
 =
EBADF
)

544 
	`socks_rmaddr
(
du≥d
, 0);

546 
bªakªas⁄
 = "known fd, but unbound; socks_addrdup() failed";

550 
socksfd
 = *
socksfd±r
;

551 
	`socks_addaddr
(
s
, &
nsocksfd
, 0);

552 
m©ched
 = 1;

554 i‡(!
	`fdis›í
(
du≥d
))

555 
	`socks_rmaddr
(
du≥d
, 0);

558 
nsocksfd
 = 
socksfd
;

559 
	`TOIN
(&
nsocksfd
.
loˇl
)->
sö_addr
 = TOIN(&local)->sin_addr;

560 
socksfd
 = *
	`socks_addaddr
(
s
, &
nsocksfd
, 0);

564 i‡(!
	`sockaddøªeq
(&
loˇl
, &
socksfd
.local, 0)) {

565 
bªakªas⁄
 = "localÇeq socksfd.local";

570 
m©ched
 = 1;

573 
du≥d
;

575 i‡(!
	`PORTISBOUND
(&
loˇl
)) {

576 
bªakªas⁄
 = "unknown fdándÇoÜocal IP-address bound for it";

581 i‡((
du≥d
 = 
	`socks_addrm©ch
(&
loˇl
, 
NULL
, NULL, 0)) != -1

582 && ((
socksfdv
[
du≥d
].
°©e
.
¥Ÿocﬁ
.
udp
 && 
ty≥
 =
SOCK_DGRAM
)

583 || (
socksfdv
[
du≥d
].
°©e
.
¥Ÿocﬁ
.
t˝
 && 
ty≥
 =
SOCK_STREAM
))) {

584 
socksfd_t
 
nsocksfd
;

586 
	`¶og
(
LOG_DEBUG
, "%s: fd %dáppearsÅo beá dup of fd %d (%s)",

587 
fun˘i⁄
,

588 
s
,

589 
du≥d
,

590 
	`sockë2°rög
(
du≥d
, 
NULL
, 0));

592 i‡(
	`socks_addrdup
(
	`socks_gëaddr
(
du≥d
, 
NULL
, 0), &
nsocksfd
)

593 =
NULL
) {

594 
	`sw¨n
("%s: socks_addrdup()", 
fun˘i⁄
);

596 i‡(
î∫o
 =
EBADF
)

597 
	`socks_rmaddr
(
du≥d
, 0);

599 
bªakªas⁄
 = "unknown fdánd socks_addrdup() failed";

603 
	`socks_addaddr
(
s
, &
nsocksfd
, 0);

605 i‡(!
	`fdis›í
(
du≥d
))

606 
	`socks_rmaddr
(
du≥d
, 0);

608 
m©ched
 = 1;

611 
bªakªas⁄
 = "unknown fdándÇo socks_addrmatch()";

616 i‡(
m©ched
) {

617 
socksfd_t
 
socksfd
;

619 
	`socks_gëaddr
(
s
, &
socksfd
, 0);

620 
	`SASSERTX
(!(
socksfd
.
°©e
.
¥Ÿocﬁ
.
t˝
 && socksfd.°©e.¥Ÿocﬁ.
udp
));

622 i‡((
socksfd
.
°©e
.
¥Ÿocﬁ
.
udp
 && 
ty≥
 !
SOCK_DGRAM
)

623 || (
socksfd
.
°©e
.
¥Ÿocﬁ
.
t˝
 && 
ty≥
 !
SOCK_STREAM
)) {

624 
bªakªas⁄
 = "protocol mismatch betweenÑegisteredánd current";

625 
m©ched
 = 0;

628 i‡(
socksfdm©ch
 !
NULL
)

629 *
socksfdm©ch
 = 
socksfd
;

633 i‡(
èkñock
)

634 
	`socks_addru∆ock
(&
lock
);

636 i‡(!
m©ched
 && 
bªakªas⁄
 !
NULL
)

637 
	`¶og
(
LOG_DEBUG
, "%s:Çÿm©ch duêtÿ%s", 
fun˘i⁄
, 
bªakªas⁄
);

639 
î∫o
 = 
î∫o_s
;

640  
m©ched
;

641 
	}
}

644 
	$socks_addrc⁄åﬁ
(
c⁄åﬁ£¡
, 
c⁄åﬁöu£
, 
èkñock
)

645 c⁄° 
c⁄åﬁ£¡
;

646 c⁄° 
c⁄åﬁöu£
;

647 c⁄° 
èkñock
;

649 c⁄° *
fun˘i⁄
 = "socks_addrcontrol()";

650 
addæock›aque_t
 
lock
;

651 
fd£¡°r
[1024], 
fdöu£°r
[(fdsentstr)];

652 
i
;

654 
	`¶og
(
LOG_DEBUG
, "%s: sent fd %d (%s), in use fd %d (%s)",

655 
fun˘i⁄
,

656 
c⁄åﬁ£¡
,

657 
c⁄åﬁ£¡
 == -1 ?

658 "<n⁄e>" : 
	`sockë2°rög
(
c⁄åﬁ£¡
, 
fd£¡°r
, (fdsentstr)),

659 
c⁄åﬁöu£
,

660 
	`sockë2°rög
(
c⁄åﬁöu£
, 
fdöu£°r
, (fdinusestr)));

662 
	`SASSERTX
(
c⁄åﬁöu£
 >= 0);

664 i‡(
èkñock
)

665 
	`socks_addæock
(
F_RDLCK
, &
lock
);

667 i‡(
	`socks_ißddr
(
c⁄åﬁ£¡
, 0)) {

674 i‡(
	`fdisdup
(
c⁄åﬁ£¡
, 
socksfdv
[c⁄åﬁ£¡].
c⁄åﬁ
)) {

675 i‡(
èkñock
)

676 
	`socks_addru∆ock
(&
lock
);

678  
c⁄åﬁ£¡
;

682 
i
 = 0; i < ()
socksfdc
; ++i) {

683 i‡(!
	`socks_ißddr
(
i
, 0))

686 i‡(
socksfdv
[
i
].
°©e
.
comm™d
 == -1)

689 i‡(
	`fdisdup
(
c⁄åﬁöu£
, 
socksfdv
[
i
].
c⁄åﬁ
))

693 i‡(
èkñock
)

694 
	`socks_addru∆ock
(&
lock
);

696 i‡(
i
 < ()
socksfdc
)

697  
i
;

700 
	}
}

703 
	$socks_addrm©ch
(
loˇl
, 
ªmŸe
, 
°©e
, 
èkñock
)

704 c⁄° 
sockaddr_°‹age
 *
loˇl
;

705 c⁄° 
sockaddr_°‹age
 *
ªmŸe
;

706 c⁄° 
socks°©e_t
 *
°©e
;

707 c⁄° 
èkñock
;

709 c⁄° *
fun˘i⁄
 = "socks_addrmatch()";

710 
addæock›aque_t
 
lock
;

711 
l°r
[
MAXSOCKADDRSTRING
], 
r°r
[MAXSOCKADDRSTRING];

712 
i
;

714 
	`¶og
(
LOG_DEBUG
, "%s:Üocal = %s,Ñemote = %s",

715 
fun˘i⁄
,

716 
loˇl
 =
NULL
 ?

717 "NULL" : 
	`sockaddr2°rög
(
loˇl
, 
l°r
, (lstr)),

718 
ªmŸe
 =
NULL
 ?

719 "NULL" : 
	`sockaddr2°rög
(
ªmŸe
, 
r°r
, (rstr)));

721 i‡(
èkñock
)

722 
	`socks_addæock
(
F_RDLCK
, &
lock
);

724 
i
 = 0; i < ()
socksfdc
; ++i) {

725 i‡(!
	`socks_ißddr
(
i
, 0))

733 i‡(
loˇl
 !
NULL
) {

734 i‡(
	`sockaddøªeq
(
loˇl
, &
socksfdv
[
i
].local, 0))

735 
	`¶og
(
LOG_DEBUG
, "%s:Üocaláddress %s matches %s for socksfdv[%d]",

736 
fun˘i⁄
,

737 
	`sockaddr2°rög
(
loˇl
, 
l°r
, (lstr)),

738 
	`sockaddr2°rög
(&
socksfdv
[
i
].
loˇl
, 
NULL
, 0),

739 
i
);

744 i‡(
ªmŸe
 !
NULL
) {

745 i‡(
	`sockaddøªeq
(
ªmŸe
, &
socksfdv
[
i
].remote, 0))

746 
	`¶og
(
LOG_DEBUG
, "%s:Ñemoteáddress %s matches %s for socksfdv[%d]",

747 
fun˘i⁄
,

748 
	`sockaddr2°rög
(
ªmŸe
, 
r°r
, (rstr)),

749 
	`sockaddr2°rög
(&
socksfdv
[
i
].
ªmŸe
, 
NULL
, 0),

750 
i
);

755 i‡(
°©e
 !
NULL
) {

756 i‡(
°©e
->
vîsi⁄
 != -1)

757 i‡(
°©e
->
vîsi⁄
 !
socksfdv
[
i
].state.version)

760 i‡(
°©e
->
comm™d
 != -1)

761 i‡(
°©e
->
comm™d
 !
socksfdv
[
i
].state.command)

764 i‡(
°©e
->
ö¥ogªss
 != -1)

765 i‡(
°©e
->
ö¥ogªss
 !
socksfdv
[
i
].state.inprogress)

768 i‡(
°©e
->
ac˚±≥ndög
 != -1)

769 i‡(
°©e
->
ac˚±≥ndög
 !
socksfdv
[
i
].state.acceptpending)

776 i‡(
èkñock
)

777 
	`socks_addru∆ock
(&
lock
);

779 i‡(
i
 < ()
socksfdc
)

780  
i
;

783 
	}
}

785 
socksfd_t
 *

786 
	$socks_addrdup
(
ﬁd
, 
√w
)

787 c⁄° 
socksfd_t
 *
ﬁd
;

788 
socksfd_t
 *
√w
;

792 *
√w
 = *
ﬁd
;

794 
ﬁd
->
°©e
.
comm™d
) {

795 
SOCKS_BIND
:

796 
SOCKS_UDPASSOCIATE
:

797 i‡((
√w
->
c⁄åﬁ
 = 
	`sockë›tdup
(
ﬁd
->control, -1)) == -1)

798  
NULL
;

801 
SOCKS_CONNECT
:

809  
√w
;

810 
	}
}

813 
	$socks_addæock
(
lockty≥
, 
lock
)

814 c⁄° 
lockty≥
;

815 
addæock›aque_t
 *
lock
;

818 
	`socks_sigblock
(-1, (
sig£t_t
 *)
lock
);

820 #i‡
HAVE_PTHREAD_H


829 i‡(!
sockscf
.
°©e
.
ösig«l
)

831 
	`socks_±hªad_muãx_lock
(&
addrmuãx
);

833 
	}
}

836 
	$socks_addru∆ock
(
lock
)

837 c⁄° 
addæock›aque_t
 *
lock
;

840 #i‡
HAVE_PTHREAD_H


841 i‡(!
sockscf
.
°©e
.
ösig«l
)

842 
	`socks_±hªad_muãx_u∆ock
(&
addrmuãx
);

845 
	`socks_sigunblock
((c⁄° 
sig£t_t
 *)
lock
);

846 
	}
}

848 
ö_addr_t


849 
	$socks_addÁkeù
(
ho°
)

850 c⁄° *
ho°
;

852 c⁄° *
fun˘i⁄
 = "socks_addfakeip()";

853 
addæock›aque_t
 
lock
;

854 
ö_addr
 
addr
;

855 **
tmpmem
;

856 
ùc_added
;

858 
	`socks_addæock
(
F_WRLCK
, &
lock
);

860 i‡(
	`socks_gëÁkeù
(
ho°
, &
addr
)) {

861 
	`socks_addru∆ock
(&
lock
);

862  
addr
.
s_addr
;

865 #i‡
FAKEIP_END
 < 
FAKEIP_START


866 
îr‹
 "\"FAKEIP_END\" cannot be smallerÅhan \"FAKEIP_START\""

869 i‡(
ùc
 >
FAKEIP_END
 - 
FAKEIP_START
) {

870 
	`sw¨nx
("%s: fakeipÑange (%d - %d)Éxhausted",

871 
fun˘i⁄
, 
FAKEIP_START
, 
FAKEIP_END
);

873 
	`socks_addru∆ock
(&
lock
);

874  
INADDR_NONE
;

877 i‡((
tmpmem
 = 
	`ªÆloc
(
ùv
, (*ùvË* (
ùc
 + 1))Ë=
NULL


878 || (
tmpmem
[
ùc
] = 
	`mÆloc
((**tmpmemË* (
	`°æí
(
ho°
Ë+ 1))Ë=
NULL
) {

879 
	`sw¨n
("%s: couldÇotállocate %lu bytes",

880 
fun˘i⁄
,

881 ()(((*
ùv
Ë* (
ùc
 + 1))

882 + ((**
tmpmem
Ë* (
	`°æí
(
ho°
) + 1))));

884 i‡(
tmpmem
 !
NULL
)

885 
	`‰ì
(
tmpmem
);

887 
	`socks_addru∆ock
(&
lock
);

888  
INADDR_NONE
;

890 
ùv
 = 
tmpmem
;

892 
ùc_added
 = 
ùc
;

893 
	`°r˝y
(
ùv
[
ùc
++], 
ho°
);

895 
	`socks_addru∆ock
(&
lock
);

897  
	`ht⁄l
(
ùc_added
 + 
FAKEIP_START
);

898 
	}
}

901 
	$socks_gëÁkeho°
(
addr
)

902 
ö_addr_t
 
addr
;

904 c⁄° *
fun˘i⁄
 = "socks_getfakehost()";

905 
addæock›aque_t
 
lock
;

906 c⁄° *
ho°
;

908 i‡(
	`¡ohl
(
addr
Ë- 
FAKEIP_START
 < 
ùc
) {

909 
	`socks_addæock
(
F_RDLCK
, &
lock
);

910 
ho°
 = 
ùv
[
	`¡ohl
(
addr
Ë- 
FAKEIP_START
];

911 
	`socks_addru∆ock
(&
lock
);

914 i‡(
	`¡ohl
(
addr
Ë>
FAKEIP_START
 &&Çtohl◊ddrË<
FAKEIP_END
)

915 
	`sw¨nx
("%s:ÜooksÜike ipáddress %s might beá \"fake\" ipáddress, "

920 
fun˘i⁄
, 
	`öë_¡ﬂ
(*(
ö_addr
 *)&
addr
));

922 
ho°
 = 
NULL
;

925  
ho°
;

926 
	}
}

929 
	$socks_gëÁkeù
(
ho°
, 
addr
)

930 c⁄° *
ho°
;

931 
ö_addr
 *
addr
;

933 
addæock›aque_t
 
lock
;

934 
i
;

936 
	`socks_addæock
(
F_RDLCK
, &
lock
);

938 
i
 = 0; i < 
ùc
; ++i)

939 i‡(
	`°rˇ£cmp
(
ho°
, 
ùv
[
i
]) == 0) {

940 
addr
->
s_addr
 = 
	`ht⁄l
(
i
 + 
FAKEIP_START
);

944 
	`socks_addru∆ock
(&
lock
);

946 i‡(
i
 < 
ùc
)

950 
	}
}

952 
socksho°_t
 *

953 
	$Ákesockaddr2socksho°
(
_addr
, 
ho°
)

954 c⁄° 
sockaddr_°‹age
 *
_addr
;

955 
socksho°_t
 *
ho°
;

957 c⁄° *
fun˘i⁄
 = "fakesockaddr2sockshost()";

958 
sockaddr_°‹age
 
addr
;

959 
°rög
[
MAXSOCKADDRSTRING
];

961 
	`˛õ¡öô
();

963 
	`sockaddr˝y
(&
addr
, 
_addr
, 
	`ßÀn
(_addr->
ss_Ámûy
));

965 
	`¶og
(
LOG_DEBUG
, "%s: %s -> %s",

966 
fun˘i⁄
,

967 
	`sockaddr2°rög
(&
addr
, 
°rög
, (string)),

968 
	`socks_gëÁkeho°
(
	`TOIN
(&
addr
)->
sö_addr
.
s_addr
Ë=
NULL
 ?

969 
°rög
 : 
	`socks_gëÁkeho°
(
	`TOIN
(&
addr
)->
sö_addr
.
s_addr
));

971 i‡(
	`socks_gëÁkeho°
(
	`TOIN
(&
addr
)->
sö_addr
.
s_addr
Ë!
NULL
) {

972 c⁄° *
ù«me
 = 
	`socks_gëÁkeho°
(
	`TOIN
(&
addr
)->
sö_addr
.
s_addr
);

974 
	`SASSERTX
(
ù«me
 !
NULL
);

976 
ho°
->
©y≥
 = 
SOCKS_ADDR_DOMAIN
;

978 
	`STRCPY_ASSERTLEN
(
ho°
->
addr
.
domaö
, 
ù«me
);

980 
ho°
->
p‹t
 = 
	`TOIN
(&
addr
)->
sö_p‹t
;

983 
	`sockaddr2socksho°
(&
addr
, 
ho°
);

985  
ho°
;

986 
	}
}

988 
sockaddr_°‹age
 *

989 
	$öt_Ákesocksho°2sockaddr
(
ho°
, 
_addr
, 
_addæí
)

990 c⁄° 
socksho°_t
 *
ho°
;

991 
sockaddr_°‹age
 *
_addr
;

992 
size_t
 
_addæí
;

994 c⁄° *
fun˘i⁄
 = "int_fakesockshost2sockaddr()";

995 
sockaddr_°‹age
 
addr
;

996 
°rög
[
MAXSOCKSHOSTSTRING
];

998 
	`˛õ¡öô
();

1000 
	`¶og
(
LOG_DEBUG
, "%s: %s",

1001 
fun˘i⁄
, 
	`socksho°2°rög
(
ho°
, 
°rög
, (string)));

1003 
	`bzîo
(&
addr
, (addr));

1005 
ho°
->
©y≥
) {

1006 
SOCKS_ADDR_DOMAIN
:

1007 
	`SET_SOCKADDR
(&
addr
, 
AF_INET
);

1008 i‡(
	`socks_gëÁkeù
(
ho°
->
addr
.
domaö
, &(
	`TOIN
(&addr)->
sö_addr
)))

1013 
	`socksho°2sockaddr
(
ho°
, &
addr
);

1016 
	`TOIN
(&
addr
)->
sö_p‹t
 = 
ho°
->
p‹t
;

1018 
	`bzîo
(
_addr
, 
_addæí
);

1019 
	`sockaddr˝y
(
_addr
, &
addr
, 
	`MIN
(
	`ßÀn
◊ddr.
ss_Ámûy
), 
_addæí
));

1021  
_addr
;

1022 
	}
}

1025 
	$socks_addfd
(
d
)

1026 c⁄° 
d
;

1028 c⁄° *
fun˘i⁄
 = "socks_addfd()";

1030 
	`˛õ¡öô
();

1032 
	`SASSERTX
(
d
 >= 0);

1034 i‡(()
d
 >
dc
) {

1035 
size_t
 
√wfdc
;

1036 *
√wfdv
;

1038 
√wfdc
 = (
d
 + 1) * 2;

1039 i‡((
√wfdv
 = 
	`ªÆloc
(
dv
, (*dvË* 
√wfdc
)Ë=
NULL
)

1040 
	`£º
("%s: couldÇotállocate %lu bytes",

1041 
fun˘i⁄
, ()((*
dv
Ë* 
√wfdc
));

1043 
dv
 = 
√wfdv
;

1046 
dc
 < 
√wfdc
)

1047 
dv
[
dc
++] = -1;

1050 
dv
[
d
] = d;

1053 
	}
}

1056 
	$socks_isfd
(
d
)

1057 c⁄° 
d
;

1059 i‡(
d
 < 0 || ()d >
dc
 || 
dv
[d] == -1)

1062 
	}
}

1065 
	$socks_rmfd
(
d
)

1066 c⁄° 
d
;

1068 i‡(
	`socks_isfd
(
d
))

1069 
dv
[
d
] = -1;

1070 
	}
}

1074 
	$socks_addröô
()

1076 c⁄° *
fun˘i⁄
 = "socks_addrinit()";

1077 #i‡
HAVE_PTHREAD_H


1078 
±hªad_muãx©å_t
 
©å
;

1079 *
Õt
;

1082 #ifde‡
HAVE_VOLATILE_SIG_ATOMIC_T


1083 
sig_©omic_t
 
öôed
;

1085 vﬁ©ûê
sig_©omic_t
 
öôed
;

1088 i‡(
öôed
)

1091 i‡(
doög_addröô
)

1099 
doög_addröô
 = 1;

1104 
	`SASSERTX
(
socksfdv
 =
NULL
 && 
dv
 == NULL);

1106 i‡((
socksfdv
 = 
	`mÆloc
((*socksfdvË* 
FDV_INITSIZE
)Ë=
NULL
)

1107 
	`£º
("%s: failedÅoálloc %lu bytes for socksify socksfd memory",

1108 
fun˘i⁄
, ()((*
socksfdv
) * 64));

1110 i‡((
dv
 = 
	`mÆloc
((*dvË* 
FDV_INITSIZE
)Ë=
NULL
)

1111 
	`£º
("%s: failedÅoálloc %lu bytes for socksify dv memory",

1112 
fun˘i⁄
, ()((*
dv
) * 64));

1115 
socksfdc
 < 
FDV_INITSIZE
)

1116 
socksfdv
[
socksfdc
++] = 
socksfdöô
;

1119 
dc
 < 
FDV_INITSIZE
)

1120 
dv
[
dc
++] = -1;

1123 #i‡
HAVE_PTHREAD_H


1124 i‡(
	`socks_gëív
(
ENV_SOCKS_DISABLE_THREADLOCK
, 
i°rue
Ë!
NULL
)

1125 
	`¶og
(
LOG_DEBUG
, "pthreadÜocking off, manually disabled inÉnvironment");

1127 #i‡
HAVE_RTLD_NEXT


1133 i‡(
	`dlsym
(
RTLD_NEXT
, 
SYMBOL_PT_ATTRINIT
Ë!
NULL
) {

1138 
Õt
 = 
RTLD_NEXT
;

1139 
	`¶og
(
LOG_DEBUG
,

1140 "%s:ÖthªadÜockög desúed:ÅhªadedÖrogøm (πld)", 
fun˘i⁄
);

1143 
	`¶og
(
LOG_DEBUG
,

1144 "%s:ÖthªadÜockög off:Ç⁄-thªadedÖrogøm (πld)", 
fun˘i⁄
);

1146 
Õt
 = 
NULL
;

1151 i‡((
Õt
 = 
	`dl›í
(
LIBRARY_PTHREAD
, 
RTLD_LAZY
)Ë=
NULL
) {

1152 
	`sw¨n
("%s: compileÅime configurationÉrror? FailedÅo open "

1154 
fun˘i⁄
, 
LIBRARY_PTHREAD
, 
	`dÀº‹
());

1158 i‡(
Õt
 !
NULL
) {

1163 i‡((
±_öô
 = (
PT_INIT_FUNC_T
)
	`dlsym
(
Õt
, 
SYMBOL_PT_INIT
)Ë=
NULL
)

1164 
	`sw¨n
("%s: compileÅime configurationÉrror? "

1166 
fun˘i⁄
, 
SYMBOL_PT_INIT
, 
LIBRARY_PTHREAD
, 
	`dÀº‹
());

1168 i‡((
±_©åöô
 = (
PT_ATTRINIT_FUNC_T
)
	`dlsym
(
Õt
, 
SYMBOL_PT_ATTRINIT
))

1169 =
NULL
)

1170 
	`sw¨n
("%s: compileÅime configurationÉrror? "

1172 
fun˘i⁄
, 
SYMBOL_PT_ATTRINIT
, 
LIBRARY_PTHREAD
, 
	`dÀº‹
());

1174 i‡((
±_£ây≥
 = (
PT_SETTYPE_FUNC_T
)
	`dlsym
(
Õt
, 
SYMBOL_PT_SETTYPE
))

1175 =
NULL
)

1176 
	`sw¨n
("%s: compileÅime configurationÉrror? "

1178 
fun˘i⁄
, 
SYMBOL_PT_SETTYPE
, 
LIBRARY_PTHREAD
, 
	`dÀº‹
());

1180 i‡((
±_lock
 = (
PT_LOCK_FUNC_T
)
	`dlsym
(
Õt
, 
SYMBOL_PT_LOCK
)Ë=
NULL
)

1181 
	`sw¨n
("%s: compileÅime configurationÉrror? "

1183 
fun˘i⁄
, 
SYMBOL_PT_LOCK
, 
LIBRARY_PTHREAD
, 
	`dÀº‹
());

1185 i‡((
±_u∆ock
 = (
PT_UNLOCK_FUNC_T
)
	`dlsym
(
Õt
, 
SYMBOL_PT_UNLOCK
))

1186 =
NULL
)

1187 
	`sw¨n
("%s: compileÅime configurationÉrror? "

1189 
fun˘i⁄
, 
SYMBOL_PT_UNLOCK
, 
LIBRARY_PTHREAD
, 
	`dÀº‹
());

1191 i‡((
±_£lf
 = (
PT_SELF_FUNC_T
)
	`dlsym
(
Õt
, 
SYMBOL_PT_SELF
)Ë=
NULL
)

1192 
	`sw¨n
("%s: compileÅime configurationÉrror? "

1194 
fun˘i⁄
, 
SYMBOL_PT_SELF
, 
LIBRARY_PTHREAD
, 
	`dÀº‹
());

1197 i‡(
±_öô
 =
NULL
 || 
±_©åöô
 =NULL || 
±_£ây≥
 == NULL

1198 || 
±_lock
 =
NULL
 || 
±_u∆ock
 =NULL || 
±_£lf
 == NULL) {

1199 
±_öô
 = 
NULL
;

1200 
±_©åöô
 = 
NULL
;

1201 
±_£ây≥
 = 
NULL
;

1202 
±_lock
 = 
NULL
;

1203 
±_u∆ock
 = 
NULL
;

1204 
±_£lf
 = 
NULL
;

1207 i‡(
±_öô
 =
NULL
) {

1208 
	`¶og
(
LOG_INFO
, "%s:ÖthªadÜockög dißbÀd", 
fun˘i⁄
);

1209 
sockscf
.
°©e
.
thªadlockíabÀd
 = 0;

1212 
	`¶og
(
LOG_INFO
, "%s:ÖthªadÜockögÉ«bÀd", 
fun˘i⁄
);

1213 
sockscf
.
°©e
.
thªadlockíabÀd
 = 1;

1215 i‡(
	`socks_±hªad_muãx©å_öô
(&
©å
) != 0)

1216 
	`£º
("%s: muãx©å_öô(ËÁûed", 
fun˘i⁄
);

1218 i‡(
	`socks_±hªad_muãx©å_£ây≥
(&
©å
, 
PTHREAD_MUTEX_ERRORCHECK
)

1220 
	`sw¨n
("%s: mutex_settype(PTHREAD_MUTEX_ERRORCHECK) failed",

1221 
fun˘i⁄
);

1223 i‡(
	`socks_±hªad_muãx_öô
(&
addrmuãx
, &
©å
) != 0) {

1224 
	`sw¨n
("%s: muãx_öô(ËÁûed", 
fun˘i⁄
);

1226 i‡(
	`socks_±hªad_muãx_öô
(&
addrmuãx
, 
NULL
) != 0)

1227 
	`£º
("%s: muãx_öô(ËÁûed", 
fun˘i⁄
);

1233 
öôed
 = 1;

1234 
doög_addröô
 = 0;

1235 
	}
}

1237 
socks_id_t
 *

1238 
	$socks_whﬂmi
(
id
)

1239 
socks_id_t
 *
id
;

1242 #i‡
HAVE_PTHREAD_H


1243 i‡(
±_£lf
 !
NULL
) {

1244 
id
->
whichid
 = 
thªad
;

1245 
id
->id.
thªad
 = 
	`±_£lf
();

1247  
id
;

1251 
id
->
whichid
 = 
pid
;

1252 
id
->id.
pid
 = 
	`gëpid
();

1254  
id
;

1255 
	}
}

1257 #i‡
HAVE_PTHREAD_H


1260 
	$socks_±hªad_muãx_öô
(
muãx
, 
©å
)

1261 
±hªad_muãx_t
 *
muãx
;

1262 c⁄° 
±hªad_muãx©å_t
 *
©å
;

1264 i‡(
±_öô
 !
NULL
)

1265  
	`±_öô
(
muãx
, 
©å
);

1268 
	}
}

1271 
	$socks_±hªad_muãx©å_öô
(
©å
)

1272 
±hªad_muãx©å_t
 *
©å
;

1274 i‡(
±_©åöô
 !
NULL
)

1275  
	`±_©åöô
(
©å
);

1278 
	}
}

1281 
	$socks_±hªad_muãx©å_£ây≥
(
©å
, 
ty≥
)

1282 
±hªad_muãx©å_t
 *
©å
;

1283 
ty≥
;

1285 i‡(
±_£ây≥
 !
NULL
)

1286  
	`±_£ây≥
(
©å
, 
ty≥
);

1289 
	}
}

1292 
	$socks_±hªad_muãx_lock
(
muãx
)

1293 
±hªad_muãx_t
 *
muãx
;

1295 i‡(
±_lock
 !
NULL
)

1296  
	`±_lock
(
muãx
);

1299 
	}
}

1302 
	$socks_±hªad_muãx_u∆ock
(
muãx
)

1303 
±hªad_muãx_t
 *
muãx
;

1305 i‡(
±_u∆ock
 !
NULL
)

1306  
	`±_u∆ock
(
muãx
);

1309 
	}
}

	@lib/addressmatch.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
ùv4_addøªeq
(c⁄° 
ö_addr
 *
a
, c⁄° ö_add∏*
b
,

52 c⁄° 
ö_addr
 *
mask
);

62 
UNIT_TEST_STATIC_SCOPE
 

63 
ùv6_addøªeq
(c⁄° 
ö6_addr
 *
a
, c⁄° ö6_add∏*
b
,

64 
maskbôs
);

70 
ho°¨ìq
(c⁄° *
ruÀdomaö
, c⁄° *
addrdomaö
);

84 
	$addrm©ch
(
ruÀ
, 
addr
, 
addrm©ched
, 
¥Ÿocﬁ
, 
Æüs
)

85 c⁄° 
ruÀaddr_t
 *
ruÀ
;

86 c⁄° 
socksho°_t
 *
addr
;

87 
socksho°_t
 *
addrm©ched
;

88 
¥Ÿocﬁ
;

89 
Æüs
;

91 c⁄° *
fun˘i⁄
 = "addrmatch()";

92 
addröfo
 *
ai_ruÀ
, *
ai_addr
, 
höts
;

93 
sockaddr_°‹age
 
ß
;

94 
dnsöfo_t
 
ai_ruÀmem
, 
ai_addrmem
;

95 
socksho°_t
 
addrm©ched_mem
;

96 
ö_p‹t_t
 
ruÀp‹t
;

97 c⁄° *
p
;

98 
size_t
 
i
;

99 
ho°«me
[
MAXHOSTNAMELEN
];

100 
d‹esﬁve
, 
rc
;

102 i‡(
sockscf
.
›ti⁄
.
debug
) {

103 
r°rög
[
MAXRULEADDRSTRING
], 
a°rög
[
MAXSOCKSHOSTSTRING
];

105 
	`¶og
(
LOG_DEBUG
,

107 
fun˘i⁄
,

108 
	`ruÀaddr2°rög
(
ruÀ
,

109 
ADDRINFO_ATYPE
 | 
ADDRINFO_PORT
,

110 
r°rög
,

111 (
r°rög
)),

112 
	`socksho°2°rög2
(
addr
,

113 
ADDRINFO_ATYPE
 | 
ADDRINFO_PORT
,

114 
a°rög
,

115 (
a°rög
)),

116 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
),

117 
Æüs
 ? "with" : "without");

120 i‡(
addrm©ched
 =
NULL
)

121 
addrm©ched
 = &
addrm©ched_mem
;

123 *
addrm©ched
 = *
addr
;

126 
¥Ÿocﬁ
) {

127 
SOCKS_TCP
:

128 
ruÀp‹t
 = 
ruÀ
->
p‹t
.
t˝
;

131 
SOCKS_UDP
:

132 
ruÀp‹t
 = 
ruÀ
->
p‹t
.
udp
;

136 
	`SERRX
(
¥Ÿocﬁ
);

139 
ruÀ
->
›î©‹
) {

140 
n⁄e
:

143 
eq
:

144 i‡(
addr
->
p‹t
 =
ruÀp‹t
)

148 
√q
:

149 i‡(
addr
->
p‹t
 !
ruÀp‹t
)

153 
ge
:

154 i‡(
	`¡ohs
(
addr
->
p‹t
Ë>¡ohs(
ruÀp‹t
))

158 
À
:

159 i‡(
	`¡ohs
(
addr
->
p‹t
Ë<¡ohs(
ruÀp‹t
))

163 
gt
:

164 i‡(
	`¡ohs
(
addr
->
p‹t
Ë>Çtohs(
ruÀp‹t
))

168 
…
:

169 i‡(
	`¡ohs
(
addr
->
p‹t
Ë<Çtohs(
ruÀp‹t
))

173 
ønge
:

174 i‡(
	`¡ohs
(
addr
->
p‹t
Ë>¡ohs(
ruÀp‹t
)

175 && 
	`¡ohs
(
addr
->
p‹t
Ë<¡ohs(
ruÀ
->
p‹ãnd
))

180 
	`SERRX
(
ruÀ
->
›î©‹
);

183 
sockscf
.
ªsﬁvïrŸocﬁ
) {

184 
RESOLVEPROTOCOL_TCP
:

185 
RESOLVEPROTOCOL_UDP
:

186 
d‹esﬁve
 = 1;

189 
RESOLVEPROTOCOL_FAKE
:

190 
d‹esﬁve
 = 0;

194 
	`SERRX
(
sockscf
.
ªsﬁvïrŸocﬁ
);

207 i‡(
ruÀ
->
©y≥
 =
SOCKS_ADDR_IPV4
 && 
addr
->©y≥ =
SOCKS_ADDR_IPV6
)

210 i‡(
ruÀ
->
©y≥
 =
SOCKS_ADDR_IPV6
 && 
addr
->©y≥ =
SOCKS_ADDR_IPV4
)

218 i‡(
ruÀ
->
©y≥
 =
SOCKS_ADDR_IPVANY
) {

219 
	`SASSERTX
(
ruÀ
->
addr
.
ùv™y
.
mask
.
s_addr
 =
	`ht⁄l
(0));

223 i‡(
ruÀ
->
©y≥
 =
SOCKS_ADDR_IPV4


224 && 
ruÀ
->
addr
.
ùv4
.
mask
.
s_addr
 =
	`ht⁄l
(0))

227 i‡(
ruÀ
->
©y≥
 =
SOCKS_ADDR_IPV6
 &&ÑuÀ->
addr
.
ùv6
.
maskbôs
 == 0)

235 
	`bzîo
(&
höts
, (hints));

242 i‡((
ruÀ
->
©y≥
 =
SOCKS_ADDR_IPV4
 ||ÑuÀ->©y≥ =
SOCKS_ADDR_IPV6
)

243 && 
addr
->
©y≥
 =
SOCKS_ADDR_DOMAIN
) {

253 i‡(!
d‹esﬁve
)

266 
höts
.
ai_Ámûy
 = 0;

268 
rc
 = 
	`cgëaddröfo
(
addr
->addr.
domaö
, 
NULL
, &
höts
, &
ai_addr
, &
ai_addrmem
);

270 i‡(
rc
 != 0) {

271 
	`log_ªsﬁveÁûed
(
addr
->addr.
domaö
, 
EXTERNALIF
, 
rc
);

275 
ruÀ
->
©y≥
) {

276 
SOCKS_ADDR_IPV4
:

277 i‡((
p
 = 
	`ùv4_addrisöli°
(&
ruÀ
->
addr
.
ùv4
.
ù
,

278 &
ruÀ
->
addr
.
ùv4
.
mask
,

279 
ai_addr
)Ë=
NULL
)

282 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV4
;

283 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv4
, 
p
, (addrmatched->addr.ipv4));

286 
SOCKS_ADDR_IPV6
:

287 i‡((
p
 = 
	`ùv6_addrisöli°
(&
ruÀ
->
addr
.
ùv6
.
ù
,

288 
ruÀ
->
addr
.
ùv6
.
maskbôs
,

289 
ai_addr
)Ë=
NULL
)

292 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV6
;

294 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv6
.
ù
,

295 
p
,

296 (
addrm©ched
->
addr
.
ùv6
.
ù
));

301 
	`SERRX
(
ruÀ
->
©y≥
);

304 i‡((
ruÀ
->
©y≥
 =
SOCKS_ADDR_IPV4
 && 
addr
->atype == SOCKS_ADDR_IPV4)

305 || (
ruÀ
->
©y≥
 =
SOCKS_ADDR_IPV6
 && 
addr
->atype == SOCKS_ADDR_IPV6)){

312 
ruÀ
->
©y≥
) {

313 
SOCKS_ADDR_IPV4
:

314 i‡(
	`ùv4_addøªeq
(&
ruÀ
->
addr
.
ùv4
.
ù
,

315 &
addr
->addr.
ùv4
,

316 &
ruÀ
->
addr
.
ùv4
.
mask
))

320 
SOCKS_ADDR_IPV6
:

321 i‡(
	`ùv6_addøªeq
(&
ruÀ
->
addr
.
ùv6
.
ù
,

322 &
addr
->addr.
ùv6
.
ù
,

323 
ruÀ
->
addr
.
ùv6
.
maskbôs
))

328 
	`SERRX
(
ruÀ
->
©y≥
);

347 i‡(!
d‹esﬁve
)

350 i‡(!
Æüs
)

353 
	`socksho°2sockaddr
(
addr
, &
ß
);

355 
rc
 = 
	`sockaddr2ho°«me
(&
ß
, 
ho°«me
, (hostname));

357 i‡(
rc
 != 0) {

358 
	`log_ªsﬁveÁûed
(
	`sockaddr2°rög2
(&
ß
, 0, 
NULL
, 0),

359 
EXTERNALIF
,

360 
rc
);

370 
höts
.
ai_Ámûy
 = 
	`©y≥2ßÁmûy
(
ruÀ
->
©y≥
);

372 
rc
 = 
	`cgëaddröfo
(
ho°«me
, 
NULL
, &
höts
, &
ai_addr
, &
ai_addrmem
);

374 i‡(
rc
 != 0) {

375 
	`log_ªsﬁveÁûed
(
ho°«me
, 
EXTERNALIF
, 
rc
);

385 
ruÀ
->
©y≥
) {

386 
SOCKS_ADDR_IPV4
:

387 i‡((
p
 = 
	`ùv4_addrisöli°
(&
ruÀ
->
addr
.
ùv4
.
ù
,

388 &
ruÀ
->
addr
.
ùv4
.
mask
,

389 
ai_addr
)Ë=
NULL
)

392 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV4
;

393 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv4
, 
p
, (addrmatched->addr.ipv4));

396 
SOCKS_ADDR_IPV6
:

397 i‡((
p
 = 
	`ùv6_addrisöli°
(&
ruÀ
->
addr
.
ùv6
.
ù
,

398 
ruÀ
->
addr
.
ùv6
.
maskbôs
,

399 
ai_addr
)Ë=
NULL
)

402 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV6
;

404 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv6
.
ù
,

405 
p
,

406 (
addrm©ched
->
addr
.
ùv6
.
ù
));

411 
	`SERRX
(
ruÀ
->
©y≥
);

414 i‡(
ruÀ
->
©y≥
 =
SOCKS_ADDR_DOMAIN


415 && 
addr
->
©y≥
 =
SOCKS_ADDR_DOMAIN
) {

428 
addröfo
 *
√xt
;

431 i‡(
	`ho°¨ìq
(
ruÀ
->
addr
.
domaö
,áddr->addr.domain))

434 i‡(!
d‹esﬁve
)

437 i‡(*
ruÀ
->
addr
.
domaö
 == '.')

451 
	`£t_höts_ai_Ámûy
(&
höts
.
ai_Ámûy
);

453 
rc
 = 
	`cgëaddröfo
(
addr
->addr.
domaö
,

454 
NULL
,

455 &
höts
,

456 &
ai_addr
,

457 &
ai_addrmem
);

459 i‡(
rc
 != 0) {

460 
	`log_ªsﬁveÁûed
(
addr
->addr.
domaö
, 
EXTERNALIF
, 
rc
);

464 
rc
 = 
	`cgëaddröfo
(
ruÀ
->
addr
.
domaö
, 
NULL
, &
höts
, &
ai_ruÀ
, &
ai_ruÀmem
);

466 i‡(
rc
 != 0) {

467 
	`log_ªsﬁveÁûed
(
ruÀ
->
addr
.
domaö
, 
INTERNALIF
, 
rc
);

469 
	`sw¨nx
("%s: cgetaddrinfo(%s) failed: %s",

470 
fun˘i⁄
, 
ruÀ
->
addr
.
domaö
, 
	`gai_°ªº‹
(
rc
));

483 
√xt
 = 
ai_ruÀ
;

485 
	`SASSERT
(
√xt
->
ai_addr
 !
NULL
);

487 
√xt
->
ai_Ámûy
) {

488 
AF_INET
: {

489 
ö_addr
 
mask
;

491 
mask
.
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

493 i‡((
p
 = 
	`ùv4_addrisöli°
(&
	`TOIN
(
√xt
->
ai_addr
)->
sö_addr
,

494 &
mask
,

495 
ai_addr
)Ë!
NULL
) {

496 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV4
;

498 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv4
,

499 
p
,

500 (
addrm©ched
->
addr
.
ùv4
));

508 
AF_INET6
:

509 i‡((
p
 = 
	`ùv6_addrisöli°
(&
	`TOIN6
(
√xt
->
ai_addr
)->
sö6_addr
,

510 
IPV6_NETMASKBITS
,

511 
ai_addr
)Ë!
NULL
) {

513 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV6
;

515 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv6
.
ù
,

516 
p
,

517 (
addrm©ched
->
addr
.
ùv6
.
ù
));

525 
	`sw¨nx
("%s: unexpectedáf_family inái_rule for %s: %d",

526 
fun˘i⁄
,

527 
ruÀ
->
addr
.
domaö
,

528 
√xt
->
ai_Ámûy
);

531 
√xt
 =Çext->
ai_√xt
;

532 } 
√xt
 !
NULL
);

536 i‡(
ruÀ
->
©y≥
 =
SOCKS_ADDR_DOMAIN


537 && (
addr
->
©y≥
 =
SOCKS_ADDR_IPV4
 ||áddr->©y≥ =
SOCKS_ADDR_IPV6
)) {

571 
addröfo
 *
√xt
;

573 i‡(!
d‹esﬁve
)

576 i‡(*
ruÀ
->
addr
.
domaö
 == '.') {

581 
	`socksho°2sockaddr
(
addr
, &
ß
);

583 
rc
 = 
	`sockaddr2ho°«me
(&
ß
, 
ho°«me
, (hostname));

585 i‡(
rc
 != 0) {

586 
	`log_ªsﬁveÁûed
(
	`sockaddr2°rög2
(&
ß
, 0, 
NULL
, 0),

587 
EXTERNALIF
,

588 
rc
);

593  
	`ho°¨ìq
(
ruÀ
->
addr
.
domaö
, 
ho°«me
);

620 
rc
 = 
	`cgëaddröfo
(
ruÀ
->
addr
.
domaö
, 
NULL
, &
höts
, &
ai_ruÀ
, &
ai_ruÀmem
);

622 i‡(
rc
 != 0) {

623 
	`log_ªsﬁveÁûed
(
ruÀ
->
addr
.
domaö
, 
INTERNALIF
, 
rc
);

625 
	`sw¨nx
("%s: cgetaddrinfo(%s) failed: %s",

626 
fun˘i⁄
, 
ruÀ
->
addr
.
domaö
, 
	`gai_°ªº‹
(
rc
));

631 
addr
->
©y≥
) {

632 
SOCKS_ADDR_IPV4
: {

633 
ö_addr
 
mask
;

635 
mask
.
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

637 i‡((
p
 = 
	`ùv4_addrisöli°
(&
addr
->addr.
ùv4
, &
mask
, 
ai_ruÀ
))

638 !
NULL
) {

639 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV4
;

641 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv4
,

642 
p
,

643 (
addrm©ched
->
addr
.
ùv4
));

651 
SOCKS_ADDR_IPV6
: {

652 i‡((
p
 = 
	`ùv6_addrisöli°
(&
addr
->addr.
ùv6
.
ù
,

653 
IPV6_NETMASKBITS
,

654 
ai_ruÀ
)Ë!
NULL
) {

655 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV6
;

657 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv6
.
ù
,

658 
p
,

659 (
addrm©ched
->
addr
.
ùv6
.
ù
));

668 
	`SERRX
(
addr
->
©y≥
);

671 i‡(!
Æüs
)

679 
	`socksho°2sockaddr
(
addr
, &
ß
);

681 
rc
 = 
	`sockaddr2ho°«me
(&
ß
, 
ho°«me
, (hostname));

683 i‡(
rc
 != 0) {

684 
	`log_ªsﬁveÁûed
(
	`sockaddr2°rög2
(&
ß
, 0, 
NULL
, 0),

685 
EXTERNALIF
,

686 
rc
);

690 
rc
 = 
	`cgëaddröfo
(
ho°«me
, 
NULL
, &
höts
, &
ai_addr
, &
ai_addrmem
);

692 i‡(
rc
 != 0) {

693 
	`log_ªsﬁveÁûed
(
ho°«me
, 
EXTERNALIF
, 
rc
);

704 
√xt
 = 
ai_ruÀ
;

706 
	`SASSERT
(
√xt
->
ai_addr
 !
NULL
);

708 
√xt
->
ai_Ámûy
) {

709 
AF_INET
: {

710 
ö_addr
 
mask
;

712 
mask
.
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

713 i‡((
p
 = 
	`ùv4_addrisöli°
(&
	`TOIN
(
√xt
->
ai_addr
)->
sö_addr
,

714 &
mask
,

715 
ai_addr
)Ë!
NULL
) {

716 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV4
;

718 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv4
,

719 
p
,

720 (
addrm©ched
->
addr
.
ùv4
));

728 
AF_INET6
:

729 i‡((
p
 = 
	`ùv6_addrisöli°
(&
	`TOIN6
(
√xt
->
ai_addr
)->
sö6_addr
,

730 
IPV6_NETMASKBITS
,

731 
ai_addr
)Ë!
NULL
) {

732 
addrm©ched
->
©y≥
 = 
SOCKS_ADDR_IPV6
;

734 
	`mem˝y
(&
addrm©ched
->
addr
.
ùv6
.
ù
,

735 
p
,

736 (
addrm©ched
->
addr
.
ùv6
.
ù
));

744 
	`sw¨nx
("%s: unexpectedáf_family inái_rule for %s: %d",

745 
fun˘i⁄
,

746 
ruÀ
->
addr
.
domaö
,

747 
√xt
->
ai_Ámûy
);

750 
√xt
 =Çext->
ai_√xt
;

751 } 
√xt
 !
NULL
);

755 i‡(
ruÀ
->
©y≥
 =
SOCKS_ADDR_IFNAME
) {

761 
sockaddr_°‹age
 
ss
, 
mask
;

762 
m©ched
;

764 
i
 = 
m©ched
 = 0;

765 !
m©ched


766 && 
	`i‚ame2sockaddr
(
ruÀ
->
addr
.
i‚ame
, 
i
++, &
ss
, &
mask
Ë!
NULL
) {

767 
ruÀaddr_t
 
ruÀaddr
;

769 
	`sockaddr2ruÀaddr
(&
ss
, &
ruÀaddr
);

770 i‡(
	`addrm©ch
(&
ruÀaddr
, 
addr
, 
addrm©ched
, 
¥Ÿocﬁ
, 
Æüs
))

777 
	`SERRX
(0);

780 
	`SERRX
(0);

782 
	}
}

784 c⁄° 
ö_addr
 *

785 
	$ùv4_addrisöli°
(
addr
, 
mask
, 
aûi°
)

786 c⁄° 
ö_addr
 *
addr
;

787 c⁄° 
ö_addr
 *
mask
;

788 c⁄° 
addröfo
 *
aûi°
;

790 c⁄° 
addröfo
 *
√xt
 = 
aûi°
;

792 
	`SASSERTX
(
√xt
->
ai_addr
 !
NULL
);

794 i‡(
√xt
->
ai_addr
->
ß_Ámûy
 =
AF_INET
) {

795 i‡(
	`ùv4_addøªeq
(
addr
, &
	`TOCIN
(
√xt
->
ai_addr
)->
sö_addr
, 
mask
))

796  &
	`TOCIN
(
√xt
->
ai_addr
)->
sö_addr
;

799 
√xt
 =Çext->
ai_√xt
;

800 } 
√xt
 !
NULL
);

802  
NULL
;

803 
	}
}

805 c⁄° 
ö6_addr
 *

806 
	$ùv6_addrisöli°
(
addr
, 
maskbôs
, 
aûi°
)

807 c⁄° 
ö6_addr
 *
addr
;

808 c⁄° 
maskbôs
;

809 c⁄° 
addröfo
 *
aûi°
;

811 c⁄° 
addröfo
 *
√xt
 = 
aûi°
;

813 
	`SASSERTX
(
√xt
->
ai_addr
 !
NULL
);

815 i‡(
√xt
->
ai_addr
->
ß_Ámûy
 =
AF_INET6
) {

816 i‡(
	`ùv6_addøªeq
(
addr
, &
	`TOCIN6
(
√xt
->
ai_addr
)->
sö6_addr
, 
maskbôs
))

817  &
	`TOCIN6
(
√xt
->
ai_addr
)->
sö6_addr
;

820 
√xt
 =Çext->
ai_√xt
;

821 } 
√xt
 !
NULL
);

823  
NULL
;

824 
	}
}

828 
	$ùv4_addøªeq
(
a
, 
b
, 
mask
)

829 c⁄° 
ö_addr
 *
a
;

830 c⁄° 
ö_addr
 *
b
;

831 c⁄° 
ö_addr
 *
mask
;

834  (
a
->
s_addr
 & 
mask
->s_addrË=(
b
->s_addr & mask->s_addr);

835 
	}
}

837 
UNIT_TEST_STATIC_SCOPE
 

838 
	$ùv6_addøªeq
(
a
, 
b
, 
maskbôs
)

839 c⁄° 
ö6_addr
 *
a
;

840 c⁄° 
ö6_addr
 *
b
;

841 
maskbôs
;

843 c⁄° 
maskv
[
CHAR_BIT
 + 1] = { 0,

852 
size_t
 
i
;

854 
	`SASSERTX
(
CHAR_BIT
 <= 8);

855 
	`SASSERTX
(
maskbôs
 <
IPV6_NETMASKBITS
);

866 
	`SASSERTX
((
maskbôs
 / 
CHAR_BIT
Ë<
	`ELEMENTS
(
a
->
s6_addr
));

867 
i
 = 0;

868 
maskbôs
 > 0) {

869 i‡(
maskbôs
 >
CHAR_BIT
) {

871 i‡(
a
->
s6_addr
[
i
] !
b
->s6_addr[i])

874 
maskbôs
 -
CHAR_BIT
;

875 ++
i
;

882  (
a
->
s6_addr
[
i
] & 
maskv
[
maskbôs
])

883 =(
b
->
s6_addr
[
i
] & 
maskv
[
maskbôs
]);

888 
	}
}

892 
	$ho°¨ìq
(
ruÀdomaö
, 
addrdomaö
)

893 c⁄° *
ruÀdomaö
;

894 c⁄° *
addrdomaö
;

896 c⁄° *
fun˘i⁄
 = "hostareeq()";

897 c⁄° 
size_t
 
ruÀdomaöÀn
 = 
	`°æí
(
ruÀdomaö
);

898 c⁄° 
size_t
 
ªmŸedomaöÀn
 = 
	`°æí
(
addrdomaö
);

900 
	`¶og
(
LOG_DEBUG
, "%s: %s, %s", 
fun˘i⁄
, 
ruÀdomaö
, 
addrdomaö
);

902 i‡(*
ruÀdomaö
 == '.') {

903 i‡(
ruÀdomaöÀn
 - 1 > 
ªmŸedomaöÀn
)

906  
	`°rˇ£cmp
(
ruÀdomaö
 + 1,

907 
addrdomaö
 + (
ªmŸedomaöÀn
 - (
ruÀdomaöÀn
 - 1)))

911  
	`°rˇ£cmp
(
ruÀdomaö
, 
addrdomaö
) == 0;

912 
	}
}

	@lib/authneg.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$√gŸüã_mëhod
(
s
, 
∑ckë
, 
rouã
, 
emsg
, 
emsgÀn
)

52 
s
;

53 
socks_t
 *
∑ckë
;

54 
rouã_t
 *
rouã
;

55 *
emsg
;

56 c⁄° 
size_t
 
emsgÀn
;

58 c⁄° *
fun˘i⁄
 = "negotiate_method()";

59 
ssize_t
 
rc
;

60 
size_t
 
i
, 
ªque°Àn
;

61 *
«me
 = 
NULL
, *
∑ssw‹d
 = NULL;

62 
ªque°
[ 1

64 + 
METHODS_KNOWN


66 
ª•⁄£
[ 1

69 
buf
[256], 
Àmsg
[512] ;

70 
ötmëhodv
[
METHODS_KNOWN
];

72 i‡(
sockscf
.
›ti⁄
.
debug
)

73 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, %s", 
fun˘i⁄
, 
s
, 
	`sockë2°rög
(s, 
NULL
, 0));

75 #i‡!
SOCKS_CLIENT
 && 
HAVE_GSSAPI


76 
∑ckë
->
ªq
.
auth
->
mëhod
) {

77 
AUTHMETHOD_GSSAPI
:

85 
	`bzîo
(&
∑ckë
->
ªq
.
auth
->
md©a
.
gsßpi
,

86 (
∑ckë
->
ªq
.
auth
->
md©a
.
gsßpi
));

88 
∑ckë
->
ªq
.
auth
->
mëhod
 = 
AUTHMETHOD_NOTSET
;

94 i‡(
∑ckë
->
ªq
.
vîsi⁄
 =
PROXY_SOCKS_V4
) {

95 
	`¶og
(
LOG_DEBUG
,

97 
fun˘i⁄
,

98 
	`¥oxy¥Ÿocﬁ2°rög
(
∑ckë
->
ªq
.
vîsi⁄
),

99 
	`mëhod2°rög
(
AUTHMETHOD_NONE
));

102 
∑ckë
->
ªq
.
auth
->
mëhod
 = 
AUTHMETHOD_NONE
;

103 
∑ckë
->
ªs
.
auth
->
mëhod
 = 
AUTHMETHOD_NONE
;

108 
	`SASSERTX
(
∑ckë
->
gw
.
°©e
.
smëhodc
 > 0);

109 
	`SASSERTX
(
∑ckë
->
gw
.
°©e
.
smëhodc
 <
METHODS_KNOWN
);

116 
ªque°Àn
 = 0;

117 
ªque°
[
ªque°Àn
++] = 
∑ckë
->
ªq
.
vîsi⁄
;

119 
	`SASSERTX
(
ªque°Àn
 =
AUTH_NMETHODS
);

120 
ªque°
[
ªque°Àn
++] = ()0;

121 
	`SASSERTX
(
ªque°
[
AUTH_NMETHODS
] == 0);

127 
i
 = 0; i < 
∑ckë
->
gw
.
°©e
.
smëhodc
; ++i) {

128 i‡(
∑ckë
->
ªq
.
auth
->
mëhod
 !
AUTHMETHOD_NOTSET
) {

138 
	`SASSERTX
(!
SOCKS_CLIENT
);

140 
∑ckë
->
gw
.
°©e
.
smëhodv
[
i
]) {

141 
AUTHMETHOD_NONE
:

144 
AUTHMETHOD_UNAME
:

145 i‡(
∑ckë
->
ªq
.
auth
->
mëhod
 !
AUTHMETHOD_UNAME
)

150 
AUTHMETHOD_GSSAPI
:

159 
	`SERRX
(
∑ckë
->
gw
.
°©e
.
smëhodv
[
i
]);

163 
ªque°
[
ªque°Àn
++] = ()
∑ckë
->
gw
.
°©e
.
smëhodv
[
i
];

164 ++
ªque°
[
AUTH_NMETHODS
];

167 
	`SASSERTX
(
ªque°
[
AUTH_NMETHODS
] > 0);

168 
	`SASSERTX
(
ªque°
[
AUTH_NMETHODS
] <
METHODS_KNOWN
);

169 
	`SASSERTX
(
ªque°
[
AUTH_NMETHODS
] <
	`ELEMENTS
(
ötmëhodv
));

171 
	`ch¨mëhod2ötmëhod
((
ssize_t
)
ªque°
[
AUTH_NMETHODS
],

172 &
ªque°
[
AUTH_FIRSTMETHOD
],

173 
ötmëhodv
);

175 
	`¶og
(
LOG_NEGOTIATE
, "%s: offeringÖroxy server #%d method%s: %s",

176 
fun˘i⁄
,

177 
ªque°
[
AUTH_NMETHODS
],

178 
ªque°
[
AUTH_NMETHODS
] == 1 ? "" : "s",

179 
	`mëhods2°rög
(
ªque°
[
AUTH_NMETHODS
], 
ötmëhodv
, 
buf
, (buf)));

181 i‡(
	`socks_£ndt⁄
(
s
,

182 
ªque°
,

183 
ªque°Àn
,

184 
ªque°Àn
,

186 
NULL
,

188 
NULL
,

189 
NULL
Ë!(
ssize_t
)
ªque°Àn
) {

190 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

193 
	`°ªº‹
(
î∫o
));

195 
	`socks_bœckli°
(
rouã
, 
emsg
);

199 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

200 
ª•⁄£
,

201 (
ª•⁄£
),

202 (
ª•⁄£
),

204 
NULL
,

205 
NULL
,

206 
NULL
,

207 
NULL
)Ë!(
ª•⁄£
)) {

208 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

211 ()
rc
,

212 ()(
ª•⁄£
),

213 
rc
 =0 ? "£rvî clo£d c⁄√˘i⁄" : 
	`°ªº‹
(
î∫o
));

215 
	`socks_bœckli°
(
rouã
, 
emsg
);

223 
	`SASSERTX
(
AUTH_VERSION
 <
rc
);

224 i‡(
ªque°
[
AUTH_VERSION
] !
ª•⁄£
[AUTH_VERSION]) {

225 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

228 
ª•⁄£
[
AUTH_VERSION
], 
ªque°
[AUTH_VERSION]);

230 
	`socks_bœckli°
(
rouã
, 
emsg
);

233 
∑ckë
->
vîsi⁄
 = 
ªque°
[
AUTH_VERSION
];

235 
	`SASSERTX
(
AUTH_SELECTEDMETHOD
 <
rc
);

236 i‡(!
	`mëhodis£t
(
ª•⁄£
[
AUTH_SELECTEDMETHOD
],

237 
ötmëhodv
,

238 
ªque°
[
AUTH_NMETHODS
])) {

239 i‡(
ª•⁄£
[
AUTH_SELECTEDMETHOD
] =
AUTHMETHOD_NOACCEPT
)

240 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

244 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

247 
ª•⁄£
[
AUTH_SELECTEDMETHOD
],

248 
	`mëhod2°rög
(
ª•⁄£
[
AUTH_SELECTEDMETHOD
]));

250 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

253 
	`socks_bœckli°
(
rouã
, 
emsg
);

257 
	`¶og
(
LOG_NEGOTIATE
, "%s:Öroxy server selected method %s",

258 
fun˘i⁄
, 
	`mëhod2°rög
(
ª•⁄£
[
AUTH_SELECTEDMETHOD
]));

260 
ª•⁄£
[
AUTH_SELECTEDMETHOD
]) {

261 
AUTHMETHOD_NONE
:

262 
rc
 = 0;

265 #i‡
HAVE_GSSAPI


266 
AUTHMETHOD_GSSAPI
:

267 i‡(
	`˛õ¡mëhod_gsßpi
(
s
,

268 
∑ckë
->
ªq
.
¥Ÿocﬁ
,

269 &
∑ckë
->
gw
,

270 
∑ckë
->
ªq
.
vîsi⁄
,

271 
∑ckë
->
ªq
.
auth
,

272 
Àmsg
,

273 (
Àmsg
)) == 0)

274 
rc
 = 0;

276 
rc
 = -1;

280 
AUTHMETHOD_UNAME
:

281 i‡(
	`˛õ¡mëhod_u«me
(
s
,

282 &
∑ckë
->
gw
.
addr
,

283 
∑ckë
->
ªq
.
vîsi⁄
,

284 
«me
,

285 
∑ssw‹d
,

286 
Àmsg
,

287 (
Àmsg
)) == 0)

288 
rc
 = 0;

290 
rc
 = -1;

293 
AUTHMETHOD_NOACCEPT
:

294 
	`¢¥ötf
(
Àmsg
, (lemsg),

298 
	`socks_bœckli°
(
rouã
, 
emsg
);

299 
rc
 = -1;

303 
	`SERRX
(
∑ckë
->
ªq
.
auth
->
mëhod
);

306 
∑ckë
->
ªq
.
auth
->
mëhod
 = 
ª•⁄£
[
AUTH_SELECTEDMETHOD
];

308 i‡(
rc
 == 0) {

309 
	`¶og
(
LOG_NEGOTIATE
, "%s:Éstablished v%d connection using method %d",

310 
fun˘i⁄
, 
∑ckë
->
vîsi⁄
,Öackë->
ªq
.
auth
->
mëhod
);

312 
î∫o
 = 0;

315 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

317 
∑ckë
->
vîsi⁄
,Öackë->
ªq
.
auth
->
mëhod
, 
Àmsg
);

319 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

322  ()
rc
;

323 
	}
}

	@lib/broken.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

	@lib/client.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 #i‡
HAVE_DARWIN
 || !
HAVE_PROGNAME


52 *
	g__¥og«me
 = "danteclient";

56 
	$SOCKSöô
(
¥og«me
)

57 *
¥og«me
;

60 
__¥og«me
 = 
¥og«me
;

62 
	}
}

65 
	$˛õ¡öô
()

67 #ifde‡
HAVE_VOLATILE_SIG_ATOMIC_T


68 
sig_©omic_t
 
öôög
;

70 vﬁ©ûê
sig_©omic_t
 
öôög
;

74 i‡(
sockscf
.
°©e
.
öôed


80 || 
öôög
)

83 
öôög
 = 1;

85 
sockscf
.
loglock
 = -1;

87 #i‡
HAVE_DARWIN


88 
__¥og«me
 = 
	`gë¥og«me
();

94 
	`socks_addröô
();

96 i‡((
sockscf
.
›ti⁄
.
c⁄figfûe
 = 
	`socks_gëív
(
ENV_SOCKS_CONF
, 
d⁄tˇª
))

97 =
NULL
)

98 
sockscf
.
›ti⁄
.
c⁄figfûe
 = 
SOCKS_CONFIGFILE
;

100 
	`gíîicöô
();

101 
	`√w¥ocöô
();

104 
	`ru√nvcheck
();

106 
	`showc⁄fig
(&
sockscf
);

108 
	`¶og
(
LOG_INFO
, "%s/˛õ¡ v%†ru¬ög", 
PRODUCT
, 
VERSION
);

111 
sockscf
.
°©e
.
öôed
 = 1;

112 
öôög
 = 0;

113 
	}
}

	@lib/clientconfig.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 
c⁄fig
 
	gsockscf
;

50 c⁄° 
	gsocks_c⁄figty≥
 = 
CONFIGTYPE_CLIENT
;

53 
	$ª£tc⁄fig
(
c⁄fig
, 
exôög
)

54 
c⁄fig
 *config;

55 c⁄° 
exôög
;

58 
	`‰ì
(
c⁄fig
->
sockë›ti⁄v
);

59 
	`bzîo
(
c⁄fig
, (*config));

60 
	}
}

	@lib/clientprotocol.c

51 
	~"comm⁄.h
"

53 #i‡
SOCKS_CLIENT
 || 
SOCKS_SERVER


54 
	~"öãΩosôi⁄.h
"

57 c⁄° 
	grcsid
[] =

61 
ªcv_socksho°
(
s
, 
socksho°_t
 *
ho°
, 
vîsi⁄
, 
authmëhod_t
 *
auth
,

62 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

73 
	$socks_£ndªque°
(
s
, 
ªque°
, 
emsg
, 
emsgÀn
)

74 
s
;

75 c⁄° 
ªque°_t
 *
ªque°
;

76 *
emsg
;

77 c⁄° 
size_t
 
emsgÀn
;

79 c⁄° *
fun˘i⁄
 = "socks_sendrequest()";

80 
ssize_t
 
rc
;

81 
size_t
 
Àn
;

82 
ªque°mem
[(*
ªque°
)], *
p
 =Ñequestmem;

84 
ªque°
->
vîsi⁄
) {

85 
PROXY_SOCKS_V4
:

92 
	`mem˝y
(
p
, &
ªque°
->
vîsi⁄
, (request->version));

93 
p
 +(
ªque°
->
vîsi⁄
);

96 
	`mem˝y
(
p
, &
ªque°
->
comm™d
, (request->command));

97 
p
 +(
ªque°
->
comm™d
);

99 
p
 = 
	`socksho°2mem
(&
ªque°
->
ho°
,Ö,Ñeque°->
vîsi⁄
);

101 *
p
 = 
NUL
;

102 ++
p
;

105 
PROXY_SOCKS_V5
:

122 
	`mem˝y
(
p
, &
ªque°
->
vîsi⁄
, (request->version));

123 
p
 +(
ªque°
->
vîsi⁄
);

126 
	`mem˝y
(
p
, &
ªque°
->
comm™d
, (request->command));

127 
p
 +(
ªque°
->
comm™d
);

130 
	`mem˝y
(
p
, &
ªque°
->
Êag
, (request->flag));

131 
p
 +(
ªque°
->
Êag
);

133 
p
 = 
	`socksho°2mem
(&
ªque°
->
ho°
,Ö,Ñeque°->
vîsi⁄
);

137 
	`SERRX
(
ªque°
->
vîsi⁄
);

140 
	`¶og
(
LOG_NEGOTIATE
, "%s: sendingÑequestÅo server: %s",

141 
fun˘i⁄
, 
	`socks_∑ckë2°rög
(
ªque°
, 1));

146 
Àn
 = 
p
 - 
ªque°mem
;

147 i‡((
rc
 = 
	`socks_£ndt⁄
(
s
,

148 
ªque°mem
,

149 
Àn
,

150 
Àn
,

152 
NULL
,

154 
NULL
,

155 
ªque°
->
auth
)Ë!(
ssize_t
)
Àn
) {

156 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

158 ()
rc
, ()
Àn
, 
	`°ªº‹
(
î∫o
));

163 
	}
}

166 
	$socks_ªcvª•⁄£
(
s
, 
ª•⁄£
, 
vîsi⁄
, 
emsg
, 
emsgÀn
)

167 
s
;

168 
ª•⁄£_t
 *
ª•⁄£
;

169 
vîsi⁄
;

170 *
emsg
;

171 c⁄° 
size_t
 
emsgÀn
;

173 c⁄° *
fun˘i⁄
 = "socks_recvresponse()";

174 
ssize_t
 
rc
;

177 
vîsi⁄
) {

178 
PROXY_SOCKS_V4
: {

184 
ª•⁄£mem
[ (
ª•⁄£
->
vîsi⁄
)

185 + (
ª•⁄£
->
ª∂y
.
socks
)

187 *
p
 = 
ª•⁄£mem
;

189 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

190 
ª•⁄£mem
,

191 (
ª•⁄£mem
),

192 (
ª•⁄£mem
),

194 
NULL
,

195 
NULL
,

196 
NULL
,

197 
ª•⁄£
->
auth
))

198 !(
ssize_t
)(
ª•⁄£mem
)) {

199 
	`fmåe•⁄£îr‹
(
rc
, (
ª•⁄£mem
), 
emsg
, 
emsgÀn
);

204 
	`mem˝y
(&
ª•⁄£
->
vîsi⁄
, 
p
, (response->version));

205 
p
 +(
ª•⁄£
->
vîsi⁄
);

206 i‡(
ª•⁄£
->
vîsi⁄
 !
PROXY_SOCKS_V4REPLY_VERSION
) {

207 
	`fmtvîsi⁄îr‹
(
PROXY_SOCKS_V4REPLY_VERSION
,

208 
ª•⁄£
->
vîsi⁄
,

209 
emsg
,

210 
emsgÀn
);

215 
	`mem˝y
(&
ª•⁄£
->
ª∂y
.
socks
, 
p
, (response->reply.socks));

216 
p
 +(
ª•⁄£
->
ª∂y
.
socks
);

220 
PROXY_SOCKS_V5
: {

233 
ª•⁄£mem
[(
ª•⁄£
->
vîsi⁄
)

234 + (
ª•⁄£
->
ª∂y
.
socks
)

235 + (
ª•⁄£
->
Êag
)

237 *
p
 = 
ª•⁄£mem
;

239 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

240 
ª•⁄£mem
,

241 (
ª•⁄£mem
),

242 (
ª•⁄£mem
),

244 
NULL
,

245 
NULL
,

246 
NULL
,

247 
ª•⁄£
->
auth
))

248 !(
ssize_t
)(
ª•⁄£mem
)) {

249 
	`fmåe•⁄£îr‹
(
rc
, (
ª•⁄£mem
), 
emsg
, 
emsgÀn
);

254 
	`mem˝y
(&
ª•⁄£
->
vîsi⁄
, 
p
, (response->version));

255 
p
 +(
ª•⁄£
->
vîsi⁄
);

256 i‡(
vîsi⁄
 !
ª•⁄£
->version) {

257 
	`fmtvîsi⁄îr‹
(
vîsi⁄
, 
ª•⁄£
->vîsi⁄, 
emsg
, 
emsgÀn
);

262 
	`mem˝y
(&
ª•⁄£
->
ª∂y
.
socks
, 
p
, (response->reply.socks));

263 
p
 +(
ª•⁄£
->
ª∂y
.
socks
);

266 
	`mem˝y
(&
ª•⁄£
->
Êag
, 
p
, (response->flag));

267 
p
 +(
ª•⁄£
->
Êag
);

273 
	`SERRX
(
vîsi⁄
);

276 i‡(
	`ªcv_socksho°
(
s
,

277 &
ª•⁄£
->
ho°
,

278 
vîsi⁄
,

279 
ª•⁄£
->
auth
,

280 
emsg
,

281 
emsgÀn
) != 0)

284 
	`¶og
(
LOG_NEGOTIATE
, "%s:ÑeceivedÑesponse from server: %s",

285 
fun˘i⁄
, 
	`socks_∑ckë2°rög
(
ª•⁄£
, 0));

288 
	}
}

291 
	$socks_√gŸüã
(
s
, 
c⁄åﬁ
, 
∑ckë
, 
rouã
, 
emsg
, 
emsgÀn
)

292 
s
;

293 
c⁄åﬁ
;

294 
socks_t
 *
∑ckë
;

295 
rouã_t
 *
rouã
;

296 *
emsg
;

297 c⁄° 
size_t
 
emsgÀn
;

299 c⁄° *
fun˘i⁄
 = "socks_negotiate()";

300 
sbuf
[512], 
cbuf
[512];

301 
Áûed
 = 0;

303 
	`¶og
(
LOG_NEGOTIATE
,

306 
fun˘i⁄
,

307 
	`¥oxy¥Ÿocﬁ2°rög
(
∑ckë
->
ªq
.
vîsi⁄
),

308 
c⁄åﬁ
,

309 
c⁄åﬁ
 =-1 ? "N/A" : 
	`sockë2°rög
(c⁄åﬁ, 
cbuf
, (cbuf)),

310 
s
,

311 
s
 =
c⁄åﬁ
 ? "ßme" : 
	`sockë2°rög
(s, 
sbuf
, (sbuf)),

312 
	`socksho°2°rög
(&
∑ckë
->
ªq
.
ho°
, 
NULL
, 0));

315 
	`bzîo
(&
∑ckë
->
ªs
.
ho°
, (packet->res.host));

317 
∑ckë
->
ªs
.
auth
 =Öackë->
ªq
.auth;

319 
∑ckë
->
ªq
.
vîsi⁄
) {

320 
PROXY_SOCKS_V4
:

321 i‡(
∑ckë
->
ªq
.
comm™d
 =
SOCKS_BIND
) {

322 i‡(
rouã
 !
NULL
 &&Ñouã->
gw
.
°©e
.
exãnsi⁄
.
böd
)

323 
∑ckë
->
ªq
.
ho°
.
addr
.
ùv4
.
s_addr
 = 
	`ht⁄l
(
BINDEXTENSION_IPADDR
);

324 #i‡
SOCKS_CLIENT


326 i‡(
∑ckë
->
ªq
.
vîsi⁄
 =
PROXY_SOCKS_V4
)

332 i‡(
	`¡ohs
(
sockscf
.
°©e
.
œ°c⁄√˘
.
p‹t
) != 0)

333 
∑ckë
->
ªq
.
ho°
.
p‹t
 = 
sockscf
.
°©e
.
œ°c⁄√˘
.port;

340 
PROXY_SOCKS_V5
: {

345 
rc
;

347 #i‡
SOCKS_CLIENT


348 
‹igöÆ_s
;

349 
executögdnscode
;

351 
	`socks_rmaddr
(
s
, 1);

352 
	`socks_rmaddr
(
c⁄åﬁ
, 1);

371 
	`SASSERTX
(
sockscf
.
°©e
.
executögdnscode
 >= 0);

372 i‡(
sockscf
.
°©e
.
executögdnscode


373 && 
s
 !
c⁄åﬁ


375 && 
∑ckë
->
ªq
.
comm™d
 =
SOCKS_UDPASSOCIATE
)

376 
executögdnscode
 = 1;

378 
executögdnscode
 = 0;

380 i‡(
executögdnscode
) {

381 
	`¶og
(
LOG_DEBUG
,

383 
fun˘i⁄
);

385 i‡((
‹igöÆ_s
 = 
	`dup
(
s
)) == -1)

386 
	`sw¨n
("%s: dup() failed on fd %d whileÉxecuting dns-code",

387 
fun˘i⁄
, 
s
);

389 
tmp_s
 = 
	`sockë›tdup
(
s
, -1);

391 i‡(
tmp_s
 == -1)

392 
	`sw¨n
("%s: socketoptdup() failed on fd %d whileÉxecuting "

394 
fun˘i⁄
, 
s
);

396 
rc
 = 
	`dup2
(
tmp_s
, 
s
);

397 
	`˛o£
(
tmp_s
);

399 i‡(
rc
 =
s
) {

400 
	`¶og
(
LOG_DEBUG
,

404 
fun˘i⁄
, 
s
, 
‹igöÆ_s
);

407 
	`sw¨n
("%s: dup2() failed on fd %d, fd %d whileÉxecuting "

409 
fun˘i⁄
, 
tmp_s
, 
s
);

415 
rc
 = 
	`√gŸüã_mëhod
(
c⁄åﬁ
, 
∑ckë
, 
rouã
, 
emsg
, 
emsgÀn
);

417 #i‡
SOCKS_CLIENT


418 i‡(
executögdnscode
 && 
‹igöÆ_s
 != -1) {

419 c⁄° 
î∫o_s
 = 
î∫o
;

421 
	`¶og
(
LOG_DEBUG
, "%s:Ñestoring data fd %d from saved fd %d (%s)",

422 
fun˘i⁄
, 
s
, 
‹igöÆ_s
, 
	`sockë2°rög
(‹igöÆ_s, 
NULL
, 0));

424 i‡(
	`dup2
(
‹igöÆ_s
, 
s
) != s)

425 
	`sw¨n
("%s: failedÅoÑestore data fd %d from saved fd %d",

426 
fun˘i⁄
, 
s
, 
‹igöÆ_s
);

428 
	`˛o£
(
‹igöÆ_s
);

429 
î∫o
 = 
î∫o_s
;

433 i‡(
rc
 != 0) {

434 i‡(
î∫o
 == 0)

435 
î∫o
 = 
ECONNREFUSED
;

437 
Áûed
 = 1;

441 
	`¶og
(
LOG_DEBUG
,

444 
fun˘i⁄
,

445 
∑ckë
->
ªq
.
auth
->
mëhod
,

446 
	`mëhod2°rög
(
∑ckë
->
ªq
.
auth
->
mëhod
));

448 i‡(
	`socks_£ndªque°
(
c⁄åﬁ
, &
∑ckë
->
ªq
, 
emsg
, 
emsgÀn
) != 0) {

449 
Áûed
 = 1;

453 i‡(
	`socks_ªcvª•⁄£
(
c⁄åﬁ
,

454 &
∑ckë
->
ªs
,

455 
∑ckë
->
ªq
.
vîsi⁄
,

456 
emsg
,

457 
emsgÀn
) != 0) {

458 
	`socks_bœckli°
(
rouã
, 
emsg
);

460 i‡(
î∫o
 == 0)

461 
î∫o
 = 
ECONNREFUSED
;

463 
Áûed
 = 1;

469 
PROXY_HTTP_10
:

470 
PROXY_HTTP_11
:

471 i‡(
	`hâµroxy_√gŸüã
(
c⁄åﬁ
, 
∑ckë
, 
emsg
, 
emsgÀn
) != 0) {

472 i‡(
î∫o
 == 0)

473 
î∫o
 = 
ECONNREFUSED
;

475 
Áûed
 = 1;

480 #i‡
HAVE_LIBMINIUPNP


481 
PROXY_UPNP
:

482 i‡(
	`u≤p_√gŸüã
(
s
, 
∑ckë
, &
rouã
->
gw
, 
emsg
, 
emsgÀn
) != 0) {

483 i‡(
î∫o
 == 0)

484 
î∫o
 = 
ECONNREFUSED
;

486 
Áûed
 = 1;

493 
	`SERRX
(
∑ckë
->
ªq
.
vîsi⁄
);

496 i‡(!
Áûed
) {

497 i‡(
	`£rvîª∂yisok
(
∑ckë
->
ªs
.
vîsi⁄
,

498 
∑ckë
->
ªq
.
comm™d
,

499 
	`socks_gë_ª•⁄£vÆue
(&
∑ckë
->
ªs
),

500 
rouã
,

501 
emsg
,

502 
emsgÀn
)) {

503 i‡(
î∫o
 !
EINPROGRESS
)

504 
î∫o
 = 0;

507 
	`SASSERTX
(
î∫o
 != 0);

508 
Áûed
 = 1;

512 i‡(
Áûed
) {

513 #i‡
HAVE_GSSAPI


514 i‡(
∑ckë
->
ªq
.
auth
->
mëhod
 =
AUTHMETHOD_GSSAPI


515 && 
∑ckë
->
ªq
.
auth
->
md©a
.
gsßpi
.
°©e
.
id
 !
GSS_C_NO_CONTEXT
) {

516 
OM_uöt32
 
maj‹_°©us
, 
mö‹_°©us
;

517 
buf
[512];

519 i‡((
maj‹_°©us


520 
	`gss_dñëe_£c_c⁄ãxt
(&
mö‹_°©us
,

521 &
∑ckë
->
ªq
.
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

522 
GSS_C_NO_BUFFER
)Ë!
GSS_S_COMPLETE
) {

523 i‡(!
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, (buf)))

524 *
buf
 = 
NUL
;

526 
	`sw¨nx
("%s: gss_delete_sec_context() failed%s%s",

527 
fun˘i⁄
,

528 *
buf
 =
NUL
 ? "" : ": ",

529 *
buf
 =
NUL
 ? "" : buf);

539 
	}
}

541 #i‡
SOCKS_CLIENT


543 
	$upd©e_a·î_√gŸüã
(
∑ckë
, 
socksfd
)

544 c⁄° 
socks_t
 *
∑ckë
;

545 
socksfd_t
 *
socksfd
;

548 
socksfd
->
°©e
.
auth
 = *
∑ckë
->
ªq
.auth;

549 
socksfd
->
°©e
.
comm™d
 = 
∑ckë
->
ªq
.command;

550 
socksfd
->
°©e
.
vîsi⁄
 = 
∑ckë
->
ªq
.version;

551 
	}
}

556 
	$ªcv_socksho°
(
s
, 
ho°
, 
vîsi⁄
, 
auth
, 
emsg
, 
emsgÀn
)

557 
s
;

558 
socksho°_t
 *
ho°
;

559 
vîsi⁄
;

560 
authmëhod_t
 *
auth
;

561 *
emsg
;

562 c⁄° 
size_t
 
emsgÀn
;

564 c⁄° *
fun˘i⁄
 = "recv_sockshost()";

565 
ssize_t
 
rc
;

567 
vîsi⁄
) {

568 
PROXY_SOCKS_V4
:

569 
PROXY_SOCKS_V4REPLY_VERSION
: {

574 
ho°mem
[ (
ho°
->
p‹t
)

575 + (
ho°
->
addr
.
ùv4
)

577 *
p
 = 
ho°mem
;

579 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

580 
ho°mem
,

581 (
ho°mem
),

582 (
ho°mem
),

584 
NULL
,

585 
NULL
,

586 
NULL
,

587 
auth
)Ë!(
ssize_t
)(
ho°mem
)) {

588 
	`fmåe•⁄£îr‹
(
rc
, (
ho°mem
), 
emsg
, 
emsgÀn
);

592 
ho°
->
©y≥
 = 
SOCKS_ADDR_IPV4
;

595 
	`mem˝y
(&
ho°
->
p‹t
, 
p
, (host->port));

596 
p
 +(
ho°
->
p‹t
);

599 
	`mem˝y
(&
ho°
->
addr
.
ùv4
, 
p
, (host->addr.ipv4));

600 
p
 +(
ho°
->
addr
.
ùv4
);

605 
PROXY_SOCKS_V5
:

615 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

616 &
ho°
->
©y≥
, (host->atype),

617 (
ho°
->
©y≥
),

619 
NULL
,

620 
NULL
,

621 
NULL
,

622 
auth
)Ë!(
ssize_t
)(
ho°
->
©y≥
)) {

623 
	`fmåe•⁄£îr‹
(
rc
, (
ho°
->
©y≥
), 
emsg
, 
emsgÀn
);

627 
ho°
->
©y≥
) {

628 
SOCKS_ADDR_IPV4
:

629 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

630 &
ho°
->
addr
.
ùv4
,

631 (
ho°
->
addr
.
ùv4
),

632 (
ho°
->
addr
.
ùv4
),

634 
NULL
,

635 
NULL
,

636 
NULL
,

637 
auth
))

638 !(
ssize_t
)(
ho°
->
addr
.
ùv4
)) {

639 
	`fmåe•⁄£îr‹
(
rc
, (
ho°
->
addr
.
ùv4
), 
emsg
, 
emsgÀn
);

644 
SOCKS_ADDR_IPV6
:

645 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

646 &
ho°
->
addr
.
ùv6
.
ù
,

647 (
ho°
->
addr
.
ùv6
.
ù
),

648 (
ho°
->
addr
.
ùv6
.
ù
),

650 
NULL
,

651 
NULL
,

652 
NULL
,

653 
auth
))

654 !(
ssize_t
)(
ho°
->
addr
.
ùv6
.
ù
)) {

655 
	`fmåe•⁄£îr‹
(
rc
,

656 (
ho°
->
addr
.
ùv6
.
ù
),

657 
emsg
,

658 
emsgÀn
);

664 
SOCKS_ADDR_DOMAIN
: {

665 
Æí
;

668 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

669 &
Æí
,

670 (
Æí
),

671 (
Æí
),

673 
NULL
,

674 
NULL
,

675 
NULL
,

676 
auth
)Ë!(
ssize_t
)(
Æí
)) {

677 
	`fmåe•⁄£îr‹
(
rc
, (
Æí
), 
emsg
, 
emsgÀn
);

681 
	`OCTETIFY
(
Æí
);

683 #i‡
MAXHOSTNAMELEN
 < 0xff

684 
	`SASSERTX
(
Æí
 < (
ho°
->
addr
.
domaö
));

688 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

689 
ho°
->
addr
.
domaö
,

690 (
size_t
)
Æí
,

691 (
size_t
)
Æí
,

693 
NULL
,

694 
NULL
,

695 
NULL
,

696 
auth
)Ë!(
ssize_t
)
Æí
) {

697 
	`fmåe•⁄£îr‹
(
rc
, 
Æí
, 
emsg
, 
emsgÀn
);

700 
ho°
->
addr
.
domaö
[
Æí
] = 
NUL
;

706 
	`sw¨nx
("%s: unsupportedáddress format %d inÑeply",

707 
fun˘i⁄
, 
ho°
->
©y≥
);

712 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

713 &
ho°
->
p‹t
,

714 (
ho°
->
p‹t
),

715 (
ho°
->
p‹t
),

717 
NULL
,

718 
NULL
,

719 
NULL
,

720 
auth
)Ë!(
ssize_t
)(
ho°
->
p‹t
)) {

721 
	`fmåe•⁄£îr‹
(
rc
, (
ho°
->
p‹t
), 
emsg
, 
emsgÀn
);

729 
	}
}

732 
	$£rvîª∂yisok
(
vîsi⁄
, 
comm™d
, 
ª∂y
, 
rouã
, 
emsg
, 
emsgÀn
)

733 c⁄° 
vîsi⁄
;

734 c⁄° 
comm™d
;

735 c⁄° 
ª∂y
;

736 
rouã_t
 *
rouã
;

737 *
emsg
;

738 c⁄° 
size_t
 
emsgÀn
;

740 c⁄° *
fun˘i⁄
 = "serverreplyisok()";

742 
	`¶og
(
LOG_NEGOTIATE
, "%s: version %d, command %d,Ñeply %d",

743 
fun˘i⁄
, 
vîsi⁄
, 
comm™d
, 
ª∂y
);

745 
vîsi⁄
) {

746 
PROXY_SOCKS_V4REPLY_VERSION
:

747 
ª∂y
) {

748 
SOCKSV4_SUCCESS
:

749 
	`socks_˛órbœckli°
(
rouã
);

752 
SOCKSV4_FAIL
:

753 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "genericÖroxy server failure");

755 
	`socks_˛órbœckli°
(
rouã
);

756 
î∫o
 = 
ECONNREFUSED
;

759 
SOCKSV4_NO_IDENTD
:

760 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

765 
	`socks_bœckli°
(
rouã
, 
emsg
);

767 
î∫o
 = 
ECONNREFUSED
;

770 
SOCKSV4_BAD_ID
:

771 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

774 
	`socks_bœckli°
(
rouã
, 
emsg
);

775 
î∫o
 = 
ECONNREFUSED
;

779 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

781 
vîsi⁄
, 
ª∂y
);

783 
	`socks_bœckli°
(
rouã
, 
emsg
);

784 
î∫o
 = 
ECONNREFUSED
;

789 
PROXY_SOCKS_V5
:

790 
ª∂y
) {

791 
SOCKS_SUCCESS
:

792 
	`socks_˛órbœckli°
(
rouã
);

795 
SOCKS_FAILURE
:

796 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

799 i‡(
comm™d
 =
SOCKS_BIND
) {

800 
î∫o
 = 
EADDRINUSE
;

801 
	`socks_˛órbœckli°
(
rouã
);

804 
	`socks_bœckli°
(
rouã
, 
emsg
);

806 
î∫o
 = 
ECONNREFUSED
;

809 
SOCKS_NOTALLOWED
:

810 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "connection denied byÖroxy server");

812 
	`socks_˛órbœckli°
(
rouã
);

813 
î∫o
 = 
ECONNREFUSED
;

816 
SOCKS_NETUNREACH
:

817 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "net unreachable byÖroxy server");

819 
	`socks_˛órbœckli°
(
rouã
);

820 
î∫o
 = 
ENETUNREACH
;

823 
SOCKS_HOSTUNREACH
:

824 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "target unreachable byÖroxy server");

826 
	`socks_˛órbœckli°
(
rouã
);

827 
î∫o
 = 
EHOSTUNREACH
;

830 
SOCKS_CONNREFUSED
:

831 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

834 
	`socks_˛órbœckli°
(
rouã
);

835 
î∫o
 = 
ECONNREFUSED
;

838 
SOCKS_TTLEXPIRED
:

839 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

842 
	`socks_˛órbœckli°
(
rouã
);

843 
î∫o
 = 
ETIMEDOUT
;

846 
SOCKS_CMD_UNSUPP
:

847 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "commandÇot supported byÖroxy server");

849 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

851 
	`socks_bœckli°
(
rouã
, 
emsg
);

852 
î∫o
 = 
ECONNREFUSED
;

855 
SOCKS_ADDR_UNSUPP
:

856 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

860 
	`socks_bœckli°
(
rouã
, 
emsg
);

861 
î∫o
 = 
ECONNREFUSED
;

865 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

867 
vîsi⁄
, 
ª∂y
);

869 
	`socks_bœckli°
(
rouã
, 
emsg
);

870 
î∫o
 = 
ECONNREFUSED
;

875 
PROXY_HTTP_10
:

876 
PROXY_HTTP_11
:

877 
ª∂y
) {

878 
HTTP_SUCCESS
:

879 
	`socks_˛órbœckli°
(
rouã
);

883 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "unknownÖroxy server failure");

885 
	`socks_bœckli°
(
rouã
, 
emsg
);

886 
î∫o
 = 
ECONNREFUSED
;

891 
PROXY_UPNP
:

892 
ª∂y
) {

893 
UPNP_SUCCESS
:

894 
	`socks_˛órbœckli°
(
rouã
);

898 
	`socks_bœckli°
(
rouã
, "UPNP failure");

899 
î∫o
 = 
ECONNREFUSED
;

906 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "unknow¿¥oxy vîsi⁄ %d", 
vîsi⁄
);

910 
	`SASSERTX
(*
emsg
 !
NUL
);

912 
	`¶og
(
LOG_DEBUG
, "%s", 
emsg
);

915 
	}
}

919 
	$˛õ¡mëhod_u«me
(
s
, 
ho°
, 
vîsi⁄
, 
«me
, 
∑ssw‹d
, 
emsg
, 
emsgÀn
)

920 
s
;

921 c⁄° 
socksho°_t
 *
ho°
;

922 
vîsi⁄
;

923 *
«me
;

924 *
∑ssw‹d
;

925 *
emsg
;

926 c⁄° 
size_t
 
emsgÀn
;

928 c⁄° *
fun˘i⁄
 = "clientmethod_uname()";

929 
authmëhod_u«me_t
 
u«me
;

930 
socksho°_t
 
u«meho°
;

931 
u£ˇchedöfo
;

932 
ssize_t
 
rc
;

933 
size_t
 
Àn
;

934 *
off£t
;

935 
ªque°
[ 1

937 + 
MAXNAMELEN


939 + 
MAXPWLEN


941 
ª•⁄£
[ 1

945 
vîsi⁄
) {

946 
PROXY_SOCKS_V5
:

950 
	`SERRX
(
vîsi⁄
);

953 i‡(
	`memcmp
(&
u«meho°
, 
ho°
, (unamehost)) != 0)

954 
u£ˇchedöfo
 = 0;

958 
off£t
 = 
ªque°
;

959 *
off£t
 = ()
SOCKS_UNAMEVERSION
;

960 ++
off£t
;

962 i‡(!
u£ˇchedöfo
) {

963 i‡(
«me
 =
NULL


964 && (
«me
 = (*)
	`socks_gëu£∫ame
(
ho°
,

965 (*)
off£t
 + 1,

966 
MAXNAMELEN
)Ë=
NULL
) {

967 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot determine username of client");

971 i‡(
	`°æí
((*)
«me
Ë> (
u«me
.name) - 1) {

972 
visbuf
[
MAXNAMELEN
];

974 
	`sw¨nx
("%s: username \"%s ...\" isÅooÜong. MaxÜength is %lu. "

976 
fun˘i⁄
,

977 
	`°r2vis
((*)
«me
,

978 
	`°æí
((*)
«me
),

979 
visbuf
,

980 (
visbuf
)),

981 ()((
u«me
.
«me
) - 1));

984 
«me
[(
u«me
.«meË- 1] = 
NUL
;

987 
	`SASSERTX
(
	`°æí
((*)
«me
Ë< (
u«me
.name));

988 
	`°r˝y
((*)
u«me
.
«me
, (*)name);

991 
	`¶og
(
LOG_DEBUG
, "%s: usecachedinfo %d,Çame \"%s\"",

992 
fun˘i⁄
, 
u£ˇchedöfo
, 
u«me
.
«me
);

995 *
off£t
 = ()
	`°æí
((*)
u«me
.
«me
);

996 
	`OCTETIFY
(*
off£t
);

997 
	`°r˝y
((*)
off£t
 + 1, (*)
u«me
.
«me
);

998 
off£t
 += *offset + 1;

1000 i‡(!
u£ˇchedöfo
) {

1001 i‡(
∑ssw‹d
 =
NULL


1002 && (
∑ssw‹d
 = (*)
	`socks_gë∑ssw‹d
(
ho°
,

1003 (*)
«me
,

1004 (*)
off£t
 + 1,

1005 
MAXPWLEN
)Ë=
NULL
) {

1006 
	`¶og
(
LOG_NEGOTIATE
,

1008 
fun˘i⁄
);

1010 
∑ssw‹d
 = (*)"";

1013 i‡(
	`°æí
((*)
∑ssw‹d
Ë> (
u«me
.password) - 1) {

1014 
	`sw¨nx
("%s:Öassword isÅooÜong. MaxÜength is %lu. "

1016 
fun˘i⁄
, ()((
u«me
.
∑ssw‹d
) - 1));

1019 
∑ssw‹d
[(
u«me
.∑ssw‹dË- 1] = 
NUL
;

1022 
	`SASSERTX
(
	`°æí
((*)
∑ssw‹d
Ë< (
u«me
.password));

1023 
	`°r˝y
((*)
u«me
.
∑ssw‹d
, (*)password);

1027 *
off£t
 = ()
	`°æí
((*)
u«me
.
∑ssw‹d
);

1028 
	`OCTETIFY
(*
off£t
);

1029 
	`°r˝y
((*)
off£t
 + 1, (*)
u«me
.
∑ssw‹d
);

1030 
off£t
 += *offset + 1;

1032 
	`¶og
(
LOG_NEGOTIATE
, "%s: offering username \"%s\",Öassword %sÅo server",

1033 
fun˘i⁄
, 
u«me
.
«me
, (*u«me.
∑ssw‹d
 =
NUL
) ? "\"\"" : "********");

1035 
Àn
 = 
off£t
 - 
ªque°
;

1036 i‡((
rc
 = 
	`socks_£ndt⁄
(
s
,

1037 
ªque°
,

1038 
Àn
,

1039 
Àn
,

1041 
NULL
,

1043 
NULL
,

1044 
NULL
)Ë!(
ssize_t
)
Àn
) {

1045 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1048 ()
rc
, ()(
off£t
 - 
ªque°
), 
	`°ªº‹
(
î∫o
));

1052 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

1053 
ª•⁄£
,

1054 (
ª•⁄£
),

1055 (
ª•⁄£
),

1057 
NULL
,

1058 
NULL
,

1059 
NULL
,

1060 
NULL
)Ë!(
ª•⁄£
)) {

1061 
	`¢¥öt‚
(
emsg
, 
emsgÀn
,

1063 ()
rc
, ()(
ª•⁄£
), 
	`°ªº‹
(
î∫o
));

1067 
	`¶og
(
LOG_NEGOTIATE
, "%s:Ñeceived serverÑesponse: 0x%x, 0x%x",

1068 
fun˘i⁄
, 
ª•⁄£
[0],Ñesponse[1]);

1070 i‡(
ªque°
[
UNAME_VERSION
] !
ª•⁄£
[UNAME_VERSION]) {

1071 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1074 
ªque°
[0], 
ª•⁄£
[1]);

1078 i‡(
ª•⁄£
[
UNAME_STATUS
] =
UNAME_STATUS_ISOK
) {

1079 
u«meho°
 = *
ho°
;

1080 
u£ˇchedöfo
 = 1;

1085 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "proxy serverÑejected our username/password");

1088 
	}
}

1090 #i‡
HAVE_GSSAPI


1097 
	$˛õ¡mëhod_gsßpi
(
s
, 
¥Ÿocﬁ
, 
gw
, 
vîsi⁄
, 
auth
, 
emsg
, 
emsgÀn
)

1098 
s
;

1099 
¥Ÿocﬁ
;

1100 c⁄° 
g©eway_t
 *
gw
;

1101 
vîsi⁄
;

1102 
authmëhod_t
 *
auth
;

1103 *
emsg
;

1104 c⁄° 
size_t
 
emsgÀn
;

1106 c⁄° *
fun˘i⁄
 = "clientmethod_gssapi()";

1107 
OM_uöt32
 
ªt_Êags
, 
maj‹_°©us
, 
mö‹_°©us
;

1108 
gss_«me_t
 
˛õ¡_«me
 = 
GSS_C_NO_NAME
,

1109 
£rvî_«me
 = 
GSS_C_NO_NAME
;

1110 
gss_¸ed_id_t
 
£rvî_¸eds
 = 
GSS_C_NO_CREDENTIAL
;

1111 
gss_buf„r_desc
 
£rvi˚
 = 
GSS_C_EMPTY_BUFFER
,

1112 
öput_tokí
 = 
GSS_C_EMPTY_BUFFER
,

1113 
ouçut_tokí
 = 
GSS_C_EMPTY_BUFFER
,

1114 *
c⁄ãxt_tokí
 = 
GSS_C_NO_BUFFER
;

1115 #i‡
SOCKS_CLIENT


1116 
sig£t_t
 
ﬁd£t
;

1118 
ssize_t
 
rc
;

1119 
size_t
 
Àn
;

1120 
tokí_Àngth
;

1121 
ªque°
[
GSSAPI_HLEN
 + 
MAXGSSAPITOKENLEN
],

1122 
ª•⁄£
[
GSSAPI_HLEN
 + 
MAXGSSAPITOKENLEN
],

1123 
gss_£rvî_íc
, 
gss_íc
;

1124 
«meöfo
[
MAXNAMELEN
 + MAXNAMELEN], 
buf
[“ameöfo)], 
tmpbuf
[512];

1125 
c⁄f_°©e
;

1127 #i‡
SOCKSLIBRARY_DYNAMIC
 && 
SOCKS_CLIENT


1149 
	`socks_m¨k_io_as_«tive
();

1159 
	`SASSERTX
(
gw
 !
NULL
);

1160 
gw
->
addr
.
©y≥
) {

1161 
SOCKS_ADDR_IPV4
: {

1162 
sockaddr_°‹age
 
addr
;

1164 
	`socksho°2sockaddr
(&
gw
->
addr
, &addr);

1166 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

1167 
rc
 = 
	`gë«meöfo
(
	`TOSA
(&
addr
),

1168 
	`ßÀn
(
addr
.
ss_Ámûy
),

1169 
«meöfo
,

1170 (
«meöfo
),

1171 
NULL
,

1173 
NI_NAMEREQD
);

1174 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

1176 i‡(
rc
 != 0) {

1177 
¡›
[
MAXSOCKADDRSTRING
];

1179 i‡(
	`öë_¡›
(
addr
.
ss_Ámûy
,

1180 
	`GET_SOCKADDRADDR
(&
addr
),

1181 
¡›
,

1182 (
¡›
)Ë=
NULL
) {

1183 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "inet_ntop(3) failed onáddr %s: %s",

1184 
	`sockaddr2°rög2
(&
addr
, 0, 
NULL
, 0), 
	`°ªº‹
(
î∫o
));

1187 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "getnameinfo(%s) failed:Érror %ld",

1188 
¡›
, ()
rc
);

1190 
	`sw¨nx
("%s: %s", 
emsg
, 
fun˘i⁄
);

1191 
îr‹
;

1196 
SOCKS_ADDR_DOMAIN
:

1197 
	`STRCPY_ASSERTSIZE
(
«meöfo
, 
gw
->
addr
.addr.
domaö
);

1201 
	`SERRX
(
gw
->
addr
.
©y≥
);

1204 
	`¢¥ötf
(
buf
, (buf), "%s@%s", 
gw
->
°©e
.
gsßpi£rvi˚«me
, 
«meöfo
);

1205 
£rvi˚
.
vÆue
 = 
buf
;

1206 
£rvi˚
.
Àngth
 = 
	`°æí
((*)£rvi˚.
vÆue
);

1208 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

1209 
maj‹_°©us
 = 
	`gss_imp‹t_«me
(&
mö‹_°©us
,

1210 &
£rvi˚
,

1211 
gss_¡_£rvi˚_«me
,

1212 &
£rvî_«me
);

1213 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

1215 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
tmpbuf
, (tmpbuf))) {

1216 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "gss_import_name() failed: %s",Émsg);

1218 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

1219 
îr‹
;

1222 
ªque°
[
GSSAPI_VERSION
] = 
SOCKS_GSSAPI_VERSION
;

1223 
auth
->
md©a
.
gsßpi
.
°©e
.
id
 = 
GSS_C_NO_CONTEXT
;

1226 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

1227 
maj‹_°©us
 = 
	`gss_öô_£c_c⁄ãxt
(&
mö‹_°©us
,

1228 
GSS_C_NO_CREDENTIAL
,

1229 &
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

1230 
£rvî_«me
,

1231 
GSS_C_NULL_OID
,

1232 
GSS_C_MUTUAL_FLAG


1233 | 
GSS_C_REPLAY_FLAG


1234 | (
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

1235 
GSS_C_SEQUENCE_FLAG
 : 0),

1248 
GSS_C_NO_CHANNEL_BINDINGS
,

1249 
c⁄ãxt_tokí
,

1250 
NULL
,

1251 &
ouçut_tokí
,

1252 &
ªt_Êags
,

1253 
NULL
);

1254 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

1256 
	`¶og
(
LOG_DEBUG
, "%s:Üength of output_token is %lu",

1257 
fun˘i⁄
, ()
ouçut_tokí
.
Àngth
);

1259 
maj‹_°©us
) {

1260 
GSS_S_COMPLETE
:

1261 
	`¶og
(
LOG_NEGOTIATE
, "%s: gsßpò√gŸüti⁄ com∂ëed", 
fun˘i⁄
);

1264 
GSS_S_CONTINUE_NEEDED
:

1265 
	`¶og
(
LOG_DEBUG
, "%s: gsßpò√gŸüti⁄Åÿbêc⁄töued", 
fun˘i⁄
);

1269 i‡(!
	`gss_îr_is£t
(
maj‹_°©us
,

1270 
mö‹_°©us
,

1271 
tmpbuf
,

1272 (
tmpbuf
)))

1273 
	`¢¥ötf
(
tmpbuf
, (tmpbuf), "unknown gss major_status %d",

1274 
maj‹_°©us
);

1276 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1277 "gss_öô_£c_c⁄ãxt(ËÁûed: %s", 
tmpbuf
);

1278 
îr‹
;

1281 if(
ouçut_tokí
.
Àngth
 != 0) {

1282 
ªque°
[
GSSAPI_STATUS
] = 
SOCKS_GSSAPI_AUTHENTICATION
;

1284 
tokí_Àngth
 = 
	`ht⁄s
(()
ouçut_tokí
.
Àngth
);

1285 
	`mem˝y
(
ªque°
 + 
GSSAPI_TOKEN_LENGTH
, &
tokí_Àngth
, ());

1287 
	`SASSERTX
(
ouçut_tokí
.
Àngth
 <(
ªque°
Ë- 
GSSAPI_HLEN
);

1288 
	`mem˝y
(
ªque°
 + 
GSSAPI_HLEN
, 
ouçut_tokí
.
vÆue
, ouçut_tokí.
Àngth
);

1290 
	`¶og
(
LOG_DEBUG
, "%s: sendingÅoken ofÜength %luÅo server",

1291 
fun˘i⁄
, ()
ouçut_tokí
.
Àngth
);

1293 
Àn
 = (
size_t
)(
GSSAPI_HLEN
 + 
ouçut_tokí
.
Àngth
);

1294 i‡((
rc
 = 
	`socks_£ndt⁄
(
s
,

1295 
ªque°
,

1296 
Àn
,

1297 
Àn
,

1299 
NULL
,

1301 
NULL
,

1302 
NULL
)Ë!(
ssize_t
)
Àn
) {

1303 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1305 ()
rc
,

1306 ()(
GSSAPI_HLEN
 + 
ouçut_tokí
.
Àngth
),

1307 
	`°ªº‹
(
î∫o
));

1308 
îr‹
;

1311 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

1314 i‡(
maj‹_°©us
 =
GSS_S_COMPLETE
)

1317 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

1318 
ª•⁄£
,

1319 
GSSAPI_HLEN
,

1320 
GSSAPI_HLEN
,

1322 
NULL
,

1323 
NULL
,

1324 
NULL
,

1325 
NULL
)Ë!
GSSAPI_HLEN
) {

1326 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1328 ()
rc
, ()
GSSAPI_HLEN
, 
	`°ªº‹
(
î∫o
));

1329 
îr‹
;

1332 
	`¶og
(
LOG_DEBUG
, "%s:Ñead %ld bytes ofÑesponse data from server",

1333 
fun˘i⁄
, ()
rc
);

1335 if(
ª•⁄£
[
GSSAPI_VERSION
] !
SOCKS_GSSAPI_VERSION
) {

1336 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1339 
ª•⁄£
[
GSSAPI_VERSION
],Ñe•⁄£[
GSSAPI_STATUS
]);

1340 
îr‹
;

1343 i‡(
ª•⁄£
[
GSSAPI_STATUS
] == 0xff) {

1344 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "user wasÑejected byÖroxy server (%d, %d).",

1345 
ª•⁄£
[
GSSAPI_VERSION
],Ñe•⁄£[
GSSAPI_STATUS
]);

1346 
îr‹
;

1349 if(
ª•⁄£
[
GSSAPI_STATUS
] !
SOCKS_GSSAPI_AUTHENTICATION
) {

1350 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1353 
ª•⁄£
[
GSSAPI_VERSION
],Ñe•⁄£[
GSSAPI_STATUS
]);

1354 
îr‹
;

1357 
	`mem˝y
(&
tokí_Àngth
, &
ª•⁄£
[
GSSAPI_TOKEN_LENGTH
], ());

1358 
tokí_Àngth
 = 
	`¡ohs
(token_length);

1360 
öput_tokí
.
vÆue
 = 
ª•⁄£
 + 
GSSAPI_HLEN
;

1361 i‡((
öput_tokí
.
Àngth
 = 
tokí_Àngth
Ë> (
ª•⁄£
Ë- 
GSSAPI_HLEN
){

1362 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1364 
tokí_Àngth
, ()(
ª•⁄£
Ë- 
GSSAPI_HLEN
);

1365 
îr‹
;

1368 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

1369 
öput_tokí
.
vÆue
,

1370 
öput_tokí
.
Àngth
,

1371 
öput_tokí
.
Àngth
,

1373 
NULL
,

1374 
NULL
,

1375 
NULL
,

1376 
NULL
)Ë!(
ssize_t
)
öput_tokí
.
Àngth
) {

1377 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1379 ()
rc
, ()
öput_tokí
.
Àngth
, 
	`°ªº‹
(
î∫o
));

1381 
îr‹
;

1384 
	`¶og
(
LOG_DEBUG
, "%s:Ñead %lu byteÅoken from server",

1385 
fun˘i⁄
, ()
öput_tokí
.
Àngth
);

1387 
c⁄ãxt_tokí
 = &
öput_tokí
;

1390 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

1391 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

1393 
ªque°
[
GSSAPI_STATUS
] = 
SOCKS_GSSAPI_ENCRYPTION
;

1401 i‡(
gw
->
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
)

1402 
gss_íc
 = 
SOCKS_GSSAPI_CONFIDENTIALITY
;

1403 i‡(
gw
->
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
)

1404 
gss_íc
 = 
SOCKS_GSSAPI_INTEGRITY
;

1405 i‡(
gw
->
°©e
.
gsßpõn¸y±i⁄
.
˛ór
)

1406 
gss_íc
 = 
SOCKS_GSSAPI_CLEAR
;

1408 
	`sw¨nx
("%s:Çÿgsßpòty≥Åÿof„∏£t", 
fun˘i⁄
);

1409 
	`SERRX
(0);

1412 
	`¶og
(
LOG_NEGOTIATE
,

1415 
fun˘i⁄
,

1416 
gw
->
°©e
.
gsßpõn¸y±i⁄
.
√c
 ? "nec" : "rfc1961",

1417 
gw
->
°©e
.
gsßpõn¸y±i⁄
.
√c
 ? "non-standard" : "standard",

1418 
	`gsßpùrŸe˘i⁄2°rög
(
gss_íc
), gss_enc);

1420 i‡(
gw
->
°©e
.
gsßpõn¸y±i⁄
.
√c
) {

1421 c⁄° 
size_t
 
to£nd
 = 
GSSAPI_HLEN
 + 1, 
t‹ód
 =Åosend;

1423 
tokí_Àngth
 = 
	`ht⁄s
(1);

1424 
	`mem˝y
(&
ªque°
[
GSSAPI_TOKEN_LENGTH
], &
tokí_Àngth
, ());

1425 
	`mem˝y
(
ªque°
 + 
GSSAPI_HLEN
, &
gss_íc
, 1);

1427 i‡((
rc
 = 
	`socks_£ndt⁄
(
s
,

1428 
ªque°
,

1429 
to£nd
,

1430 
to£nd
,

1432 
NULL
,

1434 
NULL
,

1435 
NULL
)Ë!(
ssize_t
)
to£nd
) {

1436 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1438 ()
rc
, ()
to£nd
, 
	`°ªº‹
(
î∫o
));

1439 
îr‹
;

1442 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

1443 
ª•⁄£
,

1444 
t‹ód
,

1445 
t‹ód
,

1447 
NULL
,

1448 
NULL
,

1449 
NULL
,

1450 
NULL
)Ë!(
ssize_t
)
t‹ód
) {

1451 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1453 ()
rc
, ()(
GSSAPI_HLEN
 + 1), 
	`°ªº‹
(
î∫o
));

1454 
îr‹
;

1457 i‡(
ª•⁄£
[
GSSAPI_STATUS
] !
SOCKS_GSSAPI_ENCRYPTION
) {

1458 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1461 
ª•⁄£
[
GSSAPI_VERSION
],Ñe•⁄£[
GSSAPI_STATUS
]);

1462 
îr‹
;

1465 
	`mem˝y
(&
tokí_Àngth
, &
ª•⁄£
[
GSSAPI_TOKEN_LENGTH
], ());

1466 
tokí_Àngth
 = 
	`¡ohs
(token_length);

1468 i‡(
tokí_Àngth
 != 1) {

1469 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1472 
tokí_Àngth
);

1473 
îr‹
;

1476 
gss_£rvî_íc
 = 
ª•⁄£
[
GSSAPI_TOKEN
];

1479 
p
;

1481 
öput_tokí
.
vÆue
 = &
p
;

1482 
öput_tokí
.
Àngth
 = 1;

1484 
	`mem˝y
(
öput_tokí
.
vÆue
, &
gss_íc
, i≈ut_tokí.
Àngth
);

1486 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

1487 
maj‹_°©us
 = 
	`gss_wøp
(&
mö‹_°©us
,

1488 
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

1490 
GSS_C_QOP_DEFAULT
,

1491 &
öput_tokí
,

1492 &
c⁄f_°©e
,

1493 &
ouçut_tokí
);

1494 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

1496 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
tmpbuf
, (tmpbuf))) {

1497 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "gss_wøp(ËÁûed: %s", 
tmpbuf
);

1498 
îr‹
;

1501 
tokí_Àngth
 = 
	`ht⁄s
(()
ouçut_tokí
.
Àngth
);

1502 
	`mem˝y
(&
ªque°
[
GSSAPI_TOKEN_LENGTH
], &
tokí_Àngth
, ());

1504 i‡((
rc
 = 
	`socks_£ndt⁄
(
s
,

1505 
ªque°
,

1506 
GSSAPI_TOKEN
,

1507 
GSSAPI_TOKEN
,

1509 
NULL
,

1511 
NULL
,

1512 
NULL
)Ë!
GSSAPI_TOKEN
) {

1513 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1515 ()
rc
, ()
GSSAPI_TOKEN
, 
	`°ªº‹
(
î∫o
));

1516 
îr‹
;

1519 i‡((
rc
 = 
	`socks_£ndt⁄
(
s
,

1520 
ouçut_tokí
.
vÆue
,

1521 
ouçut_tokí
.
Àngth
,

1522 
ouçut_tokí
.
Àngth
,

1524 
NULL
,

1526 
NULL
,

1527 
NULL
)Ë!(
ssize_t
)
ouçut_tokí
.
Àngth
) {

1528 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1530 ()
rc
, ()
ouçut_tokí
.
Àngth
, 
	`°ªº‹
(
î∫o
));

1531 
îr‹
;

1534 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

1536 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

1537 
ª•⁄£
,

1538 
GSSAPI_HLEN
,

1539 
GSSAPI_HLEN
,

1541 
NULL
,

1542 
NULL
,

1543 
NULL
,

1544 
NULL
)Ë!
GSSAPI_HLEN
) {

1545 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1547 ()
rc
, 
GSSAPI_HLEN
, 
	`°ªº‹
(
î∫o
));

1548 
îr‹
;

1551 i‡(
ª•⁄£
[
GSSAPI_STATUS
] !
SOCKS_GSSAPI_ENCRYPTION
) {

1552 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1555 
ª•⁄£
[
GSSAPI_VERSION
],Ñe•⁄£[
GSSAPI_STATUS
]);

1556 
îr‹
;

1559 
	`mem˝y
(&
tokí_Àngth
, 
ª•⁄£
 + 
GSSAPI_TOKEN_LENGTH
, ());

1560 
öput_tokí
.
Àngth
 = 
	`¡ohs
(
tokí_Àngth
);

1562 i‡(
öput_tokí
.
Àngth
 > (
ª•⁄£
Ë- 
GSSAPI_HLEN
) {

1563 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1566 ()
tokí_Àngth
,

1567 ()(
ª•⁄£
Ë- 
GSSAPI_HLEN
);

1568 
îr‹
;

1571 
öput_tokí
.
vÆue
 = 
ª•⁄£
 + 
GSSAPI_HLEN
;

1573 i‡((
rc
 = 
	`socks_ªcv‰omn
(
s
,

1574 
öput_tokí
.
vÆue
,

1575 
öput_tokí
.
Àngth
,

1576 
öput_tokí
.
Àngth
,

1578 
NULL
,

1579 
NULL
,

1580 
NULL
,

1581 
NULL
)Ë!(
ssize_t
)
öput_tokí
.
Àngth
) {

1582 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1584 ()
rc
, ()
öput_tokí
.
Àngth
, 
	`°ªº‹
(
î∫o
));

1585 
îr‹
;

1588 
maj‹_°©us
 = 
	`gss_unwøp
(&
mö‹_°©us
,

1589 
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

1590 &
öput_tokí
,

1591 &
ouçut_tokí
,

1593 
GSS_C_QOP_DEFAULT
);

1595 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
tmpbuf
, (tmpbuf))) {

1596 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1598 
tmpbuf
);

1599 
îr‹
;

1602 i‡(
ouçut_tokí
.
Àngth
 != 1) {

1603 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1606 ()
ouçut_tokí
.
Àngth
);

1607 
îr‹
;

1610 
gss_£rvî_íc
 = *(*)
ouçut_tokí
.
vÆue
;

1612 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

1615 
gss_£rvî_íc
) {

1616 
SOCKS_GSSAPI_CLEAR
:

1617 i‡(
gw
->
°©e
.
gsßpõn¸y±i⁄
.
˛ór
)

1618 
gss_íc
 = 
SOCKS_GSSAPI_CLEAR
;

1621 
SOCKS_GSSAPI_INTEGRITY
:

1622 i‡(
gw
->
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
)

1623 
gss_íc
 = 
SOCKS_GSSAPI_INTEGRITY
;

1626 
SOCKS_GSSAPI_CONFIDENTIALITY
:

1627 i‡(
gw
->
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
)

1628 
gss_íc
 = 
SOCKS_GSSAPI_CONFIDENTIALITY
;

1632 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1638 
gw
->
°©e
.
gsßpõn¸y±i⁄
.
˛ór
 ? "yes" : "no",

1639 
gw
->
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
 ? "yes" : "no",

1640 
gw
->
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
 ? "yes" : "no",

1641 
gw
->
°©e
.
gsßpõn¸y±i⁄
.
≥rmesßge
 ? "yes" : "no",

1642 
	`gsßpùrŸe˘i⁄2°rög
(
gss_£rvî_íc
), gss_server_enc);

1643 
îr‹
;

1646 
	`¶og
(
LOG_NEGOTIATE
, "%s: using gssapi %sÖrotection (%d)",

1647 
fun˘i⁄
, 
	`gsßpùrŸe˘i⁄2°rög
(
gss_íc
), gss_enc);

1649 
auth
->
md©a
.
gsßpi
.
°©e
.
¥Ÿe˘i⁄
 = 
gss_íc
;

1650 i‡(
auth
->
md©a
.
gsßpi
.
°©e
.
¥Ÿe˘i⁄
 !
SOCKS_GSSAPI_CLEAR
)

1651 
auth
->
md©a
.
gsßpi
.
°©e
.
wøp
 = 1;

1653 
maj‹_°©us


1654 
	`gss_wøp_size_limô
(&
mö‹_°©us
,

1655 
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

1656 
auth
->
md©a
.
gsßpi
.
°©e
.
¥Ÿe˘i⁄


1657 =
GSSAPI_CONFIDENTIALITY
 ?

1658 
GSS_REQ_CONF
 : 
GSS_REQ_INT
,

1659 
GSS_C_QOP_DEFAULT
,

1660 
MAXGSSAPITOKENLEN
 - 
GSSAPI_HLEN
,

1661 &
auth
->
md©a
.
gsßpi
.
°©e
.
maxgssd©a
);

1663 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
tmpbuf
, (tmpbuf))) {

1664 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "gss_wøp_size_limô(ËÁûed: %s", 
tmpbuf
);

1665 
îr‹
;

1668 
	`¶og
(
LOG_DEBUG
, "%s: maxÜength of gssdata beforeÉncoding: %lu",

1669 
fun˘i⁄
, ()
auth
->
md©a
.
gsßpi
.
°©e
.
maxgssd©a
);

1671 i‡(()
auth
->
md©a
.
gsßpi
.
°©e
.
maxgssd©a
 == 0) {

1672 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1677 ()
auth
->
md©a
.
gsßpi
.
°©e
.
maxgssd©a
,

1678 ()
auth
->
md©a
.
gsßpi
.
°©e
.
maxgssd©a
);

1679 
îr‹
;

1683 #i‡
SOCKSLIBRARY_DYNAMIC
 && 
SOCKS_CLIENT


1684 
	`socks_m¨k_io_as_n‹mÆ
();

1689 
îr‹
:

1690 i‡(
auth
->
md©a
.
gsßpi
.
°©e
.
id
 !
GSS_C_NO_CONTEXT
) {

1691 i‡((
maj‹_°©us


1692 
	`gss_dñëe_£c_c⁄ãxt
(&
mö‹_°©us
,

1693 &
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

1694 
GSS_C_NO_BUFFER
)Ë!
GSS_S_COMPLETE
) {

1695 i‡(!
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
tmpbuf
, (tmpbuf)))

1696 *
tmpbuf
 = 
NUL
;

1698 
	`sw¨nx
("%s: gss_delete_sec_context() failed%s%s",

1699 
fun˘i⁄
,

1700 *
tmpbuf
 =
NUL
 ? "" : ": ",

1701 *
tmpbuf
 =
NUL
 ? "" :Åmpbuf);

1705 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

1706 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

1708 #i‡
SOCKSLIBRARY_DYNAMIC
 && 
SOCKS_CLIENT


1709 
	`socks_m¨k_io_as_n‹mÆ
();

1712 
	`¶og
(
LOG_NEGOTIATE
, "%s: faûed,Éº‹ is: %s", 
fun˘i⁄
, 
emsg
);

1714 
	}
}

	@lib/config.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$gíîicöô
()

53 c⁄° *
fun˘i⁄
 = "genericinit()";

54 #i‡
BAREFOOTD


55 
ruÀ_t
 *
ruÀ
;

57 #i‡!
SOCKS_CLIENT


58 
sig£t_t
 
£t
, 
o£t
;

61 #i‡
SOCKS_CLIENT


62 
	`SASSERTX
(
sockscf
.
loglock
 == -1);

64 i‡(
sockscf
.
loglock
 == -1) {

65 i‡((
sockscf
.
loglock
 = 
	`socks_mklock
(
SOCKS_LOCKFILE
, 
NULL
, 0)) == -1)

66 
	`£º
("%s: socks_mklock() failedÅo createÜockfile using base %s",

67 
fun˘i⁄
, 
SOCKS_LOCKFILE
);

71 i‡(!
sockscf
.
°©e
.
öôed
) {

72 #i‡!
HAVE_SETPROCTITLE


74 i‡((
__¥og«me
 = 
	`°rdup
(__¥og«me)Ë=
NULL
)

75 
	`£ºx
("%s: %s", 
fun˘i⁄
, 
NOMEM
);

79 #i‡!
SOCKS_CLIENT


80 
	`sigem±y£t
(&
£t
);

81 
	`sigadd£t
(&
£t
, 
SIGHUP
);

82 
	`sigadd£t
(&
£t
, 
SIGTERM
);

83 i‡(
	`sig¥ocmask
(
SIG_BLOCK
, &
£t
, &
o£t
) != 0)

84 
	`sw¨n
("%s: sig¥ocmask(SIG_BLOCK)", 
fun˘i⁄
);

87 
	`›ti⁄öô
();

89 i‡(
	`∑r£c⁄fig
(
sockscf
.
›ti⁄
.
c⁄figfûe
) != 0)

92 #i‡!
SOCKS_CLIENT


93 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
o£t
, 
NULL
) != 0)

94 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK)", 
fun˘i⁄
);

97 
	`po°c⁄figlﬂdöô
();

99 #i‡
BAREFOOTD


100 
ruÀ
 = 
sockscf
.
¸uÀ
;

101 
ruÀ
 !
NULL
) {

102 i‡(
ruÀ
->
°©e
.
¥Ÿocﬁ
.
udp
) {

103 
sockscf
.
°©e
.
Æludpboun˚d
 = 0;

107 
ruÀ
 =ÑuÀ->
√xt
;

111 #i‡
SOCKSLIBRARY_DYNAMIC


112 
	`symbﬁcheck
();

114 
	}
}

117 
	$po°c⁄figlﬂdöô
()

119 c⁄° *
fun˘i⁄
 = "postconfigloadinit()";

120 #i‡!
SOCKS_CLIENT


121 
˝u£âög_t
 
√w˝u
;

122 (*
¥ocfunc
)();

125 
	`¶og
(
LOG_DEBUG
, "%s: Iámá %s",

126 
fun˘i⁄
,

127 #i‡
SOCKS_CLIENT


130 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
)

134 #i‡!
HAVE_NO_RESOLVESTUFF


135 i‡(!(
_ªs
.
›ti⁄s
 & 
RES_INIT
)) {

136 
	`ªs_öô
();

138 #i‡!
SOCKS_CLIENT


139 
sockscf
.
öôül
.
ªs_›ti⁄s
 = 
_ªs
.
›ti⁄s
;

144 
sockscf
.
ªsﬁvïrŸocﬁ
) {

145 
RESOLVEPROTOCOL_TCP
:

146 #i‡
HAVE_NO_RESOLVESTUFF


147 
	`SERRX
(
sockscf
.
ªsﬁvïrŸocﬁ
);

150 
_ªs
.
›ti⁄s
 |
RES_USEVC
;

151 
	`¶og
(
LOG_DEBUG
,

152 "%s: c⁄figuªdÑesﬁvî f‹Ñesﬁvög ovîÅ˝", 
fun˘i⁄
);

157 
RESOLVEPROTOCOL_UDP
:

158 
RESOLVEPROTOCOL_FAKE
:

162 
	`SERRX
(
sockscf
.
ªsﬁvïrŸocﬁ
);

165 #i‡!
HAVE_NO_RESOLVESTUFF
 && 0

166 
_ªs
.
›ti⁄s
 |
RES_DEBUG
;

167 
	`¶og
(
LOG_DEBUG
, "%s: c⁄figuªdÑesﬁvî f‹ debuggög", 
fun˘i⁄
);

170 #i‡!
SOCKS_CLIENT


172 
sockscf
.
°©e
.
ty≥
) {

173 
PROC_MOTHER
:

174 
√w˝u
 = 
sockscf
.
˝u
.
mŸhî
;

175 
¥ocfunc
 = 
mŸhî_po°c⁄figlﬂd
;

178 
PROC_MONITOR
:

179 
√w˝u
 = 
sockscf
.
˝u
.
m⁄ô‹
;

180 
¥ocfunc
 = 
m⁄ô‹_po°c⁄figlﬂd
;

183 
PROC_NEGOTIATE
:

184 
√w˝u
 = 
sockscf
.
˝u
.
√gŸüã
;

185 
¥ocfunc
 = 
√gŸüã_po°c⁄figlﬂd
;

188 
PROC_REQUEST
:

189 
√w˝u
 = 
sockscf
.
˝u
.
ªque°
;

190 
¥ocfunc
 = 
ªque°_po°c⁄figlﬂd
;

193 
PROC_IO
:

194 
√w˝u
 = 
sockscf
.
˝u
.
io
;

195 
¥ocfunc
 = 
io_po°c⁄figlﬂd
;

199 
	`SERRX
(
sockscf
.
°©e
.
ty≥
);

202 #i‡
HAVE_SCHED_SETSCHEDULER


203 i‡(!
√w˝u
.
schedulög_is£t
) {

204 
√w˝u
.
pﬁicy
 = 
sockscf
.
öôül
.
˝u
.policy;

205 
√w˝u
.
∑øm
 = 
sockscf
.
öôül
.
˝u
.param;

206 
√w˝u
.
schedulög_is£t
 = 
sockscf
.
öôül
.
˝u
.scheduling_isset;

210 #i‡
HAVE_SCHED_SETAFFINITY


211 i‡(!
√w˝u
.
afföôy_is£t
) {

212 
√w˝u
.
mask
 = 
sockscf
.
öôül
.
˝u
.mask;

213 
√w˝u
.
afföôy_is£t
 = 
sockscf
.
öôül
.
˝u
.affinity_isset;

217 i‡(!
sockscf
.
›ti⁄
.
vîify⁄ly
)

218 
	`sockd_£t˝u£âögs
(&
sockscf
.
°©e
.
˝u
, &
√w˝u
);

220 #i‡
HAVE_SCHED_SETSCHEDULER


230 
sched_∑øm
 
∑øm
;

232 
	`SASSERTX
(
sockscf
.
°©e
.
˝u
.
pﬁicy
 =
	`sched_gëscheduÀr
(0));

233 
	`SASSERTX
(
	`sched_gë∑øm
(0, &
∑øm
) == 0);

234 
	`SASSERTX
(
sockscf
.
°©e
.
˝u
.
∑øm
.
sched_¥i‹ôy
 ==Öaram.sched_priority);

237 i‡(
¥ocfunc
 !
NULL
)

238 
	`¥ocfunc
();

240 
	}
}

243 
rouã_t
 *

244 
	$socks_addrouã
(
√wrouã
, 
œ°
)

245 c⁄° 
rouã_t
 *
√wrouã
;

246 c⁄° 
œ°
;

248 c⁄° *
fun˘i⁄
 = "socks_addroute()";

249 
£rvî°©e_t
 
nû°©e
;

250 
rouã_t
 *
rouã
, *
√xåouã
;

251 
size_t
 
i
, 
ifb
, 
is⁄eshŸ
;

253 i‡((
rouã
 = 
	`mÆloc
((*rouã))Ë=
NULL
)

254 
	`yyîr‹x
("couldÇotállocate %lu bytes forÑoute",

255 ()(*
√xåouã
));

257 *
rouã
 = *
√wrouã
;

258 
	`bzîo
(&
nû°©e
, (nilstate));

260 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p
) {

261 i‡(
rouã
->
gw
.
addr
.
©y≥
 =
SOCKS_ADDR_DOMAIN


262 && 
	`°rcmp
(
rouã
->
gw
.
addr
.addr.
domaö
, 
PROXY_BROADCASTs
) == 0)

265 i‡(
rouã
->
gw
.
addr
.
©y≥
 !
SOCKS_ADDR_IFNAME


266 && 
rouã
->
gw
.
addr
.
©y≥
 !
SOCKS_ADDR_URL
)

267 
	`yyîr‹x
("gateway for upnpÖroxy hasÅo beán interface or url. "

269 
	`©y≥2°rög
(
rouã
->
gw
.
addr
.
©y≥
),

270 
	`socksho°2°rög
(&
rouã
->
gw
.
addr
, 
NULL
, 0));

272 i‡(
rouã
->
gw
.
addr
.
p‹t
 =
	`ht⁄s
(0)) {

273 i‡(
rouã
->
gw
.
addr
.
©y≥
 !
SOCKS_ADDR_URL
) {

274 
	`¶og
(
LOG_DEBUG
, "%s: upnp gwÖortÇot set, using default (%d)",

275 
fun˘i⁄
, 
DEFAULT_SSDP_PORT
);

277 
rouã
->
gw
.
addr
.
p‹t
 = 
	`ht⁄s
(
DEFAULT_SSDP_PORT
);

280 i‡(
rouã
->
gw
.
addr
.
p‹t
 !
	`ht⁄s
(
DEFAULT_SSDP_PORT
))

281 
	`yyîr‹x
("sorry,Åhe upnpÜibrary %s isÅested with does"

283 
PRODUCT
);

287 
rouã
->
gw
.
addr
.
©y≥
) {

288 
SOCKS_ADDR_IPV4
:

289 #i‡!
SOCKS_CLIENT


290 
SOCKS_ADDR_IPV6
:

294 
SOCKS_ADDR_DOMAIN
:

295 i‡(
	`memcmp
(&
nû°©e
.
¥oxy¥Ÿocﬁ
,

296 &
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
,

297 (
nû°©e
.
¥oxy¥Ÿocﬁ
)) == 0) {

298 i‡(
	`°rcmp
(
rouã
->
gw
.
addr
.addr.
domaö
, 
PROXY_DIRECTs
) == 0)

299 
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
 = 1;

300 i‡(
	`°rcmp
(
rouã
->
gw
.
addr
.addr.
domaö
, 
PROXY_BROADCASTs
)

302 
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p
 = 1;

307 
	`yyîr‹x
("gateway must beán IP-address or qualified domainname, "

309 
	`socksho°2°rög
(&
rouã
->
gw
.
addr
, 
NULL
, 0),

310 
	`©y≥2°rög
(
rouã
->
gw
.
addr
.
©y≥
));

315 i‡(
	`memcmp
(&
nû°©e
.
¥oxy¥Ÿocﬁ
, &
rouã
->
gw
.
°©e
.proxyprotocol,

316 (
nû°©e
.
¥oxy¥Ÿocﬁ
)) == 0) {

317 
	`mem£t
(&
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
, 0,

318 (
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
));

320 
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v4
 = 1;

321 
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
 = 1;

324 
¥oxy¥Ÿocﬁ_t
 
¥oxy
;

326 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v4


327 || 
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
) {

328 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
hâp


329 || 
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p
)

330 
	`yyîr‹x
("%s: cannot combineÖroxyprotocol socks with other "

332 
fun˘i⁄
);

334 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
hâp
) {

335 
	`mem£t
(&
¥oxy
, 0, (proxy));

336 
¥oxy
.
hâp
 = 1;

338 i‡(
	`memcmp
(&
¥oxy
, &
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
, (proxy)) != 0)

339 
	`yyîr‹x
("%s: cannot combineÖroxyprotocol http with other "

341 
fun˘i⁄
);

343 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p
) {

344 #i‡!
HAVE_LIBMINIUPNP


345 
	`£ºx
("%s:ÇŸ c⁄figuªd f‹ usög u≤p", 
fun˘i⁄
);

348 
	`mem£t
(&
¥oxy
, 0, (proxy));

349 
¥oxy
.
u≤p
 = 1;

351 i‡(
	`memcmp
(&
¥oxy
, &
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
, (proxy)) != 0)

352 
	`yyîr‹x
("%s: cannot combineÖroxyprotocol upnp with other "

354 
fun˘i⁄
);

359 i‡(
rouã
->
gw
.
addr
.
p‹t
 =
	`ht⁄s
(0)) {

360 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v4


361 || 
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
)

362 
rouã
->
gw
.
addr
.
p‹t
 = 
	`ht⁄s
((
ö_p‹t_t
)
SOCKD_PORT
);

364 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
hâp
)

365 
rouã
->
gw
.
addr
.
p‹t
 = 
	`ht⁄s
((
ö_p‹t_t
)
SOCKD_HTTP_PORT
);

368 i‡(
	`memcmp
(&
nû°©e
.
comm™d
, &
rouã
->
gw
.
°©e
.command,

369 (
nû°©e
.
comm™d
)) == 0) {

370 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

371 #i‡
SOCKS_CLIENT


372 
rouã
->
gw
.
°©e
.
comm™d
.
ud∑ssocüã
 = 1;

373 
rouã
->
gw
.
°©e
.
comm™d
.
ud¥ïly
 = 1;

375 
rouã
->
gw
.
°©e
.
comm™d
.
c⁄√˘
 = 1;

386 
rouã
->
gw
.
°©e
.
comm™d
.
böd
 = 0;

387 
rouã
->
gw
.
°©e
.
comm™d
.
bödª∂y
 = 0;

395 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
) {

396 #i‡
SOCKS_CLIENT


397 
rouã
->
gw
.
°©e
.
comm™d
.
ud∑ssocüã
 = 1;

398 
rouã
->
gw
.
°©e
.
comm™d
.
ud¥ïly
 = 1;

399 
rouã
->
gw
.
°©e
.
comm™d
.
böd
 = 1;

400 
rouã
->
gw
.
°©e
.
comm™d
.
bödª∂y
 = 1;

402 
rouã
->
gw
.
°©e
.
comm™d
.
c⁄√˘
 = 1;

405 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v4
) {

406 #i‡
SOCKS_CLIENT


407 
rouã
->
gw
.
°©e
.
comm™d
.
böd
 = 1;

408 
rouã
->
gw
.
°©e
.
comm™d
.
bödª∂y
 = 1;

410 
rouã
->
gw
.
°©e
.
comm™d
.
c⁄√˘
 = 1;

413 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
hâp
) {

414 
rouã
->
gw
.
°©e
.
comm™d
.
c⁄√˘
 = 1;

417 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p
) {

418 #i‡
SOCKS_CLIENT


419 
rouã
->
gw
.
°©e
.
comm™d
.
ud∑ssocüã
 = 1;

420 
rouã
->
gw
.
°©e
.
comm™d
.
ud¥ïly
 = 1;

421 
rouã
->
gw
.
°©e
.
comm™d
.
böd
 = 1;

422 
rouã
->
gw
.
°©e
.
comm™d
.
bödª∂y
 = 1;

424 
rouã
->
gw
.
°©e
.
comm™d
.
c⁄√˘
 = 1;

428 #i‡!
SOCKS_CLIENT


430 i‡(!
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

431 i‡(
rouã
->
gw
.
°©e
.
comm™d
.
böd


432 || 
rouã
->
gw
.
°©e
.
comm™d
.
bödª∂y


433 || 
rouã
->
gw
.
°©e
.
comm™d
.
ud∑ssocüã


434 || 
rouã
->
gw
.
°©e
.
comm™d
.
ud¥ïly


435 || 
rouã
->
gw
.
°©e
.
¥Ÿocﬁ
.
udp
)

436 
	`yyîr‹x
("serverchaining only supported forÅhe connect command");

441 i‡(
	`memcmp
(&
nû°©e
.
¥Ÿocﬁ
, &
rouã
->
gw
.
°©e
.protocol,

442 (
nû°©e
.
¥Ÿocﬁ
)) == 0) {

443 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

444 
rouã
->
gw
.
°©e
.
¥Ÿocﬁ
.
udp
 = 1;

445 
rouã
->
gw
.
°©e
.
¥Ÿocﬁ
.
t˝
 = 1;

448 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
) {

449 #i‡
SOCKS_CLIENT


450 
rouã
->
gw
.
°©e
.
¥Ÿocﬁ
.
udp
 = 1;

452 
rouã
->
gw
.
°©e
.
¥Ÿocﬁ
.
t˝
 = 1;

455 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v4
)

456 
rouã
->
gw
.
°©e
.
¥Ÿocﬁ
.
t˝
 = 1;

458 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
hâp
)

459 
rouã
->
gw
.
°©e
.
¥Ÿocﬁ
.
t˝
 = 1;

461 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p
) {

462 #i‡
SOCKS_CLIENT


463 
rouã
->
gw
.
°©e
.
¥Ÿocﬁ
.
udp
 = 1;

465 
rouã
->
gw
.
°©e
.
¥Ÿocﬁ
.
t˝
 = 1;

469 #i‡
HAVE_GSSAPI


474 i‡(
rouã
->
gw
.
°©e
.
gsßpõn¸y±i⁄
.
˛ór
 == 0

475 && 
rouã
->
gw
.
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
 == 0

476 && 
rouã
->
gw
.
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
 == 0

477 && 
rouã
->
gw
.
°©e
.
gsßpõn¸y±i⁄
.
≥rmesßge
 == 0) {

478 
rouã
->
gw
.
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
 = 1;

479 
rouã
->
gw
.
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
 = 1;

480 
rouã
->
gw
.
°©e
.
gsßpõn¸y±i⁄
.
≥rmesßge
 = 0;

484 i‡(
	`°rcmp
((*)&
nû°©e
.
gsßpi£rvi˚«me
,

485 (*)&
rouã
->
gw
.
°©e
.
gsßpi£rvi˚«me
) == 0)

486 
	`STRCPY_ASSERTSIZE
(
rouã
->
gw
.
°©e
.
gsßpi£rvi˚«me
,

487 
DEFAULT_GSSAPISERVICENAME
);

490 i‡(
	`°rcmp
((*)&
nû°©e
.
gsßpikeyèb
,

491 (*)&
rouã
->
gw
.
°©e
.
gsßpikeyèb
) == 0)

492 
	`STRCPY_ASSERTSIZE
(
rouã
->
gw
.
°©e
.
gsßpikeyèb
, 
DEFAULT_GSSAPIKEYTAB
);

496 i‡(
rouã
->
gw
.
°©e
.
smëhodc
 == 0) {

497 *
mëhodv
 = 
rouã
->
gw
.
°©e
.
smëhodv
;

498 
size_t
 *
mëhodc
 = &
rouã
->
gw
.
°©e
.
smëhodc
;

501 
mëhodv
[(*
mëhodc
)++] = 
AUTHMETHOD_NONE
;

503 #i‡
SOCKS_CLIENT


509 #i‡
HAVE_GSSAPI


510 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
)

511 
mëhodv
[(*
mëhodc
)++] = 
AUTHMETHOD_GSSAPI
;

516 #i‡
SOCKS_CLIENT


524 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
)

525 
mëhodv
[(*
mëhodc
)++] = 
AUTHMETHOD_UNAME
;

530 
i
 = 0; i < 
rouã
->
gw
.
°©e
.
smëhodc
; ++i)

531 
rouã
->
gw
.
°©e
.
smëhodv
[
i
]) {

532 
AUTHMETHOD_NONE
:

535 #i‡!
SOCKS_CLIENT


537 
AUTHMETHOD_GSSAPI
:

538 
	`yyîr‹x
("sorry, %sáuthentication isÇot supported for "

540 
	`mëhod2°rög
(
rouã
->
gw
.
°©e
.
smëhodv
[
i
]));

544 
AUTHMETHOD_GSSAPI
:

548 
AUTHMETHOD_UNAME
:

549 i‡(!
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
)

550 
	`yyîr‹x
("rule specifies method %s, butÅhat isÇot supported "

552 
	`mëhod2°rög
(
rouã
->
gw
.
°©e
.
smëhodv
[
i
]),

553 
	`¥oxy¥Ÿocﬁs2°rög
(&
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
,

554 
NULL
,

557 #i‡!
SOCKS_CLIENT


558 i‡(
rouã
->
gw
.
°©e
.
smëhodv
[
i
] =
AUTHMETHOD_UNAME
) {

559 
size_t
 
j
, 
have_u£∫ame_mëhods
;

562 
have_u£∫ame_mëhods
 = 0;

563 
j
 = 0; j < 
sockscf
.
smëhodc
; ++j) {

564 i‡(
	`mëhodˇ≈rovide
(
sockscf
.
smëhodv
[
j
], 
u£∫ame
)) {

565 
have_u£∫ame_mëhods
 = 1;

570 i‡(!
have_u£∫ame_mëhods
)

571 
	`yyîr‹x
("route specifies method %s inÅheÖroxychain "

577 
	`mëhod2°rög
(
rouã
->
gw
.
°©e
.
smëhodv
[
i
]));

579 
	`yylog
(
LOG_NOTICE
,

585 
	`mëhod2°rög
(
rouã
->
gw
.
°©e
.
smëhodv
[
i
]));

591 
AUTHMETHOD_BSDAUTH
:

592 
AUTHMETHOD_PAM_ANY
:

593 
AUTHMETHOD_PAM_ADDRESS
:

594 
AUTHMETHOD_PAM_USERNAME
:

595 
AUTHMETHOD_RFC931
:

596 
	`yyîr‹x
("method %s is only valid for ACLÑules",

597 
	`mëhod2°rög
(
rouã
->
gw
.
°©e
.
smëhodv
[
i
]));

601 
	`SERRX
(
rouã
->
gw
.
°©e
.
smëhodv
[
i
]);

604 i‡(
rouã
->
§c
.
©y≥
 =
SOCKS_ADDR_IFNAME
)

605 
	`yyîr‹x
("interfaceÇamesÇot supported for srcáddress");

607 #i‡
SOCKS_CLIENT


608 i‡(
rouã
->
rdr_‰om
.
©y≥
 =
SOCKS_ADDR_IPV4
) {

609 i‡(
rouã
->
rdr_‰om
.
addr
.
ùv4
.
mask
.
s_addr
 !
	`ht⁄l
(
IPV4_FULLNETMASK
))

610 
	`yyîr‹
("netmask forÑedirect fromáddress must be %d,Çot %d",

611 
IPV4_FULLNETMASK
,

612 
	`bôcou¡
(()
rouã
->
rdr_‰om
.
addr
.
ùv4
.
mask
.
s_addr
));

615 i‡(
rouã
->
rdr_‰om
.
©y≥
 =
SOCKS_ADDR_IPV6
) {

616 i‡(
rouã
->
rdr_‰om
.
addr
.
ùv6
.
maskbôs
 !
IPV6_NETMASKBITS
)

617 
	`yyîr‹
("netmask forÑedirect fromáddress must be %d,Çot %d",

618 
IPV6_NETMASKBITS
, 
rouã
->
rdr_‰om
.
addr
.
ùv6
.
maskbôs
);

622 
is⁄eshŸ
 = (
rouã
->
d°
.
©y≥
 =
SOCKS_ADDR_IFNAME
 ? 0 : 1);

623 
ifb
 = 0;

624 
√xåouã
 = 
NULL
;

634 
sockaddr_°‹age
 
addr
, 
mask
;

636 i‡(
rouã
->
d°
.
©y≥
 =
SOCKS_ADDR_IFNAME
) {

637 i‡(
	`i‚ame2sockaddr
(
rouã
->
d°
.
addr
.
i‚ame
, 
ifb
, &addr, &
mask
)

638 =
NULL
) {

639 i‡(
ifb
 == 0) {

640 
visbuf
[
MAXIFNAMELEN
 * 4];

642 
	`yyîr‹x
("couldÇot createÑoute with destination interface %s: "

644 
	`°r2vis
(
rouã
->
d°
.
addr
.
i‚ame
,

645 
	`°æí
(
rouã
->
d°
.
addr
.
i‚ame
),

646 
visbuf
,

647 (
visbuf
)));

654 i‡(
√xåouã
 =
NULL
)

655 
√xåouã
 = 
rouã
;

657 i‡((
√xåouã
 = 
	`mÆloc
((*√xåouã))Ë=
NULL
)

658 
	`yyîr‹x
("couldÇotállocate %lu bytes forÑoute",

659 ()(*
√xåouã
));

661 *
√xåouã
 = *
rouã
;

664 i‡(
rouã
->
d°
.
©y≥
 =
SOCKS_ADDR_IFNAME
) {

665 
	`SASSERTX
(
√xåouã
->
d°
.
©y≥
 =
SOCKS_ADDR_IFNAME
);

667 
	`sockaddr2ruÀaddr
(&
addr
, &
√xåouã
->
d°
);

669 
	`SASSERTX
(
√xåouã
->
d°
.
©y≥
 !
SOCKS_ADDR_IFNAME
);

671 
addr
.
ss_Ámûy
) {

672 
AF_INET
:

673 
√xåouã
->
d°
.
addr
.
ùv4
.
mask
 = 
	`TOIN
(&mask)->
sö_addr
;

676 
AF_INET6
:

677 
√xåouã
->
d°
.
addr
.
ùv6
.
maskbôs


678 
	`bôcou¡_ö6addr
(&
	`TOIN6
(&
mask
)->
sö6_addr
);

682 
	`SERRX
(
addr
.
ss_Ámûy
);

689 i‡(!
œ°
 || 
sockscf
.
rouã
 =
NULL
) {

690 
rouã_t
 *
p
;

691 
size_t
 
i
;

693 
√xåouã
->
√xt
 = 
sockscf
.
rouã
;

694 
sockscf
.
rouã
 = 
√xåouã
;

696 i‡(
√xåouã
->
°©e
.
autﬂdded
)

697 
√xåouã
->
numbî
 = 0;

699 i‡(
ifb
 == 0) {

704 
i
 = 1, 
p
 = 
sockscf
.
rouã
;Ö !
NULL
;Ö =Ö->
√xt
, ++i)

705 
p
->
numbî
 = 
i
;

709 
rouã_t
 *
œ°rouã
;

711 
œ°rouã
 = 
sockscf
.
rouã
;

712 i‡(
√xåouã
->
°©e
.
autﬂdded
)

713 
√xåouã
->
numbî
 = 0;

715 
œ°rouã
->
√xt
 !
NULL
)

716 
œ°rouã
 =Üa°rouã->
√xt
;

718 i‡(
ifb
 == 0)

723 
√xåouã
->
numbî
 = 
œ°rouã
->number + 1;

726 
œ°rouã
->
√xt
 = 
√xåouã
;

727 
√xåouã
->
√xt
 = 
NULL
;

730 i‡(
is⁄eshŸ
)

733 ++
ifb
;

736 i‡(!
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘


737 && !–
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p


738 && 
rouã
->
gw
.
addr
.
©y≥
 =
SOCKS_ADDR_DOMAIN


739 && 
	`°rcmp
(
rouã
->
gw
.
addr
.addr.
domaö
, 
PROXY_BROADCASTs
) == 0)) {

743 
sockaddr_°‹age
 
ßddr
, 
smask
;

744 
comm™d_t
 
comm™ds
;

745 
¥Ÿocﬁ_t
 
¥Ÿocﬁs
;

747 
	`bzîo
(&
comm™ds
, (commands));

748 
	`bzîo
(&
¥Ÿocﬁs
, (protocols));

750 
	`bzîo
(&
smask
, (smask));

751 
	`SET_SOCKADDR
(&
smask
, 
AF_INET
);

752 
	`TOIN
(&
smask
)->
sö_p‹t
 = 
	`ht⁄s
(0);

753 
	`TOIN
(&
smask
)->
sö_addr
.
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

755 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p


756 && 
rouã
->
gw
.
addr
.
©y≥
 =
SOCKS_ADDR_IFNAME
) {

761 
Æªady_d⁄e
;

763 i‡(!
Æªady_d⁄e
) {

764 
£rvít
 *
£rvi˚
;

766 
	`bzîo
(&
ßddr
, (saddr));

767 
	`SET_SOCKADDR
(&
ßddr
, 
AF_INET
);

768 i‡(
	`socks_öë_±⁄
(
AF_INET
,

769 
DEFAULT_SSDP_BROADCAST_IPV4ADDR
,

770 &
	`TOIN
(&
ßddr
)->
sö_addr
.
s_addr
,

771 
NULL
) != 1)

772 
	`£º
("%s: inet_pton(3): couldÇot convert %sÅo IPv4áddress",

773 
fun˘i⁄
, 
DEFAULT_SSDP_BROADCAST_IPV4ADDR
);

775 i‡((
£rvi˚
 = 
	`gë£rvby«me
("ssdp", "udp")Ë=
NULL
)

776 
	`TOIN
(&
ßddr
)->
sö_p‹t
 = 
	`ht⁄s
(
DEFAULT_SSDP_PORT
);

778 
	`TOIN
(&
ßddr
)->
sö_p‹t
 = 
£rvi˚
->
s_p‹t
;

780 
¥Ÿocﬁs
.
udp
 = 1;

782 
	`socks_autﬂdd_dúe˘rouã
(&
comm™ds
, &
¥Ÿocﬁs
, &
ßddr
, &
smask
);

784 
Æªady_d⁄e
 = 1;

788 
	`socksho°2sockaddr
(&
rouã
->
gw
.
addr
, &
ßddr
);

790 
comm™ds
.
c⁄√˘
 = 1;

791 
¥Ÿocﬁs
.
t˝
 = 1;

793 
	`socks_autﬂdd_dúe˘rouã
(&
comm™ds
, &
¥Ÿocﬁs
, &
ßddr
, &
smask
);

797  
rouã
;

798 
	}
}

800 
rouã_t
 *

801 
	$socks_autﬂdd_dúe˘rouã
(
comm™d
, 
¥Ÿocﬁ
, 
ßddr
, 
√tmask
)

802 c⁄° 
comm™d_t
 *
comm™d
;

803 c⁄° 
¥Ÿocﬁ_t
 *
¥Ÿocﬁ
;

804 c⁄° 
sockaddr_°‹age
 *
ßddr
;

805 c⁄° 
sockaddr_°‹age
 *
√tmask
;

807 
rouã_t
 
rouã
;

809 
	`mem£t
(&
rouã
, 0, (route));

811 
rouã
.
§c
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

812 
rouã
.
§c
.
›î©‹
 = 
n⁄e
;

814 
rouã
.
d°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

815 
rouã
.
d°
.
addr
.
ùv4
.
ù
 = 
	`TOCIN
(
ßddr
)->
sö_addr
;

816 
rouã
.
d°
.
addr
.
ùv4
.
mask
.
s_addr
 = 
	`TOCIN
(
√tmask
)->
sö_addr
.s_addr;

817 
rouã
.
d°
.
p‹t
.
t˝
 =Ñouã.d°.p‹t.
udp
 = 
	`TOCIN
(
ßddr
)->
sö_p‹t
;

818 
rouã
.
d°
.
›î©‹
 = 
	`ht⁄s
(
	`TOCIN
(
ßddr
)->
sö_p‹t
)

819 =0 ? 
n⁄e
 : 
eq
;

821 
rouã
.
gw
.
addr
.
©y≥
 = 
SOCKS_ADDR_DOMAIN
;

822 
	`STRCPY_ASSERTSIZE
(
rouã
.
gw
.
addr
.addr.
domaö
, "direct");

824 
rouã
.
gw
.
°©e
.
comm™d
 = *command;

825 
rouã
.
gw
.
°©e
.
¥Ÿocﬁ
 = *protocol;

827 
rouã
.
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
 = 1;

829 
rouã
.
°©e
.
autﬂdded
 = 1;

831  
	`socks_addrouã
(&
rouã
, 0);

832 
	}
}

834 
rouã_t
 *

835 
	$socks_gërouã
(
ªq
, 
§c
, 
d°
)

836 c⁄° 
ªque°_t
 *
ªq
;

837 c⁄° 
socksho°_t
 *
§c
;

838 c⁄° 
socksho°_t
 *
d°
;

840 c⁄° *
fun˘i⁄
 = "socks_getroute()";

841 
rouã_t
 *
rouã
;

842 
§cbuf
[
MAXSOCKSHOSTSTRING
], 
d°buf
[MAXSOCKSHOSTSTRING];

844 #i‡
SOCKS_CLIENT


845 
	`˛õ¡öô
();

848 
	`¶og
(
LOG_DEBUG
,

850 
fun˘i⁄
,

851 
	`¥oxy¥Ÿocﬁ2°rög
(
ªq
->
vîsi⁄
),

852 
	`comm™d2°rög
(
ªq
->
comm™d
), 
	`¥Ÿocﬁ2°rög
‘eq->
¥Ÿocﬁ
),

853 
§c
 =
NULL
 ? "<NONE>" : 
	`socksho°2°rög
(§c, 
§cbuf
, (srcbuf)),

854 
d°
 =
NULL
 ? "<NONE>" : 
	`socksho°2°rög
(d°, 
d°buf
, (dstbuf)));

856 
rouã
 = 
sockscf
.rouã;Ñouã !
NULL
;Ñouã =Ñouã->
√xt
) {

857 
	`socks_showrouã
(
rouã
);

859 i‡(
sockscf
.
rouã›ti⁄s
.
maxÁû
 != 0

860 && 
rouã
->
°©e
.
Áûed
 >
sockscf
.
rouã›ti⁄s
.
maxÁû
) {

861 i‡(
sockscf
.
rouã›ti⁄s
.
badexpúe
 == 0

862 || 
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(
NULL
), 
rouã
->
°©e
.
badtime
)

863 <
sockscf
.
rouã›ti⁄s
.
badexpúe
) {

864 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; badtime", 
fun˘i⁄
);

868 
rouã
->
°©e
.
Áûed
 = 0;

871 
ªq
->
vîsi⁄
) {

877 
PROXY_SOCKS_V4
:

878 i‡(!
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v4
) {

879 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; vîsi⁄", 
fun˘i⁄
);

883 
ªq
->
ho°
.
©y≥
) {

884 
SOCKS_ADDR_IPV4
:

888 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch;áty≥", 
fun˘i⁄
);

892 
ªq
->
comm™d
) {

893 
SOCKS_BIND
:

894 
SOCKS_CONNECT
:

898 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; cmd", 
fun˘i⁄
);

904 
PROXY_SOCKS_V5
:

905 i‡(!
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
) {

906 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; vîsi⁄", 
fun˘i⁄
);

910 
ªq
->
ho°
.
©y≥
) {

911 
SOCKS_ADDR_IPV4
:

912 
SOCKS_ADDR_IPV6
:

913 
SOCKS_ADDR_DOMAIN
:

917 
	`SERRX
(
ªq
->
ho°
.
©y≥
);

921 
PROXY_HTTP_10
:

922 
PROXY_HTTP_11
:

923 i‡(!
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
hâp
) {

924 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; vîsi⁄", 
fun˘i⁄
);

928 
ªq
->
comm™d
) {

929 
SOCKS_CONNECT
:

933 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; cmd", 
fun˘i⁄
);

939 
PROXY_UPNP
:

940 i‡(!
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p
) {

941 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; vîsi⁄", 
fun˘i⁄
);

946 
PROXY_DIRECT
:

947 i‡(!
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

948 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; vîsi⁄", 
fun˘i⁄
);

954 
	`SERRX
(
ªq
->
vîsi⁄
);

957 
ªq
->
comm™d
) {

958 
SOCKS_BIND
:

959 i‡(!
rouã
->
gw
.
°©e
.
comm™d
.
böd
) {

960 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; cmd", 
fun˘i⁄
);

969 
ªq
->
vîsi⁄
) {

970 
PROXY_SOCKS_V4
:

971 
PROXY_SOCKS_V5
:

972 i‡(
ªq
->
¥Ÿocﬁ
 =
SOCKS_TCP
)

975 
	`SASSERTX
(
ªq
->
¥Ÿocﬁ
 =
SOCKS_UDP
);

979 
PROXY_HTTP_10
:

980 
PROXY_HTTP_11
:

981 
	`¶og
(
LOG_DEBUG
,

984 
fun˘i⁄
);

988 
PROXY_UPNP
:

989 
PROXY_DIRECT
:

993 
	`SERRX
(
ªq
->
vîsi⁄
);

998 
SOCKS_CONNECT
:

999 i‡(!
rouã
->
gw
.
°©e
.
comm™d
.
c⁄√˘
) {

1000 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; cmd", 
fun˘i⁄
);

1005 
SOCKS_UDPASSOCIATE
:

1006 i‡(!
rouã
->
gw
.
°©e
.
comm™d
.
ud∑ssocüã
) {

1007 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; cmd", 
fun˘i⁄
);

1013 
	`SERRX
(
ªq
->
comm™d
);

1019 i‡((
ªq
->
¥Ÿocﬁ
 =
SOCKS_TCP
 && !
rouã
->
gw
.
°©e
.¥Ÿocﬁ.
t˝
)

1020 || (
ªq
->
¥Ÿocﬁ
 =
SOCKS_UDP
 && !
rouã
->
gw
.
°©e
.¥Ÿocﬁ.
udp
)) {

1021 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch;ÖrŸocﬁ", 
fun˘i⁄
);

1028 
ªq
->
vîsi⁄
) {

1037 
PROXY_DIRECT
:

1038 
PROXY_HTTP_10
:

1039 
PROXY_HTTP_11
:

1040 
PROXY_SOCKS_V4
:

1041 
PROXY_UPNP
:

1042 i‡(!
	`mëhodis£t
(
AUTHMETHOD_NONE
,

1043 
rouã
->
gw
.
°©e
.
smëhodv
,

1044 
rouã
->
gw
.
°©e
.
smëhodc
)) {

1045 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; mëhod", 
fun˘i⁄
);

1051 
PROXY_SOCKS_V5
:

1055 
	`SERRX
(
ªq
->
vîsi⁄
);

1058 i‡(
ªq
->
auth
 !
NULL
 &&Ñeq->auth->
mëhod
 !
AUTHMETHOD_NOTSET
) {

1062 
	`SASSERTX
(!
SOCKS_CLIENT
);

1064 
	`¶og
(
LOG_DEBUG
,

1066 
fun˘i⁄
, 
	`mëhod2°rög
(
ªq
->
auth
->
mëhod
));

1068 i‡(!
	`mëhodis£t
(
ªq
->
auth
->
mëhod
,

1069 
rouã
->
gw
.
°©e
.
smëhodv
,

1070 
rouã
->
gw
.
°©e
.
smëhodc
)) {

1071 i‡(
	`mëhodis£t
(
AUTHMETHOD_NONE
,

1072 
rouã
->
gw
.
°©e
.
smëhodv
,

1073 
rouã
->
gw
.
°©e
.
smëhodc
)) {

1074 
	`¶og
(
LOG_DEBUG
,

1078 
fun˘i⁄
,

1079 ()
rouã
->
numbî
,

1080 
	`mëhod2°rög
(
AUTHMETHOD_NONE
));

1083 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; mëhod", 
fun˘i⁄
);

1089 i‡(
§c
 !
NULL
) {

1090 
	`¶og
(
LOG_DEBUG
, "%s: checkög f‹ sr¯m©ch ...", 
fun˘i⁄
);

1091 i‡(!
	`addrm©ch
(&
rouã
->
§c
, src, 
NULL
, 
ªq
->
¥Ÿocﬁ
, 0)) {

1092 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; sr¯addr", 
fun˘i⁄
);

1097 i‡(
d°
 !
NULL
) {

1098 
	`¶og
(
LOG_DEBUG
, "%s: checkög f‹ d° m©ch ...", 
fun˘i⁄
);

1099 i‡(!
	`addrm©ch
(&
rouã
->
d°
, d°, 
NULL
, 
ªq
->
¥Ÿocﬁ
, 0)) {

1100 
	`¶og
(
LOG_DEBUG
, "%s:Ñouã d€†nŸ m©ch; d°áddr", 
fun˘i⁄
);

1108 i‡(
rouã
 =
NULL
)

1109 
	`¶og
(
LOG_DEBUG
, "%s:Ço %sÑoute found",

1110 
fun˘i⁄
, 
	`¥oxy¥Ÿocﬁ2°rög
(
ªq
->
vîsi⁄
));

1112 
	`¶og
(
LOG_DEBUG
, "%s: %sÑoute found,Ñoute #%d",

1113 
fun˘i⁄
, 
	`¥oxy¥Ÿocﬁ2°rög
(
ªq
->
vîsi⁄
), 
rouã
->
numbî
);

1115 i‡(!
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘


1116 && 
d°
 !
NULL
) {

1118 i‡(
	`socksho°¨ìq
(&
rouã
->
gw
.
addr
, 
d°
))

1119 
	`£ºx
("%s:ÑouteÅo gw %s is itself. RouteÜoop in config\n",

1120 
fun˘i⁄
, 
	`socksho°2°rög
(&
rouã
->
gw
.
addr
, 
NULL
, 0));

1124  
rouã
;

1125 
	}
}

1128 
	$socks_rouã£tup
(
c⁄åﬁ
, 
d©a
, 
rouã
, 
emsg
, 
emsgÀn
)

1129 
c⁄åﬁ
;

1130 
d©a
;

1131 c⁄° 
rouã_t
 *
rouã
;

1132 *
emsg
;

1133 c⁄° 
size_t
 
emsgÀn
;

1135 c⁄° *
fun˘i⁄
 = "socks_routesetup()";

1136 
sockaddr_°‹age
 
c⁄åﬁaddr
, 
d©Øddr
;

1137 
sockÀn_t
 
Àn
;

1138 
c⁄åﬁ_ty≥
, 
d©a_ty≥
;

1140 i‡(
rouã
->
rdr_‰om
.
©y≥
 =
SOCKS_ADDR_NOTSET
)

1143 i‡(
c⁄åﬁ
 == -1)

1144 
c⁄åﬁ
 = 
d©a
;

1145 i‡(
d©a
 == -1)

1146 
d©a
 = 
c⁄åﬁ
;

1148 
	`SASSERTX
(
c⁄åﬁ
 != -1);

1149 
	`SASSERTX
(
d©a
 != -1);

1151 
Àn
 = (
c⁄åﬁaddr
);

1152 i‡(
	`gësock«me
(
c⁄åﬁ
, 
	`TOSA
(&
c⁄åﬁaddr
), &
Àn
) != 0) {

1153 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "getsockname(2) on fd %d (control) failed: %s",

1154 
c⁄åﬁ
, 
	`°ªº‹
(
î∫o
));

1156 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

1160 i‡(
d©a
 =
c⁄åﬁ
)

1161 
d©Øddr
 = 
c⁄åﬁaddr
;

1163 
Àn
 = (
d©Øddr
);

1164 i‡(
	`gësock«me
(
d©a
, 
	`TOSA
(&
d©Øddr
), &
Àn
) != 0) {

1165 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "getsockname(2) on fd %d (data) failed: %s",

1166 
d©a
, 
	`°ªº‹
(
î∫o
));

1168 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

1173 
Àn
 = (
c⁄åﬁ_ty≥
);

1174 i‡(
	`gësock›t
(
c⁄åﬁ
, 
SOL_SOCKET
, 
SO_TYPE
, &
c⁄åﬁ_ty≥
, &
Àn
) != 0) {

1175 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "getsockopt(2) on fd %d (control) failed: %s",

1176 
c⁄åﬁ
, 
	`°ªº‹
(
î∫o
));

1178 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

1182 i‡(
d©a
 =
c⁄åﬁ
)

1183 
d©a_ty≥
 = 
c⁄åﬁ_ty≥
;

1185 
Àn
 = (
d©a_ty≥
);

1186 i‡(
	`gësock›t
(
d©a
, 
SOL_SOCKET
, 
SO_TYPE
, &
d©a_ty≥
, &
Àn
) != 0) {

1187 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "getsockopt(2) on fd %d (data) failed: %s",

1188 
d©a
, 
	`°ªº‹
(
î∫o
));

1190 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

1195 
	`¶og
(
LOG_DEBUG
,

1198 
fun˘i⁄
,

1199 
c⁄åﬁ
,

1200 
c⁄åﬁ_ty≥
 =
SOCK_STREAM
 ? "stream" : "dgram",

1201 
d©a
,

1202 
d©a_ty≥
 =
SOCK_STREAM
 ? "stream" : "dgram",

1203 
	`¥oxy¥Ÿocﬁs2°rög
(&
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
, 
NULL
, 0),

1204 
	`ruÀaddr2°rög
(&
rouã
->
rdr_‰om
, 
ADDRINFO_PORT
, 
NULL
, 0));

1206 i‡(
c⁄åﬁ_ty≥
 =
SOCK_DGRAM
) {

1207 i‡(
	`socks_ªböd
(
c⁄åﬁ
,

1208 
c⁄åﬁ_ty≥
 =
SOCK_STREAM
 ? 
SOCKS_TCP
 : 
SOCKS_UDP
,

1209 &
c⁄åﬁaddr
,

1210 &
rouã
->
rdr_‰om
,

1211 
emsg
,

1212 
emsgÀn
) != 0) {

1213 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "socks_rebind() of control-fd %d failed: %s",

1214 
c⁄åﬁ
, 
	`°ªº‹
(
î∫o
));

1216 
	`sw¨nx
("%s: %s", 
emsg
, 
fun˘i⁄
);

1221 i‡(
c⁄åﬁ
 =
d©a
)

1224 i‡(
d©a_ty≥
 =
SOCK_DGRAM
) {

1225 i‡(
	`socks_ªböd
(
d©a
,

1226 
d©a_ty≥
 =
SOCK_STREAM
 ? 
SOCKS_TCP
 : 
SOCKS_UDP
,

1227 &
d©Øddr
,

1228 &
rouã
->
rdr_‰om
,

1229 
emsg
,

1230 
emsgÀn
) != 0) {

1231 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "rebind() of data-fd %d failed: %s",

1232 
d©a
, 
	`°ªº‹
(
î∫o
));

1234 
	`sw¨nx
("%s: %s", 
emsg
, 
fun˘i⁄
);

1240 
	}
}

1242 
rouã_t
 *

1243 
	$socks_c⁄√˘rouã
(
s
, 
∑ckë
, 
§c
, 
d°
, 
emsg
, 
emsgÀn
)

1244 c⁄° 
s
;

1245 
socks_t
 *
∑ckë
;

1246 c⁄° 
socksho°_t
 *
§c
;

1247 c⁄° 
socksho°_t
 *
d°
;

1248 *
emsg
;

1249 c⁄° 
size_t
 
emsgÀn
;

1251 c⁄° *
fun˘i⁄
 = "socks_connectroute()";

1252 
rouã_t
 *
rouã
;

1253 
d°°rög
[
MAXSOCKSHOSTSTRING
], 
gw°rög
[MAXSOCKSHOSTSTRING];

1254 
rc
;

1256 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, command %s",

1257 
fun˘i⁄
, 
s
, 
	`comm™d2°rög
(
∑ckë
->
ªq
.
comm™d
));

1259 i‡((
rouã
 = 
	`socks_gërouã
(&
∑ckë
->
ªq
, 
§c
, 
d°
)Ë=
NULL
)

1260 
	`SERRX
(0);

1262 
	`¶og
(
LOG_NEGOTIATE
, "%s: have %sÑoute (route #%d)Åo %s via %s",

1263 
fun˘i⁄
,

1264 
	`¥oxy¥Ÿocﬁs2°rög
(&
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
, 
NULL
, 0),

1265 
rouã
->
numbî
,

1266 
d°
 =
NULL
 ?

1267 "<UNKNOWN>" : 
	`socksho°2°rög
(
d°
, 
d°°rög
, (dststring)),

1268 
	`socksho°2°rög
(&
rouã
->
gw
.
addr
, 
gw°rög
, (gwstring)));

1270 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
)

1271  
rouã
;

1273 #i‡
HAVE_LIBMINIUPNP


1274 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
u≤p
) {

1275 i‡(
rouã
->
gw
.
addr
.
©y≥
 =
SOCKS_ADDR_DOMAIN


1276 && 
	`°rcmp
(
rouã
->
gw
.
addr
.addr.
domaö
, 
PROXY_BROADCASTs
) == 0) {

1281 
iÁddrs
 *
iÁp
, *
iÁ˚
;

1282 
g©eway_t
 
gw
;

1284 i‡(
	`gëiÁddrs
(&
iÁp
) == -1) {

1285 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1289 
ENV_UPNP_IGD
, 
rouã
->
gw
.
addr
.addr.
domaö
, 
	`°ªº‹
(
î∫o
));

1291 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

1293 
	`socks_bœckli°
(
rouã
, 
emsg
);

1295  
NULL
;

1298 
gw
 = 
rouã
->gw;

1299 
gw
.
addr
.
©y≥
 = 
SOCKS_ADDR_IFNAME
;

1301 
iÁ˚
 = 
iÁp
; iÁ˚ !
NULL
; iÁ˚ = iÁ˚->
iÁ_√xt
) {

1302 i‡(
iÁ˚
->
iÁ_addr
 =
NULL


1303 || 
iÁ˚
->
iÁ_addr
->
ß_Ámûy
 !
AF_INET


1304 || 
	`TOIN
(
iÁ˚
->
iÁ_addr
)->
sö_addr
.
s_addr
 =
	`ht⁄l
(0)

1305 || !(
iÁ˚
->
iÁ_Êags
 & (
IFF_UP
 | 
IFF_MULTICAST
))

1306 || 
iÁ˚
->
iÁ_Êags
 & (
IFF_LOOPBACK
 | 
IFF_POINTOPOINT
))

1309 i‡(
	`°æí
(
iÁ˚
->
iÁ_«me
Ë>(
gw
.
addr
.addr.
i‚ame
)) {

1310 
	`sw¨n
("%s: ifname \"%s\" isÅooÜongáccordingÅo our "

1312 
fun˘i⁄
,

1313 
iÁ˚
->
iÁ_«me
,

1314 ()(
gw
.
addr
.addr.
i‚ame
));

1319 
	`STRCPY_ASSERTLEN
(
gw
.
addr
.addr.
i‚ame
, 
iÁ˚
->
iÁ_«me
);

1321 i‡(
	`socks_öôu≤p
(&
gw
, 
emsg
, 
emsgÀn
) == 0) {

1322 
	`¶og
(
LOG_NEGOTIATE
, "%s: socks_initupnp() succeeded on iface %s",

1323 
fun˘i⁄
, 
gw
.
addr
.addr.
i‚ame
);

1331 
∑ckë
->
gw
 = gw;

1332  
rouã
;

1335 
	`¶og
(
LOG_NEGOTIATE
,

1337 
fun˘i⁄
, 
gw
.
addr
.addr.
i‚ame
, 
emsg
);

1340 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1343 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

1345 i‡(
î∫o
 == 0)

1346 
î∫o
 = 
ENETUNREACH
;

1348 
	`socks_bœckli°
(
rouã
, 
emsg
);

1349  
NULL
;

1357 
∑ckë
->
gw
 = 
rouã
->gw;

1358  
rouã
;

1364 i‡((
rc
 = 
	`socks_c⁄√˘ho°
(
s
,

1365 #i‡!
SOCKS_CLIENT


1366 
EXTERNALIF
,

1368 &
rouã
->
gw
.
addr
,

1369 
NULL
,

1370 
NULL
,

1371 
sockscf
.
timeout
.
c⁄√˘
 ?

1372 ()
sockscf
.
timeout
.
c⁄√˘
 : ()-1,

1373 
emsg
,

1374 
emsgÀn
)) == 0

1375 || (
rc
 =-1 && 
î∫o
 =
EINPROGRESS
)) {

1376 
∑ckë
->
gw
 = 
rouã
->gw;

1377  
rouã
;

1380 
	`sw¨nx
("%s: failedÅo connectÑouteÅo %s on fd %d: %s",

1381 
fun˘i⁄
, 
	`socksho°2°rög
(&
rouã
->
gw
.
addr
, 
NULL
, 0), 
s
, 
emsg
);

1383 i‡(
î∫o
 =
EINVAL
) {

1384 
sockaddr_ö
 
œddr
;

1385 
sockÀn_t
 
Àn
 = (
œddr
);

1387 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
œddr
), &
Àn
) == 0

1388 && 
œddr
.
sö_addr
.
s_addr
 =
	`ht⁄l
(
INADDR_LOOPBACK
)) {

1389 
rouã_t
 
dúe˘rouã
;

1391 
	`¶og
(
LOG_NEGOTIATE
,

1396 
fun˘i⁄
, 
s
);

1398 
dúe˘rouã
.
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
 = 1;

1399  &
dúe˘rouã
;

1403 
	`socks_bœckli°
(
rouã
, 
emsg
);

1405  
NULL
;

1406 
	}
}

1409 
	$socks_˛órbœckli°
(
rouã
)

1410 
rouã_t
 *
rouã
;

1413 i‡(
rouã
 !
NULL
)

1414 
rouã
->
°©e
.
Áûed
 =Ñouã->°©e.
badtime
 = 0;

1415 
	}
}

1418 
	$socks_bœckli°
(
rouã
, 
ªas⁄
)

1419 
rouã_t
 *
rouã
;

1420 c⁄° *
ªas⁄
;

1422 c⁄° *
fun˘i⁄
 = "socks_blacklist()";

1424 i‡(
rouã
 =
NULL
 || 
sockscf
.
rouã›ti⁄s
.
maxÁû
 == 0)

1427 
	`¶og
(
LOG_INFO
,

1429 
fun˘i⁄
,

1430 
rouã
->
°©e
.
autﬂdded
 ? "autoadded " : "",

1431 
rouã
->
numbî
,

1432 
ªas⁄
);

1434 #i‡
HAVE_LIBMINIUPNP


1435 
	`bzîo
(&
rouã
->
gw
.
°©e
.
d©a
, (route->gw.state.data));

1438 ++
rouã
->
°©e
.
Áûed
;

1439 
	`time_m⁄Ÿ⁄ic
(&
rouã
->
°©e
.
badtime
);

1440 
	}
}

1442 
rouã_t
 *

1443 
	$socks_ªque°pﬁish
(
ªq
, 
§c
, 
d°
)

1444 
ªque°_t
 *
ªq
;

1445 c⁄° 
socksho°_t
 *
§c
;

1446 c⁄° 
socksho°_t
 *
d°
;

1448 c⁄° *
fun˘i⁄
 = "socks_requestpolish()";

1449 c⁄° 
‹igöÆvîsi⁄
 = 
ªq
->
vîsi⁄
;

1450 
rouã_t
 
dúe˘rouã
;

1451 
rouã_t
 *
rouã
;

1452 
§cbuf
[
MAXSOCKSHOSTSTRING
], 
d°buf
[MAXSOCKSHOSTSTRING];

1453 
bœckli°˛óªd
;

1455 i‡(
sockscf
.
rouã
 =
NULL
) {

1456 
rouã_t
 
dúe˘rouã
;

1458 
	`¶og
(
LOG_DEBUG
,

1459 "%s:Çÿrouã†c⁄figuªd. Goög dúe˘ f‹áŒ", 
fun˘i⁄
);

1461 
dúe˘rouã
.
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
 = 1;

1462  &
dúe˘rouã
;

1465 
	`¶og
(
LOG_NEGOTIATE
,

1468 
fun˘i⁄
,

1469 
	`¥oxy¥Ÿocﬁ2°rög
(
ªq
->
vîsi⁄
),

1470 
	`comm™d2°rög
(
ªq
->
comm™d
), 
	`¥Ÿocﬁ2°rög
‘eq->
¥Ÿocﬁ
),

1471 
§c
 =
NULL
 ? "<NONE>" : 
	`socksho°2°rög
(§c, 
§cbuf
, (srcbuf)),

1472 
d°
 =
NULL
 ? "<NONE>" : 
	`socksho°2°rög
(d°, 
d°buf
, (dstbuf)),

1473 
ªq
->
auth
->
mëhod
);

1476 
dúe˘rouã
.
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
 = 1;

1478 i‡((
rouã
 = 
	`socks_gërouã
(
ªq
, 
§c
, 
d°
)Ë!
NULL
)

1479  
rouã
;

1490 
	`SASSERTX
(
ªq
->
vîsi⁄
 =
PROXY_DIRECT
);

1492 
ªq
->
vîsi⁄
 = 
PROXY_SOCKS_V4
;

1493 i‡((
rouã
 = 
	`socks_gërouã
(
ªq
, 
§c
, 
d°
)Ë!
NULL
)

1494  
rouã
;

1496 
ªq
->
vîsi⁄
 = 
PROXY_SOCKS_V5
;

1497 i‡((
rouã
 = 
	`socks_gërouã
(
ªq
, 
§c
, 
d°
)Ë!
NULL
)

1498  
rouã
;

1500 
ªq
->
vîsi⁄
 = 
PROXY_HTTP_10
;

1501 i‡((
rouã
 = 
	`socks_gërouã
(
ªq
, 
§c
, 
d°
)Ë!
NULL
)

1502  
rouã
;

1504 
ªq
->
vîsi⁄
 = 
PROXY_HTTP_11
;

1505 i‡((
rouã
 = 
	`socks_gërouã
(
ªq
, 
§c
, 
d°
)Ë!
NULL
)

1506  
rouã
;

1508 
ªq
->
vîsi⁄
 = 
PROXY_UPNP
;

1509 i‡((
rouã
 = 
	`socks_gërouã
(
ªq
, 
§c
, 
d°
)Ë!
NULL
)

1510  
rouã
;

1512 
ªq
->
vîsi⁄
 = 
‹igöÆvîsi⁄
;

1514 i‡(
sockscf
.
›ti⁄
.
dúe˘ÁŒback
) {

1515 
	`¶og
(
LOG_NEGOTIATE
,

1517 
fun˘i⁄
, 
	`comm™d2°rög
(
ªq
->
comm™d
));

1519 
ªq
->
vîsi⁄
 = 
PROXY_DIRECT
;

1520  &
dúe˘rouã
;

1528 
bœckli°˛óªd
 = 0;

1529 
rouã
 = 
sockscf
.rouã;Ñouã !
NULL
;Ñouã =Ñouã->
√xt
) {

1530 i‡(
rouã
->
°©e
.
Áûed
) {

1531 
	`socks_˛órbœckli°
(
rouã
);

1532 ++
bœckli°˛óªd
;

1536 i‡(
bœckli°˛óªd
) {

1537 
	`¶og
(
LOG_INFO
,

1539 
fun˘i⁄
,

1540 
bœckli°˛óªd
,

1541 
bœckli°˛óªd
 == 1 ? "" : "s");

1543  
	`socks_ªque°pﬁish
(
ªq
, 
§c
, 
d°
);

1546 
	`¶og
(
LOG_NEGOTIATE
,

1549 
fun˘i⁄
, 
	`comm™d2°rög
(
ªq
->
comm™d
));

1551 
î∫o
 = 
ENETUNREACH
;

1552  
NULL
;

1554 
	}
}

1557 
	$›ti⁄öô
()

1564 
sockscf
.
ªsﬁvïrŸocﬁ
 = 
RESOLVEPROTOCOL_UDP
;

1566 #i‡
SOCKS_DIRECTROUTE_FALLBACK


1567 i‡(
	`socks_gëív
(
ENV_SOCKS_DIRECTROUTE_FALLBACK
, 
isÁl£
Ë!
NULL
)

1568 
sockscf
.
›ti⁄
.
dúe˘ÁŒback
 = 0;

1570 
sockscf
.
›ti⁄
.
dúe˘ÁŒback
 = 1;

1572 i‡(
	`socks_gëív
(
ENV_SOCKS_DIRECTROUTE_FALLBACK
, 
i°rue
Ë!
NULL
)

1573 
sockscf
.
›ti⁄
.
dúe˘ÁŒback
 = 1;

1575 
sockscf
.
›ti⁄
.
dúe˘ÁŒback
 = 0;

1578 
sockscf
.
rouã›ti⁄s
.
maxÁû
 = 1;

1579 
sockscf
.
rouã›ti⁄s
.
badexpúe
 = (
time_t
)(
ROUTEBLACKLIST_SECONDS
);

1581 #i‡!
SOCKS_CLIENT


1582 
sockscf
.
›ti⁄
.
debug
 = 0;

1583 
sockscf
.
›ti⁄
.
kì∑live
 = 1;

1584 
sockscf
.
›ti⁄
.
ho°s_ac˚ss
 = 0;

1586 
sockscf
.
udpc⁄√˘d°
 = 1;

1588 
sockscf
.
timeout
.
c⁄√˘
 = 
SOCKD_CONNECTTIMEOUT
;

1589 
sockscf
.
timeout
.
√gŸüã
 = 
SOCKD_NEGOTIATETIMEOUT
;

1590 
sockscf
.
timeout
.
t˝io
 = 
SOCKD_IOTIMEOUT_TCP
;

1591 
sockscf
.
timeout
.
udpio
 = 
SOCKD_IOTIMEOUT_UDP
;

1592 
sockscf
.
timeout
.
t˝_fö_waô
 = 
SOCKD_FIN_WAIT_2_TIMEOUT
;

1594 
sockscf
.
exã∫Æ
.
rŸ©i⁄
 = 
ROTATION_NONE
;

1596 #i‡
HAVE_PAM


1597 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
∑m£rvi˚«me
, 
DEFAULT_PAMSERVICENAME
);

1600 #i‡
HAVE_BSDAUTH


1601 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
bsdauth°yÀ«me
, 
DEFAULT_BSDAUTHSTYLENAME
);

1604 #i‡
HAVE_GSSAPI


1605 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
gsßpi£rvi˚«me
, 
DEFAULT_GSSAPISERVICENAME
);

1606 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
gsßpikeyèb
, 
DEFAULT_GSSAPIKEYTAB
);

1609 #i‡
HAVE_LDAP


1610 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
ld≠keyèb
, 
DEFAULT_GSSAPIKEYTAB
);

1611 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
ld≠fûãr
, 
DEFAULT_LDAP_FILTER
);

1612 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
ld≠fûãr_AD
, 
DEFAULT_LDAP_FILTER_AD
);

1613 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
ld≠©åibuã
, 
DEFAULT_LDAP_ATTRIBUTE
);

1614 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
ld≠©åibuã_AD
, 
DEFAULT_LDAP_ATTRIBUTE_AD
);

1615 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
ld≠˚πfûe
, 
DEFAULT_LDAP_CACERTFILE
);

1616 
	`STRCPY_ASSERTSIZE
(
sockscf
.
°©e
.
ld≠˚π∑th
, 
DEFAULT_LDAP_CERTDBPATH
);

1619 #i‡
BAREFOOTD


1624 
sockscf
.
°©e
.
Æludpboun˚d
 = 1;

1628 
	}
}

	@lib/config_parse.c

1 
	~"comm⁄.h
"

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

4 
	#YYBYACC
 1

	)

5 
	#YYMAJOR
 1

	)

6 
	#YYMINOR
 9

	)

7 
	#YYLEX
 
	`yyÀx
()

	)

8 
	#YYEMPTY
 -1

	)

9 
	#yy˛órö
 (
yych¨
=(
YYEMPTY
))

	)

10 
	#yyîrok
 (
yyîrÊag
=0)

	)

11 
	#YYRECOVERING
(Ë(
yyîrÊag
!=0)

	)

12 
	#yy∑r£
 
socks_yy∑r£


	)

13 
	#yyÀx
 
socks_yyÀx


	)

14 
	#yyîr‹
 
socks_yyîr‹


	)

15 
	#yych¨
 
socks_yych¨


	)

16 
	#yyvÆ
 
socks_yyvÆ


	)

17 
	#yylvÆ
 
socks_yylvÆ


	)

18 
	#yydebug
 
socks_yydebug


	)

19 
	#yy√ºs
 
socks_yy√ºs


	)

20 
	#yyîrÊag
 
socks_yyîrÊag


	)

21 
	#yyss
 
socks_yyss


	)

22 
	#yys¶im
 
socks_yys¶im


	)

23 
	#yys•
 
socks_yys•


	)

24 
	#yyvs
 
socks_yyvs


	)

25 
	#yyv•
 
socks_yyv•


	)

26 
	#yy°acksize
 
socks_yy°acksize


	)

27 
	#yylhs
 
socks_yylhs


	)

28 
	#yyÀn
 
socks_yyÀn


	)

29 
	#yyde‰ed
 
socks_yyde‰ed


	)

30 
	#yydgŸo
 
socks_yydgŸo


	)

31 
	#yysödex
 
socks_yysödex


	)

32 
	#yyrödex
 
socks_yyrödex


	)

33 
	#yygödex
 
socks_yygödex


	)

34 
	#yyèbÀ
 
socks_yyèbÀ


	)

35 
	#yycheck
 
socks_yycheck


	)

36 
	#yy«me
 
socks_yy«me


	)

37 
	#yyruÀ
 
socks_yyruÀ


	)

38 
	#YYPREFIX
 "socks_yy"

	)

41 
	~"yacc⁄fig.h
"

43 c⁄° 
	grcsid
[] =

46 #i‡
HAVE_LIBWRAP
 && (!
SOCKS_CLIENT
)

47 
jmp_buf
 
t˝d_buf
;

50 
yyª°¨t
(
FILE
 *
Â
);

52 íum { 
	m‰om
, 
	mto
, 
	mboun˚
 } 
	taddªssc⁄ãxt_t
;

55 
ùaddr_ªquúes_√tmask
(c⁄° 
addªssc⁄ãxt_t
 
c⁄ãxt
,

56 c⁄° 
obje˘ty≥_t
 
obje˘ty≥
);

66 
addnumbî
(
size_t
 *
numbîc
, *
numbîv
[], c⁄° 
numbî
);

69 
addröô
(
ruÀaddr_t
 *
addr
, c⁄° 
√tmask_ªquúed
);

72 
gwaddröô
(
socksho°_t
 *
addr
);

75 
rouãöô
(
rouã_t
 *
rouã
);

77 #i‡
SOCKS_CLIENT


78 
∑r£˛õ¡ív
(*
havïroxy£rvî
);

85 *
£rvî°rög2gw°rög
(c⁄° *
£rvî
, c⁄° 
vîsi⁄
,

86 *
gw
, c⁄° 
size_t
 
gwsize
);

97 
	#Æ¨möô
()

	)

98 
	#SET_TCPOPTION
(
logobje˘
, 
Àvñ
, 
©å
)

	)

106 
po°_addruÀ
();

113 
¥e_addruÀ
(
ruÀ_t
 *
ruÀ
);

114 
¥e_addm⁄ô‹
(
m⁄ô‹_t
 *
m⁄ô‹
);

121 
ruÀöô
(
ruÀ_t
 *
ruÀ
);

122 
m⁄ô‹öô
(
m⁄ô‹_t
 *
m⁄ô‹
);

123 
Æ¨möô
();

125 
c⁄figuª_¥ivûeges
();

131 
checkugid
(
uid_t
 *
uid
, 
gid_t
 *
gid
, *
is£t
, c⁄° *
ty≥
);

133 
	#SET_TCPOPTION
(
t˝
, 
Àvñ
, 
©å
) \

135 (
t˝
)->
isc⁄figuªd
 = 1; \

137 (
t˝
)->
©å
 = 1; \

138 (
t˝
)->
	`__CONCAT
(
©å
, 
_logÀvñ
Ë
˛ogÀvñ
; \

139 }  0)

	)

145 
	#LOG_CMDLINE_OVERRIDE
(
«me
, 
√wvÆue
, 
ﬁdvÆue
, 
fmt
) \

147 
	`¶og
(
LOG_NOTICE
, \

148 "%s: %†comm™dlöêvÆuê\"" 
fmt
 "\" overrides " \

149 "c⁄fig-fûêvÆuê\"" 
fmt
 "\" set in file %s", \

150 
fun˘i⁄
, 
«me
, (
√wvÆue
), (
ﬁdvÆue
), 
sockscf
.
›ti⁄
.
c⁄figfûe
); \

151 }  0 )

	)

153 
	#CMDLINE_OVERRIDE
(
cmdlöe
, 
›ti⁄
) \

155 i‡((
cmdlöe
)->
debug_is£t
) { \

156 i‡((
›ti⁄
)->
debug
 !(
cmdlöe
)->debug) \

157 
	`LOG_CMDLINE_OVERRIDE
("debug", \

158 (
cmdlöe
)->
debug
, \

159 (
›ti⁄
)->
debug
, \

162 (
›ti⁄
)->
debug
 = (
cmdlöe
)->debug; \

163 (
›ti⁄
)->
debug_is£t
(
cmdlöe
)->debug_isset; \

165 }  0)

	)

169 
yylöío
;

170 *
yyãxt
;

171 
cuºíéexlöe
[];

172 
¥eviou¶exlöe
[];

174 c⁄° *
	gfun˘i⁄
 = "configparsing()";

180 *
	g©y≥
;

181 
	g∑rsögc⁄fig
;

187 #i‡!
SOCKS_CLIENT


188 
logty≥_t
 
	gﬁd_log
, 
	gﬁd_îæog
;

191 
	gÁûed_to_add_log
, 
	gÁûed_to_add_îæog
;

193 
	gadd_to_îæog
;

195 
obje˘ty≥_t
 
	gobje˘ty≥
;

198 #i‡!
SOCKS_CLIENT


199 
log•ecül_t
 *
	glog•ecül
;

200 
w¨n_¥Ÿocﬁ_t˝_›ti⁄s_t
 *
	gt˝›ti⁄s
;

202 
öãrÁ˚¥Ÿocﬁ_t
 *
	giÂrŸo
;

204 
m⁄ô‹_t
 
	gm⁄ô‹
;

205 
m⁄ô‹_if_t
 *
	gm⁄ô‹if
;

206 *
	gÆ¨mside
;

208 
	g˛ogÀvñ
;

210 
ruÀ_t
 
	gruÀ
;

212 
shmem_obje˘_t
 
	gss
;

213 
	g£ssi⁄_is£t
;

214 
shmem_obje˘_t
 
	gbw
;

215 
	gbw_is£t
;

220 *
	gho°id›ti⁄_is£t
;

222 *
	gnumbîv
;

223 
size_t
 
	gnumbîc
;

225 #i‡!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


226 *
	gho°ödex
;

229 
timeout_t
 *
	gtimeout
 = &
sockscf
.
timeout
;

231 
sockë›ti⁄_t
 
	gsockë›t
;

233 
£rvî°©e_t
 *
	g°©e
;

234 
rouã_t
 
	grouã
;

235 
socksho°_t
 
	ggw
;

237 
ruÀaddr_t
 
	g§c
;

238 
ruÀaddr_t
 
	gd°
;

239 
ruÀaddr_t
 
	gho°id
;

240 
ruÀaddr_t
 
	grdr_‰om
;

241 
ruÀaddr_t
 
	grdr_to
;

243 #i‡
BAREFOOTD


244 
ruÀaddr_t
 
	gboun˚to
;

247 
ruÀaddr_t
 *
	gruÀaddr
;

248 
exãnsi⁄_t
 *
	gexãnsi⁄
;

251 
ö_addr
 *
	gùv4
;

252 
ö_addr
 *
	g√tmask_v4
;

254 
ö6_addr
 *
	gùv6
;

255 *
	g√tmask_v6
;

256 
uöt32_t
 *
	gsc›eid_v6
;

258 
ö_addr
 *
	gùv™y
;

259 
ö_addr
 *
	g√tmask_v™y
;

261 
	g√tmask_ªquúed
;

265 *
	gdomaö
;

266 *
	gi‚ame
;

267 *
	guæ
;

269 
ö_p‹t_t
 *
	gp‹t_t˝
;

270 
ö_p‹t_t
 *
	gp‹t_udp
;

272 *
	gcmëhodv
;

273 
size_t
 *
	gcmëhodc
;

274 *
	gsmëhodv
;

275 
size_t
 *
	gsmëhodc
;

277 
›î©‹_t
 *
	g›î©‹
;

279 #i‡
HAVE_GSSAPI


280 *
	ggsßpi£rvi˚«me
;

281 *
	ggsßpikeyèb
;

282 
gsßpi_íc_t
 *
	ggsßpõn¸y±i⁄
;

285 #i‡!
SOCKS_CLIENT
 && 
HAVE_LDAP


286 
ld≠_t
 *
	gld≠
;

289 #i‡
DEBUG


290 
	#YYDEBUG
 1

	)

293 
	#ADDMETHOD
(
mëhod
, 
mëhodc
, 
mëhodv
) \

295 i‡(
	`mëhodis£t
((
mëhod
), (
mëhodv
), (
mëhodc
))) \

296 
	`yyw¨nx
("duplicate method: %s. Already set onÅhis methodline", \

297 
	`mëhod2°rög
((
mëhod
))); \

299 i‡((
mëhodc
Ë>
METHODS_KNOWN
) { \

300 
	`yyîr‹x
("too manyáuthmethods (%lu, max is %ld)", \

301 ()(
mëhodc
), ()
METHODS_KNOWN
); \

302 
	`SERRX
(
mëhodc
); \

308 
mëhod
) { \

309 
AUTHMETHOD_BSDAUTH
: \

310 i‡(!
HAVE_BSDAUTH
) \

311 
	`yyîr‹x_nﬁib
("bsdauth"); \

314 
AUTHMETHOD_GSSAPI
: \

315 i‡(!
HAVE_GSSAPI
) \

316 
	`yyîr‹x_nﬁib
("GSSAPI"); \

320 
AUTHMETHOD_RFC931
: \

321 i‡(!
HAVE_LIBWRAP
) \

322 
	`yyîr‹x_nﬁib
("libwrap"); \

325 
AUTHMETHOD_PAM_ANY
: \

326 
AUTHMETHOD_PAM_ADDRESS
: \

327 
AUTHMETHOD_PAM_USERNAME
: \

328 i‡(!
HAVE_PAM
) \

329 
	`yyîr‹x_nﬁib
("PAM"); \

334 
mëhodv
[(
mëhodc
)++] = 
mëhod
; \

336 } 0)

	)

338 
	#ASSIGN_NUMBER
(
numbî
, 
›
, 
checkagaö°
, 
obje˘
, 
issig√d
) \

340 i‡(!((
numbî
Ë
	`›
 (
checkagaö°
))) \

341 
	`yyîr‹x
("number (%lld) must be " #op " %lld (" #checkagainst ")", \

342 ()(
numbî
), ()(
checkagaö°
)); \

344 i‡(
issig√d
) { \

345 i‡(()(
numbî
Ë< 
	`mövÆueo·y≥
((
obje˘
))) \

346 
	`yyîr‹x
("number %lld isÅoo small. Minimum is %lld", \

347 ()
numbî
, 
	`mövÆueo·y≥
((
obje˘
))); \

349 i‡(()(
numbî
Ë> 
	`maxvÆueo·y≥
((
obje˘
))) \

350 
	`yyîr‹x
("number %lld isÅooÜarge. Maximum is %lld", \

351 ()
numbî
, 
	`maxvÆueo·y≥
((
obje˘
))); \

354 i‡(()(
numbî
Ë< 
	`umövÆueo·y≥
((
obje˘
))) \

355 
	`yyîr‹x
("number %llu isÅoo small. Minimum is %llu", \

356 ()
numbî
, 
	`umövÆueo·y≥
((
obje˘
)));\

358 i‡(()(
numbî
Ë> 
	`umaxvÆueo·y≥
((
obje˘
))) \

359 
	`yyîr‹x
("number %llu isÅooÜarge. Maximum is %llu", \

360 ()
numbî
, 
	`umaxvÆueo·y≥
((
obje˘
)));\

363 (
obje˘
Ë(
numbî
); \

364 } 0)

	)

366 
	#ASSIGN_PORTNUMBER
(
p‹äumbî
, 
obje˘
) \

369 
	`ASSIGN_NUMBER
(
p‹äumbî
, >=, 0, (
obje˘
), 0); \

370 
	`ASSIGN_NUMBER
(
p‹äumbî
, <=, 
IP_MAXPORT
, (
obje˘
), 0); \

372 (
obje˘
Ë
	`ht⁄s
((
ö_p‹t_t
)(
p‹äumbî
)); \

373 } 0)

	)

375 
	#ASSIGN_THROTTLE_SECONDS
(
numbî
, 
obj
, 
issig√d
) \

376 
	`ASSIGN_NUMBER
((
numbî
), >, 0, 
obj
, 
issig√d
)

	)

377 
	#ASSIGN_THROTTLE_CLIENTS
(
numbî
, 
obj
, 
issig√d
) \

378 
	`ASSIGN_NUMBER
((
numbî
), >, 0, 
obj
, 
issig√d
)

	)

379 
	#ASSIGN_MAXSESSIONS
(
numbî
, 
obj
, 
issig√d
) \

380 
	`ASSIGN_NUMBER
((
numbî
), >, 0, 
obj
, 
issig√d
)

	)

382 #i‚de‡
YYSTYPE_DEFINED


383 
	#YYSTYPE_DEFINED


	)

386 
uid_t
 
	muid
;

387 
gid_t
 
	mgid
;

388 } 
	muid
;

391 
vÆuëy≥_t
 
	mvÆuëy≥
;

392 c⁄° *
	mvÆuev
;

393 } 
	mîr‹
;

396 c⁄° *
	mﬁd«me
;

397 c⁄° *
	m√w«me
;

398 } 
	mdïªˇãd
;

400 *
	m°rög
;

401 
	mmëhod
;

402 
	mnumbî
;

403 } 
	tYYSTYPE
;

406 
	#ALARM
 257

	)

407 
	#ALARMTYPE_DATA
 258

	)

408 
	#ALARMTYPE_DISCONNECT
 259

	)

409 
	#ALARMIF_INTERNAL
 260

	)

410 
	#ALARMIF_EXTERNAL
 261

	)

411 
	#TCPOPTION_DISABLED
 262

	)

412 
	#ECN
 263

	)

413 
	#SACK
 264

	)

414 
	#TIMESTAMPS
 265

	)

415 
	#WSCALE
 266

	)

416 
	#MTU_ERROR
 267

	)

417 
	#CLIENTCOMPATIBILITY
 268

	)

418 
	#NECGSSAPI
 269

	)

419 
	#CLIENTRULE
 270

	)

420 
	#HOSTIDRULE
 271

	)

421 
	#SOCKSRULE
 272

	)

422 
	#COMPATIBILITY
 273

	)

423 
	#SAMEPORT
 274

	)

424 
	#DRAFT_5_05
 275

	)

425 
	#CONNECTTIMEOUT
 276

	)

426 
	#TCP_FIN_WAIT
 277

	)

427 
	#CPU
 278

	)

428 
	#MASK
 279

	)

429 
	#SCHEDULE
 280

	)

430 
	#CPUMASK_ANYCPU
 281

	)

431 
	#DEBUGGING
 282

	)

432 
	#DEPRECATED
 283

	)

433 
	#ERRORLOG
 284

	)

434 
	#LOGOUTPUT
 285

	)

435 
	#LOGFILE
 286

	)

436 
	#LOGTYPE_ERROR
 287

	)

437 
	#LOGTYPE_TCP_DISABLED
 288

	)

438 
	#LOGTYPE_TCP_ENABLED
 289

	)

439 
	#LOGIF_INTERNAL
 290

	)

440 
	#LOGIF_EXTERNAL
 291

	)

441 
	#ERRORVALUE
 292

	)

442 
	#EXTENSION
 293

	)

443 
	#BIND
 294

	)

444 
	#PRIVILEGED
 295

	)

445 
	#EXTERNAL_PROTOCOL
 296

	)

446 
	#INTERNAL_PROTOCOL
 297

	)

447 
	#EXTERNAL_ROTATION
 298

	)

448 
	#SAMESAME
 299

	)

449 
	#GROUPNAME
 300

	)

450 
	#HOSTID
 301

	)

451 
	#HOSTINDEX
 302

	)

452 
	#INTERFACE
 303

	)

453 
	#SOCKETOPTION_SYMBOLICVALUE
 304

	)

454 
	#INTERNAL
 305

	)

455 
	#EXTERNAL
 306

	)

456 
	#INTERNALSOCKET
 307

	)

457 
	#EXTERNALSOCKET
 308

	)

458 
	#IOTIMEOUT
 309

	)

459 
	#IOTIMEOUT_TCP
 310

	)

460 
	#IOTIMEOUT_UDP
 311

	)

461 
	#NEGOTIATETIMEOUT
 312

	)

462 
	#LIBWRAP_FILE
 313

	)

463 
	#LOGLEVEL
 314

	)

464 
	#SOCKSMETHOD
 315

	)

465 
	#CLIENTMETHOD
 316

	)

466 
	#METHOD
 317

	)

467 
	#METHODNAME
 318

	)

468 
	#NONE
 319

	)

469 
	#BSDAUTH
 320

	)

470 
	#GSSAPI
 321

	)

471 
	#PAM_ADDRESS
 322

	)

472 
	#PAM_ANY
 323

	)

473 
	#PAM_USERNAME
 324

	)

474 
	#RFC931
 325

	)

475 
	#UNAME
 326

	)

476 
	#MONITOR
 327

	)

477 
	#PROCESSTYPE
 328

	)

478 
	#PROC_MAXREQUESTS
 329

	)

479 
	#REALM
 330

	)

480 
	#REALNAME
 331

	)

481 
	#RESOLVEPROTOCOL
 332

	)

482 
	#REQUIRED
 333

	)

483 
	#SCHEDULEPOLICY
 334

	)

484 
	#SERVERCONFIG
 335

	)

485 
	#CLIENTCONFIG
 336

	)

486 
	#SOCKET
 337

	)

487 
	#CLIENTSIDE_SOCKET
 338

	)

488 
	#SNDBUF
 339

	)

489 
	#RCVBUF
 340

	)

490 
	#SOCKETPROTOCOL
 341

	)

491 
	#SOCKETOPTION_OPTID
 342

	)

492 
	#SRCHOST
 343

	)

493 
	#NODNSMISMATCH
 344

	)

494 
	#NODNSUNKNOWN
 345

	)

495 
	#CHECKREPLYAUTH
 346

	)

496 
	#USERNAME
 347

	)

497 
	#USER_PRIVILEGED
 348

	)

498 
	#USER_UNPRIVILEGED
 349

	)

499 
	#USER_LIBWRAP
 350

	)

500 
	#WORD__IN
 351

	)

501 
	#ROUTE
 352

	)

502 
	#VIA
 353

	)

503 
	#GLOBALROUTEOPTION
 354

	)

504 
	#BADROUTE_EXPIRE
 355

	)

505 
	#MAXFAIL
 356

	)

506 
	#PORT
 357

	)

507 
	#NUMBER
 358

	)

508 
	#BANDWIDTH
 359

	)

509 
	#BOUNCE
 360

	)

510 
	#BSDAUTHSTYLE
 361

	)

511 
	#BSDAUTHSTYLENAME
 362

	)

512 
	#COMMAND
 363

	)

513 
	#COMMAND_BIND
 364

	)

514 
	#COMMAND_CONNECT
 365

	)

515 
	#COMMAND_UDPASSOCIATE
 366

	)

516 
	#COMMAND_BINDREPLY
 367

	)

517 
	#COMMAND_UDPREPLY
 368

	)

518 
	#ACTION
 369

	)

519 
	#FROM
 370

	)

520 
	#TO
 371

	)

521 
	#GSSAPIENCTYPE
 372

	)

522 
	#GSSAPIENC_ANY
 373

	)

523 
	#GSSAPIENC_CLEAR
 374

	)

524 
	#GSSAPIENC_INTEGRITY
 375

	)

525 
	#GSSAPIENC_CONFIDENTIALITY
 376

	)

526 
	#GSSAPIENC_PERMESSAGE
 377

	)

527 
	#GSSAPIKEYTAB
 378

	)

528 
	#GSSAPISERVICE
 379

	)

529 
	#GSSAPISERVICENAME
 380

	)

530 
	#GSSAPIKEYTABNAME
 381

	)

531 
	#IPV4
 382

	)

532 
	#IPV6
 383

	)

533 
	#IPVANY
 384

	)

534 
	#DOMAINNAME
 385

	)

535 
	#IFNAME
 386

	)

536 
	#URL
 387

	)

537 
	#LDAPATTRIBUTE
 388

	)

538 
	#LDAPATTRIBUTE_AD
 389

	)

539 
	#LDAPATTRIBUTE_HEX
 390

	)

540 
	#LDAPATTRIBUTE_AD_HEX
 391

	)

541 
	#LDAPBASEDN
 392

	)

542 
	#LDAP_BASEDN
 393

	)

543 
	#LDAPBASEDN_HEX
 394

	)

544 
	#LDAPBASEDN_HEX_ALL
 395

	)

545 
	#LDAPCERTFILE
 396

	)

546 
	#LDAPCERTPATH
 397

	)

547 
	#LDAPPORT
 398

	)

548 
	#LDAPPORTSSL
 399

	)

549 
	#LDAPDEBUG
 400

	)

550 
	#LDAPDEPTH
 401

	)

551 
	#LDAPAUTO
 402

	)

552 
	#LDAPSEARCHTIME
 403

	)

553 
	#LDAPDOMAIN
 404

	)

554 
	#LDAP_DOMAIN
 405

	)

555 
	#LDAPFILTER
 406

	)

556 
	#LDAPFILTER_AD
 407

	)

557 
	#LDAPFILTER_HEX
 408

	)

558 
	#LDAPFILTER_AD_HEX
 409

	)

559 
	#LDAPGROUP
 410

	)

560 
	#LDAPGROUP_NAME
 411

	)

561 
	#LDAPGROUP_HEX
 412

	)

562 
	#LDAPGROUP_HEX_ALL
 413

	)

563 
	#LDAPKEYTAB
 414

	)

564 
	#LDAPKEYTABNAME
 415

	)

565 
	#LDAPDEADTIME
 416

	)

566 
	#LDAPSERVER
 417

	)

567 
	#LDAPSERVER_NAME
 418

	)

568 
	#LDAPSSL
 419

	)

569 
	#LDAPCERTCHECK
 420

	)

570 
	#LDAPKEEPREALM
 421

	)

571 
	#LDAPTIMEOUT
 422

	)

572 
	#LDAPCACHE
 423

	)

573 
	#LDAPCACHEPOS
 424

	)

574 
	#LDAPCACHENEG
 425

	)

575 
	#LDAPURL
 426

	)

576 
	#LDAP_URL
 427

	)

577 
	#LDAP_FILTER
 428

	)

578 
	#LDAP_ATTRIBUTE
 429

	)

579 
	#LDAP_CERTFILE
 430

	)

580 
	#LDAP_CERTPATH
 431

	)

581 
	#LIBWRAPSTART
 432

	)

582 
	#LIBWRAP_ALLOW
 433

	)

583 
	#LIBWRAP_DENY
 434

	)

584 
	#LIBWRAP_HOSTS_ACCESS
 435

	)

585 
	#LINE
 436

	)

586 
	#OPERATOR
 437

	)

587 
	#PAMSERVICENAME
 438

	)

588 
	#PROTOCOL
 439

	)

589 
	#PROTOCOL_TCP
 440

	)

590 
	#PROTOCOL_UDP
 441

	)

591 
	#PROTOCOL_FAKE
 442

	)

592 
	#PROXYPROTOCOL
 443

	)

593 
	#PROXYPROTOCOL_SOCKS_V4
 444

	)

594 
	#PROXYPROTOCOL_SOCKS_V5
 445

	)

595 
	#PROXYPROTOCOL_HTTP
 446

	)

596 
	#PROXYPROTOCOL_UPNP
 447

	)

597 
	#REDIRECT
 448

	)

598 
	#SENDSIDE
 449

	)

599 
	#RECVSIDE
 450

	)

600 
	#SERVICENAME
 451

	)

601 
	#SESSION_INHERITABLE
 452

	)

602 
	#SESSIONMAX
 453

	)

603 
	#SESSIONTHROTTLE
 454

	)

604 
	#SESSIONSTATE_KEY
 455

	)

605 
	#SESSIONSTATE_MAX
 456

	)

606 
	#SESSIONSTATE_THROTTLE
 457

	)

607 
	#RULE_LOG
 458

	)

608 
	#RULE_LOG_CONNECT
 459

	)

609 
	#RULE_LOG_DATA
 460

	)

610 
	#RULE_LOG_DISCONNECT
 461

	)

611 
	#RULE_LOG_ERROR
 462

	)

612 
	#RULE_LOG_IOOPERATION
 463

	)

613 
	#RULE_LOG_TCPINFO
 464

	)

614 
	#STATEKEY
 465

	)

615 
	#UDPPORTRANGE
 466

	)

616 
	#UDPCONNECTDST
 467

	)

617 
	#USER
 468

	)

618 
	#GROUP
 469

	)

619 
	#VERDICT_BLOCK
 470

	)

620 
	#VERDICT_PASS
 471

	)

621 
	#YES
 472

	)

622 
	#NO
 473

	)

623 
	#YYERRCODE
 256

	)

624 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

625 c⁄° 
	gsocks_yylhs
[] =

627 
socks_yylhs
[] =

678 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

679 c⁄° 
	gsocks_yyÀn
[] =

681 
socks_yyÀn
[] =

732 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

733 c⁄° 
	gsocks_yyde‰ed
[] =

735 
socks_yyde‰ed
[] =

815 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

816 c⁄° 
	gsocks_yydgŸo
[] =

818 
socks_yydgŸo
[] =

847 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

848 c⁄° 
	gsocks_yysödex
[] =

850 
socks_yysödex
[] =

929 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

930 c⁄° 
	gsocks_yyrödex
[] =

932 
socks_yyrödex
[] =

1011 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

1012 c⁄° 
	gsocks_yygödex
[] =

1014 
socks_yygödex
[] =

1043 
	#YYTABLESIZE
 4446

	)

1044 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

1045 c⁄° 
	gsocks_yyèbÀ
[] =

1047 
socks_yyèbÀ
[] =

1496 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

1497 c⁄° 
	gsocks_yycheck
[] =

1499 
socks_yycheck
[] =

1948 
	#YYFINAL
 3

	)

1949 #i‚de‡
YYDEBUG


1950 
	#YYDEBUG
 0

	)

1952 
	#YYMAXTOKEN
 473

	)

1953 #i‡
YYDEBUG


1954 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

1955 c⁄° * c⁄° 
	gsocks_yy«me
[] =

1957 *
socks_yy«me
[] =

2011 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

2012 c⁄° * c⁄° 
	gsocks_yyruÀ
[] =

2014 *
socks_yyruÀ
[] =

2480 #ifde‡
YYSTACKSIZE


2481 #unde‡
YYMAXDEPTH


2482 
	#YYMAXDEPTH
 
YYSTACKSIZE


	)

2484 #ifde‡
YYMAXDEPTH


2485 
	#YYSTACKSIZE
 
YYMAXDEPTH


	)

2487 
	#YYSTACKSIZE
 10000

	)

2488 
	#YYMAXDEPTH
 10000

	)

2491 
	#YYINITSTACKSIZE
 200

	)

2493 
	gyydebug
;

2494 
	gyy√ºs
;

2495 
	gyyîrÊag
;

2496 
	gyych¨
;

2497 *
	gyys•
;

2498 
YYSTYPE
 *
	gyyv•
;

2499 
YYSTYPE
 
	gyyvÆ
;

2500 
YYSTYPE
 
	gyylvÆ
;

2501 *
	gyyss
;

2502 *
	gyys¶im
;

2503 
YYSTYPE
 *
	gyyvs
;

2504 
	gyy°acksize
;

2507 
	#INTERACTIVE
 0

	)

2509 
FILE
 *
yyö
;

2511 
	gÀx_d‹e°¨t
;

2514 
	$∑r£c⁄fig
(
fûíame
)

2515 c⁄° *
fûíame
;

2517 c⁄° *
fun˘i⁄
 = "parseconfig()";

2518 
°©
 
°©buf
;

2519 
havec⁄fig
;

2521 #i‡
SOCKS_CLIENT


2522 
	`∑r£˛õ¡ív
(&
havec⁄fig
);

2524 i‡(
havec⁄fig
)

2528 
	`SASSERTX
(
	`pidismaömŸhî
(
sockscf
.
°©e
.
pid
));

2530 i‡(
sockscf
.
°©e
.
öôed
)

2532 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

2535 
yyö
 = 
	`f›í
(
fûíame
, "r");

2537 #i‡!
SOCKS_CLIENT


2538 i‡(
sockscf
.
°©e
.
öôed
)

2539 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

2542 i‡(
yyö
 =
NULL


2543 || (
	`°©
(
fûíame
, &
°©buf
Ë=0 && sètbuf.
°_size
 == 0)) {

2544 i‡(
yyö
 =
NULL
)

2545 
	`¶og
(
sockscf
.
°©e
.
öôed
 ? 
LOG_WARNING
 : 
LOG_ERR
,

2546 "%s: couldÇŸ o≥¿c⁄fig fûê%s", 
fun˘i⁄
, 
fûíame
);

2548 
	`¶og
((
sockscf
.
°©e
.
öôed
 || 
SOCKS_CLIENT
Ë? 
LOG_WARNING
 : 
LOG_ERR
,

2549 "%s: c⁄fig fûê%†i†em±y. NŸÖ¨sög", 
fun˘i⁄
, 
fûíame
);

2551 #i‡
SOCKS_CLIENT


2553 i‡(
yyö
 =
NULL
) {

2554 i‡(
sockscf
.
›ti⁄
.
dúe˘ÁŒback
)

2555 
	`¶og
(
LOG_DEBUG
,

2557 
fun˘i⁄
, 
fûíame
);

2559 
	`exô
(0);

2562 
	`¶og
(
LOG_DEBUG
, "%s:Émpty %s,ássuming direct fallback wanted",

2563 
fun˘i⁄
, 
fûíame
);

2565 
sockscf
.
›ti⁄
.
dúe˘ÁŒback
 = 1;

2568 
	`SASSERTX
(
sockscf
.
›ti⁄
.
dúe˘ÁŒback
 == 1);

2571 i‡(!
sockscf
.
°©e
.
öôed
)

2572 
	`sockdexô
(
EXIT_FAILURE
);

2580 
havec⁄fig
 = 0;

2583 #i‡
YYDEBUG


2584 
yydebug
 = 0;

2587 
yylöío
 = 1;

2588 
î∫o
 = 0;

2589 
havec⁄fig
 = 1;

2598 #i‡!
SOCKS_CLIENT


2599 
ﬁd_log
 = 
sockscf
.
log
;

2600 
ﬁd_îæog
 = 
sockscf
.
îæog
;

2603 
Áûed_to_add_îæog
 = 
Áûed_to_add_log
 = 0;

2605 
	`¶og
(
LOG_DEBUG
, "%s:Ö¨sög c⁄fig i¿fûê%s", 
fun˘i⁄
, 
fûíame
);

2607 
	`bzîo
(&
sockscf
.
log
, (sockscf.log));

2608 
	`bzîo
(&
sockscf
.
îæog
, (sockscf.errlog));

2610 
Àx_d‹e°¨t
 = 1;

2612 
∑rsögc⁄fig
 = 1;

2613 
	`yy∑r£
();

2614 
∑rsögc⁄fig
 = 0;

2616 #i‡!
SOCKS_CLIENT


2617 
	`CMDLINE_OVERRIDE
(&
sockscf
.
öôül
.
cmdlöe
, &sockscf.
›ti⁄
);

2619 #i‡!
HAVE_PRIVILEGES


2620 i‡(!
sockscf
.
°©e
.
öôed
) {

2624 i‡(
sockscf
.
uid
.
¥ivûeged_is£t
 && !sockscf.
›ti⁄
.
vîify⁄ly
) {

2634 
logty≥_t
 *
logv
[] = { &
sockscf
.
log
, &sockscf.
îæog
 };

2635 
size_t
 
i
;

2637 
i
 = 0; i < 
	`ELEMENTS
(
logv
); ++i) {

2638 
size_t
 
fi
;

2640 
fi
 = 0; fò< 
logv
[
i
]->
fûíoc
; ++fi) {

2641 i‡(
logv
[
i
]->
¸óãdv
[
fi
]) {

2642 
	`¶og
(
LOG_DEBUG
,

2644 
fun˘i⁄
,

2645 
logv
[
i
]->
‚amev
[
fi
],

2646 ()
sockscf
.
uid
.
¥ivûeged_uid
,

2647 ()
sockscf
.
uid
.
¥ivûeged_gid
);

2649 i‡(
	`fchown
(
logv
[
i
]->
fûíov
[
fi
],

2650 ()
sockscf
.
uid
.
¥ivûeged_uid
,

2651 ()
sockscf
.
uid
.
¥ivûeged_gid
) != 0)

2652 
	`£º
("%s: couldÇot fchown(2) createdÜogfile %sÅo "

2656 
fun˘i⁄
,

2657 
logv
[
i
]->
‚amev
[
fi
],

2658 ()
sockscf
.
uid
.
¥ivûeged_uid
,

2659 ()
sockscf
.
uid
.
¥ivûeged_gid
);

2667 i‡(
	`c⁄figuª_¥ivûeges
() != 0) {

2668 i‡(
sockscf
.
°©e
.
öôed
) {

2669 
	`sw¨n
("%s: couldÇotÑeinitializeÖrivilegesáfter SIGHUP. "

2671 
fun˘i⁄
);

2673 
sockscf
.
°©e
.
havïrivs
 = 0;

2676 
	`£º
("%s: couldÇŸ c⁄figuªÖrivûeges", 
fun˘i⁄
);

2681 i‡(
yyö
 !
NULL
)

2682 
	`f˛o£
(
yyö
);

2684 
î∫o
 = 0;

2685  
havec⁄fig
 ? 0 : -1;

2686 
	}
}

2689 
	$ùaddr_ªquúes_√tmask
(
c⁄ãxt
, 
obje˘ty≥
)

2690 c⁄° 
addªssc⁄ãxt_t
 
c⁄ãxt
;

2691 c⁄° 
obje˘ty≥_t
 
obje˘ty≥
;

2694 
obje˘ty≥
) {

2695 
obje˘_¸uÀ
:

2696 #i‡
HAVE_SOCKS_RULES


2702 
c⁄ãxt
) {

2703 
‰om
:

2706 
to
:

2709 
boun˚
:

2713 
	`SERRX
(
c⁄ãxt
);

2718 #i‡
HAVE_SOCKS_HOSTID


2719 
obje˘_hruÀ
:

2723 #i‡
HAVE_SOCKS_RULES


2724 
obje˘_§uÀ
:

2728 
obje˘_rouã
:

2729 
obje˘_m⁄ô‹
:

2733 
	`SERRX
(
obje˘ty≥
);

2739 
	}
}

2743 
	$addnumbî
(
numbîc
, 
numbîv
, 
numbî
)

2744 
size_t
 *
numbîc
;

2745 *
numbîv
[];

2746 c⁄° 
numbî
;

2748 c⁄° *
fun˘i⁄
 = "addnumber()";

2750 i‡((*
numbîv
 = 
	`ªÆloc
(*numbîv, (**numbîvË* ((*
numbîc
) + 1)))

2751 =
NULL
)

2752 
	`yyîr‹
("%s: couldÇotállocate %lu bytes of memory forádding "

2754 
fun˘i⁄
, ()((**
numbîv
Ë* ((*
numbîc
) + 1)),

2755 
numbî
);

2757 (*
numbîv
)[(*
numbîc
)++] = 
numbî
;

2758 
	}
}

2762 
	$addröô
(
addr
, 
_√tmask_ªquúed
)

2763 
ruÀaddr_t
 *
addr
;

2764 c⁄° 
_√tmask_ªquúed
;

2767 
©y≥
 = &
addr
->atype;

2769 
ùv4
 = &
addr
->addr.ùv4.
ù
;

2770 
√tmask_v4
 = &
addr
->addr.
ùv4
.
mask
;

2772 
ùv6
 = &
addr
->addr.ùv6.
ù
;

2773 
√tmask_v6
 = &
addr
->addr.
ùv6
.
maskbôs
;

2774 
sc›eid_v6
 = &
addr
->addr.
ùv6
.
sc›eid
;

2776 
ùv™y
 = &
addr
->addr.ùv™y.
ù
;

2777 
√tmask_v™y
 = &
addr
->addr.
ùv™y
.
mask
;

2779 i‡(!
_√tmask_ªquúed
) {

2780 
√tmask_v4
->
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

2781 *
√tmask_v6
 = 
IPV6_NETMASKBITS
;

2782 
√tmask_v™y
->
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

2785 
domaö
 = 
addr
->addr.domain;

2786 
i‚ame
 = 
addr
->addr.ifname;

2788 
p‹t_t˝
 = &
addr
->
p‹t
.
t˝
;

2789 
p‹t_udp
 = &
addr
->
p‹t
.
udp
;

2790 
›î©‹
 = &
addr
->operator;

2792 
√tmask_ªquúed
 = 
_√tmask_ªquúed
;

2793 
ruÀaddr
 = 
addr
;

2794 
	}
}

2797 
	$gwaddröô
(
addr
)

2798 
socksho°_t
 *
addr
;

2800 
›î©‹_t
 
›î©‹mem
;

2802 
√tmask_ªquúed
 = 0;

2804 
©y≥
 = &
addr
->atype;

2806 
ùv4
 = &
addr
->addr.ipv4;

2807 
ùv6
 = &
addr
->addr.ùv6.
ù
;

2808 
domaö
 = 
addr
->addr.domain;

2809 
i‚ame
 = 
addr
->addr.ifname;

2810 
uæ
 = 
addr
->addr.
uæ«me
;

2812 
p‹t_t˝
 = &
addr
->
p‹t
;

2813 
p‹t_udp
 = &
addr
->
p‹t
;

2814 
›î©‹
 = &
›î©‹mem
;

2815 
	}
}

2818 
	$rouãöô
(
rouã
)

2819 
rouã_t
 *
rouã
;

2821 
	`bzîo
(
rouã
, (*route));

2823 
°©e
 = &
rouã
->
gw
.state;

2824 
exãnsi⁄
 = &
°©e
->extension;

2826 
cmëhodv
 = 
°©e
->cmethodv;

2827 
cmëhodc
 = &
°©e
->cmethodc;

2828 
smëhodv
 = 
°©e
->smethodv;

2829 
smëhodc
 = &
°©e
->smethodc;

2831 #i‡
HAVE_GSSAPI


2832 
gsßpi£rvi˚«me
 = 
°©e
->gssapiservicename;

2833 
gsßpikeyèb
 = 
°©e
->gssapikeytab;

2834 
gsßpõn¸y±i⁄
 = &
°©e
->gssapiencryption;

2837 #i‡!
SOCKS_CLIENT
 && 
HAVE_LDAP


2838 
ld≠
 = &
°©e
->ldap;

2841 
	`bzîo
(&
§c
, (src));

2842 
	`bzîo
(&
d°
, (dst));

2843 
§c
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

2844 
d°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

2846 
	`bzîo
(&
gw
, (gw));

2847 
	`bzîo
(&
rdr_‰om
, (rdr_from));

2848 
	`bzîo
(&
ho°id
, (hostid));

2849 
	}
}

2852 #i‡
SOCKS_CLIENT


2854 
	$∑r£˛õ¡ív
(
havïroxy£rvî
)

2855 *
havïroxy£rvî
;

2857 c⁄° *
fun˘i⁄
 = "parseclientenv()";

2858 c⁄° *
Ârötf_îr‹
 = "couldÇot writeÅoÅmpfile usedÅo hold "

2860 
size_t
 
i
;

2861 
FILE
 *
Â
;

2862 *
p
, 
rdr_‰om
[512], 
exå¨ouãöfo
[(rdr_from) + ("\n")],

2863 
gw
[
MAXSOCKSHOSTLEN
 + ("Öort = 65535")];

2864 
fd
;

2869 #i‡
SOCKS_CLIENT


2870 
p
 = "yaccenv-client-XXXXXX";

2872 
p
 = "yaccenv-server-XXXXXX";

2875 i‡((
fd
 = 
	`socks_mklock
(
p
, 
NULL
, 0)) == -1)

2876 
	`yyîr‹
("socks_mklock(ËÁûedÅÿ¸óãÅmpfûêusög ba£ %s", 
p
);

2879 i‡((
fd
 = 
	`›í
("/tmp/dante-envfile",

2880 
O_CREAT
 | 
O_TRUNC
 | 
O_RDWR
,

2881 
S_IRUSR
 | 
S_IWUSR
)) == -1)

2882 
	`£º
("%s: couldÇŸ o≥¿fûe", 
fun˘i⁄
);

2885 i‡((
Â
 = 
	`fd›í
(
fd
, "r+")Ë=
NULL
)

2886 
	`£º
("%s: fd›í(fd %dËÁûed", 
fun˘i⁄
, 
fd
);

2888 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_LOGOUTPUT
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
)

2889 i‡(
	`Ârötf
(
Â
, "logouçut: %s\n", 
p
) == -1)

2890 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

2892 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_ERRLOGOUTPUT
, 
d⁄tˇª
)Ë!
NULL


2893 && *
p
 !
NUL
)

2894 i‡(
	`Ârötf
(
Â
, "îr‹log: %s\n", 
p
) == -1)

2895 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

2897 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_DEBUG
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
)

2898 i‡(
	`Ârötf
(
Â
, "debug: %s\n", 
p
) == -1)

2899 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

2901 *
rdr_‰om
 = 
NUL
;

2902 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_REDIRECT_FROM
, 
d⁄tˇª
)Ë!
NULL


2903 && *
p
 !
NUL
) {

2904 c⁄° *
¥efix
 = "redirect from";

2906 i‡(
	`°æí
(
¥efix
Ë+ såÀn(
p
Ë+ 1 > (
rdr_‰om
))

2907 
	`£º
("%s: %s value isÅooÜong. MaxÜength is %lu",

2908 
fun˘i⁄
,

2909 
ENV_SOCKS_REDIRECT_FROM
,

2910 ()(
rdr_‰om
Ë- (
	`°æí
(
¥efix
) + 1));

2912 
	`¢¥ötf
(
rdr_‰om
, ‘dr_‰om), "%s: %s\n", 
¥efix
, 
p
);

2915 
	`¢¥ötf
(
exå¨ouãöfo
, (extrarouteinfo),

2916 "%s", 
rdr_‰om
);

2923 *
havïroxy£rvî
 = 0;

2925 
i
 = 1;

2928 
«me
[(
ENV_SOCKS_ROUTE_
) + ("640")];

2930 
	`¢¥ötf
(
«me
, “ame), "%s%lu", 
ENV_SOCKS_ROUTE_
, ()
i
);

2932 i‡((
p
 = 
	`socks_gëív
(
«me
, 
d⁄tˇª
)Ë=
NULL
)

2935 i‡(*
p
 !
NUL
) {

2936 i‡(
	`Ârötf
(
Â
, "rouã { %†}\n", 
p
) == -1)

2937 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

2939 *
havïroxy£rvî
 = 1;

2942 ++
i
;

2945 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS4_SERVER
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

2946 i‡(
	`Ârötf
(
Â
,

2951 "}\n", 
	`£rvî°rög2gw°rög
(
p
, 
PROXY_SOCKS_V4
, 
gw
, (gw)),

2952 
exå¨ouãöfo
) == -1)

2953 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

2955 *
havïroxy£rvî
 = 1;

2958 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS5_SERVER
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

2959 i‡(
	`Ârötf
(
Â
,

2964 "}\n", 
	`£rvî°rög2gw°rög
(
p
, 
PROXY_SOCKS_V5
, 
gw
, (gw)),

2965 
exå¨ouãöfo
) == -1)

2966 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

2968 *
havïroxy£rvî
 = 1;

2971 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_SERVER
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

2972 i‡(
	`Ârötf
(
Â
,

2976 "}\n", 
	`£rvî°rög2gw°rög
(
p
, 
PROXY_SOCKS_V5
, 
gw
, (gw)),

2977 
exå¨ouãöfo
) == -1)

2978 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

2980 *
havïroxy£rvî
 = 1;

2983 i‡((
p
 = 
	`socks_gëív
(
ENV_HTTP_PROXY
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

2984 
sockaddr_°‹age
 
ß
;

2985 
gaõº
;

2986 
emsg
[512];

2988 i‡(
	`uæ°rög2sockaddr
(
p
, &
ß
, &
gaõº
, 
emsg
, ”msg)Ë=
NULL
)

2989 
	`£º
("%s: couldÇot convertÅo %sÅoán Internetáddress",

2990 
fun˘i⁄
, 
p
);

2992 i‡(
	`Ârötf
(
Â
,

2998 
	`sockaddr2°rög2
(&
ß
, 0, 
NULL
, 0),

2999 
	`¡ohs
(
	`GET_SOCKADDRPORT
(&
ß
)),

3000 
exå¨ouãöfo
)

3002 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3004 *
havïroxy£rvî
 = 1;

3007 i‡((
p
 = 
	`socks_gëív
(
ENV_UPNP_IGD
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

3008 i‡(
	`Ârötf
(
Â
,

3013 "}\n", 
p
, 
exå¨ouãöfo
) == -1)

3014 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3016 *
havïroxy£rvî
 = 1;

3024 i‡(
	`f£ek
(
Â
, 0, 
SEEK_SET
) != 0)

3025 
	`yyîr‹
("fseek(3) onÅmpfile usedÅo holdÉnvironment-settings failed");

3027 
yyö
 = 
Â
;

3029 
Àx_d‹e°¨t
 = 1;

3030 
∑rsögc⁄fig
 = 1;

3031 
p
 = 
sockscf
.
›ti⁄
.
c⁄figfûe
;

3032 
sockscf
.
›ti⁄
.
c⁄figfûe
 = "<generated socks.conf>";

3034 
	`yy∑r£
();

3036 
sockscf
.
›ti⁄
.
c⁄figfûe
 = 
p
;

3037 
∑rsögc⁄fig
 = 0;

3039 
	`f˛o£
(
Â
);

3041 i‡(
	`socks_gëív
(
ENV_SOCKS_AUTOADD_LANROUTES
, 
isÁl£
Ë=
NULL
) {

3045 
iÁddrs
 *
iÁp
;

3047 
	`¶og
(
LOG_DEBUG
, "%s:áuto-addög dúe˘Ñouã†f‹Ü™ ...", 
fun˘i⁄
);

3049 i‡(
	`gëiÁddrs
(&
iÁp
) == 0) {

3050 
comm™d_t
 
comm™ds
;

3051 
¥Ÿocﬁ_t
 
¥Ÿocﬁs
;

3052 
iÁddrs
 *
iÁ˚
;

3054 
	`bzîo
(&
comm™ds
, (commands));

3055 
	`bzîo
(&
¥Ÿocﬁs
, (protocols));

3057 
¥Ÿocﬁs
.
t˝
 = 1;

3058 
¥Ÿocﬁs
.
udp
 = 1;

3060 
comm™ds
.
c⁄√˘
 = 1;

3061 
comm™ds
.
ud∑ssocüã
 = 1;

3063 
iÁ˚
 = 
iÁp
; iÁ˚ !
NULL
; iÁ˚ = iÁ˚->
iÁ_√xt
)

3064 i‡(
iÁ˚
->
iÁ_addr
 !
NULL


3065 && 
iÁ˚
->
iÁ_addr
->
ß_Ámûy
 =
AF_INET
) {

3066 i‡(
iÁ˚
->
iÁ_√tmask
 =
NULL
) {

3067 
	`sw¨n
("interface %s missingÇetmask, skipping",

3068 
iÁ˚
->
iÁ_«me
);

3072 
	`socks_autﬂdd_dúe˘rouã
(&
comm™ds
,

3073 &
¥Ÿocﬁs
,

3074 
	`TOCSS
(
iÁ˚
->
iÁ_addr
),

3075 
	`TOCSS
(
iÁ˚
->
iÁ_√tmask
));

3078 
	`‰ìiÁddrs
(
iÁp
);

3082 
	`¶og
(
LOG_DEBUG
, "%s:ÇŸáuto-addög dúe˘Ñouã†f‹Ü™", 
fun˘i⁄
);

3083 
	}
}

3086 
	$£rvî°rög2gw°rög
(
£rvî°rög
, 
vîsi⁄
, 
gw
, 
gwsize
)

3087 c⁄° *
£rvî°rög
;

3088 c⁄° 
vîsi⁄
;

3089 *
gw
;

3090 c⁄° 
size_t
 
gwsize
;

3092 c⁄° *
fun˘i⁄
 = "serverstring2gwstring()";

3093 *
£p
, 
emsg
[256];

3095 i‡(
vîsi⁄
 !
PROXY_SOCKS_V4
 && vîsi⁄ !
PROXY_SOCKS_V5
)

3096  
gw
;

3098 i‡(
	`°æí
(
£rvî°rög
Ë>
gwsize
)

3099 
	`£ºx
("%s: value ofÖroxyserver (%s) set inÉnvironment isÅooÜong. "

3101 
fun˘i⁄
, 
£rvî°rög
, ()(
gwsize
 - 1));

3103 i‡((
£p
 = 
	`°ºchr
(
£rvî°rög
, ':')Ë!
NULL
 && *(£∞+ 1Ë!
NUL
) {

3104 
p‹t
;

3106 i‡((
p‹t
 = 
	`°rög2p‹äumbî
(
£p
 + 1, 
emsg
, (emsg))) == -1)

3107 
	`yyîr‹x
("%s: %s", 
fun˘i⁄
, 
emsg
);

3109 
	`mem˝y
(
gw
, 
£rvî°rög
, 
£p
 - serverstring);

3110 
	`¢¥ötf
(&
gw
[
£p
 - 
£rvî°rög
],

3111 
gwsize
 - (
£p
 - 
£rvî°rög
),

3113 (
ö_p‹t_t
)
p‹t
);

3116 
visbuf
[256];

3118 
	`yyîr‹x
("%s: couldÇot findÖortnumber in %s serverstring \"%s\"",

3119 
fun˘i⁄
,

3120 
	`¥oxy¥Ÿocﬁ2°rög
(
vîsi⁄
),

3121 
	`°r2vis
(
£p
 =
NULL
 ? 
£rvî°rög
 : sep,

3122 
	`°æí
(
£p
 =
NULL
 ? 
£rvî°rög
 : sep),

3123 
visbuf
,

3124 (
visbuf
)));

3127  
gw
;

3128 
	}
}

3133 
	$¥e_addruÀ
(
ruÀ
)

3134 
ruÀ_t
 *
ruÀ
;

3137 
ruÀ
->
§c
 = src;

3138 
ruÀ
->
d°
 = dst;

3140 #i‡
HAVE_SOCKS_HOSTID


3141 
ruÀ
->
ho°id
 = hostid;

3144 
ruÀ
->
rdr_‰om
 =Ñdr_from;

3145 
ruÀ
->
rdr_to
 =Ñdr_to;

3147 i‡(
£ssi⁄_is£t
) {

3148 i‡((
ruÀ
->
ss
 = 
	`mÆloc
((*ruÀ->ss))Ë=
NULL
)

3149 
	`yyîr‹
("failedÅo malloc(3) %lu bytes for session memory",

3150 ()(*
ruÀ
->
ss
));

3152 *
ruÀ
->
ss
 = ss;

3155 i‡(
bw_is£t
) {

3156 i‡((
ruÀ
->
bw
 = 
	`mÆloc
((*ruÀ->bw))Ë=
NULL
)

3157 
	`yyîr‹
("failedÅo malloc(3) %lu bytes for bw memory",

3158 ()(*
ruÀ
->
bw
));

3160 *
ruÀ
->
bw
 = bw;

3162 
	}
}

3166 
	$po°_addruÀ
()

3169 
timeout
 = &
sockscf
.timeout;

3170 
	}
}

3173 
	$ruÀöô
(
ruÀ
)

3174 
ruÀ_t
 *
ruÀ
;

3176 
	`bzîo
(
ruÀ
, (*rule));

3178 
ruÀ
->
löíumbî
 = 
yylöío
;

3180 #i‡
HAVE_SOCKS_HOSTID


3181 
ruÀ
->
ho°ödex
 = 
DEFAULT_HOSTINDEX
;

3182 
ho°ödex
 = &
ruÀ
->hostindex;

3184 
ruÀ
->
ho°id›ti⁄_is£t
 = 0;

3185 
ho°id›ti⁄_is£t
 = &
ruÀ
->hostidoption_isset;

3188 
°©e
 = &
ruÀ
->state;

3190 
cmëhodv
 = 
°©e
->cmethodv;

3191 
cmëhodc
 = &
°©e
->cmethodc;

3193 
smëhodv
 = 
°©e
->smethodv;

3194 
smëhodc
 = &
°©e
->smethodc;

3200 
timeout
 = &
ruÀ
->timeout;

3201 *
timeout
 = 
sockscf
.timeout;

3203 #i‡
HAVE_GSSAPI


3204 
gsßpi£rvi˚«me
 = 
°©e
->gssapiservicename;

3205 
gsßpikeyèb
 = 
°©e
->gssapikeytab;

3206 
gsßpõn¸y±i⁄
 = &
°©e
->gssapiencryption;

3209 #i‡
HAVE_LDAP


3210 
ld≠
 = &
°©e
->ldap;

3213 
	`bzîo
(&
§c
, (src));

3214 
	`bzîo
(&
d°
, (dst));

3215 
	`bzîo
(&
ho°id
, (hostid));

3217 
	`bzîo
(&
rdr_‰om
, (rdr_from));

3218 
	`bzîo
(&
rdr_to
, (rdr_to));

3220 #i‡
BAREFOOTD


3221 
	`bzîo
(&
boun˚to
, (bounceto));

3224 
ruÀ
->
bw_isöhîôabÀ
 =ÑuÀ->
ss_isöhîôabÀ
 = 1;

3226 
	`bzîo
(&
ss
, (ss));

3227 
	`bzîo
(&
bw
, (bw));

3229 
bw_is£t
 = 
£ssi⁄_is£t
 = 0;

3230 
bw
.
ty≥
 = 
SHMEM_BW
;

3231 
ss
.
ty≥
 = 
SHMEM_SS
;

3232 
	}
}

3235 
	$Æ¨möô
()

3237 
Æ¨mside_mem
;

3239 
Æ¨mside
 = &
Æ¨mside_mem
;

3240 *
Æ¨mside
 = 0;

3241 
	}
}

3244 
	$m⁄ô‹öô
(
m⁄ô‹
)

3245 
m⁄ô‹_t
 *
m⁄ô‹
;

3247 
Æ¨mside_mem
;

3249 
Æ¨mside
 = &
Æ¨mside_mem
;

3251 
	`bzîo
(
m⁄ô‹
, (*monitor));

3253 
m⁄ô‹
->
löíumbî
 = 
yylöío
;

3255 
°©e
 = &
m⁄ô‹
->state;

3257 #i‡
HAVE_SOCKS_HOSTID


3258 
m⁄ô‹
->
ho°ödex
 = 
DEFAULT_HOSTINDEX
;

3259 
ho°ödex
 = &
m⁄ô‹
->hostindex;

3261 
m⁄ô‹
->
ho°id›ti⁄_is£t
 = 0;

3262 
ho°id›ti⁄_is£t
 = &
m⁄ô‹
->hostidoption_isset;

3265 
	`bzîo
(&
§c
, (src));

3266 
	`bzîo
(&
d°
, (dst));

3267 
	`bzîo
(&
ho°id
, (hostid));

3269 i‡((
m⁄ô‹
->
m°©s
 = 
	`mÆloc
((*m⁄ô‹->m°©s))Ë=
NULL
)

3270 
	`yyîr‹
("failedÅo malloc(3) %lu bytes for monitor stats memory",

3271 ()(*
m⁄ô‹
->
m°©s
));

3273 
	`bzîo
(
m⁄ô‹
->
m°©s
, (*monitor->mstats));

3275 
m⁄ô‹
->
m°©s
->
ty≥
 = 
SHMEM_MONITOR
;

3276 
	}
}

3279 
	$¥e_addm⁄ô‹
(
m⁄ô‹
)

3280 
m⁄ô‹_t
 *
m⁄ô‹
;

3282 
m⁄ô‹
->
§c
 = src;

3283 
m⁄ô‹
->
d°
 = dst;

3285 #i‡
HAVE_SOCKS_HOSTID


3286 
m⁄ô‹
->
ho°id
 = hostid;

3288 
	}
}

3291 
	$c⁄figuª_¥ivûeges
()

3293 c⁄° *
fun˘i⁄
 = "configure_privileges()";

3294 
isfú°time
 = 1;

3296 i‡(
sockscf
.
›ti⁄
.
vîify⁄ly
)

3299 #i‡!
HAVE_PRIVILEGES


3300 
uid_t
 
uid
;

3301 
gid_t
 
gid
;

3303 
	`SASSERTX
(
sockscf
.
°©e
.
euid
 =(
uid
 = 
	`gëeuid
()));

3304 
	`SASSERTX
(
sockscf
.
°©e
.
egid
 =(
gid
 = 
	`gëegid
()));

3310 
	`checkugid
(&
sockscf
.
uid
.
¥ivûeged_uid
,

3311 &
sockscf
.
uid
.
¥ivûeged_gid
,

3312 &
sockscf
.
uid
.
¥ivûeged_is£t
,

3315 
	`checkugid
(&
sockscf
.
uid
.
u≈rivûeged_uid
,

3316 &
sockscf
.
uid
.
u≈rivûeged_gid
,

3317 &
sockscf
.
uid
.
u≈rivûeged_is£t
,

3320 #i‡
HAVE_LIBWRAP


3321 i‡(!
sockscf
.
uid
.
libwøp_is£t


3322 && 
sockscf
.
uid
.
u≈rivûeged_is£t
) {

3323 
sockscf
.
uid
.
libwøp_uid
 = sockscf.uid.
u≈rivûeged_uid
;

3324 
sockscf
.
uid
.
libwøp_gid
 = sockscf.uid.
u≈rivûeged_gid
;

3325 
sockscf
.
uid
.
libwøp_is£t
 = sockscf.uid.
u≈rivûeged_is£t
;

3328 
	`checkugid
(&
sockscf
.
uid
.
libwøp_uid
,

3329 &
sockscf
.
uid
.
libwøp_gid
,

3330 &
sockscf
.
uid
.
libwøp_is£t
,

3334 
	`SASSERTX
(
sockscf
.
°©e
.
euid
 =(
uid
 = 
	`gëeuid
()));

3335 
	`SASSERTX
(
sockscf
.
°©e
.
egid
 =(
gid
 = 
	`gëegid
()));

3339 i‡(
isfú°time
) {

3340 i‡(
	`sockd_öô¥ivs
() != 0) {

3341 
	`¶og
(
HAVE_PRIVILEGES
 ? 
LOG_INFO
 : 
LOG_WARNING
,

3343 
fun˘i⁄
,

3344 
	`°ªº‹
(
î∫o
),

3345 
	`gëeuid
() == 0 ?

3349 #i‡
HAVE_PRIVILEGES


3361 
isfú°time
 = 0;

3365 
	}
}

3368 
	$checkugid
(
uid
, 
gid
, 
is£t
, 
ty≥
)

3369 
uid_t
 *
uid
;

3370 
gid_t
 *
gid
;

3371 *
is£t
;

3372 c⁄° *
ty≥
;

3374 c⁄° *
fun˘i⁄
 = "checkugid()";

3376 
	`SASSERTX
(
sockscf
.
°©e
.
euid
 =
	`gëeuid
());

3377 
	`SASSERTX
(
sockscf
.
°©e
.
egid
 =
	`gëegid
());

3379 i‡(
sockscf
.
›ti⁄
.
vîify⁄ly
)

3382 i‡(!(*
is£t
)) {

3383 *
uid
 = 
sockscf
.
°©e
.
euid
;

3384 *
gid
 = 
sockscf
.
°©e
.
egid
;

3385 *
is£t
 = 1;

3390 i‡(*
uid
 !
sockscf
.
°©e
.
euid
) {

3391 i‡(
	`£ãuid
(*
uid
) != 0) {

3392 
	`sw¨n
("%s: couldÇot seteuid(2)Åo %s uid %lu",

3393 
fun˘i⁄
, 
ty≥
, ()*
uid
);

3398 ()
	`£ãuid
(0);

3400 i‡(
	`£ãuid
(
sockscf
.
°©e
.
euid
) != 0) {

3401 
	`sw¨n
("%s: couldÇotÑevertÅoÉuid %lu fromÉuid %lu",

3402 
fun˘i⁄
,

3403 ()
sockscf
.
°©e
.
euid
,

3404 ()
	`gëeuid
());

3405 
	`SWARN
(0);

3407 
sockscf
.
°©e
.
euid
 = 
	`gëeuid
();

3412 i‡(*
gid
 !
sockscf
.
°©e
.
egid
) {

3413 ()
	`£ãuid
(0);

3415 i‡(
	`£ãgid
(*
gid
) != 0) {

3416 
	`sw¨n
("%s: couldÇot setegid(2)Åo %s gid %lu",

3417 
fun˘i⁄
, 
ty≥
, ()*
gid
);

3422 ()
	`£ãuid
(0);

3424 i‡(
	`£ãgid
(
sockscf
.
°©e
.
egid
) != 0) {

3425 
	`sw¨n
("%s: couldÇotÑevertÅoÉgid %lu fromÉuid %lu",

3426 
fun˘i⁄
,

3427 ()
sockscf
.
°©e
.
egid
,

3428 ()
	`gëeuid
());

3429 
	`SWARN
(0);

3431 
sockscf
.
°©e
.
egid
 = 
	`gëegid
();

3435 i‡(
	`£ãuid
(
sockscf
.
°©e
.
euid
) != 0) {

3436 
	`sw¨n
("%s: couldÇotÑevertÅoÉuid %lu fromÉuid %lu",

3437 
fun˘i⁄
,

3438 ()
sockscf
.
°©e
.
euid
,

3439 ()
	`gëeuid
());

3440 
	`SWARN
(0);

3442 
sockscf
.
°©e
.
euid
 = 
	`gëeuid
();

3447 
	`SASSERTX
(
sockscf
.
°©e
.
euid
 =
	`gëeuid
());

3448 
	`SASSERTX
(
sockscf
.
°©e
.
egid
 =
	`gëegid
());

3451 
	}
}

3456 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

3457 
	$yygrow°ack
()

3459 
	$yygrow°ack
()

3462 
√wsize
, 
i
;

3463 *
√wss
;

3464 
YYSTYPE
 *
√wvs
;

3466 i‡((
√wsize
 = 
yy°acksize
) == 0)

3467 
√wsize
 = 
YYINITSTACKSIZE
;

3468 i‡(
√wsize
 >
YYMAXDEPTH
)

3470 i‡((
√wsize
 *2Ë> 
YYMAXDEPTH
)

3471 
√wsize
 = 
YYMAXDEPTH
;

3472 
i
 = 
yys•
 - 
yyss
;

3473 #ifde‡
SIZE_MAX


3474 
	#YY_SIZE_MAX
 
SIZE_MAX


	)

3476 
	#YY_SIZE_MAX
 0xffffffffU

	)

3478 i‡(
√wsize
 && 
YY_SIZE_MAX
 /Çewsizê<  *
√wss
)

3479 
baû
;

3480 
√wss
 = 
yyss
 ? (*)
	`ªÆloc
(yyss, 
√wsize
 *  *newss) :

3481 (*)
	`mÆloc
(
√wsize
 *  *
√wss
);

3482 i‡(
√wss
 =
NULL
)

3483 
baû
;

3484 
yyss
 = 
√wss
;

3485 
yys•
 = 
√wss
 + 
i
;

3486 i‡(
√wsize
 && 
YY_SIZE_MAX
 /Çewsizê<  *
√wvs
)

3487 
baû
;

3488 
√wvs
 = 
yyvs
 ? (
YYSTYPE
 *)
	`ªÆloc
(yyvs, 
√wsize
 *  *newvs) :

3489 (
YYSTYPE
 *)
	`mÆloc
(
√wsize
 *  *
√wvs
);

3490 i‡(
√wvs
 =
NULL
)

3491 
baû
;

3492 
yyvs
 = 
√wvs
;

3493 
yyv•
 = 
√wvs
 + 
i
;

3494 
yy°acksize
 = 
√wsize
;

3495 
yys¶im
 = 
yyss
 + 
√wsize
 - 1;

3497 
baû
:

3498 i‡(
yyss
)

3499 
	`‰ì
(
yyss
);

3500 i‡(
yyvs
)

3501 
	`‰ì
(
yyvs
);

3502 
yyss
 = 
yys•
 = 
NULL
;

3503 
yyvs
 = 
yyv•
 = 
NULL
;

3504 
yy°acksize
 = 0;

3506 
	}
}

3508 
	#YYABORT
 
yyab‹t


	)

3509 
	#YYREJECT
 
yyab‹t


	)

3510 
	#YYACCEPT
 
yyac˚±


	)

3511 
	#YYERROR
 
yyîæab


	)

3513 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

3514 
	$yy∑r£
()

3516 
	$yy∑r£
()

3519 
yym
, 
yyn
, 
yy°©e
;

3520 #i‡
YYDEBUG


3521 #i‡
	`deföed
(
__˝lu•lus
Ë|| deföed(
__STDC__
)

3522 c⁄° *
yys
;

3524 *
yys
;

3527 i‡((
yys
 = 
	`gëív
("YYDEBUG")))

3529 
yyn
 = *
yys
;

3530 i‡(
yyn
 >= '0' && yyn <= '9')

3531 
yydebug
 = 
yyn
 - '0';

3535 
yy√ºs
 = 0;

3536 
yyîrÊag
 = 0;

3537 
yych¨
 = (-1);

3539 i‡(
yyss
 =
NULL
 && 
	`yygrow°ack
()Ë
yyovîÊow
;

3540 
yys•
 = 
yyss
;

3541 
yyv•
 = 
yyvs
;

3542 *
yys•
 = 
yy°©e
 = 0;

3544 
yylo›
:

3545 i‡((
yyn
 = 
yyde‰ed
[
yy°©e
]Ë!0Ë
yyªdu˚
;

3546 i‡(
yych¨
 < 0)

3548 i‡((
yych¨
 = 
	`yyÀx
()) < 0) yychar = 0;

3549 #i‡
YYDEBUG


3550 i‡(
yydebug
)

3552 
yys
 = 0;

3553 i‡(
yych¨
 <
YYMAXTOKEN
Ë
yys
 = 
yy«me
[yychar];

3554 i‡(!
yys
) yys = "illegal-symbol";

3555 
	`¥ötf
("%sdebug: state %d,Ñeading %d (%s)\n",

3556 
YYPREFIX
, 
yy°©e
, 
yych¨
, 
yys
);

3560 i‡((
yyn
 = 
yysödex
[
yy°©e
]Ë&& (yy¿+
yych¨
) >= 0 &&

3561 
yyn
 <
YYTABLESIZE
 && 
yycheck
[yyn] =
yych¨
)

3563 #i‡
YYDEBUG


3564 i‡(
yydebug
)

3565 
	`¥ötf
("%sdebug: state %d, shiftingÅo state %d\n",

3566 
YYPREFIX
, 
yy°©e
, 
yyèbÀ
[
yyn
]);

3568 i‡(
yys•
 >
yys¶im
 && 
	`yygrow°ack
())

3570 
yyovîÊow
;

3572 *++
yys•
 = 
yy°©e
 = 
yyèbÀ
[
yyn
];

3573 *++
yyv•
 = 
yylvÆ
;

3574 
yych¨
 = (-1);

3575 i‡(
yyîrÊag
 > 0) --yyerrflag;

3576 
yylo›
;

3578 i‡((
yyn
 = 
yyrödex
[
yy°©e
]Ë&& (yy¿+
yych¨
) >= 0 &&

3579 
yyn
 <
YYTABLESIZE
 && 
yycheck
[yyn] =
yych¨
)

3581 
yyn
 = 
yyèbÀ
[yyn];

3582 
yyªdu˚
;

3584 i‡(
yyîrÊag
Ë
yyöªcovîy
;

3585 #i‡
	`deföed
(
löt
Ë|| deföed(
__GNUC__
)

3586 
yy√wîr‹
;

3588 
yy√wîr‹
:

3589 
	`yyîr‹
("syntaxÉrror");

3590 #i‡
	`deföed
(
löt
Ë|| deföed(
__GNUC__
)

3591 
yyîæab
;

3593 
yyîæab
:

3594 ++
yy√ºs
;

3595 
yyöªcovîy
:

3596 i‡(
yyîrÊag
 < 3)

3598 
yyîrÊag
 = 3;

3601 i‡((
yyn
 = 
yysödex
[*
yys•
]Ë&& (yy¿+
YYERRCODE
) >= 0 &&

3602 
yyn
 <
YYTABLESIZE
 && 
yycheck
[yyn] =
YYERRCODE
)

3604 #i‡
YYDEBUG


3605 i‡(
yydebug
)

3606 
	`¥ötf
("%sdebug: sèã %d,Éº‹Ñecovîy shi·ög\
 sèã %d\n", 
YYPREFIX
, *
yys•
, 
yyèbÀ
[
yyn
]);

3609 i‡(
yys•
 >
yys¶im
 && 
	`yygrow°ack
())

3611 
yyovîÊow
;

3613 *++
yys•
 = 
yy°©e
 = 
yyèbÀ
[
yyn
];

3614 *++
yyv•
 = 
yylvÆ
;

3615 
yylo›
;

3619 #i‡
YYDEBUG


3620 i‡(
yydebug
)

3621 
	`¥ötf
("%sdebug:ÉrrorÑecovery discarding state %d\n",

3622 
YYPREFIX
, *
yys•
);

3624 i‡(
yys•
 <
yyss
Ë
yyab‹t
;

3625 --
yys•
;

3626 --
yyv•
;

3632 i‡(
yych¨
 =0Ë
yyab‹t
;

3633 #i‡
YYDEBUG


3634 i‡(
yydebug
)

3636 
yys
 = 0;

3637 i‡(
yych¨
 <
YYMAXTOKEN
Ë
yys
 = 
yy«me
[yychar];

3638 i‡(!
yys
) yys = "illegal-symbol";

3639 
	`¥ötf
("%sdebug: state %d,ÉrrorÑecovery discardsÅoken %d (%s)\n",

3640 
YYPREFIX
, 
yy°©e
, 
yych¨
, 
yys
);

3643 
yych¨
 = (-1);

3644 
yylo›
;

3646 
yyªdu˚
:

3647 #i‡
YYDEBUG


3648 i‡(
yydebug
)

3649 
	`¥ötf
("%sdebug: state %d,Ñeducing byÑule %d (%s)\n",

3650 
YYPREFIX
, 
yy°©e
, 
yyn
, 
yyruÀ
[yyn]);

3652 
yym
 = 
yyÀn
[
yyn
];

3653 i‡(
yym
)

3654 
yyvÆ
 = 
yyv•
[1-
yym
];

3656 
	`mem£t
(&
yyvÆ
, 0,  yyval);

3657 
yyn
)

3662 #i‡!
SOCKS_CLIENT


3663 
exãnsi⁄
 = &
sockscf
.extension;

3669 { 
yyvÆ
.
°rög
 = 
NULL
; }

3673 { 
yyvÆ
.
°rög
 = 
NULL
; }

3678 i‡(!
	`addedsockë›ti⁄
(&
sockscf
.
sockë›ti⁄c
,

3679 &
sockscf
.
sockë›ti⁄v
,

3680 &
sockë›t
))

3681 
	`yyw¨n
("couldÇotádd socket option");

3687 #i‡!
SOCKS_CLIENT


3688 
t˝›ti⁄s
 = &
log•ecül
->
¥Ÿocﬁ
.
t˝
.
dißbÀd
;

3695 #i‡!
SOCKS_CLIENT


3696 
t˝›ti⁄s
 = &
log•ecül
->
¥Ÿocﬁ
.
t˝
.
íabÀd
;

3703 #i‡!
SOCKS_CLIENT


3705 
log•ecül
 = &
sockscf
.
öã∫Æ
.
log
;

3714 #i‡!
SOCKS_CLIENT


3716 
log•ecül
 = &
sockscf
.
exã∫Æ
.
log
;

3725 #i‡!
SOCKS_CLIENT


3727 
log•ecül
 = &
ruÀ
.
öã∫Æ
.
log
;

3736 #i‡!
SOCKS_CLIENT


3738 
log•ecül
 = &
ruÀ
.
exã∫Æ
.
log
;

3747 #i‡!
SOCKS_CLIENT


3748 
	`SASSERTX
(
yyv•
[0].
numbî
 >= 0);

3749 
	`SASSERTX
(
yyv•
[0].
numbî
 < 
MAXLOGLEVELS
);

3751 
˛ogÀvñ
 = 
yyv•
[0].
numbî
;

3758 #i‡!
SOCKS_CLIENT


3759 
	`SET_TCPOPTION
(
t˝›ti⁄s
, 
˛ogÀvñ
, 
e˙
);

3766 #i‡!
SOCKS_CLIENT


3767 
	`SET_TCPOPTION
(
t˝›ti⁄s
, 
˛ogÀvñ
, 
ßck
);

3774 #i‡!
SOCKS_CLIENT


3775 
	`SET_TCPOPTION
(
t˝›ti⁄s
, 
˛ogÀvñ
, 
time°amps
);

3782 #i‡!
SOCKS_CLIENT


3783 
	`SET_TCPOPTION
(
t˝›ti⁄s
, 
˛ogÀvñ
, 
wsˇÀ
);

3790 #i‡!
SOCKS_CLIENT


3792 i‡(
yyv•
[0].
îr‹
.
vÆuev
 =
NULL
)

3793 
	`yyw¨nx
("unknownÉrror symbol specified");

3795 
size_t
 *
ec
, 
ec_max
, 
i
;

3796 *
ev
;

3798 
yyv•
[0].
îr‹
.
vÆuëy≥
) {

3799 
VALUETYPE_ERRNO
:

3800 
ev
 = 
log•ecül
->
î∫o_logÀvñv
[
˛ogÀvñ
];

3801 
ec
 = &
log•ecül
->
î∫o_logÀvñc
[
˛ogÀvñ
];

3802 
ec_max
 = 
	`ELEMENTS
(
log•ecül
->
î∫o_logÀvñv
[
˛ogÀvñ
]);

3805 
VALUETYPE_GAIERR
:

3806 
ev
 = 
log•ecül
->
gaõº_logÀvñv
[
˛ogÀvñ
];

3807 
ec
 = &
log•ecül
->
gaõº_logÀvñc
[
˛ogÀvñ
];

3808 
ec_max
 = 
	`ELEMENTS
(
log•ecül
->
gaõº_logÀvñv
[
˛ogÀvñ
]);

3812 
	`SERRX
(
yyv•
[0].
îr‹
.
vÆuëy≥
);

3815 
i
 = 0; 
yyv•
[0].
îr‹
.
vÆuev
[i] != 0; ++i) {

3820 
size_t
 
j
;

3822 
j
 = 0; j < *
ec
; ++j) {

3823 i‡(
ev
[
j
] =
yyv•
[0].
îr‹
.
vÆuev
[
i
])

3827 i‡(
j
 < *
ec
)

3830 
	`SASSERTX
(*
ec
 < 
ec_max
);

3832 
ev
[(*
ec
)] = 
yyv•
[0].
îr‹
.
vÆuev
[
i
];

3833 ++(*
ec
);

3842 
	`yyîr‹x
("given keyword \"%s\" is deprecated. New keyword is %s. "

3844 
yyv•
[0].
dïªˇãd
.
ﬁd«me
, yyv•[0].dïªˇãd.
√w«me
, 
PRODUCT
);

3849 { 
obje˘ty≥
 = 
obje˘_rouã
; }

3853 { 
	`rouãöô
(&
rouã
); }

3858 
rouã
.
§c
 = src;

3859 
rouã
.
d°
 = dst;

3860 
rouã
.
gw
.
addr
 = gw;

3862 
rouã
.
rdr_‰om
 =Ñdr_from;

3864 
	`socks_addrouã
(&
rouã
, 1);

3869 { 
yyvÆ
.
°rög
 = 
NULL
; }

3874 
°©e
->
¥oxy¥Ÿocﬁ
.
socks_v4
 = 1;

3880 
°©e
->
¥oxy¥Ÿocﬁ
.
socks_v5
 = 1;

3886 
°©e
->
¥oxy¥Ÿocﬁ
.
hâp
 = 1;

3892 
°©e
->
¥oxy¥Ÿocﬁ
.
u≤p
 = 1;

3898 #i‡!
SOCKS_CLIENT


3899 i‡(
	`addlöked«me
(&
ruÀ
.
u£r
, 
yyv•
[0].
°rög
Ë=
NULL
)

3900 
	`yyîr‹
(
NOMEM
);

3907 #i‡!
SOCKS_CLIENT


3908 i‡(
	`addlöked«me
(&
ruÀ
.
group
, 
yyv•
[0].
°rög
Ë=
NULL
)

3909 
	`yyîr‹
(
NOMEM
);

3916 
	`yyw¨nx
("weáre currently considering deprecatingÅhe Dante-specific "

3920 
exãnsi⁄
->
böd
 = 1;

3926 #i‡!
SOCKS_CLIENT


3927 
iÂrŸo
->
ùv4
 = 1;

3933 
iÂrŸo
->
ùv6
 = 1;

3940 #i‡!
SOCKS_CLIENT


3941 #i‡
BAREFOOTD


3942 
	`yyîr‹x
("\"öã∫Æ:\" s≥cifiˇti⁄ i†nŸ u£d i¿%s", 
PRODUCT
);

3945 
öãrÁ˚¥Ÿocﬁ_t
 
iÂrŸozîo
;

3947 
	`bzîo
(&
iÂrŸozîo
, (ifprotozero));

3948 i‡(
	`memcmp
(&
iÂrŸozîo
,

3949 &
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
,

3950 (
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
)) == 0) {

3951 
	`¶og
(
LOG_DEBUG
, "%s:Çoáddress familiesÉxplicitlyÉnabled on "

3954 
fun˘i⁄
);

3956 
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
.
ùv4
 = sockscf.öã∫Æ.¥Ÿocﬁ.
ùv6
 = 1;

3959 
	`addöã∫Æ
(
ruÀaddr
, 
SOCKS_TCP
);

3966 #i‡!
SOCKS_CLIENT


3967 
ruÀaddr_t
 
mem
;

3968 
£rvít
 *
£rvi˚
;

3969 
£rvî°©e_t
 
°©emem
;

3971 
	`bzîo
(&
°©emem
, (statemem));

3972 
°©e
 = &
°©emem
;

3973 
°©e
->
¥Ÿocﬁ
.
t˝
 = 1;

3975 
	`bzîo
(&
log•ecül
, (logspecial));

3977 
	`bzîo
(&
mem
, (mem));

3978 
	`addröô
(&
mem
, 0);

3981 i‡((
£rvi˚
 = 
	`gë£rvby«me
("socks", "t˝")Ë=
NULL
)

3982 *
p‹t_t˝
 = 
	`ht⁄s
(
SOCKD_PORT
);

3984 *
p‹t_t˝
 = (
ö_p‹t_t
)
£rvi˚
->
s_p‹t
;

3991 #i‡!
SOCKS_CLIENT


3992 i‡(
sockscf
.
öã∫Æ
.
addrc
 > 0) {

3993 i‡(
sockscf
.
°©e
.
öôed
) {

4003 
	`log_öãrÁ˚¥Ÿocﬁ_£t_too_œã
(
INTERNALIF
);

4004 
	`exô
(1);

4008 
iÂrŸo
 = &
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
;

4015 #i‡!
SOCKS_CLIENT


4016 
	`addexã∫Æ
(
ruÀaddr
);

4023 #i‡!
SOCKS_CLIENT


4024 
ruÀaddr_t
 
mem
;

4025 
öãrÁ˚¥Ÿocﬁ_t
 
iÂrŸozîo
 = { 0 };

4027 
	`bzîo
(&
mem
, (mem));

4028 
	`addröô
(&
mem
, 0);

4030 i‡(
	`memcmp
(&
iÂrŸozîo
,

4031 &
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
,

4032 (
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
)) == 0) {

4033 
	`¶og
(
LOG_DEBUG
, "%s:Çoáddress familiesÉxplicitlyÉnabled on "

4036 
fun˘i⁄
);

4038 
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
.
ùv4
 = sockscf.exã∫Æ.¥Ÿocﬁ.
ùv6
 = 1;

4046 #i‡!
SOCKS_CLIENT


4047 i‡(
sockscf
.
exã∫Æ
.
addrc
 > 0) {

4048 
	`log_öãrÁ˚¥Ÿocﬁ_£t_too_œã
(
EXTERNALIF
);

4049 
	`sockdexô
(
EXIT_FAILURE
);

4052 
iÂrŸo
 = &
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
;

4059 #i‡!
SOCKS_CLIENT


4060 
sockscf
.
exã∫Æ
.
rŸ©i⁄
 = 
ROTATION_NONE
;

4066 
sockscf
.
exã∫Æ
.
rŸ©i⁄
 = 
ROTATION_SAMESAME
;

4072 
sockscf
.
exã∫Æ
.
rŸ©i⁄
 = 
ROTATION_ROUTE
;

4078 { 
yyvÆ
.
°rög
 = 
NULL
; }

4083 i‡(
yyv•
[0].
numbî
 < 0)

4084 
	`yyîr‹x
("maxÑoute fails canÇot beÇegative (%ld) Use \"0\"Åo "

4086 ()
yyv•
[0].
numbî
);

4088 
sockscf
.
rouã›ti⁄s
.
maxÁû
 = 
yyv•
[0].
numbî
;

4094 i‡(
yyv•
[0].
numbî
 < 0)

4095 
	`yyîr‹x
("route failureÉxpiryÅime canÇot beÇegative (%ld). "

4097 ()
yyv•
[0].
numbî
);

4099 
sockscf
.
rouã›ti⁄s
.
badexpúe
 = 
yyv•
[0].
numbî
;

4104 { 
add_to_îæog
 = 1; }

4108 { 
add_to_îæog
 = 0; }

4113 
p
;

4115 i‡((
add_to_îæog
 && 
Áûed_to_add_îæog
)

4116 || (!
add_to_îæog
 && 
Áûed_to_add_log
)) {

4117 
	`yyw¨nx
("nŸáddögÜogfûê\"%s\"", 
yyv•
[0].
°rög
);

4119 
	`¶og
(
LOG_ALERT
,

4125 
fun˘i⁄
, 
yyv•
[0].
°rög
);

4128 
p
 = 
	`socks_addlogfûe
(
add_to_îæog
 ? &
sockscf
.
îæog
 : &sockscf.
log
, 
yyv•
[0].
°rög
);

4130 #i‡!
SOCKS_CLIENT


4131 i‡(
sockscf
.
°©e
.
öôed
) {

4132 i‡(
p
 == -1) {

4133 i‡(
add_to_îæog
) {

4134 
sockscf
.
îæog
 = 
ﬁd_îæog
;

4135 
Áûed_to_add_îæog
 = 1;

4138 
sockscf
.
log
 = 
ﬁd_log
;

4139 
Áûed_to_add_log
 = 1;

4143 
	`sockd_‰ìlogobje˘
(
add_to_îæog
 ? &
ﬁd_îæog
 : &
ﬁd_log
, 1);

4144 
	`¶og
(
LOG_DEBUG
, "%s:áddedÜogfile \"%s\"Åo %s",

4145 
fun˘i⁄
, 
yyv•
[0].
°rög
, 
add_to_îæog
 ? "errlog" : "logoutput");

4149 i‡(
p
 == -1)

4150 
	`¶og
(
LOG_ALERT
, "%s: couldÇot (re)openÜogfile \"%s\": %s%s %s",

4151 
fun˘i⁄
,

4152 
yyv•
[0].
°rög
,

4153 
	`°ªº‹
(
î∫o
),

4154 
sockscf
.
°©e
.
öôed
 ?

4156 
sockscf
.
°©e
.
öôed
 ?

4160 i‡(
p
 == -1)

4164 
	`yyw¨n
("ÁûedÅÿaddÜogfûê%s", 
yyv•
[0].
°rög
);

4172 #i‡!
SOCKS_CLIENT


4173 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >=, 0, 
sockscf
.
chûd
.
maxªque°s
, 0);

4180 #i‡!
SOCKS_CLIENT


4181 #i‡
HAVE_PRIVILEGES


4182 
	`yyîr‹x
("userid-settingsÇot used onÖlatforms withÖrivileges");

4184 
sockscf
.
uid
.
¥ivûeged_uid
 = 
yyv•
[0].uid.uid;

4185 
sockscf
.
uid
.
¥ivûeged_gid
 = 
yyv•
[0].uid.
gid
;

4186 
sockscf
.
uid
.
¥ivûeged_is£t
 = 1;

4194 #i‡!
SOCKS_CLIENT


4195 #i‡
HAVE_PRIVILEGES


4196 
	`yyîr‹x
("userid-settingsÇot used onÖlatforms withÖrivileges");

4198 
sockscf
.
uid
.
u≈rivûeged_uid
 = 
yyv•
[0].uid.uid;

4199 
sockscf
.
uid
.
u≈rivûeged_gid
 = 
yyv•
[0].uid.
gid
;

4200 
sockscf
.
uid
.
u≈rivûeged_is£t
 = 1;

4208 #i‡
HAVE_LIBWRAP
 && (!
SOCKS_CLIENT
)

4210 #i‡
HAVE_PRIVILEGES


4211 
	`yyîr‹x
("userid-settingsÇot used onÖlatforms withÖrivileges");

4214 
sockscf
.
uid
.
libwøp_uid
 = 
yyv•
[0].uid.uid;

4215 
sockscf
.
uid
.
libwøp_gid
 = 
yyv•
[0].uid.
gid
;

4216 
sockscf
.
uid
.
libwøp_is£t
 = 1;

4220 
	`yyîr‹x_nﬁib
("libwrap");

4227 
∑sswd
 *
pw
;

4229 i‡((
pw
 = 
	`gëpw«m
(
yyv•
[0].
°rög
)Ë=
NULL
)

4230 
	`yyîr‹
("gëpw«m(3Ëßy†nÿsuch u£∏\"%s\"", 
yyv•
[0].
°rög
);

4232 
yyvÆ
.
uid
.uid = 
pw
->
pw_uid
;

4234 i‡((
pw
 = 
	`gëpwuid
(
yyvÆ
.
uid
.uid)Ë=
NULL
)

4235 
	`yyîr‹
("getpwuid(3) saysÇo such uid %lu (from user \"%s\")",

4236 ()
yyvÆ
.
uid
.uid, 
yyv•
[0].
°rög
);

4238 
yyvÆ
.
uid
.
gid
 = 
pw
->
pw_gid
;

4244 #i‡!
SOCKS_CLIENT


4245 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >=, 0, 
timeout
->
t˝io
, 1);

4246 
timeout
->
udpio
 =Åimeout->
t˝io
;

4252 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >=, 0, 
timeout
->
t˝io
, 1);

4258 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >=, 0, 
timeout
->
udpio
, 1);

4265 #i‡!
SOCKS_CLIENT


4266 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >=, 0, 
timeout
->
√gŸüã
, 1);

4273 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >=, 0, 
timeout
->
c⁄√˘
, 1);

4279 #i‡!
SOCKS_CLIENT


4280 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >=, 0, 
timeout
->
t˝_fö_waô
, 1);

4287 #i‡
SOCKS_CLIENT


4289 
sockscf
.
›ti⁄
.
debug
 = ()
yyv•
[0].
numbî
;

4293 i‡(
sockscf
.
öôül
.
cmdlöe
.
debug_is£t


4294 && 
sockscf
.
öôül
.
cmdlöe
.
debug
 !
yyv•
[0].
numbî
)

4295 
	`LOG_CMDLINE_OVERRIDE
("debug",

4296 
sockscf
.
öôül
.
cmdlöe
.
debug
,

4297 ()
yyv•
[0].
numbî
,

4300 
sockscf
.
›ti⁄
.
debug
 = ()
yyv•
[0].
numbî
;

4308 #i‡!
SOCKS_CLIENT


4309 #i‡
HAVE_LIBWRAP


4310 i‡((
ho°s_Ælow_èbÀ
 = 
	`°rdup
(
yyv•
[0].
°rög
)Ë=
NULL
)

4311 
	`yyîr‹
(
NOMEM
);

4313 
	`¶og
(
LOG_DEBUG
, "%s:Üibwøp.Ælow: %s", 
fun˘i⁄
, 
ho°s_Ælow_èbÀ
);

4315 
	`yyîr‹x_nﬁib
("libwrap");

4323 #i‡!
SOCKS_CLIENT


4324 #i‡
HAVE_LIBWRAP


4325 i‡((
ho°s_díy_èbÀ
 = 
	`°rdup
(
yyv•
[0].
°rög
)Ë=
NULL
)

4326 
	`yyîr‹
(
NOMEM
);

4328 
	`¶og
(
LOG_DEBUG
, "%s:Üibwøp.díy: %s", 
fun˘i⁄
, 
ho°s_díy_èbÀ
);

4330 
	`yyîr‹x_nﬁib
("libwrap");

4338 #i‡!
SOCKS_CLIENT


4339 #i‡
HAVE_LIBWRAP


4340 
sockscf
.
›ti⁄
.
ho°s_ac˚ss
 = 1;

4342 
	`yyîr‹x
("libwrap.hosts_accessÑequiresÜibwrapÜibrary");

4349 #i‡
HAVE_LIBWRAP


4350 
sockscf
.
›ti⁄
.
ho°s_ac˚ss
 = 0;

4352 
	`yyîr‹x_nﬁib
("libwrap");

4360 #i‡!
SOCKS_CLIENT


4361 
sockscf
.
udpc⁄√˘d°
 = 1;

4367 
sockscf
.
udpc⁄√˘d°
 = 0;

4374 #i‡!
SOCKS_CLIENT


4375 
sockscf
.
com∑t
.
ßmï‹t
 = 1;

4381 
sockscf
.
com∑t
.
dø·_5_05
 = 1;

4388 
sockscf
.
ªsﬁvïrŸocﬁ
 = 
RESOLVEPROTOCOL_FAKE
;

4394 #i‡
HAVE_NO_RESOLVESTUFF


4395 
	`yyîr‹x
("resolveprotocol keywordÇot supported onÅhis system");

4397 
sockscf
.
ªsﬁvïrŸocﬁ
 = 
RESOLVEPROTOCOL_TCP
;

4404 
sockscf
.
ªsﬁvïrŸocﬁ
 = 
RESOLVEPROTOCOL_UDP
;

4410 #i‡!
SOCKS_CLIENT


4411 #i‡!
HAVE_SCHED_SETSCHEDULER


4412 
	`yyîr‹x
("cpu schedulingÖolicy isÇot supported onÅhis system");

4414 
˝u£âög_t
 *
˝u£âög
;

4416 
yyv•
[-4].
numbî
) {

4417 
PROC_MOTHER
:

4418 
˝u£âög
 = &
sockscf
.
˝u
.
mŸhî
;

4421 
PROC_MONITOR
:

4422 
˝u£âög
 = &
sockscf
.
˝u
.
m⁄ô‹
;

4425 
PROC_NEGOTIATE
:

4426 
˝u£âög
 = &
sockscf
.
˝u
.
√gŸüã
;

4429 
PROC_REQUEST
:

4430 
˝u£âög
 = &
sockscf
.
˝u
.
ªque°
;

4433 
PROC_IO
:

4434 
˝u£âög
 = &
sockscf
.
˝u
.
io
;

4438 
	`SERRX
(
yyv•
[-4].
numbî
);

4441 
	`bzîo
(&
˝u£âög
->
∑øm
, (cpusetting->param));

4443 
˝u£âög
->
schedulög_is£t
 = 1;

4444 
˝u£âög
->
pﬁicy
 = 
yyv•
[-2].
numbî
;

4445 
˝u£âög
->
∑øm
.
sched_¥i‹ôy
 = ()
yyv•
[0].
numbî
;

4453 #i‡!
SOCKS_CLIENT


4454 #i‡!
HAVE_SCHED_SETAFFINITY


4455 
	`yyîr‹x
("cpu schedulingáffinity isÇot supported onÅhis system");

4457 
˝u£âög_t
 *
˝u£âög
;

4459 
yyv•
[-2].
numbî
) {

4460 
PROC_MOTHER
:

4461 
˝u£âög
 = &
sockscf
.
˝u
.
mŸhî
;

4464 
PROC_MONITOR
:

4465 
˝u£âög
 = &
sockscf
.
˝u
.
m⁄ô‹
;

4468 
PROC_NEGOTIATE
:

4469 
˝u£âög
 = &
sockscf
.
˝u
.
√gŸüã
;

4472 
PROC_REQUEST
:

4473 
˝u£âög
 = &
sockscf
.
˝u
.
ªque°
;

4476 
PROC_IO
:

4477 
˝u£âög
 = &
sockscf
.
˝u
.
io
;

4481 
	`SERRX
(
yyv•
[-2].
numbî
);

4484 
	`˝u_zîo
(&
˝u£âög
->
mask
);

4485 
numbîc
-- > 0)

4486 i‡(
numbîv
[
numbîc
] =
CPUMASK_ANYCPU
) {

4487 c⁄° 
˝us
 = 
	`sysc⁄f
(
_SC_NPROCESSORS_ONLN
);

4488 
i
;

4490 i‡(
˝us
 == -1)

4491 
	`yyîr‹
("sysconf(_SC_NPROCESSORS_ONLN) failed");

4493 
i
 = 0; i < 
˝us
; ++i)

4494 
	`˝u_£t
(()
i
, &
˝u£âög
->
mask
);

4496 i‡(
numbîv
[
numbîc
] < 0)

4497 
	`yyîr‹x
("invalid CPUÇumber: %ld. The CPUÇumber canÇot be "

4498 "√g©ive", ()
numbîv
[
numbîc
]);

4500 
	`˝u_£t
(
numbîv
[
numbîc
], &
˝u£âög
->
mask
);

4502 
	`‰ì
(
numbîv
);

4503 
numbîv
 = 
NULL
;

4504 
numbîc
 = 0;

4506 
˝u£âög
->
afföôy_is£t
 = 1;

4515 #i‡!
SOCKS_CLIENT


4516 
sockë›t
.
Àvñ
 = 
yyv•
[-1].
numbî
;

4523 #i‡!
SOCKS_CLIENT


4524 
sockë›t
.
›äame
 = 
yyv•
[0].
numbî
;

4525 
sockë›t
.
öfo
 = 
	`›tvÆ2sock›t
(sockë›t.
Àvñ
, sockë›t.
›äame
);

4527 i‡(
sockë›t
.
öfo
 =
NULL
)

4528 
	`¶og
(
LOG_DEBUG
,

4530 
fun˘i⁄
, 
sockë›t
.
Àvñ
, sockë›t.
›äame
);

4532 
	`sockë›ti⁄check
(&
sockë›t
);

4538 
sockë›t
.
öfo
 = 
	`›tid2sock›t
((
size_t
)
yyv•
[0].
numbî
);

4539 
	`SASSERTX
(
sockë›t
.
öfo
 !
NULL
);

4541 
sockë›t
.
›äame
 = sockë›t.
öfo
->
vÆue
;

4543 
	`sockë›ti⁄check
(&
sockë›t
);

4550 
sockë›t
.
›tvÆ
.
öt_vÆ
 = ()
yyv•
[0].
numbî
;

4551 
sockë›t
.
›ây≥
 = 
öt_vÆ
;

4557 c⁄° 
sock›tvÆsym_t
 *
p
;

4559 i‡(
sockë›t
.
öfo
 =
NULL
)

4560 
	`yyîr‹x
("the given socket option is unknown, so canÇotÜookup "

4563 i‡((
p
 = 
	`›tvÆ2vÆsym
(
sockë›t
.
öfo
->
›tid
, 
yyv•
[0].
°rög
)Ë=
NULL
)

4564 
	`yyîr‹x
("symbolic value \"%s\" is unknown for socket option %s",

4565 
yyv•
[0].
°rög
, 
	`sock›t2°rög
(&
sockë›t
, 
NULL
, 0));

4567 
sockë›t
.
›tvÆ
 = 
p
->
symvÆ
;

4568 
sockë›t
.
›ây≥
 = sockë›t.
öfo
->opttype;

4573 { 
	`bzîo
(&
sockë›t
, (socketopt));

4574 
sockë›t
.
isöã∫Æside
 = 1;

4579 { 
	`bzîo
(&
sockë›t
, (socketopt));

4580 
sockë›t
.
isöã∫Æside
 = 0;

4586 #i‡!
SOCKS_CLIENT


4587 
sockscf
.
§cho°
.
nodnsmism©ch
 = 1;

4593 
sockscf
.
§cho°
.
nodnsunknown
 = 1;

4599 
sockscf
.
§cho°
.
checkª∂yauth
 = 1;

4606 #i‡
COVENANT


4607 
	`STRCPY_CHECKLEN
(
sockscf
.
ªÆm«me
,

4608 
yyv•
[0].
°rög
,

4609 (
sockscf
.
ªÆm«me
) - 1,

4610 
yyîr‹x
);

4612 
	`yyîr‹x
("unknow¿keyw‹d \"%s\"", 
yyv•
[-2].
°rög
);

4619 #i‡!
SOCKS_CLIENT


4621 
cmëhodv
 = 
sockscf
.cmethodv;

4622 
cmëhodc
 = &
sockscf
.cmethodc;

4623 *
cmëhodc
 = 0;

4631 #i‡
HAVE_SOCKS_RULES


4633 
smëhodv
 = 
sockscf
.smethodv;

4634 
smëhodc
 = &
sockscf
.smethodc;

4635 *
smëhodc
 = 0;

4638 
	`yyîr‹x
("\"socksmethod\" isÇot used in %s. Only \"clientmethod\" "

4640 
PRODUCT
);

4647 i‡(
	`mëhodisvÆid
(
yyv•
[0].
mëhod
, 
obje˘_§uÀ
))

4648 
	`ADDMETHOD
(
yyv•
[0].
mëhod
, *
smëhodc
, 
smëhodv
);

4650 
	`yyîr‹x
("method %s (%d) isÇotá valid method for socksmethods",

4651 
	`mëhod2°rög
(
yyv•
[0].
mëhod
), yyvsp[0].method);

4657 i‡(
	`mëhodisvÆid
(
yyv•
[0].
mëhod
, 
obje˘_¸uÀ
))

4658 
	`ADDMETHOD
(
yyv•
[0].
mëhod
, *
cmëhodc
, 
cmëhodv
);

4660 
	`yyîr‹x
("method %s (%d) isÇotá valid method for clientmethods",

4661 
	`mëhod2°rög
(
yyv•
[0].
mëhod
), yyvsp[0].method);

4666 { 
obje˘ty≥
 = 
obje˘_m⁄ô‹
; }

4671 #i‡!
SOCKS_CLIENT


4672 
	`m⁄ô‹öô
(&
m⁄ô‹
);

4679 #i‡!
SOCKS_CLIENT


4680 
	`¥e_addm⁄ô‹
(&
m⁄ô‹
);

4682 
	`addm⁄ô‹
(&
m⁄ô‹
);

4688 { 
obje˘ty≥
 = 
obje˘_¸uÀ
; }

4693 #i‡!
SOCKS_CLIENT


4694 #i‡
BAREFOOTD


4695 i‡(
boun˚to
.
©y≥
 =
SOCKS_ADDR_NOTSET
) {

4696 i‡(
ruÀ
.
vîdi˘
 =
VERDICT_PASS
)

4697 
	`yyîr‹x
("noáddressÅraffic should bounceÅo has been given");

4703 
boun˚to
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

4704 
boun˚to
.
addr
.
ùv4
.
ù
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

4705 
boun˚to
.
p‹t
.
t˝
 = 
	`ht⁄s
(0);

4706 
boun˚to
.
p‹t
.
udp
 = 
	`ht⁄s
(0);

4710 
ruÀ
.
exåa
.
boun˚to
 = bounceto;

4713 
	`¥e_addruÀ
(&
ruÀ
);

4714 
	`add˛õ¡ruÀ
(&
ruÀ
);

4715 
	`po°_addruÀ
();

4722 #i‡!
SOCKS_CLIENT


4723 
m⁄ô‹if
 = 
NULL
;

4729 
m⁄ô‹if
 = &
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
;

4735 
m⁄ô‹if
 = &
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
;

4742 #i‡!
SOCKS_CLIENT


4743 
Æ¨mside
 = 
NULL
;

4749 *
Æ¨mside
 = 
RECVSIDE
;

4755 *
Æ¨mside
 = 
SENDSIDE
;

4761 { 
	`Æ¨möô
(); }

4766 #i‡!
SOCKS_CLIENT


4767 
Æ¨m_d©a_limô_t
 
limô
;

4769 
	`ASSIGN_NUMBER
(
yyv•
[-2].
numbî
, >=, 0, 
limô
.
byãs
, 0);

4770 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >, 0, 
limô
.
£c⁄ds
, 1);

4772 
m⁄ô‹
.
Æ¨msc⁄figuªd
 |
ALARM_DATA
;

4774 i‡(
m⁄ô‹
.
Æ¨m_d©a_aggªg©e
 != 0)

4775 
	`yyîr‹x
("oneággregated dataálarm hasálready been specified. "

4778 i‡(
m⁄ô‹if
 =
NULL
) {

4779 
m⁄ô‹
.
Æ¨m_d©a_aggªg©e
 = 
ALARM_INTERNAL
 | 
ALARM_EXTERNAL
;

4781 i‡(
Æ¨mside
 =
NULL
)

4782 
m⁄ô‹
.
Æ¨m_d©a_aggªg©e
 |
ALARM_RECV
 | 
ALARM_SEND
;

4784 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
RECVSIDE
) {

4785 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


4787 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
limô
 =Üimit;

4790 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
SENDSIDE
) {

4791 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd


4793 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
limô
 =Üimit;

4796 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
RECVSIDE
) {

4797 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


4799 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
limô
 =Üimit;

4802 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
SENDSIDE
) {

4803 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd


4805 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
limô
 =Üimit;

4809 i‡(
Æ¨mside
 =
NULL
)

4810 
m⁄ô‹
.
Æ¨m_d©a_aggªg©e
 = 
ALARM_RECV
 | 
ALARM_SEND
;

4812 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
RECVSIDE
) {

4813 
m⁄ô‹if
->
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
 = 1;

4814 
m⁄ô‹if
->
Æ¨m
.
d©a
.
ªcv
.
limô
 =Üimit;

4817 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
SENDSIDE
) {

4818 
m⁄ô‹if
->
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
 = 1;

4819 
m⁄ô‹if
->
Æ¨m
.
d©a
.
£nd
.
limô
 =Üimit;

4828 #i‡!
SOCKS_CLIENT


4829 
m⁄ô‹
.
Æ¨msc⁄figuªd
 |
ALARM_TEST
;

4831 i‡(
m⁄ô‹if
 =
NULL
) {

4832 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
ã°
.
mtu
.
dŸe°
 = 1;

4833 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
ã°
.
mtu
.
dŸe°
 = 1;

4836 
m⁄ô‹if
->
Æ¨m
.
ã°
.
mtu
.
dŸe°
 = 1;

4837 
m⁄ô‹if
->
Æ¨m
.
ã°
.
mtu
.
dŸe°
 = 1;

4845 #i‡!
SOCKS_CLIENT


4846 
Æ¨m_disc⁄√˘_limô_t
 
limô
;

4848 
	`ASSIGN_NUMBER
(
yyv•
[-1].
numbî
, >, 0, 
limô
.
£ssi⁄c
, 0);

4849 
	`ASSIGN_NUMBER
(
yyv•
[-3].
numbî
, >, 0, 
limô
.
disc⁄√˘c
, 0);

4850 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >, 0, 
limô
.
£c⁄ds
, 1);

4852 i‡(
m⁄ô‹
.
Æ¨m_disc⁄√˘_aggªg©e
 != 0)

4853 
	`yyîr‹x
("oneággregated disconnectálarm hasálready been specified. "

4856 
m⁄ô‹
.
Æ¨msc⁄figuªd
 |
ALARM_DISCONNECT
;

4858 i‡(
m⁄ô‹if
 =
NULL
) {

4859 
m⁄ô‹
.
Æ¨m_disc⁄√˘_aggªg©e
 = 
ALARM_INTERNAL
 | 
ALARM_EXTERNAL
;

4861 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
 = 1;

4862 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
 =Üimit;

4864 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
disc⁄√˘


4865 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
disc⁄√˘
;

4868 
m⁄ô‹if
->
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
 = 1;

4869 
m⁄ô‹if
->
Æ¨m
.
disc⁄√˘
.
limô
 =Üimit;

4877 #i‡!
SOCKS_CLIENT


4878 
yyvÆ
.
numbî
 = 
DEFAULT_ALARM_PERIOD
;

4884 { 
yyvÆ
.
numbî
 = 
yyv•
[0].number; }

4888 { *
ho°id›ti⁄_is£t
 = 1; }

4892 { 
yyvÆ
.
°rög
 = 
NULL
; }

4897 #i‡!
BAREFOOTD


4898 
	`yyîr‹x
("unsupported option");

4905 #i‡!
BAREFOOTD


4906 
	`yyîr‹x
("unsupported option");

4913 #i‡!
SOCKS_CLIENT


4914 
£ssi⁄_is£t
 = 1;

4920 { 
yyvÆ
.
°rög
 = 
NULL
; }

4924 { 
obje˘ty≥
 = 
obje˘_hruÀ
; }

4929 #i‡!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


4930 i‡(
ho°id
.
©y≥
 !
SOCKS_ADDR_NOTSET
)

4931 
	`yyîr‹x
("it doesÇot make senseÅo setÅhe hostidáddress iná "

4935 *
ho°id›ti⁄_is£t
 = 1;

4937 
	`¥e_addruÀ
(&
ruÀ
);

4938 
	`addho°idruÀ
(&
ruÀ
);

4939 
	`po°_addruÀ
();

4941 
	`yyîr‹x
("hostid isÇot supported onÅhis system");

4948 #i‡!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


4949 
	`addröô
(&
ho°id
, 1);

4952 
	`yyîr‹x
("hostid isÇot supported onÅhis system");

4960 #i‡!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


4961 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >=, 0, *
ho°ödex
, 0);

4962 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, <=, 
HAVE_MAX_HOSTIDS
, *
ho°ödex
, 0);

4965 
	`yyîr‹x
("hostid isÇot supported onÅhis system");

4971 { 
obje˘ty≥
 = 
obje˘_§uÀ
; }

4976 #i‡!
SOCKS_CLIENT


4977 #i‡!
HAVE_SOCKS_RULES


4978 
	`yyîr‹x
("socks-ruÀ†¨ênŸ u£d i¿%s", 
PRODUCT
);

4981 
	`¥e_addruÀ
(&
ruÀ
);

4982 
	`addsock§uÀ
(&
ruÀ
);

4983 
	`po°_addruÀ
();

4989 { 
yyvÆ
.
°rög
 = 
NULL
; }

4994 #i‡!
SOCKS_CLIENT


4995 
£ssi⁄_is£t
 = 1;

5002 #i‡!
SOCKS_CLIENT


5003 
	`checkmoduÀ
("bandwidth");

5004 
bw_is£t
 = 1;

5010 { *
ho°id›ti⁄_is£t
 = 1; }

5015 #i‡!
SOCKS_CLIENT


5016 
	`checkmoduÀ
("redirect");

5023 #i‡!
SOCKS_CLIENT


5024 i‡(
ruÀ
.
vîdi˘
 =
VERDICT_BLOCK
 && !
sockë›t
.
isöã∫Æside
)

5025 
	`yyîr‹x
("it doesÇot make senseÅo setá socket option forÅhe "

5030 i‡(
sockë›t
.
isöã∫Æside
)

5031 i‡(
sockë›t
.
öfo
 !
NULL
 && sockë›t.öfo->
ˇŒty≥
 =
¥e⁄ly
)

5032 
	`yyw¨nx
("to our knowledgeÅhe socket option \"%s\" can only be "

5036 
sockë›t
.
öfo
 =
NULL
 ? "unknown" :

5037 
sockë›t
.
öfo
->
«me
);

5039 i‡(!
	`addedsockë›ti⁄
(&
ruÀ
.
sockë›ti⁄c
,

5040 &
ruÀ
.
sockë›ti⁄v
,

5041 &
sockë›t
))

5042 
	`yyw¨n
("couldÇotádd socketoption");

5049 #i‡
SOCKS_SERVER


5050 #i‡
HAVE_LDAP
 && 
HAVE_OPENLDAP


5051 
ld≠
->
debug
 = ()
yyv•
[0].
numbî
;

5057 
ld≠
->
debug
 = ()-
yyv•
[0].
numbî
;

5059 
	`yyîr‹x_nﬁib
("openldap");

5067 #i‡
SOCKS_SERVER


5068 #i‡
HAVE_LDAP


5069 
	`STRCPY_CHECKLEN
(
°©e
->
ld≠
.
domaö
,

5070 
yyv•
[0].
°rög
,

5071 (
°©e
->
ld≠
.
domaö
) - 1,

5072 
yyîr‹x
);

5074 
	`yyîr‹x_nﬁib
("LDAP");

5082 #i‡
SOCKS_SERVER


5083 #i‡
HAVE_LDAP
 && 
HAVE_OPENLDAP


5084 
ld≠
->
mdïth
 = ()
yyv•
[0].
numbî
;

5086 
	`yyîr‹x_nﬁib
("openldap");

5094 #i‡
SOCKS_SERVER


5095 #i‡
HAVE_LDAP


5096 
	`STRCPY_CHECKLEN
(
°©e
->
ld≠
.
˚πfûe
,

5097 
yyv•
[0].
°rög
,

5098 (
°©e
->
ld≠
.
˚πfûe
) - 1,

5099 
yyîr‹x
);

5101 
	`yyîr‹x_nﬁib
("LDAP");

5109 #i‡
SOCKS_SERVER


5110 #i‡
HAVE_LDAP


5111 
	`STRCPY_CHECKLEN
(
°©e
->
ld≠
.
˚π∑th
,

5112 
yyv•
[0].
°rög
,

5113 (
°©e
->
ld≠
.
˚π∑th
) - 1,

5114 
yyîr‹x
);

5116 
	`yyîr‹x_nﬁib
("LDAP");

5124 #i‡
SOCKS_SERVER


5125 #i‡
HAVE_LDAP


5126 i‡(
	`addlöked«me
(&
°©e
->
ld≠
.
ld≠uæ
, 
yyv•
[0].
°rög
Ë=
NULL
)

5127 
	`yyîr‹
(
NOMEM
);

5129 
	`yyîr‹x_nﬁib
("LDAP");

5137 #i‡
SOCKS_SERVER


5138 #i‡
HAVE_LDAP


5139 i‡(
	`addlöked«me
(&
°©e
->
ld≠
.
ld≠ba£dn
, 
yyv•
[0].
°rög
Ë=
NULL
)

5140 
	`yyîr‹
(
NOMEM
);

5142 
	`yyîr‹x_nﬁib
("LDAP");

5150 #i‡
SOCKS_SERVER


5151 #i‡
HAVE_LDAP


5152 i‡(
	`addlöked«me
(&
°©e
->
ld≠
.
ld≠ba£dn
, 
	`hextoutf8
(
yyv•
[0].
°rög
, 0)Ë=
NULL
)

5153 
	`yyîr‹
(
NOMEM
);

5155 
	`yyîr‹x_nﬁib
("LDAP");

5163 #i‡
SOCKS_SERVER


5164 #i‡
HAVE_LDAP


5165 i‡(
	`addlöked«me
(&
°©e
->
ld≠
.
ld≠ba£dn
, 
	`hextoutf8
(
yyv•
[0].
°rög
, 1)Ë=
NULL
)

5166 
	`yyîr‹
(
NOMEM
);

5168 
	`yyîr‹x_nﬁib
("LDAP");

5176 #i‡
SOCKS_SERVER


5177 #i‡
HAVE_LDAP


5178 
ld≠
->
p‹t
 = ()
yyv•
[0].
numbî
;

5180 
	`yyîr‹x_nﬁib
("LDAP");

5188 #i‡
SOCKS_SERVER


5189 #i‡
HAVE_LDAP


5190 
ld≠
->
p‹ts¶
 = ()
yyv•
[0].
numbî
;

5192 
	`yyîr‹x_nﬁib
("LDAP");

5200 #i‡
SOCKS_SERVER


5201 #i‡
HAVE_LDAP


5202 
ld≠
->
s¶
 = 1;

5208 
ld≠
->
s¶
 = 0;

5210 
	`yyîr‹x_nﬁib
("LDAP");

5218 #i‡
SOCKS_SERVER


5219 #i‡
HAVE_LDAP


5220 
ld≠
->
auto_off
 = 1;

5226 
ld≠
->
auto_off
 = 0;

5228 
	`yyîr‹x_nﬁib
("LDAP");

5236 #i‡
SOCKS_SERVER


5237 #i‡
HAVE_LDAP


5238 
ld≠
->
˚πcheck
 = 1;

5244 
ld≠
->
˚πcheck
 = 0;

5246 
	`yyîr‹x_nﬁib
("LDAP");

5254 #i‡
SOCKS_SERVER


5255 #i‡
HAVE_LDAP


5256 
ld≠
->
kì¥ólm
 = 1;

5262 
ld≠
->
kì¥ólm
 = 0;

5264 
	`yyîr‹x_nﬁib
("LDAP");

5272 #i‡
SOCKS_SERVER


5273 #i‡
HAVE_LDAP


5274 
	`STRCPY_CHECKLEN
(
ld≠
->
fûãr
, 
yyv•
[0].
°rög
, (
°©e
->ld≠.fûãrË- 1, 
yyîr‹x
);

5276 
	`yyîr‹x_nﬁib
("LDAP");

5284 #i‡
SOCKS_SERVER


5285 #i‡
HAVE_LDAP


5286 
	`STRCPY_CHECKLEN
(
ld≠
->
fûãr_AD
,

5287 
yyv•
[0].
°rög
,

5288 (
°©e
->
ld≠
.
fûãr_AD
) - 1,

5289 
yyîr‹x
);

5292 
	`yyîr‹x_nﬁib
("LDAP");

5300 #i‡
SOCKS_SERVER


5301 #i‡
HAVE_LDAP


5302 
	`STRCPY_CHECKUTFLEN
(
ld≠
->
fûãr
,

5303 
yyv•
[0].
°rög
,

5304 (
°©e
->
ld≠
.
fûãr
) - 1,

5305 
yyîr‹x
);

5307 
	`yyîr‹x_nﬁib
("LDAP");

5315 #i‡
SOCKS_SERVER


5316 #i‡
HAVE_LDAP


5317 
	`STRCPY_CHECKUTFLEN
(
ld≠
->
fûãr_AD
,

5318 
yyv•
[0].
°rög
,

5319 (
°©e
->
ld≠
.
fûãr_AD
) - 1,

5320 
yyîr‹x
);

5322 
	`yyîr‹x_nﬁib
("LDAP");

5330 #i‡
SOCKS_SERVER


5331 #i‡
HAVE_LDAP


5332 
	`STRCPY_CHECKLEN
(
ld≠
->
©åibuã
,

5333 
yyv•
[0].
°rög
,

5334 (
°©e
->
ld≠
.
©åibuã
) - 1,

5335 
yyîr‹x
);

5338 
	`yyîr‹x_nﬁib
("LDAP");

5346 #i‡
SOCKS_SERVER


5347 #i‡
HAVE_LDAP


5348 
	`STRCPY_CHECKLEN
(
ld≠
->
©åibuã_AD
,

5349 
yyv•
[0].
°rög
,

5350 (
°©e
->
ld≠
.
©åibuã_AD
) - 1,

5351 
yyîr‹x
);

5353 
	`yyîr‹x_nﬁib
("LDAP");

5361 #i‡
SOCKS_SERVER


5362 #i‡
HAVE_LDAP


5363 
	`STRCPY_CHECKUTFLEN
(
ld≠
->
©åibuã
,

5364 
yyv•
[0].
°rög
,

5365 (
°©e
->
ld≠
.
©åibuã
) -1,

5366 
yyîr‹x
);

5368 
	`yyîr‹x_nﬁib
("LDAP");

5376 #i‡
SOCKS_SERVER


5377 #i‡
HAVE_LDAP


5378 
	`STRCPY_CHECKUTFLEN
(
ld≠
->
©åibuã_AD
,

5379 
yyv•
[0].
°rög
,

5380 (
°©e
->
ld≠
.
©åibuã_AD
) - 1,

5381 
yyîr‹x
);

5383 
	`yyîr‹x_nﬁib
("LDAP");

5391 #i‡
SOCKS_SERVER


5392 #i‡
HAVE_LDAP


5393 i‡(
	`addlöked«me
(&
ruÀ
.
ld≠group
, 
	`hextoutf8
(
yyv•
[0].
°rög
, 0)Ë=
NULL
)

5394 
	`yyîr‹
(
NOMEM
);

5396 
	`yyîr‹x_nﬁib
("LDAP");

5404 #i‡
SOCKS_SERVER


5405 #i‡
HAVE_LDAP


5406 
	`checkmoduÀ
("ldap");

5408 i‡(
	`addlöked«me
(&
ruÀ
.
ld≠group
, 
	`hextoutf8
(
yyv•
[0].
°rög
, 1)Ë=
NULL
)

5409 
	`yyîr‹
(
NOMEM
);

5411 
	`yyîr‹x_nﬁib
("LDAP");

5419 #i‡
SOCKS_SERVER


5420 #i‡
HAVE_LDAP


5421 
	`checkmoduÀ
("ldap");

5423 i‡(
	`addlöked«me
(&
ruÀ
.
ld≠group
, 
	`asciôoutf8
(
yyv•
[0].
°rög
)Ë=
NULL
)

5424 
	`yyîr‹
(
NOMEM
);

5426 
	`yyîr‹x_nﬁib
("LDAP");

5434 #i‡
SOCKS_SERVER


5435 #i‡
HAVE_LDAP


5436 i‡(
	`addlöked«me
(&
ruÀ
.
ld≠£rvî
, 
yyv•
[0].
°rög
Ë=
NULL
)

5437 
	`yyîr‹
(
NOMEM
);

5439 
	`yyîr‹x_nﬁib
("LDAP");

5447 #i‡
HAVE_LDAP


5448 #i‡
SOCKS_SERVER


5449 
	`STRCPY_CHECKLEN
(
°©e
->
ld≠
.
keyèb
,

5450 
yyv•
[0].
°rög
,

5451 (
°©e
->
ld≠
.
keyèb
Ë- 1, 
yyîr‹x
);

5453 
	`yyîr‹x
("ldap keytab onlyápplicableÅo Dante server");

5456 
	`yyîr‹x_nﬁib
("LDAP");

5463 #i‡
HAVE_GSSAPI


5464 
gsßpõn¸y±i⁄
->
√c
 = 1;

5466 
	`yyîr‹x_nﬁib
("GSSAPI");

5473 #i‡!
SOCKS_CLIENT


5474 
	`ruÀöô
(&
ruÀ
);

5475 
ruÀ
.
vîdi˘
 = 
VERDICT_BLOCK
;

5481 
	`ruÀöô
(&
ruÀ
);

5482 
ruÀ
.
vîdi˘
 = 
VERDICT_PASS
;

5489 
°©e
->
comm™d
.
böd
 = 1;

5495 
°©e
->
comm™d
.
c⁄√˘
 = 1;

5501 
°©e
->
comm™d
.
ud∑ssocüã
 = 1;

5507 
°©e
->
comm™d
.
bödª∂y
 = 1;

5513 
°©e
->
comm™d
.
ud¥ïly
 = 1;

5519 
°©e
->
¥Ÿocﬁ
.
t˝
 = 1;

5525 
°©e
->
¥Ÿocﬁ
.
udp
 = 1;

5531 #i‡!
SOCKS_CLIENT


5532 
ruÀ
.
ss_isöhîôabÀ
 = 1;

5538 
ruÀ
.
ss_isöhîôabÀ
 = 0;

5545 #i‡!
SOCKS_CLIENT


5546 
	`ASSIGN_MAXSESSIONS
(
yyv•
[0].
numbî
, 
ss
.
obje˘
.ss.
max
, 0);

5547 
ss
.
obje˘
.ss.
max
 = 
yyv•
[0].
numbî
;

5548 
ss
.
obje˘
.ss.
max_is£t
 = 1;

5555 #i‡!
SOCKS_CLIENT


5556 
	`ASSIGN_THROTTLE_SECONDS
(
yyv•
[-2].
numbî
, 
ss
.
obje˘
.ss.
thrŸée
.
limô
.
˛õ¡s
, 0);

5557 
	`ASSIGN_THROTTLE_CLIENTS
(
yyv•
[0].
numbî
, 
ss
.
obje˘
.ss.
thrŸée
.
limô
.
£c⁄ds
, 0);

5558 
ss
.
obje˘
.ss.
thrŸée_is£t
 = 1;

5565 #i‡!
SOCKS_CLIENT


5566 i‡((
ss
.
key°©e
.
key
 = 
	`°rög2°©ekey
(
yyv•
[0].
°rög
)Ë=
key_un£t
)

5567 
	`yyîr‹x
("%†i†nŸá vÆid sèã key", 
yyv•
[0].
°rög
);

5569 #i‡
HAVE_SOCKS_HOSTID


5570 i‡(
ss
.
key°©e
.
key
 =
key_ho°id
) {

5571 *
ho°id›ti⁄_is£t
 = 1;

5572 
ss
.
key°©e
.
keyöfo
.
ho°ödex
 = 
DEFAULT_HOSTINDEX
;

5578 
	`SERRX
(0);

5585 #i‡!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


5586 
ho°ödex
 = &
ss
.
key°©e
.
keyöfo
.hostindex;

5592 
ho°ödex
 = &
ruÀ
.hostindex;

5599 #i‡!
SOCKS_CLIENT


5600 
	`ASSIGN_MAXSESSIONS
(
yyv•
[0].
numbî
, 
ss
.
obje˘
.ss.
max_≥r°©e
, 0);

5601 
ss
.
obje˘
.ss.
max_≥r°©e_is£t
 = 1;

5608 #i‡!
SOCKS_CLIENT


5609 
	`ASSIGN_THROTTLE_SECONDS
(
yyv•
[-2].
numbî
, 
ss
.
obje˘
.ss.
thrŸée_≥r°©e
.
limô
.
˛õ¡s
, 0);

5610 
	`ASSIGN_THROTTLE_CLIENTS
(
yyv•
[0].
numbî
, 
ss
.
obje˘
.ss.
thrŸée_≥r°©e
.
limô
.
£c⁄ds
, 0);

5611 
ss
.
obje˘
.ss.
thrŸée_≥r°©e_is£t
 = 1;

5618 #i‡!
SOCKS_CLIENT


5619 
	`ASSIGN_NUMBER
(
yyv•
[0].
numbî
, >=, 0, 
bw
.
obje˘
.bw.
maxbps
, 0);

5620 
bw
.
obje˘
.bw.
maxbps_is£t
 = 1;

5627 #i‡!
SOCKS_CLIENT


5628 
ruÀ
.
log
.
c⁄√˘
 = 1;

5634 
ruÀ
.
log
.
d©a
 = 1;

5640 
ruÀ
.
log
.
disc⁄√˘
 = 1;

5646 
ruÀ
.
log
.
îr‹
 = 1;

5652 
ruÀ
.
log
.
io›î©i⁄
 = 1;

5658 
ruÀ
.
log
.
t˝öfo
 = 1;

5665 #i‡
HAVE_PAM
 && (!
SOCKS_CLIENT
)

5666 
	`STRCPY_CHECKLEN
(
°©e
->
∑m£rvi˚«me
,

5667 
yyv•
[0].
°rög
,

5668 (
°©e
->
∑m£rvi˚«me
) -1,

5669 
yyîr‹x
);

5671 
	`yyîr‹x_nﬁib
("PAM");

5678 #i‡
HAVE_BSDAUTH
 && 
SOCKS_SERVER


5679 
	`STRCPY_CHECKLEN
(
°©e
->
bsdauth°yÀ«me
,

5680 
yyv•
[0].
°rög
,

5681 (
°©e
->
bsdauth°yÀ«me
) - 1,

5682 
yyîr‹x
);

5684 
	`yyîr‹x_nﬁib
("bsdauth");

5691 #i‡
HAVE_GSSAPI


5692 
	`STRCPY_CHECKLEN
(
gsßpi£rvi˚«me
,

5693 
yyv•
[0].
°rög
,

5694 (
°©e
->
gsßpi£rvi˚«me
) - 1,

5695 
yyîr‹x
);

5697 
	`yyîr‹x_nﬁib
("GSSAPI");

5704 #i‡
HAVE_GSSAPI


5705 #i‡
SOCKS_SERVER


5706 
	`STRCPY_CHECKLEN
(
gsßpikeyèb
,

5707 
yyv•
[0].
°rög
,

5708 (
°©e
->
gsßpikeyèb
) - 1,

5709 
yyîr‹x
);

5711 
	`yyîr‹x
("gssapi keytab setting is onlyápplicableÅo Dante server");

5714 
	`yyîr‹x_nﬁib
("GSSAPI");

5721 #i‡
HAVE_GSSAPI


5722 
gsßpõn¸y±i⁄
->
˛ór
 = 1;

5723 
gsßpõn¸y±i⁄
->
öãgrôy
 = 1;

5724 
gsßpõn¸y±i⁄
->
c⁄fidítülôy
 = 1;

5730 
gsßpõn¸y±i⁄
->
˛ór
 = 1;

5736 
gsßpõn¸y±i⁄
->
öãgrôy
 = 1;

5742 
gsßpõn¸y±i⁄
->
c⁄fidítülôy
 = 1;

5748 
	`yyîr‹x
("gssapiÖer-messageÉncryptionÇot supported");

5750 
	`yyîr‹x_nﬁib
("GSSAPI");

5757 #i‡
HAVE_LIBWRAP
 && (!
SOCKS_CLIENT
)

5758 
ªque°_öfo
 
ªque°
;

5759 
tmp
[
LIBWRAPBUF
];

5760 
î∫o_s
, 
devnuŒ
;

5762 
	`STRCPY_CHECKLEN
(
ruÀ
.
libwøp
,

5763 
yyv•
[0].
°rög
,

5764 (
ruÀ
.
libwøp
) - 1,

5765 
yyîr‹x
);

5768 
	`STRCPY_ASSERTSIZE
(
tmp
, 
ruÀ
.
libwøp
);

5770 
devnuŒ
 = 
	`›í
("/dev/nuŒ", 
O_RDWR
, 0);

5771 ++
dry_run
;

5772 
î∫o_s
 = 
î∫o
;

5774 
î∫o
 = 0;

5776 
	`ªque°_öô
(&
ªque°
, 
RQ_FILE
, 
devnuŒ
, 
RQ_DAEMON
, 
__¥og«me
, 0);

5777 i‡(
	`£tjmp
(
t˝d_buf
) != 0)

5778 
	`yyîr‹
("badÜibwrapÜine");

5779 
	`¥o˚ss_›ti⁄s
(
tmp
, &
ªque°
);

5781 i‡(
î∫o
 != 0)

5782 
	`yyw¨n
("possibleÜibwrap/tcp-wrappersÑelated configurationÉrror");

5784 --
dry_run
;

5785 
	`˛o£
(
devnuŒ
);

5786 
î∫o
 = 
î∫o_s
;

5789 
	`yyîr‹x_nﬁib
("GSSAPI");

5797 #i‡
BAREFOOTD


5798 
	`yyîr‹x
("redirecting \"to\"ánáddress doesÇot makeány sense in %s. "

5801 
PRODUCT
);

5808 i‡(!
	`addedsockë›ti⁄
(&
rouã
.
sockë›ti⁄c
,

5809 &
rouã
.
sockë›ti⁄v
,

5810 &
sockë›t
))

5811 
	`yyw¨n
("couldÇotádd socketoption");

5816 { 
yyvÆ
.
°rög
 = 
NULL
; }

5821 
	`addröô
(&
§c
, 1);

5827 
	`addröô
(&
d°
, 
	`ùaddr_ªquúes_√tmask
(
to
, 
obje˘ty≥
));

5833 
	`addröô
(&
rdr_‰om
, 1);

5839 
	`addröô
(&
rdr_to
, 0);

5845 #i‡
BAREFOOTD


5846 
	`addröô
(&
boun˚to
, 0);

5853 
	`gwaddröô
(&
gw
);

5858 { i‡(!
√tmask_ªquúed
Ë
	`yyîr‹x_ha¢ëmask
(); }

5862 { i‡(
√tmask_ªquúed
Ë
	`yyîr‹x_n⁄ëmask
(); }

5866 { i‡(!
√tmask_ªquúed
Ë
	`yyîr‹x_ha¢ëmask
(); }

5870 { i‡(
√tmask_ªquúed
Ë
	`yyîr‹x_n⁄ëmask
(); }

5874 { i‡(!
√tmask_ªquúed
)

5875 
	`yyîr‹x_ha¢ëmask
(); }

5879 { i‡(
√tmask_ªquúed
Ë
	`yyîr‹x_n⁄ëmask
(); }

5888 *
©y≥
 = 
SOCKS_ADDR_IPV4
;

5890 i‡(
	`socks_öë_±⁄
(
AF_INET
, 
yyv•
[0].
°rög
, 
ùv4
, 
NULL
) != 1)

5891 
	`yyîr‹
("bad %s: %s", 
	`©y≥2°rög
(*
©y≥
), 
yyv•
[0].
°rög
);

5897 i‡(
yyv•
[0].
numbî
 < 0 || yyvsp[0].number > 32)

5898 
	`yyîr‹x
("bad %sÇetmask: %ld. LegalÑange is 0 - 32",

5899 
	`©y≥2°rög
(*
©y≥
), ()
yyv•
[0].
numbî
);

5901 
√tmask_v4
->
s_addr
 = 
yyv•
[0].
numbî
 =0 ? 0 : 
	`ht⁄l
(
IPV4_FULLNETMASK
 << (32 - yyvsp[0].number));

5907 i‡(
	`socks_öë_±⁄
(
AF_INET
, 
yyv•
[0].
°rög
, 
√tmask_v4
, 
NULL
) != 1)

5908 
	`yyîr‹
("bad %†√tmask: %s", 
	`©y≥2°rög
(*
©y≥
), 
yyv•
[0].
°rög
);

5914 *
©y≥
 = 
SOCKS_ADDR_IPV6
;

5916 i‡(
	`socks_öë_±⁄
(
AF_INET6
, 
yyv•
[0].
°rög
, 
ùv6
, 
sc›eid_v6
) != 1)

5917 
	`yyîr‹
("bad %s: %s", 
	`©y≥2°rög
(*
©y≥
), 
yyv•
[0].
°rög
);

5923 i‡(
yyv•
[0].
numbî
 < 0 || yyv•[0].numbî > 
IPV6_NETMASKBITS
)

5924 
	`yyîr‹x
("bad %sÇetmask: %d. LegalÑange is 0 - %d",

5925 
	`©y≥2°rög
(*
©y≥
), ()
yyv•
[0].
numbî
, 
IPV6_NETMASKBITS
);

5927 *
√tmask_v6
 = 
yyv•
[0].
numbî
;

5933 
	`SASSERTX
(
	`°rcmp
(
yyv•
[0].
°rög
, "0") == 0);

5935 *
©y≥
 = 
SOCKS_ADDR_IPVANY
;

5936 
ùv™y
->
s_addr
 = 
	`ht⁄l
(0);

5942 i‡(
yyv•
[0].
numbî
 != 0)

5943 
	`yyîr‹x
("bad %sÇetmask: %d. OnlyÜegal value is 0",

5944 
	`©y≥2°rög
(*
©y≥
), ()
yyv•
[0].
numbî
);

5946 
√tmask_v™y
->
s_addr
 = 
	`ht⁄l
(
yyv•
[0].
numbî
);

5952 *
©y≥
 = 
SOCKS_ADDR_DOMAIN
;

5953 
	`STRCPY_CHECKLEN
(
domaö
, 
yyv•
[0].
°rög
, 
MAXHOSTNAMELEN
 - 1, 
yyîr‹x
);

5959 *
©y≥
 = 
SOCKS_ADDR_IFNAME
;

5960 
	`STRCPY_CHECKLEN
(
i‚ame
, 
yyv•
[0].
°rög
, 
MAXIFNAMELEN
 - 1, 
yyîr‹x
);

5966 *
©y≥
 = 
SOCKS_ADDR_URL
;

5967 
	`STRCPY_CHECKLEN
(
uæ
, 
yyv•
[0].
°rög
, 
MAXURLLEN
 - 1, 
yyîr‹x
);

5972 { 
yyvÆ
.
numbî
 = 0; }

5976 { 
yyvÆ
.
numbî
 = 0; }

5981 i‡(
	`¡ohs
(*
p‹t_t˝
Ë>Çtohs(
ruÀaddr
->
p‹ãnd
))

5982 
	`yyîr‹x
("endÖort (%u) canÇot beÜessÅhan startÖort (%u)",

5983 
	`¡ohs
(*
p‹t_t˝
),Çtohs(
ruÀaddr
->
p‹ãnd
));

5989 
	`ASSIGN_PORTNUMBER
(
yyv•
[0].
numbî
, *
p‹t_t˝
);

5990 
	`ASSIGN_PORTNUMBER
(
yyv•
[0].
numbî
, *
p‹t_udp
);

5996 
	`ASSIGN_PORTNUMBER
(
yyv•
[0].
numbî
, 
ruÀaddr
->
p‹ãnd
);

5997 
ruÀaddr
->
›î©‹
 = 
ønge
;

6003 
£rvít
 *
£rvi˚
;

6005 i‡((
£rvi˚
 = 
	`gë£rvby«me
(
yyv•
[0].
°rög
, "t˝")Ë=
NULL
) {

6006 i‡(
°©e
->
¥Ÿocﬁ
.
t˝
)

6007 
	`yyîr‹x
("unknow¿t˝ÖrŸocﬁ: %s", 
yyv•
[0].
°rög
);

6009 *
p‹t_t˝
 = 
	`ht⁄s
(0);

6012 *
p‹t_t˝
 = (
ö_p‹t_t
)
£rvi˚
->
s_p‹t
;

6014 i‡((
£rvi˚
 = 
	`gë£rvby«me
(
yyv•
[0].
°rög
, "udp")Ë=
NULL
) {

6015 i‡(
°©e
->
¥Ÿocﬁ
.
udp
)

6016 
	`yyîr‹x
("unknow¿ud∞¥Ÿocﬁ: %s", 
yyv•
[0].
°rög
);

6018 *
p‹t_udp
 = 
	`ht⁄s
(0);

6021 *
p‹t_udp
 = (
ö_p‹t_t
)
£rvi˚
->
s_p‹t
;

6023 i‡(*
p‹t_t˝
 =
	`ht⁄s
(0Ë&& *
p‹t_udp
 == htons(0))

6024 
	`yyîr‹x
("unknownÅcp/udpÖrotocol");

6027 i‡(*
p‹t_t˝
 =
	`ht⁄s
(0))

6028 *
p‹t_t˝
 = *
p‹t_udp
;

6029 i‡(*
p‹t_udp
 =
	`ht⁄s
(0))

6030 *
p‹t_udp
 = *
p‹t_t˝
;

6032 
yyvÆ
.
numbî
 = (
size_t
)*
p‹t_udp
;

6038 *
›î©‹
 = 
	`°rög2›î©‹
(
yyv•
[0].
°rög
);

6044 #i‡
SOCKS_SERVER


6045 
	`ASSIGN_PORTNUMBER
(
yyv•
[0].
numbî
, 
ruÀ
.
ud¥™ge
.
°¨t
);

6052 #i‡
SOCKS_SERVER


6053 
	`ASSIGN_PORTNUMBER
(
yyv•
[0].
numbî
, 
ruÀ
.
ud¥™ge
.
íd
);

6054 
ruÀ
.
ud¥™ge
.
›
 = 
ønge
;

6056 i‡(
	`¡ohs
(
ruÀ
.
ud¥™ge
.
°¨t
Ë>Çtohs‘uÀ.ud¥™ge.
íd
))

6057 
	`yyîr‹x
("endÖort (%d) canÇot beÜessÅhan startÖort (%u)",

6058 ()
yyv•
[0].
numbî
, 
	`¡ohs
(
ruÀ
.
ud¥™ge
.
°¨t
));

6065 
	`addnumbî
(&
numbîc
, &
numbîv
, 
yyv•
[0].
numbî
);

6070 
yys•
 -
yym
;

6071 
yy°©e
 = *
yys•
;

6072 
yyv•
 -
yym
;

6073 
yym
 = 
yylhs
[
yyn
];

6074 i‡(
yy°©e
 =0 && 
yym
 == 0)

6076 #i‡
YYDEBUG


6077 i‡(
yydebug
)

6078 
	`¥ötf
("%sdebug:á·îÑedu˘i⁄, shi·ög from sèã 0Åo\
 %d\n", 
YYPREFIX
, 
YYFINAL
);

6081 
yy°©e
 = 
YYFINAL
;

6082 *++
yys•
 = 
YYFINAL
;

6083 *++
yyv•
 = 
yyvÆ
;

6084 i‡(
yych¨
 < 0)

6086 i‡((
yych¨
 = 
	`yyÀx
()) < 0) yychar = 0;

6087 #i‡
YYDEBUG


6088 i‡(
yydebug
)

6090 
yys
 = 0;

6091 i‡(
yych¨
 <
YYMAXTOKEN
Ë
yys
 = 
yy«me
[yychar];

6092 i‡(!
yys
) yys = "illegal-symbol";

6093 
	`¥ötf
("%sdebug: state %d,Ñeading %d (%s)\n",

6094 
YYPREFIX
, 
YYFINAL
, 
yych¨
, 
yys
);

6098 i‡(
yych¨
 =0Ë
yyac˚±
;

6099 
yylo›
;

6101 i‡((
yyn
 = 
yygödex
[
yym
]Ë&& (yy¿+
yy°©e
) >= 0 &&

6102 
yyn
 <
YYTABLESIZE
 && 
yycheck
[yyn] =
yy°©e
)

6103 
yy°©e
 = 
yyèbÀ
[
yyn
];

6105 
yy°©e
 = 
yydgŸo
[
yym
];

6106 #i‡
YYDEBUG


6107 i‡(
yydebug
)

6108 
	`¥ötf
("%sdebug:á·îÑedu˘i⁄, shi·ög from sèã %d \
 sèã %d\n", 
YYPREFIX
, *
yys•
, 
yy°©e
);

6111 i‡(
yys•
 >
yys¶im
 && 
	`yygrow°ack
())

6113 
yyovîÊow
;

6115 *++
yys•
 = 
yy°©e
;

6116 *++
yyv•
 = 
yyvÆ
;

6117 
yylo›
;

6118 
yyovîÊow
:

6119 
	`yyîr‹
("yacc stack overflow");

6120 
yyab‹t
:

6121 i‡(
yyss
)

6122 
	`‰ì
(
yyss
);

6123 i‡(
yyvs
)

6124 
	`‰ì
(
yyvs
);

6125 
yyss
 = 
yys•
 = 
NULL
;

6126 
yyvs
 = 
yyv•
 = 
NULL
;

6127 
yy°acksize
 = 0;

6129 
yyac˚±
:

6130 i‡(
yyss
)

6131 
	`‰ì
(
yyss
);

6132 i‡(
yyvs
)

6133 
	`‰ì
(
yyvs
);

6134 
yyss
 = 
yys•
 = 
NULL
;

6135 
yyvs
 = 
yyv•
 = 
NULL
;

6136 
yy°acksize
 = 0;

6138 
	}
}

	@lib/config_parse.h

1 
	#ALARM
 257

	)

2 
	#ALARMTYPE_DATA
 258

	)

3 
	#ALARMTYPE_DISCONNECT
 259

	)

4 
	#ALARMIF_INTERNAL
 260

	)

5 
	#ALARMIF_EXTERNAL
 261

	)

6 
	#TCPOPTION_DISABLED
 262

	)

7 
	#ECN
 263

	)

8 
	#SACK
 264

	)

9 
	#TIMESTAMPS
 265

	)

10 
	#WSCALE
 266

	)

11 
	#MTU_ERROR
 267

	)

12 
	#CLIENTCOMPATIBILITY
 268

	)

13 
	#NECGSSAPI
 269

	)

14 
	#CLIENTRULE
 270

	)

15 
	#HOSTIDRULE
 271

	)

16 
	#SOCKSRULE
 272

	)

17 
	#COMPATIBILITY
 273

	)

18 
	#SAMEPORT
 274

	)

19 
	#DRAFT_5_05
 275

	)

20 
	#CONNECTTIMEOUT
 276

	)

21 
	#TCP_FIN_WAIT
 277

	)

22 
	#CPU
 278

	)

23 
	#MASK
 279

	)

24 
	#SCHEDULE
 280

	)

25 
	#CPUMASK_ANYCPU
 281

	)

26 
	#DEBUGGING
 282

	)

27 
	#DEPRECATED
 283

	)

28 
	#ERRORLOG
 284

	)

29 
	#LOGOUTPUT
 285

	)

30 
	#LOGFILE
 286

	)

31 
	#LOGTYPE_ERROR
 287

	)

32 
	#LOGTYPE_TCP_DISABLED
 288

	)

33 
	#LOGTYPE_TCP_ENABLED
 289

	)

34 
	#LOGIF_INTERNAL
 290

	)

35 
	#LOGIF_EXTERNAL
 291

	)

36 
	#ERRORVALUE
 292

	)

37 
	#EXTENSION
 293

	)

38 
	#BIND
 294

	)

39 
	#PRIVILEGED
 295

	)

40 
	#EXTERNAL_PROTOCOL
 296

	)

41 
	#INTERNAL_PROTOCOL
 297

	)

42 
	#EXTERNAL_ROTATION
 298

	)

43 
	#SAMESAME
 299

	)

44 
	#GROUPNAME
 300

	)

45 
	#HOSTID
 301

	)

46 
	#HOSTINDEX
 302

	)

47 
	#INTERFACE
 303

	)

48 
	#SOCKETOPTION_SYMBOLICVALUE
 304

	)

49 
	#INTERNAL
 305

	)

50 
	#EXTERNAL
 306

	)

51 
	#INTERNALSOCKET
 307

	)

52 
	#EXTERNALSOCKET
 308

	)

53 
	#IOTIMEOUT
 309

	)

54 
	#IOTIMEOUT_TCP
 310

	)

55 
	#IOTIMEOUT_UDP
 311

	)

56 
	#NEGOTIATETIMEOUT
 312

	)

57 
	#LIBWRAP_FILE
 313

	)

58 
	#LOGLEVEL
 314

	)

59 
	#SOCKSMETHOD
 315

	)

60 
	#CLIENTMETHOD
 316

	)

61 
	#METHOD
 317

	)

62 
	#METHODNAME
 318

	)

63 
	#NONE
 319

	)

64 
	#BSDAUTH
 320

	)

65 
	#GSSAPI
 321

	)

66 
	#PAM_ADDRESS
 322

	)

67 
	#PAM_ANY
 323

	)

68 
	#PAM_USERNAME
 324

	)

69 
	#RFC931
 325

	)

70 
	#UNAME
 326

	)

71 
	#MONITOR
 327

	)

72 
	#PROCESSTYPE
 328

	)

73 
	#PROC_MAXREQUESTS
 329

	)

74 
	#REALM
 330

	)

75 
	#REALNAME
 331

	)

76 
	#RESOLVEPROTOCOL
 332

	)

77 
	#REQUIRED
 333

	)

78 
	#SCHEDULEPOLICY
 334

	)

79 
	#SERVERCONFIG
 335

	)

80 
	#CLIENTCONFIG
 336

	)

81 
	#SOCKET
 337

	)

82 
	#CLIENTSIDE_SOCKET
 338

	)

83 
	#SNDBUF
 339

	)

84 
	#RCVBUF
 340

	)

85 
	#SOCKETPROTOCOL
 341

	)

86 
	#SOCKETOPTION_OPTID
 342

	)

87 
	#SRCHOST
 343

	)

88 
	#NODNSMISMATCH
 344

	)

89 
	#NODNSUNKNOWN
 345

	)

90 
	#CHECKREPLYAUTH
 346

	)

91 
	#USERNAME
 347

	)

92 
	#USER_PRIVILEGED
 348

	)

93 
	#USER_UNPRIVILEGED
 349

	)

94 
	#USER_LIBWRAP
 350

	)

95 
	#WORD__IN
 351

	)

96 
	#ROUTE
 352

	)

97 
	#VIA
 353

	)

98 
	#GLOBALROUTEOPTION
 354

	)

99 
	#BADROUTE_EXPIRE
 355

	)

100 
	#MAXFAIL
 356

	)

101 
	#PORT
 357

	)

102 
	#NUMBER
 358

	)

103 
	#BANDWIDTH
 359

	)

104 
	#BOUNCE
 360

	)

105 
	#BSDAUTHSTYLE
 361

	)

106 
	#BSDAUTHSTYLENAME
 362

	)

107 
	#COMMAND
 363

	)

108 
	#COMMAND_BIND
 364

	)

109 
	#COMMAND_CONNECT
 365

	)

110 
	#COMMAND_UDPASSOCIATE
 366

	)

111 
	#COMMAND_BINDREPLY
 367

	)

112 
	#COMMAND_UDPREPLY
 368

	)

113 
	#ACTION
 369

	)

114 
	#FROM
 370

	)

115 
	#TO
 371

	)

116 
	#GSSAPIENCTYPE
 372

	)

117 
	#GSSAPIENC_ANY
 373

	)

118 
	#GSSAPIENC_CLEAR
 374

	)

119 
	#GSSAPIENC_INTEGRITY
 375

	)

120 
	#GSSAPIENC_CONFIDENTIALITY
 376

	)

121 
	#GSSAPIENC_PERMESSAGE
 377

	)

122 
	#GSSAPIKEYTAB
 378

	)

123 
	#GSSAPISERVICE
 379

	)

124 
	#GSSAPISERVICENAME
 380

	)

125 
	#GSSAPIKEYTABNAME
 381

	)

126 
	#IPV4
 382

	)

127 
	#IPV6
 383

	)

128 
	#IPVANY
 384

	)

129 
	#DOMAINNAME
 385

	)

130 
	#IFNAME
 386

	)

131 
	#URL
 387

	)

132 
	#LDAPATTRIBUTE
 388

	)

133 
	#LDAPATTRIBUTE_AD
 389

	)

134 
	#LDAPATTRIBUTE_HEX
 390

	)

135 
	#LDAPATTRIBUTE_AD_HEX
 391

	)

136 
	#LDAPBASEDN
 392

	)

137 
	#LDAP_BASEDN
 393

	)

138 
	#LDAPBASEDN_HEX
 394

	)

139 
	#LDAPBASEDN_HEX_ALL
 395

	)

140 
	#LDAPCERTFILE
 396

	)

141 
	#LDAPCERTPATH
 397

	)

142 
	#LDAPPORT
 398

	)

143 
	#LDAPPORTSSL
 399

	)

144 
	#LDAPDEBUG
 400

	)

145 
	#LDAPDEPTH
 401

	)

146 
	#LDAPAUTO
 402

	)

147 
	#LDAPSEARCHTIME
 403

	)

148 
	#LDAPDOMAIN
 404

	)

149 
	#LDAP_DOMAIN
 405

	)

150 
	#LDAPFILTER
 406

	)

151 
	#LDAPFILTER_AD
 407

	)

152 
	#LDAPFILTER_HEX
 408

	)

153 
	#LDAPFILTER_AD_HEX
 409

	)

154 
	#LDAPGROUP
 410

	)

155 
	#LDAPGROUP_NAME
 411

	)

156 
	#LDAPGROUP_HEX
 412

	)

157 
	#LDAPGROUP_HEX_ALL
 413

	)

158 
	#LDAPKEYTAB
 414

	)

159 
	#LDAPKEYTABNAME
 415

	)

160 
	#LDAPDEADTIME
 416

	)

161 
	#LDAPSERVER
 417

	)

162 
	#LDAPSERVER_NAME
 418

	)

163 
	#LDAPSSL
 419

	)

164 
	#LDAPCERTCHECK
 420

	)

165 
	#LDAPKEEPREALM
 421

	)

166 
	#LDAPTIMEOUT
 422

	)

167 
	#LDAPCACHE
 423

	)

168 
	#LDAPCACHEPOS
 424

	)

169 
	#LDAPCACHENEG
 425

	)

170 
	#LDAPURL
 426

	)

171 
	#LDAP_URL
 427

	)

172 
	#LDAP_FILTER
 428

	)

173 
	#LDAP_ATTRIBUTE
 429

	)

174 
	#LDAP_CERTFILE
 430

	)

175 
	#LDAP_CERTPATH
 431

	)

176 
	#LIBWRAPSTART
 432

	)

177 
	#LIBWRAP_ALLOW
 433

	)

178 
	#LIBWRAP_DENY
 434

	)

179 
	#LIBWRAP_HOSTS_ACCESS
 435

	)

180 
	#LINE
 436

	)

181 
	#OPERATOR
 437

	)

182 
	#PAMSERVICENAME
 438

	)

183 
	#PROTOCOL
 439

	)

184 
	#PROTOCOL_TCP
 440

	)

185 
	#PROTOCOL_UDP
 441

	)

186 
	#PROTOCOL_FAKE
 442

	)

187 
	#PROXYPROTOCOL
 443

	)

188 
	#PROXYPROTOCOL_SOCKS_V4
 444

	)

189 
	#PROXYPROTOCOL_SOCKS_V5
 445

	)

190 
	#PROXYPROTOCOL_HTTP
 446

	)

191 
	#PROXYPROTOCOL_UPNP
 447

	)

192 
	#REDIRECT
 448

	)

193 
	#SENDSIDE
 449

	)

194 
	#RECVSIDE
 450

	)

195 
	#SERVICENAME
 451

	)

196 
	#SESSION_INHERITABLE
 452

	)

197 
	#SESSIONMAX
 453

	)

198 
	#SESSIONTHROTTLE
 454

	)

199 
	#SESSIONSTATE_KEY
 455

	)

200 
	#SESSIONSTATE_MAX
 456

	)

201 
	#SESSIONSTATE_THROTTLE
 457

	)

202 
	#RULE_LOG
 458

	)

203 
	#RULE_LOG_CONNECT
 459

	)

204 
	#RULE_LOG_DATA
 460

	)

205 
	#RULE_LOG_DISCONNECT
 461

	)

206 
	#RULE_LOG_ERROR
 462

	)

207 
	#RULE_LOG_IOOPERATION
 463

	)

208 
	#RULE_LOG_TCPINFO
 464

	)

209 
	#STATEKEY
 465

	)

210 
	#UDPPORTRANGE
 466

	)

211 
	#UDPCONNECTDST
 467

	)

212 
	#USER
 468

	)

213 
	#GROUP
 469

	)

214 
	#VERDICT_BLOCK
 470

	)

215 
	#VERDICT_PASS
 471

	)

216 
	#YES
 472

	)

217 
	#NO
 473

	)

218 #i‚de‡
YYSTYPE_DEFINED


219 
	#YYSTYPE_DEFINED


	)

222 
uid_t
 
	muid
;

223 
gid_t
 
	mgid
;

224 } 
	muid
;

227 
vÆuëy≥_t
 
	mvÆuëy≥
;

228 c⁄° *
	mvÆuev
;

229 } 
	mîr‹
;

232 c⁄° *
	mﬁd«me
;

233 c⁄° *
	m√w«me
;

234 } 
	mdïªˇãd
;

236 *
	m°rög
;

237 
	mmëhod
;

238 
	mnumbî
;

239 } 
	tYYSTYPE
;

241 
YYSTYPE
 
socks_yylvÆ
;

	@lib/config_parse.y

47 
	~"yacc⁄fig.h
"

49 c⁄° 
	grcsid
[] =

52 #i‡
HAVE_LIBWRAP
 && (!
SOCKS_CLIENT
)

53 
jmp_buf
 
t˝d_buf
;

56 
yyª°¨t
(
FILE
 *
Â
);

58 íum { 
	m‰om
, 
	mto
, 
	mboun˚
 } 
	taddªssc⁄ãxt_t
;

61 
ùaddr_ªquúes_√tmask
(c⁄° 
addªssc⁄ãxt_t
 
c⁄ãxt
,

62 c⁄° 
obje˘ty≥_t
 
obje˘ty≥
);

72 
addnumbî
(
size_t
 *
numbîc
, *
numbîv
[], c⁄° 
numbî
);

75 
addröô
(
ruÀaddr_t
 *
addr
, c⁄° 
√tmask_ªquúed
);

78 
gwaddröô
(
socksho°_t
 *
addr
);

81 
rouãöô
(
rouã_t
 *
rouã
);

83 #i‡
SOCKS_CLIENT


84 
∑r£˛õ¡ív
(*
havïroxy£rvî
);

91 *
£rvî°rög2gw°rög
(c⁄° *
£rvî
, c⁄° 
vîsi⁄
,

92 *
gw
, c⁄° 
size_t
 
gwsize
);

103 
	#Æ¨möô
()

	)

104 
	#SET_TCPOPTION
(
logobje˘
, 
Àvñ
, 
©å
)

	)

112 
po°_addruÀ
();

119 
¥e_addruÀ
(
ruÀ_t
 *
ruÀ
);

120 
¥e_addm⁄ô‹
(
m⁄ô‹_t
 *
m⁄ô‹
);

127 
ruÀöô
(
ruÀ_t
 *
ruÀ
);

128 
m⁄ô‹öô
(
m⁄ô‹_t
 *
m⁄ô‹
);

129 
Æ¨möô
();

131 
c⁄figuª_¥ivûeges
();

137 
checkugid
(
uid_t
 *
uid
, 
gid_t
 *
gid
, *
is£t
, c⁄° *
ty≥
);

139 
	#SET_TCPOPTION
(
t˝
, 
Àvñ
, 
©å
) \

141 (
t˝
)->
isc⁄figuªd
 = 1; \

143 (
t˝
)->
©å
 = 1; \

144 (
t˝
)->
	`__CONCAT
(
©å
, 
_logÀvñ
Ë
˛ogÀvñ
; \

145 }  0)

	)

151 
	#LOG_CMDLINE_OVERRIDE
(
«me
, 
√wvÆue
, 
ﬁdvÆue
, 
fmt
) \

153 
	`¶og
(
LOG_NOTICE
, \

154 "%s: %†comm™dlöêvÆuê\"" 
fmt
 "\" overrides " \

155 "c⁄fig-fûêvÆuê\"" 
fmt
 "\" set in file %s", \

156 
fun˘i⁄
, 
«me
, (
√wvÆue
), (
ﬁdvÆue
), 
sockscf
.
›ti⁄
.
c⁄figfûe
); \

157 }  0 )

	)

159 
	#CMDLINE_OVERRIDE
(
cmdlöe
, 
›ti⁄
) \

161 i‡((
cmdlöe
)->
debug_is£t
) { \

162 i‡((
›ti⁄
)->
debug
 !(
cmdlöe
)->debug) \

163 
	`LOG_CMDLINE_OVERRIDE
("debug", \

164 (
cmdlöe
)->
debug
, \

165 (
›ti⁄
)->
debug
, \

168 (
›ti⁄
)->
debug
 = (
cmdlöe
)->debug; \

169 (
›ti⁄
)->
debug_is£t
(
cmdlöe
)->debug_isset; \

171 }  0)

	)

175 
yylöío
;

176 *
yyãxt
;

177 
cuºíéexlöe
[];

178 
¥eviou¶exlöe
[];

180 c⁄° *
	gfun˘i⁄
 = "configparsing()";

186 *
	g©y≥
;

187 
	g∑rsögc⁄fig
;

193 #i‡!
SOCKS_CLIENT


194 
logty≥_t
 
	gﬁd_log
, 
	gﬁd_îæog
;

197 
	gÁûed_to_add_log
, 
	gÁûed_to_add_îæog
;

199 
	gadd_to_îæog
;

201 
obje˘ty≥_t
 
	gobje˘ty≥
;

204 #i‡!
SOCKS_CLIENT


205 
log•ecül_t
 *
	glog•ecül
;

206 
w¨n_¥Ÿocﬁ_t˝_›ti⁄s_t
 *
	gt˝›ti⁄s
;

208 
öãrÁ˚¥Ÿocﬁ_t
 *
	giÂrŸo
;

210 
m⁄ô‹_t
 
	gm⁄ô‹
;

211 
m⁄ô‹_if_t
 *
	gm⁄ô‹if
;

212 *
	gÆ¨mside
;

214 
	g˛ogÀvñ
;

216 
ruÀ_t
 
	gruÀ
;

218 
shmem_obje˘_t
 
	gss
;

219 
	g£ssi⁄_is£t
;

220 
shmem_obje˘_t
 
	gbw
;

221 
	gbw_is£t
;

226 *
	gho°id›ti⁄_is£t
;

228 *
	gnumbîv
;

229 
size_t
 
	gnumbîc
;

231 #i‡!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


232 *
	gho°ödex
;

235 
timeout_t
 *
	gtimeout
 = &
sockscf
.
timeout
;

237 
sockë›ti⁄_t
 
	gsockë›t
;

239 
£rvî°©e_t
 *
	g°©e
;

240 
rouã_t
 
	grouã
;

241 
socksho°_t
 
	ggw
;

243 
ruÀaddr_t
 
	g§c
;

244 
ruÀaddr_t
 
	gd°
;

245 
ruÀaddr_t
 
	gho°id
;

246 
ruÀaddr_t
 
	grdr_‰om
;

247 
ruÀaddr_t
 
	grdr_to
;

249 #i‡
BAREFOOTD


250 
ruÀaddr_t
 
	gboun˚to
;

253 
ruÀaddr_t
 *
	gruÀaddr
;

254 
exãnsi⁄_t
 *
	gexãnsi⁄
;

257 
ö_addr
 *
	gùv4
;

258 
ö_addr
 *
	g√tmask_v4
;

260 
ö6_addr
 *
	gùv6
;

261 *
	g√tmask_v6
;

262 
uöt32_t
 *
	gsc›eid_v6
;

264 
ö_addr
 *
	gùv™y
;

265 
ö_addr
 *
	g√tmask_v™y
;

267 
	g√tmask_ªquúed
;

271 *
	gdomaö
;

272 *
	gi‚ame
;

273 *
	guæ
;

275 
ö_p‹t_t
 *
	gp‹t_t˝
;

276 
ö_p‹t_t
 *
	gp‹t_udp
;

278 *
	gcmëhodv
;

279 
size_t
 *
	gcmëhodc
;

280 *
	gsmëhodv
;

281 
size_t
 *
	gsmëhodc
;

283 
›î©‹_t
 *
	g›î©‹
;

285 #i‡
HAVE_GSSAPI


286 *
	ggsßpi£rvi˚«me
;

287 *
	ggsßpikeyèb
;

288 
gsßpi_íc_t
 *
	ggsßpõn¸y±i⁄
;

291 #i‡!
SOCKS_CLIENT
 && 
HAVE_LDAP


292 
ld≠_t
 *
	gld≠
;

295 #i‡
DEBUG


296 
	#YYDEBUG
 1

	)

299 
	#ADDMETHOD
(
mëhod
, 
mëhodc
, 
mëhodv
) \

301 i‡(
	`mëhodis£t
((
mëhod
), (
mëhodv
), (
mëhodc
))) \

302 
	`yyw¨nx
("duplicate method: %s. Already set onÅhis methodline", \

303 
	`mëhod2°rög
((
mëhod
))); \

305 i‡((
mëhodc
Ë>
METHODS_KNOWN
) { \

306 
	`yyîr‹x
("too manyáuthmethods (%lu, max is %ld)", \

307 ()(
mëhodc
), ()
METHODS_KNOWN
); \

308 
	`SERRX
(
mëhodc
); \

314 
mëhod
) { \

315 
AUTHMETHOD_BSDAUTH
: \

316 i‡(!
HAVE_BSDAUTH
) \

317 
	`yyîr‹x_nﬁib
("bsdauth"); \

320 
AUTHMETHOD_GSSAPI
: \

321 i‡(!
HAVE_GSSAPI
) \

322 
	`yyîr‹x_nﬁib
("GSSAPI"); \

326 
AUTHMETHOD_RFC931
: \

327 i‡(!
HAVE_LIBWRAP
) \

328 
	`yyîr‹x_nﬁib
("libwrap"); \

331 
AUTHMETHOD_PAM_ANY
: \

332 
AUTHMETHOD_PAM_ADDRESS
: \

333 
AUTHMETHOD_PAM_USERNAME
: \

334 i‡(!
HAVE_PAM
) \

335 
	`yyîr‹x_nﬁib
("PAM"); \

340 
mëhodv
[(
mëhodc
)++] = 
mëhod
; \

342 } 0)

	)

344 
	#ASSIGN_NUMBER
(
numbî
, 
›
, 
checkagaö°
, 
obje˘
, 
issig√d
) \

346 i‡(!((
numbî
Ë
	`›
 (
checkagaö°
))) \

347 
	`yyîr‹x
("number (%lld) must be " #op " %lld (" #checkagainst ")", \

348 ()(
numbî
), ()(
checkagaö°
)); \

350 i‡(
issig√d
) { \

351 i‡(()(
numbî
Ë< 
	`mövÆueo·y≥
((
obje˘
))) \

352 
	`yyîr‹x
("number %lld isÅoo small. Minimum is %lld", \

353 ()
numbî
, 
	`mövÆueo·y≥
((
obje˘
))); \

355 i‡(()(
numbî
Ë> 
	`maxvÆueo·y≥
((
obje˘
))) \

356 
	`yyîr‹x
("number %lld isÅooÜarge. Maximum is %lld", \

357 ()
numbî
, 
	`maxvÆueo·y≥
((
obje˘
))); \

360 i‡(()(
numbî
Ë< 
	`umövÆueo·y≥
((
obje˘
))) \

361 
	`yyîr‹x
("number %llu isÅoo small. Minimum is %llu", \

362 ()
numbî
, 
	`umövÆueo·y≥
((
obje˘
)));\

364 i‡(()(
numbî
Ë> 
	`umaxvÆueo·y≥
((
obje˘
))) \

365 
	`yyîr‹x
("number %llu isÅooÜarge. Maximum is %llu", \

366 ()
numbî
, 
	`umaxvÆueo·y≥
((
obje˘
)));\

369 (
obje˘
Ë(
numbî
); \

370 } 0)

	)

372 
	#ASSIGN_PORTNUMBER
(
p‹äumbî
, 
obje˘
) \

375 
	`ASSIGN_NUMBER
(
p‹äumbî
, >=, 0, (
obje˘
), 0); \

376 
	`ASSIGN_NUMBER
(
p‹äumbî
, <=, 
IP_MAXPORT
, (
obje˘
), 0); \

378 (
obje˘
Ë
	`ht⁄s
((
ö_p‹t_t
)(
p‹äumbî
)); \

379 } 0)

	)

381 
	#ASSIGN_THROTTLE_SECONDS
(
numbî
, 
obj
, 
issig√d
) \

382 
	`ASSIGN_NUMBER
((
numbî
), >, 0, 
obj
, 
issig√d
)

	)

383 
	#ASSIGN_THROTTLE_CLIENTS
(
numbî
, 
obj
, 
issig√d
) \

384 
	`ASSIGN_NUMBER
((
numbî
), >, 0, 
obj
, 
issig√d
)

	)

385 
	#ASSIGN_MAXSESSIONS
(
numbî
, 
obj
, 
issig√d
) \

386 
	`ASSIGN_NUMBER
((
numbî
), >, 0, 
obj
, 
issig√d
)

	)

392 
uid_t
 
uid
;

393 
gid_t
 
gid
;

394 } 
uid
;

397 
vÆuëy≥_t
 
vÆuëy≥
;

398 c⁄° *
vÆuev
;

399 } 
îr‹
;

402 c⁄° *
ﬁd«me
;

403 c⁄° *
√w«me
;

404 } 
dïªˇãd
;

406 *
°rög
;

407 
mëhod
;

408 
numbî
;

412 %
ty≥
 <
°rög
> 
bsdauth°yÀ«me


413 %
ty≥
 <
°rög
> 
comm™d
 
comm™ds
 
comm™d«me


414 %
ty≥
 <
°rög
> 
c⁄figty≥
 
dïªˇãd


415 %
ty≥
 <
°rög
> 
debuggög


416 %
ty≥
 <
°rög
> 
iÂrŸocﬁ
 
iÂrŸocﬁs


417 %
ty≥
 <
°rög
> 
group
 
grou≤ame
 
grou≤ames


418 %
ty≥
 <
°rög
> 
gsßpõn˘y≥


419 %
ty≥
 <
°rög
> 
gsßpikeyèb


420 %
ty≥
 <
°rög
> 
gsßpi£rvi˚«me


421 %
ty≥
 <
°rög
> 
∑m£rvi˚«me


422 %
ty≥
 <
°rög
> 
¥Ÿocﬁ
 
¥Ÿocﬁs
 
¥Ÿocﬁ«me


423 %
ty≥
 <
°rög
> 
¥oxy¥Ÿocﬁ
 
¥oxy¥Ÿocﬁ«me
 
¥oxy¥Ÿocﬁs


424 %
ty≥
 <
°rög
> 
ªÆm


425 %
ty≥
 <
°rög
> 
ªsﬁvïrŸocﬁ
 
ªsﬁvïrŸocﬁ«me


426 %
ty≥
 <
°rög
> 
sockëside
 
sockë›ti⁄
 
sockë›ti⁄«me
 
sockë›ti⁄vÆue


427 %
ty≥
 <
°rög
> 
§cho°
 
§cho°›ti⁄
 
§cho°›ti⁄s


428 %
ty≥
 <
°rög
> 
udµ‹å™ge
 
udµ‹å™ge_°¨t
 
udµ‹å™ge_íd


429 %
ty≥
 <
°rög
> 
u£r
 
u£∫ame
 
u£∫ames


432 %
ty≥
 <
°rög
> 
˛õ¡›ti⁄s
 
˛õ¡›ti⁄


437 %
ty≥
 <
°rög
> 
Æ¨m
 
Æ¨m_d©a
 
Æ¨m_disc⁄√˘
 
Æ¨m_ã°


438 %
ty≥
 <
°rög
> 
√tw‹k¥obÀm


439 %
ty≥
 <
numbî
> 
Æ¨m≥riod
 
Æ¨mside


440 %
ty≥
 <
numbî
>Çumbî 
numbîs


441 %
ty≥
 <
°rög
> 
˛õ¡mëhod
 
˛õ¡mëhods
 
˛õ¡mëhod«me


442 %
ty≥
 <
°rög
> 
socksmëhod
 
socksmëhods
 
socksmëhod«me


443 %
ty≥
 <
°rög
> 
b™dwidth


444 %
ty≥
 <
°rög
> 
chûd°©e


445 %
ty≥
 <
°rög
> 
˛õ¡com∑tibûôy
 
˛õ¡com∑tibûôy«me


446 
˛õ¡com∑tibûôy«mes


447 %
ty≥
 <
°rög
> 
com∑tibûôy
 
com∑tibûôy«me
 
com∑tibûôy«mes


448 %
ty≥
 <
°rög
> 
˝u
 
˝uscheduÀ
 
˝uafföôy


449 %
ty≥
 <
°rög
> 
exãnsi⁄
 
exãnsi⁄«me
 
exãnsi⁄s


450 %
ty≥
 <
°rög
> 
exã∫Æ
 
exã∫Æöô
 
exã∫Æ_¥Ÿocﬁ
 
exã∫Æ_rŸ©i⁄


451 %
ty≥
 <
°rög
> 
globÆ_socksmëhod
 
globÆ_˛õ¡mëhod


452 %
ty≥
 <
°rög
> 
öã∫Æ
 
öã∫Æöô
 
öã∫Æ_¥Ÿocﬁ


453 %
ty≥
 <
°rög
> 
lba£dn
 
lba£dn_hex
 
lba£dn_hex_Æl


454 %
ty≥
 <
°rög
> 
ld≠©åibuã
 
ld≠©åibuã_ad
 
ld≠©åibuã_hex


455 
ld≠©åibuã_ad_hex


456 %
ty≥
 <
°rög
> 
ld≠auto
 
ld≠debug
 
ld≠dïth
 
ld≠p‹t
 
ld≠p‹ts¶


457 %
ty≥
 <
°rög
> 
ld≠˚πfûe
 
ld≠˚π∑th
 
ld≠keyèb


458 %
ty≥
 <
°rög
> 
ld≠domaö


459 %
ty≥
 <
°rög
> 
ld≠fûãr
 
ld≠fûãr_ad
 
ld≠fûãr_hex
 
ld≠fûãr_ad_hex


460 %
ty≥
 <
°rög
> 
libwøp_ho°s_ac˚ss


461 %
ty≥
 <
°rög
> 
libwøpfûes
 
libwøp_Ælowfûe
 
libwøp_díyfûe


462 %
ty≥
 <
°rög
> 
logouçut
 
îr‹log


463 %
ty≥
 <
°rög
> 
öã∫Æ_if_log›ti⁄
 
exã∫Æ_if_log›ti⁄


464 %
ty≥
 <
°rög
> 
log•ecül
 
logÀvñ
 
îr‹s
 
îr‹obje˘


465 %
ty≥
 <
°rög
> 
l£rvî
 
lgroup
 
lgroup_hex
 
lgroup_hex_Æl


466 %
ty≥
 <
°rög
> 
luæ
 
ld≠s¶
 
ld≠˚πcheck
 
ld≠kì¥ólm


467 %
ty≥
 <
°rög
> 
m⁄ô‹
 
m⁄ô‹›ti⁄
 
m⁄ô‹›ti⁄s
 
m⁄ô‹side


468 %
ty≥
 <
°rög
> 
ªdúe˘


469 %
ty≥
 <
°rög
> 
£rvî›ti⁄
 
£rvî›ti⁄s
 
£rvîobje˘
 
£rvîobje˘s


470 %
ty≥
 <
°rög
> 
£ssi⁄›ti⁄
 
¸uÀ£ssi⁄›ti⁄
 
socks£ssi⁄›ti⁄
 
£ssi⁄max
 
£ssi⁄öhîôabÀ
 
£ssi⁄thrŸée
 
£ssi⁄°©e


471 
£ssi⁄°©e_key
 
£ssi⁄°©e_keyöfo
 
£ssi⁄°©e_thrŸée


472 
£ssi⁄°©e_max


473 %
ty≥
 <
°rög
> 
timeout
 
iŸimeout
 
√gŸüãtimeout
 
c⁄√˘timeout


474 
t˝_fö_timeout


475 %
ty≥
 <
°rög
> 
udpc⁄√˘d°


476 %
ty≥
 <
°rög
> 
u£rids
 
u£r_¥ivûeged
 
u£r_u≈rivûeged
 
u£r_libwøp


477 %
ty≥
 <
uid
> 
u£rid


480 %
tokí
 <
°rög
> 
ALARM
 
ALARMTYPE_DATA
 
ALARMTYPE_DISCONNECT


481 
ALARMIF_INTERNAL
 
ALARMIF_EXTERNAL


482 %
tokí
 <
°rög
> 
TCPOPTION_DISABLED
 
ECN
 
SACK
 
TIMESTAMPS
 
WSCALE


483 %
tokí
 <
°rög
> 
MTU_ERROR


484 %
tokí
 <
°rög
> 
CLIENTCOMPATIBILITY
 
NECGSSAPI


485 %
tokí
 <
°rög
> 
CLIENTRULE
 
HOSTIDRULE
 
SOCKSRULE


486 %
tokí
 <
°rög
> 
COMPATIBILITY
 
SAMEPORT
 
DRAFT_5_05


487 %
tokí
 <
°rög
> 
CONNECTTIMEOUT
 
TCP_FIN_WAIT


488 %
tokí
 <
°rög
> 
CPU
 
MASK
 
SCHEDULE
 
CPUMASK_ANYCPU


489 %
tokí
 <
°rög
> 
DEBUGGING


490 %
tokí
 <
dïªˇãd
> 
DEPRECATED


491 %
tokí
 <
°rög
> 
ERRORLOG
 
LOGOUTPUT
 
LOGFILE
 
LOGTYPE_ERROR


492 
LOGTYPE_TCP_DISABLED
 
LOGTYPE_TCP_ENABLED


493 
LOGIF_INTERNAL
 
LOGIF_EXTERNAL


494 %
tokí
 <
îr‹
> 
ERRORVALUE


495 %
tokí
 <
°rög
> 
EXTENSION
 
BIND
 
PRIVILEGED


496 %
tokí
 <
°rög
> 
EXTERNAL_PROTOCOL
 
INTERNAL_PROTOCOL


497 %
tokí
 <
°rög
> 
EXTERNAL_ROTATION
 
SAMESAME


498 %
tokí
 <
°rög
> 
GROUPNAME


499 %
tokí
 <
°rög
> 
HOSTID
 
HOSTINDEX


500 %
tokí
 <
°rög
> 
INTERFACE
 
SOCKETOPTION_SYMBOLICVALUE


501 %
tokí
 <
°rög
> 
INTERNAL
 
EXTERNAL


502 %
tokí
 <
°rög
> 
INTERNALSOCKET
 
EXTERNALSOCKET


503 %
tokí
 <
°rög
> 
IOTIMEOUT
 
IOTIMEOUT_TCP
 
IOTIMEOUT_UDP
 
NEGOTIATETIMEOUT


504 %
tokí
 <
°rög
> 
LIBWRAP_FILE


505 %
tokí
 <
numbî
> 
LOGLEVEL


506 %
tokí
 <
°rög
> 
SOCKSMETHOD
 
CLIENTMETHOD
 
METHOD


507 %
tokí
 <
mëhod
> 
METHODNAME
 
NONE
 
BSDAUTH
 
GSSAPI


508 
PAM_ADDRESS
 
PAM_ANY
 
PAM_USERNAME


509 
RFC931
 
UNAME


510 %
tokí
 <
°rög
> 
MONITOR


511 %
tokí
 <
numbî
> 
PROCESSTYPE


512 %
tokí
 <
°rög
> 
PROC_MAXREQUESTS


513 %
tokí
 <
°rög
> 
REALM
 
REALNAME
 
RESOLVEPROTOCOL


514 %
tokí
 <
°rög
> 
REQUIRED


515 %
tokí
 <
numbî
> 
SCHEDULEPOLICY


516 %
tokí
 <
°rög
> 
SERVERCONFIG
 
CLIENTCONFIG


517 %
tokí
 <
°rög
> 
SOCKET
 
CLIENTSIDE_SOCKET
 
SNDBUF
 
RCVBUF


518 %
tokí
 <
numbî
> 
SOCKETPROTOCOL
 
SOCKETOPTION_OPTID


519 %
tokí
 <
°rög
> 
SRCHOST
 
NODNSMISMATCH
 
NODNSUNKNOWN
 
CHECKREPLYAUTH


520 %
tokí
 <
°rög
> 
USERNAME


521 %
tokí
 <
°rög
> 
USER_PRIVILEGED
 
USER_UNPRIVILEGED
 
USER_LIBWRAP


522 %
tokí
 <
°rög
> 
WORD__IN


525 %
ty≥
 <
°rög
> 
globÆ_rouã›ti⁄


526 %
ty≥
 <
°rög
> 
vü
 
g©eway
 
rouã
 
rouãs
 
rouã›ti⁄
 
rouã›ti⁄s
 
rouãmëhod


528 %
tokí
 <
°rög
> 
ROUTE
 
VIA


529 %
tokí
 <
°rög
> 
GLOBALROUTEOPTION
 
BADROUTE_EXPIRE
 
MAXFAIL


532 %
ty≥
 <
numbî
> 
p‹t
 
gwp‹t
 
p‹å™ge
 
p‹t°¨t
 
p‹äumbî
 
p‹t£rvi˚


533 %
ty≥
 <
°rög
> 
addªss
 
ùaddªss
 
ùv4
 
ùv6
 
ùv™y
 
domaö
 
i‚ame
 
uæ


534 %
ty≥
 <
°rög
> 
gwaddªss
 
boun˚tﬂddªss


535 %
ty≥
 <
°rög
> 
addªss_wôhout_p‹t
 
§ˇddªss
 
ho°id_§ˇddªss
 
d°addªss


536 %
ty≥
 <
°rög
> 
boun˚
 
boun˚to


537 %
ty≥
 <
°rög
> 
¸uÀ
 
¸uÀ›ti⁄
 
¸uÀ›ti⁄s


538 %
ty≥
 <
°rög
> 
exã∫Æaddªss


539 %
ty≥
 <
°rög
> 
‰om
 
to


540 %
ty≥
 <
°rög
> 
‰omto
 
ho°id_‰omto


541 %
ty≥
 <
°rög
> 
hruÀ
 
ho°id›ti⁄
 
ho°ödex
 
ho°id


542 %
ty≥
 <
°rög
> 
gíîi¸uÀ›ti⁄


543 %
ty≥
 <
°rög
> 
ld≠›ti⁄
 
libwøp


544 %
ty≥
 <
°rög
> 
log
 
logs
 
log«me


545 %
ty≥
 <
°rög
> 
√tmask_v4
 
√tmask_v6


546 %
ty≥
 <
°rög
> 
p‹t›î©‹


547 %
ty≥
 <
°rög
> 
§uÀ
 
§uÀ›ti⁄
 
§uÀ›ti⁄s


548 %
ty≥
 <
°rög
> 
vîdi˘


549 %
ty≥
 <
°rög
> 
ruÀ_öã∫Æ_log›ti⁄
 
ruÀ_exã∫Æ_log›ti⁄


551 %
tokí
 <
numbî
> 
PORT
 
NUMBER


552 %
tokí
 <
°rög
> 
BANDWIDTH


553 %
tokí
 <
°rög
> 
BOUNCE


554 %
tokí
 <
°rög
> 
BSDAUTHSTYLE


555 %
tokí
 <
°rög
> 
BSDAUTHSTYLENAME


556 %
tokí
 <
°rög
> 
COMMAND
 
COMMAND_BIND
 
COMMAND_CONNECT
 
COMMAND_UDPASSOCIATE


557 
COMMAND_BINDREPLY
 
COMMAND_UDPREPLY
 %
tokí
 <
°rög
> 
ACTION


558 %
tokí
 <
°rög
> 
FROM
 
TO


559 %
tokí
 <
°rög
> 
GSSAPIENCTYPE


560 %
tokí
 <
°rög
> 
GSSAPIENC_ANY
 
GSSAPIENC_CLEAR
 
GSSAPIENC_INTEGRITY
 
GSSAPIENC_CONFIDENTIALITY
 
GSSAPIENC_PERMESSAGE


561 %
tokí
 <
°rög
> 
GSSAPIKEYTAB


562 %
tokí
 <
°rög
> 
GSSAPISERVICE


563 %
tokí
 <
°rög
> 
GSSAPISERVICENAME
 
GSSAPIKEYTABNAME


564 %
tokí
 <
°rög
> 
IPV4
 
IPV6
 
IPVANY
 
DOMAINNAME
 
IFNAME
 
URL


565 %
tokí
 <
°rög
> 
LDAPATTRIBUTE
 
LDAPATTRIBUTE_AD
 
LDAPATTRIBUTE_HEX


566 
LDAPATTRIBUTE_AD_HEX


567 %
tokí
 <
°rög
> 
LDAPBASEDN
 
LDAP_BASEDN


568 %
tokí
 <
°rög
> 
LDAPBASEDN_HEX
 
LDAPBASEDN_HEX_ALL


569 %
tokí
 <
°rög
> 
LDAPCERTFILE
 
LDAPCERTPATH
 
LDAPPORT
 
LDAPPORTSSL


570 %
tokí
 <
°rög
> 
LDAPDEBUG
 
LDAPDEPTH
 
LDAPAUTO
 
LDAPSEARCHTIME


571 %
tokí
 <
°rög
> 
LDAPDOMAIN
 
LDAP_DOMAIN


572 %
tokí
 <
°rög
> 
LDAPFILTER
 
LDAPFILTER_AD
 
LDAPFILTER_HEX
 
LDAPFILTER_AD_HEX


573 %
tokí
 <
°rög
> 
LDAPGROUP
 
LDAPGROUP_NAME


574 %
tokí
 <
°rög
> 
LDAPGROUP_HEX
 
LDAPGROUP_HEX_ALL


575 %
tokí
 <
°rög
> 
LDAPKEYTAB
 
LDAPKEYTABNAME
 
LDAPDEADTIME


576 %
tokí
 <
°rög
> 
LDAPSERVER
 
LDAPSERVER_NAME


577 %
tokí
 <
°rög
> 
LDAPSSL
 
LDAPCERTCHECK
 
LDAPKEEPREALM


578 %
tokí
 <
°rög
> 
LDAPTIMEOUT
 
LDAPCACHE
 
LDAPCACHEPOS
 
LDAPCACHENEG


579 %
tokí
 <
°rög
> 
LDAPURL
 
LDAP_URL


580 %
tokí
 <
°rög
> 
LDAP_FILTER
 
LDAP_ATTRIBUTE
 
LDAP_CERTFILE
 
LDAP_CERTPATH


581 %
tokí
 <
°rög
> 
LIBWRAPSTART
 
LIBWRAP_ALLOW
 
LIBWRAP_DENY
 
LIBWRAP_HOSTS_ACCESS


582 %
tokí
 <
°rög
> 
LINE


583 %
tokí
 <
°rög
> 
OPERATOR


584 %
tokí
 <
°rög
> 
PAMSERVICENAME


585 %
tokí
 <
°rög
> 
PROTOCOL
 
PROTOCOL_TCP
 
PROTOCOL_UDP
 
PROTOCOL_FAKE


586 %
tokí
 <
°rög
> 
PROXYPROTOCOL
 
PROXYPROTOCOL_SOCKS_V4
 
PROXYPROTOCOL_SOCKS_V5


587 
PROXYPROTOCOL_HTTP
 
PROXYPROTOCOL_UPNP


588 %
tokí
 <
°rög
> 
REDIRECT


589 %
tokí
 <
°rög
> 
SENDSIDE
 
RECVSIDE


590 %
tokí
 <
°rög
> 
SERVICENAME


591 %
tokí
 <
°rög
> 
SESSION_INHERITABLE
 
SESSIONMAX
 
SESSIONTHROTTLE


592 
SESSIONSTATE_KEY
 
SESSIONSTATE_MAX
 
SESSIONSTATE_THROTTLE


593 %
tokí
 <
°rög
> 
RULE_LOG
 
RULE_LOG_CONNECT
 
RULE_LOG_DATA


594 
RULE_LOG_DISCONNECT
 
RULE_LOG_ERROR
 
RULE_LOG_IOOPERATION


595 
RULE_LOG_TCPINFO


596 %
tokí
 <
°rög
> 
STATEKEY


597 %
tokí
 <
°rög
> 
UDPPORTRANGE
 
UDPCONNECTDST


598 %
tokí
 <
°rög
> 
USER
 
GROUP


599 %
tokí
 <
°rög
> 
VERDICT_BLOCK
 
VERDICT_PASS


600 %
tokí
 <
°rög
> 
YES
 
NO


603 %% /* 
	$yy∑r£
 */ 
	`yyÀx
()

611 
c⁄figty≥
: 
SERVERCONFIG
 {

612 #!
SOCKS_CLIENT


613 
exãnsi⁄
 = &
sockscf
.extension;

614 #
ídif


615 } 
£rvî›ti⁄s
 
£rvîobje˘s


616 | 
CLIENTCONFIG
 
˛õ¡›ti⁄s
 
rouãs


619 
£rvîobje˘s
: { 
$$
 = 
NULL
; }

620 | 
£rvîobje˘s
 
£rvîobje˘


623 
£rvîobje˘
: 
¸uÀ


624 | 
hruÀ


625 | 
§uÀ


626 | 
m⁄ô‹


627 | 
rouã


630 
£rvî›ti⁄s
: { 
$$
 = 
NULL
; }

631 | 
£rvî›ti⁄
 
£rvî›ti⁄s


633 
£rvî›ti⁄
: 
chûd°©e


634 | 
com∑tibûôy


635 | 
˝u


636 | 
debuggög


637 | 
dïªˇãd


638 | 
îr‹log


639 | 
exãnsi⁄


640 | 
exã∫Æ


641 | 
exã∫Æ_¥Ÿocﬁ


642 | 
exã∫Æ_rŸ©i⁄


643 | 
exã∫Æ_if_log›ti⁄


644 | 
globÆ_˛õ¡mëhod


645 | 
globÆ_socksmëhod


646 | 
globÆ_rouã›ti⁄


647 | 
öã∫Æ


648 | 
öã∫Æ_¥Ÿocﬁ


649 | 
öã∫Æ_if_log›ti⁄


650 | 
libwøp_ho°s_ac˚ss


651 | 
libwøpfûes


652 | 
logouçut


653 | 
ªÆm


654 | 
ªsﬁvïrŸocﬁ


655 | 
§cho°


656 | 
timeout


657 | 
udpc⁄√˘d°


658 | 
u£rids


659 | 
sockë›ti⁄
 {

660 i‡(!
	`addedsockë›ti⁄
(&
sockscf
.
sockë›ti⁄c
,

661 &
sockscf
.
sockë›ti⁄v
,

662 &
sockë›t
))

663 
	`yyw¨n
("couldÇotádd socket option");

667 
log•ecül
: 
LOGTYPE_ERROR
 ':' 
îr‹s


668 | 
LOGTYPE_TCP_DISABLED
 ':' {

669 #!
SOCKS_CLIENT


670 
t˝›ti⁄s
 = &
log•ecül
->
¥Ÿocﬁ
.
t˝
.
dißbÀd
;

671 #
ídif


672 } 
t˝›ti⁄s


673 | 
LOGTYPE_TCP_ENABLED
 ':' {

674 #!
SOCKS_CLIENT


675 
t˝›ti⁄s
 = &
log•ecül
->
¥Ÿocﬁ
.
t˝
.
íabÀd
;

676 #
ídif


677 } 
t˝›ti⁄s


681 
öã∫Æ_if_log›ti⁄
: 
LOGIF_INTERNAL
 {

682 #!
SOCKS_CLIENT


684 
log•ecül
 = &
sockscf
.
öã∫Æ
.
log
;

686 #
ídif


688 } '.' 
logÀvñ
 '.' 
log•ecül


691 
exã∫Æ_if_log›ti⁄
: 
LOGIF_EXTERNAL
 {

692 #!
SOCKS_CLIENT


694 
log•ecül
 = &
sockscf
.
exã∫Æ
.
log
;

696 #
ídif


698 } '.' 
logÀvñ
 '.' 
log•ecül


701 
ruÀ_öã∫Æ_log›ti⁄
: 
LOGIF_INTERNAL
 {

702 #!
SOCKS_CLIENT


704 
log•ecül
 = &
ruÀ
.
öã∫Æ
.
log
;

706 #
ídif


708 } '.' 
logÀvñ
 '.' 
log•ecül


711 
ruÀ_exã∫Æ_log›ti⁄
: 
LOGIF_EXTERNAL
 {

712 #!
SOCKS_CLIENT


714 
log•ecül
 = &
ruÀ
.
exã∫Æ
.
log
;

716 #
ídif


718 } '.' 
logÀvñ
 '.' 
log•ecül


722 
logÀvñ
: 
LOGLEVEL
 {

723 #!
SOCKS_CLIENT


724 
	`SASSERTX
(
$1
 >= 0);

725 
	`SASSERTX
(
$1
 < 
MAXLOGLEVELS
);

727 
˛ogÀvñ
 = 
$1
;

728 #
ídif


732 
t˝›ti⁄s
: 
t˝›ti⁄


733 | 
t˝›ti⁄
 
t˝›ti⁄s


736 
t˝›ti⁄
: 
ECN
 {

737 #!
SOCKS_CLIENT


738 
	`SET_TCPOPTION
(
t˝›ti⁄s
, 
˛ogÀvñ
, 
e˙
);

739 #
ídif


743 
t˝›ti⁄
: 
SACK
 {

744 #!
SOCKS_CLIENT


745 
	`SET_TCPOPTION
(
t˝›ti⁄s
, 
˛ogÀvñ
, 
ßck
);

746 #
ídif


750 
t˝›ti⁄
: 
TIMESTAMPS
 {

751 #!
SOCKS_CLIENT


752 
	`SET_TCPOPTION
(
t˝›ti⁄s
, 
˛ogÀvñ
, 
time°amps
);

753 #
ídif


757 
t˝›ti⁄
: 
WSCALE
 {

758 #!
SOCKS_CLIENT


759 
	`SET_TCPOPTION
(
t˝›ti⁄s
, 
˛ogÀvñ
, 
wsˇÀ
);

760 #
ídif


766 
îr‹s
: 
îr‹obje˘


767 | 
îr‹obje˘
 
îr‹s


770 
îr‹obje˘
: 
ERRORVALUE
 {

771 #!
SOCKS_CLIENT


773 i‡(
$1
.
vÆuev
 =
NULL
)

774 
	`yyw¨nx
("unknownÉrror symbol specified");

776 
size_t
 *
ec
, 
ec_max
, 
i
;

777 *
ev
;

779 
$1
.
vÆuëy≥
) {

780 
VALUETYPE_ERRNO
:

781 
ev
 = 
log•ecül
->
î∫o_logÀvñv
[
˛ogÀvñ
];

782 
ec
 = &
log•ecül
->
î∫o_logÀvñc
[
˛ogÀvñ
];

783 
ec_max
 = 
	`ELEMENTS
(
log•ecül
->
î∫o_logÀvñv
[
˛ogÀvñ
]);

786 
VALUETYPE_GAIERR
:

787 
ev
 = 
log•ecül
->
gaõº_logÀvñv
[
˛ogÀvñ
];

788 
ec
 = &
log•ecül
->
gaõº_logÀvñc
[
˛ogÀvñ
];

789 
ec_max
 = 
	`ELEMENTS
(
log•ecül
->
gaõº_logÀvñv
[
˛ogÀvñ
]);

793 
	`SERRX
(
$1
.
vÆuëy≥
);

796 
i
 = 0; 
$1
.
vÆuev
[i] != 0; ++i) {

801 
size_t
 
j
;

803 
j
 = 0; j < *
ec
; ++j) {

804 i‡(
ev
[
j
] =
$1
.
vÆuev
[
i
])

808 i‡(
j
 < *
ec
)

811 
	`SASSERTX
(*
ec
 < 
ec_max
);

813 
ev
[(*
ec
)] = 
$1
.
vÆuev
[
i
];

814 ++(*
ec
);

817 #
ídif


822 
timeout
: 
c⁄√˘timeout


823 | 
iŸimeout


824 | 
√gŸüãtimeout


825 | 
t˝_fö_timeout


828 
dïªˇãd
: 
DEPRECATED
 {

829 
	`yyîr‹x
("given keyword \"%s\" is deprecated. New keyword is %s. "

831 
$1
.
ﬁd«me
, $1.
√w«me
, 
PRODUCT
);

835 
rouã
: 
ROUTE
 { 
obje˘ty≥
 = 
obje˘_rouã
; } '{'

836 { 
	`rouãöô
(&
rouã
); } 
rouã›ti⁄s
 
‰omto
 
g©eway
Ñouteoptions '}' {

837 
rouã
.
§c
 = src;

838 
rouã
.
d°
 = dst;

839 
rouã
.
gw
.
addr
 = gw;

841 
rouã
.
rdr_‰om
 =Ñdr_from;

843 
	`socks_addrouã
(&
rouã
, 1);

847 
rouãs
: { 
$$
 = 
NULL
; }

848 | 
rouãs
 
rouã


850 
¥oxy¥Ÿocﬁ
: 
PROXYPROTOCOL
 ':' 
¥oxy¥Ÿocﬁs


853 
¥oxy¥Ÿocﬁ«me
: 
PROXYPROTOCOL_SOCKS_V4
 {

854 
°©e
->
¥oxy¥Ÿocﬁ
.
socks_v4
 = 1;

856 | 
PROXYPROTOCOL_SOCKS_V5
 {

857 
°©e
->
¥oxy¥Ÿocﬁ
.
socks_v5
 = 1;

859 | 
PROXYPROTOCOL_HTTP
 {

860 
°©e
->
¥oxy¥Ÿocﬁ
.
hâp
 = 1;

862 | 
PROXYPROTOCOL_UPNP
 {

863 
°©e
->
¥oxy¥Ÿocﬁ
.
u≤p
 = 1;

865 | 
dïªˇãd


868 
¥oxy¥Ÿocﬁs
: 
¥oxy¥Ÿocﬁ«me


869 | 
¥oxy¥Ÿocﬁ«me
 
¥oxy¥Ÿocﬁs


872 
u£r
: 
USER
 ':' 
u£∫ames


875 
u£∫ame
: 
USERNAME
 {

876 #!
SOCKS_CLIENT


877 i‡(
	`addlöked«me
(&
ruÀ
.
u£r
, 
$1
Ë=
NULL
)

878 
	`yyîr‹
(
NOMEM
);

879 #
ídif


883 
u£∫ames
: 
u£∫ame


884 | 
u£∫ames
 
u£∫ame


887 
group
: 
GROUP
 ':' 
grou≤ames


890 
grou≤ame
: 
GROUPNAME
 {

891 #!
SOCKS_CLIENT


892 i‡(
	`addlöked«me
(&
ruÀ
.
group
, 
$1
Ë=
NULL
)

893 
	`yyîr‹
(
NOMEM
);

894 #
ídif


898 
grou≤ames
: 
grou≤ame


899 | 
grou≤ames
 
grou≤ame


902 
exãnsi⁄
: 
EXTENSION
 ':' 
exãnsi⁄s


905 
exãnsi⁄«me
: 
BIND
 {

906 
	`yyw¨nx
("weáre currently considering deprecatingÅhe Dante-specific "

910 
exãnsi⁄
->
böd
 = 1;

914 
exãnsi⁄s
: 
exãnsi⁄«me


915 | 
exãnsi⁄«me
 
exãnsi⁄s


918 
iÂrŸocﬁs
: 
iÂrŸocﬁ


919 | 
iÂrŸocﬁ
 
iÂrŸocﬁs


923 
iÂrŸocﬁ
: 
IPV4
 {

924 #!
SOCKS_CLIENT


925 
iÂrŸo
->
ùv4
 = 1;

927 | 
IPV6
 {

928 
iÂrŸo
->
ùv6
 = 1;

929 #
ídif


933 
öã∫Æ
: 
INTERNAL
 
öã∫Æöô
 ':' 
addªss
 {

934 #!
SOCKS_CLIENT


935 #
BAREFOOTD


936 
	`yyîr‹x
("\"öã∫Æ:\" s≥cifiˇti⁄ i†nŸ u£d i¿%s", 
PRODUCT
);

937 #
ídif


939 
öãrÁ˚¥Ÿocﬁ_t
 
iÂrŸozîo
;

941 
	`bzîo
(&
iÂrŸozîo
, (ifprotozero));

942 i‡(
	`memcmp
(&
iÂrŸozîo
,

943 &
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
,

944 (
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
)) == 0) {

945 
	`¶og
(
LOG_DEBUG
, "%s:Çoáddress familiesÉxplicitlyÉnabled on "

948 
fun˘i⁄
);

950 
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
.
ùv4
 = sockscf.öã∫Æ.¥Ÿocﬁ.
ùv6
 = 1;

953 
	`addöã∫Æ
(
ruÀaddr
, 
SOCKS_TCP
);

954 #
ídif


958 
öã∫Æöô
: {

959 #!
SOCKS_CLIENT


960 
ruÀaddr_t
 
mem
;

961 
£rvít
 *
£rvi˚
;

962 
£rvî°©e_t
 
°©emem
;

964 
	`bzîo
(&
°©emem
, (statemem));

965 
°©e
 = &
°©emem
;

966 
°©e
->
¥Ÿocﬁ
.
t˝
 = 1;

968 
	`bzîo
(&
log•ecül
, (logspecial));

970 
	`bzîo
(&
mem
, (mem));

971 
	`addröô
(&
mem
, 0);

974 i‡((
£rvi˚
 = 
	`gë£rvby«me
("socks", "t˝")Ë=
NULL
)

975 *
p‹t_t˝
 = 
	`ht⁄s
(
SOCKD_PORT
);

977 *
p‹t_t˝
 = (
ö_p‹t_t
)
£rvi˚
->
s_p‹t
;

978 #
ídif


982 
öã∫Æ_¥Ÿocﬁ
: 
INTERNAL_PROTOCOL
 ':' {

983 #!
SOCKS_CLIENT


984 i‡(
sockscf
.
öã∫Æ
.
addrc
 > 0) {

985 i‡(
sockscf
.
°©e
.
öôed
) {

995 
	`log_öãrÁ˚¥Ÿocﬁ_£t_too_œã
(
INTERNALIF
);

996 
	`exô
(1);

1000 
iÂrŸo
 = &
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
;

1001 #
ídif


1002 } 
iÂrŸocﬁs


1007 
exã∫Æ
: 
EXTERNAL
 
exã∫Æöô
 ':' 
exã∫Æaddªss
 {

1008 #!
SOCKS_CLIENT


1009 
	`addexã∫Æ
(
ruÀaddr
);

1010 #
ídif


1014 
exã∫Æöô
: {

1015 #!
SOCKS_CLIENT


1016 
ruÀaddr_t
 
mem
;

1017 
öãrÁ˚¥Ÿocﬁ_t
 
iÂrŸozîo
 = { 0 };

1019 
	`bzîo
(&
mem
, (mem));

1020 
	`addröô
(&
mem
, 0);

1022 i‡(
	`memcmp
(&
iÂrŸozîo
,

1023 &
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
,

1024 (
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
)) == 0) {

1025 
	`¶og
(
LOG_DEBUG
, "%s:Çoáddress familiesÉxplicitlyÉnabled on "

1028 
fun˘i⁄
);

1030 
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
.
ùv4
 = sockscf.exã∫Æ.¥Ÿocﬁ.
ùv6
 = 1;

1032 #
ídif


1036 
exã∫Æ_¥Ÿocﬁ
: 
EXTERNAL_PROTOCOL
 ':' {

1037 #!
SOCKS_CLIENT


1038 i‡(
sockscf
.
exã∫Æ
.
addrc
 > 0) {

1039 
	`log_öãrÁ˚¥Ÿocﬁ_£t_too_œã
(
EXTERNALIF
);

1040 
	`sockdexô
(
EXIT_FAILURE
);

1043 
iÂrŸo
 = &
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
;

1044 #
ídif


1045 } 
iÂrŸocﬁs


1049 
exã∫Æ_rŸ©i⁄
: 
EXTERNAL_ROTATION
 ':' 
NONE
 {

1050 #!
SOCKS_CLIENT


1051 
sockscf
.
exã∫Æ
.
rŸ©i⁄
 = 
ROTATION_NONE
;

1053 | 
EXTERNAL_ROTATION
 ':' 
SAMESAME
 {

1054 
sockscf
.
exã∫Æ
.
rŸ©i⁄
 = 
ROTATION_SAMESAME
;

1056 | 
EXTERNAL_ROTATION
 ':' 
ROUTE
 {

1057 
sockscf
.
exã∫Æ
.
rŸ©i⁄
 = 
ROTATION_ROUTE
;

1058 #
ídif


1062 
˛õ¡›ti⁄
: 
debuggög


1063 | 
dïªˇãd


1064 | 
globÆ_rouã›ti⁄


1065 | 
îr‹log


1066 | 
logouçut


1067 | 
ªsﬁvïrŸocﬁ


1068 | 
timeout
;

1071 
˛õ¡›ti⁄s
: { 
$$
 = 
NULL
; }

1072 | 
˛õ¡›ti⁄
 
˛õ¡›ti⁄s


1075 
globÆ_rouã›ti⁄
: 
GLOBALROUTEOPTION
 
MAXFAIL
 ':' 
NUMBER
 {

1076 i‡(
$4
 < 0)

1077 
	`yyîr‹x
("maxÑoute fails canÇot beÇegative (%ld) Use \"0\"Åo "

1079 ()
$4
);

1081 
sockscf
.
rouã›ti⁄s
.
maxÁû
 = 
$4
;

1083 | 
GLOBALROUTEOPTION
 
BADROUTE_EXPIRE
 ':' 
NUMBER
 {

1084 i‡(
$4
 < 0)

1085 
	`yyîr‹x
("route failureÉxpiryÅime canÇot beÇegative (%ld). "

1087 ()
$4
);

1089 
sockscf
.
rouã›ti⁄s
.
badexpúe
 = 
$4
;

1093 
îr‹log
: 
ERRORLOG
 ':' { 
add_to_îæog
 = 1; } 
logouçutdevi˚s


1096 
logouçut
: 
LOGOUTPUT
 ':' { 
add_to_îæog
 = 0; } 
logouçutdevi˚s


1099 
logouçutdevi˚
: 
LOGFILE
 {

1100 
p
;

1102 i‡((
add_to_îæog
 && 
Áûed_to_add_îæog
)

1103 || (!
add_to_îæog
 && 
Áûed_to_add_log
)) {

1104 
	`yyw¨nx
("nŸáddögÜogfûê\"%s\"", 
$1
);

1106 
	`¶og
(
LOG_ALERT
,

1112 
fun˘i⁄
, 
$1
);

1115 
p
 = 
	`socks_addlogfûe
(
add_to_îæog
 ? &
sockscf
.
îæog
 : &sockscf.
log
, 
$1
);

1117 #!
SOCKS_CLIENT


1118 i‡(
sockscf
.
°©e
.
öôed
) {

1119 i‡(
p
 == -1) {

1120 i‡(
add_to_îæog
) {

1121 
sockscf
.
îæog
 = 
ﬁd_îæog
;

1122 
Áûed_to_add_îæog
 = 1;

1125 
sockscf
.
log
 = 
ﬁd_log
;

1126 
Áûed_to_add_log
 = 1;

1130 
	`sockd_‰ìlogobje˘
(
add_to_îæog
 ? &
ﬁd_îæog
 : &
ﬁd_log
, 1);

1131 
	`¶og
(
LOG_DEBUG
, "%s:áddedÜogfile \"%s\"Åo %s",

1132 
fun˘i⁄
, 
$1
, 
add_to_îæog
 ? "errlog" : "logoutput");

1136 i‡(
p
 == -1)

1137 
	`¶og
(
LOG_ALERT
, "%s: couldÇot (re)openÜogfile \"%s\": %s%s %s",

1138 
fun˘i⁄
,

1139 
$1
,

1140 
	`°ªº‹
(
î∫o
),

1141 
sockscf
.
°©e
.
öôed
 ?

1143 
sockscf
.
°©e
.
öôed
 ?

1147 i‡(
p
 == -1)

1151 
	`yyw¨n
("ÁûedÅÿaddÜogfûê%s", 
$1
);

1152 #
ídif


1156 
logouçutdevi˚s
: 
logouçutdevi˚


1157 | 
logouçutdevi˚
 
logouçutdevi˚s


1160 
chûd°©e
: 
PROC_MAXREQUESTS
 ':' 
NUMBER
 {

1161 #!
SOCKS_CLIENT


1162 
	`ASSIGN_NUMBER
(
$3
, >=, 0, 
sockscf
.
chûd
.
maxªque°s
, 0);

1163 #
ídif


1167 
u£rids
: 
u£r_¥ivûeged


1168 | 
u£r_u≈rivûeged


1169 | 
u£r_libwøp


1172 
u£r_¥ivûeged
: 
USER_PRIVILEGED
 ':' 
u£rid
 {

1173 #!
SOCKS_CLIENT


1174 #
HAVE_PRIVILEGES


1175 
	`yyîr‹x
("userid-settingsÇot used onÖlatforms withÖrivileges");

1177 
sockscf
.
uid
.
¥ivûeged_uid
 = 
$3
.uid;

1178 
sockscf
.
uid
.
¥ivûeged_gid
 = 
$3
.
gid
;

1179 
sockscf
.
uid
.
¥ivûeged_is£t
 = 1;

1180 #
ídif


1181 #
ídif


1185 
u£r_u≈rivûeged
: 
USER_UNPRIVILEGED
 ':' 
u£rid
 {

1186 #!
SOCKS_CLIENT


1187 #
HAVE_PRIVILEGES


1188 
	`yyîr‹x
("userid-settingsÇot used onÖlatforms withÖrivileges");

1190 
sockscf
.
uid
.
u≈rivûeged_uid
 = 
$3
.uid;

1191 
sockscf
.
uid
.
u≈rivûeged_gid
 = 
$3
.
gid
;

1192 
sockscf
.
uid
.
u≈rivûeged_is£t
 = 1;

1193 #
ídif


1194 #
ídif


1198 
u£r_libwøp
: 
USER_LIBWRAP
 ':' 
u£rid
 {

1199 #
HAVE_LIBWRAP
 && (!
SOCKS_CLIENT
)

1201 #
HAVE_PRIVILEGES


1202 
	`yyîr‹x
("userid-settingsÇot used onÖlatforms withÖrivileges");

1205 
sockscf
.
uid
.
libwøp_uid
 = 
$3
.uid;

1206 
sockscf
.
uid
.
libwøp_gid
 = 
$3
.
gid
;

1207 
sockscf
.
uid
.
libwøp_is£t
 = 1;

1208 #
ídif


1211 
	`yyîr‹x_nﬁib
("libwrap");

1212 #
ídif


1217 
u£rid
: 
USERNAME
 {

1218 
∑sswd
 *
pw
;

1220 i‡((
pw
 = 
	`gëpw«m
(
$1
)Ë=
NULL
)

1221 
	`yyîr‹
("gëpw«m(3Ëßy†nÿsuch u£∏\"%s\"", 
$1
);

1223 
$$
.
uid
 = 
pw
->
pw_uid
;

1225 i‡((
pw
 = 
	`gëpwuid
(
$$
.
uid
)Ë=
NULL
)

1226 
	`yyîr‹
("getpwuid(3) saysÇo such uid %lu (from user \"%s\")",

1227 ()
$$
.
uid
, 
$1
);

1229 
$$
.
gid
 = 
pw
->
pw_gid
;

1233 
iŸimeout
: 
IOTIMEOUT
 ':' 
NUMBER
 {

1234 #!
SOCKS_CLIENT


1235 
	`ASSIGN_NUMBER
(
$3
, >=, 0, 
timeout
->
t˝io
, 1);

1236 
timeout
->
udpio
 =Åimeout->
t˝io
;

1238 | 
IOTIMEOUT_TCP
 ':' 
NUMBER
 {

1239 
	`ASSIGN_NUMBER
(
$3
, >=, 0, 
timeout
->
t˝io
, 1);

1241 | 
IOTIMEOUT_UDP
 ':' 
NUMBER
 {

1242 
	`ASSIGN_NUMBER
(
$3
, >=, 0, 
timeout
->
udpio
, 1);

1243 #
ídif


1247 
√gŸüãtimeout
: 
NEGOTIATETIMEOUT
 ':' 
NUMBER
 {

1248 #!
SOCKS_CLIENT


1249 
	`ASSIGN_NUMBER
(
$3
, >=, 0, 
timeout
->
√gŸüã
, 1);

1250 #
ídif


1254 
c⁄√˘timeout
: 
CONNECTTIMEOUT
 ':' 
NUMBER
 {

1255 
	`ASSIGN_NUMBER
(
$3
, >=, 0, 
timeout
->
c⁄√˘
, 1);

1259 
t˝_fö_timeout
: 
TCP_FIN_WAIT
 ':' 
NUMBER
 {

1260 #!
SOCKS_CLIENT


1261 
	`ASSIGN_NUMBER
(
$3
, >=, 0, 
timeout
->
t˝_fö_waô
, 1);

1262 #
ídif


1267 
debuggög
: 
DEBUGGING
 ':' 
NUMBER
 {

1268 #
SOCKS_CLIENT


1270 
sockscf
.
›ti⁄
.
debug
 = ()
$3
;

1274 i‡(
sockscf
.
öôül
.
cmdlöe
.
debug_is£t


1275 && 
sockscf
.
öôül
.
cmdlöe
.
debug
 !
$3
)

1276 
	`LOG_CMDLINE_OVERRIDE
("debug",

1277 
sockscf
.
öôül
.
cmdlöe
.
debug
,

1278 ()
$3
,

1281 
sockscf
.
›ti⁄
.
debug
 = ()
$3
;

1283 #
ídif


1287 
libwøpfûes
: 
libwøp_Ælowfûe


1288 | 
libwøp_díyfûe


1291 
libwøp_Ælowfûe
: 
LIBWRAP_ALLOW
 ':' 
LIBWRAP_FILE
 {

1292 #!
SOCKS_CLIENT


1293 #
HAVE_LIBWRAP


1294 i‡((
ho°s_Ælow_èbÀ
 = 
	`°rdup
(
$3
)Ë=
NULL
)

1295 
	`yyîr‹
(
NOMEM
);

1297 
	`¶og
(
LOG_DEBUG
, "%s:Üibwøp.Ælow: %s", 
fun˘i⁄
, 
ho°s_Ælow_èbÀ
);

1299 
	`yyîr‹x_nﬁib
("libwrap");

1300 #
ídif


1301 #
ídif


1305 
libwøp_díyfûe
: 
LIBWRAP_DENY
 ':' 
LIBWRAP_FILE
 {

1306 #!
SOCKS_CLIENT


1307 #
HAVE_LIBWRAP


1308 i‡((
ho°s_díy_èbÀ
 = 
	`°rdup
(
$3
)Ë=
NULL
)

1309 
	`yyîr‹
(
NOMEM
);

1311 
	`¶og
(
LOG_DEBUG
, "%s:Üibwøp.díy: %s", 
fun˘i⁄
, 
ho°s_díy_èbÀ
);

1313 
	`yyîr‹x_nﬁib
("libwrap");

1314 #
ídif


1315 #
ídif


1319 
libwøp_ho°s_ac˚ss
: 
LIBWRAP_HOSTS_ACCESS
 ':' 
YES
 {

1320 #!
SOCKS_CLIENT


1321 #
HAVE_LIBWRAP


1322 
sockscf
.
›ti⁄
.
ho°s_ac˚ss
 = 1;

1324 
	`yyîr‹x
("libwrap.hosts_accessÑequiresÜibwrapÜibrary");

1325 #
ídif


1327 | 
LIBWRAP_HOSTS_ACCESS
 ':' 
NO
 {

1328 #
HAVE_LIBWRAP


1329 
sockscf
.
›ti⁄
.
ho°s_ac˚ss
 = 0;

1331 
	`yyîr‹x_nﬁib
("libwrap");

1332 #
ídif


1333 #
ídif


1337 
udpc⁄√˘d°
: 
UDPCONNECTDST
 ':' 
YES
 {

1338 #!
SOCKS_CLIENT


1339 
sockscf
.
udpc⁄√˘d°
 = 1;

1341 | 
UDPCONNECTDST
 ':' 
NO
 {

1342 
sockscf
.
udpc⁄√˘d°
 = 0;

1343 #
ídif


1348 
com∑tibûôy
: 
COMPATIBILITY
 ':' 
com∑tibûôy«mes


1351 
com∑tibûôy«me
: 
SAMEPORT
 {

1352 #!
SOCKS_CLIENT


1353 
sockscf
.
com∑t
.
ßmï‹t
 = 1;

1355 | 
DRAFT_5_05
 {

1356 
sockscf
.
com∑t
.
dø·_5_05
 = 1;

1357 #
ídif


1361 
com∑tibûôy«mes
: 
com∑tibûôy«me


1362 | 
com∑tibûôy«me
 
com∑tibûôy«mes


1365 
ªsﬁvïrŸocﬁ
: 
RESOLVEPROTOCOL
 ':' 
ªsﬁvïrŸocﬁ«me


1368 
ªsﬁvïrŸocﬁ«me
: 
PROTOCOL_FAKE
 {

1369 
sockscf
.
ªsﬁvïrŸocﬁ
 = 
RESOLVEPROTOCOL_FAKE
;

1371 | 
PROTOCOL_TCP
 {

1372 #
HAVE_NO_RESOLVESTUFF


1373 
	`yyîr‹x
("resolveprotocol keywordÇot supported onÅhis system");

1375 
sockscf
.
ªsﬁvïrŸocﬁ
 = 
RESOLVEPROTOCOL_TCP
;

1376 #
ídif


1378 | 
PROTOCOL_UDP
 {

1379 
sockscf
.
ªsﬁvïrŸocﬁ
 = 
RESOLVEPROTOCOL_UDP
;

1383 
˝u
: 
˝uscheduÀ


1384 | 
˝uafföôy


1387 
˝uscheduÀ
: 
CPU
 '.' 
SCHEDULE
 '.' 
PROCESSTYPE
 ':' 
SCHEDULEPOLICY
 '/' 
NUMBER
 {

1388 #!
SOCKS_CLIENT


1389 #!
HAVE_SCHED_SETSCHEDULER


1390 
	`yyîr‹x
("cpu schedulingÖolicy isÇot supported onÅhis system");

1392 
˝u£âög_t
 *
˝u£âög
;

1394 
$5
) {

1395 
PROC_MOTHER
:

1396 
˝u£âög
 = &
sockscf
.
˝u
.
mŸhî
;

1399 
PROC_MONITOR
:

1400 
˝u£âög
 = &
sockscf
.
˝u
.
m⁄ô‹
;

1403 
PROC_NEGOTIATE
:

1404 
˝u£âög
 = &
sockscf
.
˝u
.
√gŸüã
;

1407 
PROC_REQUEST
:

1408 
˝u£âög
 = &
sockscf
.
˝u
.
ªque°
;

1411 
PROC_IO
:

1412 
˝u£âög
 = &
sockscf
.
˝u
.
io
;

1416 
	`SERRX
(
$5
);

1419 
	`bzîo
(&
˝u£âög
->
∑øm
, (cpusetting->param));

1421 
˝u£âög
->
schedulög_is£t
 = 1;

1422 
˝u£âög
->
pﬁicy
 = 
$7
;

1423 
˝u£âög
->
∑øm
.
sched_¥i‹ôy
 = ()
$9
;

1424 #
ídif


1425 #
ídif


1429 
˝uafföôy
: 
CPU
 '.' 
MASK
 '.' 
PROCESSTYPE
 ':' 
numbîs
 {

1430 #!
SOCKS_CLIENT


1431 #!
HAVE_SCHED_SETAFFINITY


1432 
	`yyîr‹x
("cpu schedulingáffinity isÇot supported onÅhis system");

1434 
˝u£âög_t
 *
˝u£âög
;

1436 
$5
) {

1437 
PROC_MOTHER
:

1438 
˝u£âög
 = &
sockscf
.
˝u
.
mŸhî
;

1441 
PROC_MONITOR
:

1442 
˝u£âög
 = &
sockscf
.
˝u
.
m⁄ô‹
;

1445 
PROC_NEGOTIATE
:

1446 
˝u£âög
 = &
sockscf
.
˝u
.
√gŸüã
;

1449 
PROC_REQUEST
:

1450 
˝u£âög
 = &
sockscf
.
˝u
.
ªque°
;

1453 
PROC_IO
:

1454 
˝u£âög
 = &
sockscf
.
˝u
.
io
;

1458 
	`SERRX
(
$5
);

1461 
	`˝u_zîo
(&
˝u£âög
->
mask
);

1462 
numbîc
-- > 0)

1463 i‡(
numbîv
[
numbîc
] =
CPUMASK_ANYCPU
) {

1464 c⁄° 
˝us
 = 
	`sysc⁄f
(
_SC_NPROCESSORS_ONLN
);

1465 
i
;

1467 i‡(
˝us
 == -1)

1468 
	`yyîr‹
("sysconf(_SC_NPROCESSORS_ONLN) failed");

1470 
i
 = 0; i < 
˝us
; ++i)

1471 
	`˝u_£t
(()
i
, &
˝u£âög
->
mask
);

1473 i‡(
numbîv
[
numbîc
] < 0)

1474 
	`yyîr‹x
("invalid CPUÇumber: %ld. The CPUÇumber canÇot be "

1475 "√g©ive", ()
numbîv
[
numbîc
]);

1477 
	`˝u_£t
(
numbîv
[
numbîc
], &
˝u£âög
->
mask
);

1479 
	`‰ì
(
numbîv
);

1480 
numbîv
 = 
NULL
;

1481 
numbîc
 = 0;

1483 
˝u£âög
->
afföôy_is£t
 = 1;

1485 #
ídif


1486 #
ídif


1490 
sockë›ti⁄
: 
sockëside
 
SOCKETPROTOCOL
 '.' {

1491 #!
SOCKS_CLIENT


1492 
sockë›t
.
Àvñ
 = 
$2
;

1493 #
ídif


1494 } 
sockë›ti⁄«me
 ':' 
sockë›ti⁄vÆue


1497 
sockë›ti⁄«me
: 
NUMBER
 {

1498 #!
SOCKS_CLIENT


1499 
sockë›t
.
›äame
 = 
$1
;

1500 
sockë›t
.
öfo
 = 
	`›tvÆ2sock›t
(sockë›t.
Àvñ
, sockë›t.
›äame
);

1502 i‡(
sockë›t
.
öfo
 =
NULL
)

1503 
	`¶og
(
LOG_DEBUG
,

1505 
fun˘i⁄
, 
sockë›t
.
Àvñ
, sockë›t.
›äame
);

1507 
	`sockë›ti⁄check
(&
sockë›t
);

1509 | 
SOCKETOPTION_OPTID
 {

1510 
sockë›t
.
öfo
 = 
	`›tid2sock›t
((
size_t
)
$1
);

1511 
	`SASSERTX
(
sockë›t
.
öfo
 !
NULL
);

1513 
sockë›t
.
›äame
 = sockë›t.
öfo
->
vÆue
;

1515 
	`sockë›ti⁄check
(&
sockë›t
);

1516 #
ídif


1520 
sockë›ti⁄vÆue
: 
NUMBER
 {

1521 
sockë›t
.
›tvÆ
.
öt_vÆ
 = ()
$1
;

1522 
sockë›t
.
›ây≥
 = 
öt_vÆ
;

1524 | 
SOCKETOPTION_SYMBOLICVALUE
 {

1525 c⁄° 
sock›tvÆsym_t
 *
p
;

1527 i‡(
sockë›t
.
öfo
 =
NULL
)

1528 
	`yyîr‹x
("the given socket option is unknown, so canÇotÜookup "

1531 i‡((
p
 = 
	`›tvÆ2vÆsym
(
sockë›t
.
öfo
->
›tid
, 
$1
)Ë=
NULL
)

1532 
	`yyîr‹x
("symbolic value \"%s\" is unknown for socket option %s",

1533 
$1
, 
	`sock›t2°rög
(&
sockë›t
, 
NULL
, 0));

1535 
sockë›t
.
›tvÆ
 = 
p
->
symvÆ
;

1536 
sockë›t
.
›ây≥
 = sockë›t.
öfo
->opttype;

1541 
sockëside
: 
INTERNALSOCKET
 { 
	`bzîo
(&
sockë›t
, (socketopt));

1542 
sockë›t
.
isöã∫Æside
 = 1;

1544 | 
EXTERNALSOCKET
 { 
	`bzîo
(&
sockë›t
, (socketopt));

1545 
sockë›t
.
isöã∫Æside
 = 0;

1550 
§cho°
: 
SRCHOST
 ':' 
§cho°›ti⁄s


1553 
§cho°›ti⁄
: 
NODNSMISMATCH
 {

1554 #!
SOCKS_CLIENT


1555 
sockscf
.
§cho°
.
nodnsmism©ch
 = 1;

1557 | 
NODNSUNKNOWN
 {

1558 
sockscf
.
§cho°
.
nodnsunknown
 = 1;

1560 | 
CHECKREPLYAUTH
 {

1561 
sockscf
.
§cho°
.
checkª∂yauth
 = 1;

1562 #
ídif


1566 
§cho°›ti⁄s
: 
§cho°›ti⁄


1567 | 
§cho°›ti⁄
 
§cho°›ti⁄s


1570 
ªÆm
: 
REALM
 ':' 
REALNAME
 {

1571 #
COVENANT


1572 
	`STRCPY_CHECKLEN
(
sockscf
.
ªÆm«me
,

1573 
$3
,

1574 (
sockscf
.
ªÆm«me
) - 1,

1575 
yyîr‹x
);

1577 
	`yyîr‹x
("unknow¿keyw‹d \"%s\"", 
$1
);

1578 #
ídif


1582 
globÆ_˛õ¡mëhod
: 
CLIENTMETHOD
 ':' {

1583 #!
SOCKS_CLIENT


1585 
cmëhodv
 = 
sockscf
.cmethodv;

1586 
cmëhodc
 = &
sockscf
.cmethodc;

1587 *
cmëhodc
 = 0;

1589 #
ídif


1590 } 
˛õ¡mëhods


1593 
globÆ_socksmëhod
: 
SOCKSMETHOD
 ':' {

1594 #
HAVE_SOCKS_RULES


1596 
smëhodv
 = 
sockscf
.smethodv;

1597 
smëhodc
 = &
sockscf
.smethodc;

1598 *
smëhodc
 = 0;

1601 
	`yyîr‹x
("\"socksmethod\" isÇot used in %s. Only \"clientmethod\" "

1603 
PRODUCT
);

1604 #
ídif


1605 } 
socksmëhods


1608 
socksmëhod
: 
SOCKSMETHOD
 ':' 
socksmëhods


1611 
socksmëhods
: 
socksmëhod«me


1612 | 
socksmëhod«me
 
socksmëhods


1615 
socksmëhod«me
: 
METHODNAME
 {

1616 i‡(
	`mëhodisvÆid
(
$1
, 
obje˘_§uÀ
))

1617 
	`ADDMETHOD
(
$1
, *
smëhodc
, 
smëhodv
);

1619 
	`yyîr‹x
("method %s (%d) isÇotá valid method for socksmethods",

1620 
	`mëhod2°rög
(
$1
), $1);

1624 
˛õ¡mëhod
: 
CLIENTMETHOD
 ':' 
˛õ¡mëhods


1627 
˛õ¡mëhods
: 
˛õ¡mëhod«me


1628 | 
˛õ¡mëhod«me
 
˛õ¡mëhods


1632 
˛õ¡mëhod«me
: 
METHODNAME
 {

1633 i‡(
	`mëhodisvÆid
(
$1
, 
obje˘_¸uÀ
))

1634 
	`ADDMETHOD
(
$1
, *
cmëhodc
, 
cmëhodv
);

1636 
	`yyîr‹x
("method %s (%d) isÇotá valid method for clientmethods",

1637 
	`mëhod2°rög
(
$1
), $1);

1640 
m⁄ô‹
: 
MONITOR
 { 
obje˘ty≥
 = 
obje˘_m⁄ô‹
; } '{' {

1641 #!
SOCKS_CLIENT


1642 
	`m⁄ô‹öô
(&
m⁄ô‹
);

1643 #
ídif


1644 } 
m⁄ô‹›ti⁄s
 
‰omto
 monitoroptions '}'

1646 #!
SOCKS_CLIENT


1647 
	`¥e_addm⁄ô‹
(&
m⁄ô‹
);

1649 
	`addm⁄ô‹
(&
m⁄ô‹
);

1650 #
ídif


1657 
¸uÀ
: 
CLIENTRULE
 { 
obje˘ty≥
 = 
obje˘_¸uÀ
; } 
vîdi˘
 '{'

1658 
¸uÀ›ti⁄s
 
‰omto
 cruleoptions '}' {

1659 #!
SOCKS_CLIENT


1660 #
BAREFOOTD


1661 i‡(
boun˚to
.
©y≥
 =
SOCKS_ADDR_NOTSET
) {

1662 i‡(
ruÀ
.
vîdi˘
 =
VERDICT_PASS
)

1663 
	`yyîr‹x
("noáddressÅraffic should bounceÅo has been given");

1669 
boun˚to
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

1670 
boun˚to
.
addr
.
ùv4
.
ù
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

1671 
boun˚to
.
p‹t
.
t˝
 = 
	`ht⁄s
(0);

1672 
boun˚to
.
p‹t
.
udp
 = 
	`ht⁄s
(0);

1676 
ruÀ
.
exåa
.
boun˚to
 = bounceto;

1677 #
ídif


1679 
	`¥e_addruÀ
(&
ruÀ
);

1680 
	`add˛õ¡ruÀ
(&
ruÀ
);

1681 
	`po°_addruÀ
();

1682 #
ídif


1686 
Æ¨m
: 
Æ¨m_d©a


1687 | 
Æ¨m_disc⁄√˘


1688 | 
Æ¨m_ã°


1691 
m⁄ô‹side
: {

1692 #!
SOCKS_CLIENT


1693 
m⁄ô‹if
 = 
NULL
;

1695 | 
ALARMIF_INTERNAL
 {

1696 
m⁄ô‹if
 = &
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
;

1698 | 
ALARMIF_EXTERNAL
 {

1699 
m⁄ô‹if
 = &
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
;

1700 #
ídif


1704 
Æ¨mside
: {

1705 #!
SOCKS_CLIENT


1706 
Æ¨mside
 = 
NULL
;

1708 | 
RECVSIDE
 {

1709 *
Æ¨mside
 = 
RECVSIDE
;

1711 | 
SENDSIDE
 {

1712 *
Æ¨mside
 = 
SENDSIDE
;

1713 #
ídif


1717 
Æ¨m_d©a
: 
m⁄ô‹side
 
ALARMTYPE_DATA
 { 
	`Æ¨möô
(); } 
Æ¨mside
 ':'

1718 
NUMBER
 
WORD__IN
 NUMBER {

1719 #!
SOCKS_CLIENT


1720 
Æ¨m_d©a_limô_t
 
limô
;

1722 
	`ASSIGN_NUMBER
(
$6
, >=, 0, 
limô
.
byãs
, 0);

1723 
	`ASSIGN_NUMBER
(
$8
, >, 0, 
limô
.
£c⁄ds
, 1);

1725 
m⁄ô‹
.
Æ¨msc⁄figuªd
 |
ALARM_DATA
;

1727 i‡(
m⁄ô‹
.
Æ¨m_d©a_aggªg©e
 != 0)

1728 
	`yyîr‹x
("oneággregated dataálarm hasálready been specified. "

1731 i‡(
m⁄ô‹if
 =
NULL
) {

1732 
m⁄ô‹
.
Æ¨m_d©a_aggªg©e
 = 
ALARM_INTERNAL
 | 
ALARM_EXTERNAL
;

1734 i‡(
Æ¨mside
 =
NULL
)

1735 
m⁄ô‹
.
Æ¨m_d©a_aggªg©e
 |
ALARM_RECV
 | 
ALARM_SEND
;

1737 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
RECVSIDE
) {

1738 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


1740 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
limô
 =Üimit;

1743 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
SENDSIDE
) {

1744 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd


1746 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
limô
 =Üimit;

1749 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
RECVSIDE
) {

1750 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


1752 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
limô
 =Üimit;

1755 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
SENDSIDE
) {

1756 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd


1758 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
limô
 =Üimit;

1762 i‡(
Æ¨mside
 =
NULL
)

1763 
m⁄ô‹
.
Æ¨m_d©a_aggªg©e
 = 
ALARM_RECV
 | 
ALARM_SEND
;

1765 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
RECVSIDE
) {

1766 
m⁄ô‹if
->
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
 = 1;

1767 
m⁄ô‹if
->
Æ¨m
.
d©a
.
ªcv
.
limô
 =Üimit;

1770 i‡(
Æ¨mside
 =
NULL
 || *Æ¨msidê=
SENDSIDE
) {

1771 
m⁄ô‹if
->
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
 = 1;

1772 
m⁄ô‹if
->
Æ¨m
.
d©a
.
£nd
.
limô
 =Üimit;

1775 #
ídif


1779 
Æ¨m_ã°
: 
m⁄ô‹side
 
ALARM
 '.' 
√tw‹k¥obÀm


1782 
√tw‹k¥obÀm
: 
MTU_ERROR
 {

1783 #!
SOCKS_CLIENT


1784 
m⁄ô‹
.
Æ¨msc⁄figuªd
 |
ALARM_TEST
;

1786 i‡(
m⁄ô‹if
 =
NULL
) {

1787 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
ã°
.
mtu
.
dŸe°
 = 1;

1788 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
ã°
.
mtu
.
dŸe°
 = 1;

1791 
m⁄ô‹if
->
Æ¨m
.
ã°
.
mtu
.
dŸe°
 = 1;

1792 
m⁄ô‹if
->
Æ¨m
.
ã°
.
mtu
.
dŸe°
 = 1;

1794 #
ídif


1799 
Æ¨m_disc⁄√˘
:

1800 
m⁄ô‹side
 
ALARMTYPE_DISCONNECT
 ':' 
NUMBER
 '/' NUMBER 
Æ¨m≥riod
 {

1801 #!
SOCKS_CLIENT


1802 
Æ¨m_disc⁄√˘_limô_t
 
limô
;

1804 
	`ASSIGN_NUMBER
(
$6
, >, 0, 
limô
.
£ssi⁄c
, 0);

1805 
	`ASSIGN_NUMBER
(
$4
, >, 0, 
limô
.
disc⁄√˘c
, 0);

1806 
	`ASSIGN_NUMBER
(
$7
, >, 0, 
limô
.
£c⁄ds
, 1);

1808 i‡(
m⁄ô‹
.
Æ¨m_disc⁄√˘_aggªg©e
 != 0)

1809 
	`yyîr‹x
("oneággregated disconnectálarm hasálready been specified. "

1812 
m⁄ô‹
.
Æ¨msc⁄figuªd
 |
ALARM_DISCONNECT
;

1814 i‡(
m⁄ô‹if
 =
NULL
) {

1815 
m⁄ô‹
.
Æ¨m_disc⁄√˘_aggªg©e
 = 
ALARM_INTERNAL
 | 
ALARM_EXTERNAL
;

1817 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
 = 1;

1818 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
 =Üimit;

1820 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
.
Æ¨m
.
disc⁄√˘


1821 
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
öã∫Æ
.
Æ¨m
.
disc⁄√˘
;

1824 
m⁄ô‹if
->
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
 = 1;

1825 
m⁄ô‹if
->
Æ¨m
.
disc⁄√˘
.
limô
 =Üimit;

1827 #
ídif


1831 
Æ¨m≥riod
: {

1832 #!
SOCKS_CLIENT


1833 
$$
 = 
DEFAULT_ALARM_PERIOD
;

1834 #
ídif


1836 | 
WORD__IN
 
NUMBER
 { 
$$
 = 
$2
; }

1839 
m⁄ô‹›ti⁄
: 
Æ¨m


1840 | 
comm™d


1841 | 
ho°id›ti⁄
 { *
ho°id›ti⁄_is£t
 = 1; }

1842 | 
¥Ÿocﬁ


1845 
m⁄ô‹›ti⁄s
: { 
$$
 = 
NULL
; }

1846 | 
m⁄ô‹›ti⁄
 
m⁄ô‹›ti⁄s
;

1849 
¸uÀ›ti⁄
: 
boun˚
 {

1850 #!
BAREFOOTD


1851 
	`yyîr‹x
("unsupported option");

1852 #
ídif


1854 | 
¥Ÿocﬁ
 {

1855 #!
BAREFOOTD


1856 
	`yyîr‹x
("unsupported option");

1857 #
ídif


1859 | 
˛õ¡com∑tibûôy


1860 | 
¸uÀ£ssi⁄›ti⁄
 {

1861 #!
SOCKS_CLIENT


1862 
£ssi⁄_is£t
 = 1;

1863 #
ídif


1865 | 
gíîi¸uÀ›ti⁄


1869 
¸uÀ›ti⁄s
: { 
$$
 = 
NULL
; }

1870 | 
¸uÀ›ti⁄
 
¸uÀ›ti⁄s


1873 
hruÀ
: 
HOSTIDRULE
 { 
obje˘ty≥
 = 
obje˘_hruÀ
; } 
vîdi˘
 '{'

1874 
¸uÀ›ti⁄s
 
ho°id_‰omto
 cruleoptions '}' {

1875 #!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


1876 i‡(
ho°id
.
©y≥
 !
SOCKS_ADDR_NOTSET
)

1877 
	`yyîr‹x
("it doesÇot make senseÅo setÅhe hostidáddress iná "

1881 *
ho°id›ti⁄_is£t
 = 1;

1883 
	`¥e_addruÀ
(&
ruÀ
);

1884 
	`addho°idruÀ
(&
ruÀ
);

1885 
	`po°_addruÀ
();

1887 
	`yyîr‹x
("hostid isÇot supported onÅhis system");

1888 #
ídif


1892 
ho°id›ti⁄
: 
ho°id


1893 | 
ho°ödex
;

1896 
ho°id
: 
HOSTID
 ':' {

1897 #!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


1898 
	`addröô
(&
ho°id
, 1);

1901 
	`yyîr‹x
("hostid isÇot supported onÅhis system");

1902 #
ídif


1904 } 
addªss_wôhout_p‹t


1907 
ho°ödex
: 
HOSTINDEX
 ':' 
NUMBER
 {

1908 #!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


1909 
	`ASSIGN_NUMBER
(
$3
, >=, 0, *
ho°ödex
, 0);

1910 
	`ASSIGN_NUMBER
(
$3
, <=, 
HAVE_MAX_HOSTIDS
, *
ho°ödex
, 0);

1913 
	`yyîr‹x
("hostid isÇot supported onÅhis system");

1914 #
ídif


1919 
§uÀ
: 
SOCKSRULE
 { 
obje˘ty≥
 = 
obje˘_§uÀ
; } 
vîdi˘
 '{'

1920 
§uÀ›ti⁄s
 
‰omto
 sruleoptions '}' {

1921 #!
SOCKS_CLIENT


1922 #!
HAVE_SOCKS_RULES


1923 
	`yyîr‹x
("socks-ruÀ†¨ênŸ u£d i¿%s", 
PRODUCT
);

1924 #
ídif


1926 
	`¥e_addruÀ
(&
ruÀ
);

1927 
	`addsock§uÀ
(&
ruÀ
);

1928 
	`po°_addruÀ
();

1929 #
ídif


1934 
§uÀ›ti⁄s
: { 
$$
 = 
NULL
; }

1935 | 
§uÀ›ti⁄
 
§uÀ›ti⁄s


1939 
§uÀ›ti⁄
: 
bsdauth°yÀ«me


1940 | 
comm™d


1941 | 
gíîi¸uÀ›ti⁄


1942 | 
ld≠›ti⁄


1943 | 
¥Ÿocﬁ


1944 | 
¥oxy¥Ÿocﬁ


1945 | 
socks£ssi⁄›ti⁄
 {

1946 #!
SOCKS_CLIENT


1947 
£ssi⁄_is£t
 = 1;

1948 #
ídif


1950 | 
udµ‹å™ge


1954 
gíîi¸uÀ›ti⁄
: 
b™dwidth
 {

1955 #!
SOCKS_CLIENT


1956 
	`checkmoduÀ
("bandwidth");

1957 
bw_is£t
 = 1;

1958 #
ídif


1960 | 
˛õ¡mëhod


1961 | 
socksmëhod


1962 | 
ruÀ_exã∫Æ_log›ti⁄


1963 | 
group


1964 | 
gsßpõn˘y≥


1965 | 
gsßpikeyèb


1966 | 
gsßpi£rvi˚«me


1967 | 
ho°id›ti⁄
 { *
ho°id›ti⁄_is£t
 = 1; }

1968 | 
ruÀ_öã∫Æ_log›ti⁄


1969 | 
libwøp


1970 | 
log


1971 | 
∑m£rvi˚«me


1972 | 
ªdúe˘
 {

1973 #!
SOCKS_CLIENT


1974 
	`checkmoduÀ
("redirect");

1975 #
ídif


1977 | 
sockë›ti⁄
 {

1978 #!
SOCKS_CLIENT


1979 i‡(
ruÀ
.
vîdi˘
 =
VERDICT_BLOCK
 && !
sockë›t
.
isöã∫Æside
)

1980 
	`yyîr‹x
("it doesÇot make senseÅo setá socket option forÅhe "

1985 i‡(
sockë›t
.
isöã∫Æside
)

1986 i‡(
sockë›t
.
öfo
 !
NULL
 && sockë›t.öfo->
ˇŒty≥
 =
¥e⁄ly
)

1987 
	`yyw¨nx
("to our knowledgeÅhe socket option \"%s\" can only be "

1991 
sockë›t
.
öfo
 =
NULL
 ? "unknown" :

1992 
sockë›t
.
öfo
->
«me
);

1994 i‡(!
	`addedsockë›ti⁄
(&
ruÀ
.
sockë›ti⁄c
,

1995 &
ruÀ
.
sockë›ti⁄v
,

1996 &
sockë›t
))

1997 
	`yyw¨n
("couldÇotádd socketoption");

1998 #
ídif


2000 | 
timeout


2001 | 
u£r


2006 
ld≠›ti⁄
: 
ld≠©åibuã


2007 | 
ld≠©åibuã_ad


2008 | 
ld≠©åibuã_ad_hex


2009 | 
ld≠©åibuã_hex


2010 | 
ld≠auto


2011 | 
lba£dn


2012 | 
lba£dn_hex


2013 | 
lba£dn_hex_Æl


2014 | 
ld≠˚πcheck


2015 | 
ld≠˚πfûe


2016 | 
ld≠˚π∑th


2017 | 
ld≠debug


2018 | 
ld≠dïth


2019 | 
ld≠domaö


2020 | 
ld≠fûãr


2021 | 
ld≠fûãr_ad


2022 | 
ld≠fûãr_ad_hex


2023 | 
ld≠fûãr_hex


2024 | 
ld≠kì¥ólm


2025 | 
ld≠keyèb


2026 | 
ld≠p‹t


2027 | 
ld≠p‹ts¶


2028 | 
ld≠s¶


2029 | 
lgroup


2030 | 
lgroup_hex


2031 | 
lgroup_hex_Æl


2032 | 
l£rvî


2033 | 
luæ


2037 
ld≠debug
: 
LDAPDEBUG
 ':' 
NUMBER
 {

2038 #
SOCKS_SERVER


2039 #
HAVE_LDAP
 && 
HAVE_OPENLDAP


2040 
ld≠
->
debug
 = ()
$3
;

2042 | 
LDAPDEBUG
 ':' '-'
NUMBER
 {

2043 
ld≠
->
debug
 = ()-
$4
;

2045 
	`yyîr‹x_nﬁib
("openldap");

2046 #
ídif


2047 #
ídif


2051 
ld≠domaö
: 
LDAPDOMAIN
 ':' 
LDAP_DOMAIN
 {

2052 #
SOCKS_SERVER


2053 #
HAVE_LDAP


2054 
	`STRCPY_CHECKLEN
(
°©e
->
ld≠
.
domaö
,

2055 
$3
,

2056 (
°©e
->
ld≠
.
domaö
) - 1,

2057 
yyîr‹x
);

2059 
	`yyîr‹x_nﬁib
("LDAP");

2060 #
ídif


2061 #
ídif


2065 
ld≠dïth
: 
LDAPDEPTH
 ':' 
NUMBER
 {

2066 #
SOCKS_SERVER


2067 #
HAVE_LDAP
 && 
HAVE_OPENLDAP


2068 
ld≠
->
mdïth
 = ()
$3
;

2070 
	`yyîr‹x_nﬁib
("openldap");

2071 #
ídif


2072 #
ídif


2076 
ld≠˚πfûe
: 
LDAPCERTFILE
 ':' 
LDAP_CERTFILE
 {

2077 #
SOCKS_SERVER


2078 #
HAVE_LDAP


2079 
	`STRCPY_CHECKLEN
(
°©e
->
ld≠
.
˚πfûe
,

2080 
$3
,

2081 (
°©e
->
ld≠
.
˚πfûe
) - 1,

2082 
yyîr‹x
);

2084 
	`yyîr‹x_nﬁib
("LDAP");

2085 #
ídif


2086 #
ídif


2090 
ld≠˚π∑th
: 
LDAPCERTPATH
 ':' 
LDAP_CERTPATH
 {

2091 #
SOCKS_SERVER


2092 #
HAVE_LDAP


2093 
	`STRCPY_CHECKLEN
(
°©e
->
ld≠
.
˚π∑th
,

2094 
$3
,

2095 (
°©e
->
ld≠
.
˚π∑th
) - 1,

2096 
yyîr‹x
);

2098 
	`yyîr‹x_nﬁib
("LDAP");

2099 #
ídif


2100 #
ídif


2104 
luæ
: 
LDAPURL
 ':' 
LDAP_URL
 {

2105 #
SOCKS_SERVER


2106 #
HAVE_LDAP


2107 i‡(
	`addlöked«me
(&
°©e
->
ld≠
.
ld≠uæ
, 
$3
Ë=
NULL
)

2108 
	`yyîr‹
(
NOMEM
);

2110 
	`yyîr‹x_nﬁib
("LDAP");

2111 #
ídif


2112 #
ídif


2116 
lba£dn
: 
LDAPBASEDN
 ':' 
LDAP_BASEDN
 {

2117 #
SOCKS_SERVER


2118 #
HAVE_LDAP


2119 i‡(
	`addlöked«me
(&
°©e
->
ld≠
.
ld≠ba£dn
, 
$3
Ë=
NULL
)

2120 
	`yyîr‹
(
NOMEM
);

2122 
	`yyîr‹x_nﬁib
("LDAP");

2123 #
ídif


2124 #
ídif


2128 
lba£dn_hex
: 
LDAPBASEDN_HEX
 ':' 
LDAP_BASEDN
 {

2129 #
SOCKS_SERVER


2130 #
HAVE_LDAP


2131 i‡(
	`addlöked«me
(&
°©e
->
ld≠
.
ld≠ba£dn
, 
	`hextoutf8
(
$3
, 0)Ë=
NULL
)

2132 
	`yyîr‹
(
NOMEM
);

2134 
	`yyîr‹x_nﬁib
("LDAP");

2135 #
ídif


2136 #
ídif


2140 
lba£dn_hex_Æl
: 
LDAPBASEDN_HEX_ALL
 ':' 
LDAP_BASEDN
 {

2141 #
SOCKS_SERVER


2142 #
HAVE_LDAP


2143 i‡(
	`addlöked«me
(&
°©e
->
ld≠
.
ld≠ba£dn
, 
	`hextoutf8
(
$3
, 1)Ë=
NULL
)

2144 
	`yyîr‹
(
NOMEM
);

2146 
	`yyîr‹x_nﬁib
("LDAP");

2147 #
ídif


2148 #
ídif


2152 
ld≠p‹t
: 
LDAPPORT
 ':' 
NUMBER
 {

2153 #
SOCKS_SERVER


2154 #
HAVE_LDAP


2155 
ld≠
->
p‹t
 = ()
$3
;

2157 
	`yyîr‹x_nﬁib
("LDAP");

2158 #
ídif


2159 #
ídif


2163 
ld≠p‹ts¶
: 
LDAPPORTSSL
 ':' 
NUMBER
 {

2164 #
SOCKS_SERVER


2165 #
HAVE_LDAP


2166 
ld≠
->
p‹ts¶
 = ()
$3
;

2168 
	`yyîr‹x_nﬁib
("LDAP");

2169 #
ídif


2170 #
ídif


2174 
ld≠s¶
: 
LDAPSSL
 ':' 
YES
 {

2175 #
SOCKS_SERVER


2176 #
HAVE_LDAP


2177 
ld≠
->
s¶
 = 1;

2179 | 
LDAPSSL
 ':' 
NO
 {

2180 
ld≠
->
s¶
 = 0;

2182 
	`yyîr‹x_nﬁib
("LDAP");

2183 #
ídif


2184 #
ídif


2188 
ld≠auto
: 
LDAPAUTO
 ':' 
YES
 {

2189 #
SOCKS_SERVER


2190 #
HAVE_LDAP


2191 
ld≠
->
auto_off
 = 1;

2193 | 
LDAPAUTO
 ':' 
NO
 {

2194 
ld≠
->
auto_off
 = 0;

2196 
	`yyîr‹x_nﬁib
("LDAP");

2197 #
ídif


2198 #
ídif


2202 
ld≠˚πcheck
: 
LDAPCERTCHECK
 ':' 
YES
 {

2203 #
SOCKS_SERVER


2204 #
HAVE_LDAP


2205 
ld≠
->
˚πcheck
 = 1;

2207 | 
LDAPCERTCHECK
 ':' 
NO
 {

2208 
ld≠
->
˚πcheck
 = 0;

2210 
	`yyîr‹x_nﬁib
("LDAP");

2211 #
ídif


2212 #
ídif


2216 
ld≠kì¥ólm
: 
LDAPKEEPREALM
 ':' 
YES
 {

2217 #
SOCKS_SERVER


2218 #
HAVE_LDAP


2219 
ld≠
->
kì¥ólm
 = 1;

2221 | 
LDAPKEEPREALM
 ':' 
NO
 {

2222 
ld≠
->
kì¥ólm
 = 0;

2224 
	`yyîr‹x_nﬁib
("LDAP");

2225 #
ídif


2226 #
ídif


2230 
ld≠fûãr
: 
LDAPFILTER
 ':' 
LDAP_FILTER
 {

2231 #
SOCKS_SERVER


2232 #
HAVE_LDAP


2233 
	`STRCPY_CHECKLEN
(
ld≠
->
fûãr
, 
$3
, (
°©e
->ld≠.fûãrË- 1, 
yyîr‹x
);

2235 
	`yyîr‹x_nﬁib
("LDAP");

2236 #
ídif


2237 #
ídif


2241 
ld≠fûãr_ad
: 
LDAPFILTER_AD
 ':' 
LDAP_FILTER
 {

2242 #
SOCKS_SERVER


2243 #
HAVE_LDAP


2244 
	`STRCPY_CHECKLEN
(
ld≠
->
fûãr_AD
,

2245 
$3
,

2246 (
°©e
->
ld≠
.
fûãr_AD
) - 1,

2247 
yyîr‹x
);

2250 
	`yyîr‹x_nﬁib
("LDAP");

2251 #
ídif


2252 #
ídif


2256 
ld≠fûãr_hex
: 
LDAPFILTER_HEX
 ':' 
LDAP_FILTER
 {

2257 #
SOCKS_SERVER


2258 #
HAVE_LDAP


2259 
	`STRCPY_CHECKUTFLEN
(
ld≠
->
fûãr
,

2260 
$3
,

2261 (
°©e
->
ld≠
.
fûãr
) - 1,

2262 
yyîr‹x
);

2264 
	`yyîr‹x_nﬁib
("LDAP");

2265 #
ídif


2266 #
ídif


2270 
ld≠fûãr_ad_hex
: 
LDAPFILTER_AD_HEX
 ':' 
LDAP_FILTER
 {

2271 #
SOCKS_SERVER


2272 #
HAVE_LDAP


2273 
	`STRCPY_CHECKUTFLEN
(
ld≠
->
fûãr_AD
,

2274 
$3
,

2275 (
°©e
->
ld≠
.
fûãr_AD
) - 1,

2276 
yyîr‹x
);

2278 
	`yyîr‹x_nﬁib
("LDAP");

2279 #
ídif


2280 #
ídif


2284 
ld≠©åibuã
: 
LDAPATTRIBUTE
 ':' 
LDAP_ATTRIBUTE
 {

2285 #
SOCKS_SERVER


2286 #
HAVE_LDAP


2287 
	`STRCPY_CHECKLEN
(
ld≠
->
©åibuã
,

2288 
$3
,

2289 (
°©e
->
ld≠
.
©åibuã
) - 1,

2290 
yyîr‹x
);

2293 
	`yyîr‹x_nﬁib
("LDAP");

2294 #
ídif


2295 #
ídif


2299 
ld≠©åibuã_ad
: 
LDAPATTRIBUTE_AD
 ':' 
LDAP_ATTRIBUTE
 {

2300 #
SOCKS_SERVER


2301 #
HAVE_LDAP


2302 
	`STRCPY_CHECKLEN
(
ld≠
->
©åibuã_AD
,

2303 
$3
,

2304 (
°©e
->
ld≠
.
©åibuã_AD
) - 1,

2305 
yyîr‹x
);

2307 
	`yyîr‹x_nﬁib
("LDAP");

2308 #
ídif


2309 #
ídif


2313 
ld≠©åibuã_hex
: 
LDAPATTRIBUTE_HEX
 ':' 
LDAP_ATTRIBUTE
 {

2314 #
SOCKS_SERVER


2315 #
HAVE_LDAP


2316 
	`STRCPY_CHECKUTFLEN
(
ld≠
->
©åibuã
,

2317 
$3
,

2318 (
°©e
->
ld≠
.
©åibuã
) -1,

2319 
yyîr‹x
);

2321 
	`yyîr‹x_nﬁib
("LDAP");

2322 #
ídif


2323 #
ídif


2327 
ld≠©åibuã_ad_hex
: 
LDAPATTRIBUTE_AD_HEX
 ':' 
LDAP_ATTRIBUTE
 {

2328 #
SOCKS_SERVER


2329 #
HAVE_LDAP


2330 
	`STRCPY_CHECKUTFLEN
(
ld≠
->
©åibuã_AD
,

2331 
$3
,

2332 (
°©e
->
ld≠
.
©åibuã_AD
) - 1,

2333 
yyîr‹x
);

2335 
	`yyîr‹x_nﬁib
("LDAP");

2336 #
ídif


2337 #
ídif


2341 
lgroup_hex
: 
LDAPGROUP_HEX
 ':' 
LDAPGROUP_NAME
 {

2342 #
SOCKS_SERVER


2343 #
HAVE_LDAP


2344 i‡(
	`addlöked«me
(&
ruÀ
.
ld≠group
, 
	`hextoutf8
(
$3
, 0)Ë=
NULL
)

2345 
	`yyîr‹
(
NOMEM
);

2347 
	`yyîr‹x_nﬁib
("LDAP");

2348 #
ídif


2349 #
ídif


2353 
lgroup_hex_Æl
: 
LDAPGROUP_HEX_ALL
 ':' 
LDAPGROUP_NAME
 {

2354 #
SOCKS_SERVER


2355 #
HAVE_LDAP


2356 
	`checkmoduÀ
("ldap");

2358 i‡(
	`addlöked«me
(&
ruÀ
.
ld≠group
, 
	`hextoutf8
(
$3
, 1)Ë=
NULL
)

2359 
	`yyîr‹
(
NOMEM
);

2361 
	`yyîr‹x_nﬁib
("LDAP");

2362 #
ídif


2363 #
ídif


2367 
lgroup
: 
LDAPGROUP
 ':' 
LDAPGROUP_NAME
 {

2368 #
SOCKS_SERVER


2369 #
HAVE_LDAP


2370 
	`checkmoduÀ
("ldap");

2372 i‡(
	`addlöked«me
(&
ruÀ
.
ld≠group
, 
	`asciôoutf8
(
$3
)Ë=
NULL
)

2373 
	`yyîr‹
(
NOMEM
);

2375 
	`yyîr‹x_nﬁib
("LDAP");

2376 #
ídif


2377 #
ídif


2381 
l£rvî
: 
LDAPSERVER
 ':' 
LDAPSERVER_NAME
 {

2382 #
SOCKS_SERVER


2383 #
HAVE_LDAP


2384 i‡(
	`addlöked«me
(&
ruÀ
.
ld≠£rvî
, 
$3
Ë=
NULL
)

2385 
	`yyîr‹
(
NOMEM
);

2387 
	`yyîr‹x_nﬁib
("LDAP");

2388 #
ídif


2389 #
ídif


2393 
ld≠keyèb
: 
LDAPKEYTAB
 ':' 
LDAPKEYTABNAME
 {

2394 #
HAVE_LDAP


2395 #
SOCKS_SERVER


2396 
	`STRCPY_CHECKLEN
(
°©e
->
ld≠
.
keyèb
,

2397 
$3
,

2398 (
°©e
->
ld≠
.
keyèb
Ë- 1, 
yyîr‹x
);

2400 
	`yyîr‹x
("ldap keytab onlyápplicableÅo Dante server");

2401 #
ídif


2403 
	`yyîr‹x_nﬁib
("LDAP");

2404 #
ídif


2408 
˛õ¡com∑tibûôy
: 
CLIENTCOMPATIBILITY
 ':' 
˛õ¡com∑tibûôy«mes


2411 
˛õ¡com∑tibûôy«me
: 
NECGSSAPI
 {

2412 #
HAVE_GSSAPI


2413 
gsßpõn¸y±i⁄
->
√c
 = 1;

2415 
	`yyîr‹x_nﬁib
("GSSAPI");

2416 #
ídif


2420 
˛õ¡com∑tibûôy«mes
: 
˛õ¡com∑tibûôy«me


2421 | 
˛õ¡com∑tibûôy«me
 
˛õ¡com∑tibûôy«mes


2425 
vîdi˘
: 
VERDICT_BLOCK
 {

2426 #!
SOCKS_CLIENT


2427 
	`ruÀöô
(&
ruÀ
);

2428 
ruÀ
.
vîdi˘
 = 
VERDICT_BLOCK
;

2430 | 
VERDICT_PASS
 {

2431 
	`ruÀöô
(&
ruÀ
);

2432 
ruÀ
.
vîdi˘
 = 
VERDICT_PASS
;

2433 #
ídif


2437 
comm™d
: 
COMMAND
 ':' 
comm™ds


2440 
comm™ds
: 
comm™d«me


2441 | 
comm™d«me
 
comm™ds


2444 
comm™d«me
: 
COMMAND_BIND
 {

2445 
°©e
->
comm™d
.
böd
 = 1;

2447 | 
COMMAND_CONNECT
 {

2448 
°©e
->
comm™d
.
c⁄√˘
 = 1;

2450 | 
COMMAND_UDPASSOCIATE
 {

2451 
°©e
->
comm™d
.
ud∑ssocüã
 = 1;

2456 | 
COMMAND_BINDREPLY
 {

2457 
°©e
->
comm™d
.
bödª∂y
 = 1;

2460 | 
COMMAND_UDPREPLY
 {

2461 
°©e
->
comm™d
.
ud¥ïly
 = 1;

2466 
¥Ÿocﬁ
: 
PROTOCOL
 ':' 
¥Ÿocﬁs


2469 
¥Ÿocﬁs
: 
¥Ÿocﬁ«me


2470 | 
¥Ÿocﬁ«me
 
¥Ÿocﬁs


2473 
¥Ÿocﬁ«me
: 
PROTOCOL_TCP
 {

2474 
°©e
->
¥Ÿocﬁ
.
t˝
 = 1;

2476 | 
PROTOCOL_UDP
 {

2477 
°©e
->
¥Ÿocﬁ
.
udp
 = 1;

2482 
‰omto
: 
§ˇddªss
 
d°addªss


2485 
ho°id_‰omto
: 
ho°id_§ˇddªss
 
d°addªss


2488 
ªdúe˘
: 
REDIRECT
 
rdr_‰omaddªss
 
rdr_tﬂddªss


2489 | 
REDIRECT
 
rdr_‰omaddªss


2490 | 
REDIRECT
 
rdr_tﬂddªss


2493 
£ssi⁄›ti⁄
: 
£ssi⁄max


2494 | 
£ssi⁄thrŸée


2495 | 
£ssi⁄°©e


2498 
socks£ssi⁄›ti⁄
: 
£ssi⁄›ti⁄
;

2501 
¸uÀ£ssi⁄›ti⁄
: 
£ssi⁄öhîôabÀ


2502 | 
£ssi⁄›ti⁄


2505 
£ssi⁄öhîôabÀ
: 
SESSION_INHERITABLE
 ':' 
YES
 {

2506 #!
SOCKS_CLIENT


2507 
ruÀ
.
ss_isöhîôabÀ
 = 1;

2509 | 
SESSION_INHERITABLE
 ':' 
NO
 {

2510 
ruÀ
.
ss_isöhîôabÀ
 = 0;

2511 #
ídif


2515 
£ssi⁄max
: 
SESSIONMAX
 ':' 
NUMBER
 {

2516 #!
SOCKS_CLIENT


2517 
	`ASSIGN_MAXSESSIONS
(
$3
, 
ss
.
obje˘
.ss.
max
, 0);

2518 
ss
.
obje˘
.ss.
max
 = 
$3
;

2519 
ss
.
obje˘
.ss.
max_is£t
 = 1;

2520 #
ídif


2524 
£ssi⁄thrŸée
: 
SESSIONTHROTTLE
 ':' 
NUMBER
 '/' NUMBER {

2525 #!
SOCKS_CLIENT


2526 
	`ASSIGN_THROTTLE_SECONDS
(
$3
, 
ss
.
obje˘
.ss.
thrŸée
.
limô
.
˛õ¡s
, 0);

2527 
	`ASSIGN_THROTTLE_CLIENTS
(
$5
, 
ss
.
obje˘
.ss.
thrŸée
.
limô
.
£c⁄ds
, 0);

2528 
ss
.
obje˘
.ss.
thrŸée_is£t
 = 1;

2529 #
ídif


2533 
£ssi⁄°©e
: 
£ssi⁄°©e_key


2534 | 
£ssi⁄°©e_keyöfo


2535 | 
£ssi⁄°©e_thrŸée


2536 | 
£ssi⁄°©e_max


2539 
£ssi⁄°©e_key
: 
SESSIONSTATE_KEY
 ':' 
STATEKEY
 {

2540 #!
SOCKS_CLIENT


2541 i‡((
ss
.
key°©e
.
key
 = 
	`°rög2°©ekey
(
$3
)Ë=
key_un£t
)

2542 
	`yyîr‹x
("%†i†nŸá vÆid sèã key", 
$3
);

2544 #
HAVE_SOCKS_HOSTID


2545 i‡(
ss
.
key°©e
.
key
 =
key_ho°id
) {

2546 *
ho°id›ti⁄_is£t
 = 1;

2547 
ss
.
key°©e
.
keyöfo
.
ho°ödex
 = 
DEFAULT_HOSTINDEX
;

2549 #
ídif


2553 
	`SERRX
(0);

2554 #
ídif


2558 
£ssi⁄°©e_keyöfo
: 
SESSIONSTATE_KEY
 '.' {

2559 #!
SOCKS_CLIENT
 && 
HAVE_SOCKS_HOSTID


2560 
ho°ödex
 = &
ss
.
key°©e
.
keyöfo
.hostindex;

2562 
ho°ödex
 {

2563 
ho°ödex
 = &
ruÀ
.hostindex;

2564 #
ídif


2569 
£ssi⁄°©e_max
: 
SESSIONSTATE_MAX
 ':' 
NUMBER
 {

2570 #!
SOCKS_CLIENT


2571 
	`ASSIGN_MAXSESSIONS
(
$3
, 
ss
.
obje˘
.ss.
max_≥r°©e
, 0);

2572 
ss
.
obje˘
.ss.
max_≥r°©e_is£t
 = 1;

2573 #
ídif


2577 
£ssi⁄°©e_thrŸée
: 
SESSIONSTATE_THROTTLE
 ':' 
NUMBER
 '/' NUMBER {

2578 #!
SOCKS_CLIENT


2579 
	`ASSIGN_THROTTLE_SECONDS
(
$3
, 
ss
.
obje˘
.ss.
thrŸée_≥r°©e
.
limô
.
˛õ¡s
, 0);

2580 
	`ASSIGN_THROTTLE_CLIENTS
(
$5
, 
ss
.
obje˘
.ss.
thrŸée_≥r°©e
.
limô
.
£c⁄ds
, 0);

2581 
ss
.
obje˘
.ss.
thrŸée_≥r°©e_is£t
 = 1;

2582 #
ídif


2586 
b™dwidth
: 
BANDWIDTH
 ':' 
NUMBER
 {

2587 #!
SOCKS_CLIENT


2588 
	`ASSIGN_NUMBER
(
$3
, >=, 0, 
bw
.
obje˘
.bw.
maxbps
, 0);

2589 
bw
.
obje˘
.bw.
maxbps_is£t
 = 1;

2590 #
ídif


2595 
log
: 
RULE_LOG
 ':' 
logs


2598 
log«me
: 
RULE_LOG_CONNECT
 {

2599 #!
SOCKS_CLIENT


2600 
ruÀ
.
log
.
c⁄√˘
 = 1;

2602 | 
RULE_LOG_DATA
 {

2603 
ruÀ
.
log
.
d©a
 = 1;

2605 | 
RULE_LOG_DISCONNECT
 {

2606 
ruÀ
.
log
.
disc⁄√˘
 = 1;

2608 | 
RULE_LOG_ERROR
 {

2609 
ruÀ
.
log
.
îr‹
 = 1;

2611 | 
RULE_LOG_IOOPERATION
 {

2612 
ruÀ
.
log
.
io›î©i⁄
 = 1;

2614 | 
RULE_LOG_TCPINFO
 {

2615 
ruÀ
.
log
.
t˝öfo
 = 1;

2616 #
ídif


2620 
logs
: 
log«me


2621 | 
log«me
 
logs


2625 
∑m£rvi˚«me
: 
PAMSERVICENAME
 ':' 
SERVICENAME
 {

2626 #
HAVE_PAM
 && (!
SOCKS_CLIENT
)

2627 
	`STRCPY_CHECKLEN
(
°©e
->
∑m£rvi˚«me
,

2628 
$3
,

2629 (
°©e
->
∑m£rvi˚«me
) -1,

2630 
yyîr‹x
);

2632 
	`yyîr‹x_nﬁib
("PAM");

2633 #
ídif


2637 
bsdauth°yÀ«me
: 
BSDAUTHSTYLE
 ':' 
BSDAUTHSTYLENAME
 {

2638 #
HAVE_BSDAUTH
 && 
SOCKS_SERVER


2639 
	`STRCPY_CHECKLEN
(
°©e
->
bsdauth°yÀ«me
,

2640 
$3
,

2641 (
°©e
->
bsdauth°yÀ«me
) - 1,

2642 
yyîr‹x
);

2644 
	`yyîr‹x_nﬁib
("bsdauth");

2645 #
ídif


2650 
gsßpi£rvi˚«me
: 
GSSAPISERVICE
 ':' 
GSSAPISERVICENAME
 {

2651 #
HAVE_GSSAPI


2652 
	`STRCPY_CHECKLEN
(
gsßpi£rvi˚«me
,

2653 
$3
,

2654 (
°©e
->
gsßpi£rvi˚«me
) - 1,

2655 
yyîr‹x
);

2657 
	`yyîr‹x_nﬁib
("GSSAPI");

2658 #
ídif


2662 
gsßpikeyèb
: 
GSSAPIKEYTAB
 ':' 
GSSAPIKEYTABNAME
 {

2663 #
HAVE_GSSAPI


2664 #
SOCKS_SERVER


2665 
	`STRCPY_CHECKLEN
(
gsßpikeyèb
,

2666 
$3
,

2667 (
°©e
->
gsßpikeyèb
) - 1,

2668 
yyîr‹x
);

2670 
	`yyîr‹x
("gssapi keytab setting is onlyápplicableÅo Dante server");

2671 #
ídif


2673 
	`yyîr‹x_nﬁib
("GSSAPI");

2674 #
ídif


2678 
gsßpõn˘y≥
: 
GSSAPIENCTYPE
':' 
gsßpõn˘y≥s


2681 
gsßpõn˘y≥«me
: 
GSSAPIENC_ANY
 {

2682 #
HAVE_GSSAPI


2683 
gsßpõn¸y±i⁄
->
˛ór
 = 1;

2684 
gsßpõn¸y±i⁄
->
öãgrôy
 = 1;

2685 
gsßpõn¸y±i⁄
->
c⁄fidítülôy
 = 1;

2687 | 
GSSAPIENC_CLEAR
 {

2688 
gsßpõn¸y±i⁄
->
˛ór
 = 1;

2690 | 
GSSAPIENC_INTEGRITY
 {

2691 
gsßpõn¸y±i⁄
->
öãgrôy
 = 1;

2693 | 
GSSAPIENC_CONFIDENTIALITY
 {

2694 
gsßpõn¸y±i⁄
->
c⁄fidítülôy
 = 1;

2696 | 
GSSAPIENC_PERMESSAGE
 {

2697 
	`yyîr‹x
("gssapiÖer-messageÉncryptionÇot supported");

2699 
	`yyîr‹x_nﬁib
("GSSAPI");

2700 #
ídif


2704 
gsßpõn˘y≥s
: 
gsßpõn˘y≥«me


2705 | 
gsßpõn˘y≥«me
 
gsßpõn˘y≥s


2708 
boun˚
: 
BOUNCE
 
boun˚to
 ':' 
boun˚tﬂddªss


2711 
libwøp
: 
LIBWRAPSTART
 ':' 
LINE
 {

2712 #
HAVE_LIBWRAP
 && (!
SOCKS_CLIENT
)

2713 
ªque°_öfo
 
ªque°
;

2714 
tmp
[
LIBWRAPBUF
];

2715 
î∫o_s
, 
devnuŒ
;

2717 
	`STRCPY_CHECKLEN
(
ruÀ
.
libwøp
,

2718 
$3
,

2719 (
ruÀ
.
libwøp
) - 1,

2720 
yyîr‹x
);

2723 
	`STRCPY_ASSERTSIZE
(
tmp
, 
ruÀ
.
libwøp
);

2725 
devnuŒ
 = 
	`›í
("/dev/nuŒ", 
O_RDWR
, 0);

2726 ++
dry_run
;

2727 
î∫o_s
 = 
î∫o
;

2729 
î∫o
 = 0;

2731 
	`ªque°_öô
(&
ªque°
, 
RQ_FILE
, 
devnuŒ
, 
RQ_DAEMON
, 
__¥og«me
, 0);

2732 i‡(
	`£tjmp
(
t˝d_buf
) != 0)

2733 
	`yyîr‹
("badÜibwrapÜine");

2734 
	`¥o˚ss_›ti⁄s
(
tmp
, &
ªque°
);

2736 i‡(
î∫o
 != 0)

2737 
	`yyw¨n
("possibleÜibwrap/tcp-wrappersÑelated configurationÉrror");

2739 --
dry_run
;

2740 
	`˛o£
(
devnuŒ
);

2741 
î∫o
 = 
î∫o_s
;

2744 
	`yyîr‹x_nﬁib
("GSSAPI");

2745 #
ídif


2751 
§ˇddªss
: 
‰om
 ':' 
addªss


2754 
ho°id_§ˇddªss
: 
‰om
 ':' 
addªss_wôhout_p‹t


2757 
d°addªss
: 
to
 ':' 
addªss


2760 
rdr_‰omaddªss
: 
rdr_‰om
 ':' 
addªss


2763 
rdr_tﬂddªss
: 
rdr_to
 ':' 
addªss
 {

2764 #
BAREFOOTD


2765 
	`yyîr‹x
("redirecting \"to\"ánáddress doesÇot makeány sense in %s. "

2768 
PRODUCT
);

2769 #
ídif


2773 
g©eway
: 
vü
 ':' 
gwaddªss


2776 
rouã›ti⁄
: 
rouãmëhod


2777 | 
comm™d


2778 | 
˛õ¡com∑tibûôy


2779 | 
exãnsi⁄


2780 | 
¥Ÿocﬁ


2781 | 
gsßpi£rvi˚«me


2782 | 
gsßpikeyèb


2783 | 
gsßpõn˘y≥


2784 | 
¥oxy¥Ÿocﬁ


2785 | 
REDIRECT
 
rdr_‰omaddªss


2786 | 
sockë›ti⁄
 {

2787 i‡(!
	`addedsockë›ti⁄
(&
rouã
.
sockë›ti⁄c
,

2788 &
rouã
.
sockë›ti⁄v
,

2789 &
sockë›t
))

2790 
	`yyw¨n
("couldÇotádd socketoption");

2794 
rouã›ti⁄s
: { 
$$
 = 
NULL
; }

2795 | 
rouã›ti⁄
 
rouã›ti⁄s


2798 
rouãmëhod
: 
METHOD
 ':' 
socksmëhods


2801 
‰om
: 
FROM
 {

2802 
	`addröô
(&
§c
, 1);

2806 
to
: 
TO
 {

2807 
	`addröô
(&
d°
, 
	`ùaddr_ªquúes_√tmask
(
to
, 
obje˘ty≥
));

2811 
rdr_‰om
: 
FROM
 {

2812 
	`addröô
(&
rdr_‰om
, 1);

2816 
rdr_to
: 
TO
 {

2817 
	`addröô
(&
rdr_to
, 0);

2821 
boun˚to
: 
TO
 {

2822 #
BAREFOOTD


2823 
	`addröô
(&
boun˚to
, 0);

2824 #
ídif


2829 
vü
: 
VIA
 {

2830 
	`gwaddröô
(&
gw
);

2834 
exã∫Æaddªss
: 
ùv4


2835 | 
ùv6


2836 | 
domaö


2837 | 
i‚ame


2840 
addªss_wôhout_p‹t
: 
ùaddªss


2841 | 
domaö


2842 | 
i‚ame


2845 
addªss
: 
addªss_wôhout_p‹t
 
p‹t


2849 
ùaddªss
: 
ùv4
 '/' 
√tmask_v4
 { i‡(!
√tmask_ªquúed
Ë
	`yyîr‹x_ha¢ëmask
(); }

2850 | 
ùv4
 { i‡(
√tmask_ªquúed
Ë
	`yyîr‹x_n⁄ëmask
(); }

2851 | 
ùv6
 '/' 
√tmask_v6
 { i‡(!
√tmask_ªquúed
Ë
	`yyîr‹x_ha¢ëmask
(); }

2852 | 
ùv6
 { i‡(
√tmask_ªquúed
Ë
	`yyîr‹x_n⁄ëmask
(); }

2853 | 
ùv™y
 '/' 
√tmask_v™y
 { i‡(!
√tmask_ªquúed
)

2854 
	`yyîr‹x_ha¢ëmask
(); }

2855 | 
ùv™y
 { i‡(
√tmask_ªquúed
Ë
	`yyîr‹x_n⁄ëmask
(); }

2857 
gwaddªss
: 
ùaddªss
 
gwp‹t


2858 | 
domaö
 
gwp‹t


2859 | 
i‚ame
 { }

2860 | 
uæ


2863 
boun˚tﬂddªss
: 
ùaddªss
 
gwp‹t


2864 | 
domaö
 
gwp‹t


2868 
ùv4
: 
IPV4
 {

2869 *
©y≥
 = 
SOCKS_ADDR_IPV4
;

2871 i‡(
	`socks_öë_±⁄
(
AF_INET
, 
$1
, 
ùv4
, 
NULL
) != 1)

2872 
	`yyîr‹
("bad %s: %s", 
	`©y≥2°rög
(*
©y≥
), 
$1
);

2876 
√tmask_v4
: 
NUMBER
 {

2877 i‡(
$1
 < 0 || $1 > 32)

2878 
	`yyîr‹x
("bad %sÇetmask: %ld. LegalÑange is 0 - 32",

2879 
	`©y≥2°rög
(*
©y≥
), ()
$1
);

2881 
√tmask_v4
->
s_addr
 = 
$1
 =0 ? 0 : 
	`ht⁄l
(
IPV4_FULLNETMASK
 << (32 - $1));

2883 | 
IPV4
 {

2884 i‡(
	`socks_öë_±⁄
(
AF_INET
, 
$1
, 
√tmask_v4
, 
NULL
) != 1)

2885 
	`yyîr‹
("bad %†√tmask: %s", 
	`©y≥2°rög
(*
©y≥
), 
$1
);

2889 
ùv6
: 
IPV6
 {

2890 *
©y≥
 = 
SOCKS_ADDR_IPV6
;

2892 i‡(
	`socks_öë_±⁄
(
AF_INET6
, 
$1
, 
ùv6
, 
sc›eid_v6
) != 1)

2893 
	`yyîr‹
("bad %s: %s", 
	`©y≥2°rög
(*
©y≥
), 
$1
);

2897 
√tmask_v6
: 
NUMBER
 {

2898 i‡(
$1
 < 0 || $1 > 
IPV6_NETMASKBITS
)

2899 
	`yyîr‹x
("bad %sÇetmask: %d. LegalÑange is 0 - %d",

2900 
	`©y≥2°rög
(*
©y≥
), ()
$1
, 
IPV6_NETMASKBITS
);

2902 *
√tmask_v6
 = 
$1
;

2906 
ùv™y
: 
IPVANY
 {

2907 
	`SASSERTX
(
	`°rcmp
(
$1
, "0") == 0);

2909 *
©y≥
 = 
SOCKS_ADDR_IPVANY
;

2910 
ùv™y
->
s_addr
 = 
	`ht⁄l
(0);

2914 
√tmask_v™y
: 
NUMBER
 {

2915 i‡(
$1
 != 0)

2916 
	`yyîr‹x
("bad %sÇetmask: %d. OnlyÜegal value is 0",

2917 
	`©y≥2°rög
(*
©y≥
), ()
$1
);

2919 
√tmask_v™y
->
s_addr
 = 
	`ht⁄l
(
$1
);

2924 
domaö
: 
DOMAINNAME
 {

2925 *
©y≥
 = 
SOCKS_ADDR_DOMAIN
;

2926 
	`STRCPY_CHECKLEN
(
domaö
, 
$1
, 
MAXHOSTNAMELEN
 - 1, 
yyîr‹x
);

2930 
i‚ame
: 
IFNAME
 {

2931 *
©y≥
 = 
SOCKS_ADDR_IFNAME
;

2932 
	`STRCPY_CHECKLEN
(
i‚ame
, 
$1
, 
MAXIFNAMELEN
 - 1, 
yyîr‹x
);

2937 
uæ
: 
URL
 {

2938 *
©y≥
 = 
SOCKS_ADDR_URL
;

2939 
	`STRCPY_CHECKLEN
(
uæ
, 
$1
, 
MAXURLLEN
 - 1, 
yyîr‹x
);

2944 
p‹t
: { 
$$
 = 0; }

2945 | 
PORT
 ':' 
p‹äumbî


2946 | 
PORT
 
p‹t›î©‹
 
p‹äumbî


2947 | 
PORT
 
p‹å™ge


2950 
gwp‹t
: { 
$$
 = 0; }

2951 | 
PORT
 
p‹t›î©‹
 
p‹äumbî


2954 
p‹äumbî
: 
p‹t£rvi˚


2955 | 
p‹t°¨t


2958 
p‹å™ge
: 
p‹t°¨t
 '-' 
p‹ãnd
 {

2959 i‡(
	`¡ohs
(*
p‹t_t˝
Ë>Çtohs(
ruÀaddr
->
p‹ãnd
))

2960 
	`yyîr‹x
("endÖort (%u) canÇot beÜessÅhan startÖort (%u)",

2961 
	`¡ohs
(*
p‹t_t˝
),Çtohs(
ruÀaddr
->
p‹ãnd
));

2966 
p‹t°¨t
: 
NUMBER
 {

2967 
	`ASSIGN_PORTNUMBER
(
$1
, *
p‹t_t˝
);

2968 
	`ASSIGN_PORTNUMBER
(
$1
, *
p‹t_udp
);

2972 
p‹ãnd
: 
NUMBER
 {

2973 
	`ASSIGN_PORTNUMBER
(
$1
, 
ruÀaddr
->
p‹ãnd
);

2974 
ruÀaddr
->
›î©‹
 = 
ønge
;

2978 
p‹t£rvi˚
: 
SERVICENAME
 {

2979 
£rvít
 *
£rvi˚
;

2981 i‡((
£rvi˚
 = 
	`gë£rvby«me
(
$1
, "t˝")Ë=
NULL
) {

2982 i‡(
°©e
->
¥Ÿocﬁ
.
t˝
)

2983 
	`yyîr‹x
("unknow¿t˝ÖrŸocﬁ: %s", 
$1
);

2985 *
p‹t_t˝
 = 
	`ht⁄s
(0);

2988 *
p‹t_t˝
 = (
ö_p‹t_t
)
£rvi˚
->
s_p‹t
;

2990 i‡((
£rvi˚
 = 
	`gë£rvby«me
(
$1
, "udp")Ë=
NULL
) {

2991 i‡(
°©e
->
¥Ÿocﬁ
.
udp
)

2992 
	`yyîr‹x
("unknow¿ud∞¥Ÿocﬁ: %s", 
$1
);

2994 *
p‹t_udp
 = 
	`ht⁄s
(0);

2997 *
p‹t_udp
 = (
ö_p‹t_t
)
£rvi˚
->
s_p‹t
;

2999 i‡(*
p‹t_t˝
 =
	`ht⁄s
(0Ë&& *
p‹t_udp
 == htons(0))

3000 
	`yyîr‹x
("unknownÅcp/udpÖrotocol");

3003 i‡(*
p‹t_t˝
 =
	`ht⁄s
(0))

3004 *
p‹t_t˝
 = *
p‹t_udp
;

3005 i‡(*
p‹t_udp
 =
	`ht⁄s
(0))

3006 *
p‹t_udp
 = *
p‹t_t˝
;

3008 
$$
 = (
size_t
)*
p‹t_udp
;

3013 
p‹t›î©‹
: 
OPERATOR
 {

3014 *
›î©‹
 = 
	`°rög2›î©‹
(
$1
);

3019 
udµ‹å™ge
: 
UDPPORTRANGE
 ':' 
udµ‹å™ge_°¨t
 '-' 
udµ‹å™ge_íd


3022 
udµ‹å™ge_°¨t
: 
NUMBER
 {

3023 #
SOCKS_SERVER


3024 
	`ASSIGN_PORTNUMBER
(
$1
, 
ruÀ
.
ud¥™ge
.
°¨t
);

3025 #
ídif


3029 
udµ‹å™ge_íd
: 
NUMBER
 {

3030 #
SOCKS_SERVER


3031 
	`ASSIGN_PORTNUMBER
(
$1
, 
ruÀ
.
ud¥™ge
.
íd
);

3032 
ruÀ
.
ud¥™ge
.
›
 = 
ønge
;

3034 i‡(
	`¡ohs
(
ruÀ
.
ud¥™ge
.
°¨t
Ë>Çtohs‘uÀ.ud¥™ge.
íd
))

3035 
	`yyîr‹x
("endÖort (%d) canÇot beÜessÅhan startÖort (%u)",

3036 ()
$1
, 
	`¡ohs
(
ruÀ
.
ud¥™ge
.
°¨t
));

3037 #
ídif


3041 
numbî
: 
NUMBER
 {

3042 
	`addnumbî
(&
numbîc
, &
numbîv
, 
$1
);

3046 
numbîs
: 
numbî


3047 | 
numbî
 
numbîs


3051 
	}
%%

3053 
	#INTERACTIVE
 0

	)

3055 
FILE
 *
yyö
;

3057 
	gÀx_d‹e°¨t
;

3060 
	$∑r£c⁄fig
(
fûíame
)

3061 c⁄° *
fûíame
;

3063 c⁄° *
fun˘i⁄
 = "parseconfig()";

3064 
°©
 
°©buf
;

3065 
havec⁄fig
;

3067 #i‡
SOCKS_CLIENT


3068 
	`∑r£˛õ¡ív
(&
havec⁄fig
);

3070 i‡(
havec⁄fig
)

3074 
	`SASSERTX
(
	`pidismaömŸhî
(
sockscf
.
°©e
.
pid
));

3076 i‡(
sockscf
.
°©e
.
öôed
)

3078 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

3081 
yyö
 = 
	`f›í
(
fûíame
, "r");

3083 #i‡!
SOCKS_CLIENT


3084 i‡(
sockscf
.
°©e
.
öôed
)

3085 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

3088 i‡(
yyö
 =
NULL


3089 || (
	`°©
(
fûíame
, &
°©buf
Ë=0 && sètbuf.
°_size
 == 0)) {

3090 i‡(
yyö
 =
NULL
)

3091 
	`¶og
(
sockscf
.
°©e
.
öôed
 ? 
LOG_WARNING
 : 
LOG_ERR
,

3092 "%s: couldÇŸ o≥¿c⁄fig fûê%s", 
fun˘i⁄
, 
fûíame
);

3094 
	`¶og
((
sockscf
.
°©e
.
öôed
 || 
SOCKS_CLIENT
Ë? 
LOG_WARNING
 : 
LOG_ERR
,

3095 "%s: c⁄fig fûê%†i†em±y. NŸÖ¨sög", 
fun˘i⁄
, 
fûíame
);

3097 #i‡
SOCKS_CLIENT


3099 i‡(
yyö
 =
NULL
) {

3100 i‡(
sockscf
.
›ti⁄
.
dúe˘ÁŒback
)

3101 
	`¶og
(
LOG_DEBUG
,

3103 
fun˘i⁄
, 
fûíame
);

3105 
	`exô
(0);

3108 
	`¶og
(
LOG_DEBUG
, "%s:Émpty %s,ássuming direct fallback wanted",

3109 
fun˘i⁄
, 
fûíame
);

3111 
sockscf
.
›ti⁄
.
dúe˘ÁŒback
 = 1;

3114 
	`SASSERTX
(
sockscf
.
›ti⁄
.
dúe˘ÁŒback
 == 1);

3117 i‡(!
sockscf
.
°©e
.
öôed
)

3118 
	`sockdexô
(
EXIT_FAILURE
);

3126 
havec⁄fig
 = 0;

3129 #i‡
YYDEBUG


3130 
yydebug
 = 0;

3133 
yylöío
 = 1;

3134 
î∫o
 = 0;

3135 
havec⁄fig
 = 1;

3144 #i‡!
SOCKS_CLIENT


3145 
ﬁd_log
 = 
sockscf
.
log
;

3146 
ﬁd_îæog
 = 
sockscf
.
îæog
;

3149 
Áûed_to_add_îæog
 = 
Áûed_to_add_log
 = 0;

3151 
	`¶og
(
LOG_DEBUG
, "%s:Ö¨sög c⁄fig i¿fûê%s", 
fun˘i⁄
, 
fûíame
);

3153 
	`bzîo
(&
sockscf
.
log
, (sockscf.log));

3154 
	`bzîo
(&
sockscf
.
îæog
, (sockscf.errlog));

3156 
Àx_d‹e°¨t
 = 1;

3158 
∑rsögc⁄fig
 = 1;

3159 
	`yy∑r£
();

3160 
∑rsögc⁄fig
 = 0;

3162 #i‡!
SOCKS_CLIENT


3163 
	`CMDLINE_OVERRIDE
(&
sockscf
.
öôül
.
cmdlöe
, &sockscf.
›ti⁄
);

3165 #i‡!
HAVE_PRIVILEGES


3166 i‡(!
sockscf
.
°©e
.
öôed
) {

3170 i‡(
sockscf
.
uid
.
¥ivûeged_is£t
 && !sockscf.
›ti⁄
.
vîify⁄ly
) {

3180 
logty≥_t
 *
logv
[] = { &
sockscf
.
log
, &sockscf.
îæog
 };

3181 
size_t
 
i
;

3183 
i
 = 0; i < 
	`ELEMENTS
(
logv
); ++i) {

3184 
size_t
 
fi
;

3186 
fi
 = 0; fò< 
logv
[
i
]->
fûíoc
; ++fi) {

3187 i‡(
logv
[
i
]->
¸óãdv
[
fi
]) {

3188 
	`¶og
(
LOG_DEBUG
,

3190 
fun˘i⁄
,

3191 
logv
[
i
]->
‚amev
[
fi
],

3192 ()
sockscf
.
uid
.
¥ivûeged_uid
,

3193 ()
sockscf
.
uid
.
¥ivûeged_gid
);

3195 i‡(
	`fchown
(
logv
[
i
]->
fûíov
[
fi
],

3196 ()
sockscf
.
uid
.
¥ivûeged_uid
,

3197 ()
sockscf
.
uid
.
¥ivûeged_gid
) != 0)

3198 
	`£º
("%s: couldÇot fchown(2) createdÜogfile %sÅo "

3202 
fun˘i⁄
,

3203 
logv
[
i
]->
‚amev
[
fi
],

3204 ()
sockscf
.
uid
.
¥ivûeged_uid
,

3205 ()
sockscf
.
uid
.
¥ivûeged_gid
);

3213 i‡(
	`c⁄figuª_¥ivûeges
() != 0) {

3214 i‡(
sockscf
.
°©e
.
öôed
) {

3215 
	`sw¨n
("%s: couldÇotÑeinitializeÖrivilegesáfter SIGHUP. "

3217 
fun˘i⁄
);

3219 
sockscf
.
°©e
.
havïrivs
 = 0;

3222 
	`£º
("%s: couldÇŸ c⁄figuªÖrivûeges", 
fun˘i⁄
);

3227 i‡(
yyö
 !
NULL
)

3228 
	`f˛o£
(
yyö
);

3230 
î∫o
 = 0;

3231  
havec⁄fig
 ? 0 : -1;

3232 
	}
}

3235 
	$ùaddr_ªquúes_√tmask
(
c⁄ãxt
, 
obje˘ty≥
)

3236 c⁄° 
addªssc⁄ãxt_t
 
c⁄ãxt
;

3237 c⁄° 
obje˘ty≥_t
 
obje˘ty≥
;

3240 
obje˘ty≥
) {

3241 
obje˘_¸uÀ
:

3242 #i‡
HAVE_SOCKS_RULES


3248 
c⁄ãxt
) {

3249 
‰om
:

3252 
to
:

3255 
boun˚
:

3259 
	`SERRX
(
c⁄ãxt
);

3264 #i‡
HAVE_SOCKS_HOSTID


3265 
obje˘_hruÀ
:

3269 #i‡
HAVE_SOCKS_RULES


3270 
obje˘_§uÀ
:

3274 
obje˘_rouã
:

3275 
obje˘_m⁄ô‹
:

3279 
	`SERRX
(
obje˘ty≥
);

3285 
	}
}

3289 
	$addnumbî
(
numbîc
, 
numbîv
, 
numbî
)

3290 
size_t
 *
numbîc
;

3291 *
numbîv
[];

3292 c⁄° 
numbî
;

3294 c⁄° *
fun˘i⁄
 = "addnumber()";

3296 i‡((*
numbîv
 = 
	`ªÆloc
(*numbîv, (**numbîvË* ((*
numbîc
) + 1)))

3297 =
NULL
)

3298 
	`yyîr‹
("%s: couldÇotállocate %lu bytes of memory forádding "

3300 
fun˘i⁄
, ()((**
numbîv
Ë* ((*
numbîc
) + 1)),

3301 
numbî
);

3303 (*
numbîv
)[(*
numbîc
)++] = 
numbî
;

3304 
	}
}

3308 
	$addröô
(
addr
, 
_√tmask_ªquúed
)

3309 
ruÀaddr_t
 *
addr
;

3310 c⁄° 
_√tmask_ªquúed
;

3313 
©y≥
 = &
addr
->atype;

3315 
ùv4
 = &
addr
->addr.ùv4.
ù
;

3316 
√tmask_v4
 = &
addr
->addr.
ùv4
.
mask
;

3318 
ùv6
 = &
addr
->addr.ùv6.
ù
;

3319 
√tmask_v6
 = &
addr
->addr.
ùv6
.
maskbôs
;

3320 
sc›eid_v6
 = &
addr
->addr.
ùv6
.
sc›eid
;

3322 
ùv™y
 = &
addr
->addr.ùv™y.
ù
;

3323 
√tmask_v™y
 = &
addr
->addr.
ùv™y
.
mask
;

3325 i‡(!
_√tmask_ªquúed
) {

3326 
√tmask_v4
->
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

3327 *
√tmask_v6
 = 
IPV6_NETMASKBITS
;

3328 
√tmask_v™y
->
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

3331 
domaö
 = 
addr
->addr.domain;

3332 
i‚ame
 = 
addr
->addr.ifname;

3334 
p‹t_t˝
 = &
addr
->
p‹t
.
t˝
;

3335 
p‹t_udp
 = &
addr
->
p‹t
.
udp
;

3336 
›î©‹
 = &
addr
->operator;

3338 
√tmask_ªquúed
 = 
_√tmask_ªquúed
;

3339 
ruÀaddr
 = 
addr
;

3340 
	}
}

3343 
	$gwaddröô
(
addr
)

3344 
socksho°_t
 *
addr
;

3346 
›î©‹_t
 
›î©‹mem
;

3348 
√tmask_ªquúed
 = 0;

3350 
©y≥
 = &
addr
->atype;

3352 
ùv4
 = &
addr
->addr.ipv4;

3353 
ùv6
 = &
addr
->addr.ùv6.
ù
;

3354 
domaö
 = 
addr
->addr.domain;

3355 
i‚ame
 = 
addr
->addr.ifname;

3356 
uæ
 = 
addr
->addr.
uæ«me
;

3358 
p‹t_t˝
 = &
addr
->
p‹t
;

3359 
p‹t_udp
 = &
addr
->
p‹t
;

3360 
›î©‹
 = &
›î©‹mem
;

3361 
	}
}

3364 
	$rouãöô
(
rouã
)

3365 
rouã_t
 *
rouã
;

3367 
	`bzîo
(
rouã
, (*route));

3369 
°©e
 = &
rouã
->
gw
.state;

3370 
exãnsi⁄
 = &
°©e
->extension;

3372 
cmëhodv
 = 
°©e
->cmethodv;

3373 
cmëhodc
 = &
°©e
->cmethodc;

3374 
smëhodv
 = 
°©e
->smethodv;

3375 
smëhodc
 = &
°©e
->smethodc;

3377 #i‡
HAVE_GSSAPI


3378 
gsßpi£rvi˚«me
 = 
°©e
->gssapiservicename;

3379 
gsßpikeyèb
 = 
°©e
->gssapikeytab;

3380 
gsßpõn¸y±i⁄
 = &
°©e
->gssapiencryption;

3383 #i‡!
SOCKS_CLIENT
 && 
HAVE_LDAP


3384 
ld≠
 = &
°©e
->ldap;

3387 
	`bzîo
(&
§c
, (src));

3388 
	`bzîo
(&
d°
, (dst));

3389 
§c
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

3390 
d°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

3392 
	`bzîo
(&
gw
, (gw));

3393 
	`bzîo
(&
rdr_‰om
, (rdr_from));

3394 
	`bzîo
(&
ho°id
, (hostid));

3395 
	}
}

3398 #i‡
SOCKS_CLIENT


3400 
	$∑r£˛õ¡ív
(
havïroxy£rvî
)

3401 *
havïroxy£rvî
;

3403 c⁄° *
fun˘i⁄
 = "parseclientenv()";

3404 c⁄° *
Ârötf_îr‹
 = "couldÇot writeÅoÅmpfile usedÅo hold "

3406 
size_t
 
i
;

3407 
FILE
 *
Â
;

3408 *
p
, 
rdr_‰om
[512], 
exå¨ouãöfo
[(rdr_from) + ("\n")],

3409 
gw
[
MAXSOCKSHOSTLEN
 + ("Öort = 65535")];

3410 
fd
;

3415 #i‡
SOCKS_CLIENT


3416 
p
 = "yaccenv-client-XXXXXX";

3418 
p
 = "yaccenv-server-XXXXXX";

3421 i‡((
fd
 = 
	`socks_mklock
(
p
, 
NULL
, 0)) == -1)

3422 
	`yyîr‹
("socks_mklock(ËÁûedÅÿ¸óãÅmpfûêusög ba£ %s", 
p
);

3425 i‡((
fd
 = 
	`›í
("/tmp/dante-envfile",

3426 
O_CREAT
 | 
O_TRUNC
 | 
O_RDWR
,

3427 
S_IRUSR
 | 
S_IWUSR
)) == -1)

3428 
	`£º
("%s: couldÇŸ o≥¿fûe", 
fun˘i⁄
);

3431 i‡((
Â
 = 
	`fd›í
(
fd
, "r+")Ë=
NULL
)

3432 
	`£º
("%s: fd›í(fd %dËÁûed", 
fun˘i⁄
, 
fd
);

3434 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_LOGOUTPUT
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
)

3435 i‡(
	`Ârötf
(
Â
, "logouçut: %s\n", 
p
) == -1)

3436 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3438 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_ERRLOGOUTPUT
, 
d⁄tˇª
)Ë!
NULL


3439 && *
p
 !
NUL
)

3440 i‡(
	`Ârötf
(
Â
, "îr‹log: %s\n", 
p
) == -1)

3441 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3443 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_DEBUG
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
)

3444 i‡(
	`Ârötf
(
Â
, "debug: %s\n", 
p
) == -1)

3445 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3447 *
rdr_‰om
 = 
NUL
;

3448 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_REDIRECT_FROM
, 
d⁄tˇª
)Ë!
NULL


3449 && *
p
 !
NUL
) {

3450 c⁄° *
¥efix
 = "redirect from";

3452 i‡(
	`°æí
(
¥efix
Ë+ såÀn(
p
Ë+ 1 > (
rdr_‰om
))

3453 
	`£º
("%s: %s value isÅooÜong. MaxÜength is %lu",

3454 
fun˘i⁄
,

3455 
ENV_SOCKS_REDIRECT_FROM
,

3456 ()(
rdr_‰om
Ë- (
	`°æí
(
¥efix
) + 1));

3458 
	`¢¥ötf
(
rdr_‰om
, ‘dr_‰om), "%s: %s\n", 
¥efix
, 
p
);

3461 
	`¢¥ötf
(
exå¨ouãöfo
, (extrarouteinfo),

3462 "%s", 
rdr_‰om
);

3469 *
havïroxy£rvî
 = 0;

3471 
i
 = 1;

3474 
«me
[(
ENV_SOCKS_ROUTE_
) + ("640")];

3476 
	`¢¥ötf
(
«me
, “ame), "%s%lu", 
ENV_SOCKS_ROUTE_
, ()
i
);

3478 i‡((
p
 = 
	`socks_gëív
(
«me
, 
d⁄tˇª
)Ë=
NULL
)

3481 i‡(*
p
 !
NUL
) {

3482 i‡(
	`Ârötf
(
Â
, "rouã { %†}\n", 
p
) == -1)

3483 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3485 *
havïroxy£rvî
 = 1;

3488 ++
i
;

3491 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS4_SERVER
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

3492 i‡(
	`Ârötf
(
Â
,

3497 "}\n", 
	`£rvî°rög2gw°rög
(
p
, 
PROXY_SOCKS_V4
, 
gw
, (gw)),

3498 
exå¨ouãöfo
) == -1)

3499 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3501 *
havïroxy£rvî
 = 1;

3504 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS5_SERVER
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

3505 i‡(
	`Ârötf
(
Â
,

3510 "}\n", 
	`£rvî°rög2gw°rög
(
p
, 
PROXY_SOCKS_V5
, 
gw
, (gw)),

3511 
exå¨ouãöfo
) == -1)

3512 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3514 *
havïroxy£rvî
 = 1;

3517 i‡((
p
 = 
	`socks_gëív
(
ENV_SOCKS_SERVER
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

3518 i‡(
	`Ârötf
(
Â
,

3522 "}\n", 
	`£rvî°rög2gw°rög
(
p
, 
PROXY_SOCKS_V5
, 
gw
, (gw)),

3523 
exå¨ouãöfo
) == -1)

3524 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3526 *
havïroxy£rvî
 = 1;

3529 i‡((
p
 = 
	`socks_gëív
(
ENV_HTTP_PROXY
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

3530 
sockaddr_°‹age
 
ß
;

3531 
gaõº
;

3532 
emsg
[512];

3534 i‡(
	`uæ°rög2sockaddr
(
p
, &
ß
, &
gaõº
, 
emsg
, ”msg)Ë=
NULL
)

3535 
	`£º
("%s: couldÇot convertÅo %sÅoán Internetáddress",

3536 
fun˘i⁄
, 
p
);

3538 i‡(
	`Ârötf
(
Â
,

3544 
	`sockaddr2°rög2
(&
ß
, 0, 
NULL
, 0),

3545 
	`¡ohs
(
	`GET_SOCKADDRPORT
(&
ß
)),

3546 
exå¨ouãöfo
)

3548 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3550 *
havïroxy£rvî
 = 1;

3553 i‡((
p
 = 
	`socks_gëív
(
ENV_UPNP_IGD
, 
d⁄tˇª
)Ë!
NULL
 && *∞!
NUL
) {

3554 i‡(
	`Ârötf
(
Â
,

3559 "}\n", 
p
, 
exå¨ouãöfo
) == -1)

3560 
	`£º
("%s: %s", 
fun˘i⁄
, 
Ârötf_îr‹
);

3562 *
havïroxy£rvî
 = 1;

3570 i‡(
	`f£ek
(
Â
, 0, 
SEEK_SET
) != 0)

3571 
	`yyîr‹
("fseek(3) onÅmpfile usedÅo holdÉnvironment-settings failed");

3573 
yyö
 = 
Â
;

3575 
Àx_d‹e°¨t
 = 1;

3576 
∑rsögc⁄fig
 = 1;

3577 
p
 = 
sockscf
.
›ti⁄
.
c⁄figfûe
;

3578 
sockscf
.
›ti⁄
.
c⁄figfûe
 = "<generated socks.conf>";

3580 
	`yy∑r£
();

3582 
sockscf
.
›ti⁄
.
c⁄figfûe
 = 
p
;

3583 
∑rsögc⁄fig
 = 0;

3585 
	`f˛o£
(
Â
);

3587 i‡(
	`socks_gëív
(
ENV_SOCKS_AUTOADD_LANROUTES
, 
isÁl£
Ë=
NULL
) {

3591 
iÁddrs
 *
iÁp
;

3593 
	`¶og
(
LOG_DEBUG
, "%s:áuto-addög dúe˘Ñouã†f‹Ü™ ...", 
fun˘i⁄
);

3595 i‡(
	`gëiÁddrs
(&
iÁp
) == 0) {

3596 
comm™d_t
 
comm™ds
;

3597 
¥Ÿocﬁ_t
 
¥Ÿocﬁs
;

3598 
iÁddrs
 *
iÁ˚
;

3600 
	`bzîo
(&
comm™ds
, (commands));

3601 
	`bzîo
(&
¥Ÿocﬁs
, (protocols));

3603 
¥Ÿocﬁs
.
t˝
 = 1;

3604 
¥Ÿocﬁs
.
udp
 = 1;

3606 
comm™ds
.
c⁄√˘
 = 1;

3607 
comm™ds
.
ud∑ssocüã
 = 1;

3609 
iÁ˚
 = 
iÁp
; iÁ˚ !
NULL
; iÁ˚ = iÁ˚->
iÁ_√xt
)

3610 i‡(
iÁ˚
->
iÁ_addr
 !
NULL


3611 && 
iÁ˚
->
iÁ_addr
->
ß_Ámûy
 =
AF_INET
) {

3612 i‡(
iÁ˚
->
iÁ_√tmask
 =
NULL
) {

3613 
	`sw¨n
("interface %s missingÇetmask, skipping",

3614 
iÁ˚
->
iÁ_«me
);

3618 
	`socks_autﬂdd_dúe˘rouã
(&
comm™ds
,

3619 &
¥Ÿocﬁs
,

3620 
	`TOCSS
(
iÁ˚
->
iÁ_addr
),

3621 
	`TOCSS
(
iÁ˚
->
iÁ_√tmask
));

3624 
	`‰ìiÁddrs
(
iÁp
);

3628 
	`¶og
(
LOG_DEBUG
, "%s:ÇŸáuto-addög dúe˘Ñouã†f‹Ü™", 
fun˘i⁄
);

3629 
	}
}

3632 
	$£rvî°rög2gw°rög
(
£rvî°rög
, 
vîsi⁄
, 
gw
, 
gwsize
)

3633 c⁄° *
£rvî°rög
;

3634 c⁄° 
vîsi⁄
;

3635 *
gw
;

3636 c⁄° 
size_t
 
gwsize
;

3638 c⁄° *
fun˘i⁄
 = "serverstring2gwstring()";

3639 *
£p
, 
emsg
[256];

3641 i‡(
vîsi⁄
 !
PROXY_SOCKS_V4
 && vîsi⁄ !
PROXY_SOCKS_V5
)

3642  
gw
;

3644 i‡(
	`°æí
(
£rvî°rög
Ë>
gwsize
)

3645 
	`£ºx
("%s: value ofÖroxyserver (%s) set inÉnvironment isÅooÜong. "

3647 
fun˘i⁄
, 
£rvî°rög
, ()(
gwsize
 - 1));

3649 i‡((
£p
 = 
	`°ºchr
(
£rvî°rög
, ':')Ë!
NULL
 && *(£∞+ 1Ë!
NUL
) {

3650 
p‹t
;

3652 i‡((
p‹t
 = 
	`°rög2p‹äumbî
(
£p
 + 1, 
emsg
, (emsg))) == -1)

3653 
	`yyîr‹x
("%s: %s", 
fun˘i⁄
, 
emsg
);

3655 
	`mem˝y
(
gw
, 
£rvî°rög
, 
£p
 - serverstring);

3656 
	`¢¥ötf
(&
gw
[
£p
 - 
£rvî°rög
],

3657 
gwsize
 - (
£p
 - 
£rvî°rög
),

3659 (
ö_p‹t_t
)
p‹t
);

3662 
visbuf
[256];

3664 
	`yyîr‹x
("%s: couldÇot findÖortnumber in %s serverstring \"%s\"",

3665 
fun˘i⁄
,

3666 
	`¥oxy¥Ÿocﬁ2°rög
(
vîsi⁄
),

3667 
	`°r2vis
(
£p
 =
NULL
 ? 
£rvî°rög
 : sep,

3668 
	`°æí
(
£p
 =
NULL
 ? 
£rvî°rög
 : sep),

3669 
visbuf
,

3670 (
visbuf
)));

3673  
gw
;

3674 
	}
}

3679 
	$¥e_addruÀ
(
ruÀ
)

3680 
ruÀ_t
 *
ruÀ
;

3683 
ruÀ
->
§c
 = src;

3684 
ruÀ
->
d°
 = dst;

3686 #i‡
HAVE_SOCKS_HOSTID


3687 
ruÀ
->
ho°id
 = hostid;

3690 
ruÀ
->
rdr_‰om
 =Ñdr_from;

3691 
ruÀ
->
rdr_to
 =Ñdr_to;

3693 i‡(
£ssi⁄_is£t
) {

3694 i‡((
ruÀ
->
ss
 = 
	`mÆloc
((*ruÀ->ss))Ë=
NULL
)

3695 
	`yyîr‹
("failedÅo malloc(3) %lu bytes for session memory",

3696 ()(*
ruÀ
->
ss
));

3698 *
ruÀ
->
ss
 = ss;

3701 i‡(
bw_is£t
) {

3702 i‡((
ruÀ
->
bw
 = 
	`mÆloc
((*ruÀ->bw))Ë=
NULL
)

3703 
	`yyîr‹
("failedÅo malloc(3) %lu bytes for bw memory",

3704 ()(*
ruÀ
->
bw
));

3706 *
ruÀ
->
bw
 = bw;

3708 
	}
}

3712 
	$po°_addruÀ
()

3715 
timeout
 = &
sockscf
.timeout;

3716 
	}
}

3719 
	$ruÀöô
(
ruÀ
)

3720 
ruÀ_t
 *
ruÀ
;

3722 
	`bzîo
(
ruÀ
, (*rule));

3724 
ruÀ
->
löíumbî
 = 
yylöío
;

3726 #i‡
HAVE_SOCKS_HOSTID


3727 
ruÀ
->
ho°ödex
 = 
DEFAULT_HOSTINDEX
;

3728 
ho°ödex
 = &
ruÀ
->hostindex;

3730 
ruÀ
->
ho°id›ti⁄_is£t
 = 0;

3731 
ho°id›ti⁄_is£t
 = &
ruÀ
->hostidoption_isset;

3734 
°©e
 = &
ruÀ
->state;

3736 
cmëhodv
 = 
°©e
->cmethodv;

3737 
cmëhodc
 = &
°©e
->cmethodc;

3739 
smëhodv
 = 
°©e
->smethodv;

3740 
smëhodc
 = &
°©e
->smethodc;

3746 
timeout
 = &
ruÀ
->timeout;

3747 *
timeout
 = 
sockscf
.timeout;

3749 #i‡
HAVE_GSSAPI


3750 
gsßpi£rvi˚«me
 = 
°©e
->gssapiservicename;

3751 
gsßpikeyèb
 = 
°©e
->gssapikeytab;

3752 
gsßpõn¸y±i⁄
 = &
°©e
->gssapiencryption;

3755 #i‡
HAVE_LDAP


3756 
ld≠
 = &
°©e
->ldap;

3759 
	`bzîo
(&
§c
, (src));

3760 
	`bzîo
(&
d°
, (dst));

3761 
	`bzîo
(&
ho°id
, (hostid));

3763 
	`bzîo
(&
rdr_‰om
, (rdr_from));

3764 
	`bzîo
(&
rdr_to
, (rdr_to));

3766 #i‡
BAREFOOTD


3767 
	`bzîo
(&
boun˚to
, (bounceto));

3770 
ruÀ
->
bw_isöhîôabÀ
 =ÑuÀ->
ss_isöhîôabÀ
 = 1;

3772 
	`bzîo
(&
ss
, (ss));

3773 
	`bzîo
(&
bw
, (bw));

3775 
bw_is£t
 = 
£ssi⁄_is£t
 = 0;

3776 
bw
.
ty≥
 = 
SHMEM_BW
;

3777 
ss
.
ty≥
 = 
SHMEM_SS
;

3778 
	}
}

3781 
	$Æ¨möô
()

3783 
Æ¨mside_mem
;

3785 
Æ¨mside
 = &
Æ¨mside_mem
;

3786 *
Æ¨mside
 = 0;

3787 
	}
}

3790 
	$m⁄ô‹öô
(
m⁄ô‹
)

3791 
m⁄ô‹_t
 *
m⁄ô‹
;

3793 
Æ¨mside_mem
;

3795 
Æ¨mside
 = &
Æ¨mside_mem
;

3797 
	`bzîo
(
m⁄ô‹
, (*monitor));

3799 
m⁄ô‹
->
löíumbî
 = 
yylöío
;

3801 
°©e
 = &
m⁄ô‹
->state;

3803 #i‡
HAVE_SOCKS_HOSTID


3804 
m⁄ô‹
->
ho°ödex
 = 
DEFAULT_HOSTINDEX
;

3805 
ho°ödex
 = &
m⁄ô‹
->hostindex;

3807 
m⁄ô‹
->
ho°id›ti⁄_is£t
 = 0;

3808 
ho°id›ti⁄_is£t
 = &
m⁄ô‹
->hostidoption_isset;

3811 
	`bzîo
(&
§c
, (src));

3812 
	`bzîo
(&
d°
, (dst));

3813 
	`bzîo
(&
ho°id
, (hostid));

3815 i‡((
m⁄ô‹
->
m°©s
 = 
	`mÆloc
((*m⁄ô‹->m°©s))Ë=
NULL
)

3816 
	`yyîr‹
("failedÅo malloc(3) %lu bytes for monitor stats memory",

3817 ()(*
m⁄ô‹
->
m°©s
));

3819 
	`bzîo
(
m⁄ô‹
->
m°©s
, (*monitor->mstats));

3821 
m⁄ô‹
->
m°©s
->
ty≥
 = 
SHMEM_MONITOR
;

3822 
	}
}

3825 
	$¥e_addm⁄ô‹
(
m⁄ô‹
)

3826 
m⁄ô‹_t
 *
m⁄ô‹
;

3828 
m⁄ô‹
->
§c
 = src;

3829 
m⁄ô‹
->
d°
 = dst;

3831 #i‡
HAVE_SOCKS_HOSTID


3832 
m⁄ô‹
->
ho°id
 = hostid;

3834 
	}
}

3837 
	$c⁄figuª_¥ivûeges
()

3839 c⁄° *
fun˘i⁄
 = "configure_privileges()";

3840 
isfú°time
 = 1;

3842 i‡(
sockscf
.
›ti⁄
.
vîify⁄ly
)

3845 #i‡!
HAVE_PRIVILEGES


3846 
uid_t
 
uid
;

3847 
gid_t
 
gid
;

3849 
	`SASSERTX
(
sockscf
.
°©e
.
euid
 =(
uid
 = 
	`gëeuid
()));

3850 
	`SASSERTX
(
sockscf
.
°©e
.
egid
 =(
gid
 = 
	`gëegid
()));

3856 
	`checkugid
(&
sockscf
.
uid
.
¥ivûeged_uid
,

3857 &
sockscf
.
uid
.
¥ivûeged_gid
,

3858 &
sockscf
.
uid
.
¥ivûeged_is£t
,

3861 
	`checkugid
(&
sockscf
.
uid
.
u≈rivûeged_uid
,

3862 &
sockscf
.
uid
.
u≈rivûeged_gid
,

3863 &
sockscf
.
uid
.
u≈rivûeged_is£t
,

3866 #i‡
HAVE_LIBWRAP


3867 i‡(!
sockscf
.
uid
.
libwøp_is£t


3868 && 
sockscf
.
uid
.
u≈rivûeged_is£t
) {

3869 
sockscf
.
uid
.
libwøp_uid
 = sockscf.uid.
u≈rivûeged_uid
;

3870 
sockscf
.
uid
.
libwøp_gid
 = sockscf.uid.
u≈rivûeged_gid
;

3871 
sockscf
.
uid
.
libwøp_is£t
 = sockscf.uid.
u≈rivûeged_is£t
;

3874 
	`checkugid
(&
sockscf
.
uid
.
libwøp_uid
,

3875 &
sockscf
.
uid
.
libwøp_gid
,

3876 &
sockscf
.
uid
.
libwøp_is£t
,

3880 
	`SASSERTX
(
sockscf
.
°©e
.
euid
 =(
uid
 = 
	`gëeuid
()));

3881 
	`SASSERTX
(
sockscf
.
°©e
.
egid
 =(
gid
 = 
	`gëegid
()));

3885 i‡(
isfú°time
) {

3886 i‡(
	`sockd_öô¥ivs
() != 0) {

3887 
	`¶og
(
HAVE_PRIVILEGES
 ? 
LOG_INFO
 : 
LOG_WARNING
,

3889 
fun˘i⁄
,

3890 
	`°ªº‹
(
î∫o
),

3891 
	`gëeuid
() == 0 ?

3895 #i‡
HAVE_PRIVILEGES


3907 
isfú°time
 = 0;

3911 
	}
}

3914 
	$checkugid
(
uid
, 
gid
, 
is£t
, 
ty≥
)

3915 
uid_t
 *
uid
;

3916 
gid_t
 *
gid
;

3917 *
is£t
;

3918 c⁄° *
ty≥
;

3920 c⁄° *
fun˘i⁄
 = "checkugid()";

3922 
	`SASSERTX
(
sockscf
.
°©e
.
euid
 =
	`gëeuid
());

3923 
	`SASSERTX
(
sockscf
.
°©e
.
egid
 =
	`gëegid
());

3925 i‡(
sockscf
.
›ti⁄
.
vîify⁄ly
)

3928 i‡(!(*
is£t
)) {

3929 *
uid
 = 
sockscf
.
°©e
.
euid
;

3930 *
gid
 = 
sockscf
.
°©e
.
egid
;

3931 *
is£t
 = 1;

3936 i‡(*
uid
 !
sockscf
.
°©e
.
euid
) {

3937 i‡(
	`£ãuid
(*
uid
) != 0) {

3938 
	`sw¨n
("%s: couldÇot seteuid(2)Åo %s uid %lu",

3939 
fun˘i⁄
, 
ty≥
, ()*
uid
);

3944 ()
	`£ãuid
(0);

3946 i‡(
	`£ãuid
(
sockscf
.
°©e
.
euid
) != 0) {

3947 
	`sw¨n
("%s: couldÇotÑevertÅoÉuid %lu fromÉuid %lu",

3948 
fun˘i⁄
,

3949 ()
sockscf
.
°©e
.
euid
,

3950 ()
	`gëeuid
());

3951 
	`SWARN
(0);

3953 
sockscf
.
°©e
.
euid
 = 
	`gëeuid
();

3958 i‡(*
gid
 !
sockscf
.
°©e
.
egid
) {

3959 ()
	`£ãuid
(0);

3961 i‡(
	`£ãgid
(*
gid
) != 0) {

3962 
	`sw¨n
("%s: couldÇot setegid(2)Åo %s gid %lu",

3963 
fun˘i⁄
, 
ty≥
, ()*
gid
);

3968 ()
	`£ãuid
(0);

3970 i‡(
	`£ãgid
(
sockscf
.
°©e
.
egid
) != 0) {

3971 
	`sw¨n
("%s: couldÇotÑevertÅoÉgid %lu fromÉuid %lu",

3972 
fun˘i⁄
,

3973 ()
sockscf
.
°©e
.
egid
,

3974 ()
	`gëeuid
());

3975 
	`SWARN
(0);

3977 
sockscf
.
°©e
.
egid
 = 
	`gëegid
();

3981 i‡(
	`£ãuid
(
sockscf
.
°©e
.
euid
) != 0) {

3982 
	`sw¨n
("%s: couldÇotÑevertÅoÉuid %lu fromÉuid %lu",

3983 
fun˘i⁄
,

3984 ()
sockscf
.
°©e
.
euid
,

3985 ()
	`gëeuid
());

3986 
	`SWARN
(0);

3988 
sockscf
.
°©e
.
euid
 = 
	`gëeuid
();

3993 
	`SASSERTX
(
sockscf
.
°©e
.
euid
 =
	`gëeuid
());

3994 
	`SASSERTX
(
sockscf
.
°©e
.
egid
 =
	`gëegid
());

3997 
	}
}

	@lib/config_scan.c

1 
	~"comm⁄.h
"

2 
	#yy_¸óã_buf„r
 
socks_yy_¸óã_buf„r


	)

3 
	#yy_dñëe_buf„r
 
socks_yy_dñëe_buf„r


	)

4 
	#yy_sˇn_buf„r
 
socks_yy_sˇn_buf„r


	)

5 
	#yy_sˇn_°rög
 
socks_yy_sˇn_°rög


	)

6 
	#yy_sˇn_byãs
 
socks_yy_sˇn_byãs


	)

7 
	#yy_Êex_debug
 
socks_yy_Êex_debug


	)

8 
	#yy_öô_buf„r
 
socks_yy_öô_buf„r


	)

9 
	#yy_Êush_buf„r
 
socks_yy_Êush_buf„r


	)

10 
	#yy_lﬂd_buf„r_°©e
 
socks_yy_lﬂd_buf„r_°©e


	)

11 
	#yy_swôch_to_buf„r
 
socks_yy_swôch_to_buf„r


	)

12 
	#yyö
 
socks_yyö


	)

13 
	#yyÀng
 
socks_yyÀng


	)

14 
	#yyÀx
 
socks_yyÀx


	)

15 
	#yyout
 
socks_yyout


	)

16 
	#yyª°¨t
 
socks_yyª°¨t


	)

17 
	#yyãxt
 
socks_yyãxt


	)

18 
	#yylöío
 
socks_yylöío


	)

29 
	#FLEX_SCANNER


	)

30 
	#YY_FLEX_MAJOR_VERSION
 2

	)

31 
	#YY_FLEX_MINOR_VERSION
 5

	)

33 
	~<°dio.h
>

34 
	~<î∫o.h
>

38 #ifde‡
c_∂u•lus


39 #i‚de‡
__˝lu•lus


40 
	#__˝lu•lus


	)

45 #ifde‡
__˝lu•lus


47 
	~<°dlib.h
>

48 
	~<uni°d.h
>

51 
	#YY_USE_PROTOS


	)

54 
	#YY_USE_CONST


	)

58 #ifde‡
__STDC__


60 
	#YY_USE_PROTOS


	)

61 
	#YY_USE_CONST


	)

66 #ifde‡
__TURBOC__


67 #¥agm®
w¨n
 -
rch


68 #¥agm®
w¨n
 -
u£


69 
	~<io.h
>

70 
	~<°dlib.h
>

71 
	#YY_USE_CONST


	)

72 
	#YY_USE_PROTOS


	)

75 #ifde‡
YY_USE_CONST


76 
	#yyc⁄°
 c⁄°

	)

78 
	#yyc⁄°


	)

82 #ifde‡
YY_USE_PROTOS


83 
	#YY_PROTO
(
¥Ÿo
Ë
	)
proto

85 
	#YY_PROTO
(
¥Ÿo
Ë()

	)

89 
	#YY_NULL
 0

	)

96 
	#YY_SC_TO_UI
(
c
Ë((Ë(Ëc)

	)

102 
	#BEGIN
 
yy_°¨t
 = 1 + 2 *

	)

108 
	#YY_START
 ((
yy_°¨t
 - 1Ë/ 2)

	)

109 
	#YYSTATE
 
YY_START


	)

112 
	#YY_STATE_EOF
(
°©e
Ë(
YY_END_OF_BUFFER
 + sèã + 1)

	)

115 
	#YY_NEW_FILE
 
	`yyª°¨t
–
yyö
 )

	)

117 
	#YY_END_OF_BUFFER_CHAR
 0

	)

120 
	#YY_BUF_SIZE
 16384

	)

122 
yy_buf„r_°©e
 *
	tYY_BUFFER_STATE
;

124 
yyÀng
;

125 
FILE
 *
yyö
, *
yyout
;

127 
	#EOB_ACT_CONTINUE_SCAN
 0

	)

128 
	#EOB_ACT_END_OF_FILE
 1

	)

129 
	#EOB_ACT_LAST_MATCH
 2

	)

147 
	#yyÀss
(
n
) \

151 *
yy_˝
 = 
yy_hﬁd_ch¨
; \

152 
YY_RESTORE_YY_MORE_OFFSET
 \

153 
yy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 
n
 - 
YY_MORE_ADJ
; \

154 
YY_DO_BEFORE_ACTION
; \

156  0 )

	)

158 
	#u≈ut
(
c
Ë
	`yyu≈ut
–c, 
yyãxt_±r
 )

	)

164 
	tyy_size_t
;

167 
	syy_buf„r_°©e


169 
FILE
 *
	myy_öput_fûe
;

171 *
	myy_ch_buf
;

172 *
	myy_buf_pos
;

177 
yy_size_t
 
	myy_buf_size
;

182 
	myy_n_ch¨s
;

188 
	myy_is_our_buf„r
;

195 
	myy_is_öãø˘ive
;

201 
	myy_©_bﬁ
;

206 
	myy_fûl_buf„r
;

208 
	myy_buf„r_°©us
;

209 
	#YY_BUFFER_NEW
 0

	)

210 
	#YY_BUFFER_NORMAL
 1

	)

221 
	#YY_BUFFER_EOF_PENDING
 2

	)

224 
YY_BUFFER_STATE
 
	gyy_cuºít_buf„r
 = 0;

230 
	#YY_CURRENT_BUFFER
 
yy_cuºít_buf„r


	)

234 
	gyy_hﬁd_ch¨
;

236 
	gyy_n_ch¨s
;

239 
	gyyÀng
;

242 *
	gyy_c_buf_p
 = (*) 0;

243 
	gyy_öô
 = 1;

244 
	gyy_°¨t
 = 0;

249 
	gyy_did_buf„r_swôch_⁄_eof
;

251 
yyª°¨t
 
YY_PROTO
(–
FILE
 *
öput_fûe
 ));

253 
yy_swôch_to_buf„r
 
YY_PROTO
(–
YY_BUFFER_STATE
 
√w_buf„r
 ));

254 
yy_lﬂd_buf„r_°©e
 
YY_PROTO
(( ));

255 
YY_BUFFER_STATE
 
yy_¸óã_buf„r
 
YY_PROTO
(–
FILE
 *
fûe
, 
size
 ));

256 
yy_dñëe_buf„r
 
YY_PROTO
(–
YY_BUFFER_STATE
 
b
 ));

257 
yy_öô_buf„r
 
YY_PROTO
(–
YY_BUFFER_STATE
 
b
, 
FILE
 *
fûe
 ));

258 
yy_Êush_buf„r
 
YY_PROTO
(–
YY_BUFFER_STATE
 
b
 ));

259 
	#YY_FLUSH_BUFFER
 
	`yy_Êush_buf„r
–
yy_cuºít_buf„r
 )

	)

261 
YY_BUFFER_STATE
 
yy_sˇn_buf„r
 
YY_PROTO
(–*
ba£
, 
yy_size_t
 
size
 ));

262 
YY_BUFFER_STATE
 
yy_sˇn_°rög
 
YY_PROTO
(–
yyc⁄°
 *
yy_°r
 ));

263 
YY_BUFFER_STATE
 
yy_sˇn_byãs
 
YY_PROTO
(–
yyc⁄°
 *
byãs
, 
Àn
 ));

265 *
yy_Êex_Æloc
 
YY_PROTO
(–
yy_size_t
 ));

266 *
yy_Êex_ªÆloc
 
YY_PROTO
(–*, 
yy_size_t
 ));

267 
yy_Êex_‰ì
 
YY_PROTO
(( * ));

269 
	#yy_√w_buf„r
 
yy_¸óã_buf„r


	)

271 
	#yy_£t_öãø˘ive
(
is_öãø˘ive
) \

273 i‡–! 
yy_cuºít_buf„r
 ) \

274 
yy_cuºít_buf„r
 = 
	`yy_¸óã_buf„r
–
yyö
, 
YY_BUF_SIZE
 ); \

275 
yy_cuºít_buf„r
->
yy_is_öãø˘ive
 = 
is_öãø˘ive
; \

276 }

	)

278 
	#yy_£t_bﬁ
(
©_bﬁ
) \

280 i‡–! 
yy_cuºít_buf„r
 ) \

281 
yy_cuºít_buf„r
 = 
	`yy_¸óã_buf„r
–
yyö
, 
YY_BUF_SIZE
 ); \

282 
yy_cuºít_buf„r
->
yy_©_bﬁ
 = 
©_bﬁ
; \

283 }

	)

285 
	#YY_AT_BOL
(Ë(
yy_cuºít_buf„r
->
yy_©_bﬁ
)

	)

288 
	#YY_USES_REJECT


	)

290 
	#yywøp
(Ë1

	)

291 
	#YY_SKIP_YYWRAP


	)

292 
	tYY_CHAR
;

293 
FILE
 *
	gyyö
 = (FILE *Ë0, *
	gyyout
 = (FILE *) 0;

294 
	tyy_°©e_ty≥
;

295 
yylöío
;

296 
	gyylöío
 = 1;

297 *
yyãxt
;

298 
	#yyãxt_±r
 
yyãxt


	)

300 
yy_°©e_ty≥
 
yy_gë_¥evious_°©e
 
YY_PROTO
(( ));

301 
yy_°©e_ty≥
 
yy_åy_NUL_å™s
 
YY_PROTO
(–yy_°©e_ty≥ 
cuºít_°©e
 ));

302 
yy_gë_√xt_buf„r
 
YY_PROTO
(( ));

303 
yy_Áèl_îr‹
 
YY_PROTO
(–
yyc⁄°
 
msg
[] ));

308 
	#YY_DO_BEFORE_ACTION
 \

309 
yyãxt_±r
 = 
yy_bp
; \

310 
yyÀng
 = (Ë(
yy_˝
 - 
yy_bp
); \

311 
yy_hﬁd_ch¨
 = *
yy_˝
; \

312 *
yy_˝
 = '\0'; \

313 
yy_c_buf_p
 = 
yy_˝
;

	)

315 
	#YY_NUM_RULES
 225

	)

316 
	#YY_END_OF_BUFFER
 226

	)

317 
yyc⁄°
 
	gyy_ac˛i°
[2056] =

547 
yyc⁄°
 
	gyy_ac˚±
[2577] =

834 
yyc⁄°
 
	gyy_ec
[256] =

866 
yyc⁄°
 
	gyy_mëa
[56] =

876 
yyc⁄°
 
	gyy_ba£
[2730] =

1180 
yyc⁄°
 
	gyy_def
[2730] =

1484 
yyc⁄°
 
	gyy_nxt
[6929] =

2250 
yyc⁄°
 
	gyy_chk
[6929] =

3016 
yy_°©e_ty≥
 
	gyy_°©e_buf
[
YY_BUF_SIZE
 + 2], *
	gyy_°©e_±r
;

3017 *
	gyy_fuŒ_m©ch
;

3018 
	gyy_Õ
;

3019 
	gyy_lookög_f‹_åaû_begö
 = 0;

3020 
	gyy_fuŒ_Õ
;

3021 *
	gyy_fuŒ_°©e
;

3022 
	#YY_TRAILING_MASK
 0x2000

	)

3023 
	#YY_TRAILING_HEAD_MASK
 0x4000

	)

3024 
	#REJECT
 \

3026 *
yy_˝
 = 
yy_hﬁd_ch¨
; \

3027 
yy_˝
 = 
yy_fuŒ_m©ch
; \

3028 
yy_Õ
 = 
yy_fuŒ_Õ
; \

3029 
yy_°©e_±r
 = 
yy_fuŒ_°©e
; \

3030 
yy_cuºít_°©e
 = *
yy_°©e_±r
; \

3031 ++
yy_Õ
; \

3032 
föd_ruÀ
; \

3033 }

	)

3034 
	#yym‹e
(Ë
yym‹e_u£d_but_nŸ_dëe˘ed


	)

3035 
	#YY_MORE_ADJ
 0

	)

3036 
	#YY_RESTORE_YY_MORE_OFFSET


	)

3037 *
	gyyãxt
;

3039 
	#INITIAL
 0

	)

3086 
	~"comm⁄.h
"

3089 c⁄° 
	grcsid
[] =

3092 
	~"yacc⁄fig.h
"

3093 
	~"c⁄fig_∑r£.h
"

3095 
	#YY_STACK_USED
 0

	)

3096 
	#YY_ALWAYS_INTERACTIVE
 0

	)

3097 
	#YY_NEVER_INTERACTIVE
 1

	)

3098 
	#YY_MAIN
 0

	)

3100 #i‡
SOCKS_CLIENT


3105 
	#PROC_MOTHER
 0

	)

3106 
	#PROC_NEGOTIATE
 0

	)

3107 
	#PROC_REQUEST
 0

	)

3108 
	#PROC_IO
 0

	)

3109 
	#PROC_MONITOR
 0

	)

3113 
shouldª£t°©e
(c⁄° 
cuºít_°©e
, c⁄° 
√xt_tokí
);

3121 c⁄° 
socks_c⁄figty≥
;

3122 
Àx_d‹e°¨t
;

3124 
	gcuºíéexlöe
[100];

3125 
	g¥eviou¶exlöe
[100];

3126 
	gismask
;

3127 
	görouã
, 
	gö˛õ¡ruÀ
;

3133 
	#YY_NO_UNPUT
 1

	)

3136 
	#°¨t_addªss
 1

	)

3138 
	#°¨t_p‹t
 2

	)

3141 
	#löïªfix
 3

	)

3143 
	#°¨t_comm™d
 4

	)

3145 
	#°¨t_com∑tibûôy
 5

	)

3147 
	#°¨t_löe
 6

	)

3149 
	#°¨t_log
 7

	)

3151 
	#°¨t_logÀvñ
 8

	)

3153 
	#°¨t_logouçut
 9

	)

3155 
	#°¨t_logty≥
 10

	)

3157 
	#°¨t_îr‹symbﬁ
 11

	)

3159 
	#°¨t_mëhod
 12

	)

3161 
	#°¨t_›ti⁄
 13

	)

3163 
	#°¨t_¥oxy¥Ÿocﬁ
 14

	)

3165 
	#°¨t_u£∫ame
 15

	)

3167 
	#°¨t_grou≤ame
 16

	)

3169 
	#°¨t_libwøpfûe
 17

	)

3171 
	#°¨t_˝u›ti⁄
 18

	)

3173 
	#°¨t_ho°ödex
 19

	)

3175 
	#°¨t_°©ekey
 20

	)

3177 
	#°¨t_t˝›ti⁄
 21

	)

3180 
	#°¨t_ld≠domaö
 22

	)

3182 
	#°¨t_ld≠ba£dn
 23

	)

3184 
	#°¨t_ld≠uæ
 24

	)

3186 
	#°¨t_ld≠fûãr
 25

	)

3188 
	#°¨t_ld≠©åibuã
 26

	)

3190 
	#°¨t_ld≠£rvî«me
 27

	)

3192 
	#°¨t_ld≠grou≤ame
 28

	)

3194 
	#°¨t_ld≠keyèb«me
 29

	)

3196 
	#°¨t_ld≠˚πfûe
 30

	)

3198 
	#°¨t_ld≠˚π∑th
 31

	)

3200 
	#°¨t_Æ¨mã°
 32

	)

3202 
	#°¨t_§cho°
 33

	)

3204 
	#°¨t_¥Ÿocﬁ
 34

	)

3206 
	#°¨t_£rvi˚«me
 35

	)

3208 
	#°¨t_p‹äumbî
 36

	)

3210 
	#°¨t_bsdauth°yÀ«me
 37

	)

3212 
	#°¨t_gsßpi£rvi˚«me
 38

	)

3214 
	#°¨t_gsßpikeyèb«me
 39

	)

3216 
	#°¨t_í¸y±i⁄
 40

	)

3218 
	#°¨t_ªÆm«me
 41

	)

3220 
	#°¨t_sockë¥Ÿocﬁ
 42

	)

3222 
	#°¨t_sockë›ti⁄
 43

	)

3224 
	#°¨t_sockë›ti⁄vÆue
 44

	)

3226 
	#°¨t_¥o˚s°y≥
 45

	)

3228 
	#°¨t_scheduÀpﬁicy
 46

	)

3230 
	#°¨t_scheduÀmask
 47

	)

3238 #i‚de‡
YY_SKIP_YYWRAP


3239 #ifde‡
__˝lu•lus


3240 "C" 
yywøp
 
YY_PROTO
(( ));

3242 
yywøp
 
YY_PROTO
(( ));

3246 #i‚de‡
YY_NO_UNPUT


3247 
yyu≈ut
 
YY_PROTO
(–
c
, *
buf_±r
 ));

3250 #i‚de‡
yyãxt_±r


3251 
yy_Êex_°∫˝y
 
YY_PROTO
(–*, 
yyc⁄°
 *, ));

3254 #ifde‡
YY_NEED_STRLEN


3255 
yy_Êex_°æí
 
YY_PROTO
(–
yyc⁄°
 * ));

3258 #i‚de‡
YY_NO_INPUT


3259 #ifde‡
__˝lu•lus


3260 
yyöput
 
YY_PROTO
(( ));

3262 
öput
 
YY_PROTO
(( ));

3266 #i‡
deföed
(
YY_STACK_USED
) && YY_STACK_USED

3267 
	gyy_°¨t_°ack_±r
 = 0;

3268 
	gyy_°¨t_°ack_dïth
 = 0;

3269 *
	gyy_°¨t_°ack
 = 0;

3270 #i‚de‡
YY_NO_PUSH_STATE


3271 
yy_push_°©e
 
YY_PROTO
(–
√w_°©e
 ));

3273 #i‚de‡
YY_NO_POP_STATE


3274 
yy_p›_°©e
 
YY_PROTO
(( ));

3276 #i‚de‡
YY_NO_TOP_STATE


3277 
yy_t›_°©e
 
YY_PROTO
(( ));

3281 
	#YY_NO_PUSH_STATE
 1

	)

3282 
	#YY_NO_POP_STATE
 1

	)

3283 
	#YY_NO_TOP_STATE
 1

	)

3286 #ifde‡
YY_MALLOC_DECL


3287 
	gYY_MALLOC_DECL


3289 #ifde‡
__STDC__


3290 #i‚de‡
__˝lu•lus


3291 
	~<°dlib.h
>

3302 #i‚de‡
YY_READ_BUF_SIZE


3303 
	#YY_READ_BUF_SIZE
 8192

	)

3308 #i‚de‡
ECHO


3312 
	#ECHO
 (Ë
	`fwrôe
–
yyãxt
, 
yyÀng
, 1, 
yyout
 )

	)

3318 #i‚de‡
YY_INPUT


3319 
	#YY_INPUT
(
buf
,
ªsu…
,
max_size
) \

3320 i‡–
yy_cuºít_buf„r
->
yy_is_öãø˘ive
 ) \

3322 
c
 = '*', 
n
; \

3323  
n
 = 0;Ç < 
max_size
 && \

3324 (
c
 = 
	`gëc
–
yyö
 )Ë!
EOF
 && c !'\n'; ++
n
 ) \

3325 
buf
[
n
] = (Ë
c
; \

3326 i‡–
c
 == '\n' ) \

3327 
buf
[
n
++] = (Ë
c
; \

3328 i‡–
c
 =
EOF
 && 
	`„º‹
–
yyö
 ) ) \

3329 
	`YY_FATAL_ERROR
( "input in flex scanner failed" ); \

3330 
ªsu…
 = 
n
; \

3332 i‡–((
ªsu…
 = 
	`‰ód
–
buf
, 1, 
max_size
, 
yyö
 )) == 0) \

3333 && 
	`„º‹
–
yyö
 ) ) \

3334 
	`YY_FATAL_ERROR
–"öpuàö fÀx sˇ¬î faûed" );

	)

3341 #i‚de‡
yyãrmö©e


3342 
	#yyãrmö©e
(Ë 
YY_NULL


	)

3346 #i‚de‡
YY_START_STACK_INCR


3347 
	#YY_START_STACK_INCR
 25

	)

3351 #i‚de‡
YY_FATAL_ERROR


3352 
	#YY_FATAL_ERROR
(
msg
Ë
	`yy_Áèl_îr‹
–msg )

	)

3358 #i‚de‡
YY_DECL


3359 
	#YY_DECL
 
yyÀx
 
	`YY_PROTO
(–))

	)

3365 #i‚de‡
YY_USER_ACTION


3366 
	#YY_USER_ACTION


	)

3370 #i‚de‡
YY_BREAK


3371 
	#YY_BREAK
 ;

	)

3374 
	#YY_RULE_SETUP
 \

3375 i‡–
yyÀng
 > 0 ) \

3376 
yy_cuºít_buf„r
->
yy_©_bﬁ
 = \

3377 (
yyãxt
[
yyÀng
 - 1] == '\n'); \

3378 
YY_USER_ACTION


	)

3380 
	gYY_DECL


3382 
yy_°©e_ty≥
 
	gyy_cuºít_°©e
;

3383 *
	gyy_˝
, *
	gyy_bp
;

3384 
	gyy_a˘
;

3391 i‡(
	gÀx_d‹e°¨t
) {

3392 
	gÀx_d‹e°¨t
 = 0;

3393 
	gö˛õ¡ruÀ
 = 
örouã
 = 0;

3395 
	gsocks_c⁄figty≥
) {

3396 
	gCONFIGTYPE_SERVER
:

3397  
SERVERCONFIG
;

3399 
	gCONFIGTYPE_CLIENT
:

3400  
CLIENTCONFIG
;

3403 
SERRX
(
socks_c⁄figty≥
);

3409 \
	gn
.* {

3410 c⁄° *
	g°rù
 = " \n\t";

3411 c⁄° *
	gp
 = 
cuºíéexlöe
;

3413 
SKIPLEADING
(
p
, 
°rù
);

3414 i‡(
°æí
(
p
) > 0)

3415 
°r˝y
(
¥eviou¶exlöe
, 
cuºíéexlöe
);

3418 
°∫˝y
(
cuºíéexlöe
, 
yyãxt
, (currentlexline) - 1);

3419 
	gcuºíéexlöe
[(
cuºíéexlöe
Ë- 1] = 
NUL
;

3421 ++
	gyylöío
;

3422 
yyÀss
(1);

3434 i‡–
	gyy_öô
 )

3436 
	gyy_öô
 = 0;

3438 #ifde‡
YY_USER_INIT


3439 
	gYY_USER_INIT
;

3442 i‡–! 
	gyy_°¨t
 )

3443 
	gyy_°¨t
 = 1;

3445 i‡–! 
	gyyö
 )

3446 
	gyyö
 = 
°dö
;

3448 i‡–! 
	gyyout
 )

3449 
	gyyout
 = 
°dout
;

3451 i‡–! 
	gyy_cuºít_buf„r
 )

3452 
	gyy_cuºít_buf„r
 =

3453 
yy_¸óã_buf„r
–
yyö
, 
YY_BUF_SIZE
 );

3455 
yy_lﬂd_buf„r_°©e
();

3460 
	gyy_˝
 = 
yy_c_buf_p
;

3463 *
	gyy_˝
 = 
yy_hﬁd_ch¨
;

3468 
	gyy_bp
 = 
yy_˝
;

3470 
	gyy_cuºít_°©e
 = 
yy_°¨t
;

3471 
	gyy_cuºít_°©e
 +
YY_AT_BOL
();

3472 
	gyy_°©e_±r
 = 
yy_°©e_buf
;

3473 *
	gyy_°©e_±r
++ = 
yy_cuºít_°©e
;

3474 
	gyy_m©ch
:

3477 
YY_CHAR
 
yy_c
 = 
yy_ec
[
YY_SC_TO_UI
(*
yy_˝
)];

3478  
	gyy_chk
[
yy_ba£
[
yy_cuºít_°©e
] + 
	gyy_c
] != yy_current_state )

3480 
yy_cuºít_°©e
 = (Ë
yy_def
[yy_current_state];

3481 i‡–
	gyy_cuºít_°©e
 >= 2576 )

3482 
yy_c
 = 
yy_mëa
[() yy_c];

3484 
	gyy_cuºít_°©e
 = 
yy_nxt
[
yy_ba£
[
yy_cuºít_°©e
] + (Ë
yy_c
];

3485 *
	gyy_°©e_±r
++ = 
yy_cuºít_°©e
;

3486 ++
	gyy_˝
;

3488  
	gyy_ba£
[
yy_cuºít_°©e
] != 6873 );

3490 
	gyy_föd_a˘i⁄
:

3491 
yy_cuºít_°©e
 = *--
yy_°©e_±r
;

3492 
	gyy_Õ
 = 
yy_ac˚±
[
yy_cuºít_°©e
];

3493 
	gföd_ruÀ
:

3496 i‡–
	gyy_Õ
 && yy_Õ < 
	gyy_ac˚±
[
yy_cuºít_°©e
 + 1] )

3498 
	gyy_a˘
 = 
yy_ac˛i°
[
yy_Õ
];

3499 i‡–
	gyy_a˘
 & 
	gYY_TRAILING_HEAD_MASK
 ||

3500 
	gyy_lookög_f‹_åaû_begö
 )

3502 i‡–
	gyy_a˘
 =
yy_lookög_f‹_åaû_begö
 )

3504 
yy_lookög_f‹_åaû_begö
 = 0;

3505 
	gyy_a˘
 &~
YY_TRAILING_HEAD_MASK
;

3509 i‡–
	gyy_a˘
 & 
	gYY_TRAILING_MASK
 )

3511 
	gyy_lookög_f‹_åaû_begö
 = 
yy_a˘
 & ~
YY_TRAILING_MASK
;

3512 
	gyy_lookög_f‹_åaû_begö
 |
YY_TRAILING_HEAD_MASK
;

3513 
	gyy_fuŒ_m©ch
 = 
yy_˝
;

3514 
	gyy_fuŒ_°©e
 = 
yy_°©e_±r
;

3515 
	gyy_fuŒ_Õ
 = 
yy_Õ
;

3519 
	gyy_fuŒ_m©ch
 = 
yy_˝
;

3520 
	gyy_fuŒ_°©e
 = 
yy_°©e_±r
;

3521 
	gyy_fuŒ_Õ
 = 
yy_Õ
;

3524 ++
	gyy_Õ
;

3525 
	gföd_ruÀ
;

3527 --
	gyy_˝
;

3528 
	gyy_cuºít_°©e
 = *--
yy_°©e_±r
;

3529 
	gyy_Õ
 = 
yy_ac˚±
[
yy_cuºít_°©e
];

3532 
	gYY_DO_BEFORE_ACTION
;

3534 i‡–
	gyy_a˘
 !
YY_END_OF_BUFFER
 )

3536 
yyl
;

3537  
	gyyl
 = 0; yy»< 
	gyyÀng
; ++yyl )

3538 i‡–
	gyyãxt
[
yyl
] == '\n' )

3539 ++
yylöío
;

3542 
	gdo_a˘i⁄
:

3545  
yy_a˘
 )

3548 
YY_RULE_SETUP


3551 
yylvÆ
.
°rög
 = 
yyãxt
;

3552  
	gIPV4
;

3554 
YY_BREAK


3556 
YY_RULE_SETUP


3559 
yylvÆ
.
°rög
 = 
yyãxt
;

3560  
	gIPV6
;

3562 
YY_BREAK


3564 
YY_RULE_SETUP


3567 
yylvÆ
.
°rög
 = 
yyãxt
;

3568  
	gECN
;

3570 
YY_BREAK


3572 
YY_RULE_SETUP


3575 
yylvÆ
.
°rög
 = 
yyãxt
;

3576  
	gSACK
;

3578 
YY_BREAK


3580 
YY_RULE_SETUP


3583 
yylvÆ
.
°rög
 = 
yyãxt
;

3584  
	gTIMESTAMPS
;

3586 
YY_BREAK


3588 
YY_RULE_SETUP


3591 
yylvÆ
.
°rög
 = 
yyãxt
;

3592  
	gWSCALE
;

3594 
YY_BREAK


3596 
YY_RULE_SETUP


3599 
yylvÆ
.
°rög
 = 
yyãxt
;

3600  
	gMTU_ERROR
;

3602 
YY_BREAK


3604 
YY_RULE_SETUP


3607 
BEGIN
(0);

3609 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

3610  
	gSTATEKEY
;

3612 
YY_BREAK


3614 
YY_RULE_SETUP


3617 
BEGIN
(0);

3619 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

3620  
	gSERVICENAME
;

3622 
YY_BREAK


3624 
YY_RULE_SETUP


3627 
yylvÆ
.
°rög
 = 
yyãxt
;

3628  
	gPROXYPROTOCOL_SOCKS_V4
;

3630 
YY_BREAK


3632 
YY_RULE_SETUP


3635 
yylvÆ
.
°rög
 = 
yyãxt
;

3636  
	gPROXYPROTOCOL_SOCKS_V5
;

3638 
YY_BREAK


3640 
YY_RULE_SETUP


3643 
yylvÆ
.
°rög
 = 
yyãxt
;

3644  
	gPROXYPROTOCOL_HTTP
;

3646 
YY_BREAK


3648 
YY_RULE_SETUP


3651 
yylvÆ
.
°rög
 = 
yyãxt
;

3652  
	gPROXYPROTOCOL_UPNP
;

3654 
YY_BREAK


3656 
YY_RULE_SETUP


3659 
yylvÆ
.
°rög
 = 
yyãxt
;

3660  
	gCOMMAND_BIND
;

3662 
YY_BREAK


3664 
YY_RULE_SETUP


3667 
yylvÆ
.
°rög
 = 
yyãxt
;

3668  
	gCOMMAND_CONNECT
;

3670 
YY_BREAK


3672 
YY_RULE_SETUP


3675 
yylvÆ
.
°rög
 = 
yyãxt
;

3676  
	gCOMMAND_UDPASSOCIATE
;

3678 
YY_BREAK


3680 
YY_RULE_SETUP


3683 
yylvÆ
.
°rög
 = 
yyãxt
;

3684  
	gCOMMAND_BINDREPLY
;

3686 
YY_BREAK


3688 
YY_RULE_SETUP


3691 
yylvÆ
.
°rög
 = 
yyãxt
;

3692  
	gCOMMAND_UDPREPLY
;

3694 
YY_BREAK


3696 
YY_RULE_SETUP


3699 
yylvÆ
.
°rög
 = 
yyãxt
;

3700  
	gURL
;

3702 
YY_BREAK


3704 
YY_RULE_SETUP


3707 
BEGIN
(
°¨t_p‹t
);

3709 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

3710  
	gDOMAINNAME
;

3712 
YY_BREAK


3714 *
yy_˝
 = 
yy_hﬁd_ch¨
;

3715 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 1;

3716 
	gYY_DO_BEFORE_ACTION
;

3717 
	gYY_RULE_SETUP


3725 
BEGIN
(
°¨t_p‹t
);

3727 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

3728  
	gIPVANY
;

3730 
YY_BREAK


3732 
YY_RULE_SETUP


3735 
sockaddr_°‹age
 
addr
, 
	gmask
;

3736 
ö6_addr
 
	gùv6
;

3737 
ö_addr
 
	gùv4
;

3738 
	gvisbuf
[256];

3740 
BEGIN
(
°¨t_p‹t
);

3742 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

3753 i‡(
socks_öë_±⁄
(
AF_INET
, 
yyãxt
, &
ùv4
, 
NULL
) == 1)

3754  
IPV4
;

3756 i‡(
socks_öë_±⁄
(
AF_INET6
, 
yyãxt
, &
ùv6
, 
NULL
) == 1) {

3757 i‡(
IN6_IS_ADDR_V4MAPPED
(&
ùv6
))

3758 
yyîr‹x
("we doÇot use IPv4-mapped IPv6áddresses. Please specify "

3761  
	gIPV6
;

3764 
	gî∫o
 = 0;

3765 i‡(
i‚ame2sockaddr
(
yyãxt
, 0, &
addr
, &
mask
Ë!
NULL
)

3766  
IFNAME
;

3768 i‡(
ERRNOISNOFILE
(
î∫o
))

3769 
yyîr‹
("no free filedescriptors: canÇotáccess information on "

3771 
°r2vis
(
yyãxt
, 
°æí
(yyãxt), 
visbuf
, (visbuf)));

3774 
¶og
(
LOG_DEBUG
,

3776 
yyãxt
);

3778  
	gDOMAINNAME
;

3780 
YY_BREAK


3782 
YY_RULE_SETUP


3785 
yylvÆ
.
°rög
 = 
yyãxt
;

3786  
	gPORT
;

3788 
YY_BREAK


3793 
YY_RULE_SETUP


3796 
BEGIN
(
°¨t_˝u›ti⁄
);

3798 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

3799  
	gCPU
;

3801 
YY_BREAK


3803 
YY_RULE_SETUP


3806 
BEGIN
(
°¨t_¥o˚s°y≥
);

3808 
	gismask
 = 0;

3810 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

3811  
	gSCHEDULE
;

3813 
YY_BREAK


3815 
YY_RULE_SETUP


3818 
BEGIN
(
°¨t_¥o˚s°y≥
);

3820 
	gismask
 = 1;

3822 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

3823  
	gMASK
;

3825 
YY_BREAK


3827 
YY_RULE_SETUP


3830 
BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

3832 
	gyylvÆ
.
	gnumbî
 = 
PROC_MOTHER
;

3833  
	gPROCESSTYPE
;

3835 
YY_BREAK


3837 
YY_RULE_SETUP


3840 
BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

3842 
	gyylvÆ
.
	gnumbî
 = 
PROC_MONITOR
;

3843  
	gPROCESSTYPE
;

3845 
YY_BREAK


3847 
YY_RULE_SETUP


3850 
BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

3852 
	gyylvÆ
.
	gnumbî
 = 
PROC_NEGOTIATE
;

3853  
	gPROCESSTYPE
;

3855 
YY_BREAK


3857 
YY_RULE_SETUP


3860 
BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

3862 
	gyylvÆ
.
	gnumbî
 = 
PROC_REQUEST
;

3863  
	gPROCESSTYPE
;

3865 
YY_BREAK


3867 
YY_RULE_SETUP


3870 
BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

3872 
	gyylvÆ
.
	gnumbî
 = 
PROC_IO
;

3873  
	gPROCESSTYPE
;

3875 
YY_BREAK


3877 
YY_RULE_SETUP


3880 
BEGIN
(0);

3882 
	gyylvÆ
.
	gnumbî
 = 
CPUMASK_ANYCPU
;

3883  
	gNUMBER
;

3885 
YY_BREAK


3887 
YY_RULE_SETUP


3890 #i‡
SOCKS_CLIENT


3891 
SERRX
(0);

3894 #i‡
HAVE_SCHED_SETAFFINITY


3896 
BEGIN
(0);

3898 i‡((
	gyylvÆ
.
	gnumbî
 = 
˝upﬁicy2numîic
(
yyãxt
)) == -1)

3899 
yyîr‹x
("unknow¿schedulögÖﬁicy \"%s\"", 
yyãxt
);

3901  
	gSCHEDULEPOLICY
;

3903 
yyîr‹x
("setting cpu schedulingÖolicy isÇot supported onÅhisÖlatform");

3908 
YY_BREAK


3913 
YY_RULE_SETUP


3916 
BEGIN
(
°¨t_sockë›ti⁄
);

3918 
	gyylvÆ
.
	gnumbî
 = 
IPPROTO_IP
;

3919  
	gSOCKETPROTOCOL
;

3921 
YY_BREAK


3923 
YY_RULE_SETUP


3926 
BEGIN
(
°¨t_sockë›ti⁄
);

3928 
	gyylvÆ
.
	gnumbî
 = 
SOL_SOCKET
;

3929  
	gSOCKETPROTOCOL
;

3931 
YY_BREAK


3933 
YY_RULE_SETUP


3936 
BEGIN
(
°¨t_sockë›ti⁄
);

3938 
	gyylvÆ
.
	gnumbî
 = 
IPPROTO_TCP
;

3939  
	gSOCKETPROTOCOL
;

3941 
YY_BREAK


3943 
YY_RULE_SETUP


3946 
BEGIN
(
°¨t_sockë›ti⁄
);

3948 
	gyylvÆ
.
	gnumbî
 = 
IPPROTO_UDP
;

3949  
	gSOCKETPROTOCOL
;

3951 
YY_BREAK


3953 
YY_RULE_SETUP


3956 c⁄° 
sock›t_t
 *
sock›t
;

3958 
BEGIN
(
°¨t_sockë›ti⁄vÆue
);

3960 i‡((
	gsock›t
 = 
›äame2sock›t
(
yyãxt
)Ë=
NULL
)

3961 
yyîr‹x
("unknow¿sockë o±i⁄ \"%s\"", 
yyãxt
);

3963 
	gyylvÆ
.
	gnumbî
 = (
ssize_t
)
sock›t
->
›tid
;

3964  
	gSOCKETOPTION_OPTID
;

3966 
YY_BREAK


3968 
YY_RULE_SETUP


3971 
BEGIN
(0);

3973 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

3974  
	gSOCKETOPTION_SYMBOLICVALUE
;

3976 
YY_BREAK


3978 
YY_RULE_SETUP


3981 
yylvÆ
.
°rög
 = 
yyãxt
;

3982  
	gRULE_LOG_CONNECT
;

3984 
YY_BREAK


3986 
YY_RULE_SETUP


3989 
yylvÆ
.
°rög
 = 
yyãxt
;

3990  
	gRULE_LOG_DATA
;

3992 
YY_BREAK


3994 
YY_RULE_SETUP


3997 
yylvÆ
.
°rög
 = 
yyãxt
;

3998  
	gRULE_LOG_DISCONNECT
;

4000 
YY_BREAK


4002 
YY_RULE_SETUP


4005 
yylvÆ
.
°rög
 = 
yyãxt
;

4006  
	gRULE_LOG_ERROR
;

4008 
YY_BREAK


4010 
YY_RULE_SETUP


4013 
yylvÆ
.
°rög
 = 
yyãxt
;

4014  
	gRULE_LOG_IOOPERATION
;

4016 
YY_BREAK


4018 
YY_RULE_SETUP


4021 
yylvÆ
.
°rög
 = 
yyãxt
;

4022  
	gRULE_LOG_TCPINFO
;

4024 
YY_BREAK


4026 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4027 
	gyy_c_buf_p
 = 
yy_˝
 -= 1;

4028 
	gYY_DO_BEFORE_ACTION
;

4029 
	gYY_RULE_SETUP


4032 c⁄° 
logÀvñ_t
 *
	gl
;

4033 
	gvisbuf
[256];

4035 
BEGIN
(
°¨t_logty≥
);

4037 i‡((
	gl
 = 
logÀvñ
(
yyãxt
)Ë=
NULL
)

4038 
yyîr‹
("unknownÜoglevel: \"%s\"",

4039 
°r2vis
(
yyãxt
, 
°æí
(yyãxt), 
visbuf
, (visbuf)));

4041 
	gyylvÆ
.
	gnumbî
 = 
l
->
vÆue
;

4042  
	gLOGLEVEL
;

4044 
YY_BREAK


4046 
YY_RULE_SETUP


4049 
BEGIN
(
°¨t_îr‹symbﬁ
);

4051 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4052  
	gLOGTYPE_ERROR
;

4054 
YY_BREAK


4056 
YY_RULE_SETUP


4059 
BEGIN
(
°¨t_t˝›ti⁄
);

4061 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4062  
	gLOGTYPE_TCP_DISABLED
;

4064 
YY_BREAK


4066 
YY_RULE_SETUP


4069 
BEGIN
(
°¨t_t˝›ti⁄
);

4071 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4072  
	gLOGTYPE_TCP_ENABLED
;

4074 
YY_BREAK


4076 
YY_RULE_SETUP


4079 #i‡!
SOCKS_CLIENT


4086 i‡((
yylvÆ
.
îr‹
.
vÆuev
 = 
gaivÆue
(
yyãxt
)Ë!
NULL
)

4087 
yylvÆ
.
îr‹
.
vÆuëy≥
 = 
VALUETYPE_GAIERR
;

4088 i‡((
	gyylvÆ
.
	gîr‹
.
	gvÆuev
 = 
î∫ovÆue
(
yyãxt
)Ë!
NULL
)

4089 
yylvÆ
.
îr‹
.
vÆuëy≥
 = 
VALUETYPE_ERRNO
;

4093 
	gyylvÆ
.
	gîr‹
.
	gvÆuev
 = 
NULL
;

4097  
	gERRORVALUE
;

4099 
YY_BREAK


4101 
YY_RULE_SETUP


4104 
yylvÆ
.
°rög
 = 
yyãxt
;

4105  
	gBSDAUTHSTYLENAME
;

4107 
YY_BREAK


4109 
YY_RULE_SETUP


4112 
yylvÆ
.
°rög
 = 
yyãxt
;

4113  
	gLOGFILE
;

4115 
YY_BREAK


4117 
YY_RULE_SETUP


4120 
yylvÆ
.
°rög
 = 
yyãxt
;

4121  
	gUSERNAME
;

4123 
YY_BREAK


4125 
YY_RULE_SETUP


4128 
yylvÆ
.
°rög
 = 
yyãxt
;

4129  
	gGROUPNAME
;

4131 
YY_BREAK


4133 
YY_RULE_SETUP


4136 
yylvÆ
.
°rög
 = 
yyãxt
;

4137  
	gLIBWRAP_FILE
;

4139 
YY_BREAK


4141 
YY_RULE_SETUP


4144 
yylvÆ
.
°rög
 = 
yyãxt
;

4145  
	gLDAP_DOMAIN
;

4147 
YY_BREAK


4149 
YY_RULE_SETUP


4152 
yylvÆ
.
°rög
 = 
yyãxt
;

4153  
	gLDAP_BASEDN
;

4155 
YY_BREAK


4157 
YY_RULE_SETUP


4160 
yylvÆ
.
°rög
 = 
yyãxt
;

4161  
	gLDAP_FILTER
;

4163 
YY_BREAK


4165 
YY_RULE_SETUP


4168 
yylvÆ
.
°rög
 = 
yyãxt
;

4169  
	gLDAP_URL
;

4171 
YY_BREAK


4173 
YY_RULE_SETUP


4176 
yylvÆ
.
°rög
 = 
yyãxt
;

4177  
	gLDAP_ATTRIBUTE
;

4179 
YY_BREAK


4181 
YY_RULE_SETUP


4184 
yylvÆ
.
°rög
 = 
yyãxt
;

4185  
	gLDAPGROUP_NAME
;

4187 
YY_BREAK


4189 
YY_RULE_SETUP


4192 
yylvÆ
.
°rög
 = 
yyãxt
;

4193  
	gLDAPSERVER_NAME
;

4195 
YY_BREAK


4197 
YY_RULE_SETUP


4200 
yylvÆ
.
°rög
 = 
yyãxt
;

4201  
	gLDAP_CERTFILE
;

4203 
YY_BREAK


4205 
YY_RULE_SETUP


4208 
yylvÆ
.
°rög
 = 
yyãxt
;

4209  
	gLDAP_CERTPATH
;

4211 
YY_BREAK


4213 
YY_RULE_SETUP


4216 
yylvÆ
.
°rög
 = 
yyãxt
;

4217  
	gLDAPKEYTABNAME
;

4219 
YY_BREAK


4221 
YY_RULE_SETUP


4224 
yylvÆ
.
°rög
 = 
yyãxt
;

4225  
	gLDAPKEYTABNAME
;

4227 
YY_BREAK


4229 
YY_RULE_SETUP


4232 
yylvÆ
.
°rög
 = 
yyãxt
;

4233  
	gGSSAPIKEYTABNAME
;

4235 
YY_BREAK


4237 
YY_RULE_SETUP


4240 
yylvÆ
.
°rög
 = 
yyãxt
;

4241  
	gGSSAPIKEYTABNAME
;

4243 
YY_BREAK


4245 
YY_RULE_SETUP


4248 
yylvÆ
.
°rög
 = 
yyãxt
;

4249  
	gGSSAPISERVICENAME
;

4251 
YY_BREAK


4253 
YY_RULE_SETUP


4256 
BEGIN
(
°¨t_löe
);

4258 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4259  *
	gyyãxt
;

4261 
YY_BREAK


4263 
YY_RULE_SETUP


4266 
BEGIN
(0);

4268 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4269  
	gLINE
;

4271 
YY_BREAK


4273 
YY_RULE_SETUP


4276 
yylvÆ
.
°rög
 = 
yyãxt
;

4277  
	gNODNSMISMATCH
;

4279 
YY_BREAK


4281 
YY_RULE_SETUP


4284 
yylvÆ
.
°rög
 = 
yyãxt
;

4285  
	gNODNSUNKNOWN
;

4287 
YY_BREAK


4289 
YY_RULE_SETUP


4292 
yylvÆ
.
°rög
 = 
yyãxt
;

4293  
	gCHECKREPLYAUTH
;

4295 
YY_BREAK


4297 
YY_RULE_SETUP


4300 
yylvÆ
.
°rög
 = 
yyãxt
;

4301  
	gPROTOCOL_TCP
;

4303 
YY_BREAK


4305 
YY_RULE_SETUP


4308 
yylvÆ
.
°rög
 = 
yyãxt
;

4309  
	gPROTOCOL_UDP
;

4311 
YY_BREAK


4313 
YY_RULE_SETUP


4316 
yylvÆ
.
°rög
 = 
yyãxt
;

4317  
	gPROTOCOL_FAKE
;

4319 
YY_BREAK


4321 
YY_RULE_SETUP


4324 
yylvÆ
.
°rög
 = 
yyãxt
;

4325  
	gGSSAPIENC_ANY
;

4327 
YY_BREAK


4329 
YY_RULE_SETUP


4332 
yylvÆ
.
°rög
 = 
yyãxt
;

4333  
	gGSSAPIENC_CLEAR
;

4335 
YY_BREAK


4337 
YY_RULE_SETUP


4340 
yylvÆ
.
°rög
 = 
yyãxt
;

4341  
	gGSSAPIENC_INTEGRITY
;

4343 
YY_BREAK


4345 
YY_RULE_SETUP


4348 
yylvÆ
.
°rög
 = 
yyãxt
;

4349  
	gGSSAPIENC_CONFIDENTIALITY
;

4351 
YY_BREAK


4353 
YY_RULE_SETUP


4356 
yylvÆ
.
°rög
 = 
yyãxt
;

4357  
	gGSSAPIENC_PERMESSAGE
;

4359 
YY_BREAK


4361 
YY_RULE_SETUP


4364 
yylvÆ
.
°rög
 = 
yyãxt
;

4365  
	gREALNAME
;

4367 
YY_BREAK


4369 
YY_RULE_SETUP


4372 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_NONE
;

4373  
	gMETHODNAME
;

4375 
YY_BREAK


4377 
YY_RULE_SETUP


4380 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_GSSAPI
;

4381  
	gMETHODNAME
;

4383 
YY_BREAK


4385 
YY_RULE_SETUP


4388 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_UNAME
;

4389  
	gMETHODNAME
;

4391 
YY_BREAK


4393 
YY_RULE_SETUP


4396 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_RFC931
;

4397  
	gMETHODNAME
;

4399 
YY_BREAK


4401 
YY_RULE_SETUP


4404 
yylvÆ
.
numbî
 = 
AUTHMETHOD_PAM_ANY
;

4405  
	gMETHODNAME
;

4407 
YY_BREAK


4409 
YY_RULE_SETUP


4412 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_PAM_ADDRESS
;

4413  
	gMETHODNAME
;

4415 
YY_BREAK


4417 
YY_RULE_SETUP


4420 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_PAM_USERNAME
;

4421  
	gMETHODNAME
;

4423 
YY_BREAK


4425 
YY_RULE_SETUP


4428 
yyw¨nx_dïªˇãd
(
yyãxt
, "pam.*");

4430 
	gyylvÆ
.
	gmëhod
 = 
AUTHMETHOD_PAM_USERNAME
;

4431  
	gMETHODNAME
;

4433 
YY_BREAK


4435 
YY_RULE_SETUP


4438 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_BSDAUTH
;

4439  
	gMETHODNAME
;

4441 
YY_BREAK


4444 
YY_RULE_SETUP


4447 
BEGIN
(
°¨t_£rvi˚«me
);

4449 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4450  
	gOPERATOR
;

4452 
YY_BREAK


4454 
YY_RULE_SETUP


4457 
ö˛õ¡ruÀ
 = 1;

4459 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4460  
	gCLIENTRULE
;

4462 
YY_BREAK


4464 
YY_RULE_SETUP


4467 
yylvÆ
.
°rög
 = 
yyãxt
;

4468  
	gHOSTIDRULE
;

4470 
YY_BREAK


4472 
YY_RULE_SETUP


4475 
yylvÆ
.
°rög
 = 
yyãxt
;

4476  
	gSOCKSRULE
;

4478 
YY_BREAK


4480 
YY_RULE_SETUP


4483 #i‡
SOCKS_CLIENT


4485 
yyîr‹x
("pass/blockÑulesáreÇot used inÅhe client");

4488 
	gﬁd
[256], 
	g√w
[256];

4490 
¢¥ötf
(
ﬁd
, (ﬁd), "%s", 
yyãxt
);

4491 
STRIPTRAILING
(
ﬁd
, 
°æí
(old), " \t");

4493 
¢¥ötf
(
√w
, “ew), "sock†%s", 
ﬁd
);

4495 
yyw¨nx_dïªˇãd
(
ﬁd
, 
√w
);

4497 
yyÀss
(0);

4499  
	gSOCKSRULE
;

4503 
YY_BREAK


4505 
YY_RULE_SETUP


4508 
yylvÆ
.
°rög
 = 
yyãxt
;

4509  
	gALARMTYPE_DATA
;

4511 
YY_BREAK


4513 
YY_RULE_SETUP


4516 
yylvÆ
.
°rög
 = 
yyãxt
;

4517  
	gALARMTYPE_DISCONNECT
;

4519 
YY_BREAK


4521 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4522 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 5;

4523 
	gYY_DO_BEFORE_ACTION
;

4524 
	gYY_RULE_SETUP


4527 
BEGIN
(
°¨t_Æ¨mã°
);

4529 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4530  
	gALARM
;

4532 
YY_BREAK


4534 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4535 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 5;

4536 
	gYY_DO_BEFORE_ACTION
;

4537 
	gYY_RULE_SETUP


4540 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4541  
	gRECVSIDE
;

4543 
YY_BREAK


4545 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4546 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 5;

4547 
	gYY_DO_BEFORE_ACTION
;

4548 
	gYY_RULE_SETUP


4551 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4552  
	gSENDSIDE
;

4554 
YY_BREAK


4556 
YY_RULE_SETUP


4559 
yylvÆ
.
°rög
 = 
yyãxt
;

4560  
	gDEBUGGING
;

4562 
YY_BREAK


4564 
YY_RULE_SETUP


4567 
örouã
 = 1;

4569 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4570  
	gROUTE
;

4572 
YY_BREAK


4574 
YY_RULE_SETUP


4577 
yylvÆ
.
°rög
 = 
yyãxt
;

4578  
	gROUTE
;

4580 
YY_BREAK


4582 
YY_RULE_SETUP


4585 
yylvÆ
.
°rög
 = 
yyãxt
;

4586  
	gGLOBALROUTEOPTION
;

4588 
YY_BREAK


4590 
YY_RULE_SETUP


4593 
yylvÆ
.
°rög
 = 
yyãxt
;

4594  
	gMAXFAIL
;

4596 
YY_BREAK


4598 
YY_RULE_SETUP


4601 
yylvÆ
.
°rög
 = 
yyãxt
;

4602  
	gBADROUTE_EXPIRE
;

4604 
YY_BREAK


4606 
YY_RULE_SETUP


4609 
BEGIN
(
°¨t_¥Ÿocﬁ
);

4611 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4612  
	gRESOLVEPROTOCOL
;

4614 
YY_BREAK


4616 
YY_RULE_SETUP


4619 
BEGIN
(
°¨t_§cho°
);

4621 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4622  
	gSRCHOST
;

4624 
YY_BREAK


4626 
YY_RULE_SETUP


4629 
BEGIN
(
°¨t_¥oxy¥Ÿocﬁ
);

4631 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4632  
	gPROXYPROTOCOL
;

4634 
YY_BREAK


4636 
YY_RULE_SETUP


4639 
BEGIN
(
°¨t_logouçut
);

4641 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4642  
	gERRORLOG
;

4644 
YY_BREAK


4646 
YY_RULE_SETUP


4649 
BEGIN
(
°¨t_logouçut
);

4651 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4652  
	gLOGOUTPUT
;

4654 
YY_BREAK


4656 
YY_RULE_SETUP


4659 
BEGIN
(
°¨t_¥Ÿocﬁ
);

4661 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4662  
	gPROTOCOL
;

4664 
YY_BREAK


4666 
YY_RULE_SETUP


4669 
BEGIN
(
°¨t_comm™d
);

4671 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4672  
	gCOMMAND
;

4674 
YY_BREAK


4676 
YY_RULE_SETUP


4679 
yylvÆ
.
°rög
 = 
yyãxt
;

4680  
	gUDPPORTRANGE
;

4682 
YY_BREAK


4684 
YY_RULE_SETUP


4687 
yylvÆ
.
°rög
 = 
yyãxt
;

4688  
	gUDPCONNECTDST
;

4690 
YY_BREAK


4692 
YY_RULE_SETUP


4695 
yylvÆ
.
°rög
 = 
yyãxt
;

4696  
	gREDIRECT
;

4698 
YY_BREAK


4700 
YY_RULE_SETUP


4703 
yylvÆ
.
°rög
 = 
yyãxt
;

4704  
	gBANDWIDTH
;

4706 
YY_BREAK


4708 
YY_RULE_SETUP


4711 
yylvÆ
.
°rög
 = 
yyãxt
;

4712  
	gSESSIONMAX
;

4714 
YY_BREAK


4716 
YY_RULE_SETUP


4719 
yylvÆ
.
°rög
 = 
yyãxt
;

4720  
	gSESSION_INHERITABLE
;

4722 
YY_BREAK


4724 
YY_RULE_SETUP


4727 
yylvÆ
.
°rög
 = 
yyãxt
;

4728  
	gSESSIONTHROTTLE
;

4730 
YY_BREAK


4732 
YY_RULE_SETUP


4735 
BEGIN
(
°¨t_°©ekey
);

4737 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4738  
	gSESSIONSTATE_KEY
;

4740 
YY_BREAK


4742 
YY_RULE_SETUP


4745 
yylvÆ
.
°rög
 = 
yyãxt
;

4746  
	gSESSIONSTATE_THROTTLE
;

4748 
YY_BREAK


4750 
YY_RULE_SETUP


4753 
yylvÆ
.
°rög
 = 
yyãxt
;

4754  
	gSESSIONSTATE_MAX
;

4756 
YY_BREAK


4758 
YY_RULE_SETUP


4761 
yylvÆ
.
°rög
 = 
yyãxt
;

4762  
	gWORD__IN
;

4764 
YY_BREAK


4766 
YY_RULE_SETUP


4769 
BEGIN
(
°¨t_addªss
);

4771 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4772  
	gFROM
;

4774 
YY_BREAK


4776 
YY_RULE_SETUP


4779 
BEGIN
(
°¨t_addªss
);

4781 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4782  
	gTO
;

4784 
YY_BREAK


4786 
YY_RULE_SETUP


4789 
BEGIN
(
°¨t_addªss
);

4791 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4792  
	gVIA
;

4794 
YY_BREAK


4796 
YY_RULE_SETUP


4799 
yylvÆ
.
°rög
 = 
yyãxt
;

4800  
	gYES
;

4802 
YY_BREAK


4804 
YY_RULE_SETUP


4807 
yylvÆ
.
°rög
 = 
yyãxt
;

4808  
	gNO
;

4810 
YY_BREAK


4812 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4813 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 9;

4814 
	gYY_DO_BEFORE_ACTION
;

4815 
	gYY_RULE_SETUP


4818 
BEGIN
(
°¨t_sockë¥Ÿocﬁ
);

4820 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4821  
	gINTERNALSOCKET
;

4823 
YY_BREAK


4825 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4826 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 9;

4827 
	gYY_DO_BEFORE_ACTION
;

4828 
	gYY_RULE_SETUP


4831 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4832  
	gALARMIF_INTERNAL
;

4834 
YY_BREAK


4836 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4837 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 12;

4838 
	gYY_DO_BEFORE_ACTION
;

4839 
	gYY_RULE_SETUP


4842 
BEGIN
(
°¨t_logÀvñ
);

4844 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4845  
	gLOGIF_INTERNAL
;

4847 
YY_BREAK


4849 
YY_RULE_SETUP


4852 
BEGIN
(
°¨t_¥Ÿocﬁ
);

4854 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4855  
	gINTERNAL_PROTOCOL
;

4857 
YY_BREAK


4859 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4860 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 8;

4861 
	gYY_DO_BEFORE_ACTION
;

4862 
	gYY_RULE_SETUP


4865 
BEGIN
(
°¨t_addªss
);

4867 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4868  
	gINTERNAL
;

4870 
YY_BREAK


4872 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4873 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 9;

4874 
	gYY_DO_BEFORE_ACTION
;

4875 
	gYY_RULE_SETUP


4878 
BEGIN
(
°¨t_sockë¥Ÿocﬁ
);

4880 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4881  
	gEXTERNALSOCKET
;

4883 
YY_BREAK


4885 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4886 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 9;

4887 
	gYY_DO_BEFORE_ACTION
;

4888 
	gYY_RULE_SETUP


4891 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4892  
	gALARMIF_EXTERNAL
;

4894 
YY_BREAK


4896 
YY_RULE_SETUP


4899 
BEGIN
(
°¨t_¥Ÿocﬁ
);

4901 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4902  
	gEXTERNAL_PROTOCOL
;

4904 
YY_BREAK


4906 
YY_RULE_SETUP


4909 
yylvÆ
.
°rög
 = 
yyãxt
;

4910  
	gEXTERNAL_ROTATION
;

4912 
YY_BREAK


4914 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4915 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 12;

4916 
	gYY_DO_BEFORE_ACTION
;

4917 
	gYY_RULE_SETUP


4920 
BEGIN
(
°¨t_logÀvñ
);

4922 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4923  
	gLOGIF_EXTERNAL
;

4925 
YY_BREAK


4927 *
yy_˝
 = 
yy_hﬁd_ch¨
;

4928 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 8;

4929 
	gYY_DO_BEFORE_ACTION
;

4930 
	gYY_RULE_SETUP


4933 
BEGIN
(
°¨t_addªss
);

4935 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4936  
	gEXTERNAL
;

4938 
YY_BREAK


4940 
YY_RULE_SETUP


4943 
yylvÆ
.
°rög
 = 
yyãxt
;

4944  
	gNONE
;

4946 
YY_BREAK


4948 
YY_RULE_SETUP


4951 
yylvÆ
.
°rög
 = 
yyãxt
;

4952  
	gSAMESAME
;

4954 
YY_BREAK


4956 
YY_RULE_SETUP


4959 
yyw¨nx_dïªˇãd
(
yyãxt
, 
NULL
);

4961 
YY_BREAK


4963 
YY_RULE_SETUP


4966 
yylvÆ
.
°rög
 = 
yyãxt
;

4967  
	gPROC_MAXREQUESTS
;

4969 
YY_BREAK


4971 
YY_RULE_SETUP


4974 
BEGIN
(
°¨t_u£∫ame
);

4976 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4977  
	gUSER
;

4979 
YY_BREAK


4981 
YY_RULE_SETUP


4984 
BEGIN
(
°¨t_grou≤ame
);

4986 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4987  
	gGROUP
;

4989 
YY_BREAK


4991 
YY_RULE_SETUP


4994 
BEGIN
(
°¨t_u£∫ame
);

4996 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

4997  
	gUSER_PRIVILEGED
;

4999 
YY_BREAK


5001 
YY_RULE_SETUP


5004 
BEGIN
(
°¨t_u£∫ame
);

5006 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5007  
	gUSER_UNPRIVILEGED
;

5009 
YY_BREAK


5011 
YY_RULE_SETUP


5014 
BEGIN
(
°¨t_u£∫ame
);

5016 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5017  
	gUSER_LIBWRAP
;

5019 
YY_BREAK


5021 
YY_RULE_SETUP


5024 
yylvÆ
.
°rög
 = 
yyãxt
;

5025  
	gCONNECTTIMEOUT
;

5027 
YY_BREAK


5029 
YY_RULE_SETUP


5032 
yylvÆ
.
°rög
 = 
yyãxt
;

5033  
	gTCP_FIN_WAIT
;

5035 
YY_BREAK


5037 
YY_RULE_SETUP


5040 
yylvÆ
.
°rög
 = 
yyãxt
;

5041  
	gIOTIMEOUT
;

5043 
YY_BREAK


5045 
YY_RULE_SETUP


5048 
yylvÆ
.
°rög
 = 
yyãxt
;

5049  
	gIOTIMEOUT_TCP
;

5051 
YY_BREAK


5053 
YY_RULE_SETUP


5056 
yylvÆ
.
°rög
 = 
yyãxt
;

5057  
	gIOTIMEOUT_UDP
;

5059 
YY_BREAK


5061 
YY_RULE_SETUP


5064 
yylvÆ
.
°rög
 = 
yyãxt
;

5065  
	gNEGOTIATETIMEOUT
;

5067 
YY_BREAK


5069 
YY_RULE_SETUP


5072 
yylvÆ
.
°rög
 = 
yyãxt
;

5073  
	gCOMPATIBILITY
;

5075 
YY_BREAK


5077 
YY_RULE_SETUP


5080 
yylvÆ
.
°rög
 = 
yyãxt
;

5081  
	gSAMEPORT
;

5083 
YY_BREAK


5085 
YY_RULE_SETUP


5088 
yylvÆ
.
°rög
 = 
yyãxt
;

5089  
	gDRAFT_5_05
;

5091 
YY_BREAK


5093 
YY_RULE_SETUP


5096 
yylvÆ
.
°rög
 = 
yyãxt
;

5097  
	gCLIENTCOMPATIBILITY
;

5099 
YY_BREAK


5101 
YY_RULE_SETUP


5104 
yylvÆ
.
°rög
 = 
yyãxt
;

5105  
	gNECGSSAPI
;

5107 
YY_BREAK


5109 
YY_RULE_SETUP


5112 
yylvÆ
.
°rög
 = 
yyãxt
;

5113  
	gEXTENSION
;

5115 
YY_BREAK


5117 
YY_RULE_SETUP


5120 
yylvÆ
.
°rög
 = 
yyãxt
;

5121  
	gBIND
;

5123 
YY_BREAK


5125 
YY_RULE_SETUP


5128 
BEGIN
(
°¨t_addªss
);

5130 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5131  
	gHOSTID
;

5133 
YY_BREAK


5135 
YY_RULE_SETUP


5138 
yylvÆ
.
°rög
 = 
yyãxt
;

5139  
	gMONITOR
;

5141 
YY_BREAK


5143 
YY_RULE_SETUP


5146 
BEGIN
(
°¨t_ho°ödex
);

5148 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5149  
	gHOSTINDEX
;

5151 
YY_BREAK


5153 
YY_RULE_SETUP


5156 
BEGIN
(0);

5158 
	gyylvÆ
.
	gnumbî
 = 0;

5159  
	gNUMBER
;

5161 
YY_BREAK


5163 
YY_RULE_SETUP


5166 
BEGIN
(
°¨t_mëhod
);

5168 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5169  
	gSOCKSMETHOD
;

5171 
YY_BREAK


5173 
YY_RULE_SETUP


5176 
BEGIN
(
°¨t_mëhod
);

5178 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5179  
	gCLIENTMETHOD
;

5181 
YY_BREAK


5183 
YY_RULE_SETUP


5186 
BEGIN
(
°¨t_mëhod
);

5188 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5190 i‡(
	görouã
)

5191  
	gMETHOD
;

5192 i‡(
	gö˛õ¡ruÀ
) {

5193 
yyw¨nx_dïªˇãd
(
yyãxt
, "clientmethod");

5194  
	gCLIENTMETHOD
;

5197 
yyw¨nx_dïªˇãd
(
yyãxt
, "socksmethod");

5199  
	gSOCKSMETHOD
;

5201 
YY_BREAK


5207 
YY_RULE_SETUP


5210 
yylvÆ
.
°rög
 = 
yyãxt
;

5211  
	gVERDICT_BLOCK
;

5213 
YY_BREAK


5215 
YY_RULE_SETUP


5218 
yylvÆ
.
°rög
 = 
yyãxt
;

5219  
	gVERDICT_PASS
;

5221 
YY_BREAK


5223 *
yy_˝
 = 
yy_hﬁd_ch¨
;

5224 
	gyy_c_buf_p
 = 
yy_˝
 = 
yy_bp
 + 3;

5225 
	gYY_DO_BEFORE_ACTION
;

5226 
	gYY_RULE_SETUP


5229 
BEGIN
(
°¨t_log
);

5231 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5232  
	gRULE_LOG
;

5234 
YY_BREAK


5236 
YY_RULE_SETUP


5239 
BEGIN
(
löïªfix
);

5241 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5242  
	gLIBWRAPSTART
;

5244 
YY_BREAK


5246 
YY_RULE_SETUP


5249 
BEGIN
(
°¨t_libwøpfûe
);

5251 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5252  
	gLIBWRAP_ALLOW
;

5254 
YY_BREAK


5256 
YY_RULE_SETUP


5259 
BEGIN
(
°¨t_libwøpfûe
);

5261 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5262  
	gLIBWRAP_DENY
;

5264 
YY_BREAK


5266 
YY_RULE_SETUP


5269 
yylvÆ
.
°rög
 = 
yyãxt
;

5270  
	gLIBWRAP_HOSTS_ACCESS
;

5272 
YY_BREAK


5274 
YY_RULE_SETUP


5277 
BEGIN
(
°¨t_£rvi˚«me
);

5279 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5280  
	gPAMSERVICENAME
;

5282 
YY_BREAK


5284 
YY_RULE_SETUP


5287 
BEGIN
(
°¨t_bsdauth°yÀ«me
);

5289 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5290  
	gBSDAUTHSTYLE
;

5292 
YY_BREAK


5294 
YY_RULE_SETUP


5297 
BEGIN
(
°¨t_gsßpi£rvi˚«me
);

5299 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5300  
	gGSSAPISERVICE
;

5302 
YY_BREAK


5304 
YY_RULE_SETUP


5307 
BEGIN
(
°¨t_gsßpikeyèb«me
);

5309 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5310  
	gGSSAPIKEYTAB
;

5312 
YY_BREAK


5314 
YY_RULE_SETUP


5317 
BEGIN
(
°¨t_í¸y±i⁄
);

5319 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5320  
	gGSSAPIENCTYPE
;

5322 
YY_BREAK


5324 
YY_RULE_SETUP


5327 
BEGIN
(
°¨t_ld≠ba£dn
);

5329 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5330  
	gLDAPBASEDN
;

5332 
YY_BREAK


5334 
YY_RULE_SETUP


5337 
BEGIN
(
°¨t_ld≠ba£dn
);

5339 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5340  
	gLDAPBASEDN_HEX
;

5342 
YY_BREAK


5344 
YY_RULE_SETUP


5347 
BEGIN
(
°¨t_ld≠ba£dn
);

5349 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5350  
	gLDAPBASEDN_HEX_ALL
;

5352 
YY_BREAK


5354 
YY_RULE_SETUP


5357 
yylvÆ
.
°rög
 = 
yyãxt
;

5358  
	gLDAPPORT
;

5360 
YY_BREAK


5362 
YY_RULE_SETUP


5365 
yylvÆ
.
°rög
 = 
yyãxt
;

5366  
	gLDAPPORTSSL
;

5368 
YY_BREAK


5370 
YY_RULE_SETUP


5373 
BEGIN
(
°¨t_ld≠uæ
);

5375 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5376  
	gLDAPURL
;

5378 
YY_BREAK


5380 
YY_RULE_SETUP


5383 
BEGIN
(
°¨t_ld≠˚πfûe
);

5385 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5386  
	gLDAPCERTFILE
;

5388 
YY_BREAK


5390 
YY_RULE_SETUP


5393 
BEGIN
(
°¨t_ld≠˚π∑th
);

5395 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5396  
	gLDAPCERTPATH
;

5398 
YY_BREAK


5400 
YY_RULE_SETUP


5403 
BEGIN
(
°¨t_ld≠domaö
);

5405 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5406  
	gLDAPDOMAIN
;

5408 
YY_BREAK


5410 
YY_RULE_SETUP


5413 
yylvÆ
.
°rög
 = 
yyãxt
;

5414  
	gLDAPDEBUG
;

5416 
YY_BREAK


5418 
YY_RULE_SETUP


5421 
yylvÆ
.
°rög
 = 
yyãxt
;

5422  
	gLDAPDEPTH
;

5424 
YY_BREAK


5426 
YY_RULE_SETUP


5429 
yylvÆ
.
°rög
 = 
yyãxt
;

5430  
	gLDAPSSL
;

5432 
YY_BREAK


5434 
YY_RULE_SETUP


5437 
yylvÆ
.
°rög
 = 
yyãxt
;

5438  
	gLDAPAUTO
;

5440 
YY_BREAK


5442 
YY_RULE_SETUP


5445 
yylvÆ
.
°rög
 = 
yyãxt
;

5446  
	gLDAPCERTCHECK
;

5448 
YY_BREAK


5450 
YY_RULE_SETUP


5453 
yylvÆ
.
°rög
 = 
yyãxt
;

5454  
	gLDAPKEEPREALM
;

5456 
YY_BREAK


5458 
YY_RULE_SETUP


5461 
BEGIN
(
°¨t_ld≠fûãr
);

5463 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5464  
	gLDAPFILTER
;

5466 
YY_BREAK


5468 
YY_RULE_SETUP


5471 
BEGIN
(
°¨t_ld≠fûãr
);

5473 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5474  
	gLDAPFILTER_AD
;

5476 
YY_BREAK


5478 
YY_RULE_SETUP


5481 
BEGIN
(
°¨t_ld≠fûãr
);

5483 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5484  
	gLDAPFILTER_HEX
;

5486 
YY_BREAK


5488 
YY_RULE_SETUP


5491 
BEGIN
(
°¨t_ld≠fûãr
);

5493 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5494  
	gLDAPFILTER_AD_HEX
;

5496 
YY_BREAK


5498 
YY_RULE_SETUP


5501 
BEGIN
(
°¨t_ld≠©åibuã
);

5503 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5504  
	gLDAPATTRIBUTE
;

5506 
YY_BREAK


5508 
YY_RULE_SETUP


5511 
BEGIN
(
°¨t_ld≠©åibuã
);

5513 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5514  
	gLDAPATTRIBUTE_AD
;

5516 
YY_BREAK


5518 
YY_RULE_SETUP


5521 
BEGIN
(
°¨t_ld≠©åibuã
);

5523 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5524  
	gLDAPATTRIBUTE_HEX
;

5526 
YY_BREAK


5528 
YY_RULE_SETUP


5531 
BEGIN
(
°¨t_ld≠©åibuã
);

5533 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5534  
	gLDAPATTRIBUTE_AD_HEX
;

5536 
YY_BREAK


5538 
YY_RULE_SETUP


5541 
BEGIN
(
°¨t_ld≠£rvî«me
);

5543 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5544  
	gLDAPSERVER
;

5546 
YY_BREAK


5548 
YY_RULE_SETUP


5551 
BEGIN
(
°¨t_ld≠grou≤ame
);

5553 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5554  
	gLDAPGROUP
;

5556 
YY_BREAK


5558 
YY_RULE_SETUP


5561 
BEGIN
(
°¨t_ld≠grou≤ame
);

5563 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5564  
	gLDAPGROUP_HEX
;

5566 
YY_BREAK


5568 
YY_RULE_SETUP


5571 
BEGIN
(
°¨t_ld≠grou≤ame
);

5573 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5574  
	gLDAPGROUP_HEX_ALL
;

5576 
YY_BREAK


5578 
YY_RULE_SETUP


5581 
BEGIN
(
°¨t_ld≠keyèb«me
);

5583 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5584  
	gLDAPKEYTAB
;

5586 
YY_BREAK


5588 
YY_RULE_SETUP


5591 
yylvÆ
.
°rög
 = 
yyãxt
;

5592  
	gBOUNCE
;

5594 
YY_BREAK


5596 
YY_RULE_SETUP


5599 
BEGIN
(
°¨t_ªÆm«me
);

5601 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5602  
	gREALM
;

5604 
YY_BREAK


5609 
YY_RULE_SETUP


5612 
yyw¨nx_dïªˇãd
(
yyãxt
, 
NULL
);

5614 
YY_BREAK


5616 
YY_RULE_SETUP


5619 
yyw¨nx_dïªˇãd
(
yyãxt
, "timeout.connect");

5621 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5622  
	gCONNECTTIMEOUT
;

5624 
YY_BREAK


5626 
YY_RULE_SETUP


5629 
yyw¨nx_dïªˇãd
(
yyãxt
, "timeout.io");

5631 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5632  
	gIOTIMEOUT
;

5634 
YY_BREAK


5636 
YY_RULE_SETUP


5639 
yylvÆ
.
dïªˇãd
.
ﬁd«me
 = 
yyãxt
;

5641 
	gyylvÆ
.
	gdïªˇãd
.
	g√w«me
 =

5647  
	gDEPRECATED
;

5649 
YY_BREAK


5656 
YY_RULE_SETUP


5659 *
ï
;

5660 
	gŒvÆ
;

5662 
	gî∫o
 = 0;

5663 
	gŒvÆ
 = 
°πﬁl
(
yyãxt
, &
ï
, 0);

5664 i‡(*
	gyyãxt
 =
NUL
 || *
ï
 != NUL)

5665 
yyîr‹
("confusing. Thought we would haveáÇumber here");

5667 i‡(
	gî∫o
 =
ERANGE
)

5668 
yyîr‹
("number given is out ofÑange");

5670 
	gyylvÆ
.
	gnumbî
 = 
ŒvÆ
;

5672 i‡(
shouldª£t°©e
(
YYSTATE
, 
NUMBER
))

5673 
BEGIN
(0);

5675  
	gNUMBER
;

5677 
YY_BREAK


5680 
YY_RULE_SETUP


5685 
YY_BREAK


5688 
YY_RULE_SETUP


5691 
BEGIN
(0);

5694 
YY_BREAK


5697 
YY_RULE_SETUP


5700 
BEGIN
(0);

5702 
YY_BREAK


5705 
YY_RULE_SETUP


5710 
YY_BREAK


5712 
YY_RULE_SETUP


5715 
ö˛õ¡ruÀ
 = 
örouã
 = 0;

5717 
	gyylvÆ
.
	g°rög
 = 
yyãxt
;

5718  *
	gyyãxt
;

5720 
YY_BREAK


5722 
YY_RULE_SETUP


5725 
yylvÆ
.
°rög
 = 
yyãxt
;

5726  *
	gyyãxt
;

5728 
YY_BREAK


5730 
YY_RULE_SETUP


5732 
ECHO
;

5733 
	gYY_BREAK


5735 
YY_STATE_EOF
(
INITIAL
):

5736 
YY_STATE_EOF
(
°¨t_addªss
):

5737 
YY_STATE_EOF
(
°¨t_p‹t
):

5738 
YY_STATE_EOF
(
löïªfix
):

5739 
YY_STATE_EOF
(
°¨t_comm™d
):

5740 
YY_STATE_EOF
(
°¨t_com∑tibûôy
):

5741 
YY_STATE_EOF
(
°¨t_löe
):

5742 
YY_STATE_EOF
(
°¨t_log
):

5743 
YY_STATE_EOF
(
°¨t_logÀvñ
):

5744 
YY_STATE_EOF
(
°¨t_logouçut
):

5745 
YY_STATE_EOF
(
°¨t_logty≥
):

5746 
YY_STATE_EOF
(
°¨t_îr‹symbﬁ
):

5747 
YY_STATE_EOF
(
°¨t_mëhod
):

5748 
YY_STATE_EOF
(
°¨t_›ti⁄
):

5749 
YY_STATE_EOF
(
°¨t_¥oxy¥Ÿocﬁ
):

5750 
YY_STATE_EOF
(
°¨t_u£∫ame
):

5751 
YY_STATE_EOF
(
°¨t_grou≤ame
):

5752 
YY_STATE_EOF
(
°¨t_libwøpfûe
):

5753 
YY_STATE_EOF
(
°¨t_˝u›ti⁄
):

5754 
YY_STATE_EOF
(
°¨t_ho°ödex
):

5755 
YY_STATE_EOF
(
°¨t_°©ekey
):

5756 
YY_STATE_EOF
(
°¨t_t˝›ti⁄
):

5757 
YY_STATE_EOF
(
°¨t_ld≠domaö
):

5758 
YY_STATE_EOF
(
°¨t_ld≠ba£dn
):

5759 
YY_STATE_EOF
(
°¨t_ld≠uæ
):

5760 
YY_STATE_EOF
(
°¨t_ld≠fûãr
):

5761 
YY_STATE_EOF
(
°¨t_ld≠©åibuã
):

5762 
YY_STATE_EOF
(
°¨t_ld≠£rvî«me
):

5763 
YY_STATE_EOF
(
°¨t_ld≠grou≤ame
):

5764 
YY_STATE_EOF
(
°¨t_ld≠keyèb«me
):

5765 
YY_STATE_EOF
(
°¨t_ld≠˚πfûe
):

5766 
YY_STATE_EOF
(
°¨t_ld≠˚π∑th
):

5767 
YY_STATE_EOF
(
°¨t_Æ¨mã°
):

5768 
YY_STATE_EOF
(
°¨t_§cho°
):

5769 
YY_STATE_EOF
(
°¨t_¥Ÿocﬁ
):

5770 
YY_STATE_EOF
(
°¨t_£rvi˚«me
):

5771 
YY_STATE_EOF
(
°¨t_p‹äumbî
):

5772 
YY_STATE_EOF
(
°¨t_bsdauth°yÀ«me
):

5773 
YY_STATE_EOF
(
°¨t_gsßpi£rvi˚«me
):

5774 
YY_STATE_EOF
(
°¨t_gsßpikeyèb«me
):

5775 
YY_STATE_EOF
(
°¨t_í¸y±i⁄
):

5776 
YY_STATE_EOF
(
°¨t_ªÆm«me
):

5777 
YY_STATE_EOF
(
°¨t_sockë¥Ÿocﬁ
):

5778 
YY_STATE_EOF
(
°¨t_sockë›ti⁄
):

5779 
YY_STATE_EOF
(
°¨t_sockë›ti⁄vÆue
):

5780 
YY_STATE_EOF
(
°¨t_¥o˚s°y≥
):

5781 
YY_STATE_EOF
(
°¨t_scheduÀpﬁicy
):

5782 
YY_STATE_EOF
(
°¨t_scheduÀmask
):

5783 
yyãrmö©e
();

5785 
	gYY_END_OF_BUFFER
:

5788 
yy_amou¡_of_m©ched_ãxt
 = (Ë(
yy_˝
 - 
yyãxt_±r
) - 1;

5791 *
	gyy_˝
 = 
yy_hﬁd_ch¨
;

5792 
YY_RESTORE_YY_MORE_OFFSET


5794 i‡–
	gyy_cuºít_buf„r
->
	gyy_buf„r_°©us
 =
YY_BUFFER_NEW
 )

5805 
yy_n_ch¨s
 = 
yy_cuºít_buf„r
->yy_n_chars;

5806 
	gyy_cuºít_buf„r
->
	gyy_öput_fûe
 = 
yyö
;

5807 
	gyy_cuºít_buf„r
->
	gyy_buf„r_°©us
 = 
YY_BUFFER_NORMAL
;

5817 i‡–
	gyy_c_buf_p
 <&
yy_cuºít_buf„r
->
yy_ch_buf
[
yy_n_ch¨s
] )

5819 
yy_°©e_ty≥
 
yy_√xt_°©e
;

5821 
	gyy_c_buf_p
 = 
yyãxt_±r
 + 
yy_amou¡_of_m©ched_ãxt
;

5823 
	gyy_cuºít_°©e
 = 
yy_gë_¥evious_°©e
();

5834 
	gyy_√xt_°©e
 = 
yy_åy_NUL_å™s
–
yy_cuºít_°©e
 );

5836 
	gyy_bp
 = 
yyãxt_±r
 + 
YY_MORE_ADJ
;

5838 i‡–
	gyy_√xt_°©e
 )

5841 
	gyy_˝
 = ++
yy_c_buf_p
;

5842 
	gyy_cuºít_°©e
 = 
yy_√xt_°©e
;

5843 
	gyy_m©ch
;

5848 
	gyy_˝
 = 
yy_c_buf_p
;

5849 
	gyy_föd_a˘i⁄
;

5853  
yy_gë_√xt_buf„r
() )

5855 
	gEOB_ACT_END_OF_FILE
:

5857 
yy_did_buf„r_swôch_⁄_eof
 = 0;

5859 i‡–
yywøp
() )

5870 
	gyy_c_buf_p
 = 
yyãxt_±r
 + 
YY_MORE_ADJ
;

5872 
	gyy_a˘
 = 
YY_STATE_EOF
(
YY_START
);

5873 
	gdo_a˘i⁄
;

5878 i‡–! 
	gyy_did_buf„r_swôch_⁄_eof
 )

5879 
	gYY_NEW_FILE
;

5884 
	gEOB_ACT_CONTINUE_SCAN
:

5885 
yy_c_buf_p
 =

5886 
yyãxt_±r
 + 
yy_amou¡_of_m©ched_ãxt
;

5888 
	gyy_cuºít_°©e
 = 
yy_gë_¥evious_°©e
();

5890 
	gyy_˝
 = 
yy_c_buf_p
;

5891 
	gyy_bp
 = 
yyãxt_±r
 + 
YY_MORE_ADJ
;

5892 
	gyy_m©ch
;

5894 
	gEOB_ACT_LAST_MATCH
:

5895 
yy_c_buf_p
 =

5896 &
yy_cuºít_buf„r
->
yy_ch_buf
[
yy_n_ch¨s
];

5898 
	gyy_cuºít_°©e
 = 
yy_gë_¥evious_°©e
();

5900 
	gyy_˝
 = 
yy_c_buf_p
;

5901 
	gyy_bp
 = 
yyãxt_±r
 + 
YY_MORE_ADJ
;

5902 
	gyy_föd_a˘i⁄
;

5908 
YY_FATAL_ERROR
(

5923 
	$yy_gë_√xt_buf„r
()

5925 *
de°
 = 
yy_cuºít_buf„r
->
yy_ch_buf
;

5926 *
sour˚
 = 
yyãxt_±r
;

5927 
numbî_to_move
, 
i
;

5928 
ªt_vÆ
;

5930 i‡–
yy_c_buf_p
 > &
yy_cuºít_buf„r
->
yy_ch_buf
[
yy_n_ch¨s
 + 1] )

5931 
	`YY_FATAL_ERROR
(

5934 i‡–
yy_cuºít_buf„r
->
yy_fûl_buf„r
 == 0 )

5936 i‡–
yy_c_buf_p
 - 
yyãxt_±r
 - 
YY_MORE_ADJ
 == 1 )

5941  
EOB_ACT_END_OF_FILE
;

5949  
EOB_ACT_LAST_MATCH
;

5956 
numbî_to_move
 = (Ë(
yy_c_buf_p
 - 
yyãxt_±r
) - 1;

5958  
i
 = 0; i < 
numbî_to_move
; ++i )

5959 *(
de°
++Ë*(
sour˚
++);

5961 i‡–
yy_cuºít_buf„r
->
yy_buf„r_°©us
 =
YY_BUFFER_EOF_PENDING
 )

5965 
yy_cuºít_buf„r
->
yy_n_ch¨s
 = yy_n_chars = 0;

5969 
num_to_ªad
 =

5970 
yy_cuºít_buf„r
->
yy_buf_size
 - 
numbî_to_move
 - 1;

5972  
num_to_ªad
 <= 0 )

5974 #ifde‡
YY_USES_REJECT


5975 
	`YY_FATAL_ERROR
(

5980 
YY_BUFFER_STATE
 
b
 = 
yy_cuºít_buf„r
;

5982 
yy_c_buf_p_off£t
 =

5983 (Ë(
yy_c_buf_p
 - 
b
->
yy_ch_buf
);

5985 i‡–
b
->
yy_is_our_buf„r
 )

5987 
√w_size
 = 
b
->
yy_buf_size
 * 2;

5989 i‡–
√w_size
 <= 0 )

5990 
b
->
yy_buf_size
 += b->yy_buf_size / 8;

5992 
b
->
yy_buf_size
 *= 2;

5994 
b
->
yy_ch_buf
 = (*)

5996 
	`yy_Êex_ªÆloc
–(*Ë
b
->
yy_ch_buf
,

5997 
b
->
yy_buf_size
 + 2 );

6001 
b
->
yy_ch_buf
 = 0;

6003 i‡–! 
b
->
yy_ch_buf
 )

6004 
	`YY_FATAL_ERROR
(

6007 
yy_c_buf_p
 = &
b
->
yy_ch_buf
[
yy_c_buf_p_off£t
];

6009 
num_to_ªad
 = 
yy_cuºít_buf„r
->
yy_buf_size
 -

6010 
numbî_to_move
 - 1;

6014 i‡–
num_to_ªad
 > 
YY_READ_BUF_SIZE
 )

6015 
num_to_ªad
 = 
YY_READ_BUF_SIZE
;

6018 
	`YY_INPUT
–(&
yy_cuºít_buf„r
->
yy_ch_buf
[
numbî_to_move
]),

6019 
yy_n_ch¨s
, 
num_to_ªad
 );

6021 
yy_cuºít_buf„r
->
yy_n_ch¨s
 = yy_n_chars;

6024 i‡–
yy_n_ch¨s
 == 0 )

6026 i‡–
numbî_to_move
 =
YY_MORE_ADJ
 )

6028 
ªt_vÆ
 = 
EOB_ACT_END_OF_FILE
;

6029 
	`yyª°¨t
–
yyö
 );

6034 
ªt_vÆ
 = 
EOB_ACT_LAST_MATCH
;

6035 
yy_cuºít_buf„r
->
yy_buf„r_°©us
 =

6036 
YY_BUFFER_EOF_PENDING
;

6041 
ªt_vÆ
 = 
EOB_ACT_CONTINUE_SCAN
;

6043 
yy_n_ch¨s
 +
numbî_to_move
;

6044 
yy_cuºít_buf„r
->
yy_ch_buf
[
yy_n_ch¨s
] = 
YY_END_OF_BUFFER_CHAR
;

6045 
yy_cuºít_buf„r
->
yy_ch_buf
[
yy_n_ch¨s
 + 1] = 
YY_END_OF_BUFFER_CHAR
;

6047 
yyãxt_±r
 = &
yy_cuºít_buf„r
->
yy_ch_buf
[0];

6049  
ªt_vÆ
;

6050 
	}
}

6055 
yy_°©e_ty≥
 
	$yy_gë_¥evious_°©e
()

6057 
yy_°©e_ty≥
 
yy_cuºít_°©e
;

6058 *
yy_˝
;

6060 
yy_cuºít_°©e
 = 
yy_°¨t
;

6061 
yy_cuºít_°©e
 +
	`YY_AT_BOL
();

6062 
yy_°©e_±r
 = 
yy_°©e_buf
;

6063 *
yy_°©e_±r
++ = 
yy_cuºít_°©e
;

6065  
yy_˝
 = 
yyãxt_±r
 + 
YY_MORE_ADJ
; yy_˝ < 
yy_c_buf_p
; ++yy_cp )

6067 
YY_CHAR
 
yy_c
 = (*
yy_˝
 ? 
yy_ec
[
	`YY_SC_TO_UI
(*yy_cp)] : 1);

6068  
yy_chk
[
yy_ba£
[
yy_cuºít_°©e
] + 
yy_c
] != yy_current_state )

6070 
yy_cuºít_°©e
 = (Ë
yy_def
[yy_current_state];

6071 i‡–
yy_cuºít_°©e
 >= 2576 )

6072 
yy_c
 = 
yy_mëa
[() yy_c];

6074 
yy_cuºít_°©e
 = 
yy_nxt
[
yy_ba£
[yy_cuºít_°©e] + (Ë
yy_c
];

6075 *
yy_°©e_±r
++ = 
yy_cuºít_°©e
;

6078  
yy_cuºít_°©e
;

6079 
	}
}

6088 #ifde‡
YY_USE_PROTOS


6089 
yy_°©e_ty≥
 
	$yy_åy_NUL_å™s
–
yy_°©e_ty≥
 
yy_cuºít_°©e
 )

6091 
yy_°©e_ty≥
 
	$yy_åy_NUL_å™s
–
yy_cuºít_°©e
 )

6092 
yy_°©e_ty≥
 
yy_cuºít_°©e
;

6095 
yy_is_jam
;

6097 
YY_CHAR
 
yy_c
 = 1;

6098  
yy_chk
[
yy_ba£
[
yy_cuºít_°©e
] + 
yy_c
] != yy_current_state )

6100 
yy_cuºít_°©e
 = (Ë
yy_def
[yy_current_state];

6101 i‡–
yy_cuºít_°©e
 >= 2576 )

6102 
yy_c
 = 
yy_mëa
[() yy_c];

6104 
yy_cuºít_°©e
 = 
yy_nxt
[
yy_ba£
[yy_cuºít_°©e] + (Ë
yy_c
];

6105 
yy_is_jam
 = (
yy_cuºít_°©e
 == 2575);

6106 i‡–! 
yy_is_jam
 )

6107 *
yy_°©e_±r
++ = 
yy_cuºít_°©e
;

6109  
yy_is_jam
 ? 0 : 
yy_cuºít_°©e
;

6110 
	}
}

6113 #i‚de‡
YY_NO_UNPUT


6114 #ifde‡
YY_USE_PROTOS


6115 
	$yyu≈ut
–
c
, *
yy_bp
 )

6117 
	$yyu≈ut
–
c
, 
yy_bp
 )

6118 
c
;

6119 *
yy_bp
;

6122 *
yy_˝
 = 
yy_c_buf_p
;

6125 *
yy_˝
 = 
yy_hﬁd_ch¨
;

6127 i‡–
yy_˝
 < 
yy_cuºít_buf„r
->
yy_ch_buf
 + 2 )

6130 
numbî_to_move
 = 
yy_n_ch¨s
 + 2;

6131 *
de°
 = &
yy_cuºít_buf„r
->
yy_ch_buf
[

6132 
yy_cuºít_buf„r
->
yy_buf_size
 + 2];

6133 *
sour˚
 =

6134 &
yy_cuºít_buf„r
->
yy_ch_buf
[
numbî_to_move
];

6136  
sour˚
 > 
yy_cuºít_buf„r
->
yy_ch_buf
 )

6137 *--
de°
 = *--
sour˚
;

6139 
yy_˝
 +(Ë(
de°
 - 
sour˚
);

6140 
yy_bp
 +(Ë(
de°
 - 
sour˚
);

6141 
yy_cuºít_buf„r
->
yy_n_ch¨s
 =

6142 
yy_n_ch¨s
 = 
yy_cuºít_buf„r
->
yy_buf_size
;

6144 i‡–
yy_˝
 < 
yy_cuºít_buf„r
->
yy_ch_buf
 + 2 )

6145 
	`YY_FATAL_ERROR
( "flex scannerÖush-back overflow" );

6148 *--
yy_˝
 = (Ë
c
;

6150 i‡–
c
 == '\n' )

6151 --
yylöío
;

6153 
yyãxt_±r
 = 
yy_bp
;

6154 
yy_hﬁd_ch¨
 = *
yy_˝
;

6155 
yy_c_buf_p
 = 
yy_˝
;

6156 
	}
}

6160 #i‚de‡
YY_NO_INPUT


6161 #ifde‡
__˝lu•lus


6162 
	$yyöput
()

6164 
	$öput
()

6167 
c
;

6169 *
yy_c_buf_p
 = 
yy_hﬁd_ch¨
;

6171 i‡–*
yy_c_buf_p
 =
YY_END_OF_BUFFER_CHAR
 )

6177 i‡–
yy_c_buf_p
 < &
yy_cuºít_buf„r
->
yy_ch_buf
[
yy_n_ch¨s
] )

6179 *
yy_c_buf_p
 = '\0';

6183 
off£t
 = 
yy_c_buf_p
 - 
yyãxt_±r
;

6184 ++
yy_c_buf_p
;

6186  
	`yy_gë_√xt_buf„r
() )

6188 
EOB_ACT_LAST_MATCH
:

6200 
	`yyª°¨t
–
yyö
 );

6204 
EOB_ACT_END_OF_FILE
:

6206 i‡–
	`yywøp
() )

6207  
EOF
;

6209 i‡–! 
yy_did_buf„r_swôch_⁄_eof
 )

6210 
YY_NEW_FILE
;

6211 #ifde‡
__˝lu•lus


6212  
	`yyöput
();

6214  
	`öput
();

6218 
EOB_ACT_CONTINUE_SCAN
:

6219 
yy_c_buf_p
 = 
yyãxt_±r
 + 
off£t
;

6225 
c
 = *(*Ë
yy_c_buf_p
;

6226 *
yy_c_buf_p
 = '\0';

6227 
yy_hﬁd_ch¨
 = *++
yy_c_buf_p
;

6229 
yy_cuºít_buf„r
->
yy_©_bﬁ
 = (
c
 == '\n');

6230 i‡–
yy_cuºít_buf„r
->
yy_©_bﬁ
 )

6231 ++
yylöío
;

6233  
c
;

6234 
	}
}

6238 #ifde‡
YY_USE_PROTOS


6239 
	$yyª°¨t
–
FILE
 *
öput_fûe
 )

6241 
	$yyª°¨t
–
öput_fûe
 )

6242 
FILE
 *
öput_fûe
;

6245 i‡–! 
yy_cuºít_buf„r
 )

6246 
yy_cuºít_buf„r
 = 
	`yy_¸óã_buf„r
–
yyö
, 
YY_BUF_SIZE
 );

6248 
	`yy_öô_buf„r
–
yy_cuºít_buf„r
, 
öput_fûe
 );

6249 
	`yy_lﬂd_buf„r_°©e
();

6250 
	}
}

6253 #ifde‡
YY_USE_PROTOS


6254 
	$yy_swôch_to_buf„r
–
YY_BUFFER_STATE
 
√w_buf„r
 )

6256 
	$yy_swôch_to_buf„r
–
√w_buf„r
 )

6257 
YY_BUFFER_STATE
 
√w_buf„r
;

6260 i‡–
yy_cuºít_buf„r
 =
√w_buf„r
 )

6263 i‡–
yy_cuºít_buf„r
 )

6266 *
yy_c_buf_p
 = 
yy_hﬁd_ch¨
;

6267 
yy_cuºít_buf„r
->
yy_buf_pos
 = 
yy_c_buf_p
;

6268 
yy_cuºít_buf„r
->
yy_n_ch¨s
 = yy_n_chars;

6271 
yy_cuºít_buf„r
 = 
√w_buf„r
;

6272 
	`yy_lﬂd_buf„r_°©e
();

6279 
yy_did_buf„r_swôch_⁄_eof
 = 1;

6280 
	}
}

6283 #ifde‡
YY_USE_PROTOS


6284 
	$yy_lﬂd_buf„r_°©e
( )

6286 
	$yy_lﬂd_buf„r_°©e
()

6289 
yy_n_ch¨s
 = 
yy_cuºít_buf„r
->yy_n_chars;

6290 
yyãxt_±r
 = 
yy_c_buf_p
 = 
yy_cuºít_buf„r
->
yy_buf_pos
;

6291 
yyö
 = 
yy_cuºít_buf„r
->
yy_öput_fûe
;

6292 
yy_hﬁd_ch¨
 = *
yy_c_buf_p
;

6293 
	}
}

6296 #ifde‡
YY_USE_PROTOS


6297 
YY_BUFFER_STATE
 
	$yy_¸óã_buf„r
–
FILE
 *
fûe
, 
size
 )

6299 
YY_BUFFER_STATE
 
	$yy_¸óã_buf„r
–
fûe
, 
size
 )

6300 
FILE
 *
fûe
;

6301 
size
;

6304 
YY_BUFFER_STATE
 
b
;

6306 
b
 = (
YY_BUFFER_STATE
Ë
	`yy_Êex_Æloc
––
yy_buf„r_°©e
 ) );

6307 i‡–! 
b
 )

6308 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_create_buffer()" );

6310 
b
->
yy_buf_size
 = 
size
;

6315 
b
->
yy_ch_buf
 = (*Ë
	`yy_Êex_Æloc
–b->
yy_buf_size
 + 2 );

6316 i‡–! 
b
->
yy_ch_buf
 )

6317 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_create_buffer()" );

6319 
b
->
yy_is_our_buf„r
 = 1;

6321 
	`yy_öô_buf„r
–
b
, 
fûe
 );

6323  
b
;

6324 
	}
}

6327 #ifde‡
YY_USE_PROTOS


6328 
	$yy_dñëe_buf„r
–
YY_BUFFER_STATE
 
b
 )

6330 
	$yy_dñëe_buf„r
–
b
 )

6331 
YY_BUFFER_STATE
 
b
;

6334 i‡–! 
b
 )

6337 i‡–
b
 =
yy_cuºít_buf„r
 )

6338 
yy_cuºít_buf„r
 = (
YY_BUFFER_STATE
) 0;

6340 i‡–
b
->
yy_is_our_buf„r
 )

6341 
	`yy_Êex_‰ì
–(*Ë
b
->
yy_ch_buf
 );

6343 
	`yy_Êex_‰ì
–(*Ë
b
 );

6344 
	}
}

6347 #i‚de‡
YY_ALWAYS_INTERACTIVE


6348 #i‚de‡
YY_NEVER_INTERACTIVE


6349 
	~<uni°d.h
>

6353 #ifde‡
YY_USE_PROTOS


6354 
	$yy_öô_buf„r
–
YY_BUFFER_STATE
 
b
, 
FILE
 *
fûe
 )

6356 
	$yy_öô_buf„r
–
b
, 
fûe
 )

6357 
YY_BUFFER_STATE
 
b
;

6358 
FILE
 *
fûe
;

6363 
€ºno
 = 
î∫o
;

6365 
	`yy_Êush_buf„r
–
b
 );

6367 
b
->
yy_öput_fûe
 = 
fûe
;

6368 
b
->
yy_fûl_buf„r
 = 1;

6370 #i‡
	`deföed
(
YY_ALWAYS_INTERACTIVE
) && YY_ALWAYS_INTERACTIVE

6371 
b
->
yy_is_öãø˘ive
 = 1;

6373 #i‡
	`deföed
(
YY_NEVER_INTERACTIVE
) && YY_NEVER_INTERACTIVE

6374 
b
->
yy_is_öãø˘ive
 = 0;

6376 
b
->
yy_is_öãø˘ive
 = 
fûe
 ? (
	`ißây
–
	`fûío
(file) ) > 0) : 0;

6379 
î∫o
 = 
€ºno
;

6380 
	}
}

6383 #ifde‡
YY_USE_PROTOS


6384 
	$yy_Êush_buf„r
–
YY_BUFFER_STATE
 
b
 )

6386 
	$yy_Êush_buf„r
–
b
 )

6387 
YY_BUFFER_STATE
 
b
;

6391 i‡–! 
b
 )

6394 
b
->
yy_n_ch¨s
 = 0;

6400 
b
->
yy_ch_buf
[0] = 
YY_END_OF_BUFFER_CHAR
;

6401 
b
->
yy_ch_buf
[1] = 
YY_END_OF_BUFFER_CHAR
;

6403 
b
->
yy_buf_pos
 = &b->
yy_ch_buf
[0];

6405 
b
->
yy_©_bﬁ
 = 1;

6406 
b
->
yy_buf„r_°©us
 = 
YY_BUFFER_NEW
;

6408 i‡–
b
 =
yy_cuºít_buf„r
 )

6409 
	`yy_lﬂd_buf„r_°©e
();

6410 
	}
}

6413 #i‚de‡
YY_NO_SCAN_BUFFER


6414 #ifde‡
YY_USE_PROTOS


6415 
YY_BUFFER_STATE
 
	$yy_sˇn_buf„r
–*
ba£
, 
yy_size_t
 
size
 )

6417 
YY_BUFFER_STATE
 
	$yy_sˇn_buf„r
–
ba£
, 
size
 )

6418 *
ba£
;

6419 
yy_size_t
 
size
;

6422 
YY_BUFFER_STATE
 
b
;

6424 i‡–
size
 < 2 ||

6425 
ba£
[
size
-2] !
YY_END_OF_BUFFER_CHAR
 ||

6426 
ba£
[
size
-1] !
YY_END_OF_BUFFER_CHAR
 )

6430 
b
 = (
YY_BUFFER_STATE
Ë
	`yy_Êex_Æloc
––
yy_buf„r_°©e
 ) );

6431 i‡–! 
b
 )

6432 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_scan_buffer()" );

6434 
b
->
yy_buf_size
 = 
size
 - 2;

6435 
b
->
yy_buf_pos
 = b->
yy_ch_buf
 = 
ba£
;

6436 
b
->
yy_is_our_buf„r
 = 0;

6437 
b
->
yy_öput_fûe
 = 0;

6438 
b
->
yy_n_ch¨s
 = b->
yy_buf_size
;

6439 
b
->
yy_is_öãø˘ive
 = 0;

6440 
b
->
yy_©_bﬁ
 = 1;

6441 
b
->
yy_fûl_buf„r
 = 0;

6442 
b
->
yy_buf„r_°©us
 = 
YY_BUFFER_NEW
;

6444 
	`yy_swôch_to_buf„r
–
b
 );

6446  
b
;

6447 
	}
}

6451 #i‚de‡
YY_NO_SCAN_STRING


6452 #ifde‡
YY_USE_PROTOS


6453 
YY_BUFFER_STATE
 
	$yy_sˇn_°rög
–
yyc⁄°
 *
yy_°r
 )

6455 
YY_BUFFER_STATE
 
	$yy_sˇn_°rög
–
yy_°r
 )

6456 
yyc⁄°
 *
yy_°r
;

6459 
Àn
;

6460  
Àn
 = 0; 
yy_°r
[len]; ++len )

6463  
	`yy_sˇn_byãs
–
yy_°r
, 
Àn
 );

6464 
	}
}

6468 #i‚de‡
YY_NO_SCAN_BYTES


6469 #ifde‡
YY_USE_PROTOS


6470 
YY_BUFFER_STATE
 
	$yy_sˇn_byãs
–
yyc⁄°
 *
byãs
, 
Àn
 )

6472 
YY_BUFFER_STATE
 
	$yy_sˇn_byãs
–
byãs
, 
Àn
 )

6473 
yyc⁄°
 *
byãs
;

6474 
Àn
;

6477 
YY_BUFFER_STATE
 
b
;

6478 *
buf
;

6479 
yy_size_t
 
n
;

6480 
i
;

6483 
n
 = 
Àn
 + 2;

6484 
buf
 = (*Ë
	`yy_Êex_Æloc
–
n
 );

6485 i‡–! 
buf
 )

6486 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_scan_bytes()" );

6488  
i
 = 0; i < 
Àn
; ++i )

6489 
buf
[
i
] = 
byãs
[i];

6491 
buf
[
Àn
] = buf[Àn+1] = 
YY_END_OF_BUFFER_CHAR
;

6493 
b
 = 
	`yy_sˇn_buf„r
–
buf
, 
n
 );

6494 i‡–! 
b
 )

6495 
	`YY_FATAL_ERROR
( "bad buffer in yy_scan_bytes()" );

6500 
b
->
yy_is_our_buf„r
 = 1;

6502  
b
;

6503 
	}
}

6507 #i‚de‡
YY_NO_PUSH_STATE


6508 #ifde‡
YY_USE_PROTOS


6509 
	$yy_push_°©e
–
√w_°©e
 )

6511 
	$yy_push_°©e
–
√w_°©e
 )

6512 
√w_°©e
;

6515 i‡–
yy_°¨t_°ack_±r
 >
yy_°¨t_°ack_dïth
 )

6517 
yy_size_t
 
√w_size
;

6519 
yy_°¨t_°ack_dïth
 +
YY_START_STACK_INCR
;

6520 
√w_size
 = 
yy_°¨t_°ack_dïth
 * ( );

6522 i‡–! 
yy_°¨t_°ack
 )

6523 
yy_°¨t_°ack
 = (*Ë
	`yy_Êex_Æloc
–
√w_size
 );

6526 
yy_°¨t_°ack
 = (*Ë
	`yy_Êex_ªÆloc
(

6527 (*Ë
yy_°¨t_°ack
, 
√w_size
 );

6529 i‡–! 
yy_°¨t_°ack
 )

6530 
	`YY_FATAL_ERROR
(

6534 
yy_°¨t_°ack
[
yy_°¨t_°ack_±r
++] = 
YY_START
;

6536 
	`BEGIN
(
√w_°©e
);

6537 
	}
}

6541 #i‚de‡
YY_NO_POP_STATE


6542 
	$yy_p›_°©e
()

6544 i‡–--
yy_°¨t_°ack_±r
 < 0 )

6545 
	`YY_FATAL_ERROR
( "start-condition stack underflow" );

6547 
	`BEGIN
(
yy_°¨t_°ack
[
yy_°¨t_°ack_±r
]);

6548 
	}
}

6552 #i‚de‡
YY_NO_TOP_STATE


6553 
	$yy_t›_°©e
()

6555  
yy_°¨t_°ack
[
yy_°¨t_°ack_±r
 - 1];

6556 
	}
}

6559 #i‚de‡
YY_EXIT_FAILURE


6560 
	#YY_EXIT_FAILURE
 2

	)

6563 #ifde‡
YY_USE_PROTOS


6564 
	$yy_Áèl_îr‹
–
yyc⁄°
 
msg
[] )

6566 
	$yy_Áèl_îr‹
–
msg
 )

6567 
msg
[];

6570 (Ë
	`Ârötf
–
°dîr
, "%s\n", 
msg
 );

6571 
	`exô
–
YY_EXIT_FAILURE
 );

6572 
	}
}

6578 #unde‡
yyÀss


6579 
	#yyÀss
(
n
) \

6583 
yyãxt
[
yyÀng
] = 
yy_hﬁd_ch¨
; \

6584 
yy_c_buf_p
 = 
yyãxt
 + 
n
; \

6585 
yy_hﬁd_ch¨
 = *
yy_c_buf_p
; \

6586 *
yy_c_buf_p
 = '\0'; \

6587 
yyÀng
 = 
n
; \

6589  0 )

	)

6594 #i‚de‡
yyãxt_±r


6595 #ifde‡
YY_USE_PROTOS


6596 
	$yy_Êex_°∫˝y
–*
s1
, 
yyc⁄°
 *
s2
, 
n
 )

6598 
	$yy_Êex_°∫˝y
–
s1
, 
s2
, 
n
 )

6599 *
s1
;

6600 
yyc⁄°
 *
s2
;

6601 
n
;

6604 
i
;

6605  
i
 = 0; i < 
n
; ++i )

6606 
s1
[
i
] = 
s2
[i];

6607 
	}
}

6610 #ifde‡
YY_NEED_STRLEN


6611 #ifde‡
YY_USE_PROTOS


6612 
	$yy_Êex_°æí
–
yyc⁄°
 *
s
 )

6614 
	$yy_Êex_°æí
–
s
 )

6615 
yyc⁄°
 *
s
;

6618 
n
;

6619  
n
 = 0; 
s
[n]; ++n )

6622  
n
;

6623 
	}
}

6627 #ifde‡
YY_USE_PROTOS


6628 *
	$yy_Êex_Æloc
–
yy_size_t
 
size
 )

6630 *
	$yy_Êex_Æloc
–
size
 )

6631 
yy_size_t
 
size
;

6634  (*Ë
	`mÆloc
–
size
 );

6635 
	}
}

6637 #ifde‡
YY_USE_PROTOS


6638 *
	$yy_Êex_ªÆloc
–*
±r
, 
yy_size_t
 
size
 )

6640 *
	$yy_Êex_ªÆloc
–
±r
, 
size
 )

6641 *
±r
;

6642 
yy_size_t
 
size
;

6652  (*Ë
	`ªÆloc
–(*Ë
±r
, 
size
 );

6653 
	}
}

6655 #ifde‡
YY_USE_PROTOS


6656 
	$yy_Êex_‰ì
–*
±r
 )

6658 
	$yy_Êex_‰ì
–
±r
 )

6659 *
±r
;

6662 
	`‰ì
–
±r
 );

6663 
	}
}

6665 #i‡
deföed
(
YY_MAIN
) && YY_MAIN

6666 
	$maö
()

6668 
	`yyÀx
();

6670 
	}
}

6676 
	$shouldª£t°©e
(
cuºít_°©e
, 
√xt_tokí
)

6677 c⁄° 
cuºít_°©e
;

6678 c⁄° 
√xt_tokí
;

6680 
cuºít_°©e
) {

6681 
°¨t_ho°ödex
:

6682 
°¨t_scheduÀmask
:

6683 
°¨t_£rvi˚«me
:

6684 
√xt_tokí
) {

6685 
NUMBER
:

6692 
	}
}

	@lib/config_scan.l

48 
	~"comm⁄.h
"

51 c⁄° 
	grcsid
[] =

54 
	~"yacc⁄fig.h
"

55 
	~"c⁄fig_∑r£.h
"

57 
	#YY_STACK_USED
 0

	)

58 
	#YY_ALWAYS_INTERACTIVE
 0

	)

59 
	#YY_NEVER_INTERACTIVE
 1

	)

60 
	#YY_MAIN
 0

	)

62 #i‡
SOCKS_CLIENT


67 
	#PROC_MOTHER
 0

	)

68 
	#PROC_NEGOTIATE
 0

	)

69 
	#PROC_REQUEST
 0

	)

70 
	#PROC_IO
 0

	)

71 
	#PROC_MONITOR
 0

	)

75 
shouldª£t°©e
(c⁄° 
cuºít_°©e
, c⁄° 
√xt_tokí
);

83 c⁄° 
socks_c⁄figty≥
;

84 
Àx_d‹e°¨t
;

86 
	gcuºíéexlöe
[100];

87 
	g¥eviou¶exlöe
[100];

88 
	gismask
;

89 
	görouã
, 
	gö˛õ¡ruÀ
;

97 %
›ti⁄
 
yylöío


98 %
›ti⁄
 
noyywøp


99 %
›ti⁄
 
nou≈ut


103 
WORDCHAR
 [[:
Æpha
:]]

104 
NOT_WORDCHAR
 [[^:
Æpha
:]]

105 
LS
 ^[[:
bœnk
:]]*

107 
SOCKETLEVEL
 (
ù
|
sockë
|
t˝
|
udp
)

111 %
s
 
°¨t_addªss


112 %
s
 
°¨t_p‹t


115 %
x
 
löïªfix


116 %
x
 
°¨t_comm™d


117 %
x
 
°¨t_com∑tibûôy


118 %
x
 
°¨t_löe


119 %
x
 
°¨t_log


120 %
x
 
°¨t_logÀvñ


121 %
x
 
°¨t_logouçut


122 %
x
 
°¨t_logty≥


123 %
x
 
°¨t_îr‹symbﬁ


124 %
x
 
°¨t_mëhod


125 %
x
 
°¨t_›ti⁄


126 %
x
 
°¨t_¥oxy¥Ÿocﬁ


127 %
x
 
°¨t_u£∫ame


128 %
x
 
°¨t_grou≤ame


129 %
x
 
°¨t_libwøpfûe


130 %
x
 
°¨t_˝u›ti⁄


131 %
x
 
°¨t_ho°ödex


132 %
x
 
°¨t_°©ekey


133 %
x
 
°¨t_t˝›ti⁄


136 %
x
 
°¨t_ld≠domaö


137 %
x
 
°¨t_ld≠ba£dn


138 %
x
 
°¨t_ld≠uæ


139 %
x
 
°¨t_ld≠fûãr


140 %
x
 
°¨t_ld≠©åibuã


141 %
x
 
°¨t_ld≠£rvî«me


142 %
x
 
°¨t_ld≠grou≤ame


143 %
x
 
°¨t_ld≠keyèb«me


144 %
x
 
°¨t_ld≠˚πfûe


145 %
x
 
°¨t_ld≠˚π∑th


148 %
x
 
°¨t_Æ¨mã°


149 %
x
 
°¨t_§cho°


150 %
x
 
°¨t_¥Ÿocﬁ


151 %
x
 
°¨t_£rvi˚«me


152 %
x
 
°¨t_p‹äumbî


153 %
x
 
°¨t_bsdauth°yÀ«me


154 %
x
 
°¨t_gsßpi£rvi˚«me


155 %
x
 
°¨t_gsßpikeyèb«me


156 %
x
 
°¨t_í¸y±i⁄


157 %
x
 
°¨t_ªÆm«me


159 %
x
 
°¨t_sockë¥Ÿocﬁ


160 %
x
 
°¨t_sockë›ti⁄


161 %
x
 
°¨t_sockë›ti⁄vÆue


163 %
x
 
°¨t_¥o˚s°y≥


164 %
x
 
°¨t_scheduÀpﬁicy


165 %
x
 
°¨t_scheduÀmask


166 %% /* 
	$yyÀx
 */

170 i‡(
	gÀx_d‹e°¨t
) {

171 
	gÀx_d‹e°¨t
 = 0;

172 
	gö˛õ¡ruÀ
 = 
örouã
 = 0;

174 
	gsocks_c⁄figty≥
) {

175 
	gCONFIGTYPE_SERVER
:

176  
SERVERCONFIG
;

178 
	gCONFIGTYPE_CLIENT
:

179  
CLIENTCONFIG
;

182 
	`SERRX
(
socks_c⁄figty≥
);

188 \
	gn
.* {

189 c⁄° *
	g°rù
 = " \n\t";

190 c⁄° *
	gp
 = 
cuºíéexlöe
;

192 
	`SKIPLEADING
(
	gp
, 
	g°rù
);

193 i‡(
	`°æí
(
	gp
) > 0)

194 
	`°r˝y
(
	g¥eviou¶exlöe
, 
	gcuºíéexlöe
);

197 
	`°∫˝y
(
	gcuºíéexlöe
, 
	gyyãxt
, (currentlexline) - 1);

198 
	gcuºíéexlöe
[(
cuºíéexlöe
Ë- 1] = 
NUL
;

200 ++
	gyylöío
;

201 
	`yyÀss
(1);

203 #
ídif


211 <
°¨t_¥Ÿocﬁ
>
ùv4
 {

212 
yylvÆ
.
°rög
 = 
yyãxt
;

213  
IPV4
;

216 <
°¨t_¥Ÿocﬁ
>
ùv6
 {

217 
yylvÆ
.
°rög
 = 
yyãxt
;

218  
IPV6
;

221 <
°¨t_t˝›ti⁄
>
e˙
 {

222 
yylvÆ
.
°rög
 = 
yyãxt
;

223  
ECN
;

226 <
°¨t_t˝›ti⁄
>
ßck
 {

227 
yylvÆ
.
°rög
 = 
yyãxt
;

228  
SACK
;

231 <
°¨t_t˝›ti⁄
>
time°amps
 {

232 
yylvÆ
.
°rög
 = 
yyãxt
;

233  
TIMESTAMPS
;

236 <
°¨t_t˝›ti⁄
>
wsˇÀ
 {

237 
yylvÆ
.
°rög
 = 
yyãxt
;

238  
WSCALE
;

242 <
°¨t_Æ¨mã°
>
mtu
-
îr‹
 {

243 
yylvÆ
.
°rög
 = 
yyãxt
;

244  
MTU_ERROR
;

247 <
°¨t_°©ekey
>
‰om
|
ho°id
[^: /\
t
\
n
]* {

248 
	`BEGIN
(0);

250 
yylvÆ
.
°rög
 = 
yyãxt
;

251  
STATEKEY
;

254 <
°¨t_£rvi˚«me
>[
a
-
zA
-
Z
]+[^: /\
t
\
n
]* {

255 
	`BEGIN
(0);

257 
yylvÆ
.
°rög
 = 
yyãxt
;

258  
SERVICENAME
;

261 <
°¨t_¥oxy¥Ÿocﬁ
>
socks_v4
 {

262 
yylvÆ
.
°rög
 = 
yyãxt
;

263  
PROXYPROTOCOL_SOCKS_V4
;

266 <
°¨t_¥oxy¥Ÿocﬁ
>
socks_v5
 {

267 
yylvÆ
.
°rög
 = 
yyãxt
;

268  
PROXYPROTOCOL_SOCKS_V5
;

271 <
°¨t_¥oxy¥Ÿocﬁ
>
hâp
|
hâp_v1
.0 {

272 
yylvÆ
.
°rög
 = 
yyãxt
;

273  
PROXYPROTOCOL_HTTP
;

276 <
°¨t_¥oxy¥Ÿocﬁ
>
u≤p
 {

277 
yylvÆ
.
°rög
 = 
yyãxt
;

278  
PROXYPROTOCOL_UPNP
;

281 <
°¨t_comm™d
>
böd
 {

282 
yylvÆ
.
°rög
 = 
yyãxt
;

283  
COMMAND_BIND
;

286 <
°¨t_comm™d
>
c⁄√˘
 {

287 
yylvÆ
.
°rög
 = 
yyãxt
;

288  
COMMAND_CONNECT
;

291 <
°¨t_comm™d
>
ud∑ssocüã
 {

292 
yylvÆ
.
°rög
 = 
yyãxt
;

293  
COMMAND_UDPASSOCIATE
;

296 <
°¨t_comm™d
>
bödª∂y
 {

297 
yylvÆ
.
°rög
 = 
yyãxt
;

298  
COMMAND_BINDREPLY
;

301 <
°¨t_comm™d
>
ud¥ïly
 {

302 
yylvÆ
.
°rög
 = 
yyãxt
;

303  
COMMAND_UDPREPLY
;

307 <
°¨t_addªss
>(
hâp
|
·p
)\:\/\/.* {

308 
yylvÆ
.
°rög
 = 
yyãxt
;

309  
URL
;

312 <
°¨t_addªss
>\. {

313 
	`BEGIN
(
°¨t_p‹t
);

315 
yylvÆ
.
°rög
 = 
yyãxt
;

316  
DOMAINNAME
;

319 <
°¨t_addªss
>0/\/ {

325 
	`BEGIN
(
°¨t_p‹t
);

327 
yylvÆ
.
°rög
 = 
yyãxt
;

328  
IPVANY
;

331 <
°¨t_addªss
>([^ \
t
\
n
][^/ \t\n]+)|(::) {

332 
sockaddr_°‹age
 
addr
, 
mask
;

333 
ö6_addr
 
ùv6
;

334 
ö_addr
 
ùv4
;

335 
visbuf
[256];

337 
	`BEGIN
(
°¨t_p‹t
);

339 
yylvÆ
.
°rög
 = 
yyãxt
;

350 i‡(
	`socks_öë_±⁄
(
AF_INET
, 
yyãxt
, &
ùv4
, 
NULL
) == 1)

351  
IPV4
;

353 i‡(
	`socks_öë_±⁄
(
AF_INET6
, 
yyãxt
, &
ùv6
, 
NULL
) == 1) {

354 i‡(
	`IN6_IS_ADDR_V4MAPPED
(&
ùv6
))

355 
	`yyîr‹x
("we doÇot use IPv4-mapped IPv6áddresses. Please specify "

358  
IPV6
;

361 
î∫o
 = 0;

362 i‡(
	`i‚ame2sockaddr
(
yyãxt
, 0, &
addr
, &
mask
Ë!
NULL
)

363  
IFNAME
;

365 i‡(
	`ERRNOISNOFILE
(
î∫o
))

366 
	`yyîr‹
("no free filedescriptors: canÇotáccess information on "

368 
	`°r2vis
(
yyãxt
, 
	`°æí
(yyãxt), 
visbuf
, (visbuf)));

371 
	`¶og
(
LOG_DEBUG
,

373 
yyãxt
);

375  
DOMAINNAME
;

378 <
°¨t_p‹t
>
p‹t
 {

379 
yylvÆ
.
°rög
 = 
yyãxt
;

380  
PORT
;

387 
˝u
 {

388 
	`BEGIN
(
°¨t_˝u›ti⁄
);

390 
yylvÆ
.
°rög
 = 
yyãxt
;

391  
CPU
;

394 <
°¨t_˝u›ti⁄
>
scheduÀ
 {

395 
	`BEGIN
(
°¨t_¥o˚s°y≥
);

397 
ismask
 = 0;

399 
yylvÆ
.
°rög
 = 
yyãxt
;

400  
SCHEDULE
;

403 <
°¨t_˝u›ti⁄
>
mask
 {

404 
	`BEGIN
(
°¨t_¥o˚s°y≥
);

406 
ismask
 = 1;

408 
yylvÆ
.
°rög
 = 
yyãxt
;

409  
MASK
;

412 <
°¨t_¥o˚s°y≥
>
mŸhî
 {

413 
	`BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

415 
yylvÆ
.
numbî
 = 
PROC_MOTHER
;

416  
PROCESSTYPE
;

419 <
°¨t_¥o˚s°y≥
>
m⁄ô‹
 {

420 
	`BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

422 
yylvÆ
.
numbî
 = 
PROC_MONITOR
;

423  
PROCESSTYPE
;

426 <
°¨t_¥o˚s°y≥
>
√gŸüã
 {

427 
	`BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

429 
yylvÆ
.
numbî
 = 
PROC_NEGOTIATE
;

430  
PROCESSTYPE
;

433 <
°¨t_¥o˚s°y≥
>
ªque°
 {

434 
	`BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

436 
yylvÆ
.
numbî
 = 
PROC_REQUEST
;

437  
PROCESSTYPE
;

440 <
°¨t_¥o˚s°y≥
>
io
 {

441 
	`BEGIN
(
ismask
 ? 
°¨t_scheduÀmask
 : 
°¨t_scheduÀpﬁicy
);

443 
yylvÆ
.
numbî
 = 
PROC_IO
;

444  
PROCESSTYPE
;

447 <
°¨t_scheduÀmask
>
™y
 {

448 
	`BEGIN
(0);

450 
yylvÆ
.
numbî
 = 
CPUMASK_ANYCPU
;

451  
NUMBER
;

454 <
°¨t_scheduÀpﬁicy
>[^: 0-9\
t
/]+ {

455 #
SOCKS_CLIENT


456 
	`SERRX
(0);

459 #
HAVE_SCHED_SETAFFINITY


461 
	`BEGIN
(0);

463 i‡((
yylvÆ
.
numbî
 = 
	`˝upﬁicy2numîic
(
yyãxt
)) == -1)

464 
	`yyîr‹x
("unknow¿schedulögÖﬁicy \"%s\"", 
yyãxt
);

466  
SCHEDULEPOLICY
;

468 
	`yyîr‹x
("setting cpu schedulingÖolicy isÇot supported onÅhisÖlatform");

469 #
ídif


471 #
ídif


479 <
°¨t_sockë¥Ÿocﬁ
>
ù
 {

480 
	`BEGIN
(
°¨t_sockë›ti⁄
);

482 
yylvÆ
.
numbî
 = 
IPPROTO_IP
;

483  
SOCKETPROTOCOL
;

486 <
°¨t_sockë¥Ÿocﬁ
>
sockë
 {

487 
	`BEGIN
(
°¨t_sockë›ti⁄
);

489 
yylvÆ
.
numbî
 = 
SOL_SOCKET
;

490  
SOCKETPROTOCOL
;

493 <
°¨t_sockë¥Ÿocﬁ
>
t˝
 {

494 
	`BEGIN
(
°¨t_sockë›ti⁄
);

496 
yylvÆ
.
numbî
 = 
IPPROTO_TCP
;

497  
SOCKETPROTOCOL
;

500 <
°¨t_sockë¥Ÿocﬁ
>
udp
 {

501 
	`BEGIN
(
°¨t_sockë›ti⁄
);

503 
yylvÆ
.
numbî
 = 
IPPROTO_UDP
;

504  
SOCKETPROTOCOL
;

508 <
°¨t_sockë›ti⁄
>[-
a
-
zA
-
Z_
][-a-zA-Z_\.0-9]+ {

509 c⁄° 
sock›t_t
 *
sock›t
;

511 
	`BEGIN
(
°¨t_sockë›ti⁄vÆue
);

513 i‡((
sock›t
 = 
	`›äame2sock›t
(
yyãxt
)Ë=
NULL
)

514 
	`yyîr‹x
("unknow¿sockë o±i⁄ \"%s\"", 
yyãxt
);

516 
yylvÆ
.
numbî
 = (
ssize_t
)
sock›t
->
›tid
;

517  
SOCKETOPTION_OPTID
;

520 <
°¨t_sockë›ti⁄vÆue
>[^: \
t
\
n0
-9][^ \t\
n
]+ {

521 
	`BEGIN
(0);

523 
yylvÆ
.
°rög
 = 
yyãxt
;

524  
SOCKETOPTION_SYMBOLICVALUE
;

527 <
°¨t_log
>
c⁄√˘
 {

528 
yylvÆ
.
°rög
 = 
yyãxt
;

529  
RULE_LOG_CONNECT
;

532 <
°¨t_log
>
d©a
 {

533 
yylvÆ
.
°rög
 = 
yyãxt
;

534  
RULE_LOG_DATA
;

537 <
°¨t_log
>
disc⁄√˘
 {

538 
yylvÆ
.
°rög
 = 
yyãxt
;

539  
RULE_LOG_DISCONNECT
;

542 <
°¨t_log
>
îr‹
 {

543 
yylvÆ
.
°rög
 = 
yyãxt
;

544  
RULE_LOG_ERROR
;

547 <
°¨t_log
>
io›î©i⁄
|
io›
 {

548 
yylvÆ
.
°rög
 = 
yyãxt
;

549  
RULE_LOG_IOOPERATION
;

552 <
°¨t_log
>
t˝öfo
 {

553 
yylvÆ
.
°rög
 = 
yyãxt
;

554  
RULE_LOG_TCPINFO
;

557 <
°¨t_logÀvñ
>[
a
-
zA
-
Z
]+/\. {

558 c⁄° 
logÀvñ_t
 *
l
;

559 
visbuf
[256];

561 
	`BEGIN
(
°¨t_logty≥
);

563 i‡((
l
 = 
	`logÀvñ
(
yyãxt
)Ë=
NULL
)

564 
	`yyîr‹
("unknownÜoglevel: \"%s\"",

565 
	`°r2vis
(
yyãxt
, 
	`°æí
(yyãxt), 
visbuf
, (visbuf)));

567 
yylvÆ
.
numbî
 = 
l
->
vÆue
;

568  
LOGLEVEL
;

571 <
°¨t_logty≥
>
îr‹
 {

572 
	`BEGIN
(
°¨t_îr‹symbﬁ
);

574 
yylvÆ
.
°rög
 = 
yyãxt
;

575  
LOGTYPE_ERROR
;

578 <
°¨t_logty≥
>
t˝
\.
dißbÀd
 {

579 
	`BEGIN
(
°¨t_t˝›ti⁄
);

581 
yylvÆ
.
°rög
 = 
yyãxt
;

582  
LOGTYPE_TCP_DISABLED
;

585 <
°¨t_logty≥
>
t˝
\.
íabÀd
 {

586 
	`BEGIN
(
°¨t_t˝›ti⁄
);

588 
yylvÆ
.
°rög
 = 
yyãxt
;

589  
LOGTYPE_TCP_ENABLED
;

593 <
°¨t_îr‹symbﬁ
>[
a
-
zA
-
Z
][^:[:
•a˚
:]]+ {

594 #!
SOCKS_CLIENT


601 i‡((
yylvÆ
.
îr‹
.
vÆuev
 = 
	`gaivÆue
(
yyãxt
)Ë!
NULL
)

602 
yylvÆ
.
îr‹
.
vÆuëy≥
 = 
VALUETYPE_GAIERR
;

603 i‡((
yylvÆ
.
îr‹
.
vÆuev
 = 
	`î∫ovÆue
(
yyãxt
)Ë!
NULL
)

604 
yylvÆ
.
îr‹
.
vÆuëy≥
 = 
VALUETYPE_ERRNO
;

608 
yylvÆ
.
îr‹
.
vÆuev
 = 
NULL
;

610 #
ídif


612  
ERRORVALUE
;

615 <
°¨t_bsdauth°yÀ«me
>[
a
-
zA
-
Z
]+[^: /\
t
\
n
]* {

616 
yylvÆ
.
°rög
 = 
yyãxt
;

617  
BSDAUTHSTYLENAME
;

620 <
°¨t_logouçut
>[^: \
t
\
n
]+ {

621 
yylvÆ
.
°rög
 = 
yyãxt
;

622  
LOGFILE
;

625 <
°¨t_u£∫ame
>[^: \
t
\
n
]+ {

626 
yylvÆ
.
°rög
 = 
yyãxt
;

627  
USERNAME
;

630 <
°¨t_grou≤ame
>[^: \
t
\
n
]+ {

631 
yylvÆ
.
°rög
 = 
yyãxt
;

632  
GROUPNAME
;

635 <
°¨t_libwøpfûe
>[^: \
t
\
n
]+ {

636 
yylvÆ
.
°rög
 = 
yyãxt
;

637  
LIBWRAP_FILE
;

640 <
°¨t_ld≠domaö
>[^: \
t
\
n
]+[^\t\n]+ {

641 
yylvÆ
.
°rög
 = 
yyãxt
;

642  
LDAP_DOMAIN
;

645 <
°¨t_ld≠ba£dn
>[^: \
t
\
n
]+[^\t\n]+ {

646 
yylvÆ
.
°rög
 = 
yyãxt
;

647  
LDAP_BASEDN
;

650 <
°¨t_ld≠fûãr
>[^: \
t
\
n
]+[^\t\n]+ {

651 
yylvÆ
.
°rög
 = 
yyãxt
;

652  
LDAP_FILTER
;

655 <
°¨t_ld≠uæ
>(
ld≠
|
ld≠s
)\:\/\/.* {

656 
yylvÆ
.
°rög
 = 
yyãxt
;

657  
LDAP_URL
;

660 <
°¨t_ld≠©åibuã
>[^: \
t
\
n
]+[^\t\n]+ {

661 
yylvÆ
.
°rög
 = 
yyãxt
;

662  
LDAP_ATTRIBUTE
;

665 <
°¨t_ld≠grou≤ame
>[^: \
t
\
n
]+[^\t\n]+ {

666 
yylvÆ
.
°rög
 = 
yyãxt
;

667  
LDAPGROUP_NAME
;

670 <
°¨t_ld≠£rvî«me
>[^: \
t
\
n
]+[^\t\n]+ {

671 
yylvÆ
.
°rög
 = 
yyãxt
;

672  
LDAPSERVER_NAME
;

675 <
°¨t_ld≠˚πfûe
>[^: \
t
\
n
]+ {

676 
yylvÆ
.
°rög
 = 
yyãxt
;

677  
LDAP_CERTFILE
;

680 <
°¨t_ld≠˚π∑th
>[^: \
t
\
n
]+ {

681 
yylvÆ
.
°rög
 = 
yyãxt
;

682  
LDAP_CERTPATH
;

685 <
°¨t_ld≠keyèb«me
>[^: \
t
\
n
]+ {

686 
yylvÆ
.
°rög
 = 
yyãxt
;

687  
LDAPKEYTABNAME
;

690 <
°¨t_ld≠keyèb«me
>
FILE
:[^ \
t
\
n
]+ {

691 
yylvÆ
.
°rög
 = 
yyãxt
;

692  
LDAPKEYTABNAME
;

695 <
°¨t_gsßpikeyèb«me
>[^: \
t
\
n
]+ {

696 
yylvÆ
.
°rög
 = 
yyãxt
;

697  
GSSAPIKEYTABNAME
;

700 <
°¨t_gsßpikeyèb«me
>
FILE
:[^ \
t
\
n
]+ {

701 
yylvÆ
.
°rög
 = 
yyãxt
;

702  
GSSAPIKEYTABNAME
;

705 <
°¨t_gsßpi£rvi˚«me
>[^: \
t
\
n
]+ {

706 
yylvÆ
.
°rög
 = 
yyãxt
;

707  
GSSAPISERVICENAME
;

710 <
löïªfix
>: {

711 
	`BEGIN
(
°¨t_löe
);

713 
yylvÆ
.
°rög
 = 
yyãxt
;

714  *
yyãxt
;

717 <
°¨t_löe
>.* {

718 
	`BEGIN
(0);

720 
yylvÆ
.
°rög
 = 
yyãxt
;

721  
LINE
;

724 <
°¨t_§cho°
>
nodnsmism©ch
 {

725 
yylvÆ
.
°rög
 = 
yyãxt
;

726  
NODNSMISMATCH
;

729 <
°¨t_§cho°
>
nodnsunknown
 {

730 
yylvÆ
.
°rög
 = 
yyãxt
;

731  
NODNSUNKNOWN
;

734 <
°¨t_§cho°
>
checkª∂yauth
 {

735 
yylvÆ
.
°rög
 = 
yyãxt
;

736  
CHECKREPLYAUTH
;

739 <
°¨t_¥Ÿocﬁ
>
t˝
 {

740 
yylvÆ
.
°rög
 = 
yyãxt
;

741  
PROTOCOL_TCP
;

744 <
°¨t_¥Ÿocﬁ
>
udp
 {

745 
yylvÆ
.
°rög
 = 
yyãxt
;

746  
PROTOCOL_UDP
;

749 <
°¨t_¥Ÿocﬁ
>
Áke
 {

750 
yylvÆ
.
°rög
 = 
yyãxt
;

751  
PROTOCOL_FAKE
;

754 <
°¨t_í¸y±i⁄
>
™y
 {

755 
yylvÆ
.
°rög
 = 
yyãxt
;

756  
GSSAPIENC_ANY
;

759 <
°¨t_í¸y±i⁄
>
˛ór
 {

760 
yylvÆ
.
°rög
 = 
yyãxt
;

761  
GSSAPIENC_CLEAR
;

764 <
°¨t_í¸y±i⁄
>
öãgrôy
 {

765 
yylvÆ
.
°rög
 = 
yyãxt
;

766  
GSSAPIENC_INTEGRITY
;

769 <
°¨t_í¸y±i⁄
>
c⁄fidítülôy
 {

770 
yylvÆ
.
°rög
 = 
yyãxt
;

771  
GSSAPIENC_CONFIDENTIALITY
;

774 <
°¨t_í¸y±i⁄
>
≥rmesßge
 {

775 
yylvÆ
.
°rög
 = 
yyãxt
;

776  
GSSAPIENC_PERMESSAGE
;

779 <
°¨t_ªÆm«me
>[^: \
t
\
n
]+ {

780 
yylvÆ
.
°rög
 = 
yyãxt
;

781  
REALNAME
;

784 <
°¨t_mëhod
>
n⁄e
 {

785 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_NONE
;

786  
METHODNAME
;

789 <
°¨t_mëhod
>
gsßpi
 {

790 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_GSSAPI
;

791  
METHODNAME
;

794 <
°¨t_mëhod
>
u£∫ame
 {

795 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_UNAME
;

796  
METHODNAME
;

799 <
°¨t_mëhod
>
rfc931
 {

800 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_RFC931
;

801  
METHODNAME
;

804 <
°¨t_mëhod
>
∑m
.
™y
 {

805 
yylvÆ
.
numbî
 = 
AUTHMETHOD_PAM_ANY
;

806  
METHODNAME
;

809 <
°¨t_mëhod
>
∑m
.
addªss
 {

810 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_PAM_ADDRESS
;

811  
METHODNAME
;

814 <
°¨t_mëhod
>
∑m
.
u£∫ame
 {

815 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_PAM_USERNAME
;

816  
METHODNAME
;

819 <
°¨t_mëhod
>
∑m
 {

820 
	`yyw¨nx_dïªˇãd
(
yyãxt
, "pam.*");

822 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_PAM_USERNAME
;

823  
METHODNAME
;

827 <
°¨t_mëhod
>
bsdauth
 {

828 
yylvÆ
.
mëhod
 = 
AUTHMETHOD_BSDAUTH
;

829  
METHODNAME
;

834 
eq
|=|
√
|!=|
ge
|>=|
À
|<=|
gt
|>|
…
|< {

835 
	`BEGIN
(
°¨t_£rvi˚«me
);

837 
yylvÆ
.
°rög
 = 
yyãxt
;

838  
OPERATOR
;

841 {
LS
}
˛õ¡
/[ ]+(
∑ss
|
block
) {

842 
ö˛õ¡ruÀ
 = 1;

844 
yylvÆ
.
°rög
 = 
yyãxt
;

845  
CLIENTRULE
;

848 {
LS
}
ho°id
/[ ]+(
∑ss
|
block
) {

849 
yylvÆ
.
°rög
 = 
yyãxt
;

850  
HOSTIDRULE
;

853 {
LS
}
socks
/[ ]+(
∑ss
|
block
) {

854 
yylvÆ
.
°rög
 = 
yyãxt
;

855  
SOCKSRULE
;

858 {
LS
}(
∑ss
|
block
) {

859 #
SOCKS_CLIENT


861 
	`yyîr‹x
("pass/blockÑulesáreÇot used inÅhe client");

864 
ﬁd
[256], 
√w
[256];

866 
	`¢¥ötf
(
ﬁd
, (ﬁd), "%s", 
yyãxt
);

867 
	`STRIPTRAILING
(
ﬁd
, 
	`°æí
(old), " \t");

869 
	`¢¥ötf
(
√w
, “ew), "sock†%s", 
ﬁd
);

871 
	`yyw¨nx_dïªˇãd
(
ﬁd
, 
√w
);

873 
	`yyÀss
(0);

875  
SOCKSRULE
;

877 #
ídif


881 
Æ¨m
.
d©a
 {

882 
yylvÆ
.
°rög
 = 
yyãxt
;

883  
ALARMTYPE_DATA
;

886 
Æ¨m
.
disc⁄√˘
 {

887 
yylvÆ
.
°rög
 = 
yyãxt
;

888  
ALARMTYPE_DISCONNECT
;

891 
Æ¨m
/\. {

892 
	`BEGIN
(
°¨t_Æ¨mã°
);

894 
yylvÆ
.
°rög
 = 
yyãxt
;

895  
ALARM
;

899 \.
ªcv
/[[:
•a˚
:]]*: {

900 
yylvÆ
.
°rög
 = 
yyãxt
;

901  
RECVSIDE
;

904 \.
£nd
/[[:
•a˚
:]]*: {

905 
yylvÆ
.
°rög
 = 
yyãxt
;

906  
SENDSIDE
;

909 
debug
 {

910 
yylvÆ
.
°rög
 = 
yyãxt
;

911  
DEBUGGING
;

914 {
LS
}
rouã
 {

915 
örouã
 = 1;

917 
yylvÆ
.
°rög
 = 
yyãxt
;

918  
ROUTE
;

921 
rouã
 {

922 
yylvÆ
.
°rög
 = 
yyãxt
;

923  
ROUTE
;

927 
rouã
\. {

928 
yylvÆ
.
°rög
 = 
yyãxt
;

929  
GLOBALROUTEOPTION
;

933 
maxÁû
 {

934 
yylvÆ
.
°rög
 = 
yyãxt
;

935  
MAXFAIL
;

938 
badexpúe
 {

939 
yylvÆ
.
°rög
 = 
yyãxt
;

940  
BADROUTE_EXPIRE
;

943 
ªsﬁvïrŸocﬁ
 {

944 
	`BEGIN
(
°¨t_¥Ÿocﬁ
);

946 
yylvÆ
.
°rög
 = 
yyãxt
;

947  
RESOLVEPROTOCOL
;

950 
§cho°
 {

951 
	`BEGIN
(
°¨t_§cho°
);

953 
yylvÆ
.
°rög
 = 
yyãxt
;

954  
SRCHOST
;

957 
¥oxy¥Ÿocﬁ
 {

958 
	`BEGIN
(
°¨t_¥oxy¥Ÿocﬁ
);

960 
yylvÆ
.
°rög
 = 
yyãxt
;

961  
PROXYPROTOCOL
;

964 
îr‹log
 {

965 
	`BEGIN
(
°¨t_logouçut
);

967 
yylvÆ
.
°rög
 = 
yyãxt
;

968  
ERRORLOG
;

971 
logouçut
 {

972 
	`BEGIN
(
°¨t_logouçut
);

974 
yylvÆ
.
°rög
 = 
yyãxt
;

975  
LOGOUTPUT
;

979 
¥Ÿocﬁ
 {

980 
	`BEGIN
(
°¨t_¥Ÿocﬁ
);

982 
yylvÆ
.
°rög
 = 
yyãxt
;

983  
PROTOCOL
;

986 
comm™d
 {

987 
	`BEGIN
(
°¨t_comm™d
);

989 
yylvÆ
.
°rög
 = 
yyãxt
;

990  
COMMAND
;

993 
udp
\.
p‹å™ge
 {

994 
yylvÆ
.
°rög
 = 
yyãxt
;

995  
UDPPORTRANGE
;

998 
udp
\.
c⁄√˘d°
 {

999 
yylvÆ
.
°rög
 = 
yyãxt
;

1000  
UDPCONNECTDST
;

1003 
ªdúe˘
 {

1004 
yylvÆ
.
°rög
 = 
yyãxt
;

1005  
REDIRECT
;

1008 
b™dwidth
 {

1009 
yylvÆ
.
°rög
 = 
yyãxt
;

1010  
BANDWIDTH
;

1013 
£ssi⁄
\.
max
 {

1014 
yylvÆ
.
°rög
 = 
yyãxt
;

1015  
SESSIONMAX
;

1018 
£ssi⁄
\.
öhîôabÀ
 {

1019 
yylvÆ
.
°rög
 = 
yyãxt
;

1020  
SESSION_INHERITABLE
;

1023 
£ssi⁄
\.
thrŸée
 {

1024 
yylvÆ
.
°rög
 = 
yyãxt
;

1025  
SESSIONTHROTTLE
;

1028 
£ssi⁄
\.
°©e
.
key
 {

1029 
	`BEGIN
(
°¨t_°©ekey
);

1031 
yylvÆ
.
°rög
 = 
yyãxt
;

1032  
SESSIONSTATE_KEY
;

1035 
£ssi⁄
\.
°©e
.
thrŸée
 {

1036 
yylvÆ
.
°rög
 = 
yyãxt
;

1037  
SESSIONSTATE_THROTTLE
;

1040 
£ssi⁄
\.
°©e
.
max
 {

1041 
yylvÆ
.
°rög
 = 
yyãxt
;

1042  
SESSIONSTATE_MAX
;

1046 
ö
 {

1047 
yylvÆ
.
°rög
 = 
yyãxt
;

1048  
WORD__IN
;

1051 
‰om
 {

1052 
	`BEGIN
(
°¨t_addªss
);

1054 
yylvÆ
.
°rög
 = 
yyãxt
;

1055  
FROM
;

1058 
to
 {

1059 
	`BEGIN
(
°¨t_addªss
);

1061 
yylvÆ
.
°rög
 = 
yyãxt
;

1062  
TO
;

1065 
vü
 {

1066 
	`BEGIN
(
°¨t_addªss
);

1068 
yylvÆ
.
°rög
 = 
yyãxt
;

1069  
VIA
;

1072 
yes
 {

1073 
yylvÆ
.
°rög
 = 
yyãxt
;

1074  
YES
;

1077 
no
 {

1078 
yylvÆ
.
°rög
 = 
yyãxt
;

1079  
NO
;

1082 
öã∫Æ
\./{
SOCKETLEVEL
}\. {

1083 
	`BEGIN
(
°¨t_sockë¥Ÿocﬁ
);

1085 
yylvÆ
.
°rög
 = 
yyãxt
;

1086  
INTERNALSOCKET
;

1089 
öã∫Æ
\./
Æ¨m
\. {

1090 
yylvÆ
.
°rög
 = 
yyãxt
;

1091  
ALARMIF_INTERNAL
;

1094 
öã∫Æ
\.
log
/\. {

1095 
	`BEGIN
(
°¨t_logÀvñ
);

1097 
yylvÆ
.
°rög
 = 
yyãxt
;

1098  
LOGIF_INTERNAL
;

1101 
öã∫Æ
\.
¥Ÿocﬁ
 {

1102 
	`BEGIN
(
°¨t_¥Ÿocﬁ
);

1104 
yylvÆ
.
°rög
 = 
yyãxt
;

1105  
INTERNAL_PROTOCOL
;

1109 
öã∫Æ
/[[:
•a˚
:]]*: {

1110 
	`BEGIN
(
°¨t_addªss
);

1112 
yylvÆ
.
°rög
 = 
yyãxt
;

1113  
INTERNAL
;

1117 
exã∫Æ
\./{
SOCKETLEVEL
}\. {

1118 
	`BEGIN
(
°¨t_sockë¥Ÿocﬁ
);

1120 
yylvÆ
.
°rög
 = 
yyãxt
;

1121  
EXTERNALSOCKET
;

1124 
exã∫Æ
\./
Æ¨m
\. {

1125 
yylvÆ
.
°rög
 = 
yyãxt
;

1126  
ALARMIF_EXTERNAL
;

1129 
exã∫Æ
\.
¥Ÿocﬁ
 {

1130 
	`BEGIN
(
°¨t_¥Ÿocﬁ
);

1132 
yylvÆ
.
°rög
 = 
yyãxt
;

1133  
EXTERNAL_PROTOCOL
;

1136 
exã∫Æ
\.
rŸ©i⁄
 {

1137 
yylvÆ
.
°rög
 = 
yyãxt
;

1138  
EXTERNAL_ROTATION
;

1141 
exã∫Æ
\.
log
/\. {

1142 
	`BEGIN
(
°¨t_logÀvñ
);

1144 
yylvÆ
.
°rög
 = 
yyãxt
;

1145  
LOGIF_EXTERNAL
;

1148 
exã∫Æ
/[[:
•a˚
:]]*: {

1149 
	`BEGIN
(
°¨t_addªss
);

1151 
yylvÆ
.
°rög
 = 
yyãxt
;

1152  
EXTERNAL
;

1155 
n⁄e
 {

1156 
yylvÆ
.
°rög
 = 
yyãxt
;

1157  
NONE
;

1160 
ßme
-same {

1161 
yylvÆ
.
°rög
 = 
yyãxt
;

1162  
SAMESAME
;

1166 
chûd
\.
maxidÀ
.*:.* {

1167 
	`yyw¨nx_dïªˇãd
(
yyãxt
, 
NULL
);

1170 
chûd
\.
maxªque°s
 {

1171 
yylvÆ
.
°rög
 = 
yyãxt
;

1172  
PROC_MAXREQUESTS
;

1176 
u£r
 {

1177 
	`BEGIN
(
°¨t_u£∫ame
);

1179 
yylvÆ
.
°rög
 = 
yyãxt
;

1180  
USER
;

1183 
group
 {

1184 
	`BEGIN
(
°¨t_grou≤ame
);

1186 
yylvÆ
.
°rög
 = 
yyãxt
;

1187  
GROUP
;

1190 
u£r
\.
¥ivûeged
 {

1191 
	`BEGIN
(
°¨t_u£∫ame
);

1193 
yylvÆ
.
°rög
 = 
yyãxt
;

1194  
USER_PRIVILEGED
;

1197 
u£r
\.
u≈rivûeged
|u£r\.
nŸ¥ivûeged
 {

1198 
	`BEGIN
(
°¨t_u£∫ame
);

1200 
yylvÆ
.
°rög
 = 
yyãxt
;

1201  
USER_UNPRIVILEGED
;

1204 
u£r
\.
libwøp
 {

1205 
	`BEGIN
(
°¨t_u£∫ame
);

1207 
yylvÆ
.
°rög
 = 
yyãxt
;

1208  
USER_LIBWRAP
;

1211 
timeout
\.
c⁄√˘
 {

1212 
yylvÆ
.
°rög
 = 
yyãxt
;

1213  
CONNECTTIMEOUT
;

1216 
timeout
\.
t˝_fö_waô
 {

1217 
yylvÆ
.
°rög
 = 
yyãxt
;

1218  
TCP_FIN_WAIT
;

1222 
timeout
\.
io
 {

1223 
yylvÆ
.
°rög
 = 
yyãxt
;

1224  
IOTIMEOUT
;

1227 
timeout
\.
io
\.
t˝
 {

1228 
yylvÆ
.
°rög
 = 
yyãxt
;

1229  
IOTIMEOUT_TCP
;

1232 
timeout
\.
io
\.
udp
 {

1233 
yylvÆ
.
°rög
 = 
yyãxt
;

1234  
IOTIMEOUT_UDP
;

1237 
timeout
\.
√gŸüã
 {

1238 
yylvÆ
.
°rög
 = 
yyãxt
;

1239  
NEGOTIATETIMEOUT
;

1243 
com∑tibûôy
 {

1244 
yylvÆ
.
°rög
 = 
yyãxt
;

1245  
COMPATIBILITY
;

1248 
ßmï‹t
 {

1249 
yylvÆ
.
°rög
 = 
yyãxt
;

1250  
SAMEPORT
;

1253 
dø·
-5.05 {

1254 
yylvÆ
.
°rög
 = 
yyãxt
;

1255  
DRAFT_5_05
;

1258 
˛õ¡com∑tibûôy
 {

1259 
yylvÆ
.
°rög
 = 
yyãxt
;

1260  
CLIENTCOMPATIBILITY
;

1263 
√cgsßpi
 {

1264 
yylvÆ
.
°rög
 = 
yyãxt
;

1265  
NECGSSAPI
;

1268 
exãnsi⁄
 {

1269 
yylvÆ
.
°rög
 = 
yyãxt
;

1270  
EXTENSION
;

1273 
böd
 {

1274 
yylvÆ
.
°rög
 = 
yyãxt
;

1275  
BIND
;

1278 
ho°id
 {

1279 
	`BEGIN
(
°¨t_addªss
);

1281 
yylvÆ
.
°rög
 = 
yyãxt
;

1282  
HOSTID
;

1285 
m⁄ô‹
 {

1286 
yylvÆ
.
°rög
 = 
yyãxt
;

1287  
MONITOR
;

1290 <
°¨t_°©ekey
,
INITIAL
>
ho°ödex
 {

1291 
	`BEGIN
(
°¨t_ho°ödex
);

1293 
yylvÆ
.
°rög
 = 
yyãxt
;

1294  
HOSTINDEX
;

1297 <
°¨t_ho°ödex
>
™y
 {

1298 
	`BEGIN
(0);

1300 
yylvÆ
.
numbî
 = 0;

1301  
NUMBER
;

1305 
socksmëhod
 {

1306 
	`BEGIN
(
°¨t_mëhod
);

1308 
yylvÆ
.
°rög
 = 
yyãxt
;

1309  
SOCKSMETHOD
;

1312 
˛õ¡mëhod
 {

1313 
	`BEGIN
(
°¨t_mëhod
);

1315 
yylvÆ
.
°rög
 = 
yyãxt
;

1316  
CLIENTMETHOD
;

1319 
mëhod
 {

1320 
	`BEGIN
(
°¨t_mëhod
);

1322 
yylvÆ
.
°rög
 = 
yyãxt
;

1324 i‡(
örouã
)

1325  
METHOD
;

1326 i‡(
ö˛õ¡ruÀ
) {

1327 
	`yyw¨nx_dïªˇãd
(
yyãxt
, "clientmethod");

1328  
CLIENTMETHOD
;

1331 
	`yyw¨nx_dïªˇãd
(
yyãxt
, "socksmethod");

1333  
SOCKSMETHOD
;

1343 
block
 {

1344 
yylvÆ
.
°rög
 = 
yyãxt
;

1345  
VERDICT_BLOCK
;

1348 
∑ss
 {

1349 
yylvÆ
.
°rög
 = 
yyãxt
;

1350  
VERDICT_PASS
;

1353 
log
/: {

1354 
	`BEGIN
(
°¨t_log
);

1356 
yylvÆ
.
°rög
 = 
yyãxt
;

1357  
RULE_LOG
;

1361 
libwøp
 {

1362 
	`BEGIN
(
löïªfix
);

1364 
yylvÆ
.
°rög
 = 
yyãxt
;

1365  
LIBWRAPSTART
;

1368 
libwøp
\.
Ælow
 {

1369 
	`BEGIN
(
°¨t_libwøpfûe
);

1371 
yylvÆ
.
°rög
 = 
yyãxt
;

1372  
LIBWRAP_ALLOW
;

1375 
libwøp
\.
díy
 {

1376 
	`BEGIN
(
°¨t_libwøpfûe
);

1378 
yylvÆ
.
°rög
 = 
yyãxt
;

1379  
LIBWRAP_DENY
;

1382 
libwøp
\.
ho°s_ac˚ss
 {

1383 
yylvÆ
.
°rög
 = 
yyãxt
;

1384  
LIBWRAP_HOSTS_ACCESS
;

1387 
∑m
\.
£rvi˚«me
|
∑m£rvi˚«me
 {

1388 
	`BEGIN
(
°¨t_£rvi˚«me
);

1390 
yylvÆ
.
°rög
 = 
yyãxt
;

1391  
PAMSERVICENAME
;

1394 
bsdauth
\.
°yÀ«me
 {

1395 
	`BEGIN
(
°¨t_bsdauth°yÀ«me
);

1397 
yylvÆ
.
°rög
 = 
yyãxt
;

1398  
BSDAUTHSTYLE
;

1401 
gsßpi
\.
£rvi˚«me
 {

1402 
	`BEGIN
(
°¨t_gsßpi£rvi˚«me
);

1404 
yylvÆ
.
°rög
 = 
yyãxt
;

1405  
GSSAPISERVICE
;

1408 
gsßpi
\.
keyèb
 {

1409 
	`BEGIN
(
°¨t_gsßpikeyèb«me
);

1411 
yylvÆ
.
°rög
 = 
yyãxt
;

1412  
GSSAPIKEYTAB
;

1415 
gsßpi
\.
í˘y≥
 {

1416 
	`BEGIN
(
°¨t_í¸y±i⁄
);

1418 
yylvÆ
.
°rög
 = 
yyãxt
;

1419  
GSSAPIENCTYPE
;

1422 
ld≠
\.
ba£dn
 {

1423 
	`BEGIN
(
°¨t_ld≠ba£dn
);

1425 
yylvÆ
.
°rög
 = 
yyãxt
;

1426  
LDAPBASEDN
;

1429 
ld≠
\.
ba£dn
\.
hex
 {

1430 
	`BEGIN
(
°¨t_ld≠ba£dn
);

1432 
yylvÆ
.
°rög
 = 
yyãxt
;

1433  
LDAPBASEDN_HEX
;

1436 
ld≠
\.
ba£dn
\.
hex
\.
Æl
 {

1437 
	`BEGIN
(
°¨t_ld≠ba£dn
);

1439 
yylvÆ
.
°rög
 = 
yyãxt
;

1440  
LDAPBASEDN_HEX_ALL
;

1443 
ld≠
\.
p‹t
 {

1444 
yylvÆ
.
°rög
 = 
yyãxt
;

1445  
LDAPPORT
;

1448 
ld≠
\.
p‹t
\.
s¶
 {

1449 
yylvÆ
.
°rög
 = 
yyãxt
;

1450  
LDAPPORTSSL
;

1453 
ld≠
\.
uæ
 {

1454 
	`BEGIN
(
°¨t_ld≠uæ
);

1456 
yylvÆ
.
°rög
 = 
yyãxt
;

1457  
LDAPURL
;

1460 
ld≠
\.
˚πfûe
 {

1461 
	`BEGIN
(
°¨t_ld≠˚πfûe
);

1463 
yylvÆ
.
°rög
 = 
yyãxt
;

1464  
LDAPCERTFILE
;

1467 
ld≠
\.
˚π∑th
 {

1468 
	`BEGIN
(
°¨t_ld≠˚π∑th
);

1470 
yylvÆ
.
°rög
 = 
yyãxt
;

1471  
LDAPCERTPATH
;

1474 
ld≠
\.
domaö
 {

1475 
	`BEGIN
(
°¨t_ld≠domaö
);

1477 
yylvÆ
.
°rög
 = 
yyãxt
;

1478  
LDAPDOMAIN
;

1481 
ld≠
\.
debug
 {

1482 
yylvÆ
.
°rög
 = 
yyãxt
;

1483  
LDAPDEBUG
;

1486 
ld≠
\.
mdïth
 {

1487 
yylvÆ
.
°rög
 = 
yyãxt
;

1488  
LDAPDEPTH
;

1491 
ld≠
\.
s¶
 {

1492 
yylvÆ
.
°rög
 = 
yyãxt
;

1493  
LDAPSSL
;

1496 
ld≠
\.auto\.
off
 {

1497 
yylvÆ
.
°rög
 = 
yyãxt
;

1498  
LDAPAUTO
;

1501 
ld≠
\.
˚πcheck
 {

1502 
yylvÆ
.
°rög
 = 
yyãxt
;

1503  
LDAPCERTCHECK
;

1506 
ld≠
\.
kì¥ólm
 {

1507 
yylvÆ
.
°rög
 = 
yyãxt
;

1508  
LDAPKEEPREALM
;

1511 
ld≠
\.
fûãr
 {

1512 
	`BEGIN
(
°¨t_ld≠fûãr
);

1514 
yylvÆ
.
°rög
 = 
yyãxt
;

1515  
LDAPFILTER
;

1518 
ld≠
\.
fûãr
\.
ad
 {

1519 
	`BEGIN
(
°¨t_ld≠fûãr
);

1521 
yylvÆ
.
°rög
 = 
yyãxt
;

1522  
LDAPFILTER_AD
;

1525 
ld≠
\.
fûãr
\.
hex
 {

1526 
	`BEGIN
(
°¨t_ld≠fûãr
);

1528 
yylvÆ
.
°rög
 = 
yyãxt
;

1529  
LDAPFILTER_HEX
;

1532 
ld≠
\.
fûãr
\.
ad
\.
hex
 {

1533 
	`BEGIN
(
°¨t_ld≠fûãr
);

1535 
yylvÆ
.
°rög
 = 
yyãxt
;

1536  
LDAPFILTER_AD_HEX
;

1539 
ld≠
\.
©åibuã
 {

1540 
	`BEGIN
(
°¨t_ld≠©åibuã
);

1542 
yylvÆ
.
°rög
 = 
yyãxt
;

1543  
LDAPATTRIBUTE
;

1546 
ld≠
\.
©åibuã
\.
ad
 {

1547 
	`BEGIN
(
°¨t_ld≠©åibuã
);

1549 
yylvÆ
.
°rög
 = 
yyãxt
;

1550  
LDAPATTRIBUTE_AD
;

1553 
ld≠
\.
©åibuã
\.
hex
 {

1554 
	`BEGIN
(
°¨t_ld≠©åibuã
);

1556 
yylvÆ
.
°rög
 = 
yyãxt
;

1557  
LDAPATTRIBUTE_HEX
;

1560 
ld≠
\.
©åibuã
\.
ad
\.
hex
 {

1561 
	`BEGIN
(
°¨t_ld≠©åibuã
);

1563 
yylvÆ
.
°rög
 = 
yyãxt
;

1564  
LDAPATTRIBUTE_AD_HEX
;

1567 
ld≠
\.
£rvî
 {

1568 
	`BEGIN
(
°¨t_ld≠£rvî«me
);

1570 
yylvÆ
.
°rög
 = 
yyãxt
;

1571  
LDAPSERVER
;

1574 
ld≠
\.
group
 {

1575 
	`BEGIN
(
°¨t_ld≠grou≤ame
);

1577 
yylvÆ
.
°rög
 = 
yyãxt
;

1578  
LDAPGROUP
;

1581 
ld≠
\.
group
\.
hex
 {

1582 
	`BEGIN
(
°¨t_ld≠grou≤ame
);

1584 
yylvÆ
.
°rög
 = 
yyãxt
;

1585  
LDAPGROUP_HEX
;

1588 
ld≠
\.
group
\.
hex
\.
Æl
 {

1589 
	`BEGIN
(
°¨t_ld≠grou≤ame
);

1591 
yylvÆ
.
°rög
 = 
yyãxt
;

1592  
LDAPGROUP_HEX_ALL
;

1595 
ld≠
\.
keyèb
 {

1596 
	`BEGIN
(
°¨t_ld≠keyèb«me
);

1598 
yylvÆ
.
°rög
 = 
yyãxt
;

1599  
LDAPKEYTAB
;

1602 
boun˚
 {

1603 
yylvÆ
.
°rög
 = 
yyãxt
;

1604  
BOUNCE
;

1607 
ªÆm
 {

1608 
	`BEGIN
(
°¨t_ªÆm«me
);

1610 
yylvÆ
.
°rög
 = 
yyãxt
;

1611  
REALM
;

1618 
loˇldomaö
.*:.* {

1619 
	`yyw¨nx_dïªˇãd
(
yyãxt
, 
NULL
);

1622 
c⁄√˘timeout
 {

1623 
	`yyw¨nx_dïªˇãd
(
yyãxt
, "timeout.connect");

1625 
yylvÆ
.
°rög
 = 
yyãxt
;

1626  
CONNECTTIMEOUT
;

1629 
iŸimeout
 {

1630 
	`yyw¨nx_dïªˇãd
(
yyãxt
, "timeout.io");

1632 
yylvÆ
.
°rög
 = 
yyãxt
;

1633  
IOTIMEOUT
;

1636 
sockë
.(
ªcvbuf
|
£ndbuf
).(
t˝
|
udp
) {

1637 
yylvÆ
.
dïªˇãd
.
ﬁd«me
 = 
yyãxt
;

1639 
yylvÆ
.
dïªˇãd
.
√w«me
 =

1645  
DEPRECATED
;

1655 <*>([0-9]|0x[
a
-
fA
-
F0
-9])+ {

1656 *
ï
;

1657 
ŒvÆ
;

1659 
î∫o
 = 0;

1660 
ŒvÆ
 = 
	`°πﬁl
(
yyãxt
, &
ï
, 0);

1661 i‡(*
yyãxt
 =
NUL
 || *
ï
 != NUL)

1662 
	`yyîr‹
("confusing. Thought we would haveáÇumber here");

1664 i‡(
î∫o
 =
ERANGE
)

1665 
	`yyîr‹
("number given is out ofÑange");

1667 
yylvÆ
.
numbî
 = 
ŒvÆ
;

1669 i‡(
	`shouldª£t°©e
(
YYSTATE
, 
NUMBER
))

1670 
	`BEGIN
(0);

1672  
NUMBER
;

1676 <*>[[:
bœnk
:]]+ {

1682 
	`BEGIN
(0);

1687 <*>\
n
 {

1688 
	`BEGIN
(0);

1692 <*>\\\
n
 {

1697 
ö˛õ¡ruÀ
 = 
örouã
 = 0;

1699 
yylvÆ
.
°rög
 = 
yyãxt
;

1700  *
yyãxt
;

1704 
yylvÆ
.
°rög
 = 
yyãxt
;

1705  *
yyãxt
;

1708 
	}
%%

1711 
	$shouldª£t°©e
(
cuºít_°©e
, 
√xt_tokí
)

1712 c⁄° 
cuºít_°©e
;

1713 c⁄° 
√xt_tokí
;

1715 
cuºít_°©e
) {

1716 
°¨t_ho°ödex
:

1717 
°¨t_scheduÀmask
:

1718 
°¨t_£rvi˚«me
:

1719 
√xt_tokí
) {

1720 
NUMBER
:

1727 
	}
}

	@lib/connectchild.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

70 
	#MOTHER
 (0Ë

	)

71 
	#CHILD
 (1Ë

	)

77 
	#MAXPACKETSQUEUED
 (10)

	)

79 
sigio
(
sig
, 
sigöfo_t
 *
sù
, *
s˝
);

80 
run_c⁄√˘chûd
(c⁄° 
mŸhî_d©a
, c⁄° 
mŸhî_ack
);

82 
siga˘i⁄
 
	g‹igöÆsig
;

83 vﬁ©ûê
sig_©omic_t
 
	gªqout°™dög
;

85 
rouã_t
 *

86 
	$socks_nbc⁄√˘rouã
(
s
, 
c⁄åﬁ
, 
∑ckë
, 
§c
, 
d°
, 
emsg
, 
emsgÀn
)

87 
s
;

88 
c⁄åﬁ
;

89 
socks_t
 *
∑ckë
;

90 c⁄° 
socksho°_t
 *
§c
, *
d°
;

91 *
emsg
;

92 c⁄° 
size_t
 
emsgÀn
;

94 c⁄° *
fun˘i⁄
 = "socks_nbconnectroute()";

95 
rouã_t
 *
rouã
;

96 
socksfd_t
 
socksfd
;

97 
chûd∑ckë_t
 
chûdªq
;

98 
siga˘i⁄
 
cuºítsig
, 
√wsig
;

99 
iovec
 
iov
[1];

100 
sockaddr_°‹age
 
loˇl
;

101 
msghdr
 
msg
;

102 
sockÀn_t
 
Àn
;

103 
size_t
 
fd£¡
;

104 
	`CMSG_AALLOC
(
cmsg
, (Ë* 
FDPASS_MAX
);

105 
§c°r
[
MAXSOCKSHOSTSTRING
], 
d°°r
[MAXSOCKSHOSTSTRING], *
p
;

106 
tmp
, 
Êags
, 
isourh™dÀr
;

108 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
s
);

110 i‡((
rouã
 = 
	`socks_gërouã
(&
∑ckë
->
ªq
, 
§c
, 
d°
)Ë=
NULL
) {

111 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "noÑoute from %sÅo %s found",

112 
§c
 =
NULL
 ?

113 "<™y>" : 
	`socksho°2°rög
(
§c
, 
§c°r
, (srcstr)),

114 
d°
 =
NULL
 ?

115 "<™y>" : 
	`socksho°2°rög
(
d°
, 
d°°r
, (dststr)));

117 
î∫o
 = 
ENETUNREACH
;

118  
NULL
;

121 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
)

122  
rouã
;

124 i‡(
	`siga˘i⁄
(
SIGIO
, 
NULL
, &
cuºítsig
) != 0) {

125 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot install signal handler for SIGIO: %s",

126 
	`°ªº‹
(
î∫o
));

128 
	`sw¨n
("%s: %s", 
fun˘i⁄
, 
emsg
);

129  
NULL
;

132 i‡(
cuºítsig
.
ß_Êags
 & 
SA_SIGINFO
) {

133 
isourh™dÀr
 = (
cuºítsig
.
ß_siga˘i⁄
 =
sigio
);

135 i‡(!
isourh™dÀr
) {

136 i‡(
cuºítsig
.
ß_siga˘i⁄
 =
NULL
) {

137 
	`¶og
(
LOG_NOTICE
,

140 
fun˘i⁄
, 
cuºítsig
.
ß_Êags
);

143 
	`¶og
(
LOG_NOTICE
, "%s:á SIGIO sa_sigaction isálready installed, "

145 
fun˘i⁄
);

149 
isourh™dÀr
 = 0;

151 i‡(
cuºítsig
.
ß_h™dÀr
 !
SIG_IGN


152 && 
cuºítsig
.
ß_h™dÀr
 !
SIG_DFL
)

153 
	`¶og
(
LOG_NOTICE
,

154 "%s:á h™dÀ∏i†ö°ÆÀd, buàô'†nŸ our†...", 
fun˘i⁄
);

156 
	`¶og
(
LOG_DEBUG
,

157 "%s:ÇÿSIGIO h™dÀ∏¥eviou¶y in°ÆÀd", 
fun˘i⁄
);

160 i‡(!
isourh™dÀr
) {

161 
√wsig
 = 
cuºítsig
;

162 
√wsig
.
ß_siga˘i⁄
 = 
sigio
;

163 
√wsig
.
ß_Êags
 |
SA_SIGINFO
;

165 
	`¶og
(
LOG_DEBUG
, "%s: our signal handler isÇot installed, installing ...",

166 
fun˘i⁄
);

168 
‹igöÆsig
 = 
cuºítsig
;

170 i‡(
	`siga˘i⁄
(
SIGIO
, &
√wsig
, 
NULL
) != 0) {

171 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

173 
	`°ªº‹
(
î∫o
));

175 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

176  
NULL
;

180 
	`¶og
(
LOG_DEBUG
, "%s: ou∏sig«»h™dÀ∏Æªady in°ÆÀd", 
fun˘i⁄
);

182 i‡(
sockscf
.
c⁄√˘chûd
 == 0) {

186 
d©≠ùev
[2], 
ackpùev
[2];

187 
¢dbuf
, 
¢dbuf_£t
, 
rcvbuf
, 
rcvbuf_£t
;

188 
sockÀn_t
 
›éí
;

191 i‡(
	`sockë∑ú
(
AF_LOCAL
, 
SOCK_DGRAM
, 0, 
d©≠ùev
) != 0) {

192 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "socketpair(AF_LOCAL, SOCK_DGRAM) failed: %s",

193 
	`°ªº‹
(
î∫o
));

195 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

196  
NULL
;

199 
	`¶og
(
LOG_DEBUG
, "%s: socketpair(SOCK_DGRAM)Ñeturned %d, %d",

200 
fun˘i⁄
, 
d©≠ùev
[0], datapipev[1]);

202 i‡(
	`sockë∑ú
(
AF_LOCAL
, 
SOCK_STREAM
, 0, 
ackpùev
) != 0) {

203 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "socketpair(AF_LOCAL, SOCK_STREAM) failed: %s",

204 
	`°ªº‹
(
î∫o
));

206 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

207  
NULL
;

210 
	`¶og
(
LOG_DEBUG
, "%s: socketpair(SOCK_STREAM)Ñeturned %d, %d",

211 
fun˘i⁄
, 
ackpùev
[0],áckpipev[1]);

213 
p
 = "pipe between motheránd connect-child";

214 i‡(
	`£ä⁄blockög
(
d©≠ùev
[0], 
p
) == -1

215 || 
	`£ä⁄blockög
(
d©≠ùev
[1], 
p
) == -1

216 || 
	`£ä⁄blockög
(
ackpùev
[0], 
p
) == -1

217 || 
	`£ä⁄blockög
(
ackpùev
[1], 
p
) == -1) {

218 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot set %sÇon-blocking: %s",

219 
p
, 
	`°ªº‹
(
î∫o
));

221 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

222  
NULL
;

225 
rcvbuf
 = ((
chûd∑ckë_t
)

226 + (
msghdr
)

227 + 
	`CMSG_SPACE
((Ë* 
FDPASS_MAX
)

228 + 
SENDMSG_PADBYTES
);

229 #i‡
HAVE_GSSAPI


230 
rcvbuf
 +
MAX_GSS_STATE
 + (
iovec
);

233 
¢dbuf
 = 
rcvbuf
 * (
MAXPACKETSQUEUED
 + 1 );

235 i‡(
HAVE_PIPEBUFFER_RECV_BASED
) {

240 c⁄° 
size_t
 
tmp
 = 
¢dbuf
;

241 
¢dbuf
 = 
rcvbuf
;

242 
rcvbuf
 = 
tmp
;

244 i‡(
HAVE_PIPEBUFFER_UNKNOWN
) {

245 
rcvbuf
 = 
	`MAX
(
¢dbuf
,Ñcvbuf);

246 
¢dbuf
 = 
	`MAX
(¢dbuf, 
rcvbuf
);

249 
›éí
 = (
¢dbuf
);

250 i‡(
	`£tsock›t
(
d©≠ùev
[
MOTHER
],

251 
SOL_SOCKET
,

252 
SO_SNDBUF
,

253 &
¢dbuf
,

254 
›éí
) != 0

255 || 
	`£tsock›t
(
d©≠ùev
[
CHILD
],

256 
SOL_SOCKET
,

257 
SO_SNDBUF
,

258 &
¢dbuf
,

259 
›éí
) != 0

260 || 
	`£tsock›t
(
d©≠ùev
[
MOTHER
],

261 
SOL_SOCKET
,

262 
SO_RCVBUF
,

263 &
rcvbuf
,

264 
›éí
) != 0

265 || 
	`£tsock›t
(
d©≠ùev
[
CHILD
],

266 
SOL_SOCKET
,

267 
SO_RCVBUF
,

268 &
rcvbuf
,

269 
›éí
) != 0) {

270 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

272 
¢dbuf
, 
rcvbuf
, 
p
, 
	`°ªº‹
(
î∫o
));

274 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

275  
NULL
;

278 
›éí
 = (
¢dbuf_£t
);

279 i‡(
	`gësock›t
(
d©≠ùev
[
MOTHER
],

280 
SOL_SOCKET
,

281 
SO_SNDBUF
,

282 &
¢dbuf_£t
,

283 &
›éí
) == -1

284 || 
	`gësock›t
(
d©≠ùev
[
CHILD
],

285 
SOL_SOCKET
,

286 
SO_RCVBUF
,

287 &
rcvbuf_£t
,

288 &
›éí
) == -1) {

289 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

291 
p
, 
	`°ªº‹
(
î∫o
));

293 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

294  
NULL
;

297 i‡(
¢dbuf_£t
 < 
¢dbuf
 || 
rcvbuf_£t
 < 
rcvbuf
) {

298 
	`sw¨nx
("%s: couldÇot set SNDBUF/motheránd RCVBUF/child "

301 
fun˘i⁄
, 
p
, 
¢dbuf
, 
rcvbuf
, 
¢dbuf_£t
, 
rcvbuf_£t
);

306 
	`¶og
(
LOG_DEBUG
,

309 
fun˘i⁄
, 
p
, 
¢dbuf
, 
rcvbuf
, 
¢dbuf_£t
, 
rcvbuf_£t
);

311 
›éí
 = (
rcvbuf_£t
);

312 i‡(
	`gësock›t
(
d©≠ùev
[
MOTHER
],

313 
SOL_SOCKET
,

314 
SO_RCVBUF
,

315 &
rcvbuf_£t
,

316 &
›éí
) == -1

317 || 
	`gësock›t
(
d©≠ùev
[
CHILD
],

318 
SOL_SOCKET
,

319 
SO_SNDBUF
,

320 &
¢dbuf_£t
,

321 &
›éí
) == -1) {

322 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

324 
p
, 
	`°ªº‹
(
î∫o
));

326 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

327  
NULL
;

330 i‡(
¢dbuf_£t
 < 
¢dbuf
 || 
rcvbuf_£t
 < 
rcvbuf
) {

331 
	`sw¨nx
("%s: couldÇot set SNDBUF/childánd RCVBUF/mother on %s"

333 
fun˘i⁄
, 
p
, 
¢dbuf
, 
rcvbuf
, 
¢dbuf_£t
, 
rcvbuf_£t
);

338 
	`¶og
(
LOG_DEBUG
,

341 
fun˘i⁄
, 
p
, 
¢dbuf
, 
rcvbuf
, 
¢dbuf_£t
, 
rcvbuf_£t
);

343 
sockscf
.
c⁄√˘chûd
 = 
	`f‹k
()) {

345 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "f‹k(2ËÁûed: %s", 
	`°ªº‹
(
î∫o
));

347 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

348  
NULL
;

351 
size_t
 
max
;

352 
i
;

354 
	`¶og
(
LOG_INFO
,

356 
fun˘i⁄
, ()
	`gëpid
(), ()
	`gëµid
());

359 
i
 = 0, 
max
 = 
	`gëmaxofûes
(
so·limô
); i < ()max; ++i)

360 i‡(
	`socks_logm©ch
(
i
, &
sockscf
.
log
)

361 || 
	`socks_logm©ch
(
i
, &
sockscf
.
îæog
)

362 || 
i
 =
d©≠ùev
[
CHILD
]

363 || 
i
 =
ackpùev
[
CHILD
]

364 || 
	`FD_IS_RESERVED_EXTERNAL
(
i
))

366 i‡(
	`ißây
(
i
))

369 
	`˛o£
(
i
);

371 
	`√w¥ocöô
();

373 
	`run_c⁄√˘chûd
(
d©≠ùev
[
CHILD
], 
ackpùev
[CHILD]);

379 
	`¶og
(
LOG_INFO
, "%s: connectchild forked withÖid %lu",

380 
fun˘i⁄
, ()
sockscf
.
c⁄√˘chûd
);

382 
sockscf
.
chûd_d©a
 = 
d©≠ùev
[
MOTHER
];

383 
sockscf
.
chûd_ack
 = 
ackpùev
[
MOTHER
];

385 
	`˛o£
(
d©≠ùev
[
CHILD
]);

386 
	`˛o£
(
ackpùev
[
CHILD
]);

388 i‡(
	`f˙é
(
sockscf
.
chûd_d©a
, 
F_SETOWN
, 
	`gëpid
()) == -1

389 || 
	`f˙é
(
sockscf
.
chûd_ack
, 
F_SETOWN
, 
	`gëpid
()) == -1)

390 
	`£º
("%s: f˙é(F_SETOWN)", 
fun˘i⁄
);

392 i‡((
Êags
 = 
	`f˙é
(
sockscf
.
chûd_d©a
, 
F_GETFL
, 0)) == -1

393 || 
	`f˙é
(
sockscf
.
chûd_d©a
, 
F_SETFL
, 
Êags
 | 
FASYNC
) == -1

394 || 
	`f˙é
(
sockscf
.
chûd_ack
, 
F_SETFL
, 
Êags
 | 
FASYNC
) == -1)

395 
	`£º
("%s: f˙é(F_SETFL, FASYNC)", 
fun˘i⁄
);

415 
	`SASSERTX
(
c⁄åﬁ
 =
s
);

416 i‡((
c⁄åﬁ
 = 
	`makedummyfd
(
AF_INET
, 
SOCK_STREAM
)) == -1) {

417 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

420 
	`socksho°2°rög
(
d°
, 
NULL
, 0), 
	`°ªº‹
(
î∫o
));

422 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

423  
NULL
;

426 i‡(
	`sockë›tdup
(
s
, 
c⁄åﬁ
) == -1) {

427 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

430 
	`socksho°2°rög
(
d°
, 
NULL
, 0), 
	`°ªº‹
(
î∫o
));

432 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

434 
	`˛o£
(
c⁄åﬁ
);

435  
NULL
;

438 #i‡
HAVE_GSSAPI


439 i‡(
	`socks_Ælocbuf„r
(
s
, 
SOCK_STREAM
Ë=
NULL
) {

440 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "socks_allocbuffer() failed: %s",

441 
	`°ªº‹
(
î∫o
));

443 
	`˛o£
(
c⁄åﬁ
);

445 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

446  
NULL
;

450 i‡((
tmp
 = 
	`dup
(
s
)) == -1) {

451 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

452 "couldÇŸ dup(2Ëd©a-fd %d: %s", 
s
, 
	`°ªº‹
(
î∫o
));

454 
	`˛o£
(
c⁄åﬁ
);

456 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

457  
NULL
;

460 i‡(
	`dup2
(
c⁄åﬁ
, 
s
) == -1) {

461 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot dup2(2) control-fd %d: %s",

462 
c⁄åﬁ
, 
	`°ªº‹
(
î∫o
));

464 
	`˛o£
(
c⁄åﬁ
);

465 
	`˛o£
(
tmp
);

467 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

468  
NULL
;

475 
	`˛o£
(
c⁄åﬁ
);

476 
c⁄åﬁ
 = 
tmp
;

478 
	`¶og
(
LOG_DEBUG
,

480 
fun˘i⁄
, 
s
, 
c⁄åﬁ
);

489 
	`socks_rmaddr
(
c⁄åﬁ
, 1);

491 
	`bzîo
(&
socksfd
, (socksfd));

492 i‡((
socksfd
.
rouã
 = 
	`socks_c⁄√˘rouã
(
c⁄åﬁ
,

493 
∑ckë
,

494 
§c
,

495 
d°
,

496 
emsg
,

497 
emsgÀn
)Ë=
NULL
) {

498 
	`˛o£
(
c⁄åﬁ
);

499  
NULL
;

502 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
)

503  
rouã
;

510 
Àn
 = (
loˇl
);

511 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
loˇl
), &
Àn
) != 0) {

512 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "getsockname(2) on control-fd %d failed: %s",

513 
s
, 
	`°ªº‹
(
î∫o
));

515 
	`˛o£
(
c⁄åﬁ
);

517 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

518  
NULL
;

521 i‡(!
	`PORTISBOUND
(
	`TOIN
(&
loˇl
))) {

522 
	`bzîo
(&
loˇl
, (local));

526 
Àn
 = (
loˇl
);

527 i‡(
	`gësock«me
(
c⁄åﬁ
, 
	`TOSA
(&
loˇl
), &
Àn
) != 0) {

528 
√w_c⁄åﬁ
;

530 
	`socks_bœckli°
(
socksfd
.
rouã
, 
	`°ªº‹
(
î∫o
));

532 i‡((
√w_c⁄åﬁ
 = 
	`sockë›tdup
(
c⁄åﬁ
, -1)) == -1) {

533 
	`˛o£
(
c⁄åﬁ
);

535 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot dup(2) control socket: %s",

536 
	`°ªº‹
(
î∫o
));

538 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

539  
NULL
;

542 
∑ckë
->
ªq
.
vîsi⁄
) {

543 
PROXY_SOCKS_V4
:

544 
PROXY_SOCKS_V5
:

545 
PROXY_HTTP_10
:

546 
PROXY_HTTP_11
:

547 
PROXY_UPNP
:

548 
	`˛o£
(
c⁄åﬁ
);

549 
c⁄åﬁ
 = 
s
;

553 
	`SERRX
(
∑ckë
->
ªq
.
vîsi⁄
);

556 i‡(
	`dup2
(
√w_c⁄åﬁ
, 
c⁄åﬁ
) != -1) {

557 
	`˛o£
(
√w_c⁄åﬁ
);

560  
	`socks_nbc⁄√˘rouã
(
s
,

561 
c⁄åﬁ
,

562 
∑ckë
,

563 
§c
,

564 
d°
,

565 
emsg
,

566 
emsgÀn
);

569 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot dup2(2) control-fd %d: %s",

570 
c⁄åﬁ
, 
	`°ªº‹
(
î∫o
));

572 
	`˛o£
(
√w_c⁄åﬁ
);

574 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

575  
NULL
;

578 
	`SASSERTX
(
	`PORTISBOUND
(
	`TOIN
(&
loˇl
)));

579 
	`TOIN
(&
loˇl
)->
sö_p‹t
 = 
	`ht⁄s
(0);

581 i‡(
	`socks_böd
(
s
, 
	`TOSS
(&
loˇl
), 0) != 0) {

582 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

584 
	`sockaddr2°rög
(&
loˇl
, 
NULL
, 0), 
s
, 
	`°ªº‹
(
î∫o
));

586 
	`˛o£
(
c⁄åﬁ
);

588 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

589  
NULL
;

593 
Àn
 = (
socksfd
.
loˇl
);

594 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), &
Àn
) != 0)

595 
	`SERR
(
s
);

601 
socksfd
.
c⁄åﬁ
 = control;

602 
socksfd
.
°©e
.
comm™d
 = 
∑ckë
->
ªq
.command;

603 
socksfd
.
°©e
.
vîsi⁄
 = 
∑ckë
->
ªq
.version;

604 
socksfd
.
°©e
.
¥Ÿocﬁ
.
t˝
 = 1;

605 
socksfd
.
°©e
.
ö¥ogªss
 = 1;

606 
socksfd
.
f‹us
.
c⁄√˘ed
 = 
∑ckë
->
ªq
.
ho°
;

608 
	`¶og
(
LOG_DEBUG
, "%s:Ñegistering with socks_addaddr() using fd %d",

609 
fun˘i⁄
, 
s
);

615 
	`socks_addaddr
(
s
, &
socksfd
, 1);

623 
fd£¡
 = 0;

624 
	`CMSG_ADDOBJECT
(
c⁄åﬁ
, 
cmsg
, (c⁄åﬁË* 
fd£¡
++);

626 
∑ckë
->
ªq
.
vîsi⁄
) {

627 
PROXY_SOCKS_V4
:

628 
PROXY_SOCKS_V5
:

629 
PROXY_HTTP_10
:

630 
PROXY_HTTP_11
:

631 
PROXY_UPNP
:

635 
	`SERRX
(
∑ckë
->
ªq
.
vîsi⁄
);

638 
	`bzîo
(&
chûdªq
, (childreq));

639 
chûdªq
.
s
 = s;

640 
chûdªq
.
∑ckë
 = *packet;

642 
iov
[0].
iov_ba£
 = &
chûdªq
;

643 
iov
[0].
iov_Àn
 = (
chûdªq
);

644 
Àn
 = (
chûdªq
);

646 
	`bzîo
(&
msg
, (msg));

647 
msg
.
msg_iov
 = 
iov
;

648 
msg
.
msg_iovÀn
 = 
	`ELEMENTS
(
iov
);

649 
msg
.
msg_«me
 = 
NULL
;

650 
msg
.
msg_«mñí
 = 0;

653 
	`CMSG_SETHDR_SEND
(
msg
, 
cmsg
, (Ë* 
fd£¡
);

655 
	`¶og
(
LOG_INFO
,

658 
fun˘i⁄
,

659 ()
Àn
,

660 ()
	`CMSG_TOTLEN
(
msg
),

661 ()
ªqout°™dög
);

663 i‡(
	`£ndmsgn
(
sockscf
.
chûd_d©a
, &
msg
, 0, -1Ë!(
ssize_t
)
Àn
) {

664 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

665 "couldÇŸ síd clõ¡Åÿc⁄√˘-chûd: %s", 
	`°ªº‹
(
î∫o
));

667 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

668  
NULL
;

671 ++
ªqout°™dög
;

672  
socksfd
.
rouã
;

673 
	}
}

680 
	$run_c⁄√˘chûd
(
mŸhî_d©a
, 
mŸhî_ack
)

681 c⁄° 
mŸhî_d©a
;

682 c⁄° 
mŸhî_ack
;

684 c⁄° *
fun˘i⁄
 = "run_connectchild()";

685 
fd_£t
 *
r£t
, *
w£t
;

686 #i‡
HAVE_GSSAPI


687 
gss_buf„r_desc
 
gsßpi°©e
;

688 
gsßpi°©emem
[
MAX_GSS_STATE
];

690 
ssize_t
 
p
;

691 
fdex≥˘
, 
fdbôs
;

693 
	`¶og
(
LOG_DEBUG
, "%s: data %d,áck %d",

694 
fun˘i⁄
, 
mŸhî_d©a
, 
mŸhî_ack
);

697 
	`¶ìp
(20);

700 
	`SASSERTX
(
sockscf
.
°©e
.
ösig«l
 == 0);

702 
	`£çro˘ôÀ
("connectchild");

704 #i‡
HAVE_GSSAPI


705 
gsßpi°©e
.
vÆue
 = 
gsßpi°©emem
;

706 
gsßpi°©e
.
Àngth
 = (
gsßpi°©emem
);

709 
r£t
 = 
	`Æloˇã_maxsize_fd£t
();

710 
w£t
 = 
	`Æloˇã_maxsize_fd£t
();

715 
msghdr
 
msg
;

716 
size_t
 
msgÀn
;

717 
iovec
 
iov
[2];

719 
chûd∑ckë_t
 
ªq
;

720 #i‡
HAVE_GSSAPI


721 
gssd©a
[
MAX_GSS_STATE
];

724 #i‡
HAVE_CMSGHDR


727 
cmsgmem
[
	`CMSG_SPACE
((Ë* 
FDPASS_MAX
 )];

728 
cmsghdr
 
Æign
;

729 } 
cmsgd©a
;

733 
cmsgd©a
[
	`CMSG_SPACE
((Ë* 
FDPASS_MAX
 )];

736 } *
föishedv
;

738 
size_t
 
föishedc
;

739 
w£t_is£t
;

741 
î∫o
 = 0;

743 
	`FD_ZERO
(
r£t
);

744 
	`FD_SET
(
mŸhî_d©a
, 
r£t
);

745 
	`FD_SET
(
mŸhî_ack
, 
r£t
);

746 
fdbôs
 = 
	`MAX
(
mŸhî_d©a
, 
mŸhî_ack
);

748 i‡(
föishedc
 > 0) {

749 
	`¶og
(
LOG_DEBUG
,

751 
fun˘i⁄
, ()
föishedc
);

753 
	`FD_ZERO
(
w£t
);

754 
	`FD_SET
(
mŸhî_d©a
, 
w£t
);

756 
fdbôs
 = 
	`MAX
(fdbôs, 
mŸhî_d©a
);

757 
w£t_is£t
 = 1;

760 
w£t_is£t
 = 0;

762 ++
fdbôs
;

764 
	`£À˘n
(
fdbôs
,

765 
r£t
,

766 
w£t_is£t
 ? 
w£t
 : 
NULL
,

767 
NULL
,

768 
NULL
,

769 
NULL
,

770 
NULL
)) {

772 i‡(
î∫o
 =
EINTR
)

775 
	`SERR
(-1);

779 i‡(
	`FD_ISSET
(
mŸhî_ack
, 
r£t
)) {

780 
buf
[256];

782 (
p
 = 
	`ªad
(
mŸhî_ack
, 
buf
, (buf)))) {

784 
	`¶og
(
LOG_INFO
, "%s:Ñead(): motherÉxited: %s",

785 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

787 
	`_exô
(
EXIT_SUCCESS
);

791 
	`¶og
(
LOG_INFO
, "%s:Ñód(): mŸhî clo£d", 
fun˘i⁄
);

792 
	`_exô
(
EXIT_SUCCESS
);

796 
	`SERRX
(
p
);

800 i‡(
	`FD_ISSET
(
mŸhî_d©a
, 
w£t
)) {

805 
föishedc
 > 0) {

806 i‡(
	`£ndmsgn
(
mŸhî_d©a
, &
föishedv
[
föishedc
 - 1].
msg
, 0, 0)

808 
	`¶og
(
LOG_DEBUG
,

809 "%s: faûedÅÿ£ndÑe•⁄£ÅÿmŸhî,ágaö", 
fun˘i⁄
);

813 --
föishedc
;

817 i‡(
	`FD_ISSET
(
mŸhî_d©a
, 
r£t
)) {

823 
chûd∑ckë_t
 
ªq
;

824 
iovec
 
iov
[2];

825 
sockÀn_t
 
Àn
;

826 
size_t
 
to£nd
, 
fd£¡
;

827 
sockaddr_°‹age
 
loˇl
, 
ªmŸe
;

828 
msghdr
 
msg
;

829 
timevÆ
 
tvÆ
 = { 
sockscf
.
timeout
.
c⁄√˘
, ()0 };

830 
d©a
, 
c⁄åﬁ
, 
ioc
, 
Êags
, 
ßvedf‹œãr
;

831 
	`CMSG_AALLOC
(
cmsg
, (Ë* 
FDPASS_MAX
);

833 
ioc
 = 0;

834 
	`bzîo
(
iov
, (iov));

835 
iov
[
ioc
].
iov_ba£
 = &
ªq
;

836 
iov
[
ioc
].
iov_Àn
 = (
ªq
);

837 
Àn
 = 
iov
[
ioc
].
iov_Àn
;

838 ++
ioc
;

840 
	`bzîo
(&
msg
, (msg));

841 
msg
.
msg_iov
 = 
iov
;

842 
msg
.
msg_iovÀn
 = 
ioc
;

843 
msg
.
msg_«me
 = 
NULL
;

844 
msg
.
msg_«mñí
 = 0;

846 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

847 i‡((
p
 = 
	`ªcvmsgn
(
mŸhî_d©a
, &
msg
, 0)Ë!(
ssize_t
)
Àn
) {

848 
p
) {

850 
	`¶og
(
LOG_INFO
, "%s:Ñecvmsgn() failed: %s",

851 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

855 
	`¶og
(
LOG_INFO
, "%s:Ñecvmsg(): mŸhî clo£d", 
fun˘i⁄
);

856 
	`_exô
(
EXIT_SUCCESS
);

860 
	`sw¨n
("%s:Ñecvmsg(): got %ld of %ld",

861 
fun˘i⁄
, ()
p
, ()
Àn
);

867 
	`¶og
(
LOG_DEBUG
,

869 
fun˘i⁄
, ()
p
, ()
	`CMSG_TOTLEN
(
msg
));

871 i‡(
	`socks_msgha£º‹s
(
fun˘i⁄
, &
msg
))

875 
ªq
.
∑ckë
.ªq.
vîsi⁄
) {

876 
PROXY_SOCKS_V4
:

877 
PROXY_SOCKS_V5
:

878 
PROXY_HTTP_10
:

879 
PROXY_HTTP_11
:

880 
PROXY_UPNP
:

881 
fdex≥˘
 = 1;

885 
	`SERRX
(
ªq
.
∑ckë
.ªq.
vîsi⁄
);

888 i‡(!
	`CMSG_RCPTLEN_ISOK
(
msg
, (Ë* 
fdex≥˘
)) {

889 
	`sw¨nx
("%s:Ñeceived control message hasÅhe invalidÜen of %d",

890 
fun˘i⁄
, ()
	`CMSG_TOTLEN
(
msg
));

895 
	`SASSERTX
(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET
);

896 
	`SASSERTX
(
cmsg
->
cmsg_ty≥
 =
SCM_RIGHTS
);

898 
Àn
 = 0;

899 
	`CMSG_GETOBJECT
(
c⁄åﬁ
, 
cmsg
, (c⁄åﬁË* 
Àn
++);

901 
ªq
.
∑ckë
.ªq.
vîsi⁄
) {

902 
PROXY_SOCKS_V4
:

903 
PROXY_SOCKS_V5
:

904 
PROXY_HTTP_10
:

905 
PROXY_HTTP_11
:

906 
PROXY_UPNP
:

907 
d©a
 = 
c⁄åﬁ
;

911 
	`SERRX
(
ªq
.
∑ckë
.ªq.
vîsi⁄
);

914 
	`¶og
(
LOG_DEBUG
, "%s: controlfd %d, datafd %d,Ñeq.s fd %d",

915 
fun˘i⁄
, 
c⁄åﬁ
, 
d©a
, 
ªq
.
s
);

922 i‡(
ªq
.
∑ckë
.ªq.
vîsi⁄
 =
PROXY_SOCKS_V4
)

923 
ªq
.
∑ckë
.
ªs
.
vîsi⁄
 = 
PROXY_SOCKS_V4REPLY_VERSION
;

925 
ªq
.
∑ckë
.
ªs
.
vîsi⁄
 =Ñeq.packet.req.version;

927 
	`socks_£t_ª•⁄£vÆue
(&
ªq
.
∑ckë
.
ªs
,

928 
	`sockscode
(
ªq
.
∑ckë
.
ªs
.
vîsi⁄
,

929 
SOCKS_FAILURE
));

931 
ªq
.
∑ckë
.ªq.
auth
 = &ªq.∑ckë.
°©e
.auth;

932 
ªq
.
∑ckë
.ªq.
auth
->
mëhod
 = 
AUTHMETHOD_NOTSET
;

939 
Êags
 = 
	`£tblockög
(
c⁄åﬁ
, "socket used forÖroxyÇegotiation");

941 
î∫o
 = 0;

943 
Àn
 = (
loˇl
);

944 i‡((
p
 = 
	`gësock«me
(
c⁄åﬁ
, 
	`TOSA
(&
loˇl
), &
Àn
)) == 0

945 && 
	`ADDRISBOUND
(&
loˇl
)) {

946 
	`¶og
(
LOG_DEBUG
, "%s: controlÜocal: %s",

947 
fun˘i⁄
, 
	`sockaddr2°rög
(&
loˇl
, 
NULL
, 0));

965 
	`¶og
(
LOG_INFO
, "%s: waôög f‹ c⁄√˘Ñe•⁄£ ...", 
fun˘i⁄
);

967 
	`FD_ZERO
(
w£t
);

968 
	`FD_SET
(
c⁄åﬁ
, 
w£t
);

969 
	`£À˘n
(
c⁄åﬁ
 + 1,

970 
NULL
,

971 
NULL
,

972 
NULL
,

973 
w£t
,

974 
NULL
,

975 
sockscf
.
timeout
.
c⁄√˘
 =0 ? 
NULL
 : &
tvÆ
)) {

977 i‡(
î∫o
 =
EINTR
)

980 
	`SERR
(-1);

984 
	`sw¨nx
("%s: select(2)Åimed out waiting for connect(2)",

985 
fun˘i⁄
);

987 
î∫o
 = 
ETIMEDOUT
;

992 i‡(
p
 == 0) {

993 
	`SASSERT
(!
	`ADDRISBOUND
(&
loˇl
));

994 
	`¶og
(
LOG_DEBUG
,

997 
fun˘i⁄
);

1000 
	`¶og
(
LOG_DEBUG
, "%s: getsockname(control) failed: %s",

1001 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

1004 i‡(
î∫o
 == 0) {

1005 
Àn
 = (
î∫o
);

1006 
	`gësock›t
(
c⁄åﬁ
, 
SOL_SOCKET
, 
SO_ERROR
, &
î∫o
, &
Àn
);

1008 
	`¶og
(
î∫o
 =0 ? 
LOG_DEBUG
 : 
LOG_WARNING
,

1010 
fun˘i⁄
, 
î∫o
, 
	`°ªº‹
(errno));

1013 
ªq
.
∑ckë
.
°©e
.
îr
 = 
î∫o
;

1015 
Àn
 = (
ªmŸe
);

1016 i‡(
	`gë≥î«me
(
c⁄åﬁ
, 
	`TOSA
(&
ªmŸe
), &
Àn
) != 0) {

1017 i‡(
ªq
.
∑ckë
.
°©e
.
îr
 == 0) {

1018 
	`sw¨n
("%s:ÇoÉrror detected, but getpeername(control) failed",

1019 
fun˘i⁄
);

1021 
ªq
.
∑ckë
.
°©e
.
îr
 = 
î∫o
;

1024 
	`sw¨n
("%s: gë≥î«me(c⁄åﬁËÁûed", 
fun˘i⁄
);

1027 
	`¶og
(
LOG_INFO
, "%s: connect %s (errno = %d)",

1028 
fun˘i⁄
,

1029 
ªq
.
∑ckë
.
°©e
.
îr
 == 0 ? "succeeded" : "failed",

1030 
ªq
.
∑ckë
.
°©e
.
îr
);

1033 i‡(
ªq
.
∑ckë
.
°©e
.
îr
 == 0) {

1034 
emsg
[1024];

1036 i‡(
	`socks_√gŸüã
(
d©a
,

1037 
c⁄åﬁ
,

1038 &
ªq
.
∑ckë
,

1039 
NULL
,

1040 
emsg
,

1041 (
emsg
)) != 0) {

1042 
	`sw¨nx
("%s: socks_√gŸüã(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

1044 
ªq
.
∑ckë
.
ªs
.
auth
->
mëhod
 = 
AUTHMETHOD_NOTSET
;

1045 
ªq
.
∑ckë
.
°©e
.
îr
 = 
î∫o
;

1048 
	`¶og
(
LOG_INFO
, "%s: socks_√gŸüã(Ësuc˚eded", 
fun˘i⁄
);

1049 
ªq
.
∑ckë
.
°©e
.
îr
 = 0;

1054 i‡(
Êags
 != -1)

1055 i‡(
	`f˙é
(
c⁄åﬁ
, 
F_SETFL
, 
Êags
) == -1)

1056 
	`sw¨n
("%s: failedÅoÑestore flags on control-fd %d",

1057 
fun˘i⁄
, 
c⁄åﬁ
);

1059 
ioc
 = 0;

1060 
	`bzîo
(
iov
, (iov));

1062 
iov
[
ioc
].
iov_ba£
 = &
ªq
;

1063 
iov
[
ioc
].
iov_Àn
 = (
ªq
);

1064 
to£nd
 = 
iov
[
ioc
].
iov_Àn
;

1065 ++
ioc
;

1067 #i‡
HAVE_GSSAPI


1068 i‡(
ªq
.
∑ckë
.
°©e
.
îr
 == 0

1069 && 
ªq
.
∑ckë
.
°©e
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

1070 
	`gsßpi_exp‹t_°©e
(&
ªq
.
∑ckë
.
°©e
.
auth
.
md©a
.
gsßpi
.°©e.
id
,

1071 &
gsßpi°©e
);

1073 
iov
[
ioc
].
iov_ba£
 = 
gsßpi°©e
.
vÆue
;

1074 
iov
[
ioc
].
iov_Àn
 = 
gsßpi°©e
.
Àngth
;

1075 
to£nd
 +
iov
[
ioc
].
iov_Àn
;

1076 ++
ioc
;

1078 
	`¶og
(
LOG_DEBUG
,

1080 
fun˘i⁄
,

1081 ()
gsßpi°©e
.
Àngth
,

1082 ((*)
gsßpi°©e
.
vÆue
)[0],

1083 ((*)
gsßpi°©e
.
vÆue
)[1]);

1088 
	`bzîo
(&
msg
, (msg));

1089 
msg
.
msg_iov
 = 
iov
;

1090 
msg
.
msg_iovÀn
 = 
ioc
;

1091 
msg
.
msg_«me
 = 
NULL
;

1092 
msg
.
msg_«mñí
 = 0;

1094 
fd£¡
 = 0;

1095 
	`CMSG_ADDOBJECT
(
c⁄åﬁ
, 
cmsg
, (c⁄åﬁË* 
fd£¡
++);

1096 
	`CMSG_SETHDR_SEND
(
msg
, 
cmsg
, (Ë* 
fd£¡
);

1098 
ßvedf‹œãr
 = 0;

1099 i‡(
	`£ndmsgn
(
mŸhî_d©a
, &
msg
, 0, 0) == -1) {

1100 *
tmp
;

1101 
size_t
 
ioc
;

1103 
	`¶og
(
LOG_INFO
,

1106 
fun˘i⁄
, ()
to£nd
, 
ªq
.
s
, 
	`°ªº‹
(
î∫o
));

1108 i‡((
tmp
 = 
	`ªÆloc
(
föishedv
, (*föishedvË* (
föishedc
 + 1)))

1109 =
NULL
) {

1110 
	`sw¨nx
("%s: couldÇotÉxpand finishedvárray for connectÅo %s",

1111 
fun˘i⁄
,

1112 
	`socksho°2°rög
(&
ªq
.
∑ckë
.ªq.
ho°
, 
NULL
, 0));

1113 
exô
;

1116 
föishedv
 = 
tmp
;

1117 
	`bzîo
(&
föishedv
[
föishedc
], (finishedv[finishedc]));

1119 
föishedv
[
föishedc
].
ªq
 =Ñeq;

1121 
ioc
 = 0;

1122 
föishedv
[
föishedc
].
iov
[
ioc
].
iov_ba£


1123 &
föishedv
[
föishedc
].
ªq
;

1125 
föishedv
[
föishedc
].
iov
[
ioc
].
iov_Àn


1126 (
föishedv
[
föishedc
].
ªq
);

1128 
	`SASSERTX
(
msg
.
msg_iovÀn
 <= 2);

1129 #i‡
HAVE_GSSAPI


1130 i‡(
msg
.
msg_iovÀn
 == 2) {

1135 ++
ioc
;

1137 
	`SASSERTX
(
msg
.
msg_iov
[
ioc
].
iov_Àn


1138 <(
föishedv
[
föishedc
].
gssd©a
));

1140 
föishedv
[
föishedc
].
iov
[
ioc
].
iov_ba£


1141 &
föishedv
[
föishedc
].
gssd©a
;

1143 
	`mem˝y
(
föishedv
[
föishedc
].
iov
[
ioc
].
iov_ba£
,

1144 
msg
.
msg_iov
[
ioc
].
iov_ba£
,

1145 
msg
.
msg_iov
[
ioc
].
iov_Àn
);

1147 
föishedv
[
föishedc
].
iov
[
ioc
].
iov_Àn


1148 
msg
.
msg_iov
[
ioc
].
iov_Àn
;

1152 
	`SASSERTX
(
msg
.
msg_c⁄åﬁÀn


1153 <(
föishedv
[
föishedc
].
cmsgd©a
));

1155 
föishedv
[
föishedc
].
msg
.
msg_c⁄åﬁ


1156 &
föishedv
[
föishedc
].
cmsgd©a
;

1158 
	`mem˝y
(
föishedv
[
föishedc
].
msg
.
msg_c⁄åﬁ
,

1159 
msg
.
msg_c⁄åﬁ
,

1160 
msg
.
msg_c⁄åﬁÀn
);

1162 
föishedv
[
föishedc
].
msg
.
msg_c⁄åﬁÀn


1163 
msg
.
msg_c⁄åﬁÀn
;

1165 
	`SASSERTX
(
msg
.
msg_«me
 =
NULL
);

1166 
	`SASSERTX
(
msg
.
msg_«mñí
 == 0);

1167 
föishedv
[
föishedc
].
msg
.
msg_«me
 = msg.msg_name;

1168 
föishedv
[
föishedc
].
msg
.
msg_«mñí
 = msg.msg_namelen;

1170 
föishedv
[
föishedc
].
msg
.
msg_iov
 = föishedv[föishedc].
iov
;

1171 
föishedv
[
föishedc
].
msg
.
msg_iovÀn
 = 
ioc
;

1173 
föishedv
[
föishedc
].
msg
.
msg_Êags
 = msg.msg_flags;

1175 ++
föishedc
;

1176 
ßvedf‹œãr
 = 1;

1178 
	`¶og
(
LOG_DEBUG
,

1180 
fun˘i⁄
,

1181 
	`socksho°2°rög
(&
ªq
.
∑ckë
.ªq.
ho°
, 
NULL
, 0));

1184 
	`¶og
(
LOG_INFO
,

1186 
fun˘i⁄
, ()
to£nd
, 
ªq
.
s
);

1188 
exô
:

1189 i‡(!
ßvedf‹œãr
) {

1190 
	`˛o£
(
c⁄åﬁ
);

1191 i‡(
d©a
 !
c⁄åﬁ
)

1192 
	`˛o£
(
d©a
);

1196 
	}
}

1199 
	$sigio
(
sig
, 
sù
, 
s˝
)

1200 
sig
;

1201 
sigöfo_t
 *
sù
;

1202 *
s˝
;

1204 c⁄° *
fun˘i⁄
 = "sigio()";

1205 c⁄° 
î∫o_s
 = 
î∫o
;

1206 
socksfd_t
 
socksfd
;

1207 
chûd∑ckë_t
 
chûdªs
;

1208 
msghdr
 
msg
;

1209 
iovec
 
iov
[2];

1210 
sockÀn_t
 
Àn
;

1211 
ssize_t
 
rc
;

1212 
size_t
 
gŸ∑ckës
;

1213 
emsg
[256], 
b
[5][256];

1214 
fdex≥˘
, 
s
, 
ioc
;

1215 #i‡
HAVE_GSSAPI


1216 
gsßpi°©emem
[
MAX_GSS_STATE
];

1218 
	`CMSG_AALLOC
(
cmsg
, (Ë* 
FDPASS_MAX
);

1220 #ifde‡
HAVE_LINUX_BUGS


1232 i‡(
sockscf
.
°©e
.
ösig«l
) {

1233 
	`¶og
(
LOG_DEBUG
, "%s:Åhis shouldn't happen ..."

1235 
fun˘i⁄
, 
sockscf
.
°©e
.
ösig«l
, 
sig
);

1240 
	`SASSERTX
(!
sockscf
.
°©e
.
ösig«l
);

1243 
sockscf
.
°©e
.
ösig«l
 = sockscf.°©e.
h™dÀdsig«l
 = 
sig
;

1245 i‡(
sockscf
.
›ti⁄
.
debug
) {

1246 c⁄° *
msgv
[] =

1247 { 
fun˘i⁄
,

1250 
	`…ﬂ
(()
ªqout°™dög
, 
b
[0], (b[0])),

1251 
NULL


1254 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1261 i‡((
rc
 = 
	`ªcv
(
sockscf
.
chûd_ack
, &
msg
, (msg), 0)) != -1

1262 && !
	`ERRNOISTMP
(
î∫o
)) {

1263 c⁄° *
msgv
[] =

1264 { 
fun˘i⁄
,

1268 
	`…ﬂ
(
rc
, 
b
[0], (b[0])),

1270 
NULL


1273 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1275 
sockscf
.
c⁄√˘chûd
 = 0;

1276 
	`˛o£
(
sockscf
.
chûd_ack
);

1277 
	`˛o£
(
sockscf
.
chûd_d©a
);

1286 
sockscf
.
°©e
.
ösig«l
 = 0;

1290 i‡(
‹igöÆsig
.
ß_Êags
 & 
SA_SIGINFO


1291 && 
‹igöÆsig
.
ß_siga˘i⁄
 !
NULL
) {

1292 c⁄° *
msgv
[] =

1293 { 
fun˘i⁄
,

1296 
NULL


1299 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1301 
‹igöÆsig
.
	`ß_siga˘i⁄
(
sig
, 
sù
, 
s˝
);

1304 i‡(
‹igöÆsig
.
ß_h™dÀr
 !
SIG_IGN


1305 && 
‹igöÆsig
.
ß_h™dÀr
 !
SIG_DFL
) {

1306 c⁄° *
msgv
[] =

1307 { 
fun˘i⁄
,

1310 
NULL


1313 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1315 
‹igöÆsig
.
	`ß_h™dÀr
(
sig
);

1319 i‡(
sockscf
.
c⁄√˘chûd
 == 0) {

1320 
sockscf
.
°©e
.
ösig«l
 = 0;

1324 
	`bzîo
(
iov
, (iov));

1325 
ioc
 = 0;

1327 
iov
[
ioc
].
iov_ba£
 = &
chûdªs
;

1328 
iov
[
ioc
].
iov_Àn
 = (
chûdªs
);

1329 ++
ioc
;

1331 #i‡
HAVE_GSSAPI


1332 
iov
[
ioc
].
iov_ba£
 = 
gsßpi°©emem
;

1333 
iov
[
ioc
].
iov_Àn
 = (
gsßpi°©emem
);

1334 ++
ioc
;

1337 
	`bzîo
(&
msg
, (msg));

1338 
msg
.
msg_iov
 = 
iov
;

1339 
msg
.
msg_iovÀn
 = 
ioc
;

1340 
msg
.
msg_«me
 = 
NULL
;

1341 
msg
.
msg_«mñí
 = 0;

1343 i‡(
sockscf
.
›ti⁄
.
debug
) {

1344 c⁄° *
msgv
[] =

1345 { 
fun˘i⁄
,

1348 
NULL


1351 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1354 
gŸ∑ckës
 = 0;

1356 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

1357 (
rc
 = 
	`ªcvmsgn
(
sockscf
.
chûd_d©a
, &
msg
, 0))

1358 >(
ssize_t
)(
chûdªs
)) {

1359 c⁄° *
msgv
[] =

1360 { 
fun˘i⁄
,

1363 
	`…ﬂ
(()
rc
, 
b
[0], (b[0])),

1365 
	`…ﬂ
(()
	`CMSG_TOTLEN
(
msg
), 
b
[1], (b[1])),

1367 
	`…ﬂ
(()
chûdªs
.
s
, 
b
[2], (b[2])),

1369 
	`…ﬂ
(()
ªqout°™dög
 + 1, 
b
[3], (b[3])),

1370 
NULL


1373 
sockaddr_°‹age
 
loˇlmem
, *
loˇl
 = &localmem;

1374 
sockaddr_°‹age
 
ªmŸemem
, *
ªmŸe
 = &remotemem;

1375 
chûd_s
;

1377 ++
gŸ∑ckës
;

1378 --
ªqout°™dög
;

1380 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1382 i‡(
	`socks_msgha£º‹s
(
fun˘i⁄
, &
msg
))

1385 
fdex≥˘
 = 1;

1386 i‡(!
	`CMSG_RCPTLEN_ISOK
(
msg
, (Ë* 
fdex≥˘
)) {

1387 c⁄° *
msgv
[] =

1388 { 
fun˘i⁄
,

1391 
	`…ﬂ
(()
	`CMSG_TOTLEN
(
msg
), 
b
[0], (b[0])),

1392 
NULL
,

1395 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

1399 
	`SASSERTX
(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET
);

1400 
	`SASSERTX
(
cmsg
->
cmsg_ty≥
 =
SCM_RIGHTS
);

1402 
Àn
 = 0;

1403 
	`CMSG_GETOBJECT
(
chûd_s
, 
cmsg
, (chûd_sË* 
Àn
++);

1405 i‡(
sockscf
.
›ti⁄
.
debug
) {

1406 c⁄° *
msgv
[] =

1407 { 
fun˘i⁄
,

1410 
	`…ﬂ
(()
chûd_s
, 
b
[0], (b[0])),

1411 
NULL


1414 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1417 
	`SASSERTX
(
	`fdis›í
(
chûd_s
));

1419 
rc
 -(
chûdªs
);

1425 
	`socks_rmaddr
(
chûd_s
, 0);

1427 
Àn
 = (*
loˇl
);

1428 i‡(
	`gësock«me
(
chûd_s
, 
	`TOSA
(
loˇl
), &
Àn
) == 0) {

1429 c⁄° *
msgv
[] =

1430 { 
fun˘i⁄
,

1433 
NULL


1436 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1439 c⁄° *
msgv
[] =

1440 { 
fun˘i⁄
,

1443 
	`…ﬂ
(()
î∫o
, 
b
[0], (b[0])),

1444 
NULL


1447 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1450 
Àn
 = (*
ªmŸe
);

1451 i‡(
	`gë≥î«me
(
chûd_s
, 
	`TOSA
(
ªmŸe
), &
Àn
) == 0) {

1452 c⁄° *
msgv
[] =

1453 { 
fun˘i⁄
,

1457 
NULL


1460 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1463 c⁄° *
msgv
[] =

1464 { 
fun˘i⁄
,

1467 
	`…ﬂ
(()
î∫o
, 
b
[0], (b[0])),

1468 
NULL


1471 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1474 
chûdªs
.
∑ckë
.
ªq
.
auth


1475 
chûdªs
.
∑ckë
.
ªs
.
auth


1476 &
chûdªs
.
∑ckë
.
°©e
.
auth
;

1478 i‡(
chûdªs
.
∑ckë
.
°©e
.
îr
 != 0) {

1479 c⁄° *
msgv
[] =

1480 { 
fun˘i⁄
,

1483 
	`…ﬂ
(()
chûdªs
.
∑ckë
.
°©e
.
îr
, 
b
[0], (b[0])),

1484 
NULL


1487 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

1490 c⁄° *
msgv
[] =

1491 { 
fun˘i⁄
,

1494 
	`…ﬂ
(()
chûdªs
.
∑ckë
.
ªs
.
auth
->
mëhod
, 
b
[0], (b[0])),

1495 
NULL


1498 
	`sig«l¶og
(
LOG_INFO
, 
msgv
);

1501 
s
 = 
	`socks_addrc⁄åﬁ
(
chûdªs
.s, 
chûd_s
, 0);

1502 
	`˛o£
(
chûd_s
);

1504 i‡(
s
 == -1) {

1505 c⁄° *
msgv
[] =

1506 { 
fun˘i⁄
,

1509 
	`…ﬂ
(()
chûdªs
.
s
, 
b
[0], (b[0])),

1512 
NULL


1515 
	`sig«l¶og
(
LOG_INFO
, 
msgv
);

1523 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

1527 i‡(
sockscf
.
›ti⁄
.
debug
) {

1528 c⁄° *
msgv
[] =

1529 { 
fun˘i⁄
,

1532 
	`…ﬂ
(()
s
, 
b
[0], (b[0])),

1533 
NULL


1536 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1539 i‡(
	`socks_gëaddr
(
s
, &
socksfd
, 0Ë=
NULL
) {

1540 c⁄° *
msgv
[] =

1541 { 
fun˘i⁄
,

1544 
	`…ﬂ
(()
s
, 
b
[0], (b[0])),

1545 
NULL


1548 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

1552 
socksfd
.
°©e
.
îr
 = 
chûdªs
.
∑ckë
.state.err;

1554 
socksfd
.
°©e
.
vîsi⁄
) {

1555 
PROXY_SOCKS_V4
:

1556 
PROXY_SOCKS_V5
:

1557 
PROXY_HTTP_10
:

1558 
PROXY_HTTP_11
:

1559 
PROXY_UPNP
:

1560 i‡(
socksfd
.
c⁄åﬁ
 =
s
) {

1561 c⁄° *
msgv
[] =

1562 { 
fun˘i⁄
,

1565 
	`…ﬂ
(()
socksfd
.
c⁄åﬁ
, 
b
[0], (b[0])),

1567 
NULL


1570 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1574 i‡(
sockscf
.
›ti⁄
.
debug
) {

1575 c⁄° *
msgv
[] =

1576 { 
fun˘i⁄
,

1579 
	`…ﬂ
(()
socksfd
.
c⁄åﬁ
, 
b
[0], (b[0])),

1581 
	`…ﬂ
(()
s
, 
b
[1], (b[1])),

1582 
NULL


1585 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1588 i‡(
	`dup2
(
socksfd
.
c⁄åﬁ
, 
s
) == -1) {

1589 c⁄° *
msgv
[] =

1590 { 
fun˘i⁄
,

1593 
	`…ﬂ
(()
socksfd
.
c⁄åﬁ
, 
b
[0], (b[0])),

1595 
	`…ﬂ
(()
s
, 
b
[1], (b[1])),

1597 
	`…ﬂ
(()
î∫o
, 
b
[2], (b[2])),

1598 
NULL


1601 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

1603 
	`SASSERT
(
î∫o
 !
EBADF
);

1605 
	`socks_addaddr
(
s
, &
socksfd
, 0);

1609 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

1610 
socksfd
.
c⁄åﬁ
 = 
s
;

1611 
	`socks_addaddr
(
s
, &
socksfd
, 0);

1615 
	`SERRX
(
socksfd
.
°©e
.
vîsi⁄
);

1622 
Àn
 = (
socksfd
.
loˇl
);

1623 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), &
Àn
) != 0) {

1624 c⁄° *
msgv
[] =

1625 { 
fun˘i⁄
,

1628 
	`…ﬂ
(()
î∫o
, 
b
[0], (b[0])),

1629 
NULL


1632 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1634 
	`socks_rmaddr
(
s
, 0);

1636 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

1640 c⁄° *
msgv
[] =

1641 { 
fun˘i⁄
,

1645 
NULL


1648 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1651 
Àn
 = (
socksfd
.
£rvî
);

1652 i‡(
	`gë≥î«me
(
s
, 
	`TOSA
(&
socksfd
.
£rvî
), &
Àn
) == 0) {

1653 c⁄° *
msgv
[] =

1654 { 
fun˘i⁄
,

1658 
NULL


1661 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1664 c⁄° *
msgv
[] =

1665 { 
fun˘i⁄
,

1668 
	`…ﬂ
(()
s
, 
b
[0], (b[0])),

1670 
	`…ﬂ
(()
î∫o
, 
b
[1], (b[1])),

1671 
NULL


1674 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

1677 
socksfd
.
°©e
.
ö¥ogªss
 = 0;

1678 
	`socks_addaddr
(
s
, &
socksfd
, 0);

1680 i‡(
socksfd
.
°©e
.
îr
 != 0

1681 || !
	`£rvîª∂yisok
(
chûdªs
.
∑ckë
.
ªs
.
vîsi⁄
,

1682 
chûdªs
.
∑ckë
.
ªq
.
comm™d
,

1683 
	`socks_gë_ª•⁄£vÆue
(&
chûdªs
.
∑ckë
.
ªs
),

1684 
socksfd
.
rouã
,

1685 
emsg
,

1686 (
emsg
))) {

1687 c⁄° *
msgv
[] =

1688 { 
fun˘i⁄
,

1690 
	`¥oxy¥Ÿocﬁisknown
(
chûdªs
.
∑ckë
.
ªs
.
vîsi⁄
) ?

1693 
socksfd
.
°©e
.
îr
 =0 ? 
emsg
 : 
NULL
,

1694 
NULL


1697 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

1699 i‡(
socksfd
.
°©e
.
îr
 == 0

1700 && !
	`¥oxy¥Ÿocﬁisknown
(
chûdªs
.
∑ckë
.
ªs
.
vîsi⁄
))

1701 
socksfd
.
°©e
.
îr
 = 
EPROTONOSUPPORT
;

1703 i‡(
socksfd
.
°©e
.
îr
 == 0)

1704 
socksfd
.
°©e
.
îr
 = 
î∫o
;

1706 
î∫o
 = 
socksfd
.
°©e
.
îr
;

1708 i‡(
î∫o
 == 0)

1709 
socksfd
.
°©e
.
îr
 = 
EPROTONOSUPPORT
;

1711 c⁄° *
msgv
[] =

1712 { 
fun˘i⁄
,

1716 
	`…ﬂ
(()
î∫o
, 
b
[0], (b[0])),

1717 
NULL


1720 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

1723 
	`socks_addaddr
(
s
, &
socksfd
, 0);

1733 c⁄° *
msgv
[] =

1734 { 
fun˘i⁄
,

1738 
NULL
,

1741 
	`sig«l¶og
(
LOG_INFO
, 
msgv
);

1744 
socksfd
.
°©e
.
auth
 = *
chûdªs
.
∑ckë
.
ªs
.auth;

1745 
	`socksho°2sockaddr
(&
chûdªs
.
∑ckë
.
ªs
.
ho°
, &
socksfd
.
ªmŸe
);

1747 #i‡
HAVE_GSSAPI


1748 i‡(
socksfd
.
°©e
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

1754 c⁄° *
msgv
[] =

1755 { 
fun˘i⁄
,

1758 
	`…ﬂ
(()
rc
, 
b
[0], (b[0])),

1760 
	`…ﬂ
(()
s
, 
b
[1], (b[1])),

1762 
	`…ﬂ
(()
gsßpi°©emem
[0], 
b
[2], (b[2])),

1764 
	`…ﬂ
(()
gsßpi°©emem
[1], 
b
[3], (b[3])),

1766 
NULL


1769 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1771 
	`SASSERTX
(
rc
 > 0);

1773 
socksfd
.
°©e
.
gssimp‹äìded
 = 1;

1774 
socksfd
.
°©e
.
gsßpi°©e
.
vÆue
 = socksfd.°©e.
gsßpi°©emem
;

1775 
socksfd
.
°©e
.
gsßpi°©e
.
Àngth
 = 
rc
;

1777 
	`SASSERTX
((
socksfd
.
°©e
.
gsßpi°©emem
Ë>(
size_t
)
rc
);

1778 
	`mem˝y
(
socksfd
.
°©e
.
gsßpi°©e
.
vÆue
, 
gsßpi°©emem
, 
rc
);

1782 
	`socks_addaddr
(
s
, &
socksfd
, 0);

1785 
sockscf
.
°©e
.
œ°c⁄√˘
 = 
socksfd
.
f‹us
.
c⁄√˘ed
;

1789 
öô
;

1791 i‡(!
öô
) {

1792 
	`¶og
(
LOG_DEBUG
, "%s: XXX sÀïög", 
fun˘i⁄
);

1793 
öô
 = 1;

1794 
	`¶ìp
(20);

1799 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

1802 i‡(
gŸ∑ckës
) {

1803 c⁄° *
msgv
[] =

1804 { 
fun˘i⁄
,

1807 
	`…ﬂ
(()
gŸ∑ckës
, 
b
[0], (b[0])),

1809 
	`…ﬂ
(()
ªqout°™dög
, 
b
[1], (b[1])),

1811 
NULL


1814 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1817 c⁄° *
msgv
[] =

1818 { 
fun˘i⁄
,

1822 
	`…ﬂ
(()
rc
, 
b
[0], (b[0])),

1823 
NULL


1826 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

1829 
î∫o
 = 
î∫o_s
;

1830 
sockscf
.
°©e
.
ösig«l
 = 0;

1831 
	}
}

	@lib/debug.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 #i‡
DEBUG


52 
	$fd_is£t
(
fd
, 
fd£t
)

53 
fd
;

54 
fd_£t
 *
fd£t
;

57  
	`FD_ISSET
(
fd
, 
fd£t
);

58 
	}
}

	@lib/errorsymbols.c

44 
	~"comm⁄.h
"

45 
	~"îr‹symbﬁs.h
"

47 c⁄° 
	grcsid
[] =

51 
dosˇn
(c⁄° *
symbﬁ
, 
size_t
 *
vÆuec
, 
vÆuev
[], c⁄° size_à
èbÀc
,

52 c⁄° 
îr‹symbﬁèbÀ_t
 
èbÀv
[]);

62 
	$î∫ovÆue
(
symbﬁ
)

63 c⁄° *
symbﬁ
;

65 
vÆuev
[
MAX_ERRNO_VALUES_FOR_SYMBOL
 + 1];

66 
size_t
 
vÆuec
;

68 
vÆuec
 = 
	`ELEMENTS
(
vÆuev
);

69 
	`dosˇn
(
symbﬁ
, &
vÆuec
, 
vÆuev
, 
	`ELEMENTS
(
î∫osymbﬁv
),Érrnosymbolv);

71 i‡(
vÆuec
 == 0)

72  
NULL
;

74  
vÆuev
;

75 
	}
}

78 
	$gaivÆue
(
symbﬁ
)

79 c⁄° *
symbﬁ
;

81 
vÆuev
[
MAX_GAIERR_VALUES_FOR_SYMBOL
 + 1];

82 
size_t
 
vÆuec
;

84 
vÆuec
 = 
	`ELEMENTS
(
vÆuev
);

85 
	`dosˇn
(
symbﬁ
, &
vÆuec
, 
vÆuev
, 
	`ELEMENTS
(
gaõºsymbﬁv
), gaierrsymbolv);

87 i‡(
vÆuec
 == 0)

88  
NULL
;

90  
vÆuev
;

91 
	}
}

95 
	$dosˇn
(
symbﬁ
, 
vÆuec
, 
vÆuev
, 
èbÀc
, 
èbÀv
)

96 c⁄° *
symbﬁ
;

97 
size_t
 *
vÆuec
;

98 
vÆuev
[];

99 c⁄° 
size_t
 
èbÀc
;

100 c⁄° 
îr‹symbﬁèbÀ_t
 
èbÀv
[];

102 c⁄° 
size_t
 
maxvÆuec
 = *
vÆuec
;

103 
size_t
 
i
;

105 *
vÆuec
 = 0;

106 
i
 = 0; i < 
èbÀc
; ++i) {

107 i‡(
	`°rˇ£cmp
(
èbÀv
[
i
].
«me
, 
symbﬁ
) == 0) {

108 
vÆuev
[(*
vÆuec
)++] = 
èbÀv
[
i
].
vÆue
;

115 
	`SASSERTX
(*
vÆuec
 < 
maxvÆuec
);

118 i‡(*
vÆuec
 > 0) {

119 
	`SASSERTX
(*
vÆuec
 < 
maxvÆuec
);

120 
vÆuev
[(*
vÆuec
)++] = 0;

123 
	`SASSERTX
(*
vÆuec
 <
maxvÆuec
);

124 
	}
}

	@lib/fmt.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

	@lib/fmt_customer.c

43 
	~"comm⁄.h
"

45 c⁄° 
	grcsid
[] =

54 
	$log_c⁄√˘Áûed
(
side
, 
d°°r
)

55 c⁄° 
öãrÁ˚side_t
 
side
;

56 c⁄° *
d°°r
;

58 c⁄° *
fun˘i⁄
 = "log_connectfailed()";

59 c⁄° 
Œ
 = 
	`logÀvñ_î∫o
(
î∫o
, 
side
);

61 i‡(
	`ERRNOISNOROUTE
(
î∫o
))

62 
	`¶og
(
Œ
, "nÿrouãÅÿ%s: %s", 
d°°r
, 
	`°ªº‹
(
î∫o
));

63 i‡(
î∫o
 =
EINPROGRESS
)

64 
	`¶og
(
Œ
, "c⁄√˘Åÿho° %†i†now i¿¥ogªss", 
d°°r
);

66 
	`¶og
(
Œ
, "c⁄√˘Åÿho° %†Áûed: %s", 
d°°r
, 
	`°ªº‹
(
î∫o
));

67 
	}
}

70 
	$log_wrôeÁûed
(
side
, 
s
, 
d°
)

71 c⁄° 
öãrÁ˚side_t
 
side
;

72 c⁄° 
s
;

73 c⁄° 
sockaddr_°‹age
 *
d°
;

75 c⁄° 
Œ
 = 
	`logÀvñ_î∫o
(
î∫o
, 
side
);

76 c⁄° 
î∫o_s
 = 
î∫o
;

77 
d°°r
[
MAXSOCKADDRSTRING
];

79 i‡(
d°
 !
NULL
)

80 
	`sockaddr2°rög
(
d°
, 
d°°r
, (dststr));

82 
sockaddr_°‹age
 
p
;

83 
sockÀn_t
 
Àn
;

85 
Àn
 = (
p
);

86 i‡(
	`gë≥î«me
(
s
, 
	`TOSA
(&
p
), &
Àn
) == -1)

87 
	`¢¥ötf
(
d°°r
, (dststr), "N/A");

89 
	`sockaddr2°rög
(&
p
, 
d°°r
, (dststr));

92 
î∫o
 = 
î∫o_s
;

94 i‡(
	`ERRNOISNOROUTE
(
î∫o
))

95 
	`¶og
(
Œ
, "nÿrouãÅÿ%s: %s", 
d°°r
, 
	`°ªº‹
(
î∫o
));

97 
	`¶og
(
Œ
, "£ndÅÿho° %†Áûed: %s", 
d°°r
, 
	`°ªº‹
(
î∫o
));

98 
	}
}

101 
	$log_ªsﬁveÁûed
(
ho°«me
, 
side
, 
gaõº
)

102 c⁄° *
ho°«me
;

103 c⁄° 
öãrÁ˚side_t
 
side
;

104 c⁄° 
gaõº
;

106 c⁄° 
Œ
 = 
	`logÀvñ_gaõº
(
gaõº
, 
side
);

107 
visbuf
[
MAXHOSTNAMELEN
 * 4];

109 
	`¶og
(
Œ
, "couldÇot DNS-resolve \"%s\": %s",

110 
	`°r2vis
(
ho°«me
, 
	`°æí
(ho°«me), 
visbuf
, (visbuf)),

111 
gaõº
 =
EAI_SYSTEM
 ? 
	`°ªº‹
(
î∫o
Ë: 
	`gai_°ªº‹
(gaierr));

112 
	}
}

115 
	$log_ªvî£m≠Áûed
(
addr
, 
side
, 
gaõº
)

116 c⁄° 
sockaddr_°‹age
 *
addr
;

117 c⁄° 
öãrÁ˚side_t
 
side
;

118 c⁄° 
gaõº
;

120 c⁄° 
Œ
 = 
	`logÀvñ_gaõº
(
gaõº
, 
side
);

121 
addr°rög
[256];

123 
	`socks_öë_±⁄
(
addr
->
ss_Ámûy
,

124 
	`GET_SOCKADDRADDR
(
addr
),

125 
addr°rög
,

126 
NULL
)) {

131 
	`STRCPY_ASSERTSIZE
(
addr°rög
, "<nonsenseáddress>");

136 
	`°∫˝y
(
addr°rög
, 
	`°ªº‹
(
î∫o
), (addrstring) - 1);

137 
addr°rög
[◊ddr°rögË- 1] = 
NUL
;

141 
	`¶og
(
Œ
, "couldÇot DNSÑeversemapáddress %s: %s",

142 
addr°rög
,

143 
gaõº
 =
EAI_SYSTEM
 ? 
	`°ªº‹
(
î∫o
Ë: 
	`gai_°ªº‹
(gaierr));

144 
	}
}

146 #i‡!
SOCKS_CLIENT


149 
	$log_˛õ¡dr›≥d
(
˛õ¡
)

150 c⁄° 
sockaddr_°‹age
 *
˛õ¡
;

153 
	`¶og
(
LOG_WARNING
, "new client from %s dropped:ÇoÑesources",

154 
	`sockaddr2°rög
(
˛õ¡
, 
NULL
, 0));

155 
	}
}

158 
	$log_addchûd_Áûed
()

161 
	`¶og
(
LOG_WARNING
, "failedÅoáddáÇew childÅo handleÇew clients");

162 
	}
}

	@lib/fmt_protocol.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

50 
	$fmåe•⁄£îr‹
(
ª˚ived
, 
ex≥˘ed
, 
emsg
, 
emsgÀn
)

51 c⁄° 
ssize_t
 
ª˚ived
;

52 c⁄° 
size_t
 
ex≥˘ed
;

53 *
emsg
;

54 c⁄° 
size_t
 
emsgÀn
;

57 
ª˚ived
) {

59 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "errorÑeadingÖroxy serverÑesponse: %s",

60 
	`°ªº‹
(
î∫o
));

64 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

69 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

71 ()
ª˚ived
, ()
ex≥˘ed
);

74  
emsg
;

75 
	}
}

78 
	$fmtvîsi⁄îr‹
(
ex≥˘ed
, 
ª˚ived
, 
emsg
, 
emsgÀn
)

79 c⁄° 
ex≥˘ed
;

80 c⁄° 
ª˚ived
;

81 *
emsg
;

82 c⁄° 
size_t
 
emsgÀn
;

84 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

87 
ex≥˘ed
, 
ª˚ived
);

89  
emsg
;

90 
	}
}

	@lib/gssapi.c

52 
	~"comm⁄.h
"

54 c⁄° 
	grcsid
[] =

57 #i‡
HAVE_GSSAPI


59 #i‡
SOCKS_CLIENT


62 
døösockë
(
iobuf„r_t
 *
iobuf
, c⁄° 
døöôÆl
,

63 *
buf
, c⁄° 
size_t
 
bufsize
);

79 
ssize_t


80 
gsßpi_decode_ªad_udp
(
s
, *
buf
, 
size_t
 
Àn
, 
Êags
,

81 
sockaddr_°‹age
 *
‰om
, 
sockÀn_t
 *
‰omÀn
,

82 
ªcv‰om_öfo_t
 *
ªcvÊags
, 
gsßpi_°©e_t
 *
gs
,

83 *
tokí
, c⁄° 
size_t
 
tokísize
);

92 
ssize_t


93 
gsßpi_ícode_wrôe_udp
(
s
, c⁄° *
msg
, 
size_t
 
Àn
, 
Êags
,

94 c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
,

95 
£ndto_öfo_t
 *
£ndtoÊags
, 
gsßpi_°©e_t
 *
gs
,

96 *
tokí
, c⁄° 
size_t
 
tokísize
);

102 
gsßpi_hódîisok
(c⁄° *
hódîbuf
, c⁄° 
size_t
 
Àn
,

103 *
tokíÀn
,

104 *
emsg
, 
size_t
 
emsgÀn
);

113 
	$gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, 
buÊí
)

114 
OM_uöt32
 
maj‹_°©us
;

115 
OM_uöt32
 
mö‹_°©us
;

116 *
buf
;

117 
size_t
 
buÊí
;

119 
OM_uöt32
 
maj_°©
, 
mö_°©
, 
msg_˘x
;

120 
gss_buf„r_desc
 
°©°r
;

121 #i‡
SOCKS_CLIENT


122 
sig£t_t
 
ﬁd£t
;

124 
size_t
 
w
;

126 i‡(!
	`GSS_ERROR
(
maj‹_°©us
))

129 i‡(
buf
 =
NULL
 || 
buÊí
 <= 0)

132 *
buf
 = 
NUL
;

134 
msg_˘x
 = 0;

142 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

143 
maj_°©
 = 
	`gss_di•œy_°©us
(&
mö_°©
,

144 
maj‹_°©us
,

145 
GSS_C_GSS_CODE
,

146 
GSS_C_NULL_OID
,

147 &
msg_˘x
,

148 &
°©°r
);

149 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

151 i‡(!
	`GSS_ERROR
(
maj_°©
)) {

152 
w
 = 
	`¢¥ötf
(
buf
, 
buÊí
,

153 "%.*s. ", ()
°©°r
.
Àngth
, (*)°©°r.
vÆue
);

154 
buf
 +
w
;

155 
buÊí
 -
w
;

158 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

159 
	`gss_ªÀa£_buf„r
(&
mö_°©
, &
°©°r
);

160 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

161 } 
buÊí
 > 1 && 
msg_˘x
 !0 && !
	`GSS_ERROR
(
maj_°©
));

163 
msg_˘x
 = 0;

171 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

172 
maj_°©
 = 
	`gss_di•œy_°©us
(&
mö_°©
,

173 
mö‹_°©us
,

174 
GSS_C_MECH_CODE
,

175 
GSS_C_NULL_OID
,

176 &
msg_˘x
,

177 &
°©°r
);

178 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

180 i‡(!
	`GSS_ERROR
(
maj_°©
)) {

181 
w
 = 
	`¢¥ötf
(
buf
, 
buÊí
,

182 "%.*s. ", ()
°©°r
.
Àngth
, (*)°©°r.
vÆue
);

183 
buf
 +
w
;

184 
buÊí
 -
w
;

187 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

188 
	`gss_ªÀa£_buf„r
(&
mö_°©
, &
°©°r
);

189 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

190 } 
buÊí
 > 1 && 
msg_˘x
 !0 && !
	`GSS_ERROR
(
maj_°©
));

193 
	}
}

196 
	$gsßpi_ícode
(
öput_tokí
, 
gs
, 
ouçut_tokí
)

197 c⁄° 
gss_buf„r_t
 
öput_tokí
;

198 
gsßpi_°©e_t
 *
gs
;

199 
gss_buf„r_t
 
ouçut_tokí
;

201 c⁄° *
fun˘i⁄
 = "gssapi_encode()";

202 
gss_buf„r_desc
 
ícoded_tokí
;

203 
OM_uöt32
 
mö‹_°©us
, 
maj‹_°©us
;

204 #i‡
SOCKS_CLIENT


205 
sig£t_t
 
ﬁd£t
;

207 
emsg
[1024];

208 
c⁄f_°©e
;

210 
	`¶og
(
LOG_DEBUG
, "%s, inputÜength %lu, max outputÜength %lu",

211 
fun˘i⁄
,

212 ()
öput_tokí
->
Àngth
,

213 ()
ouçut_tokí
->
Àngth
);

215 #i‡
SOCKS_CLIENT
 && 
SOCKSLIBRARY_DYNAMIC


216 
	`socks_m¨k_io_as_«tive
();

219 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

220 
maj‹_°©us
 = 
	`gss_wøp
(&
mö‹_°©us
,

221 
gs
->
id
,

222 
gs
->
¥Ÿe˘i⁄
 =
GSSAPI_CONFIDENTIALITY
 ?

223 
GSS_REQ_CONF
 : 
GSS_REQ_INT
,

224 
GSS_C_QOP_DEFAULT
,

225 
öput_tokí
,

226 &
c⁄f_°©e
,

227 &
ícoded_tokí
);

228 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

230 #i‡
SOCKS_CLIENT
 && 
SOCKSLIBRARY_DYNAMIC


231 
	`socks_m¨k_io_as_n‹mÆ
();

234 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

235 
	`sw¨nx
("%s: gss_wøp(): %s", 
fun˘i⁄
, 
emsg
);

239 i‡(
ícoded_tokí
.
Àngth
 > 
öput_tokí
->length) {

240 i‡(((
ícoded_tokí
.
Àngth
 + 
GSSAPI_HLEN
Ë- 
öput_tokí
->length)

241 > 
gs
->
gssovîhód
) {

242 
	`¶og
(
LOG_DEBUG
,

244 
fun˘i⁄
,

245 ()
gs
->
gssovîhód
,

246 ()((
ícoded_tokí
.
Àngth
 + 
GSSAPI_HLEN
)

247 - 
öput_tokí
->
Àngth
));

249 
gs
->
gssovîhód
 = (
ícoded_tokí
.
Àngth
 + 
GSSAPI_HLEN
)

250 - 
öput_tokí
->
Àngth
;

254 i‡(
ícoded_tokí
.
Àngth
 > 
ouçut_tokí
->length) {

255 
	`¶og
(
LOG_NOTICE
,

257 
fun˘i⁄
,

258 ()
ícoded_tokí
.
Àngth
,

259 ()
ouçut_tokí
->
Àngth
);

261 
	`CLEAN_GSS_TOKEN
(
ícoded_tokí
);

263 
î∫o
 = 
EMSGSIZE
;

267 
ouçut_tokí
->
Àngth
 = 
ícoded_tokí
.length;

268 
	`mem˝y
(
ouçut_tokí
->
vÆue
, 
ícoded_tokí
.vÆue,Éncoded_tokí.
Àngth
);

270 
	`CLEAN_GSS_TOKEN
(
ícoded_tokí
);

272 i‡(
ouçut_tokí
->
Àngth
 >= 4)

273 
	`¶og
(
LOG_DEBUG
,

279 
fun˘i⁄
,

280 ()
öput_tokí
->
Àngth
,

281 ()
ouçut_tokí
->
Àngth
,

283 ((*)(
ouçut_tokí
->
vÆue
))[0],

285 ((*)(
ouçut_tokí
->
vÆue
))[1],

287 ((*)(
ouçut_tokí
->
vÆue
))[2],

289 ((*)(
ouçut_tokí
->
vÆue
))[3],

290 ()(
ouçut_tokí
->
Àngth
 - 4),

291 ((*)(
ouçut_tokí
->
vÆue
))[ouçut_tokí->
Àngth
 - 4],

292 ()(
ouçut_tokí
->
Àngth
 - 3),

293 ((*)(
ouçut_tokí
->
vÆue
))[ouçut_tokí->
Àngth
 - 3],

294 ()(
ouçut_tokí
->
Àngth
 - 2),

295 ((*)(
ouçut_tokí
->
vÆue
))[ouçut_tokí->
Àngth
 - 2],

296 ()(
ouçut_tokí
->
Àngth
 - 1),

297 ((*)(
ouçut_tokí
->
vÆue
))[ouçut_tokí->
Àngth
 - 1]);

300 
	}
}

303 
	$gsßpi_decode
(
öput_tokí
, 
gs
, 
ouçut_tokí
)

304 c⁄° 
gss_buf„r_t
 
öput_tokí
;

305 
gsßpi_°©e_t
 *
gs
;

306 
gss_buf„r_t
 
ouçut_tokí
;

308 c⁄° *
fun˘i⁄
 = "gssapi_decode()";

309 
gss_buf„r_desc
 
decoded_tokí
;

310 
OM_uöt32
 
mö‹_°©us
, 
maj‹_°©us
;

311 #i‡
SOCKS_CLIENT


312 
sig£t_t
 
ﬁd£t
;

314 
emsg
[1024];

315 
ªq_c⁄f_°©e
;

317 
	`¶og
(
LOG_DEBUG
, "%s, inputÜength %lu, max outputÜength %lu",

318 
fun˘i⁄
,

319 ()
öput_tokí
->
Àngth
,

320 ()
ouçut_tokí
->
Àngth
);

322 i‡(
gs
->
¥Ÿe˘i⁄
 =
GSSAPI_CONFIDENTIALITY
)

323 
ªq_c⁄f_°©e
 = 
GSS_REQ_CONF
;

325 
ªq_c⁄f_°©e
 = 
GSS_REQ_INT
;

327 #i‡
SOCKS_CLIENT
 && 
SOCKSLIBRARY_DYNAMIC


328 
	`socks_m¨k_io_as_«tive
();

331 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

332 
maj‹_°©us
 = 
	`gss_unwøp
(&
mö‹_°©us
,

333 
gs
->
id
,

334 
öput_tokí
,

335 &
decoded_tokí
,

336 &
ªq_c⁄f_°©e
,

337 
GSS_C_QOP_DEFAULT
);

338 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

340 #i‡
SOCKS_CLIENT
 && 
SOCKSLIBRARY_DYNAMIC


341 
	`socks_m¨k_io_as_n‹mÆ
();

344 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

345 
	`¶og
(
	`GSSERR_IS_OK
(
maj‹_°©us
Ë? 
LOG_DEBUG


346 : 
SOCKS_CLIENT
 ?

347 
LOG_WARNING
 : 
LOG_NOTICE
,

350 
fun˘i⁄
,

351 ()
öput_tokí
->
Àngth
,

352 
emsg
);

354 #i‡
DIAGNOSTIC


355 i‡(!
	`GSSERR_IS_OK
(
maj‹_°©us
))

356 
	`SWARNX
(0);

359 
î∫o
 = 0;

363 i‡(
decoded_tokí
.
Àngth
 > 
ouçut_tokí
->length) {

364 
	`sw¨nx
("%s: output bufferÅoo small. Need %lu bytes, but have only %lu",

365 
fun˘i⁄
,

366 ()
decoded_tokí
.
Àngth
,

367 ()
ouçut_tokí
->
Àngth
);

369 
	`CLEAN_GSS_TOKEN
(
decoded_tokí
);

371 
î∫o
 = 
ENOMEM
;

375 
ouçut_tokí
->
Àngth
 = 
decoded_tokí
.length;

376 
	`mem˝y
(
ouçut_tokí
->
vÆue
, 
decoded_tokí
.vÆue, decoded_tokí.
Àngth
);

378 
	`CLEAN_GSS_TOKEN
(
decoded_tokí
);

380 
	`¶og
(
LOG_DEBUG
, "%s: gssapiÖacket decoded. Decoded/encodedÜength %lu/%lu",

381 
fun˘i⁄
,

382 ()
ouçut_tokí
->
Àngth
,

383 ()
öput_tokí
->
Àngth
);

386 
	}
}

398 
ssize_t


399 
	$gsßpi_decode_ªad
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
, 
ªcvÊags
, 
gs
)

400 
s
;

401 *
buf
;

402 
size_t
 
Àn
;

403 
Êags
;

404 
sockaddr_°‹age
 *
‰om
;

405 
sockÀn_t
 *
‰omÀn
;

406 
ªcv‰om_öfo_t
 *
ªcvÊags
;

407 
gsßpi_°©e_t
 *
gs
;

409 c⁄° *
fun˘i⁄
 = "gssapi_decode_read()";

410 
gss_buf„r_desc
 
öput_tokí
, 
ouçut_tokí
;

411 
iobuf„r_t
 *
iobuf
 = 
NULL
;

412 
ícodedÀn
;

413 
öputmem
[(
iobuf
->
buf
[0])],

414 
ouçutmem
[(
iobuf
->
buf
[0])];

415 
ssize_t
 
ƒód
, 
ícoded_À·_to_ªad
;

416 
size_t
 
tokínumbî
, 
p
, 
ªad‰ombuf
, 
möt‹ód
;

417 
emsg
[512];

419 i‡(
iobuf
 =
NULL
 && (iobu‡
	`socks_gëbuf„r
(
s
)) == NULL) {

420 
°y≥
;

422 i‡(
ªcvÊags
 !
NULL
)

423 
°y≥
 = 
ªcvÊags
->
ty≥
;

425 
sockÀn_t
 
éí
 = (
°y≥
);

427 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
°y≥
, &
éí
) != 0) {

428 
	`sw¨n
("%s: gësock›t(SO_TYPE)", 
fun˘i⁄
);

433 i‡((
iobuf
 = 
	`socks_Ælocbuf„r
(
s
, 
°y≥
)Ë=
NULL
) {

434 
	`sw¨nx
("%s: couldÇŸáŒoˇã iobuf„r", 
fun˘i⁄
);

436 
î∫o
 = 
ENOMEM
;

441 i‡(
iobuf
->
°y≥
 =
SOCK_DGRAM
)

442  
	`gsßpi_decode_ªad_udp
(
s
,

443 
buf
,

444 
Àn
,

445 
Êags
,

446 
‰om
,

447 
‰omÀn
,

448 
ªcvÊags
,

449 
gs
,

450 
ouçutmem
,

451 (
ouçutmem
));

453 i‡(
ªcvÊags
 !
NULL
)

454 
ªcvÊags
->
‰omsockë
 = 0;

456 #i‡
SOCKS_CLIENT


461 i‡(
	`socks_Êushbuf„r
(
s
, -1, 
NULL
) == -1)

467 
	`SASSERTX
(!(
Êags
 & 
MSG_WAITALL
));

471 i‡(
Êags
 & 
MSG_WAITALL
)

472 
möt‹ód
 = 
Àn
;

473 i‡(
	`fdisblockög
(
s
))

474 
möt‹ód
 = 1;

476 
möt‹ód
 = 0;

483 
agaö
:

485 
	`¶og
(
LOG_DEBUG
,

487 
fun˘i⁄
,

488 
s
,

489 ()
Àn
,

490 
Êags
,

491 ()
möt‹ód
,

492 ()
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 0),

493 ()
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 1));

495 i‡(
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 0Ë>
möt‹ód
) {

502 
ªad‰ombuf
 = 
	`socks_gë‰ombuf„r
(
s
, 
Êags
, 
READ_BUF
, 0, 
buf
, 
Àn
);

505 
ªad‰ombuf
 = 0;

507 #i‡
SOCKS_CLIENT


535 
	`døösockë
(
iobuf
,

536 
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 0) == 0,

537 
öputmem
,

538 (
öputmem
));

541 i‡(
ªad‰ombuf
 > 0) {

542 
	`¶og
(
LOG_DEBUG
,

544 
fun˘i⁄
,

545 ()
ªad‰ombuf
,

546 #i‡
SOCKS_CLIENT


547 ()
iobuf
->
öfo
[
READ_BUF
].
ªadÆªady


553  
ªad‰ombuf
;

556 
	`¶og
(
LOG_DEBUG
, "%s: mintoread = %lu. WillÅryÅoÑead more from fd %d",

557 
fun˘i⁄
, ()
möt‹ód
, 
s
);

569 i‡(
möt‹ód
 > 0)

570 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 0Ë< 
möt‹ód
);

576 #i‡
SOCKS_CLIENT


585 
ƒód
 = 
	`ªcv
(
s
,

586 
öputmem
,

587 
	`MIN
((
öputmem
), 
	`socks_‰ìöbuf„r
(
s
, 
READ_BUF
)),

588 (
Êags
 | 
MSG_PEEK
)

595 
ƒód
 = 
	`ªcv
(
s
,

596 
öputmem
,

597 
	`MIN
((
öputmem
), 
	`socks_‰ìöbuf„r
(
s
, 
READ_BUF
)),

598 
Êags


602 
	`¶og
(
LOG_DEBUG
,

604 
fun˘i⁄
, 
s
, ()
ƒód
, 
	`°ªº‹
(
î∫o
));

606 i‡(
ƒód
 <= 0) {

607 i‡(
möt‹ód
 == 0)

608  
ƒód
;

610 i‡(
î∫o
 =
EAGAIN
) {

611 
	`¶og
(
LOG_DEBUG
,

614 
fun˘i⁄
, 
s
, 
	`°ªº‹
(
î∫o
), ()
möt‹ód
);

616 
ƒód
 = 0;

619  
ƒód
;

622 i‡(
ƒód
 > 0) {

623 i‡(
ªcvÊags
 !
NULL
)

624 
ªcvÊags
->
‰omsockë
 +
ƒód
;

626 #i‡
SOCKS_CLIENT


627 
iobuf
->
öfo
[
READ_BUF
].
ªadÆªady
 +
ƒód
;

630 
	`socks_addtobuf„r
(
s
, 
READ_BUF
, 1, 
öputmem
, 
ƒód
);

642 
tokínumbî
 = 0;

643 
ícoded_À·_to_ªad
 = -1;

645 
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 1Ë>
GSSAPI_HLEN
) {

646 
p
 = 
	`socks_gë‰ombuf„r
(
s
, 
MSG_PEEK
, 
READ_BUF
, 1, 
öputmem
, 
GSSAPI_HLEN
);

648 
	`SASSERTX
(
p
 =
GSSAPI_HLEN
);

650 i‡(!
	`gsßpi_hódîisok
(
öputmem
, 
p
, &
ícodedÀn
, 
emsg
, (emsg))) {

651 
	`¶og
(
LOG_NOTICE
,

653 
fun˘i⁄
, 
s
, 
	`≥î«me2°rög
(s, 
NULL
, 0), 
emsg
);

655 
î∫o
 = 
EPROTO
;

659 
ícoded_À·_to_ªad
 = ()(
GSSAPI_HLEN
 + 
ícodedÀn
)

660 - 
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 1);

662 
	`¶og
(
LOG_DEBUG
,

665 
fun˘i⁄
,

666 (Ë
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 1)

667 - 
GSSAPI_HLEN
,

668 ()(
ícoded_À·_to_ªad
));

670 i‡(
ícoded_À·_to_ªad
 > 0)

677 
ícoded_À·_to_ªad
 = -1;

679 
	`SASSERTX
((
size_t
)(
GSSAPI_HLEN
 + 
ícodedÀn
Ë<(
öputmem
));

681 
ªad‰ombuf
 = 
	`socks_gë‰ombuf„r
(
s
,

683 
READ_BUF
,

685 
öputmem
,

686 
GSSAPI_HLEN
 + 
ícodedÀn
);

688 
	`SASSERTX
(
ªad‰ombuf
 =(
size_t
)(
GSSAPI_HLEN
 + 
ícodedÀn
));

690 i‡(
sockscf
.
›ti⁄
.
debug
 >2 && 
ícodedÀn
 >= 4)

691 
	`¶og
(
LOG_DEBUG
,

697 
fun˘i⁄
,

698 ()++
tokínumbî
,

699 
ícodedÀn
,

701 
öputmem
[
GSSAPI_HLEN
 + 0],

703 
öputmem
[
GSSAPI_HLEN
 + 1],

705 
öputmem
[
GSSAPI_HLEN
 + 2],

707 
öputmem
[
GSSAPI_HLEN
 + 3],

708 ()(
ícodedÀn
 - 4),

709 
öputmem
[
ªad‰ombuf
 - 4],

710 ()(
ícodedÀn
 - 3),

711 
öputmem
[
ªad‰ombuf
 - 3],

712 ()(
ícodedÀn
 - 2),

713 
öputmem
[
ªad‰ombuf
 - 2],

714 ()(
ícodedÀn
 - 1),

715 
öputmem
[
ªad‰ombuf
 - 1]);

717 
öput_tokí
.
vÆue
 = 
öputmem
 + 
GSSAPI_HLEN
;

718 
öput_tokí
.
Àngth
 = 
ªad‰ombuf
 - 
GSSAPI_HLEN
;

720 
ouçut_tokí
.
vÆue
 = 
ouçutmem
;

721 
ouçut_tokí
.
Àngth
 = (
ouçutmem
);

723 i‡(
	`gsßpi_decode
(&
öput_tokí
, 
gs
, &
ouçut_tokí
) != 0) {

724 
	`¶og
(
LOG_DEBUG
,

726 
fun˘i⁄
, 
ícodedÀn
);

728 
î∫o
 = 
EPROTO
;

737 
	`socks_addtobuf„r
(
s
,

738 
READ_BUF
,

740 (*)
ouçut_tokí
.
vÆue
,

741 
ouçut_tokí
.
Àngth
);

744 i‡(
ícoded_À·_to_ªad
 == -1) {

745 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 1Ë< 
GSSAPI_HLEN
);

747 
ícoded_À·_to_ªad
 = 
GSSAPI_HLEN
 - 
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 1);

749 
	`¶og
(
LOG_DEBUG
, "%s:ÉncodedÜeftÅoÑead was -1. ChangedÅo %ld",

750 
fun˘i⁄
, ()
ícoded_À·_to_ªad
);

753 i‡(
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 0Ë>
möt‹ód
) {

754 
	`¶og
(
LOG_DEBUG
, "%s:Énough decoded data bufferedÅoÑeturn %luÇow",

755 
fun˘i⁄
, ()
möt‹ód
);

757 
agaö
;

764 #i‡
SOCKS_CLIENT


768 
	`døösockë
(
iobuf
, 1, 
öputmem
, (inputmem));

771 i‡(
sockscf
.
›ti⁄
.
debug
)

772 
	`¶og
(
LOG_DEBUG
,

775 
fun˘i⁄
,

776 
s
,

777 
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 0),

778 ()
möt‹ód
,

779 ()
ícoded_À·_to_ªad
);

781 
ƒód
 = 
	`ªcv
(
s
,

782 
öputmem
,

783 
ícoded_À·_to_ªad
,

784 (
Êags
 | 
MSG_PEEK
Ë| 
MSG_WAITALL
);

786 
	`¶og
(
LOG_DEBUG
,

789 
fun˘i⁄
,

790 
s
,

791 ()
ƒód
,

792 
ƒód
 >2 ? 
öputmem
[nread - 2] : 0,

793 
ƒód
 >2 ? 
öputmem
[nread - 1] : 0,

794 
î∫o
,

795 
	`°ªº‹
(
î∫o
));

797 i‡(
ƒód
 <= 0)

798  
ƒód
;

805 
agaö
;

806 
	}
}

819 
ssize_t


820 
	$gsßpi_ícode_wrôe
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
, 
£ndtoÊags
, 
gs
)

821 
s
;

822 c⁄° *
msg
;

823 
size_t
 
Àn
;

824 
Êags
;

825 c⁄° 
sockaddr_°‹age
 *
to
;

826 
sockÀn_t
 
tﬁí
;

827 
£ndto_öfo_t
 *
£ndtoÊags
;

828 
gsßpi_°©e_t
 *
gs
;

830 c⁄° *
fun˘i⁄
 = "gssapi_encode_write()";

831 
gss_buf„r_desc
 
öput_tokí
, 
ouçut_tokí
;

832 
ouçutmem
[
GSSAPI_HLEN
 + 
MAXGSSAPITOKENLEN
];

833 
psh‹t
;

834 
iobuf„r_t
 *
iobuf
;

835 
ssize_t
 
towrôe
, 
wrôãn
, 
p
, 
ícodedÀn
, 
addedtobuf
;

836 
size_t
 
i
;

839 
size_t
 
j
;

840 
size_t
 
Ànv
[] = { 60000, 60001, 60002, 60003, 60004, 60005, 60006, 60007,

843 
Àn
 = 
	`MIN
(
Ànv
[
j
 % 
	`ELEMENTS
(lenv)],Üen);

844 ++
j
;

847 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Üen %lu, gssoverhead %lu",

848 
fun˘i⁄
, 
s
, ()
Àn
, ()
gs
->
gssovîhód
);

850 i‡((
iobuf
 = 
	`socks_gëbuf„r
(
s
)Ë=
NULL
) {

854 
°y≥
;

855 
sockÀn_t
 
éí
 = (
°y≥
);

861 
	`SASSERTX
(
SOCKS_CLIENT
);

863 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
°y≥
, &
éí
) != 0) {

864 
	`sw¨n
("%s: gësock›t(SO_TYPEË⁄ fd %d faûed", 
fun˘i⁄
, 
s
);

868 i‡((
iobuf
 = 
	`socks_Ælocbuf„r
(
s
, 
°y≥
)Ë=
NULL
) {

869 
	`sw¨n
("%s: couldÇŸáŒoˇã iobuf„∏f‹ fd %d", 
fun˘i⁄
, 
s
);

871 
î∫o
 = 
ENOMEM
;

876 i‡(
iobuf
->
°y≥
 =
SOCK_DGRAM
)

877  
	`gsßpi_ícode_wrôe_udp
(
s
,

878 
msg
,

879 
Àn
,

880 
Êags
,

881 
to
,

882 
tﬁí
,

883 
£ndtoÊags
,

884 
gs
,

885 
ouçutmem
,

886 (
ouçutmem
));

888 #i‡
SOCKS_CLIENT


905 i‡(
iobuf
->
öfo
[
WRITE_BUF
].
mode
 !
_IONBF
) {

910 i‡(
Êags
 & 
MSG_OOB
)

911 
	`sw¨nx
("%s: oob data is currentlyÇot handled for buffered writes",

912 
fun˘i⁄
);

914 i‡(
	`socks_‰ìöbuf„r
(
s
, 
WRITE_BUF
Ë< 
Àn
) {

918 i‡(
	`socks_Êushbuf„r
(
s
, -1, 
£ndtoÊags
) == -1)

922 i‡(
	`socks_‰ìöbuf„r
(
s
, 
WRITE_BUF
Ë< 
Àn
) {

923 i‡(
î∫o
 == 0)

924 
î∫o
 = 
EAGAIN
;

929 
	`SASSERTX
(
	`socks_‰ìöbuf„r
(
s
, 
WRITE_BUF
Ë>
Àn
);

931 
	`socks_addtobuf„r
(
s
, 
WRITE_BUF
, 0, 
msg
, 
Àn
);

933 i‡(
Àn
 >= 2) {

934 i‡(
	`memchr
((c⁄° *)
msg
, '\r', 
Àn
Ë!
NULL


935 || 
	`memchr
((c⁄° *)
msg
, '\n', 
Àn
Ë!
NULL
) {

942 ()
	`socks_Êushbuf„r
(
s
, -1, 
£ndtoÊags
);

946  
Àn
;

953 i‡((
towrôe
 = 
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1)) > 0) {

960 
	`SASSERTX
(
iobuf
->
°y≥
 =
SOCK_STREAM
);

962 i‡(
	`socks_Êushbuf„r
(
s
, -1, 
£ndtoÊags
) == -1)

971 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1) == 0);

981 
ouçut_tokí
.
Àngth
 = 
	`MIN
((
ouçutmem
Ë- 
GSSAPI_HLEN
,

982 
	`socks_‰ìöbuf„r
(
s
, 
WRITE_BUF
Ë- 
GSSAPI_HLEN
);

985 
ouçut_tokí
.
vÆue
 = 
ouçutmem
 + 
GSSAPI_HLEN
;

987 i‡(
gs
->
maxgssd©a
 != 0)

988 
Àn
 = 
	`MIN
÷í, 
gs
->
maxgssd©a
);

990 
p
 = 
	`MIN
(
Àn
, 
	`socks_‰ìöbuf„r
(
s
, 
WRITE_BUF
Ë- 
gs
->
gssovîhód
);

992 i‡(
p
 <0 || 
ouçut_tokí
.
Àngth
 < 
gs
->
gssovîhód
) {

993 
	`¶og
(
LOG_DEBUG
,

996 
fun˘i⁄
,

997 ()
	`socks_‰ìöbuf„r
(
s
, 
WRITE_BUF
),

998 ()
gs
->
gssovîhód
);

1000 
î∫o
 = 
EAGAIN
;

1004 i‡(
Àn
 !(
size_t
)
p
)

1005 
	`¶og
(
LOG_DEBUG
, "%s: onlyÑoom in bufferÅoáttempt write of %ld/%lu",

1006 
fun˘i⁄
, ()
p
, ()
Àn
);

1008 
Àn
 = 
p
;

1009 
öput_tokí
.
vÆue
 = 
msg
;

1010 
öput_tokí
.
Àngth
 = 
Àn
;

1012 i‡(
	`gsßpi_ícode
(&
öput_tokí
, 
gs
, &
ouçut_tokí
) != 0) {

1013 i‡(
î∫o
 =
EMSGSIZE
) {

1014 
OM_uöt32
 
mö‹_°©us
, 
maj‹_°©us
, 
maxÀn
;

1015 
emsg
[1024];

1017 
maj‹_°©us


1018 
	`gss_wøp_size_limô
(&
mö‹_°©us
,

1019 
gs
->
id
,

1020 
gs
->
¥Ÿe˘i⁄
 =
GSSAPI_CONFIDENTIALITY
 ?

1021 
GSS_REQ_CONF
 : 
GSS_REQ_INT
,

1022 
GSS_C_QOP_DEFAULT
,

1023 
ouçut_tokí
.
Àngth
,

1024 &
maxÀn
);

1026 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

1027 
	`sw¨nx
("%s: gss_wrap_size_limit(): %lu isÅoo bigáÅoken for "

1030 
fun˘i⁄
, ()
Àn
, 
emsg
);

1035 
	`¶og
(
LOG_DEBUG
,

1038 
fun˘i⁄
, ()
Àn
, ()
maxÀn
);

1040 
Àn
 = 
maxÀn
;

1041 
öput_tokí
.
Àngth
 = 
Àn
;

1043 i‡(
	`gsßpi_ícode
(&
öput_tokí
, 
gs
, &
ouçut_tokí
) == 0)

1044 
î∫o
 = 0;

1046 
	`sw¨nx
("%s: unexpected. gssapi_encode() failed withÅhe shorter "

1048 
fun˘i⁄
, ()
öput_tokí
.
Àngth
);

1050 
î∫o
 = 
ECONNABORTED
;

1054 
	`¶og
(
LOG_DEBUG
,

1056 
fun˘i⁄
, ()
öput_tokí
.
Àngth
);

1062 i‡(
ouçut_tokí
.
Àngth
 + 
GSSAPI_HLEN
 > 
	`socks_‰ìöbuf„r
(
s
, 
WRITE_BUF
)) {

1063 
	`¶og
(
LOG_DEBUG
,

1066 
fun˘i⁄
, ()(
ouçut_tokí
.
Àngth
 + 
GSSAPI_HLEN
));

1068 
î∫o
 = 
EAGAIN
;

1076 
ouçut_tokí
.
vÆue
 = 
ouçutmem
;

1078 
i
 = 0;

1079 ((*)
ouçut_tokí
.
vÆue
)[
i
++] = 
SOCKS_GSSAPI_VERSION
;

1080 ((*)
ouçut_tokí
.
vÆue
)[
i
++] = 
SOCKS_GSSAPI_PACKET
;

1082 
psh‹t
 = 
	`ht⁄s
(
ouçut_tokí
.
Àngth
);

1083 
	`mem˝y
(&((*)
ouçut_tokí
.
vÆue
)[
i
], &
psh‹t
, (pshort));

1084 
i
 +(
psh‹t
);

1086 
	`SASSERTX
(
i
 =
GSSAPI_HLEN
);

1088 
ouçut_tokí
.
Àngth
 +
i
;

1090 
addedtobuf
 = 
	`socks_addtobuf„r
(
s
,

1091 
WRITE_BUF
,

1093 
ouçut_tokí
.
vÆue
,

1094 
ouçut_tokí
.
Àngth
);

1096 
ícodedÀn
 = (
size_t
)
ouçut_tokí
.
Àngth
;

1102 
towrôe
 = 
	`socks_gë‰ombuf„r
(
s
,

1103 
MSG_PEEK
,

1104 
WRITE_BUF
,

1106 
ouçutmem
,

1107 
	`MIN
(
ícodedÀn
, (
ssize_t
)(
ouçutmem
)));

1109 i‡(
towrôe
 >
GSSAPI_HLEN
 + 2)

1110 
	`¶og
(
LOG_DEBUG
,

1113 
fun˘i⁄
,

1114 ()
towrôe
,

1115 
GSSAPI_HLEN
 + 0,

1116 
ouçutmem
[
GSSAPI_HLEN
 + 0],

1117 
GSSAPI_HLEN
 + 1,

1118 
ouçutmem
[
GSSAPI_HLEN
 + 1],

1119 ()
towrôe
 - 2,

1120 
ouçutmem
[
towrôe
 - 2],

1121 ()
towrôe
 - 1,

1122 
ouçutmem
[
towrôe
 - 1]);

1124 
	`¶og
(
LOG_DEBUG
, "%s:áttemptingÅo write %luÉncoded bytes",

1125 
fun˘i⁄
, ()
towrôe
);

1127 i‡((
wrôãn
 = 
	`£ndto
(
s
, 
ouçutmem
, 
towrôe
, 
Êags
, 
	`TOCSA
(
to
), 
tﬁí
)) > 0) {

1128 
	`¶og
(
LOG_DEBUG
, "%s: wrote %ld/%ld bytes",

1129 
fun˘i⁄
, ()
wrôãn
, ()
towrôe
);

1135 
towrôe
 = 
	`socks_gë‰ombuf„r
(
s
, 0, 
WRITE_BUF
, 1, 
ouçutmem
, 
wrôãn
);

1137 i‡(
£ndtoÊags
 !
NULL
)

1138 
£ndtoÊags
->
tosockë
 +
wrôãn
;

1141 i‡(
sockscf
.
›ti⁄
.
debug
)

1142 
	`¶og
(
LOG_DEBUG
,

1145 
fun˘i⁄
,

1146 ()
wrôãn
,

1147 ()
towrôe
,

1148 
s
,

1149 ()
	`socks_‰ìöbuf„r
(
s
, 
WRITE_BUF
),

1150 
î∫o
,

1151 
	`°ªº‹
(
î∫o
));

1153 i‡(
wrôãn
 >= 0)

1157  
Àn
;

1171 i‡(!
	`ERRNOISTMP
(
î∫o
Ë|| 
SOCKS_CLIENT
) {

1172 
	`¶og
(
LOG_DEBUG
,

1175 
fun˘i⁄
, 
î∫o
, 
	`°ªº‹
”ºno), ()
addedtobuf
, ()
wrôãn
);

1177 
p
 = 
	`socks_gë‰ombuf„r
(
s
, 0, 
WRITE_BUF
, 1, 
ouçutmem
, 
addedtobuf
);

1178 
	`SASSERTX
(
p
 =
addedtobuf
);

1180 
	`SASSERTX
(
wrôãn
 < 0);

1181  
wrôãn
;

1188 
	`SASSERTX
(!
SOCKS_CLIENT
);

1190  
Àn
;

1191 
	}
}

1194 
	$gsßpi_exp‹t_°©e
(
id
, 
°©e
)

1195 
gss_˘x_id_t
 *
id
;

1196 
gss_buf„r_desc
 *
°©e
;

1198 c⁄° *
fun˘i⁄
 = "gssapi_export_state()";

1199 c⁄° 
î∫o_s
 = 
î∫o
;

1200 
OM_uöt32
 
maj‹_°©us
, 
mö‹_°©us
;

1201 
gss_buf„r_desc
 
tokí
;

1202 
emsg
[512];

1203 #i‡
SOCKS_CLIENT


1204 
sig£t_t
 
ﬁd£t
;

1207 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

1209 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

1210 
maj‹_°©us
 = 
	`gss_exp‹t_£c_c⁄ãxt
(&
mö‹_°©us
, 
id
, &
tokí
);

1211 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

1213 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

1214 
	`sw¨nx
("%s: gss_exp‹t_£c_c⁄ãxt(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

1218 i‡(
tokí
.
Àngth
 > 
°©e
->length) {

1219 
	`sw¨nx
("%s: we depend onÅhe size ofÅheÉxported gssapi contextÇot "

1222 
fun˘i⁄
,

1223 ()
°©e
->
Àngth
,

1224 ()
tokí
.
Àngth
);

1226 
	`SWARNX
(0);

1231 
	`SASSERTX
(
tokí
.
Àngth
 <
°©e
->length);

1232 
	`mem˝y
(
°©e
->
vÆue
, 
tokí
.vÆue,Åokí.
Àngth
);

1233 
°©e
->
Àngth
 = 
tokí
.length;

1235 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

1236 
	`gss_ªÀa£_buf„r
(&
mö‹_°©us
, &
tokí
);

1237 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

1239 
	`¶og
(
LOG_DEBUG
,

1241 
fun˘i⁄
,

1242 ()
°©e
->
Àngth
,

1243 ((*)
°©e
->
vÆue
)[0],

1244 ((*)
°©e
->
vÆue
)[1]);

1246 
î∫o
 = 
î∫o_s
;

1248 
	}
}

1251 
	$gsßpi_imp‹t_°©e
(
id
, 
°©e
)

1252 
gss_˘x_id_t
 *
id
;

1253 
gss_buf„r_desc
 *
°©e
;

1255 c⁄° *
fun˘i⁄
 = "gssapi_import_state()";

1256 c⁄° 
î∫o_s
 = 
î∫o
;

1257 
OM_uöt32
 
maj‹_°©us
, 
mö‹_°©us
;

1258 
emsg
[512];

1259 #i‡
SOCKS_CLIENT


1260 
sig£t_t
 
ﬁd£t
;

1263 
	`¶og
(
LOG_DEBUG
,

1265 
fun˘i⁄
,

1266 ()
°©e
->
Àngth
,

1267 ((*)
°©e
->
vÆue
)[0],

1268 ((*)
°©e
->
vÆue
)[1]);

1270 
	`SOCKS_SIGBLOCK_IF_CLIENT
(
SIGIO
, &
ﬁd£t
);

1271 
maj‹_°©us
 = 
	`gss_imp‹t_£c_c⁄ãxt
(&
mö‹_°©us
, 
°©e
, 
id
);

1272 
	`SOCKS_SIGUNBLOCK_IF_CLIENT
(&
ﬁd£t
);

1274 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

1275 
	`sw¨nx
("%s: gss_imp‹t_£c_c⁄ãxt(): %s", 
fun˘i⁄
, 
emsg
);

1279 
î∫o
 = 
î∫o_s
;

1282 
	}
}

1285 
	$gsßpi_hódîisok
(
hódîbuf
, 
Àn
, 
tokíÀn
, 
emsg
, 
emsgÀn
)

1286 c⁄° *
hódîbuf
;

1287 c⁄° 
size_t
 
Àn
;

1288 *
tokíÀn
;

1289 *
emsg
;

1290 c⁄° 
size_t
 
emsgÀn
;

1292 c⁄° *
fun˘i⁄
 = "gssapi_headerisok()";

1294 i‡(
Àn
 < 
GSSAPI_HLEN
) {

1295 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1297 ()
Àn
, ()
GSSAPI_HLEN
);

1301 i‡(
hódîbuf
[
GSSAPI_VERSION
] !
SOCKS_GSSAPI_VERSION


1302 || 
hódîbuf
[
GSSAPI_STATUS
] !
SOCKS_GSSAPI_PACKET
) {

1303 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1305 ()
hódîbuf
[
GSSAPI_VERSION
],

1306 ()
hódîbuf
[
GSSAPI_STATUS
],

1307 
SOCKS_GSSAPI_VERSION
,

1308 
SOCKS_GSSAPI_PACKET
);

1313 
	`mem˝y
(
tokíÀn
, &
hódîbuf
[
GSSAPI_TOKEN_LENGTH
], (*tokenlen));

1314 *
tokíÀn
 = 
	`¡ohs
(*tokenlen);

1316 
	`¶og
(
LOG_DEBUG
, "%s: SOCKS header for GSSAPIÅoken ofÜength %u is ok",

1317 
fun˘i⁄
, *
tokíÀn
);

1320 
	}
}

1322 #i‡
SOCKS_CLIENT


1324 
	$gsßpi_i£n¸y±ed
(
s
)

1325 c⁄° 
s
;

1327 
socksfd_t
 
socksfd
;

1329 i‡(!
sockscf
.
°©e
.
havegsßpisockës
)

1333 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1)) {

1334 
	`socks_rmaddr
(
s
, 1);

1338 i‡(
socksfd
.
°©e
.
auth
.
mëhod
 !
AUTHMETHOD_GSSAPI
)

1341  
socksfd
.
°©e
.
auth
.
md©a
.
gsßpi
.°©e.
wøp
;

1342 
	}
}

1346 
ssize_t


1347 
	$gsßpi_decode_ªad_udp
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
, 
ªcvÊags
, 
gs
,

1348 
tokí
, 
tokísize
)

1349 
s
;

1350 *
buf
;

1351 
size_t
 
Àn
;

1352 
Êags
;

1353 
sockaddr_°‹age
 *
‰om
;

1354 
sockÀn_t
 *
‰omÀn
;

1355 
ªcv‰om_öfo_t
 *
ªcvÊags
;

1356 
gsßpi_°©e_t
 *
gs
;

1357 *
tokí
;

1358 c⁄° 
size_t
 
tokísize
;

1360 c⁄° *
fun˘i⁄
 = "gssapi_decode_read_udp()";

1361 
gss_buf„r_desc
 
öput_tokí
, 
ouçut_tokí
;

1362 
ícodedÀn
;

1363 
ssize_t
 
ƒód
;

1364 
emsg
[512];

1366 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Üen %lu, flags %d",

1367 
fun˘i⁄
, 
s
, ()
Àn
, 
Êags
);

1375 i‡((
ƒód
 = 
	`socks_ªcv‰om
(
s
,

1376 
tokí
,

1377 
tokísize
,

1378 
Êags
,

1379 
‰om
,

1380 
‰omÀn
,

1381 
ªcvÊags
,

1382 
NULL
)) <= 0) {

1383 
	`¶og
(
LOG_DEBUG
, "%s:Ñead from fd %dÑeturned %ld: %s",

1384 
fun˘i⁄
, 
s
, ()
ƒód
, 
	`°ªº‹
(
î∫o
));

1386  
ƒód
;

1389 
	`¶og
(
LOG_DEBUG
, "%s:Ñead %ld/%lu from socket",

1390 
fun˘i⁄
, ()
ƒód
, ()
tokísize
);

1392 i‡(
ƒód
 < 
GSSAPI_HLEN
) {

1393 
	`¶og
(
LOG_NOTICE
,

1396 
fun˘i⁄
,

1397 
s
,

1398 
	`sockë2°rög
(
s
, 
NULL
, 0),

1399 ()
ƒód
,

1400 ()
GSSAPI_HLEN
);

1402 
î∫o
 = 
ENOMSG
;

1406 i‡(!
	`gsßpi_hódîisok
(
tokí
, 
ƒód
, &
ícodedÀn
, 
emsg
, (emsg))) {

1407 
	`¶og
(
LOG_NOTICE
,

1409 
fun˘i⁄
, 
s
, 
	`sockë2°rög
(s, 
NULL
, 0), 
emsg
);

1411 
î∫o
 = 
ENOMSG
;

1415 i‡(
ƒód
 < 
GSSAPI_HLEN
 + 
ícodedÀn
) {

1416 
	`¶og
(
LOG_NOTICE
,

1419 
fun˘i⁄
,

1420 
s
,

1421 
	`sockë2°rög
(
s
, 
NULL
, 0),

1422 ()(
GSSAPI_HLEN
 + 
ícodedÀn
),

1423 ()
ƒód
);

1425 
î∫o
 = 
ENOMSG
;

1429 
	`¶og
(
LOG_DEBUG
, "%s:Ñead completeÅoken ofÉncoded size %d + %u",

1430 
fun˘i⁄
, 
GSSAPI_HLEN
, 
ícodedÀn
);

1432 
öput_tokí
.
vÆue
 = 
tokí
 + 
GSSAPI_HLEN
;

1433 
öput_tokí
.
Àngth
 = 
ƒód
 - 
GSSAPI_HLEN
;

1435 
ouçut_tokí
.
vÆue
 = 
buf
;

1436 
ouçut_tokí
.
Àngth
 = 
Àn
;

1438 i‡(
	`gsßpi_decode
(&
öput_tokí
, 
gs
, &
ouçut_tokí
) != 0) {

1439 
	`¶og
(
LOG_NOTICE
,

1441 
fun˘i⁄
,

1442 
ícodedÀn
,

1443 
î∫o
 =
ENOMEM
 ? "ouçuàbuf„∏toÿsmÆl" : 
	`°ªº‹
(errno));

1445 i‡(
î∫o
 =
ENOMEM
) {

1446 #i‡!
SOCKS_CLIENT


1447 
	`SWARNX
(
Àn
);

1451 
î∫o
 = 
ENOMSG
;

1455  
ouçut_tokí
.
Àngth
;

1456 
	}
}

1458 
ssize_t


1459 
	$gsßpi_ícode_wrôe_udp
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
, 
£ndtoÊags
, 
gs
,

1460 
tokí
, 
tokísize
)

1461 
s
;

1462 c⁄° *
msg
;

1463 
size_t
 
Àn
;

1464 
Êags
;

1465 c⁄° 
sockaddr_°‹age
 *
to
;

1466 
sockÀn_t
 
tﬁí
;

1467 
£ndto_öfo_t
 *
£ndtoÊags
;

1468 
gsßpi_°©e_t
 *
gs
;

1469 *
tokí
;

1470 c⁄° 
size_t
 
tokísize
;

1472 c⁄° *
fun˘i⁄
 = "gssapi_encode_write_udp()";

1473 
gss_buf„r_desc
 
öput_tokí
, 
ouçut_tokí
;

1474 
psh‹t
;

1475 
ssize_t
 
towrôe
, 
wrôãn
;

1476 
size_t
 
i
;

1478 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Üen %lu, gssoverhead %lu",

1479 
fun˘i⁄
, 
s
, ()
Àn
, ()
gs
->
gssovîhód
);

1482 
ouçut_tokí
.
Àngth
 = 
tokísize
 - 
GSSAPI_HLEN
;

1485 
ouçut_tokí
.
vÆue
 = 
tokí
 + 
GSSAPI_HLEN
;

1487 
öput_tokí
.
vÆue
 = 
msg
;

1488 
öput_tokí
.
Àngth
 = 
Àn
;

1490 i‡(
	`gsßpi_ícode
(&
öput_tokí
, 
gs
, &
ouçut_tokí
) != 0)

1497 
ouçut_tokí
.
vÆue
 = 
tokí
;

1499 
i
 = 0;

1500 ((*)
ouçut_tokí
.
vÆue
)[
i
++] = 
SOCKS_GSSAPI_VERSION
;

1501 ((*)
ouçut_tokí
.
vÆue
)[
i
++] = 
SOCKS_GSSAPI_PACKET
;

1503 
psh‹t
 = 
	`ht⁄s
(
ouçut_tokí
.
Àngth
);

1504 
	`mem˝y
(&((*)
ouçut_tokí
.
vÆue
)[
i
], &
psh‹t
, (pshort));

1505 
i
 +(
psh‹t
);

1507 
	`SASSERTX
(
i
 =
GSSAPI_HLEN
);

1509 
ouçut_tokí
.
Àngth
 +
i
;

1510 
towrôe
 = 
ouçut_tokí
.
Àngth
;

1513 i‡(
towrôe
 >
GSSAPI_HLEN
 + 2)

1514 
	`¶og
(
LOG_DEBUG
,

1517 
fun˘i⁄
,

1518 ()
towrôe
,

1519 
tokí
[0],

1520 
tokí
[1],

1521 ()
towrôe
 - 2,

1522 
tokí
[
towrôe
 - 2],

1523 ()
towrôe
 - 1,

1524 
tokí
[
towrôe
 - 1]);

1526 
	`¶og
(
LOG_DEBUG
, "%s:áttemptingÅo write %luÉncoded bytes",

1527 
fun˘i⁄
, ()
towrôe
);

1529 
wrôãn
 = 
	`£ndto
(
s
, 
tokí
, 
towrôe
, 
Êags
, 
	`TOCSA
(
to
), 
tﬁí
);

1531 i‡(
£ndtoÊags
 !
NULL
 && 
wrôãn
 > 0)

1532 
£ndtoÊags
->
tosockë
 +
wrôãn
;

1534 
	`¶og
(
LOG_DEBUG
, "%s: wrote %ld/%lu (%lu unencoded)Åo fd %d",

1535 
fun˘i⁄
, ()
wrôãn
, ()
towrôe
, ()
Àn
, 
s
);

1537  
Àn
;

1538 
	}
}

1540 #i‡
SOCKS_CLIENT


1543 
	$døösockë
(
iobuf
, 
døöôÆl
, 
buf
, 
bufsize
)

1544 
iobuf„r_t
 *
iobuf
;

1545 c⁄° 
døöôÆl
;

1546 *
buf
;

1547 c⁄° 
size_t
 
bufsize
;

1549 c⁄° *
fun˘i⁄
 = "drainsocket()";

1550 
ssize_t
 
ƒód
, 
døö
;

1566 i‡(
døöôÆl
)

1567 
døö
 = 
iobuf
->
öfo
[
READ_BUF
].
ªadÆªady
;

1573 
døö
 = 
iobuf
->
öfo
[
READ_BUF
].
ªadÆªady
 - 1;

1575 
	`¶og
(
LOG_DEBUG
, "%s: draining socket for %ldÖeekedát bytes",

1576 
fun˘i⁄
, ()
døö
);

1578 
	`SASSERTX
(
døö
 <(
ssize_t
)
bufsize
);

1579 
	`SASSERTX
(
døö
 >= 0);

1581 i‡(
døö
 == 0)

1584 (
ƒód
 = 
	`ªad
(
iobuf
->
s
, 
buf
, (
size_t
)
døö
)Ë=-1 && 
î∫o
 =
EINTR
)

1587 
iobuf
->
öfo
[
READ_BUF
].
ªadÆªady
 -(
ƒód
 == -1 ? 0 :Çread);

1589 i‡(
ƒód
 !
døö
) {

1590 
	`¶og
(
LOG_INFO
,

1593 
fun˘i⁄
,

1594 ()
døö
,

1595 
iobuf
->
s
,

1596 ()
ƒód
,

1597 
	`°ªº‹
(
î∫o
),

1598 
ƒód
 =-1 ? 
døö
 : drain -Çread);

1604 
	`socks_gë‰ombuf„r
(
iobuf
->
s
,

1606 
READ_BUF
,

1608 
buf
,

1609 
ƒód
 =-1 ? 
døö
 : drain -Çread);

1611 
	}
}

	@lib/hostcache.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

52 
	#LOG_DEBUG
 
LOG_INFO


	)

55 #i‡!
SOCKS_CLIENT


57 
	#MIN_HASH_SIZE
 (10240)

	)

64 
size_t


65 
ho°hash
(c⁄° *
«me
, c⁄° 
size_t
 
size
);

71 
ho°íåy_t
 *

72 
ho°ítc›y
(
ho°íåy_t
 *
to
, c⁄° 
ho°ít
 *
‰om
);

91 
size_t


92 
addrhash
(c⁄° 
sockaddr_°‹age
 *
addr
, c⁄° 
size_t
 
size
);

99 
addrisöli°
(c⁄° 
sockaddr
 *
addr
, 
addröfo
 *
aûi°
,

100 
addröfo
 *
aûi°_œ°
);

108 
dnsöfo_t
 *

109 
gëﬁde°
–c⁄° 
size_t
 
°¨ti
);

115 
«me_m©ches_ˇche
(c⁄° 
dnsöfo_t
 *
ˇchì¡ry
,

116 c⁄° *
«me
, c⁄° *
£rvi˚
,

117 c⁄° 
addröfo
 *
höts
);

119 
addr_m©ches_ˇche
(c⁄° 
dnsöfo_t
 *
ˇchì¡ry
, c⁄° 
sockaddr
 *
addr
,

120 c⁄° 
Êags
);

130 #i‡
STANDALONE_UNIT_TEST


131 
size_t
 
	gcby«me_hô
, 
	gcby«me_miss
;

132 
size_t
 
	gcbyaddr_hô
, 
	gcbyaddr_miss
;

138 
UNIT_TEST_STATIC_SCOPE
 
dnsöfo_t
 *
	gho°ˇche
;

142 
gai2h_î∫o
(c⁄° 
gai_rc
);

147 #unde‡
cgëaddröfo


151 
UNIT_TEST_STATIC_SCOPE
 

152 
addröfoc›y
(
dnsöfo_t
 *
to
, c⁄° 
addröfo
 *
‰om
,

153 c⁄° 
addröfo
 *
höts
);

166 #i‡
SOCKSLIBRARY_DYNAMIC


168 #unde‡
gëho°byaddr


169 #unde‡
gëho°by«me


171 #unde‡
gë«meöfo


174 
	#gëho°byaddr
(
addr
, 
Àn
, 
ty≥
Ë
	`sys_gëho°byaddr
◊ddr,Üí,Åy≥)

	)

176 #i‡
SOCKS_CLIENT


177 
	#gëho°by«me
(
«me
Ë
	`sys_gëho°by«me
“ame)

	)

182 
	#GAI_RC_IS_SYSTEMPROBLEM
(
gai_rc
) \

183 ((
gai_rc
Ë=
EAI_MEMORY
 \

184 || (
gai_rc
Ë=
EAI_SYSTEM
)

	)

186 
	#GAI_RC_IS_EAGAIN
(
gai_rc
) \

187 ((
gai_rc
Ë=
EAI_AGAIN
)

	)

189 #i‡
HAVE_ERR_EAI_OVERFLOW


190 
	#GAI_RC_IS_INTERNALERROR
(
gai_rc
) \

191 –((
gai_rc
Ë=
EAI_BADFLAGS
) \

192 || ((
gai_rc
Ë=
EAI_FAMILY
) \

193 || ((
gai_rc
Ë=
EAI_SOCKTYPE
) \

194 || ((
gai_rc
Ë=
EAI_OVERFLOW
))

	)

196 
	#GAI_RC_IS_INTERNALERROR
(
gai_rc
) \

197 –((
gai_rc
Ë=
EAI_BADFLAGS
) \

198 || ((
gai_rc
Ë=
EAI_FAMILY
) \

199 || ((
gai_rc
Ë=
EAI_SOCKTYPE
))

	)

203 
	$cgëaddröfo
(
«me
, 
£rvi˚
, 
höts
, 
ªs
, 
ªsmem
)

204 c⁄° *
«me
;

205 c⁄° *
£rvi˚
;

206 c⁄° 
addröfo
 *
höts
;

207 
addröfo
 **
ªs
;

208 
dnsöfo_t
 *
ªsmem
;

210 c⁄° *
fun˘i⁄
 = "cgetaddrinfo()";

211 
«mebuf
[
MAXHOSTNAMELEN
 * 4], 
£rvi˚buf
[
MAXSERVICELEN
 * 4];

212 
gai_rc
;

214 #i‡
SOCKS_CLIENT


221 
	`SASSERTX
(
ªs
 !
NULL
);

222 
	`SASSERTX
(
ªsmem
 !
NULL
);

224 i‡((
gai_rc
 = 
	`gëaddröfo
(
«me
, 
£rvi˚
, 
höts
, 
ªs
)) != 0)

225  
gai_rc
;

227 
	`SASSERTX
(*
ªs
 !
NULL
);

229 i‡((
gai_rc
 = 
	`addröfoc›y
(
ªsmem
, *
ªs
, 
höts
)) != 0

230 && 
	`GAI_RC_IS_SYSTEMPROBLEM
(
gai_rc
))

231 
	`sw¨nx
("%s:áddrinfocopy() failed for hostname \"%s\", service \"%s\"",

232 
fun˘i⁄
,

233 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
«mebuf
, (namebuf)),

234 
£rvi˚
 =
NULL
 ?

235 "<NULL>" : 
	`°r2vis
(
£rvi˚
,

236 
	`°æí
(
£rvi˚
),

237 
£rvi˚buf
,

238 (
£rvi˚buf
)));

241 
	`‰ìaddröfo
(*
ªs
);

243  
gai_rc
;

247 
size_t
 
i
;

248 
cou¡
;

249 c⁄° 
time_t
 
timíow
 = 
	`time_m⁄Ÿ⁄ic
(
NULL
);

250 #i‡!
STANDALONE_UNIT_TEST


251 
size_t
 
cby«me_hô
, 
cby«me_miss
;

253 
dnsöfo_t
 *
‰ìho°
;

254 
size_t
 
hashi
;

255 
have_ﬁdªs
 = 0;

257 
	`SASSERTX
(
ªs
 !
NULL
);

258 
	`SASSERTX
(
ªsmem
 !
NULL
);

260 i‡(
cou¡
++ % 
SOCKD_CACHESTAT
 == 0)

261 
	`¶og
(
LOG_DEBUG
, "%s, hit: %lu, miss: %lu",

262 
fun˘i⁄
, ()
cby«me_hô
, ()
cby«me_miss
);

264 i‡(
	`°æí
(
«me
Ë>(
‰ìho°
->
id
.name)) {

265 
	`sw¨nx
("%s: hostname \"%s\" isÅooÜong. MaxÜength is %lu",

266 
fun˘i⁄
,

267 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
«mebuf
, (namebuf)),

268 ()(
‰ìho°
->
id
.
«me
) - 1);

270  
EAI_MEMORY
;

273 i‡(
£rvi˚
 !
NULL
 && 
	`°æí
(£rvi˚Ë>(
‰ìho°
->service)) {

274 
	`sw¨n
("maxÜength of servicename wasát compiletime setÅo %lu, but "

278 ()(
‰ìho°
->
£rvi˚
) - 1,

279 ()
	`°æí
(
£rvi˚
) + 1,

280 
	`°r2vis
(
£rvi˚
, 
	`°æí
(£rvi˚), 
£rvi˚buf
, (servicebuf)));

282  
EAI_MEMORY
;

285 
	`socks_lock
(
sockscf
.
ho°fd
, 0, 0, 0, 1);

290 i‡(
i
 < 
SOCKD_HOSTCACHE


291 && 
	`«me_m©ches_ˇche
(&
ho°ˇche
[
i
], 
«me
, 
£rvi˚
, 
höts
)) {

292 i‡(
	`socks_dif·ime
(
timíow
, 
ho°ˇche
[
i
].
wrôãn
Ë< 
SOCKD_CACHETIMEOUT
) {

293 ++
cby«me_hô
;

295 i‡(
ho°ˇche
[
i
].
gai_rc
 == 0) {

296 
gai_rc
 = 
	`addröfoc›y
(
ªsmem
,

297 &
ho°ˇche
[
i
].
d©a
.
gëaddr
.
addröfo
,

298 
höts
);

299 
	`SASSERTX
(
gai_rc
 == 0);

301 *
ªs
 = &
ªsmem
->
d©a
.
gëaddr
.
addröfo
;

304 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

305  
ho°ˇche
[
i
].
gai_rc
;

311 
‰ìho°
 = &
ho°ˇche
[
i
];

312 
hashi
 = 
	`ho°hash
(
«me
, 
SOCKD_HOSTCACHE
);

314 i‡(
‰ìho°
->
gai_rc
 == 0) {

315 
gai_rc
 = 
	`addröfoc›y
(
ªsmem
,

316 &
‰ìho°
->
d©a
.
gëaddr
.
addröfo
,

317 
höts
);

319 
	`SASSERTX
(
gai_rc
 == 0);

320 
have_ﬁdªs
 = 1;

328 
hashi
 = 
	`ho°hash
(
«me
, 
SOCKD_HOSTCACHE
);

329 
i
 = 
hashi
, 
‰ìho°
 = 
NULL
; i < 
SOCKD_HOSTCACHE
; ++i) {

330 i‡(!
ho°ˇche
[
i
].
Æloˇãd
) {

331 i‡(
‰ìho°
 =
NULL
)

332 
‰ìho°
 = &
ho°ˇche
[
i
];

337 i‡(
	`«me_m©ches_ˇche
(&
ho°ˇche
[
i
], 
«me
, 
£rvi˚
, 
höts
)) {

338 i‡(
	`socks_dif·ime
(
timíow
, 
ho°ˇche
[
i
].
wrôãn
)

339 >
SOCKD_CACHETIMEOUT
) {

340 
‰ìho°
 = &
ho°ˇche
[
i
];

342 i‡(
‰ìho°
->
gai_rc
 == 0) {

343 
gai_rc
 = 
	`addröfoc›y
(
ªsmem
,

344 &
‰ìho°
->
d©a
.
gëaddr
.
addröfo
,

345 
höts
);

347 
	`SASSERTX
(
gai_rc
 == 0);

348 
have_ﬁdªs
 = 1;

354 ++
cby«me_hô
;

356 i‡(
ho°ˇche
[
i
].
gai_rc
 != 0) {

357 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

358  
ho°ˇche
[
i
].
gai_rc
;

361 
gai_rc
 = 
	`addröfoc›y
(
ªsmem
,

362 &
ho°ˇche
[
i
].
d©a
.
gëaddr
.
addröfo
,

363 
höts
);

365 
	`SASSERTX
(
gai_rc
 == 0);

367 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

369 *
ªs
 = &
ªsmem
->
d©a
.
gëaddr
.
addröfo
;

379 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

381 ++
cby«me_miss
;

383 
gai_rc
 = 
	`gëaddröfo
(
«me
, 
£rvi˚
, 
höts
, 
ªs
);

385 
	`¶og
(
LOG_DEBUG
,

387 
fun˘i⁄
,

388 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
«mebuf
, (namebuf)),

389 
£rvi˚
 =
NULL
 ? "<NULL>" : 
	`°r2vis
(service,

390 
	`°æí
(
£rvi˚
),

391 
£rvi˚buf
,

392 (
£rvi˚buf
)),

393 
höts
 =
NULL
 ? "<NULL>" : 
	`aihöts2°rög
(hints, NULL, 0),

394 
gai_rc
,

395 
gai_rc
 =0 ? *
ªs
 : 
NULL
,

396 
gai_rc
 =0 ? "nÿîr‹" : 
	`gai_°ªº‹
(gai_rc));

398 i‡(
gai_rc
 =
EAI_SYSTEM
 && 
	`ERRNOISNOFILE
(
î∫o
)) {

399 i‡(
sockscf
.
°©e
.
ª£rvedfdv
[0] != -1) {

400 
	`˛o£
(
sockscf
.
°©e
.
ª£rvedfdv
[0]);

402 
gai_rc
 = 
	`gëaddröfo
(
«me
, 
£rvi˚
, 
höts
, 
ªs
);

404 
sockscf
.
°©e
.
ª£rvedfdv
[0] = 
	`makedummyfd
(0, 0);

406 i‡(
gai_rc
 != 0)

407 
	`¶og
(
LOG_DEBUG
, "%s: getaddrinfo(%s, %s) failedágain: %s",

408 
fun˘i⁄
,

409 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
«mebuf
, (namebuf)),

410 
£rvi˚
 =
NULL
 ?

411 "<NULL>" : 
	`°r2vis
(
£rvi˚
,

412 
	`°æí
(
£rvi˚
),

413 
£rvi˚buf
,

414 (
£rvi˚buf
)),

415 
	`gai_°ªº‹
(
gai_rc
));

419 #i‡
HAVE_LINUX_BUGS


426 i‡(
gai_rc
 == 0)

427 
î∫o
 = 0;

430 i‡(
gai_rc
 != 0) {

435 i‡(
	`GAI_RC_IS_SYSTEMPROBLEM
(
gai_rc
)) {

436 
	`sw¨n
("%s: getaddrinfo(%s, %s) failedágain: %s",

437 
fun˘i⁄
,

438 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
«mebuf
, (namebuf)),

439 
£rvi˚
 =
NULL
 ?

440 "<NULL>" : 
	`°r2vis
(
£rvi˚
,

441 
	`°æí
(
£rvi˚
),

442 
£rvi˚buf
,

443 (
£rvi˚buf
)),

444 
	`gai_°ªº‹
(
gai_rc
));

448 i‡(
have_ﬁdªs
) {

449 
	`¶og
(
LOG_DEBUG
,

451 
fun˘i⁄
, 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
«mebuf
, (namebuf))),

453 *
ªs
 = &
ªsmem
->
d©a
.
gëaddr
.
addröfo
;

457 i‡(
	`GAI_RC_IS_SYSTEMPROBLEM
(
gai_rc
))

458  
gai_rc
;

459 i‡(
	`GAI_RC_IS_EAGAIN
(
gai_rc
))

460  
gai_rc
;

461 i‡(
	`GAI_RC_IS_INTERNALERROR
(
gai_rc
))

462 
	`SERR
(
gai_rc
);

472 i‡(
gai_rc
 == 0)

473 
	`SASSERTX
(*
ªs
 !
NULL
);

479 *
ªs
 = 
NULL
;

480 
ªs
 = 
NULL
;

483 
	`socks_lock
(
sockscf
.
ho°fd
, 0, 0, 1, 1);

485 i‡(
‰ìho°
 =
NULL
)

486 
‰ìho°
 = 
	`gëﬁde°
(
hashi
);

494 
	`SASSERTX
(
‰ìho°
 !
NULL
);

496 i‡(
gai_rc
 == 0) {

497 
gai_rc
 = 
	`addröfoc›y
(
‰ìho°
, *
ªs
, 
höts
);

502 
	`‰ìaddröfo
(*
ªs
);

503 
	`¶og
(
LOG_DEBUG
, "%s: fªedáddröfÿ%p", 
fun˘i⁄
, *
ªs
);

506 i‡(
gai_rc
 != 0) {

507 i‡(
	`GAI_RC_IS_SYSTEMPROBLEM
(
gai_rc
))

508 
	`sw¨nx
("%s:áddrinfocopy() failed for \"%s\"/service \"%s\": %s",

509 
fun˘i⁄
,

510 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
«mebuf
, (namebuf)),

511 
£rvi˚
 =
NULL
 ?

512 "<NULL>" : 
	`°r2vis
(
£rvi˚
,

513 
	`°æí
(
£rvi˚
),

514 
£rvi˚buf
,

515 (
£rvi˚buf
)),

516 
	`gai_°ªº‹
(
gai_rc
));

518 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

519  
gai_rc
;

523 i‡(
höts
 =
NULL
)

524 
‰ìho°
->
d©a
.
gëaddr
.
höts
 = 
NULL
;

526 
‰ìho°
->
d©a
.
gëaddr
.
höts
 = &‰ìho°->d©a.gëaddr.
höts_mem
;

527 *
‰ìho°
->
d©a
.
gëaddr
.
höts
 = *hints;

530 
‰ìho°
->
key
 = 
id_«me
;

531 
	`STRCPY_ASSERTLEN
(
‰ìho°
->
id
.
«me
,Çame);

533 i‡(
£rvi˚
 =
NULL
)

534 *
‰ìho°
->
£rvi˚
 = 
NUL
;

536 
	`STRCPY_ASSERTLEN
(
‰ìho°
->
£rvi˚
, service);

538 
‰ìho°
->
wrôãn
 = 
timíow
;

539 
‰ìho°
->
gai_rc
 = gai_rc;

540 
‰ìho°
->
Æloˇãd
 = 1;

542 
	`SASSERTX
(
‰ìho°
->
key
 =
id_«me
);

544 i‡(
gai_rc
 == 0) {

545 
gai_rc
 = 
	`addröfoc›y
(
ªsmem
, &
‰ìho°
->
d©a
.
gëaddr
.
addröfo
, 
höts
);

546 
	`SASSERTX
(
gai_rc
 == 0);

549 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

551 
ªsmem
->
gai_rc
 = gai_rc;

552 i‡(
ªsmem
->
gai_rc
 == 0)

553 *
ªs
 = &
ªsmem
->
d©a
.
gëaddr
.
addröfo
;

555  
ªsmem
->
gai_rc
;

557 
	}
}

559 #i‡!
SOCKS_CLIENT


561 
	$cgë«meöfo
(
addr
, 
addæí
, 
_ho°
, 
_ho°Àn
, 
_£rvi˚
, 
_£rvi˚Àn
, 
Êags
)

562 c⁄° 
sockaddr
 *
addr
;

563 c⁄° 
sockÀn_t
 
addæí
;

564 *
_ho°
;

565 c⁄° 
sockÀn_t
 
_ho°Àn
;

566 *
_£rvi˚
;

567 c⁄° 
sockÀn_t
 
_£rvi˚Àn
;

568 c⁄° 
Êags
;

570 c⁄° *
fun˘i⁄
 = "cgetnameinfo()";

571 c⁄° 
time_t
 
timíow
 = 
	`time_m⁄Ÿ⁄ic
(
NULL
);

572 #i‡!
STANDALONE_UNIT_TEST


573 
size_t
 
cbyaddr_hô
, 
cbyaddr_miss
;

575 
size_t
 
i
;

576 
cou¡
;

577 
dnsöfo_t
 *
‰ìho°
;

578 
size_t
 
hashi
;

579 
ho°
[(
‰ìho°
->
d©a
.
gë«me
.
«me
)],

580 
£rvi˚
[(
‰ìho°
->service)];

581 
gai_rc
, 
have_ﬁdªs
 = 0;

583 
	#DOCOPY
(
_ho°
, 
_ho°Àn
, 
_£rvi˚
, 
_£rvi˚Àn
, 
ˇchì¡ry
) \

585 i‡((
_ho°Àn
) > 0) { \

586 
	`°∫˝y
((
_ho°
), (
ˇchì¡ry
)->
d©a
.
gë«me
.
«me
, (
_ho°Àn
) - 1); \

587 (
_ho°
)[(
_ho°Àn
Ë- 1] = 
NUL
; \

590 i‡((
_£rvi˚Àn
) > 0) { \

591 
	`°∫˝y
((
_£rvi˚
), (
ˇchì¡ry
)->
£rvi˚
, (
_£rvi˚Àn
) - 1); \

592 (
_£rvi˚
)[(
_£rvi˚Àn
Ë- 1] = 
NUL
; \

594 }  0)

	)

596 i‡(
cou¡
++ % 
SOCKD_CACHESTAT
 == 0) {

597 
	`¶og
(
LOG_DEBUG
, "%s: hit: %lu, miss: %lu",

598 
fun˘i⁄
, ()
cbyaddr_hô
, ()
cbyaddr_miss
);

601 
	`socks_lock
(
sockscf
.
ho°fd
, 0, 0, 0, 1);

606 i‡(
i
 < 
SOCKD_HOSTCACHE


607 && 
	`addr_m©ches_ˇche
(&
ho°ˇche
[
i
], 
addr
, 
Êags
)) {

608 i‡(
	`socks_dif·ime
(
timíow
, 
ho°ˇche
[
i
].
wrôãn
Ë< 
SOCKD_CACHETIMEOUT
) {

609 ++
cbyaddr_hô
;

611 i‡(
ho°ˇche
[
i
].
gai_rc
 == 0)

612 
	`DOCOPY
(
_ho°
, 
_ho°Àn
, 
_£rvi˚
, 
_£rvi˚Àn
, &
ho°ˇche
[
i
]);

614 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

615  
ho°ˇche
[
i
].
gai_rc
;

622 
‰ìho°
 = &
ho°ˇche
[
i
];

623 
hashi
 = 
	`addrhash
(
	`TOCSS
(
addr
), 
SOCKD_HOSTCACHE
);

625 i‡(
‰ìho°
->
gai_rc
 == 0) {

626 
	`DOCOPY
(
_ho°
, 
_ho°Àn
, 
_£rvi˚
, 
_£rvi˚Àn
, 
‰ìho°
);

627 
have_ﬁdªs
 = 1;

635 
hashi
 = 
	`addrhash
(
	`TOCSS
(
addr
), 
SOCKD_HOSTCACHE
);

636 
i
 = 
hashi
, 
‰ìho°
 = 
NULL
; i < 
SOCKD_HOSTCACHE
; ++i) {

637 i‡(!
ho°ˇche
[
i
].
Æloˇãd
) {

638 i‡(
‰ìho°
 =
NULL
)

639 
‰ìho°
 = &
ho°ˇche
[
i
];

644 i‡(
	`addr_m©ches_ˇche
(&
ho°ˇche
[
i
], 
addr
, 
Êags
)) {

645 i‡(
	`socks_dif·ime
(
timíow
, 
ho°ˇche
[
i
].
wrôãn
)

646 >
SOCKD_CACHETIMEOUT
) {

647 
‰ìho°
 = &
ho°ˇche
[
i
];

649 i‡(
‰ìho°
->
gai_rc
 == 0) {

650 
	`DOCOPY
(
_ho°
, 
_ho°Àn
, 
_£rvi˚
, 
_£rvi˚Àn
, 
‰ìho°
);

651 
have_ﬁdªs
 = 1;

657 ++
cbyaddr_hô
;

659 i‡(
ho°ˇche
[
i
].
gai_rc
 != 0) {

660 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

661  
ho°ˇche
[
i
].
gai_rc
;

664 
	`DOCOPY
(
_ho°
, 
_ho°Àn
, 
_£rvi˚
, 
_£rvi˚Àn
, &
ho°ˇche
[
i
]);

666 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

672 ++
cbyaddr_miss
;

674 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

676 #i‡
SOCKSLIBRARY_DYNAMIC


685 
	`socks_m¨ka¢©ive
("*");

688 
gai_rc
 = 
	`gë«meöfo
(
addr
,

689 
addæí
,

690 
ho°
,

691 (
ho°
),

692 
£rvi˚
,

693 (
£rvi˚
),

694 
Êags
);

696 #i‡
SOCKSLIBRARY_DYNAMIC


697 
	`socks_m¨ka¢‹mÆ
("*");

700 
	`¶og
(
LOG_DEBUG
, "%s: getnameinfo(%s)Ñeturned %d: %s",

701 
fun˘i⁄
,

702 
	`sockaddr2°rög
(
	`TOCSS
(
addr
), 
NULL
, 0),

703 
gai_rc
,

704 
	`gai_°ªº‹
(
gai_rc
));

706 i‡(
gai_rc
 !0 && 
	`GAI_RC_IS_SYSTEMPROBLEM
(gai_rc)) {

707 i‡(
sockscf
.
°©e
.
ª£rvedfdv
[0] != -1) {

708 
	`˛o£
(
sockscf
.
°©e
.
ª£rvedfdv
[0]);

710 
gai_rc
 = 
	`gë«meöfo
(
addr
,

711 
addæí
,

712 
ho°
,

713 (
ho°
),

714 
£rvi˚
,

715 (
£rvi˚
),

716 
Êags
);

718 
sockscf
.
°©e
.
ª£rvedfdv
[0] = 
	`makedummyfd
(0, 0);

720 i‡(
gai_rc
 != 0) {

721 
	`¶og
(
LOG_DEBUG
, "%s: getnameinfo(%s) failedágain: %s",

722 
fun˘i⁄
,

723 
	`sockaddr2°rög
(
	`TOCSS
(
addr
), 
NULL
, 0),

724 
	`gai_°ªº‹
(
gai_rc
));

729 i‡(
gai_rc
 != 0) {

730 i‡(
have_ﬁdªs
) {

731 
	`¶og
(
LOG_DEBUG
,

733 
fun˘i⁄
, 
	`sockaddr2°rög
(
	`TOCSS
(
addr
), 
NULL
, 0));

739 i‡(
	`GAI_RC_IS_SYSTEMPROBLEM
(
gai_rc
)) {

740 
	`sw¨n
("%s: getnameinfo(%s) failed: %s",

741 
fun˘i⁄
,

742 
	`sockaddr2°rög
(
	`TOCSS
(
addr
), 
NULL
, 0),

743 
	`gai_°ªº‹
(
gai_rc
));

745  
gai_rc
;

747 i‡(
	`GAI_RC_IS_EAGAIN
(
gai_rc
))

748  
gai_rc
;

749 i‡(
	`GAI_RC_IS_INTERNALERROR
(
gai_rc
))

750 
	`SERR
(
gai_rc
);

753 
	`socks_lock
(
sockscf
.
ho°fd
, 0, 0, 1, -1);

755 i‡(
‰ìho°
 =
NULL
)

756 
‰ìho°
 = 
	`gëﬁde°
(
hashi
);

758 
	`SASSERTX
(
‰ìho°
 !
NULL
);

760 
‰ìho°
->
gai_rc
 = gai_rc;

762 
	`STRCPY_ASSERTSIZE
(
‰ìho°
->
£rvi˚
, service);

763 
	`STRCPY_ASSERTSIZE
(
‰ìho°
->
d©a
.
gë«me
.
«me
, 
ho°
);

765 
‰ìho°
->
d©a
.
gë«me
.
Êags
 = flags;

766 
‰ìho°
->
wrôãn
 = 
timíow
;

767 
‰ìho°
->
key
 = 
id_addr
;

768 
	`mem˝y
(&
‰ìho°
->
id
.
addr
,áddr, 
	`MIN
((‰ìho°->id.addr), 
addæí
));

770 
‰ìho°
->
Æloˇãd
 = 1;

772 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

774 i‡(
‰ìho°
->
gai_rc
 == 0)

775 
	`DOCOPY
(
_ho°
, 
_ho°Àn
, 
_£rvi˚
, 
_£rvi˚Àn
, 
‰ìho°
);

777  
‰ìho°
->
gai_rc
;

778 
	}
}

783 
	$addröfo_issuµ‹ãd
(
ai
)

784 c⁄° 
addröfo
 *
ai
;

787 i‡(!
	`ßÁmûy_issuµ‹ãd
(
ai
->
ai_Ámûy
))

790 
ai
->
ai_sockty≥
) {

792 
SOCK_STREAM
:

793 
SOCK_DGRAM
:

800 
ai
->
ai_¥Ÿocﬁ
) {

802 
IPPROTO_TCP
:

803 
IPPROTO_UDP
:

811 
	}
}

813 
UNIT_TEST_STATIC_SCOPE
 

814 
	$addröfoc›y
(
to
, 
‰om
, 
höts
)

815 
dnsöfo_t
 *
to
;

816 c⁄° 
addröfo
 *
‰om
;

817 c⁄° 
addröfo
 *
höts
;

819 c⁄° *
fun˘i⁄
 = "addrinfocopy()";

820 c⁄° 
addröfo
 *
‰om_ai
;

821 c⁄° 
size_t
 
maxíåõs
 = 
	`ELEMENTS
(
to
->
d©a
.
gëaddr
.
ai_addr_mem
);

822 
addröfo
 *
to_ai
, *
to_ai_¥evious
, *
to_ai_°¨t
;

823 
size_t
 
i
;

824 
visbuf
[
MAXHOSTNAMELEN
 * 4];

826 
	`bzîo
(
to
, (*to));

828 
‰om_ai
 = 
‰om
;

829 
to_ai
 = &
to
->
d©a
.
gëaddr
.
addröfo
;

830 
to_ai_°¨t
 = 
to_ai
;

831 
to_ai_¥evious
 = 
to_ai
;

832 
i
 = 0;

834 
i
 < 
maxíåõs
 && 
‰om_ai
 !
NULL
) {

835 #i‡!
SOCKS_CLIENT


836 
doskù
 = 0;

838 i‡(!
	`addröfo_issuµ‹ãd
(
‰om_ai
))

839 
doskù
 = 1;

840 i‡(
i
 > 0

841 && 
	`¡ohs
(
	`GET_SOCKADDRPORT
(
	`TOSS
(
‰om_ai
->
ai_addr
))) == 0

842 && 
	`¡ohs
(
	`GET_SOCKADDRPORT
(
	`TOSS
(
to_ai_¥evious
->
ai_addr
))) == 0

843 && 
	`addrisöli°
(
‰om_ai
->
ai_addr
, 
to_ai_°¨t
, 
to_ai_¥evious
)) {

856 
	`¶og
(
LOG_DEBUG
, "%s: skippingáddress %s,Örotocol %d",

857 
fun˘i⁄
,

858 
	`sockaddr2°rög
(
	`TOSS
(
‰om_ai
->
ai_addr
), 
NULL
, 0),

859 
‰om_ai
->
ai_¥Ÿocﬁ
);

861 
doskù
 = 1;

863 i‡(
‰om_ai
->
ai_addr
->
ß_Ámûy
 =
AF_INET6


864 && 
	`IN6_IS_ADDR_V4MAPPED
(&
	`TOIN6
(
‰om_ai
->
ai_addr
)->
sö6_addr
)) {

865 i‡(
höts
 !
NULL


866 && 
höts
->
ai_Ámûy
 != 0

867 && 
höts
->
ai_Ámûy
 !
AF_INET
)

868 
doskù
 = 1;

869 i‡(!
	`exã∫Æ_has_ßÁmûy
(
AF_INET
)) {

875 
doskù
 = 1;

885 *
to_ai
 = *
‰om_ai
;

887 
to_ai
->
ai_addr
 = 
	`TOSA
(&
to
->
d©a
.
gëaddr
.
ai_addr_mem
[
i
]);

888 
	`bzîo
(
to_ai
->
ai_addr
, 
	`ßÀn
(
AF_INET
));

889 
	`SET_SOCKADDR
(
	`TOSS
(
to_ai
->
ai_addr
), 
AF_INET
);

891 
	`ùv4_m≠≥d_to_ªguœr
(&
	`TOIN6
(
‰om_ai
->
ai_addr
)->
sö6_addr
,

892 &
	`TOIN
(
to_ai
->
ai_addr
)->
sö_addr
);

894 
to_ai
->
ai_Ámûy
 = 
AF_INET
;

895 
to_ai
->
ai_addæí
 = 
	`ßÀn
(
AF_INET
);

899 *
to_ai
 = *
‰om_ai
;

900 
to_ai
->
ai_addr
 = 
	`TOSA
(&
to
->
d©a
.
gëaddr
.
ai_addr_mem
[
i
]);

901 
	`mem˝y
(
to_ai
->
ai_addr
, 
‰om_ai
->ai_addr, from_ai->
ai_addæí
);

904 i‡(
doskù
) {

905 
	`¶og
(
LOG_DEBUG
, "%s: skippingáddress family %d",

906 
fun˘i⁄
, 
‰om_ai
->
ai_addr
->
ß_Ámûy
);

908 
‰om_ai
 = from_ai->
ai_√xt
;

914 *
to_ai
 = *
‰om_ai
;

918 i‡(
‰om_ai
->
ai_ˇn⁄«me
 !
NULL
) {

919 c⁄° 
size_t
 
Àn
 = 
	`°æí
(
‰om_ai
->
ai_ˇn⁄«me
);

921 i‡(
Àn
 >(
to
->
d©a
.
gëaddr
.
ai_ˇn⁄«me_mem
)) {

922 
	`sw¨nx
("%s: DNS-name %s is %lu bytesÜong,Éxpected max is %lu",

923 
fun˘i⁄
,

924 
	`°r2vis
(
‰om_ai
->
ai_ˇn⁄«me
, 
Àn
, 
visbuf
, (visbuf)),

925 ()
Àn
,

926 ()(
to
->
d©a
.
gëaddr
.
ai_ˇn⁄«me_mem
) - 1);

928  
EAI_MEMORY
;

943 i‡(
i
 == 0)

944 
	`mem˝y
(
to
->
d©a
.
gëaddr
.
ai_ˇn⁄«me_mem
,

945 
‰om_ai
->
ai_ˇn⁄«me
,

946 
Àn
 + 1);

948 
to_ai
->
ai_ˇn⁄«me
 = 
to
->
d©a
.
gëaddr
.
ai_ˇn⁄«me_mem
;

951 
to_ai
->
ai_ˇn⁄«me
 = 
NULL
;

953 
‰om_ai
 = from_ai->
ai_√xt
;

955 
to_ai_¥evious
 = 
to_ai
;

956 
to_ai
->
ai_√xt
 = &
to
->
d©a
.
gëaddr
.
ai_√xt_mem
[
i
];

957 
to_ai
 =Åo_ai->
ai_√xt
;

959 ++
i
;

962 
to_ai
->
ai_√xt
 = 
NULL
;

964 i‡(
‰om_ai
 =
NULL
 || 
i
 >
maxíåõs
)

965 
to_ai_¥evious
->
ai_√xt
 = 
NULL
;

967 i‡(
i
 == 0) {

968 
	`¶og
(
LOG_DEBUG
, "%s: så™ge,Çÿíåõ†c›õd", 
fun˘i⁄
);

970 
	`bzîo
(&
to
->
d©a
.
gëaddr
.
addröfo
, (to->data.getaddr.addrinfo));

971  
EAI_FAMILY
;

975 
	}
}

978 #i‡!
SOCKS_CLIENT


981 
	$ho°ˇcheövÆid©e
()

983 c⁄° *
fun˘i⁄
 = "hostcacheinvalidate()";

984 
size_t
 
i
;

986 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

988 
	`socks_lock
(
sockscf
.
ho°fd
, 0, 0, 0, 1);

990 
i
 = 0; i < 
SOCKD_HOSTCACHE
; ++i)

991 
ho°ˇche
[
i
].
Æloˇãd
 = 0;

993 
	`socks_u∆ock
(
sockscf
.
ho°fd
, 0, 0);

994 
	}
}

997 
	$gai2h_î∫o
(
gai_rc
)

998 c⁄° 
gai_rc
;

1001 
gai_rc
) {

1002 
EAI_AGAIN
:

1003 
EAI_MEMORY
:

1004  
TRY_AGAIN
;

1006 
EAI_NONAME
:

1007  
HOST_NOT_FOUND
;

1010  
NO_RECOVERY
;

1011 
	}
}

1014 
	$ho°ˇche£tup
()

1016 c⁄° *
fun˘i⁄
 = "hostcachesetup()";

1018 i‡((
sockscf
.
ho°fd
 = 
	`socks_mklock
(
SOCKD_SHMEMFILE
, 
NULL
, 0)) == -1)

1019 
	`£º
("%s: socks_mklock() failedÅo create shmemfile using base %s",

1020 
fun˘i⁄
, 
SOCKD_SHMEMFILE
);

1022 i‡((
ho°ˇche
 = 
	`sockd_mm≠
(
NULL
,

1023 (*
ho°ˇche
Ë* 
SOCKD_HOSTCACHE
,

1024 
PROT_READ
 | 
PROT_WRITE
,

1025 
MAP_SHARED
,

1026 
sockscf
.
ho°fd
,

1027 1)Ë=
MAP_FAILED
)

1028 
	`£º
("%s: failedÅo mmap(2) hostcache of size %lu",

1029 
fun˘i⁄
, ()((*
ho°ˇche
Ë* 
SOCKD_HOSTCACHE
));

1030 
	}
}

1033 
ho°ít
 *

1034 
	$cgëho°by«me
(
«me
)

1035 c⁄° *
«me
;

1037 c⁄° *
fun˘i⁄
 = "cgethostbyname()";

1038 
ho°íåy_t
 
ho°íåy
;

1039 
dnsöfo_t
 
ªsmem
;

1040 *
nuŒi°
[] = { 
NULL
 }, *
addrv
[
HOSTENT_MAX_ALIASES
 + 1];

1041 
addröfo
 *
aöfo
, *
√xt
, 
höts
;

1042 
ho°ít
 
he
;

1043 
size_t
 
addrc
;

1044 
rc
;

1046 
	`bzîo
(&
höts
, (hints));

1047 
höts
.
ai_Êags
 = 
AI_CANONNAME
;

1048 
höts
.
ai_Ámûy
 = 
AF_INET
;

1050 i‡((
rc
 = 
	`cgëaddröfo
(
«me
, 
NULL
, &
höts
, &
aöfo
, &
ªsmem
)) != 0) {

1051 
visbuf
[
MAXHOSTNAMELEN
 * 4];

1053 
	`¶og
(
LOG_DEBUG
, "%s: getaddrinfo(%s) failed: %s",

1054 
fun˘i⁄
,

1055 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
visbuf
, (visbuf)),

1056 
	`gai_°ªº‹
(
rc
));

1058 
h_î∫o
 = 
	`gai2h_î∫o
(
rc
);

1059  
NULL
;

1062 
	`SASSERTX
(
aöfo
 !
NULL
);

1064 
addrc
 = 0;

1065 
√xt
 = 
aöfo
;Çexà!
NULL
;Çexà√xt->
ai_√xt
) {

1066 
	`SASSERTX
(
addrc
 < 
	`ELEMENTS
(
addrv
));

1067 
	`SASSERTX
(
√xt
->
ai_addr
 !
NULL
);

1068 
	`SASSERTX
(
√xt
->
ai_Ámûy
 =√xt->
ai_addr
->
ß_Ámûy
);

1070 i‡(
√xt
->
ai_addr
->
ß_Ámûy
 =
AF_INET
) {

1071 
he
.
h_addπy≥
 = 
√xt
->
ai_addr
->
ß_Ámûy
;

1072 
he
.
h_Àngth
 = (
ö_addr
);

1073 
addrv
[
addrc
++] = (*)&
	`TOIN
(
√xt
->
ai_addr
)->
sö_addr
;

1075 i‡(
addrc
 + 1 >
	`ELEMENTS
(
addrv
))

1079 
	`¶og
(
LOG_DEBUG
,

1080 "%s:ái_Ámûy = %d. Skù≥d", 
fun˘i⁄
, 
√xt
->
ai_Ámûy
);

1083 i‡(
addrc
 == 0) {

1084 
h_î∫o
 = 
NO_ADDRESS
;

1085  
NULL
;

1088 
addrv
[
addrc
] = 
NULL
;

1090 
he
.
h_«me
 = 
aöfo
->
ai_ˇn⁄«me
;

1091 
he
.
h_Æü£s
 = 
nuŒi°
;

1092 
he
.
h_addr_li°
 = 
addrv
;

1094 
	`ho°ítc›y
(&
ho°íåy
, &
he
);

1096  &
ho°íåy
.
ho°ít
;

1097 
	}
}

1100 
ho°ít
 *

1101 
	$cgëho°byaddr
(
addr
, 
Àn
, 
ty≥
)

1102 c⁄° *
addr
;

1103 
sockÀn_t
 
Àn
;

1104 
ty≥
;

1106 c⁄° *
fun˘i⁄
 = "cgethostbyaddr()";

1107 
ho°íåy_t
 
ho°íåy
;

1108 *
nuŒi°
[] = { 
NULL
 }, *
⁄ñi°
[2];

1109 
sockaddr_°‹age
 
ß
;

1110 
ho°ít
 
he
;

1111 
ho°
[
MAXHOSTNAMELEN
];

1112 
rc
;

1114 
	`SASSERTX
(
ty≥
 =
AF_INET
);

1115 
	`SASSERTX
(
Àn
 =(
ö_addr
));

1117 
	`bzîo
(&
ß
, (sa));

1118 
	`SET_SOCKADDR
(&
ß
, 
AF_INET
);

1119 
	`TOIN
(&
ß
)->
sö_addr
 = *(c⁄° 
ö_addr
 *)
addr
;

1121 i‡((
rc
 = 
	`cgë«meöfo
(
	`TOSA
(&
ß
),

1122 
	`ßÀn
(
ß
.
ss_Ámûy
),

1123 
ho°
,

1124 (
ho°
),

1125 
NULL
,

1127 
NI_NAMEREQD
)) != 0) {

1128 
	`¶og
(
LOG_DEBUG
, "%s: cgetnameinfo(%s) failed: %s",

1129 
fun˘i⁄
, 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0), 
	`gai_°ªº‹
(
rc
));

1131 
h_î∫o
 = 
	`gai2h_î∫o
(
rc
);

1132  
NULL
;

1135 
he
.
h_«me
 = 
ho°
;

1136 
he
.
h_Æü£s
 = 
nuŒi°
;

1137 
he
.
h_addπy≥
 = 
ß
.
ss_Ámûy
;

1138 
he
.
h_Àngth
 = (
ö_addr
);

1139 
he
.
h_addr_li°
 = 
⁄ñi°
;

1140 
he
.
h_addr_li°
[0] = (*)&
	`TOIN
(&
ß
)->
sö_addr
;

1141 
he
.
h_addr_li°
[1] = 
NULL
;

1143 
	`ho°ítc›y
(&
ho°íåy
, &
he
);

1145  &
ho°íåy
.
ho°ít
;

1146 
	}
}

1148 
ho°íåy_t
 *

1149 
	$ho°ítc›y
(
to
, 
‰om
)

1150 
ho°íåy_t
 *
to
;

1151 c⁄° 
ho°ít
 *
‰om
;

1153 c⁄° *
fun˘i⁄
 = "hostentcopy()";

1154 c⁄° 
size_t
 
maxÆü£s
 = 
	`ELEMENTS
(
to
->
h_Æü£s
);

1155 
size_t
 
i
;

1157 i‡((
size_t
)
‰om
->
h_Àngth
 > (
to
->
h_addr_li°mem
[0])) {

1158 
	`sw¨nx
("%s: h_length of %s is %d bytesÜong, maxÉxpected is %lu",

1159 
fun˘i⁄
,

1160 
‰om
->
h_«me
,

1161 
‰om
->
h_Àngth
,

1162 ()(
to
->
h_addr_li°mem
[0]));

1164  
NULL
;

1167 i‡(
	`°æí
(
‰om
->
h_«me
Ë>(
to
->h_name)) {

1168 
	`sw¨nx
("%s:Çame %s is %lu bytesÜong, maxÉxpected is %lu",

1169 
fun˘i⁄
,

1170 
‰om
->
h_«me
,

1171 ()
	`°æí
(
‰om
->
h_«me
),

1172 ()(
to
->
h_«me
) - 1);

1174  
NULL
;

1177 
to
->
ho°ít
.
h_addπy≥
 = 
‰om
->h_addrtype;

1178 
to
->
ho°ít
.
h_Àngth
 = 
‰om
->h_length;

1179 
to
->
ho°ít
.
h_«me
 =Åo->h_name;

1180 
	`°r˝y
(
to
->
ho°ít
.
h_«me
, 
‰om
->h_name);

1182 
i
 = 0; i < (
maxÆü£s
 - 1Ë&& 
‰om
->
h_Æü£s
[i] !
NULL
; ++i) {

1183 i‡(
	`°æí
(
‰om
->
h_Æü£s
[
i
]Ë>(
to
->
h_Æü£smem
[0])) {

1184 
	`sw¨nx
("%s:Çame %s is %lu bytesÜong, maxÉxpected is %lu",

1185 
fun˘i⁄
,

1186 
‰om
->
h_Æü£s
[
i
],

1187 ()
	`°æí
(
‰om
->
h_Æü£s
[
i
]),

1188 ()(
to
->
h_Æü£s
[0]) - 1);

1190  
NULL
;

1193 
to
->
h_Æü£s
[
i
] =Åo->
h_Æü£smem
[i];

1194 
	`°r˝y
(
to
->
h_Æü£s
[
i
], 
‰om
->h_aliases[i]);

1197 
to
->
ho°ít
.
h_Æü£s
 =Åo->h_aliases;

1198 
to
->
ho°ít
.
h_Æü£s
[
i
] = 
NULL
;

1200 
i
 = 0; i < (
maxÆü£s
 - 1Ë&& 
‰om
->
h_addr_li°
[i] !
NULL
; ++i) {

1201 
to
->
h_addr_li°
[
i
] =Åo->
h_addr_li°mem
[i];

1202 
	`mem˝y
(
to
->
h_addr_li°
[
i
], 
‰om
->h_addr_li°[i], (
size_t
)‰om->
h_Àngth
);

1205 
to
->
ho°ít
.
h_addr_li°
 =Åo->h_addr_list;

1206 
to
->
ho°ít
.
h_addr_li°
[
i
] = 
NULL
;

1208  
to
;

1209 
	}
}

1211 
size_t


1212 
	$ho°hash
(
«me
, 
size
)

1213 c⁄° *
«me
;

1214 c⁄° 
size_t
 
size
;

1216 
vÆue
;

1217 *
íd
;

1219 i‡(
size
 < 
MIN_HASH_SIZE
)

1223 i‡((
íd
 = 
	`°rchr
(
«me
, '.')Ë!
NULL
)

1224 
íd
 = 
	`°rchr
(end + 1, '.');

1226 i‡(
íd
 =
NULL
)

1227 
íd
 = 
	`°rchr
(
«me
, 
NUL
);

1229 
	`SASSERTX
(
«me
 <
íd
);

1231 
vÆue
 = 0;

1232 
«me
 !
íd
) {

1233 
vÆue
 = (vÆuê<< 5Ë+ *
«me
;

1234 ++
«me
;

1237  
vÆue
 % 
size
;

1238 
	}
}

1240 
size_t


1241 
	$addrhash
(
addr
, 
size
)

1242 c⁄° 
sockaddr_°‹age
 *
addr
;

1243 c⁄° 
size_t
 
size
;

1245 
size_t
 
sum
;

1247 i‡(
size
 < 
MIN_HASH_SIZE
)

1255 
addr
->
ss_Ámûy
) {

1256 
AF_INET
:

1257 
sum
 = 
	`¡ohl
(
	`TOCIN
(
addr
)->
sö_addr
.
s_addr
);

1260 
AF_INET6
: {

1261 c⁄° *
byã
 = 
	`TOCIN6
(
addr
)->
sö6_addr
.
s6_addr
;

1262 c⁄° 
size_t
 
Àn
 = (
	`TOCIN6
(
addr
)->
sö6_addr
.
s6_addr
),

1263 
digôs_w™ãd
 = 4;

1264 
ssize_t
 
i
;

1265 
size_t
 
digôs_summed
;

1267 
sum
 = 0;

1268 
digôs_summed
 = 0;

1269 
i
 = 
Àn
 - 1;

1271 
i
 >0 && 
digôs_summed
 < 
digôs_w™ãd
) {

1272 i‡(
byã
[
i
] != 0) {

1273 
sum
 +
byã
[
i
];

1274 ++
digôs_summed
;

1277 --
i
;

1284 
	`SERRX
(
addr
->
ss_Ámûy
);

1287  
sum
 % 
size
;

1288 
	}
}

1290 
dnsöfo_t
 *

1291 
	$gëﬁde°
(
°¨ti
)

1292 c⁄° 
size_t
 
°¨ti
;

1294 
dnsöfo_t
 *
ﬁde°
;

1295 
size_t
 
i
;

1297 
i
 = 
°¨ti
, 
ﬁde°
 = 
NULL
; i < 
SOCKD_HOSTCACHE
; ++i) {

1298 i‡(
ﬁde°
 =
NULL


1299 || 
ho°ˇche
[
i
].
wrôãn
 < 
ﬁde°
->written)

1300 
ﬁde°
 = &
ho°ˇche
[
i
];

1303 
	`SASSERTX
(
ﬁde°
 !
NULL
);

1304  
ﬁde°
;

1305 
	}
}

1308 
	$«me_m©ches_ˇche
(
˚
, 
«me
, 
£rvi˚
, 
höts
)

1309 c⁄° 
dnsöfo_t
 *
˚
;

1310 c⁄° *
«me
;

1311 c⁄° *
£rvi˚
;

1312 c⁄° 
addröfo
 *
höts
;

1314 i‡(
˚
->
Æloˇãd
 && ce->
key
 =
id_«me
) {

1315 i‡(
höts
 =
NULL
) {

1316 i‡(
˚
->
d©a
.
gëaddr
.
höts
 !
NULL
)

1320 i‡(
˚
->
d©a
.
gëaddr
.
höts
 =
NULL
)

1323 i‡(
	`memcmp
(
˚
->
d©a
.
gëaddr
.
höts
, hints, (*hints)) != 0)

1327 i‡(
	`°rˇ£cmp
(
˚
->
id
.
«me
,Çame) != 0)

1330 i‡(
£rvi˚
 =
NULL
) {

1331 i‡(*
˚
->
£rvi˚
 !
NUL
)

1335 i‡(*
˚
->
£rvi˚
 =
NUL
)

1338 i‡(
	`°rˇ£cmp
(
˚
->
£rvi˚
, service) != 0)

1347 
	}
}

1350 
	$addr_m©ches_ˇche
(
˚
, 
addr
, 
Êags
)

1351 c⁄° 
dnsöfo_t
 *
˚
;

1352 c⁄° 
sockaddr
 *
addr
;

1353 c⁄° 
Êags
;

1355 i‡(
˚
->
Æloˇãd


1356 && 
˚
->
d©a
.
gë«me
.
Êags
 == flags

1357 && 
˚
->
key
 =
id_addr


1358 && 
	`sockaddøªeq
(&
˚
->
id
.
addr
, 
	`TOCSS
(addr), 0))

1362 
	}
}

1365 
	$addrisöli°
(
addr
, 
aûi°
, 
aûi°_œ°
)

1366 c⁄° 
sockaddr
 *
addr
;

1367 
addröfo
 *
aûi°
;

1368 
addröfo
 *
aûi°_œ°
;

1370 c⁄° *
fun˘i⁄
 = "addrisinlist()";

1371 
addröfo
 *
ai_√xt_‹igöÆ
 = 
aûi°_œ°
->
ai_√xt
;

1372 
isöli°
;

1374 
aûi°_œ°
->
ai_√xt
 = 
NULL
;

1376 
addr
->
ß_Ámûy
) {

1377 
AF_INET
: {

1378 
ö_addr
 
mask
;

1380 
mask
.
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

1382 
isöli°
 = 
	`ùv4_addrisöli°
(&
	`TOCIN
(
addr
)->
sö_addr
, &
mask
, 
aûi°
)

1383 =
NULL
 ? 0 : 1;

1387 
AF_INET6
: {

1388 c⁄° 
mask
 = { 
IPV6_NETMASKBITS
 };

1390 
isöli°
 = 
	`ùv6_addrisöli°
(&
	`TOCIN6
(
addr
)->
sö6_addr
, 
mask
, 
aûi°
)

1391 =
NULL
 ? 0 : 1;

1396 
	`¶og
(
PRERELEASE
 ? 
LOG_NOTICE
 : 
LOG_DEBUG
,

1398 
fun˘i⁄
, 
addr
->
ß_Ámûy
);

1400 
isöli°
 = 1;

1403 
aûi°_œ°
->
ai_√xt
 = 
ai_√xt_‹igöÆ
;

1405  
isöli°
;

1406 
	}
}

	@lib/hostid.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 #i‡
SOCKS_HOSTID_TYPE
 !
SOCKS_HOSTID_TYPE_NONE


51 
	$gësockëho°id
(
s
, 
addrc
, 
addrv
)

52 c⁄° 
s
;

53 c⁄° 
size_t
 
addrc
;

54 
ö_addr
 
addrv
[];

56 #i‡
SOCKS_HOSTID_TYPE
 =
SOCKS_HOSTID_TYPE_TCP_IPA


57 c⁄° *
fun˘i⁄
 = "getsockethostid()";

58 
t˝_ùa
 
ho°id
;

59 
size_t
 
i
;

60 
sockÀn_t
 
Àn
;

62 
Àn
 = (
ho°id
);

63 i‡(
	`gësock›t
(
s
, 
IPPROTO_TCP
, 
TCP_IPA
, &
ho°id
, &
Àn
) != 0) {

64 
	`¶og
(
LOG_DEBUG
, "%s:Ço hostidÑetrieved via TCP_IPA on fd %d (%s)",

65 
fun˘i⁄
, 
s
, 
	`°ªº‹
(
î∫o
));

67 
î∫o
 = 0;

71 
	`¶og
(
LOG_DEBUG
,

73 
fun˘i⁄
, ()
Àn
, ()(
ho°id
), 
s
);

75 
	`CTASSERT
((*
addrv
Ë=(*
ho°id
.
ùa_ùaddªss
));

77 i‡(
Àn
 == 0)

80 
	`SASSERTX
(
Àn
 >(*
addrv
));

82 
i
 = 0; i < 
addrc
 && i < (
Àn
 / (*
ho°id
.
ùa_ùaddªss
)); ++i) {

83 
addrv
[
i
].
s_addr
 = 
ho°id
.
ùa_ùaddªss
[i];

85 i‡(
sockscf
.
›ti⁄
.
debug
) {

86 
¡›
[
MAXSOCKADDRSTRING
];

88 i‡(
	`öë_¡›
(
AF_INET
, &
addrv
[
i
], 
¡›
, “t›)Ë=
NULL
)

89 
	`sw¨n
("%s: inet_ntop(3) failed on %s %x",

90 
fun˘i⁄
, 
	`ßÁmûy2°rög
(
AF_INET
), 
addrv
[
i
].
s_addr
);

92 
	`¶og
(
LOG_DEBUG
, "%s: hostidát index #%lu: %s",

93 
fun˘i⁄
, ()
i
, 
¡›
);

97  
i
;

102 
	}
}

105 
	$£tsockëho°id
(
s
, 
addrc
, 
addrv
)

106 c⁄° 
s
;

107 c⁄° 
size_t
 
addrc
;

108 
ö_addr
 
addrv
[];

110 #i‡
SOCKS_HOSTID_TYPE
 =
SOCKS_HOSTID_TYPE_TCP_IPA


111 c⁄° *
fun˘i⁄
 = "setsockethostid()";

112 
t˝_ùa
 
ho°id
;

113 
size_t
 
i
;

114 
sockÀn_t
 
Àn
;

116 
	`CTASSERT
((*
addrv
Ë=(*
ho°id
.
ùa_ùaddªss
));

118 i‡(
addrc
 == 0)

121 
i
 = 0; i < 
addrc
; ++i) {

122 
¡›
[
MAXSOCKADDRSTRING
];

124 i‡(
	`öë_¡›
(
AF_INET
, &
addrv
[
i
], 
¡›
, “t›)Ë=
NULL
)

125 
	`sw¨n
("%s: inet_ntop(3) failed on %s %x",

126 
fun˘i⁄
, 
	`ßÁmûy2°rög
(
AF_INET
), 
addrv
[
i
].
s_addr
);

128 
	`¶og
(
LOG_DEBUG
, "%s: hostidát index #%lu: %s",

129 
fun˘i⁄
, ()
i
, 
¡›
);

131 
	`mem˝y
(&
ho°id
.
ùa_ùaddªss
[
i
], &
addrv
[i], (addrv[i]));

134 
Àn
 = (*
ho°id
.
ùa_ùaddªss
Ë* 
addrc
;

135 i‡(
	`£tsock›t
(
s
, 
IPPROTO_TCP
, 
TCP_IPA
, &
ho°id
, 
Àn
) != 0) {

136 
	`sw¨n
("%s: couldÇot set hostid via TCP_IPA on fd %d (%s)",

137 
fun˘i⁄
, 
s
, 
	`°ªº‹
(
î∫o
));

147 
	}
}

	@lib/httpproxy.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$hâµroxy_√gŸüã
(
s
, 
∑ckë
, 
emsg
, 
emsgÀn
)

52 
s
;

53 
socks_t
 *
∑ckë
;

54 *
emsg
;

55 
size_t
 
emsgÀn
;

57 c⁄° *
fun˘i⁄
 = "httpproxy_negotiate()";

58 
buf
[
MAXHOSTNAMELEN
 + 512] ,

59 
visbuf
[(
buf
Ë* 4 + 1], *
p
;

60 
ho°
[
MAXSOCKSHOSTSTRING
];

61 
checked
, 
eof
;

62 
ssize_t
 
rc
;

63 
size_t
 
Àn
, 
ªadsoÁr
;

64 
sockaddr_°‹age
 
addr
;

65 
sockÀn_t
 
addæí
;

67 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

69 
	`socksho°2°rög
(&
∑ckë
->
ªq
.
ho°
, host, (host));

75 i‡((
p
 = 
	`°ºchr
(
ho°
, '.')Ë=
NULL
) {

76 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

78 
ho°
);

80 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

84 *
p
 = ':';

86 
Àn
 = 
	`¢¥ötf
(
buf
, (buf),

90 
ho°
,

91 
	`¥oxy¥Ÿocﬁ2°rög
(
∑ckë
->
ªq
.
vîsi⁄
),

92 
PRODUCT
,

93 
VERSION
);

95 
	`¶og
(
LOG_NEGOTIATE
, "%s: sendingÅo server: %s",

96 
fun˘i⁄
, 
	`°r2vis
(
buf
, 
Àn
, 
visbuf
, (visbuf)));

98 i‡((
rc
 = 
	`socks_£ndt⁄
(
s
, 
buf
, 
Àn
,Üí, 0, 
NULL
, 0, NULL, NULL))

99 !(
ssize_t
)
Àn
) {

100 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

102 ()
rc
, ()
Àn
, 
	`°ªº‹
(
î∫o
));

111 
eof
 = 
checked
 = 
ªadsoÁr
 = 0;

113 c⁄° *
eo‰e•⁄£_°r
 = "\r\n\r\n";

118 c⁄° *
eﬁ_°r
 = "\r\n";

119 *
eﬁ
, *
buÂ
;

120 
size_t
 
löñí
;

122 i‡((
rc
 = 
	`ªad
(
s
, &
buf
[
ªadsoÁr
], (buf) -Ñeadsofar - 1)) <= 0) {

123 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

126 ()
rc
, ()
ªadsoÁr
);

130 
Àn
 = (
size_t
)
rc
;

132 
buf
[
ªadsoÁr
 + 
Àn
] = 
NUL
;

134 
	`¶og
(
LOG_NEGOTIATE
, "%s:Ñead from server: %s",

135 
fun˘i⁄
, 
	`°r2vis
(&
buf
[
ªadsoÁr
], 
Àn
, 
visbuf
, (visbuf)));

137 
ªadsoÁr
 +
Àn
;

139 i‡((
	`°r°r
(
buf
, 
eo‰e•⁄£_°r
)Ë=
NULL
)

142 
eof
 = 1;

144 
buÂ
 = 
buf
;

145 (
eﬁ
 = 
	`°r°r
(
buÂ
, 
eﬁ_°r
)Ë!
NULL
) {

147 *
eﬁ
 = 
NUL
;

148 
löñí
 = 
eﬁ
 - 
buÂ
;

150 
	`¶og
(
LOG_DEBUG
, "%s: checkingÜine \"%s\"",

151 
fun˘i⁄
, 
	`°r2vis
(
buÂ
, 
löñí
, 
visbuf
, (visbuf)));

153 i‡(!
checked
) {

154 
îr‹
 = 0;

156 
∑ckë
->
ªq
.
vîsi⁄
) {

157 
PROXY_HTTP_10
:

158 
PROXY_HTTP_11
: {

159 c⁄° *
vî_°r


160 
	`¥oxy¥Ÿocﬁ2°rög
(
∑ckë
->
ªq
.
vîsi⁄
);

161 
size_t
 
off£t
 = 
	`°æí
(
vî_°r
);

163 i‡(
löñí
 < 
off£t
 + 
	`°æí
(" 200")) {

164 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

167 
visbuf
);

169 
îr‹
 = 1;

173 i‡(
	`°∫cmp
(
buÂ
, 
vî_°r
, 
off£t
) != 0) {

174 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

178 
visbuf
, 
vî_°r
);

181 
	`is•a˚
(()
buÂ
[
off£t
]))

182 ++
off£t
;

184 i‡(!
	`isdigô
(()
buÂ
[
off£t
])) {

185 
tmp
[(
visbuf
)];

187 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

190 ()
off£t
,

191 
	`°r2vis
(&
buÂ
[
off£t
],

192 
löñí
 - 
off£t
,

193 
tmp
,

194 (
tmp
)));

195 
îr‹
 = 1;

199 
∑ckë
->
ªs
.
vîsi⁄
 =Öackë->
ªq
.version;

200 i‡((
rc
 = 
	`°rög2p‹äumbî
(&
buÂ
[
off£t
], 
emsg
, 
emsgÀn
))

202 
	`sw¨n
("%s: couldÇot findÑesponse code in http "

204 
fun˘i⁄
, 
visbuf
, 
emsg
);

206 
rc
 = 
HTTP_SUCCESS
;

209 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

212 ()
rc
,

213 
	`socks_gë_ª•⁄£vÆue
(&
∑ckë
->
ªs
)

214 =
HTTP_SUCCESS
 ? "success" : "failure",

215 
visbuf
);

217 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

220 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, ()
rc
);

228 
addæí
 = (
addr
);

229 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
addr
), &
addæí
) != 0)

230 
	`SWARN
(
s
);

232 
	`sockaddr2socksho°
(&
addr
, &
∑ckë
->
ªs
.
ho°
);

234 
checked
 = 1;

239 
	`SERRX
(
∑ckë
->
ªq
.
vîsi⁄
);

242 i‡(
îr‹
) {

243 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

245 
	`°r2vis
(
buÂ
, 
löñí
, 
visbuf
, (visbuf)));

251 
buÂ
 +
löñí
;

253 } !
eof
);

255 i‡(
checked
)

256  
	`socks_gë_ª•⁄£vÆue
(&
∑ckë
->
ªs
Ë=
HTTP_SUCCESS
 ? 0 : -1;

258 
	`¶og
(
LOG_INFO
, "%s: didn'àgë sètu†codê‰omÖroxy", 
fun˘i⁄
);

260 
	}
}

	@lib/hw.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

51 
mömaxvÆueo·y≥
(c⁄° 
size_t
 
ty≥Àn
, *
mö
, *
max
);

54 
umömaxvÆueo·y≥
(c⁄° 
size_t
 
ty≥Àn
, *
mö
,

55 *
max
);

59 
	$ru√nvcheck
()

61 c⁄° *
fun˘i⁄
 = "runenvcheck()";

63 
size_t
 
ex≥˘edsize
;

64 
size_t
 
a˘uÆsize
;

65 
issig√d
;

66 
size_t
 
bôÀngth
;

67 } 
checkv
[] = {

68 { 
BYTEWIDTH_8BITS
, (
sbôs_8
), 1, 8 },

69 { 
BYTEWIDTH_8BITS
, (
ubôs_8
), 0, 8 },

70 { 
BYTEWIDTH_16BITS
, (
sbôs_16
), 1, 16 },

71 { 
BYTEWIDTH_16BITS
, (
ubôs_16
), 0, 16 },

72 { 
BYTEWIDTH_32BITS
, (
sbôs_32
), 1, 32 },

73 { 
BYTEWIDTH_32BITS
, (
ubôs_32
), 0, 32 }

75 
size_t
 
i
;

77 
i
 = 0; i < 
	`ELEMENTS
(
checkv
); ++i)

78 i‡(
checkv
[
i
].
ex≥˘edsize
 !checkv[i].
a˘uÆsize
)

79 
	`£ºx
("%s:Éxpected size of %s %lu bitÅypeÅo be %lu (based on "

83 
fun˘i⁄
,

84 
checkv
[
i
].
issig√d
 ? "signed" : "unsigned",

85 ()
checkv
[
i
].
bôÀngth
,

86 ()
checkv
[
i
].
ex≥˘edsize
,

87 ()
checkv
[
i
].
a˘uÆsize
);

88 
	}
}

91 
	$mövÆueo·y≥
(
ty≥Àn
)

92 c⁄° 
size_t
 
ty≥Àn
;

94 
mö
, 
max
;

96 
	`mömaxvÆueo·y≥
(
ty≥Àn
, &
mö
, &
max
);

97  
mö
;

98 
	}
}

101 
	$maxvÆueo·y≥
(
ty≥Àn
)

102 c⁄° 
size_t
 
ty≥Àn
;

104 
mö
, 
max
;

106 
	`mömaxvÆueo·y≥
(
ty≥Àn
, &
mö
, &
max
);

108  
max
;

109 
	}
}

112 
	$umövÆueo·y≥
(
ty≥Àn
)

113 c⁄° 
size_t
 
ty≥Àn
;

115 
mö
, 
max
;

117 
	`umömaxvÆueo·y≥
(
ty≥Àn
, &
mö
, &
max
);

118  
mö
;

119 
	}
}

122 
	$umaxvÆueo·y≥
(
ty≥Àn
)

123 c⁄° 
size_t
 
ty≥Àn
;

125 
mö
, 
max
;

127 
	`umömaxvÆueo·y≥
(
ty≥Àn
, &
mö
, &
max
);

128  
max
;

129 
	}
}

132 
	$mömaxvÆueo·y≥
(
ty≥Àn
, 
mö
, 
max
)

133 c⁄° 
size_t
 
ty≥Àn
;

134 *
mö
;

135 *
max
;

137 c⁄° *
fun˘i⁄
 = "minmaxvalueoftype()";

139 
ty≥Àn
) {

140 (
öt8_t
):

141 *
mö
 = 
INT8_MIN
;

142 *
max
 = 
INT8_MAX
;

145 (
öt16_t
):

146 *
mö
 = 
INT16_MIN
;

147 *
max
 = 
INT16_MAX
;

150 (
öt32_t
):

151 *
mö
 = 
INT32_MIN
;

152 *
max
 = 
INT32_MAX
;

155 (
öt64_t
):

156 *
mö
 = 
INT64_MIN
;

157 *
max
 = 
INT64_MAX
;

161 
	`sw¨nx
("%s: unsupportedÅypelength %lu",

162 
fun˘i⁄
, ()
ty≥Àn
);

164 
	`SERRX
(0);

166 
	}
}

169 
	$umömaxvÆueo·y≥
(
ty≥Àn
, 
mö
, 
max
)

170 c⁄° 
size_t
 
ty≥Àn
;

171 *
mö
;

172 *
max
;

174 c⁄° *
fun˘i⁄
 = "minmaxvalueoftype()";

176 *
mö
 = 0;

178 
ty≥Àn
) {

179 (
uöt8_t
):

180 *
max
 = 
UINT8_MAX
;

183 (
uöt16_t
):

184 *
max
 = 
UINT16_MAX
;

187 (
uöt32_t
):

188 *
max
 = 
UINT32_MAX
;

191 (
uöt64_t
):

192 *
max
 = 
UINT64_MAX
;

196 
	`sw¨nx
("%s: unsupportedÅypelength %lu",

197 
fun˘i⁄
, ()
ty≥Àn
);

199 
	`SERRX
(0);

201 
	}
}

	@lib/iface.c

44 c⁄° 
	grcsid
[] =

47 
	~"comm⁄.h
"

49 #i‡!
SOCKS_CLIENT


51 #i‡!
HAVE_SIOCGIFHWADDR


59 
gë_ifc⁄fig_ouçut
(c⁄° *
i‚ame
, *
ouçut
, 
size_t
 
ouçuéí
);

68 
∑r£_ifc⁄fig_ouçut
(c⁄° *
öput
, *
addr
);

74 #unde‡
gëiÁddrs


77 
	$socks_gëiÁddrs
(
iÁp
)

78 
iÁddrs
 **
iÁp
;

80 c⁄° *
fun˘i⁄
 = "sockd_getifaddrs()";

81 
rc
;

83 
rc
 = 
	`gëiÁddrs
(
iÁp
);

85 #i‡!
SOCKS_CLIENT


86 i‡(
rc
 != 0) {

87 i‡(
	`ERRNOISNOFILE
(
î∫o
Ë&& 
sockscf
.
°©e
.
ª£rvedfdv
[0] != -1) {

88 
	`˛o£
(
sockscf
.
°©e
.
ª£rvedfdv
[0]);

90 
rc
 = 
	`gëiÁddrs
(
iÁp
);

92 
sockscf
.
°©e
.
ª£rvedfdv
[0] = 
	`makedummyfd
(0, 0);

97  
rc
;

98 
	}
}

100 #i‡!
SOCKS_CLIENT


102 
ùv6_addrsc›e_t


103 
	$ùv6_addrsc›e
(
a
)

104 c⁄° 
ö6_addr
 *
a
;

106 c⁄° *
fun˘i⁄
 = "ipv6_addrscope()";

107 
ùv6_addrsc›e_t
 
sc›e
;

108 
¡›
[256];

110 i‡(
	`IN6_IS_ADDR_UNSPECIFIED
(
a
Ë|| 
	`IN6_IS_ADDR_MC_GLOBAL
(a))

111 
sc›e
 = 
addrsc›e_globÆ
;

112 i‡(
	`IN6_IS_ADDR_LINKLOCAL
(
a
Ë|| 
	`IN6_IS_ADDR_MC_LINKLOCAL
(a))

113 
sc›e
 = 
addrsc›e_lökloˇl
;

114 i‡(
	`IN6_IS_ADDR_LOOPBACK
(
a
Ë|| 
	`IN6_IS_ADDR_MC_NODELOCAL
(a))

115 
sc›e
 = 
addrsc›e_nodñoˇl
;

120 
sc›e
 = 
addrsc›e_globÆ
;

122 i‡(
	`öë_¡›
(
AF_INET6
, 
a
, 
¡›
, “t›)Ë=
NULL
)

123 
	`¢¥ötf
(
¡›
, “t›), "<%s>", 
	`°ªº‹
(
î∫o
));

125 
	`¶og
(
LOG_DEBUG
, "%s:áddress %s,áddrscope: %s",

126 
fun˘i⁄
, 
¡›
, 
	`addrsc›e2°rög
(
sc›e
));

128  
sc›e
;

129 
	}
}

132 
	$sockd_gëmaˇddr
(
i‚ame
, 
addr
)

133 c⁄° *
i‚ame
;

134 *
addr
;

136 c⁄° *
fun˘i⁄
 = "sockd_getmacaddr()";

138 #i‡
HAVE_SIOCGIFHWADDR


139 
i‰eq
 
i‰
;

140 
rc
, 
s
;

142 
	`¶og
(
LOG_DEBUG
, "%s: HAVE_SIOCGIFHWADDR. I‚amê%s", 
fun˘i⁄
, 
i‚ame
);

144 
	`°∫˝y
(
i‰
.
i‰_«me
, 
i‚ame
, (ifr.ifr_name) - 1);

145 
i‰
.
i‰_«me
[(i‰.i‰_«meË- 1] = 
NUL
;

147 i‡((
s
 = 
sockscf
.
°©e
.
ª£rvedfdv
[0]) == -1)

148 
s
 = 
sockscf
.
°©e
.
ª£rvedfdv
[0] = 
	`makedummyfd
(0, 0);

150 i‡(
s
 == -1) {

151 
	`sw¨n
("%s: couldÇŸ cª©êsockë", 
fun˘i⁄
);

152  
NULL
;

155 
rc
 = 
	`io˘l
(
s
, 
SIOCGIFHWADDR
, &
i‰
);

157 i‡(
rc
 != 0) {

158 
	`sw¨n
("%s: io˘l(SIOCGIFHWADDR)", 
fun˘i⁄
);

159  
NULL
;

162 
	`mem˝y
(
addr
, 
i‰
.
i‰_hwaddr
.
ß_d©a
, 
ETHER_ADDR_LEN
);

165 
ouçut
[1024];

167 
	`¶og
(
LOG_DEBUG
, "%s: don't have HAVE_SIOCGIFHWADDR, so using ifconfig. "

169 
fun˘i⁄
, 
i‚ame
);

171 i‡(
	`gë_ifc⁄fig_ouçut
(
i‚ame
, 
ouçut
, (output)) != 0) {

172 
	`¶og
(
LOG_DEBUG
,

174 
fun˘i⁄
, 
i‚ame
);

176  
NULL
;

179 i‡(
	`∑r£_ifc⁄fig_ouçut
(
ouçut
, 
addr
) != 0) {

180 
	`¶og
(
LOG_DEBUG
, "%s:Öarsing ifconfig output for interface %s failed",

181 
fun˘i⁄
, 
i‚ame
);

183 #i‡
HAVE_SOLARIS_BUGS


184 i‡(!
sockscf
.
°©e
.
havïrivs
)

185 
	`sw¨nx
("%s:Öarsing ifconfig output for interface %s failed. "

189 
fun˘i⁄
, 
i‚ame
, 
PRODUCT
);

192  
NULL
;

196 
	`¶og
(
LOG_DEBUG
,

198 
fun˘i⁄
,

199 
i‚ame
,

200 
addr
[0],áddr[1],áddr[2],áddr[3],áddr[4],áddr[5]);

202  
addr
;

203 
	}
}

205 #i‡!
HAVE_SIOCGIFHWADDR


207 
	$gë_ifc⁄fig_ouçut
(
i‚ame
, 
ouçut
, 
ouçuéí
)

208 c⁄° *
i‚ame
;

209 *
ouçut
;

210 
size_t
 
ouçuéí
;

212 c⁄° *
fun˘i⁄
 = "get_ifconfig_output()";

213 
FILE
 *
Â
;

214 
size_t
 
i
, 
rc
;

215 c⁄° *
ifc⁄fig_∑ths
[] = { "ifconfig",

220 
i
 = 0; i < 
	`ELEMENTS
(
ifc⁄fig_∑ths
); ++i) {

221 
cmd
[256];

223 
	`¢¥ötf
(
cmd
, (cmd), "%s %s 2>/dev/null",

224 
ifc⁄fig_∑ths
[
i
], 
i‚ame
);

226 
	`¶og
(
LOG_DEBUG
, "%s:Åryög %†... \n", 
fun˘i⁄
, 
cmd
);

229 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

230 
Â
 = 
	`p›í
(
cmd
, "r");

231 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

233 i‡(
Â
 =
NULL
) {

234 
	`¶og
(
LOG_DEBUG
, "%s:Öopen(%s) failed: %s\n",

235 
fun˘i⁄
, 
cmd
, 
	`°ªº‹
(
î∫o
));

240 
rc
 = 
	`‰ód
(
ouçut
, 1, 
ouçuéí
 - 1, 
Â
);

241 
ouçut
[
rc
] = 
NUL
;

242 
	`p˛o£
(
Â
);

244 i‡(
rc
 == 0) {

245 
	`¶og
(
LOG_DEBUG
, "%s:Öopen(%s) failed: %s\n",

246 
fun˘i⁄
, 
cmd
, 
	`°ªº‹
(
î∫o
));

254 i‡(
Â
 =
NULL
)

258 
	}
}

261 
	$∑r£_ifc⁄fig_ouçut
(
öput
, 
addr
)

262 c⁄° *
öput
;

263 *
addr
;

265 c⁄° *
fun˘i⁄
 = "parse_ifconfig_output()";

266 
ªgex_t
 
¥eg
;

267 
ªgm©ch_t
 
pm©ch
;

268 
size_t
 
i
, 
√xtbyã
;

270 i‡(
	`ªgcomp
(&
¥eg
,

279 
REG_EXTENDED
) != 0)

282 i‡(
	`ªgexec
(&
¥eg
, 
öput
, 1, &
pm©ch
, 0) != 0)

285 
√xtbyã
 = 
pm©ch
.
rm_so
;

286 
	`is•a˚
(
öput
[
√xtbyã
]))

287 ++
√xtbyã
;

289 
i
 = 0; i < 6; ++i) {

290 *
íd±r
;

292 
î∫o
 = 0;

293 
addr
[
i
] = ()
	`°πﬁ
(&
öput
[
√xtbyã
], &
íd±r
, 16);

294 
√xtbyã
 +(
íd±r
 - &
öput
[√xtbyã]Ë+ 
	`°æí
(":");

297 i‡(
i
 !5 && *
íd±r
 != ':') {

298 
	`sw¨nx
("%s: missög ':' sï¨©‹ i¿°rög: %s", 
fun˘i⁄
, 
öput
);

302 i‡(
î∫o
 =
ERANGE
) {

303 
	`sw¨n
("%s: ouào‡øngêö såög: %s", 
fun˘i⁄
, 
öput
);

309 
	}
}

	@lib/io.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
¥öt_£À˘fds
(c⁄° *
¥ómbÀ
, c⁄° 
docheck
, c⁄° 
nfds
,

52 
fd_£t
 *
r£t
, fd_£à*
bu‰£t
, fd_£à*
buffw£t
,

53 
fd_£t
 *
w£t
, fd_£à*
x£t
,

54 c⁄° 
time•ec
 *
timeout
);

56 
ssize_t


57 
	$socks_ªcv‰omn
(
s
, 
buf
, 
Àn
, 
möªad
, 
Êags
, 
‰om
, 
‰omÀn
, 
ªcvÊags
, 
auth
)

58 c⁄° 
s
;

59 *
buf
;

60 c⁄° 
size_t
 
Àn
;

61 c⁄° 
size_t
 
möªad
;

62 c⁄° 
Êags
;

63 
sockaddr_°‹age
 *
‰om
;

64 
sockÀn_t
 *
‰omÀn
;

65 
ªcv‰om_öfo_t
 *
ªcvÊags
;

66 
authmëhod_t
 *
auth
;

68 c⁄° *
fun˘i⁄
 = "socks_recvfromn()";

69 
fd_£t
 *
r£t
;

70 
ssize_t
 
p
;

71 
size_t
 
À·
;

73 i‡(
r£t
 =
NULL
)

74 
r£t
 = 
	`Æloˇã_maxsize_fd£t
();

76 
À·
 = 
Àn
;

78 #i‡
SOCKS_CLIENT


85 
sockscf
.
°©e
.
h™dÀdsig«l
 = 0;

88 i‡((
p
 = 
	`socks_ªcv‰om
(
s
,

89 &((*)
buf
)[
Àn
 - 
À·
],

90 
À·
,

91 
Êags
,

92 
‰om
,

93 
‰omÀn
,

94 
ªcvÊags
,

95 
auth
)) == -1) {

96 #i‡!
SOCKS_CLIENT


98 i‡(
î∫o
 =
EINTR
) {

99 
î∫o
 = 0;

103 i‡(
	`ERRNOISTMP
(
î∫o
Ë&& 
Àn
 - 
À·
 < 
möªad
) {

108 
î∫o
 = 0;

109 
	`FD_ZERO
(
r£t
);

110 
	`FD_SET
(
s
, 
r£t
);

112 i‡(
	`£À˘
(
s
 + 1, 
r£t
, 
NULL
, NULL, NULL) == 1)

115 i‡(
î∫o
 =
EINTR
)

118 
	`SWARNX
(
î∫o
);

122 
	`¶og
(
LOG_DEBUG
, "%s:Çon-temporaryÑeadÉrror: %s",

123 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

130 i‡(
î∫o
 =
EINTR
) {

131 i‡(
sockscf
.
°©e
.
h™dÀdsig«l
) {

138 
	`¶og
(
LOG_DEBUG
,

142 
fun˘i⁄
,

143 ()
sockscf
.
°©e
.
h™dÀdsig«l
,

144 
	`sig«l2°rög
(
sockscf
.
°©e
.
h™dÀdsig«l
));

146 
sockscf
.
°©e
.
h™dÀdsig«l
 = 0;

158 i‡(
p
 == 0)

161 
	`SASSERTX
(
p
 > 0);

163 
À·
 -(
size_t
)
p
;

164 } 
Àn
 - 
À·
 < 
möªad
);

166 i‡(
À·
 =
Àn
)

167  
p
;

169  
Àn
 - 
À·
;

170 
	}
}

172 
ssize_t


173 
	$socks_£ndt⁄
(
s
, 
buf
, 
Àn
, 
möwrôe
, 
Êags
, 
to
, 
tﬁí
, 
£ndtoÊags
, 
auth
)

174 
s
;

175 c⁄° *
buf
;

176 
size_t
 
Àn
;

177 c⁄° 
size_t
 
möwrôe
;

178 
Êags
;

179 c⁄° 
sockaddr_°‹age
 *
to
;

180 
sockÀn_t
 
tﬁí
;

181 
£ndto_öfo_t
 *
£ndtoÊags
;

182 
authmëhod_t
 *
auth
;

184 c⁄° *
fun˘i⁄
 = "socks_sendton()";

185 
fd_£t
 *
w£t
;

186 
ssize_t
 
p
;

187 
size_t
 
À·
 = 
Àn
;

189 i‡(
w£t
 =
NULL
)

190 
w£t
 = 
	`Æloˇã_maxsize_fd£t
();

192 
	`SASSERTX
(
möwrôe
 <
Àn
);

195 i‡((
p
 = 
	`socks_£ndto
(
s
,

196 &((c⁄° *)
buf
)[
Àn
 - 
À·
],

197 
À·
,

198 
Êags
,

199 
to
,

200 
tﬁí
,

201 
£ndtoÊags
,

202 
auth
)) == -1) {

203 #i‡!
SOCKS_CLIENT


204 i‡(
î∫o
 =
EINTR
)

208 i‡((
î∫o
 =
EAGAIN
 ||Éºnÿ=
EWOULDBLOCK
Ë&& 
möwrôe
 > 0) {

209 
î∫o
 = 0;

211 
	`FD_ZERO
(
w£t
);

212 
	`FD_SET
(
s
, 
w£t
);

213 i‡(
	`£À˘n
(
s
 + 1, 
NULL
, NULL, 
w£t
, NULL, NULL, NULL) == -1) {

214 i‡(
î∫o
 !
EINTR
)

215 
	`sw¨n
("%s: sñe˘()", 
fun˘i⁄
);

226 
À·
 -(
size_t
)
p
;

228 i‡(
£ndtoÊags
 !
NULL
)

229 
£ndtoÊags
->
tosockë
 +
p
;

230 } (
Àn
 - 
À·
Ë< 
möwrôe
);

232  
Àn
 - 
À·
;

233 
	}
}

235 
ssize_t


236 
	$socks_ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
, 
ªcvÊags
, 
auth
)

237 
s
;

238 *
buf
;

239 
size_t
 
Àn
;

240 
Êags
;

241 
sockaddr_°‹age
 *
‰om
;

242 
sockÀn_t
 *
‰omÀn
;

243 
ªcv‰om_öfo_t
 *
ªcvÊags
;

244 
authmëhod_t
 *
auth
;

246 c⁄° *
fun˘i⁄
 = "socks_recvfrom()";

247 
ssize_t
 
r
;

248 #i‡!
SOCKS_CLIENT


249 
size_t
 
t‹ód
, 
toˇŒî
, 
tobuf
;

250 
ssize_t
 
ªad‰ombuf
;

251 
tmpbuf
[
	`MAX
((
sockd_io_t
), 
SOCKD_BUFSIZE
)];

254 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

255 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Üen %lu, flags %d",

256 
fun˘i⁄
, 
s
, ()
Àn
, 
Êags
);

258 i‡(
auth
 !
NULL
)

259 
	`SASSERTX
(
	`authmëhodisknown
(
auth
->
mëhod
));

261 i‡(
ªcvÊags
 !
NULL
) {

262 
ªcvÊags
->
Êags
 = 0;

263 
ªcvÊags
->
‰omsockë
 = 0;

264 
	`timî˛ór
(&
ªcvÊags
->
ts
);

267 #i‡
HAVE_GSSAPI


268 i‡(
auth
 !
NULL


269 && 
auth
->
mëhod
 =
AUTHMETHOD_GSSAPI
 &&áuth->
md©a
.
gsßpi
.
°©e
.
wøp
)

270  
	`gsßpi_decode_ªad
(
s
,

271 
buf
,

272 
Àn
,

273 
Êags
,

274 
‰om
,

275 
‰omÀn
,

276 
ªcvÊags
,

277 &
auth
->
md©a
.
gsßpi
.
°©e
);

280 #i‡
SOCKS_CLIENT


281 
	`SASSERTX
(
ªcvÊags
 =
NULL
);

287 i‡(
‰om
 =
NULL
 && 
Êags
 == 0)

289 
r
 = 
	`ªad
(
s
, 
buf
, 
Àn
);

291 
r
 = 
	`ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
	`TOSA
(
‰om
), 
‰omÀn
);

293 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

294 
	`¶og
(
LOG_DEBUG
, "%s:Ñead %ld byte%s,Érrno = %d (%s)",

295 
fun˘i⁄
, ()
r
,Ñ =1 ? "" : "s", 
î∫o
, 
	`°ªº‹
(errno));

297 i‡(
r
 >= 0)

303 
î∫o
 = 0;

305  
r
;

318 i‡(
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
) {

319 
	`SASSERTX
(
Êags
 == 0);

320 
	`SASSERTX
(
‰om
 =
NULL
);

321 
	`SASSERTX
(
‰omÀn
 =
NULL
);

322 
	`SASSERTX
(
auth
 =
NULL
);

323 
	`SASSERTX
(
ªcvÊags
 =
NULL
);

325  
	`ªad
(
s
, 
buf
, 
Àn
);

332 i‡((
ªad‰ombuf
 = 
	`socks_gë‰ombuf„r
(
s
, 
Êags
, 
READ_BUF
, 0, 
buf
, 
Àn
)) > 0)

334 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
) {

335 
	`¶og
(
LOG_DEBUG
, "%s:Ñead %lu byte from buf, %lu bytesÜeft in buf",

336 
fun˘i⁄
,

337 ()
ªad‰ombuf
,

338 ()
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 0));

342 i‡((
size_t
)
ªad‰ombuf
 >
Àn
)

343  
ªad‰ombuf
;

350 i‡(
	`socks_gëbuf„r
(
s
Ë=
NULL
)

351 
r
 = 
Àn
;

353 
r
 = 
	`MIN
(
	`socks_‰ìöbuf„r
(
s
, 
READ_BUF
), (
tmpbuf
));

355 i‡(
r
 <= 0)

356  
ªad‰ombuf
;

364 
t‹ód
 = (
size_t
)
r
;

366 i‡(
‰om
 =
NULL
 && 
Êags
 =0 && 
ªcvÊags
 == NULL)

371 
r
 = 
	`ªad
(
s
, 
tmpbuf
, 
t‹ód
);

373 c⁄° 
sockÀn_t
 
∑s£d_‰omÀn
 = (
‰omÀn
 =
NULL
 ? 0 : *fromlen);

374 
Áûuªs
, 
Áûed_sockë
;

375 
msghdr
 
msg
;

376 
iovec
 
iov
 = { 
tmpbuf
, 
t‹ód
 };

377 
	`CMSG_AALLOC
(
cmsg
, (
ªcvÊags
->
ts
));

379 
	`bzîo
(&
msg
, (msg));

380 
msg
.
msg_«me
 = 
‰om
;

381 
msg
.
msg_«mñí
 = 
∑s£d_‰omÀn
;

382 
msg
.
msg_iov
 = &
iov
;

383 
msg
.
msg_iovÀn
 = 1;

385 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

387 i‡((
r
 = 
	`ªcvmsgn
(
s
, &
msg
, 
Êags
)) == -1) {

388 
	`¶og
(
LOG_DEBUG
, "%s:Ñecvmsgn() on fd %d failed (%s)",

389 
fun˘i⁄
, 
s
, 
	`°ªº‹
(
î∫o
));

391 #i‡
HAVE_LINUX_BUGS


392 i‡(
î∫o
 == 0) {

393 c⁄° 
î∫o_s
 = 
î∫o
;

394 
isudpsockë
;

396 i‡(
ªcvÊags
 !
NULL
)

397 
isudpsockë
 = 
ªcvÊags
->
ty≥
 =
SOCK_DGRAM
;

399 
iobuf„r_t
 *
iobuf
;

401 i‡((
iobuf
 = 
	`socks_gëbuf„r
(
s
)Ë!
NULL
)

402 
isudpsockë
 = (
iobuf
->
°y≥
 =
SOCK_DGRAM
);

404 
ty≥
;

405 
sockÀn_t
 
ty≥Àn
 = (
ty≥
);

407 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
ty≥
, &
ty≥Àn
) == 0

408 && 
ty≥
 =
SOCK_DGRAM
)

409 
isudpsockë
 = 1;

411 
isudpsockë
 = 0;

415 i‡(
isudpsockë
) {

416 
	`sw¨nx
("%s:ÅryingÅo workáround Linux bug.Ñecvmsg(2) "

420 
fun˘i⁄
);

422 
î∫o
 = 
EAGAIN
;

425 
î∫o
 = 
î∫o_s
;

430 i‡(
	`socks_msgha£º‹s
(
fun˘i⁄
, &
msg
))

431 
r
 = -1;

432 i‡(
msg
.
msg_«mñí
 < (
sockaddr_ö
)

433 && 
∑s£d_‰omÀn
 >(
sockaddr_ö
)) {

442 
	`sw¨nx
("%s: kernel/systemÉrror: didÇot getá valid src "

445 
fun˘i⁄
, 
s
, ()*
‰omÀn
, ()
r
);

447 i‡(
Áûuªs
++ >= 4) {

453 
	`sw¨nx
("%s: giving upáfter %dÑecvfrom(2) failures",

454 
fun˘i⁄
, 
Áûuªs
);

457 
Áûuªs
 = 0;

458 
î∫o
 = 0;

463 
Áûed_sockë
 = 
s
;

465 
î∫o
 = 
EAGAIN
;

470 i‡(
Áûed_sockë
 =
s
)

471 
Áûuªs
 = 0;

473 i‡(
ªcvÊags
 !
NULL
) {

474 
ªcvÊags
->
Êags
 = 
msg
.
msg_Êags
;

476 #i‡
HAVE_SO_TIMESTAMP


477 i‡(
	`CMSG_TOTLEN
(
msg
) != 0) {

478 i‡(!
	`CMSG_RCPTLEN_ISOK
(
msg
, (
timevÆ
))) {

479 
	`sw¨nx
("%s: didÇotÑeceiveáÅimestamp forÖacket "

481 
fun˘i⁄
,

482 ()
r
,

483 ()
	`CMSG_TOTLEN
(
msg
));

485 
	`timî˛ór
(&
ªcvÊags
->
ts
);

488 
	`SASSERTX
(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET
);

489 
	`SASSERTX
(
cmsg
->
cmsg_ty≥
 =
SCM_TIMESTAMP
);

491 
	`CMSG_GETOBJECT
(
ªcvÊags
->
ts
, 
cmsg
, 0);

495 
	`timî˛ór
(&
ªcvÊags
->
ts
);

498 
	`timî˛ór
(&
ªcvÊags
->
ts
);

506 i‡(
r
 =-1 && 
ªcvÊags
 !
NULL
 &&ÑecvÊags->
ty≥
 =
SOCK_DGRAM
)

507 i‡(
	`ERRNOISPREVIOUSPACKET
(
î∫o
))

508 
	`log_wrôeÁûed
(
ªcvÊags
->
side
 =
INTERNALIF
 ?

509 
EXTERNALIF
 : 
INTERNALIF
,

510 
s
,

511 &
ªcvÊags
->
≥î
);

513 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

514 
	`¶og
(
LOG_DEBUG
,

516 
fun˘i⁄
,

517 ()
r
,

518 ()
t‹ód
,

519 
s
,

520 
î∫o
,

521 
	`°ªº‹
(
î∫o
));

523 i‡(
r
 <= 0) {

524 i‡(
ªad‰ombuf
 <= 0)

525  
r
;

529 
î∫o
 = 0;

530  
ªad‰ombuf
;

533 i‡(
ªcvÊags
 !
NULL
)

534 
ªcvÊags
->
‰omsockë
 +
r
;

537 
toˇŒî
 = 
	`MIN
((
size_t
)
r
, 
Àn
 - 
ªad‰ombuf
);

539 i‡(
Êags
 & 
MSG_PEEK
)

544 
tobuf
 = 0;

549 
tobuf
 = (
size_t
)
r
 - 
toˇŒî
;

551 
	`mem˝y
((*)
buf
 + 
ªad‰ombuf
, 
tmpbuf
, 
toˇŒî
);

553 i‡(
tobuf
 > 0)

554 
	`socks_addtobuf„r
(
s
, 
READ_BUF
, 0, 
tmpbuf
 + 
toˇŒî
, 
tobuf
);

556  
ªad‰ombuf
 + 
toˇŒî
;

558 
	}
}

560 
ssize_t


561 
	$socks_£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
to
, 
tﬁí
, 
£ndtoÊags
, 
auth
)

562 
s
;

563 c⁄° *
msg
;

564 
size_t
 
Àn
;

565 
Êags
;

566 c⁄° 
sockaddr_°‹age
 *
to
;

567 
sockÀn_t
 
tﬁí
;

568 
£ndto_öfo_t
 *
£ndtoÊags
;

569 
authmëhod_t
 *
auth
;

571 c⁄° *
fun˘i⁄
 = "socks_sendto()";

572 
ssize_t
 
wrôãn
;

573 #i‡!
SOCKS_CLIENT


574 
ssize_t
 
towrôe
, 
wrôãn_fb
, 
p
;

575 
buf
[
	`MAX
((
sockd_io_t
), 
SOCKD_BUFSIZE
)];

578 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

579 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Üen %lu, flags %d,Åo = %s",

580 
fun˘i⁄
,

581 
s
,

582 ()
Àn
,

583 
Êags
,

584 
to
 =
NULL
 ? "NULL" : 
	`sockaddr2°rög
(to, NULL, 0));

586 i‡(
to
 !
NULL
 && 
tﬁí
 != 0)

587 
tﬁí
 = 
	`ßÀn
(
to
->
ss_Ámûy
);

589 i‡(
auth
 !
NULL
)

590 
	`SASSERTX
(
	`authmëhodisknown
(
auth
->
mëhod
));

592 i‡(
£ndtoÊags
 !
NULL
) {

593 
£ndtoÊags
->
tosockë
 = 0;

595 #i‡!
SOCKS_CLIENT


596 
	`SASSERTX
(
£ndtoÊags
->
side
 !
NONESETIF
);

600 #i‡
HAVE_GSSAPI


601 i‡(
auth
 !
NULL


602 && 
auth
->
mëhod
 =
AUTHMETHOD_GSSAPI
 &&áuth->
md©a
.
gsßpi
.
°©e
.
wøp
) {

603 
wrôãn
 = 
	`gsßpi_ícode_wrôe
(
s
,

604 
msg
,

605 
Àn
,

606 
Êags
,

607 
to
,

608 
tﬁí
,

609 
£ndtoÊags
,

610 &
auth
->
md©a
.
gsßpi
.
°©e
);

612 i‡(
wrôãn
 =-1 && 
£ndtoÊags
 !
NULL
)

613 
	`log_wrôeÁûed
(
£ndtoÊags
->
side
, 
s
, 
to
);

615 
	`¶og
(
LOG_DEBUG
, "%s: gssapi-written on fd %d: %ld (%s)",

616 
fun˘i⁄
, 
s
, ()
wrôãn
, 
	`°ªº‹
(
î∫o
));

618  
wrôãn
;

622 #i‡
SOCKS_CLIENT


627 i‡(
to
 =
NULL
 && 
Êags
 == 0)

629 
wrôãn
 = 
	`wrôe
(
s
, 
msg
, 
Àn
);

631 
wrôãn
 = 
	`£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
	`TOCSA
(
to
), 
tﬁí
);

633 i‡(
wrôãn
 !-1 && 
£ndtoÊags
 !
NULL
)

634 
£ndtoÊags
->
tosockë
 = 
wrôãn
;

636 
	`¶og
(
LOG_DEBUG
, "%s: wrôã¿⁄ fd %d: %ld", 
fun˘i⁄
, 
s
, ()
wrôãn
);

638  
wrôãn
;

641 i‡((
towrôe
 = 
	`socks_gë‰ombuf„r
(
s
, 0, 
WRITE_BUF
, 0, 
buf
, 
Àn
)) > 0) {

654 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

655 
	`¶og
(
LOG_DEBUG
,

657 
fun˘i⁄
,

658 ()
towrôe
,Åowrite == 1 ? "" : "s",

659 ()
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 0));

661 
wrôãn_fb
 = 
	`£ndto
(
s
, 
buf
, (
size_t
)
towrôe
, 
Êags
, 
	`TOCSA
(
to
), 
tﬁí
);

663 i‡(
£ndtoÊags
 !
NULL
) {

664 i‡(
wrôãn_fb
 == -1)

665 
	`log_wrôeÁûed
(
£ndtoÊags
->
side
, 
s
, 
to
);

667 
£ndtoÊags
->
tosockë
 +
wrôãn_fb
;

670 i‡(
wrôãn_fb
 < 
towrôe
) {

674 c⁄° 
ssize_t
 
addback
 = 
wrôãn_fb
 > 0 ?

675 
towrôe
 - 
wrôãn_fb
 :Åowrite;

677 i‡((
p
 = 
	`socks_addtobuf„r
(
s
,

678 
WRITE_BUF
,

680 
buf
 + (
towrôe
 - 
addback
),

681 (
size_t
)
addback
)) !=áddback)

682 
	`SERRX
(
p
);

686 i‡(
wrôãn_fb
 == -1) {

687 i‡(!
	`ERRNOISTMP
(
î∫o
))

691 
towrôe
 = 0;

694 
towrôe
 = 
Àn
 - 
wrôãn_fb
;

698 
towrôe
 = 
Àn
;

700 i‡(
towrôe
 >= 0) {

705 i‡((
wrôãn
 = 
	`£ndto
(
s
, 
msg
, (
size_t
)
towrôe
, 
Êags
, 
	`TOCSA
(
to
), 
tﬁí
))

707 
iobuf„r_t
 *
iobuf
;

709 i‡(
£ndtoÊags
 !
NULL
)

710 
	`log_wrôeÁûed
(
£ndtoÊags
->
side
, 
s
, 
to
);

712 
	`¶og
(
LOG_DEBUG
, "%s: %s(2) failed: %s",

713 
fun˘i⁄
,

714 
to
 =
NULL
 && 
Êags
 == 0 ? "write" : "sendto",

715 
	`°ªº‹
(
î∫o
));

721 i‡(!
	`ERRNOISTMP
(
î∫o
)

722 || (
iobuf
 = 
	`socks_gëbuf„r
(
s
)Ë=
NULL


723 || 
iobuf
->
°y≥
 =
SOCK_DGRAM
)

724  
wrôãn
;

726 
wrôãn
 = 0;

730 
wrôãn
 = 0;

732 i‡(
£ndtoÊags
 !
NULL
)

733 
£ndtoÊags
->
tosockë
 +
wrôãn
;

735 
	`SASSERTX
(
wrôãn
 <(
ssize_t
)
Àn
);

737 
towrôe
 = 
Àn
 - 
wrôãn
;

738 i‡(
towrôe
 > 0) {

739 
iobuf„r_t
 *
iobuf
;

740 
ssize_t
 
wrôãn_tb
;

741 
dobuf„r
;

743 i‡((
iobuf
 = 
	`socks_gëbuf„r
(
s
)Ë!
NULL


744 && 
iobuf
->
°y≥
 !
SOCK_DGRAM
)

745 
dobuf„r
 = 1;

747 
dobuf„r
 = 0;

749 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

750 
	`¶og
(
LOG_DEBUG
, "%s: %lu byte%s unwrittenÅo socket. %s",

751 
fun˘i⁄
,

752 ()
towrôe
,

753 
towrôe
 == 1 ? "" : "s",

754 
dobuf„r
 ? "AddingÅo buffer" : "");

756 i‡(!
dobuf„r
)

757  
wrôãn
;

759 
wrôãn_tb
 = 
	`socks_addtobuf„r
(
s
,

760 
WRITE_BUF
,

762 (c⁄° *)
msg
 + 
wrôãn
,

763 (
size_t
)
towrôe
);

764 
towrôe
 -
wrôãn_tb
;

767 
	`SASSERTX
(
towrôe
 == 0);

769  
Àn
;

771 
	}
}

773 
ssize_t


774 
	$ªcvmsgn
(
s
, 
msg
, 
Êags
)

775 
s
;

776 
msghdr
 *
msg
;

777 
Êags
;

779 c⁄° *
fun˘i⁄
 = "recvmsgn()";

780 
ssize_t
 
ª˚ived
;

782 i‡((
ª˚ived
 = 
	`ªcvmsg
(
s
, 
msg
, 
Êags
)) == -1)

783 
	`¶og
(
LOG_DEBUG
, "%s:Ñecvmsg() on fd %d failed,Ñeceived %ld bytes%s %s",

784 
fun˘i⁄
,

785 
s
, ()
ª˚ived
,

786 
sockscf
.
°©e
.
ösig«l
 ? "" : ":",

787 
sockscf
.
°©e
.
ösig«l
 ? "" : 
	`°ªº‹
(
î∫o
));

789  
ª˚ived
;

797 i‡(
ª˚ived
 <= 0)

798  
ª˚ived
;

799 
À·
 = 
Àn
 - (
size_t
)
ª˚ived
;

801 i‡(
À·
 > 0) {

802 
size_t
 
i
, 
cou¡
, 
d⁄e
;

809 
	`SASSERTX
(
ª˚ived
 >= 0);

811 
d⁄e
 = (
size_t
)
ª˚ived
;

812 
i
 = 
cou¡
 = 
ª˚ived
 = 0;

813 
i
 < (
size_t
)
msg
->
msg_iovÀn
 && 
À·
 > 0) {

814 c⁄° 
iovec
 *
io
 = &
msg
->
msg_iov
[
i
];

816 
cou¡
 +
io
->
iov_Àn
;

817 i‡(
cou¡
 > 
d⁄e
) {

818 i‡((
ª˚ived
 = 
	`socks_ªcv‰omn
(
s
,

819 &((*)(
io
->
iov_ba£
))[io->
iov_Àn
 - (
cou¡
 - 
d⁄e
)],

820 
cou¡
 - 
d⁄e
,

821 
cou¡
 - 
d⁄e
,

823 
NULL
,

824 
NULL
,

825 
NULL
,

826 
NULL
,

827 
NULL
,

828 
NULL
))

829 !((
ssize_t
)(
cou¡
 - 
d⁄e
))) {

834 
size_t
 
Àaked
;

835 
d
;

837 
	`sw¨n
("%s: %ld byte%sÜeft",

838 
fun˘i⁄
, ()
À·
,Üeft == 1 ? "" : "s");

840 
Àaked
 = 0;

841 
	`CMSG_SPACE
(
Àaked
 * (
d
)Ë< (
size_t
)
	`CMSG_TOTLEN
(*
msg
);

842 ++
Àaked
) {

843 
	`CMSG_GETOBJECT
(
d
, 
	`CMSG_CONTROLDATA
(*
msg
), 
Àaked
 * (d));

844 
	`˛o£
(
d
);

850 
À·
 -
ª˚ived
;

851 
d⁄e
 +
ª˚ived
;

854 ++
i
;

858 i‡(
À·
 =
Àn
)

859  
ª˚ived
;

860  
Àn
 - 
À·
;

863 
	}
}

865 
ssize_t


866 
	$£ndmsgn
(
s
, 
msg
, 
Êags
, 
timeoutms
)

867 
s
;

868 c⁄° 
msghdr
 *
msg
;

869 
Êags
;

870 c⁄° 
time_t
 
timeoutms
;

872 c⁄° *
fun˘i⁄
 = "sendmsgn()";

873 
fd_£t
 *
w£t
;

874 c⁄° 
maxÁûuªs
 = 10;

875 
timevÆ
 
time°¨t
;

876 
ssize_t
 
p
, 
£¡
;

877 
size_t
 
Àn
;

878 
Áûedcou¡
, 
£ndmsg_î∫o
;

880 #i‡!
SOCKS_CLIENT


881 i‡(
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
)

887 
	`SASSERTX
(
timeoutms
 == 0);

890 i‡(
w£t
 =
NULL
)

891 
w£t
 = 
	`Æloˇã_maxsize_fd£t
();

894 
Áûedcou¡
 = 
Àn
 = 0;

895 (
£¡
 = 
	`£ndmsg
(
s
, 
msg
, 
Êags
)) == -1) {

896 
timevÆ
 
timñe·
;

897 
d‹ëry
 = ( 
	`ERRNOISTMP
(
î∫o
)

898 && ++
Áûedcou¡
 < 
maxÁûuªs


899 && 
timeoutms
 != 0);

901 
£ndmsg_î∫o
 = 
î∫o
;

903 i‡(
Àn
 == 0)

904 
p
 = 0;Ö < (
ssize_t
)
msg
->
msg_iovÀn
; ++p)

905 
Àn
 +
msg
->
msg_iov
[
p
].
iov_Àn
;

907 i‡(
d‹ëry
) {

908 c⁄° 
timevÆ
 
max_timëou£
 = { 0, 
timeoutms
 * 1000 };

909 
timevÆ
 
timíow
;

911 i‡(
Áûedcou¡
 == 1)

912 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
time°¨t
);

914 i‡(
timeoutms
 != -1) {

915 
timevÆ
 
timeu£d
;

917 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
timíow
);

918 
	`timîsub
(&
timíow
, &
time°¨t
, &
timeu£d
);

920 
	`SASSERTX
(
timeu£d
.
tv_£c
 >= 0);

922 
	`timîsub
(&
max_timëou£
, &
timeu£d
, &
timñe·
);

923 i‡(
timñe·
.
tv_£c
 < 0)

924 
d‹ëry
 = 0;

928 
	`¶og
(
LOG_DEBUG
,

930 
fun˘i⁄
,

931 ()
Àn
,

932 
s
,

933 
Áûedcou¡
,

934 
	`°ªº‹
(
î∫o
),

935 
d‹ëry
 ? ". Will blockándÑetry" : ". Giving up onÅhis one");

937 i‡(!
d‹ëry
) {

938 i‡(
î∫o
 == 0)

939 
î∫o
 = 
£ndmsg_î∫o
;

944 i‡(
Áûedcou¡
 + 1 >
maxÁûuªs
) {

945 i‡(
timeoutms
 == -1) {

950 
timñe·
.
tv_£c
 = 1;

951 
timñe·
.
tv_u£c
 = 0;

954 
	`¶og
(
LOG_DEBUG
,

958 
fun˘i⁄
,

959 
Áûedcou¡
,

960 ()
timñe·
.
tv_£c
,

961 ()
timñe·
.
tv_u£c
);

963 i‡((
p
 = 
	`£À˘n
(0, 
NULL
, NULL, NULL, NULL, NULL, &
timñe·
)) <= 0) {

964 
	`¶og
(
LOG_DEBUG
, "%s: select()Ñeturned %ld, withÅime %ld.%06ld",

965 
fun˘i⁄
,

966 ()
p
,

967 ()
timñe·
.
tv_£c
,

968 ()
timñe·
.
tv_u£c
);

970 i‡(
î∫o
 == 0)

971 
î∫o
 = 
£ndmsg_î∫o
;

979 
	`FD_ZERO
(
w£t
);

980 
	`FD_SET
(
s
, 
w£t
);

981 
p
 = 
	`£À˘n
(
s
 + 1,

982 
NULL
,

983 
NULL
,

984 
NULL
,

985 
w£t
,

986 
NULL
,

987 
timeoutms
 =-1 ? 
NULL
 : &
timñe·
);

989 i‡(
timeoutms
 == -1)

990 
	`¶og
(
LOG_DEBUG
, "%s: sñe˘(Ëªtu∫ed %d", 
fun˘i⁄
, ()
p
);

992 
	`¶og
(
LOG_DEBUG
, "%s: select()Ñeturned %d, withÅime %ld.%06ld",

993 
fun˘i⁄
, ()
p
, ()
timñe·
.
tv_£c
, (Èimñe·.
tv_u£c
);

995 i‡(
p
 <= 0) {

996 #i‡
SOCKS_CLIENT


997 i‡(
î∫o
 =
EINTR
) {

998 i‡(
sockscf
.
°©e
.
h™dÀdsig«l
) {

1005 
	`¶og
(
LOG_DEBUG
,

1009 
fun˘i⁄
,

1010 ()
sockscf
.
°©e
.
h™dÀdsig«l
,

1011 
	`sig«l2°rög
(
sockscf
.
°©e
.
h™dÀdsig«l
));

1013 
sockscf
.
°©e
.
h™dÀdsig«l
 = 0;

1019 i‡(
î∫o
 == 0)

1020 
î∫o
 = 
£ndmsg_î∫o
;

1026  
£¡
;

1027 
	}
}

1030 
	$£À˘n
(
nfds
, 
r£t
, 
bu‰£t
, 
buffw£t
, 
w£t
, 
x£t
, 
_timeout
)

1031 
nfds
;

1032 
fd_£t
 *
r£t
;

1033 
fd_£t
 *
bu‰£t
;

1034 
fd_£t
 *
buffw£t
;

1035 
fd_£t
 *
w£t
;

1036 
fd_£t
 *
x£t
;

1037 
timevÆ
 *
_timeout
;

1039 c⁄° *
fun˘i⁄
 = "selectn()";

1040 
time•ec
 *
timeout
, 
timeout_mem
, 
zîŸimeout
 = { 0, 0 };

1041 
i
, 
rc
, 
buf£t_nfds
;

1042 #i‡!
SOCKS_CLIENT


1043 
sig£t_t
 
fuŒmask
;

1045 
sig£t_t
 
ﬁdmask
;

1047 #i‡
DIAGNOSTIC
 && !
SOCKS_CLIENT


1048 
timevÆ
 
tfú°sh‹t¶ìp
;

1049 
size_t
 
sh‹t¶ìpc
;

1050 
fd_£t
 *
zîo£t
;

1055 c⁄° 
timevÆ
 
tsh‹t¶ìp
 = { 0, 2 },

1056 
tsh‹âimñ≠£
 = { 0, 100000 };

1057 c⁄° 
size_t
 
maxsh‹t¶ìpc
 = 1000;

1058 
timevÆ
 
t°¨t
, 
ãnd
, 
tdiff
;

1060 i‡(
zîo£t
 =
NULL
) {

1061 
zîo£t
 = 
	`Æloˇã_maxsize_fd£t
();

1062 
	`FD_ZERO
(
zîo£t
);

1065 
	`SASSERTX
 (
_timeout
 !
NULL


1066 || (
r£t
 !
NULL
 && 
	`FD_CMP
(
zîo£t
,Ñset) != 0)

1067 || (
bu‰£t
 !
NULL
 && 
	`FD_CMP
(
zîo£t
, bufrset) != 0)

1068 || (
buffw£t
 !
NULL
 && 
	`FD_CMP
(
zîo£t
, buffwset) != 0)

1069 || (
w£t
 !
NULL
 && 
	`FD_CMP
(
zîo£t
, wset) != 0)

1070 || (
x£t
 !
NULL
 && 
	`FD_CMP
(
zîo£t
, xset) != 0));

1073 #i‡
DO_SHMEMCHECK


1074 
	`shmemcheck
();

1078 i‡(
_timeout
 =
NULL
)

1079 
timeout
 = 
NULL
;

1081 #i‡
HAVE_SELECT_MAXTIMEOUT


1082 
timevÆ
 
maxtimeout
 = { 
HAVE_SELECT_MAXTIMEOUT
, 0 };

1084 i‡(
	`timîcmp
(
_timeout
, &
maxtimeout
, >))

1085 *
_timeout
 = 
maxtimeout
;

1088 #i‡!
SOCKS_CLIENT


1089 i‡(
_timeout
->
tv_£c
 < 0) {

1090 
	`SWARNX
(
_timeout
->
tv_£c
);

1091 
_timeout
->
tv_£c
 = 0;

1094 i‡(
_timeout
->
tv_u£c
 < 0) {

1095 
	`SWARNX
(
_timeout
->
tv_u£c
);

1096 
_timeout
->
tv_u£c
 = 0;

1100 
timeout
 = &
timeout_mem
;

1101 
timeout
->
tv_£c
 = 
_timeout
->tv_sec;

1102 
timeout
->
tv_n£c
 = 
_timeout
->
tv_u£c
 * 1000;

1105 #i‡
SOCKS_CLIENT


1117 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, 
NULL
, &
ﬁdmask
) != 0)

1118 
	`£º
("%s: sig¥ocmask(ËÁûed", 
fun˘i⁄
);

1120 
	`SASSERTX
(!
	`sigismembî
(&
ﬁdmask
, 
SIGIO
));

1123 
	`sigfûl£t
(&
fuŒmask
);

1132 i‡(
	`sig¥ocmask
(
SIG_BLOCK
, &
fuŒmask
, &
ﬁdmask
) != 0)

1133 
	`SERR
(
î∫o
);

1135 i‡(
	`sockd_h™dÀdsig«ls
() != 0) {

1143 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

1144 
	`SERR
(
î∫o
);

1146 
î∫o
 = 
EINTR
;

1151 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
) {

1152 
buf
[1024];

1153 
size_t
 
bufu£d
;

1154 
i
;

1156 
bufu£d
 = 0;

1157 
i
 = 1, 
bufu£d
 = 0; i < 
SOCKS_NSIG
; ++i) {

1158 i‡((
rc
 = 
	`sigismembî
(&
ﬁdmask
, 
i
)) == 1)

1159 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

1160 "%d, ", 
i
);

1161 i‡(
rc
 == -1)

1170 i‡(
bufu£d
 != 0)

1171 
	`¶og
(
LOG_DEBUG
, "%s: sig«l†blocked i¿ﬁdmask: %s", 
fun˘i⁄
, 
buf
);

1173 
	`¥öt_£À˘fds
("pre-select:",

1174 
SOCKS_CLIENT
 ? 0 : 1,

1175 
nfds
,

1176 
r£t
,

1177 
bu‰£t
,

1178 
buffw£t
,

1179 
w£t
,

1180 
x£t
,

1181 
timeout
);

1184 
buf£t_nfds
 = 0;

1185 i‡(
bu‰£t
 !
NULL
 || 
buffw£t
 != NULL) {

1193 
i
 = 0; i < 
nfds
; ++i) {

1202 i‡(
bu‰£t
 !
NULL
) {

1203 i‡(
	`FD_ISSET
(
i
, 
bu‰£t
)

1204 && 
	`socks_byãsöbuf„r
(
i
, 
READ_BUF
, 0) > 0) {

1205 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1206 
	`¶og
(
LOG_DEBUG
,

1209 
fun˘i⁄
, 
i
,

1210 ()
	`socks_byãsöbuf„r
(
i
, 
READ_BUF
, 0),

1211 ()
	`socks_byãsöbuf„r
(
i
, 
READ_BUF
, 1),

1212 ()
	`socks_byãsöbuf„r
(
i
, 
WRITE_BUF
, 0),

1213 ()
	`socks_byãsöbuf„r
(
i
, 
WRITE_BUF
, 1));

1215 
	`FD_SET
(
i
, 
bu‰£t
);

1216 
buf£t_nfds
 = 
	`MAX
(buf£t_nfds, 
i
 + 1);

1217 
timeout
 = &
zîŸimeout
;

1220 
	`FD_CLR
(
i
, 
bu‰£t
);

1226 i‡(
buffw£t
 !
NULL
) {

1227 i‡(
	`FD_ISSET
(
i
, 
buffw£t
)

1228 && 
	`socks_buf„rhasbyãs
(
i
, 
WRITE_BUF
) > 0) {

1229 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1230 
	`¶og
(
LOG_DEBUG
,

1233 
fun˘i⁄
, 
i
,

1234 ()
	`socks_byãsöbuf„r
(
i
, 
READ_BUF
, 0),

1235 ()
	`socks_byãsöbuf„r
(
i
, 
READ_BUF
, 1),

1236 ()
	`socks_byãsöbuf„r
(
i
, 
WRITE_BUF
, 0),

1237 ()
	`socks_byãsöbuf„r
(
i
, 
WRITE_BUF
, 1));

1239 
	`FD_SET
(
i
, 
buffw£t
);

1240 
buf£t_nfds
 = 
	`MAX
(buf£t_nfds, 
i
 + 1);

1241 
timeout
 = &
zîŸimeout
;

1244 
	`FD_CLR
(
i
, 
buffw£t
);

1249 #i‡
DO_SHMEMCHECK


1250 
	`shmemcheck
();

1253 
î∫o
 = 0;

1256 #i‡
DIAGNOSTIC
 && !
SOCKS_CLIENT


1257 
	`gëtimeofday
(&
t°¨t
, 
NULL
);

1260 
rc
 = 
	`p£À˘
(
nfds
,

1261 
r£t
,

1262 
w£t
,

1263 
x£t
,

1264 
timeout
,

1265 #i‡
SOCKS_CLIENT


1266 
NULL


1268 &
ﬁdmask


1272 #i‡
DIAGNOSTIC
 && !
SOCKS_CLIENT


1273 
	`gëtimeofday
(&
ãnd
, 
NULL
);

1275 
	`timîsub
(&
ãnd
, &
t°¨t
, &
tdiff
);

1277 i‡(
	`timîcmp
(&
tdiff
, &
tsh‹t¶ìp
, >)) {

1279 i‡(
sh‹t¶ìpc
 > 0)

1280 
	`¶og
(
LOG_NOTICE
,

1282 
fun˘i⁄
, 
__LINE__
, ()
sh‹t¶ìpc
);

1285 
sh‹t¶ìpc
 = 0;

1288 i‡(
sh‹t¶ìpc
++ == 0)

1289 
tfú°sh‹t¶ìp
 = 
ãnd
;

1292 i‡(
sh‹t¶ìpc
 >
maxsh‹t¶ìpc
) {

1293 
	`timîsub
(&
ãnd
, &
tfú°sh‹t¶ìp
, &
tdiff
);

1295 i‡(
	`timîcmp
(&
tdiff
, &
tsh‹âimñ≠£
, <)) {

1296 
	`sw¨nx
("%s:Öselect(2) blocked forÜessÅhan %ld.%06lds %luÅimes "

1298 
fun˘i⁄
,

1299 ()
tsh‹t¶ìp
.
tv_£c
,

1300 ()
tsh‹t¶ìp
.
tv_u£c
,

1301 ()
sh‹t¶ìpc
,

1302 ()
tdiff
.
tv_£c
,

1303 ()
tdiff
.
tv_u£c
);

1305 
	`SERRX
(0);

1309 i‡(
sh‹t¶ìpc
 > 0)

1310 
	`¶og
(
LOG_NOTICE
,

1312 
fun˘i⁄
, 
__LINE__
, ()
sh‹t¶ìpc
);

1314 
sh‹t¶ìpc
 = 0;

1319 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
) {

1320 c⁄° 
î∫o_s
 = 
î∫o
;

1321 
pfix
[256];

1323 
	`¢¥ötf
(
pfix
, (pfix), "post-selectÑeturned %d (errno: %s)",

1324 
rc
, 
	`°ªº‹
(
î∫o
));

1326 
	`SASSERTX
(
î∫o_s
 =
î∫o
);

1327 
	`¥öt_£À˘fds
(
pfix
,

1328 
SOCKS_CLIENT
 ? 0 : 1,

1329 
nfds
,

1330 
r£t
,

1331 
bu‰£t
,

1332 
buffw£t
,

1333 
w£t
,

1334 
x£t
,

1335 
timeout
);

1336 
	`SASSERTX
(
î∫o_s
 =
î∫o
);

1339 #i‡!
SOCKS_CLIENT


1340 i‡(
rc
 =-1 && 
î∫o
 =
EINTR
)

1341 ()
	`sockd_h™dÀdsig«ls
();

1343 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

1344 
	`SERR
(
î∫o
);

1347 #i‡
DO_SHMEMCHECK


1348 
	`shmemcheck
();

1351 i‡(
rc
 == -1)

1352  
rc
;

1354  
	`MAX
(
rc
, 
buf£t_nfds
);

1355 
	}
}

1359 
	$¥öt_£À˘fds
(
¥ómbÀ
, 
docheck
,

1360 
nfds
, 
r£t
, 
bu‰£t
, 
buffw£t
, 
w£t
, 
x£t
, 
timeout
)

1361 c⁄° *
¥ómbÀ
;

1362 c⁄° 
docheck
;

1363 c⁄° 
nfds
;

1364 
fd_£t
 *
r£t
, *
bu‰£t
, *
buffw£t
;

1365 
fd_£t
 *
w£t
;

1366 
fd_£t
 *
x£t
;

1367 c⁄° 
time•ec
 *
timeout
;

1369 c⁄° *
fun˘i⁄
 = "print_selectfds()";

1370 c⁄° 
î∫o_s
 = 
î∫o
;

1371 
buf
[32],

1372 
r£tfd
[8192 * ("65535"Ë- 1], 
bu‰£tfd
[(rsetfd)],

1373 
buffw£tfd
[(
r£tfd
)], 
w£tfd
[(rsetfd)],

1374 
x£tfd
[(
r£tfd
)];

1375 
size_t
 
r£tfdi
, 
bu‰£tfdi
, 
buffw£tfdi
, 
w£tfdi
, 
x£tfdi
, 
rc
;

1376 
i
;

1378 i‡(
timeout
 !
NULL
)

1379 
	`¢¥ötf
(
buf
, (buf),

1381 ()
timeout
->
tv_£c
, (Èimeout->
tv_n£c
);

1383 
	`¢¥ötf
(
buf
, (buf), "0x0");

1385 
r£tfdi
 = 
bu‰£tfdi
 = 
buffw£tfdi
 = 
w£tfdi
 = 
x£tfdi
 = 0;

1386 *
r£tfd
 = *
bu‰£tfd
 = *
buffw£tfd
 = *
w£tfd
 = *
x£tfd
 = 
NUL
;

1388 
i
 = 0; i < 
nfds
; ++i) {

1389 i‡(
r£t
 !
NULL
 && 
	`FD_ISSET
(
i
,Ñset)) {

1390 
rc
 = 
	`¢¥ötf
(&
r£tfd
[
r£tfdi
], (rsetfd) -Ñsetfdi,

1392 
i
, 
docheck
 ? (
	`fdis›í
(i) ? "" : "-invalid") : "");

1393 
r£tfdi
 +
rc
;

1396 i‡(
bu‰£t
 !
NULL
 && 
	`FD_ISSET
(
i
, bufrset)) {

1397 
rc
 = 
	`¢¥ötf
(&
bu‰£tfd
[
bu‰£tfdi
],

1398 (
bu‰£tfd
Ë- 
bu‰£tfdi
,

1400 
i
, 
docheck
 ? (
	`fdis›í
(i) ? "" : "-invalid") : "");

1401 
bu‰£tfdi
 +
rc
;

1404 i‡(
buffw£t
 !
NULL
 && 
	`FD_ISSET
(
i
, buffwset)) {

1405 
rc
 = 
	`¢¥ötf
(&
buffw£tfd
[
buffw£tfdi
],

1406 (
buffw£tfd
Ë- 
buffw£tfdi
,

1408 
i
, 
docheck
 ? (
	`fdis›í
(i) ? "" : "-invalid") : "");

1410 
buffw£tfdi
 +
rc
;

1414 i‡(
w£t
 !
NULL
 && 
	`FD_ISSET
(
i
, wset)) {

1415 
rc
 = 
	`¢¥ötf
(&
w£tfd
[
w£tfdi
], (wsetfd) - wsetfdi,

1417 
i
, 
docheck
 ? (
	`fdis›í
(i) ? "" : "-invalid") : "");

1419 
w£tfdi
 +
rc
;

1422 i‡(
x£t
 !
NULL
 && 
	`FD_ISSET
(
i
, xset)) {

1423 
rc
 = 
	`¢¥ötf
(&
x£tfd
[
x£tfdi
], (xsetfd) - xsetfdi,

1425 
i
, 
docheck
 ? (
	`fdis›í
(i) ? "" : "-invalid") : "");

1427 
x£tfdi
 +
rc
;

1431 
	`¶og
(
LOG_DEBUG
,

1439 
¥ómbÀ
, 
nfds
,

1440 
r£t
, 
r£tfd
,

1441 
bu‰£t
, 
bu‰£tfd
,

1442 
buffw£t
, 
buffw£tfd
,

1443 
w£t
, 
w£tfd
,

1444 
x£t
, 
x£tfd
,

1445 
buf
);

1447 i‡(
î∫o
 !
î∫o_s
) {

1448 
	`sw¨nx
("%s: strange ...Érrno changed from %dÅo %d",

1449 
fun˘i⁄
, 
î∫o_s
, 
î∫o
);

1451 
î∫o
 = 
î∫o_s
;

1453 
	}
}

	@lib/iobuf.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 
socks_ÊushÆlbuf„rs
();

56 #i‡!
SOCKS_CLIENT


62 
iobuf„r_t


63 
	giobufv
[
MAX
((
SOCKD_NEGOTIATEMAX
 * 1 ),

64 
MAX
((
SOCKD_IOMAX
 * 4 ),

65 (
SOCKD_REQUESTMAX
 * 3 )))];

66 c⁄° 
size_t
 
	giobufc
 = 
ELEMENTS
(
iobufv
);

69 
iobuf„r_t
 *
	giobufv
;

70 
size_t
 
	giobufc
;

73 
size_t
 
	gœ°‰ìi
;

76 
	$socks_£tbuf„r
(
iobuf
, 
mode
, 
size
)

77 
iobuf„r_t
 *
iobuf
;

78 c⁄° 
mode
;

79 
ssize_t
 
size
;

82 
iobuf
->
öfo
[
READ_BUF
].
mode
 = 
_IONBF
;

83 
iobuf
->
öfo
[
WRITE_BUF
].
mode
 = mode;

85 i‡(
size
 == -1)

86 
size
 = (*
iobuf
->
buf
);

88 
	`SASSERTX
(
size
 > 0);

89 
	`SASSERTX
(
size
 <(
ssize_t
)(*
iobuf
->
buf
));

91 
iobuf
->
öfo
[
READ_BUF
].
size
 = size;

92 
iobuf
->
öfo
[
WRITE_BUF
].
size
 = size;

93 
	}
}

96 
	$socks_£tbuf„rfd
(
s
, 
mode
, 
size
)

97 c⁄° 
s
;

98 c⁄° 
mode
;

99 
ssize_t
 
size
;

101 
iobuf„r_t
 *
iobuf
;

103 
	`SASSERTX
(
size
 <
SOCKD_BUFSIZE
);

105 i‡((
iobuf
 = 
	`socks_gëbuf„r
(
s
)Ë=
NULL
)

108 
	`socks_£tbuf„r
(
iobuf
, 
mode
, 
size
);

109 
	}
}

113 
	$socks_Êushbuf„r
(
s
, 
Àn
, 
£ndtoÊags
)

114 c⁄° 
s
;

115 c⁄° 
ssize_t
 
Àn
;

116 
£ndto_öfo_t
 *
£ndtoÊags
;

118 c⁄° *
fun˘i⁄
 = "socks_flushbuffer()";

119 #i‡
HAVE_GSSAPI
 || !
SOCKS_CLIENT


120 
öputmem
[(
iobuf„r_t
)];

121 
ssize_t
 
wrôãn
 = 0;

122 
ssize_t
 
p
;

124 #i‡!
SOCKS_CLIENT


125 
ícoded
;

128 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

129 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Üí = %ld", 
fun˘i⁄
, 
s
, ()
Àn
);

131 i‡(
£ndtoÊags
 !
NULL
)

132 
£ndtoÊags
->
tosockë
 = 0;

134 i‡(
s
 == -1)

135  
	`socks_ÊushÆlbuf„rs
();

137 i‡(!
	`socks_buf„rhasbyãs
(
s
, 
WRITE_BUF
))

140 
	`¶og
(
LOG_DEBUG
, "%s: buffer for fd %d has bytes (%lu + %lu). Flushing",

141 
fun˘i⁄
,

142 
s
,

143 ()
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 0),

144 ()
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1));

147 #i‡
SOCKS_CLIENT


148 #i‡
HAVE_GSSAPI


163 
	`SASSERTX
(
Àn
 == -1);

165 
agaö
:

166 i‡(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1) > 0) {

172 
size_t
 
towrôe
 = 
	`socks_gë‰ombuf„r
(
s
,

173 
MSG_PEEK
,

174 
WRITE_BUF
,

176 
öputmem
,

177 (
öputmem
));

179 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

180 
	`¶og
(
LOG_DEBUG
,

182 
fun˘i⁄
, ()
towrôe
,Åowrite == 1 ? "" : "s");

184 
p
 = 
	`wrôe
(
s
, 
öputmem
, 
towrôe
);

186 
	`¶og
(
LOG_DEBUG
, "%s: write of %lu bytesÑeturned %ld (%s)",

187 
fun˘i⁄
, ()
towrôe
, ()
p
, 
	`°ªº‹
(
î∫o
));

189 i‡(
p
 > 0) {

195 
wrôãn
 +
p
;

197 
	`socks_gë‰ombuf„r
(
s
, 0, 
WRITE_BUF
, 1, 
öputmem
, 
p
);

199 i‡(
£ndtoÊags
 !
NULL
)

200 
£ndtoÊags
->
tosockë
 +
p
;

202 i‡(
p
 !(
ssize_t
)
towrôe
) {

208 
î∫o
 = 
EAGAIN
;

213  
p
;

216 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1) == 0);

218 
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 0) > 0) {

226 
gss_buf„r_desc
 
öput_tokí
, 
ouçut_tokí
;

227 
socksfd_t
 
socksfd
, *
±r
;

228 
ouçutmem
[
GSSAPI_HLEN
 + 
MAXGSSAPITOKENLEN
];

229 
psh‹t
;

230 
ssize_t
 
t€ncode
;

232 
±r
 = 
	`socks_gëaddr
(
s
, &
socksfd
, 1);

233 
	`SASSERTX
(
±r
 !
NULL
);

234 
	`SASSERTX
(
socksfd
.
°©e
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
);

236 
t€ncode


237 
	`socks_gë‰ombuf„r
(
s
,

239 
WRITE_BUF
,

241 
öputmem
,

242 
	`MIN
((
öputmem
),

243 
socksfd
.
°©e
.
auth
.
md©a
.
gsßpi
.°©e.
maxgssd©a
));

245 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

246 
	`¶og
(
LOG_DEBUG
, "%s:Éncoding %ld byte%s before flushing ...",

247 
fun˘i⁄
, ()
t€ncode
,Åoencode == 1 ? "" : "s");

249 
öput_tokí
.
vÆue
 = 
öputmem
;

250 
öput_tokí
.
Àngth
 = 
t€ncode
;

252 
ouçut_tokí
.
vÆue
 = 
ouçutmem
 + 
GSSAPI_HLEN
;

253 
ouçut_tokí
.
Àngth
 = (
ouçutmem
Ë- 
GSSAPI_HLEN
;

255 i‡(
	`gsßpi_ícode
(&
öput_tokí
,

256 &
socksfd
.
°©e
.
auth
.
md©a
.
gsßpi
.state,

257 &
ouçut_tokí
) != 0) {

258 
	`sw¨nx
("%s: gsßpi_ícode(ËÁûed", 
fun˘i⁄
);

262 ((*)(
ouçut_tokí
.
vÆue
))[
GSSAPI_VERSION
] = 
SOCKS_GSSAPI_VERSION
;

263 ((*)(
ouçut_tokí
.
vÆue
))[
GSSAPI_STATUS
] = 
SOCKS_GSSAPI_PACKET
;

265 
psh‹t
 = 
	`ht⁄s
(
ouçut_tokí
.
Àngth
);

266 
	`mem˝y
(&((*)
ouçut_tokí
.
vÆue
)[
GSSAPI_TOKEN_LENGTH
],

267 &
psh‹t
,

268 (
psh‹t
));

270 
	`SASSERTX
(
GSSAPI_HLEN
 + 
ouçut_tokí
.
Àngth


271 <
	`socks_‰ìöbuf„r
(
s
, 
WRITE_BUF
));

273 
	`socks_addtobuf„r
(
s
,

274 
WRITE_BUF
,

276 
ouçut_tokí
.
vÆue
,

277 
ouçut_tokí
.
Àngth
 + 
GSSAPI_HLEN
);

280 i‡(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1) > 0)

281 
agaö
;

287 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 0) == 0);

288 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1) == 0);

305 i‡(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 0) > 0) {

306 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1) == 0);

307 
ícoded
 = 0;

309 i‡(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1) > 0) {

310 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 0) == 0);

311 
ícoded
 = 1;

314 
	`SERRX
(0);

326 
ssize_t
 
rc
;

327 
size_t
 
towrôe
;

329 
towrôe
 = 
	`socks_gë‰ombuf„r
(
s
,

330 
MSG_PEEK
,

331 
WRITE_BUF
,

332 
ícoded
,

333 
öputmem
,

334 
Àn
 =-1 ? (
öputmem
Ë: (
size_t
)len);

336 
rc
 = 
	`wrôe
(
s
, 
öputmem
, 
towrôe
);

338 
	`¶og
(
LOG_DEBUG
, "%s: wrote %ld/%ld %s bytes (%s)",

339 
fun˘i⁄
,

340 ()
rc
,

341 ()
towrôe
,

342 
ícoded
 ? "encoded" : "unencoded",

343 
	`°ªº‹
(
î∫o
));

345 i‡(
rc
 > 0) {

349 
p
 = 
	`socks_gë‰ombuf„r
(
s
, 0, 
WRITE_BUF
, 
ícoded
, 
öputmem
, 
rc
);

350 
	`SASSERTX
(
p
 =
rc
);

352 i‡(
£ndtoÊags
 !
NULL
)

353 
£ndtoÊags
->
tosockë
 +
rc
;

358 
wrôãn
 +
rc
;

359 } (
Àn
 =-1 || 
wrôãn
 <Üen)

360 && 
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 
ícoded
) > 0);

362 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 0) == 0);

363 
	`SASSERTX
(
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1) == 0);

365  
wrôãn
;

367 
	}
}

369 
iobuf„r_t
 *

370 
	$socks_gëbuf„r
(
s
)

371 c⁄° 
s
;

374 
size_t
 
i
;

376 i‡(
i
 < 
iobufc
 && 
iobufv
[i].
s
 =†&& iobufv[i].
Æloˇãd
)

377  &
iobufv
[
i
];

379 
i
 = 0; i < 
iobufc
; ++i)

380 i‡(
iobufv
[
i
].
s
 =†&& iobufv[i].
Æloˇãd
)

381  &
iobufv
[
i
];

383  
NULL
;

384 
	}
}

387 
	$socks_˛órbuf„r
(
s
, 
which
)

388 c⁄° 
s
;

389 c⁄° 
whichbuf_t
 
which
;

391 
iobuf„r_t
 *
iobuf
;

393 i‡((
iobuf
 = 
	`socks_gëbuf„r
(
s
)Ë=
NULL
)

396 
iobuf
->
öfo
[
which
].
Àn
 = iobuf->öfo[which].
í˛í
 = 0;

397 #i‡
SOCKS_CLIENT


398 
iobuf
->
öfo
[
which
].
ªadÆªady
 = 0;

401 
	`bzîo
(&
iobuf
->
buf
[
which
], (iobuf->buf[which]));

402 
	}
}

404 
iobuf„r_t
 *

405 
	$socks_Ælocbuf„r
(
s
, 
°y≥
)

406 c⁄° 
s
;

407 c⁄° 
°y≥
;

409 c⁄° *
fun˘i⁄
 = "socks_allocbuffer()";

411 #i‡
SOCKS_CLIENT


412 
sig£t_t
 
o£t
;

414 
iobuf„r_t
 *
‰ìbuf„r
;

415 
size_t
 
i
;

417 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, sty≥ = %d", 
fun˘i⁄
, 
s
, 
°y≥
);

419 
	`SASSERTX
(
	`socks_gëbuf„r
(
s
Ë=
NULL
);

424 i‡(
œ°‰ìi
 < 
iobufc
 && !
iobufv
[œ°‰ìi].
Æloˇãd
)

425 
‰ìbuf„r
 = &
iobufv
[
œ°‰ìi
];

427 
i
 = 0, 
‰ìbuf„r
 = 
NULL
; i < 
iobufc
; ++i)

428 i‡(!
iobufv
[
i
].
Æloˇãd
) {

429 
‰ìbuf„r
 = &
iobufv
[
i
];

434 #i‡
SOCKS_CLIENT


441 
	`socks_sigblock
(
SIGIO
, &
o£t
);

443 i‡(
‰ìbuf„r
 =
NULL
) {

444 *
p
;

446 i‡((
p
 = 
	`ªÆloc
(
iobufv
, (*iobufvË* (
iobufc
 + 1))Ë=
NULL
) {

447 
	`sw¨n
("%s: %s", 
fun˘i⁄
, 
NOMEM
);

448 
	`socks_sigunblock
(&
o£t
);

450  
NULL
;

453 
iobufv
 = 
p
;

454 
iobufc
 += 1;

456 
‰ìbuf„r
 = &
iobufv
[
iobufc
 - 1];

460 
	`SASSERTX
(
‰ìbuf„r
 !
NULL
);

461 
	`socks_öôbuf„r
(
s
, 
°y≥
, 
‰ìbuf„r
);

463 #i‡
SOCKS_CLIENT


464 
	`socks_sigunblock
(&
o£t
);

467  
‰ìbuf„r
;

468 
	}
}

471 
	$socks_öôbuf„r
(
fd
, 
°y≥
, 
iobuf
)

472 c⁄° 
fd
;

473 c⁄° 
°y≥
;

474 
iobuf„r_t
 *
iobuf
;

477 
	`bzîo
(
iobuf
, (*iobuf));

478 
iobuf
->
s
 = 
fd
;

479 
iobuf
->
°y≥
 = stype;

480 
iobuf
->
Æloˇãd
 = 1;

482 
	`socks_£tbuf„r
(
iobuf
, 
_IONBF
, -1);

483 
	}
}

487 
	$socks_ªÆlocbuf„r
(
ﬁd
, 
√w
)

488 c⁄° 
ﬁd
;

489 c⁄° 
√w
;

491 c⁄° *
fun˘i⁄
 = "socks_reallocbuffer()";

492 
iobuf„r_t
 *
iobuf
 = 
	`socks_gëbuf„r
(
ﬁd
);

494 
	`¶og
(
LOG_DEBUG
, "%s: old %d,Çew %d, %s",

495 
fun˘i⁄
, 
ﬁd
, 
√w
, 
iobuf
 =
NULL
 ? "no iobuf" : "have iobuf");

497 i‡(
iobuf
 !
NULL
)

498 
iobuf
->
s
 = 
√w
;

499 
	}
}

502 
	$socks_‰ìbuf„r
(
s
)

503 c⁄° 
s
;

505 c⁄° *
fun˘i⁄
 = "socks_freebuffer()";

507 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
s
);

509 i‡(
œ°‰ìi
 < 
iobufc


510 && 
iobufv
[
œ°‰ìi
].
s
 =†&& iobufv[œ°‰ìi].
Æloˇãd
)

513 
œ°‰ìi
 = 0;

515 ; 
œ°‰ìi
 < 
iobufc
; ++lastfreei) {

516 i‡(!
iobufv
[
œ°‰ìi
].
Æloˇãd


517 || 
iobufv
[
œ°‰ìi
].
s
 != s)

520 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE


521 && ( 
	`socks_buf„rhasbyãs
(
s
, 
READ_BUF
)

522 || 
	`socks_buf„rhasbyãs
(
s
, 
WRITE_BUF
)))

523 
	`¶og
(
LOG_DEBUG
, "%s: freeing buffer with data (%lu/%lu, %lu/%lu)",

524 
fun˘i⁄
,

525 ()
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 0),

526 ()
	`socks_byãsöbuf„r
(
s
, 
READ_BUF
, 1),

527 ()
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 0),

528 ()
	`socks_byãsöbuf„r
(
s
, 
WRITE_BUF
, 1));

530 
iobufv
[
œ°‰ìi
].
Æloˇãd
 = 0;

533 
	}
}

535 
size_t


536 
	$socks_addtobuf„r
(
s
, 
which
, 
ícoded
, 
d©a
, 
d©Æí
)

537 c⁄° 
s
;

538 c⁄° 
whichbuf_t
 
which
;

539 c⁄° 
ícoded
;

540 c⁄° *
d©a
;

541 c⁄° 
size_t
 
d©Æí
;

543 c⁄° *
fun˘i⁄
 = "socks_addtobuffer()";

544 
iobuf„r_t
 *
iobuf
;

545 
size_t
 
tﬂdd
, 
off£t
;

547 i‡(
d©Æí
 == 0)

550 
iobuf
 = 
	`socks_gëbuf„r
(
s
);

551 
	`SASSERTX
(
iobuf
 !
NULL
);

553 i‡(
iobuf
->
°y≥
 =
SOCK_DGRAM
) {

554 
	`SASSERTX
(
	`socks_buf„rhasbyãs
(
s
, 
READ_BUF
) == 0);

555 
	`SASSERTX
(
	`socks_buf„rhasbyãs
(
s
, 
WRITE_BUF
) == 0);

557 
	`SERRX
(0);

560 
tﬂdd
 = 
	`MIN
(
	`socks_‰ìöbuf„r
(
s
, 
which
), 
d©Æí
);

562 
	`SASSERTX
(
tﬂdd
 =
d©Æí
);

564 i‡(
ícoded
) {

568 
off£t
 = 
	`socks_byãsöbuf„r
(
s
, 
which
, 0)

569 + 
	`socks_byãsöbuf„r
(
s
, 
which
, 1);

581 
	`memmove
(&
iobuf
->
buf
[
which
][
	`socks_byãsöbuf„r
(
s
, which, 0Ë+ 
tﬂdd
],

582 &
iobuf
->
buf
[
which
][
	`socks_byãsöbuf„r
(
s
, which, 0)],

583 
	`socks_byãsöbuf„r
(
s
, 
which
, 1));

585 
off£t
 = 
	`socks_byãsöbuf„r
(
s
, 
which
, 0);

588 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
 && 
tﬂdd
 >= 2) {

589 
ssize_t
 
p
;

591 
p
 = (
ssize_t
)
off£t
 - 1;

593 
	`¶og
(
LOG_DEBUG
,

597 
fun˘i⁄
,

598 
s
,

599 ()
d©Æí
,

600 
ícoded
 ? "encoded" : "unencoded",

601 
d©Æí
 == 1 ? "" : "s",

602 
which
 =
READ_BUF
 ? "read" : "write",

603 ()
	`socks_byãsöbuf„r
(
s
, 
which
, 0),

604 ()
	`socks_byãsöbuf„r
(
s
, 
which
, 1),

605 ()((c⁄° *)
d©a
)[
d©Æí
 - 2],

606 ()((c⁄° *)
d©a
)[
d©Æí
 - 1],

607 
p
 > 0 ? ()((c⁄° *)
iobuf
->
buf
[
which
])[p] : 0,

608 ()
p
);

611 
	`mem˝y
(&
iobuf
->
buf
[
which
][
off£t
], 
d©a
, 
tﬂdd
);

613 i‡(
ícoded
)

614 
iobuf
->
öfo
[
which
].
í˛í
 +
tﬂdd
;

616 
iobuf
->
öfo
[
which
].
Àn
 +
tﬂdd
;

618  
tﬂdd
;

619 
	}
}

621 
size_t


622 
	$socks_byãsöbuf„r
(
s
, 
which
, 
ícoded
)

623 c⁄° 
s
;

624 c⁄° 
whichbuf_t
 
which
;

625 c⁄° 
ícoded
;

627 c⁄° 
iobuf„r_t
 *
iobuf
 = 
	`socks_gëbuf„r
(
s
);

628 
size_t
 
rc
;

630 i‡(
iobuf
 =
NULL
)

633 i‡(
ícoded
)

634 
rc
 = 
iobuf
->
öfo
[
which
].
í˛í
;

636 
rc
 = 
iobuf
->
öfo
[
which
].
Àn
;

638 
	`SASSERTX
(
rc
 <(
iobuf
->
buf
[
which
]));

639  
rc
;

640 
	}
}

642 
size_t


643 
	$socks_buf„rsize
(
s
, 
which
)

644 c⁄° 
s
;

645 c⁄° 
whichbuf_t
 
which
;

647 c⁄° 
iobuf„r_t
 *
iobuf
 = 
	`socks_gëbuf„r
(
s
);

649 i‡(
iobuf
 =
NULL
)

652  
iobuf
->
öfo
[
which
].
size
;

653 
	}
}

657 
	$socks_buf„rhasbyãs
(
s
, 
which
)

658 c⁄° 
s
;

659 c⁄° 
whichbuf_t
 
which
;

661 c⁄° 
iobuf„r_t
 *
iobuf
 = 
	`socks_gëbuf„r
(
s
);

663 i‡(
iobuf
 =
NULL
)

666  
iobuf
->
öfo
[
which
].
í˛í
 || iobuf->öfo[which].
Àn
;

667 
	}
}

670 
size_t


671 
	$socks_‰ìöbuf„r
(
s
, 
which
)

672 c⁄° 
s
;

673 c⁄° 
whichbuf_t
 
which
;

675 c⁄° *
fun˘i⁄
 = "socks_freeinbuffer()";

676 
iobuf„r_t
 *
iobuf
;

677 
size_t
 
rc
;

679 i‡((
iobuf
 = 
	`socks_gëbuf„r
(
s
)Ë=
NULL
)

682 
rc
 = 
iobuf
->
öfo
[
which
].
size


683 - (
	`socks_byãsöbuf„r
(
s
, 
which
, 0) + socks_bytesinbuffer(s, which, 1));

685 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

686 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, which %d, free: %lu",

687 
fun˘i⁄
, 
s
, 
which
, ()
rc
);

689 
	`SASSERTX
(
rc
 <(
iobuf
->
buf
[
which
]));

691  
rc
;

692 
	}
}

694 
size_t


695 
	$socks_gë‰ombuf„r
(
s
, 
Êags
, 
which
, 
ícoded
, 
d©a
, 
d©Æí
)

696 c⁄° 
s
;

697 c⁄° 
size_t
 
Êags
;

698 c⁄° 
whichbuf_t
 
which
;

699 c⁄° 
ícoded
;

700 *
d©a
;

701 c⁄° 
size_t
 
d©Æí
;

703 c⁄° *
fun˘i⁄
 = "socks_getfrombuffer()";

704 
iobuf„r_t
 *
iobuf
;

705 
size_t
 
togë
;

707 i‡((
iobuf
 = 
	`socks_gëbuf„r
(
s
)Ë=
NULL
)

710 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

711 
	`¶og
(
LOG_DEBUG
,

714 
fun˘i⁄
,

715 
s
,

716 ()
d©Æí
,

717 
ícoded
 ? "encoded" : "decoded",

718 
d©Æí
 == 1 ? "" : "s",

719 
which
 =
READ_BUF
 ? "read" : "write",

720 ()
	`socks_byãsöbuf„r
(
s
, 
which
, 0),

721 ()
	`socks_byãsöbuf„r
(
s
, 
which
, 1),

722 ()
Êags
);

724 i‡((
togë
 = 
	`MIN
(
d©Æí
, 
	`socks_byãsöbuf„r
(
s
, 
which
, 
ícoded
))) == 0)

727 i‡(
ícoded
) {

728 
	`SASSERTX
(
iobuf
->
öfo
[
which
].
í˛í
 >
togë
);

731 
	`mem˝y
(
d©a
, &
iobuf
->
buf
[
which
][iobuf->
öfo
[which].
Àn
], 
togë
);

733 i‡(!(
Êags
 & 
MSG_PEEK
)) {

734 
iobuf
->
öfo
[
which
].
í˛í
 -
togë
;

739 
	`memmove
(&
iobuf
->
buf
[
which
][iobuf->
öfo
[which].
Àn
],

740 &
iobuf
->
buf
[
which
][iobuf->
öfo
[which].
Àn
 + 
togë
],

741 
iobuf
->
öfo
[
which
].
í˛í
);

745 
	`SASSERTX
(
iobuf
->
öfo
[
which
].
Àn
 >
togë
);

747 
	`mem˝y
(
d©a
, 
iobuf
->
buf
[
which
], 
togë
);

749 i‡(!(
Êags
 & 
MSG_PEEK
)) {

750 
iobuf
->
öfo
[
which
].
Àn
 -
togë
;

753 
	`memmove
(
iobuf
->
buf
[
which
],

754 &
iobuf
->
buf
[
which
][
togë
],

755 
iobuf
->
öfo
[
which
].
Àn
 + iobuf->öfo[which].
í˛í
);

759  
togë
;

760 
	}
}

763 
	$socks_ÊushÆlbuf„rs
()

766 
size_t
 
i
;

767 
rc
;

769 
i
 = 0, 
rc
 = 0; i < 
iobufc
; ++i)

770 i‡(
iobufv
[
i
].
Æloˇãd
)

771 i‡(
	`socks_Êushbuf„r
(
iobufv
[
i
].
s
, -1, 
NULL
) == -1)

772 
rc
 = -1;

774  
rc
;

775 
	}
}

	@lib/ipv6.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

50 
	$socks_öë_±⁄
(
af
, 
§c
, 
d°
, 
d°sc›e
)

51 c⁄° 
af
;

52 c⁄° *
§c
;

53 *
d°
;

54 
uöt32_t
 *
d°sc›e
;

56 c⁄° *
fun˘i⁄
 = "socks_inet_pton()";

57 
dnsöfo_t
 
ªsmem
;

58 
addröfo
 *
ªs
, 
höts
;

59 
visbuf
[1024];

60 
rc
;

62 i‡(
	`°rchr
(
§c
, '%'Ë=
NULL
)

63  
	`öë_±⁄
(
af
, 
§c
, 
d°
);

65 
	`bzîo
(&
höts
, (hints));

66 
höts
.
ai_Êags
 = 
AI_NUMERICHOST
;

67 
höts
.
ai_Ámûy
 = 
af
;

69 i‡((
rc
 = 
	`cgëaddröfo
(
§c
, 
NULL
, &
höts
, &
ªs
, &
ªsmem
)) == 0) {

70 
	`SASSERTX
(
ªs
->
ai_addr
 !
NULL
);

72 
	`mem˝y
(
d°
, 
	`GET_SOCKADDRADDR
(
	`TOSS
(
ªs
->
ai_addr
)),Ñes->
ai_addæí
);

74 
af
) {

75 
AF_INET
:

78 
AF_INET6
:

79 i‡(
d°sc›e
 !
NULL
)

80 *
d°sc›e
 = 
	`TOIN6
(
ªs
->
ai_addr
)->
sö6_sc›e_id
;

85 
	`SERRX
(
af
);

91 
	`¶og
(
LOG_DEBUG
, "%s: getaddrinfo(3) on %s failed: %s",

92 
fun˘i⁄
,

93 
	`°r2vis
(
§c
, 
	`°æí
(§c), 
visbuf
, (visbuf)),

94 
	`gai_°ªº‹
(
rc
));

96 i‡(
rc
 =
EAI_FAMILY
) {

97 
î∫o
 = 
EAFNOSUPPORT
;

102 
	}
}

105 
	$£t_höts_ai_Ámûy
(
ai_Ámûy
)

106 *
ai_Ámûy
;

108 #i‡!
SOCKS_CLIENT


109 c⁄° *
fun˘i⁄
 = "set_hints_ai_family";

111 i‡(
	`exã∫Æ_has_⁄ly_ßÁmûy
(
AF_INET
))

112 *
ai_Ámûy
 = 
AF_INET
;

113 i‡(
	`exã∫Æ_has_⁄ly_ßÁmûy
(
AF_INET6
)

114 && 
	`exã∫Æ_has_globÆ_ßÁmûy
(
AF_INET6
))

115 *
ai_Ámûy
 = 
AF_INET6
;

121 *
ai_Ámûy
 = 0;

123 
	`¶og
(
LOG_DEBUG
, "%s:ái_Ámûy = %d", 
fun˘i⁄
, *
ai_Ámûy
);

125 
	}
}

127 #i‡!
SOCKS_CLIENT


128 
ö_addr
 *

129 
	$ùv4_m≠≥d_to_ªguœr
(
ùv4_m≠≥d
, 
ùv4_ªguœr
)

130 c⁄° 
ö6_addr
 *
ùv4_m≠≥d
;

131 
ö_addr
 *
ùv4_ªguœr
;

133 c⁄° *
fun˘i⁄
 = "ipv4_mapped_to_regular";

135 
	`mem˝y
(
ùv4_ªguœr
,

136 &
ùv4_m≠≥d
->
s6_addr
[(*ùv4_m≠≥dË- (*
ùv4_ªguœr
)],

137 (*
ùv4_ªguœr
));

139 i‡(
sockscf
.
›ti⁄
.
debug
) {

140 
m≠≥d
[
	`MAX
(
INET6_ADDRSTRLEN
, 32)], 
ªguœr
[MAX(
INET_ADDRSTRLEN
, 32)];

142 i‡(
	`öë_¡›
(
AF_INET6
, 
ùv4_m≠≥d
, 
m≠≥d
, (m≠≥d)Ë=
NULL
)

143 
	`STRCPY_ASSERTSIZE
(
m≠≥d
, "<nonsenseáddress>");

145 i‡(
	`öë_¡›
(
AF_INET
, 
ùv4_ªguœr
, 
ªguœr
, ‘eguœr)Ë=
NULL
)

146 
	`STRCPY_ASSERTSIZE
(
m≠≥d
, "<nonsenseáddress>");

148 
	`¶og
(
LOG_DEBUG
, "c⁄vîãd from %†tÿ%s", 
m≠≥d
, 
ªguœr
);

151  
ùv4_ªguœr
;

152 
	}
}

157 #unde‡
gai_°ªº‹


159 
	$socks_gai_°ªº‹
(
îrcode
)

160 
îrcode
;

162 
emsg
[1024];

164 #i‡!
SOCKS_CLIENT


165 
ißÊimô
 = 0, 
haßf
 = 0;

167 
îrcode
) {

168 
EAI_FAMILY
:

169 
EAI_FAIL
:

170 
EAI_NONAME
:

171 #ifde‡
EAI_NODATA


172 
EAI_NODATA
:

174 i‡(
	`exã∫Æ_has_⁄ly_ßÁmûy
(
AF_INET
)) {

175 
ißÊimô
 = 1;

176 
haßf
 = 
AF_INET
;

178 i‡(
	`exã∫Æ_has_⁄ly_ßÁmûy
(
AF_INET6
)) {

179 
ißÊimô
 = 1;

180 
haßf
 = 
AF_INET6
;

188 
	`¢¥ötf
(
emsg
, (emsg), "%s%s%s",

189 
	`gai_°ªº‹
(
îrcode
),

190 
ißÊimô
 ? " for " : "",

191 
ißÊimô
 ? 
	`ßÁmûy2°rög
(
haßf
) : "");

195 
	`¢¥ötf
(
emsg
, ”msg), "%s", 
	`gai_°ªº‹
(
îrcode
));

200  
emsg
;

201 
	}
}

	@lib/log.c

45 c⁄° 
	grcsid
[] =

48 
	~"comm⁄.h
"

49 
	~"c⁄fig_∑r£.h
"

51 #i‡
HAVE_EXECINFO_H
 && 
HAVE_BACKTRACE


52 
	~<execöfo.h
>

55 #i‡
DEBUG
 && 
PRERELEASE


56 #unde‡
SOCKS_IGNORE_SIGNALSAFETY


57 
	#SOCKS_IGNORE_SIGNALSAFETY
 1

	)

60 #i‡
SOCKS_CLIENT


61 
	#SRCDSTLEN
 (1024)

	)

63 
	#SRCDSTLEN
 (
MAX_IOLOGADDR
 + (" -> "Ë+ MAX_IOLOGADDR)

	)

66 
	#DATALEN
 (2048Ë

	)

67 
	#REGULARBUFLEN
 ( 
SRCDSTLEN
 \

68 + (
DATALEN
 * 4) \

69 + 1024 )

	)

71 
	ssy¶ogÁcûôy
 {

72 c⁄° 
	m«me
[
MAXFACILITYNAMELEN
];

73 c⁄° 
	mvÆue
;

82 
	#ADDNL
(
bufu£d
, 
buf
, 
buÊí
) \

84 
	`SASSERTX
((
buf
)[(*
bufu£d
Ë- 1] =
NUL
); \

85 i‡((
buf
)[(*
bufu£d
) - 2] != '\n') { \

86 i‡((*
bufu£d
Ë+ 1 <(
buÊí
)) { \

87 
buf
[(*
bufu£d
) - 1] = '\n'; \

88 
buf
[(*
bufu£d
)++] = 
NUL
; \

91 
buf
[(*
bufu£d
) - 2] = '\n'; \

93 
	`SASSERTX
((
buf
)[(*
bufu£d
Ë- 1] =
NUL
); \

94 } 0 )

	)

96 c⁄° 
sy¶ogÁcûôy
 *

97 
sy¶ogÁcûôy
(c⁄° *
«me
);

105 
dﬁog
(c⁄° 
¥i‹ôy
, c⁄° *
buf
,

106 c⁄° 
size_t
 
log¥efixÀn
, c⁄° size_à
mesßgñí
);

120 
›ílogfûe
(c⁄° *
logfûe
, *
we¸óãd
);

132 
size_t


133 
gëlog¥efix
(c⁄° 
¥i‹ôy
, *
buf
, 
size_t
 
buÊí
);

144 #i‡
HAVE_LIVEDEBUG


152 
	#SOCKS_RINGBUF_MAXLINELEN
 (1024)

	)

154 #i‚de‡
SOCKS_RINGBUFLEN


155 
	#SOCKS_RINGBUFLEN
 (
SOCKS_RINGBUF_MAXLINELEN
 * 100)

	)

159 
	gd⁄t_add_to_rb
;

161 
socks_addt‹b
(c⁄° *
°r
, c⁄° 
size_t
 
°æí
);

167 #i‡
SOCKS_CLIENT


168 
©exô_Êushrb
();

171 
	grögbuf„r
[
SOCKS_RINGBUFLEN
];

172 
size_t
 
	grögbuf_cuºoff
;

175 #i‡!
SOCKS_CLIENT


177 
	#DO_BUILD
(
§cd°_°r
, 
d°_too
) \

179 
§c°r
[
MAX_IOLOGADDR
]; \

181 
	`buûd_addr°r_§c
(
	`GET_HOSTIDV
(
§c
), \

182 
	`GET_HOSTIDC
(
§c
), \

183 
§c
 !
NULL
 && src->
≥î_is£t
 ? \

184 &
§c
->
≥î
 : 
NULL
, \

185 
to§c_¥oxy
 !
NULL
 &&Åo§c_¥oxy->
≥î_is£t
 ? \

186 &
to§c_¥oxy
->
≥î
 : 
NULL
, \

187 
to§c_¥oxy
 !
NULL
 &&Åo§c_¥oxy->
loˇl_is£t
 ? \

188 &
to§c_¥oxy
->
loˇl
 : 
NULL
, \

189 
§c
 !
NULL
 && src->
loˇl_is£t
 ? \

190 &
§c
->
loˇl
 : 
NULL
, \

191 
§c
 !
NULL
 && src->
auth_is£t
 ? \

192 &
§c
->
auth
 : 
NULL
, \

193 
to§c_¥oxy
 !
NULL
 &&Åo§c_¥oxy->
auth_is£t
 ? \

194 &
to§c_¥oxy
->
auth
 : 
NULL
, \

195 (
d°_too
Ë? 
§c°r
 : 
§cd°_°r
, \

196 (
d°_too
Ë? (
§c°r
Ë: (
§cd°_°r
)); \

198 i‡(
d°_too
) { \

199 
d°°r
[
MAX_IOLOGADDR
]; \

201 
	`buûd_addr°r_d°
(
d°
 !
NULL
 && d°->
loˇl_is£t
 ? \

202 &
d°
->
loˇl
 : 
NULL
, \

203 
tod°_¥oxy
 !
NULL
 &&Åod°_¥oxy->
loˇl_is£t
 ? \

204 &
tod°_¥oxy
->
loˇl
 : 
NULL
, \

205 
tod°_¥oxy
 !
NULL
 &&Åod°_¥oxy->
≥î_is£t
 ? \

206 &
tod°_¥oxy
->
≥î
 : 
NULL
, \

207 
d°
 !
NULL
 && d°->
≥î_is£t
 ? \

208 &
d°
->
≥î
 : 
NULL
, \

209 
d°
 !
NULL
 && d°->
auth_is£t
 ? \

210 &
d°
->
auth
 : 
NULL
, \

211 
tod°_¥oxy
 !
NULL
 &&Åod°_¥oxy->
auth_is£t
 ? \

212 &
tod°_¥oxy
->
auth
 : 
NULL
, \

213 
	`GET_HOSTIDV
(
d°
), \

214 
	`GET_HOSTIDC
(
d°
), \

215 
d°°r
, \

216 (
d°°r
)); \

218 
	`¢¥ötf
(
§cd°_°r
, (§cd°_°r), "%†-> %s", 
§c°r
, 
d°°r
); \

220 }  0)

	)

223 
iﬁogaddr_t
 *

224 
	$öô_iﬁogaddr
(
addr
, 
loˇl_ty≥
, 
loˇl
, 
≥î_ty≥
, 
≥î
, 
auth
, 
ho°idv
, 
ho°idc
)

225 
iﬁogaddr_t
 *
addr
;

226 c⁄° 
obje˘ty≥_t
 
loˇl_ty≥
;

227 c⁄° *
loˇl
;

228 c⁄° 
obje˘ty≥_t
 
≥î_ty≥
;

229 c⁄° *
≥î
;

230 c⁄° 
authmëhod_t
 *
auth
;

231 c⁄° 
ö_addr
 *
ho°idv
;

232 c⁄° 
ho°idc
;

235 i‡(
loˇl
 =
NULL
 || 
loˇl_ty≥
 =
obje˘_n⁄e
)

236 
addr
->
loˇl_is£t
 = 0;

238 
loˇl_ty≥
) {

239 
obje˘_sockaddr
:

240 
	`sockaddr2socksho°
(
loˇl
, &
addr
->local);

243 
obje˘_socksho°
:

244 
addr
->
loˇl
 = *(c⁄° 
socksho°_t
 *)local;

248 
	`SERRX
(
loˇl_ty≥
);

251 
addr
->
loˇl_is£t
 = 1;

254 i‡(
≥î
 =
NULL
 || 
≥î_ty≥
 =
obje˘_n⁄e
)

255 
addr
->
≥î_is£t
 = 0;

257 
≥î_ty≥
) {

258 
obje˘_sockaddr
:

259 
	`sockaddr2socksho°
(
≥î
, &
addr
->peer);

262 
obje˘_socksho°
:

263 
addr
->
≥î
 = *(c⁄° 
socksho°_t
 *)peer;

267 
	`SERRX
(
≥î_ty≥
);

270 
addr
->
≥î_is£t
 = 1;

273 i‡(
auth
 =
NULL
)

274 
addr
->
auth_is£t
 = 0;

276 
addr
->
auth
 = *auth;

277 
addr
->
auth_is£t
 = 1;

280 #i‡
HAVE_SOCKS_HOSTID


281 i‡(
ho°idv
 =
NULL
 || 
ho°idc
 == 0)

282 
addr
->
ho°idc
 = 0;

284 
	`mem˝y
(
addr
->
ho°idv
, ho°idv, (*ho°idvË* 
ho°idc
);

285 
addr
->
ho°idc
 = hostidc;

289  
addr
;

290 
	}
}

293 
	$iﬁog
(
ruÀ
, 
°©e
, 
›
, 
§c
, 
d°
, 
to§c_¥oxy
, 
tod°_¥oxy
, 
d©a
, 
d©Æí
)

294 c⁄° 
ruÀ_t
 *
ruÀ
;

295 c⁄° 
c⁄√˘i⁄°©e_t
 *
°©e
;

296 c⁄° 
›î©i⁄_t
 
›
;

297 c⁄° 
iﬁogaddr_t
 *
§c
;

298 c⁄° 
iﬁogaddr_t
 *
d°
;

299 c⁄° 
iﬁogaddr_t
 *
to§c_¥oxy
;

300 c⁄° 
iﬁogaddr_t
 *
tod°_¥oxy
;

301 c⁄° *
d©a
;

302 
size_t
 
d©Æí
;

304 c⁄° *
fun˘i⁄
 = "iolog()";

305 c⁄° *
t˝öf›ªfix
 = "\nTCP_INFO:\n";

306 c⁄° *
vîdi˘
;

307 c⁄° 
dﬁogt˝öfo
 = (
ruÀ
->
log
.
t˝öfo
 && 
°©e
->t˝öfÿ!
NULL
) ?

309 c⁄° 
dﬁogd°öfo
 = (
d°
 =
NULL
) ? 0 : 1;

310 
size_t
 
buÊí
;

311 
§cd°_°r
[
SRCDSTLEN
], 
ruÀcomm™d
[256],

312 *
buf
, *
bigbuf
, 
ªgbuf
[
REGULARBUFLEN
];

314 i‡(
ruÀ
->
log
.
d©a
 && 
d©Æí
 > 
DATALEN
) {

315 c⁄° 
size_t
 
bigbufsize
 = (size_t)
d©Æí
 * 4

316 + (
ªgbuf
);

318 
	`¶og
(
LOG_DEBUG
,

321 
fun˘i⁄
, ()
d©Æí
, ()
bigbufsize
);

323 i‡((
bigbuf
 = 
	`mÆloc
(
bigbufsize
)Ë!
NULL
) {

324 
buf
 = 
bigbuf
;

325 
buÊí
 = 
bigbufsize
;

328 
	`sw¨n
("%s: failedÅoállocate %lu bytes of memory",

329 
fun˘i⁄
, ()
bigbufsize
);

331 
buf
 = 
ªgbuf
;

332 
buÊí
 = (
ªgbuf
);

336 
buÊí
 = (
ªgbuf
);

337 
buf
 = 
ªgbuf
;

338 
bigbuf
 = 
NULL
;

347 
	#DATASEPARATOR
(
d©a
) \

348 (((
d©a
Ë=
NULL
 || *(d©aË=
NUL
 || *(d©aË='\n'Ë? "" : ": ")

	)

350 
	#DATASTRING
(
d©a
) \

351 (((
d©a
Ë=
NULL
 || *(d©aË=
NUL
Ë? "" : d©a)

	)

353 
vîdi˘
 = 
NULL
;

354 
›
) {

355 
OPERATION_ACCEPT
:

356 
OPERATION_HOSTID
:

357 
OPERATION_CONNECT
:

358 i‡(
ruÀ
->
log
.
c⁄√˘
) {

359 
	`DO_BUILD
(
§cd°_°r
, 
dﬁogd°öfo
);

360 
	`¢¥ötf
(
buf
, 
buÊí
,

362 
§cd°_°r
,

363 
	`DATASEPARATOR
(
d©a
),

364 
	`DATASTRING
(
d©a
));

367 
	`‰ì
(
bigbuf
);

373 
OPERATION_BLOCK
:

374 
OPERATION_TMPBLOCK
:

375 i‡(
ruÀ
->
log
.
c⁄√˘
 ||ÑuÀ->log.
disc⁄√˘


376 || 
ruÀ
->
log
.
d©a
 ||ÑuÀ->log.
io›î©i⁄
) {

377 
	`DO_BUILD
(
§cd°_°r
, 
dﬁogd°öfo
);

378 
	`¢¥ötf
(
buf
, 
buÊí
,

380 
›
 =
OPERATION_BLOCK
 ? ']' : '-',

381 
§cd°_°r
,

382 
	`DATASEPARATOR
(
d©a
),

383 
	`DATASTRING
(
d©a
));

386 
	`‰ì
(
bigbuf
);

390 
vîdi˘
 = 
	`vîdi˘2°rög
(
VERDICT_BLOCK
);

393 
OPERATION_DISCONNECT
:

394 i‡(
ruÀ
->
log
.
disc⁄√˘
) {

395 
	`DO_BUILD
(
§cd°_°r
, 
dﬁogd°öfo
);

396 
	`¢¥ötf
(
buf
, 
buÊí
,

398 
§cd°_°r
,

399 
	`DATASEPARATOR
(
d©a
),

400 
	`DATASTRING
(
d©a
));

403 
	`‰ì
(
bigbuf
);

409 
OPERATION_ERROR
:

410 
OPERATION_TMPERROR
:

411 i‡(
ruÀ
->
log
.
îr‹
 ||ÑuÀ->log.
disc⁄√˘
) {

412 
	`DO_BUILD
(
§cd°_°r
, 
dﬁogd°öfo
);

413 
	`¢¥ötf
(
buf
, 
buÊí
,

415 
›
 =
OPERATION_ERROR
 ? ']' : '-',

416 
§cd°_°r
,

417 
	`DATASEPARATOR
((
d©a
 =
NULL
 || *d©®=
NUL
) ?

418 
	`°ªº‹
(
î∫o
Ë: 
d©a
),

419 (
d©a
 =
NULL
 || *d©®=
NUL
Ë? 
	`°ªº‹
(
î∫o
) : data);

422 
	`‰ì
(
bigbuf
);

426 
vîdi˘
 = 
	`vîdi˘2°rög
(
VERDICT_BLOCK
);

429 
OPERATION_IO
:

430 i‡(
ruÀ
->
log
.
d©a
 ||ÑuÀ->log.
io›î©i⁄
) {

431 i‡(
ruÀ
->
log
.
d©a
 && 
d©Æí
 != 0) {

432 
size_t
 
œ°byãu£d
;

434 
	`DO_BUILD
(
§cd°_°r
, 
dﬁogd°öfo
);

435 
œ°byãu£d
 = 
	`¢¥ötf
(
buf
, 
buÊí
,

437 
§cd°_°r
, ()
d©Æí
);

438 
	`°r2vis
(
d©a
,

439 
d©Æí
,

440 &
buf
[
œ°byãu£d
],

441 
buÊí
 - 
œ°byãu£d
);

444 
	`DO_BUILD
(
§cd°_°r
, 
dﬁogd°öfo
);

445 
	`¢¥ötf
(
buf
, 
buÊí
,

446 "-: %†(%lu)", 
§cd°_°r
, ()
d©Æí
);

450 
	`‰ì
(
bigbuf
);

457 
	`SERRX
(
›
);

460 
	`¢¥ötf
(
ruÀcomm™d
, (rulecommand), "%s(%lu): %s/%s",

461 
vîdi˘
 =
NULL
 ? 
	`vîdi˘2°rög
(
ruÀ
->verdict) : verdict,

462 ()
ruÀ
->
numbî
,

463 
	`¥Ÿocﬁ2°rög
(
°©e
->
¥Ÿocﬁ
),

464 
	`comm™d2°rög
(
°©e
->
comm™d
));

466 
	`¶og
(
LOG_INFO
, "%s %s%s%s",

467 
ruÀcomm™d
,

468 
buf
,

469 
dﬁogt˝öfo
 ? 
t˝öf›ªfix
 : "",

470 
dﬁogt˝öfo
 ? 
°©e
->
t˝öfo
 : "");

472 
	`‰ì
(
bigbuf
);

473 
	}
}

476 
	$sockd_‰ìlogobje˘
(
logobje˘
, 
˛o£too
)

477 
logty≥_t
 *
logobje˘
;

478 c⁄° 
˛o£too
;

480 c⁄° *
fun˘i⁄
 = "sockd_freelogobject()";

481 
sig£t_t
 
Æl
, 
ﬁdmask
;

482 
size_t
 
i
;

484 ()
	`sigfûl£t
(&
Æl
);

485 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
Æl
, &
ﬁdmask
) != 0)

486 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK)", 
fun˘i⁄
);

488 
i
 = 0; i < 
logobje˘
->
fûíoc
; ++i) {

489 i‡(
˛o£too
 && !
	`FD_IS_RESERVED_EXTERNAL
(
logobje˘
->
fûíov
[
i
]))

490 
	`˛o£
(
logobje˘
->
fûíov
[
i
]);

492 
	`‰ì
(
logobje˘
->
‚amev
[
i
]);

495 
	`‰ì
(
logobje˘
->
‚amev
);

496 
	`‰ì
(
logobje˘
->
fûíov
);

497 
	`‰ì
(
logobje˘
->
¸óãdv
);

499 
	`bzîo
(
logobje˘
, (*logobject));

501 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

502 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

503 
	}
}

506 
	$logÀvñ_î∫o
(
e
, 
side
)

507 c⁄° 
e
;

508 c⁄° 
öãrÁ˚side_t
 
side
;

510 c⁄° 
log•ecül_t
 *
log
;

511 
öãrÁ˚side_t
 
œ°_side
;

512 
œ°_logÀvñ
 = -1, 
œ°_î∫o
;

513 
size_t
 
i
, 
ii
;

515 
	`CTASSERT
(
LOG_EMERG
 == 0);

516 
	`CTASSERT
(
LOG_DEBUG
 == 7);

518 i‡(
œ°_logÀvñ
 !-1 && 
œ°_î∫o
 =
e
 && 
œ°_side
 =
side
)

519  
œ°_logÀvñ
;

521 i‡(
side
 =
INTERNALIF
)

522 
log
 = &
sockscf
.
öã∫Æ
.log;

524 
	`SASSERTX
(
side
 =
EXTERNALIF
);

525 
log
 = &
sockscf
.
exã∫Æ
.log;

537 
i
 = 0; i < 
	`ELEMENTS
(
log
->
î∫o_logÀvñv
); ++i)

538 
ii
 = 0; iò< 
log
->
î∫o_logÀvñc
[
i
]; ++ii)

539 i‡(
log
->
î∫o_logÀvñv
[
i
][
ii
] =
e
) {

540 
œ°_side
 = 
side
;

541 
œ°_î∫o
 = 
î∫o
;

542 
œ°_logÀvñ
 = 
i
;

544  
i
;

547  
LOG_DEBUG
;

548 
	}
}

551 
	$logÀvñ_gaõº
(
e
, 
side
)

552 c⁄° 
e
;

553 c⁄° 
öãrÁ˚side_t
 
side
;

555 c⁄° *
fun˘i⁄
 = "loglevel_gaierr()";

556 
öãrÁ˚side_t
 
œ°_side
;

557 
œ°_logÀvñ
 = -1, 
œ°_gaõº
;

558 c⁄° 
log•ecül_t
 *
log
;

559 
size_t
 
i
, 
ii
;

561 
	`CTASSERT
(
LOG_EMERG
 == 0);

562 
	`CTASSERT
(
LOG_DEBUG
 == 7);

564 
	`¶og
(
LOG_DEBUG
, "%s:Érror %d, side %s",

565 
fun˘i⁄
, 
e
, 
side
 =
EXTERNALIF
 ? "external" : "internal");

567 i‡(
œ°_logÀvñ
 !-1 && 
œ°_gaõº
 =
e
 && 
œ°_side
 =
side
)

568  
œ°_logÀvñ
;

570 i‡(
side
 =
INTERNALIF
)

571 
log
 = &
sockscf
.
öã∫Æ
.log;

573 
	`SASSERTX
(
side
 =
EXTERNALIF
);

574 
log
 = &
sockscf
.
exã∫Æ
.log;

577 
i
 = 0; i < 
	`ELEMENTS
(
log
->
gaõº_logÀvñv
); ++i) {

578 
ii
 = 0; iò< 
log
->
gaõº_logÀvñc
[
i
]; ++ii)

579 i‡(
log
->
gaõº_logÀvñv
[
i
][
ii
] =
e
) {

580 
œ°_logÀvñ
 = 
i
;

581 
œ°_gaõº
 = 
e
;

582 
œ°_side
 = 
side
;

583  
i
;

587  
LOG_DEBUG
;

588 
	}
}

593 
	$√w¥ocöô
()

596 #i‡
SOCKS_CLIENT


599 c⁄° *
fun˘i⁄
 = "newprocinit()";

601 i‡((
sockscf
.
log
.
ty≥
 & 
LOGTYPE_SYSLOG
)

602 || (
sockscf
.
îæog
.
ty≥
 & 
LOGTYPE_SYSLOG
)

603 || 
HAVE_LIBWRAP
 ) {

604 
	`˛o£log
();

610 
	`›ílog
(
__¥og«me
,

611 
LOG_NDELAY
 | 
LOG_PID


612 #ifde‡
LOG_NOWAIT


613 | 
LOG_NOWAIT


617 
î∫o
 = 0;

624 
sockscf
.
°©e
.
pid
 = 
	`gëpid
();

626 
	`§™dom
(()
sockscf
.
°©e
.
pid
);

629 
sockscf
.
°©e
.
sig«lc
 = 0;

631 
	}
}

634 
	$socks_addlogfûe
(
logcf
, 
logfûe
)

635 
logty≥_t
 *
logcf
;

636 c⁄° *
logfûe
;

638 c⁄° *
fun˘i⁄
 = "socks_addlogfile()";

639 c⁄° *
sy¶og«me
 = "syslog";

640 *
p1
, *
p2
, *
p3
;

641 
sig£t_t
 
Æl
, 
ﬁdmask
;

642 *
‚ame
;

643 
fd
, 
logfûewas¸óãd
;

645 i‡(
	`°∫cmp
(
logfûe
, 
sy¶og«me
, 
	`°æí
(syslogname)) == 0

646 && ( 
logfûe
[
	`°æí
(
sy¶og«me
)] =
NUL


647 || 
logfûe
[
	`°æí
(
sy¶og«me
)] == '/')) {

648 c⁄° *
¶
;

650 
logcf
->
ty≥
 |
LOGTYPE_SYSLOG
;

652 i‡(*(
¶
 = &(
logfûe
[
	`°æí
(
sy¶og«me
)])) == '/') {

653 c⁄° 
sy¶ogÁcûôy
 *
Ácûôy
;

655 ++
¶
;

656 i‡((
Ácûôy
 = 
	`sy¶ogÁcûôy
(
¶
)Ë=
NULL
) {

657 
	`yyw¨nx
("unknow¿sy¶og facûôy \"%s\"", 
¶
);

661 
logcf
->
Ácûôy
 = facûôy->
vÆue
;

662 
	`STRCPY_ASSERTSIZE
(
logcf
->
Ácûôy«me
, 
Ácûôy
->
«me
);

665 
logcf
->
Ácûôy
 = 
LOG_DAEMON
;

666 
	`STRCPY_ASSERTSIZE
(
logcf
->
Ácûôy«me
, "daemon");

669 i‡(!
sockscf
.
°©e
.
öôed
)

670 
	`√w¥ocöô
();

676 
logcf
->
ty≥
 |
LOGTYPE_FILE
;

677 i‡((
fd
 = 
	`›ílogfûe
(
logfûe
, &
logfûewas¸óãd
)) == -1)

685 ()
	`sigfûl£t
(&
Æl
);

686 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
Æl
, &
ﬁdmask
) != 0)

687 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK)", 
fun˘i⁄
);

689 i‡((
‚ame
 = 
	`°rdup
(
logfûe
)Ë=
NULL
) {

690 
	`yyw¨n
("%s: couldÇotállocate %lu bytes of memory forÜogfile \"%s\"",

691 
fun˘i⁄
, ()
	`°æí
(
logfûe
),Üogfile);

693 i‡(
fd
 !
	`fûío
(
°dout
Ë&& fd !fûío(
°dîr
))

694 
	`˛o£
(
fd
);

696 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

697 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

702 
p1
 = 
p2
 = 
p3
 = 
NULL
;

704 
p1
 = 
	`ªÆloc
(
logcf
->
fûíov
, (*logcf->fûíovË* (logcf->
fûíoc
 + 1));

705 
p2
 = 
	`ªÆloc
(
logcf
->
‚amev
, (*logcf->‚amevË* (logcf->
fûíoc
 + 1));

706 
p3
 = 
	`ªÆloc
(
logcf
->
¸óãdv
,

707 (*
logcf
->
¸óãdv
Ë* (logcf->
fûíoc
 + 1));

710 i‡(
p1
 !
NULL
)

711 
logcf
->
fûíov
 = 
p1
;

713 i‡(
p2
 !
NULL
)

714 
logcf
->
‚amev
 = 
p2
;

716 i‡(
p3
 !
NULL
)

717 
logcf
->
¸óãdv
 = 
p3
;

720 i‡(
p1
 =
NULL
 || 
p2
 =NULL || 
p3
 == NULL) {

721 
	`yyw¨n
("%s: faûedÅÿÆloˇã mem‹y f‹Üog fûíames", 
fun˘i⁄
);

723 
	`‰ì
(
‚ame
);

731 i‡(
fd
 !
	`fûío
(
°dout
Ë&& fd !fûío(
°dîr
))

732 
	`˛o£
(
fd
);

734 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

735 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

740 
logcf
->
fûíov
[logcf->
fûíoc
] = 
fd
;

741 
logcf
->
‚amev
[logcf->
fûíoc
] = 
‚ame
;

742 
logcf
->
¸óãdv
[logcf->
fûíoc
] = 
logfûewas¸óãd
;

743 ++
logcf
->
fûíoc
;

745 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

746 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

749 
	}
}

751 #i‡!
SOCKS_CLIENT


754 
	$sockd_ª›ílogfûes
(
log
, 
do˛o£ﬁd
)

755 
logty≥_t
 *
log
;

756 c⁄° 
do˛o£ﬁd
;

758 c⁄° *
fun˘i⁄
 = "sockd_reopenlogfiles()";

759 
sig£t_t
 
Æl
, 
ﬁdmask
;

760 
size_t
 
i
;

761 
p
;

763 ()
	`sigfûl£t
(&
Æl
);

764 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
Æl
, &
ﬁdmask
) != 0)

765 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK)", 
fun˘i⁄
);

767 
i
 = 0; i < 
log
->
fûíoc
; ++i) {

768 i‡(
do˛o£ﬁd
) {

769 i‡(
	`˛o£
(
log
->
fûíov
[
i
]) != 0)

770 
	`sw¨n
("%s: couldÇot closeÜogfile \"%s\" using fd %d",

771 
fun˘i⁄
, 
log
->
‚amev
[
i
],Üog->
fûíov
[i]);

780 i‡((
log
->
fûíov
[
i
] = 
	`›ílogfûe
÷og->
‚amev
[i], &
p
)) == -1) {

781 
	`sw¨n
("%s: couldÇŸÑe›íÜogfûê\"%s\"", 
fun˘i⁄
, 
log
->
‚amev
[
i
]);

783 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

784 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

790 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

791 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

794 
	}
}

798 
	$¶og
(
¥i‹ôy
, c⁄° *
mesßge
, ...)

800 
va_li°
 
≠
, 
≠c›y
;

806 
	`va_°¨t
(
≠
, 
mesßge
);

807 
	`va_°¨t
(
≠c›y
, 
mesßge
);

809 
	`v¶og
(
¥i‹ôy
, 
mesßge
, 
≠
, 
≠c›y
);

811 
	`va_íd
(
≠c›y
);

812 
	`va_íd
(
≠
);

813 
	}
}

816 
	$v¶og
(
¥i‹ôy
, 
mesßge
, 
≠
, 
≠c›y
)

817 
¥i‹ôy
;

818 c⁄° *
mesßge
;

819 
va_li°
 
≠
;

820 
va_li°
 
≠c›y
;

822 c⁄° *
fun˘i⁄
 = "vslog()";

823 c⁄° 
î∫o_s
 = 
î∫o
;

824 
ssize_t
 
p
;

825 
size_t
 
d©Æí
 , 
¥efixÀn
 , 
buÊí
,

826 
logÀn
, 
ﬁdlogÀn
;

827 *
buf
, *
bigbuf
, 
ªgbuf
[
REGULARBUFLEN
];

829 
buf
 = 
ªgbuf
;

830 
buÊí
 = (
ªgbuf
);

831 
bigbuf
 = 
NULL
;

833 #i‡!
SOCKS_IGNORE_SIGNALSAFETY


834 i‡(
sockscf
.
°©e
.
ösig«l


845 i‡(
¥i‹ôy
 =
LOG_DEBUG
 && !
sockscf
.
›ti⁄
.
debug
) {

846 #i‡
HAVE_LIVEDEBUG


847 c⁄° 
ösig«l
 = 
sockscf
.
°©e
.insignal;

849 #i‡
SOCKS_CLIENT


850 
©exô_ªgi°îed
;

852 i‡(!
©exô_ªgi°îed
) {

853 i‡(
	`©exô
(
©exô_Êushrb
) != 0)

854 
	`sw¨n
("%s:áãxô(ËÁûedÅÿªgi°îáãxô fun˘i⁄", 
fun˘i⁄
);

856 
©exô_ªgi°îed
 = 1;

860 i‡(!
d⁄t_add_to_rb
) {

865 
ssize_t
 
maxt›röt
;

867 
sockscf
.
°©e
.
ösig«l
 = 1;

868 
¥efixÀn
 = 
	`gëlog¥efix
(
¥i‹ôy
, 
buf
, 
buÊí
);

869 
sockscf
.
°©e
.
ösig«l
 = insignal;

871 
maxt›röt
 = 
	`MIN
(
buÊí
 - 
¥efixÀn
, 
SOCKS_RINGBUF_MAXLINELEN
);

872 
	`SASSERTX
(
maxt›röt
 >= 0);

874 
p
 = 
	`v¢¥ötf
(&
buf
[
¥efixÀn
],

875 (
size_t
)
maxt›röt
,

876 
mesßge
,

877 
≠
);

879 i‡(
p
 <= 0) {

880 
î∫o
 = 
î∫o_s
;

884 i‡(
p
 >
maxt›röt
) {

885 
buf
[(
¥efixÀn
 + 
maxt›röt
Ë- 1] = 
NUL
;

886 
p
 = 
maxt›röt
 - 1;

889 
d©Æí
 = (
size_t
)
p
;

891 
	`SASSERTX
(
buf
[
¥efixÀn
 + 
d©Æí
] =
NUL
);

893 i‡(
¥efixÀn
 + 
d©Æí
 < 
buÊí
)

894 
logÀn
 = 
¥efixÀn
 + 
d©Æí
 + 1 ;

896 
logÀn
 = 
buÊí
;

898 #i‡
DIAGNOSTIC


899 
	`SASSERTX
(
logÀn
 =
	`°æí
(
buf
) + 1);

902 
	`SASSERTX
(
logÀn
 >= 2);

903 
	`SASSERTX
(
buf
[
logÀn
 - 1] =
NUL
);

905 
	`ADDNL
(&
logÀn
, 
buf
, 
buÊí
);

907 
	`SASSERTX
(
buf
[
logÀn
 - 1] =
NUL
);

908 
	`socks_addt‹b
(
buf
, 
logÀn
);

912 
î∫o
 = 
î∫o_s
;

916 
¥efixÀn
 = 
	`gëlog¥efix
(
¥i‹ôy
, 
buf
, 
buÊí
);

917 
	`SASSERTX
(
¥efixÀn
 < 
buÊí
);

919 
p
 = 
	`v¢¥ötf
(&
buf
[
¥efixÀn
], 
buÊí
 -¥efixÀn, 
mesßge
, 
≠
);

920 i‡(
p
 <= 0) {

921 
î∫o
 = 
î∫o_s
;

925 
d©Æí
 = 
p
;

927 i‡(
¥efixÀn
 + 
d©Æí
 >
buÊí
 && !
sockscf
.
°©e
.
ösig«l
) {

932 c⁄° 
size_t
 
tﬂŒoc
 = 
d©Æí
 + 
¥efixÀn
 + ("\n");

934 i‡((
bigbuf
 = 
	`mÆloc
(
tﬂŒoc
)Ë!
NULL
) {

935 
	`mem˝y
(
bigbuf
, 
buf
, 
¥efixÀn
);

936 
buf
 = 
bigbuf
;

937 
buÊí
 = 
tﬂŒoc
;

939 
p
 = 
	`v¢¥ötf
(&
buf
[
¥efixÀn
], 
buÊí
 -ÖªfixÀn, 
mesßge
, 
≠c›y
);

940 i‡(
p
 <= 0) {

941 
	`‰ì
(
bigbuf
);

942 
î∫o
 = 
î∫o_s
;

947 
d©Æí
 = 
p
;

952 i‡(
¥efixÀn
 + 
d©Æí
 >
buÊí
) {

954 
d©Æí
 = 
buÊí
 - 
¥efixÀn
 - 1;

955 
buf
[
buÊí
 - 1] = 
NUL
;

958 
logÀn
 = 
¥efixÀn
 + 
d©Æí
 + 1 ;

959 
	`SASSERTX
(
logÀn
 <
buÊí
);

960 
	`SASSERTX
(
buf
[
logÀn
 - 1] =
NUL
);

962 #i‡
DIAGNOSTIC


963 
	`SASSERTX
(
logÀn
 =
	`°æí
(
buf
) + 1);

966 
ﬁdlogÀn
 = 
logÀn
;

967 
	`ADDNL
(&
logÀn
, 
buf
, 
buÊí
);

968 i‡(
logÀn
 !
ﬁdlogÀn
) {

969 
	`SASSERTX
(
logÀn
 = 
ﬁdlogÀn
 + 1);

970 ++
d©Æí
;

973 
	`SASSERTX
(
logÀn
 <
buÊí
);

974 
	`SASSERTX
(
buf
[
logÀn
 - 1] =
NUL
);

976 #i‡
DIAGNOSTIC


977 
	`SASSERTX
(
logÀn
 =
	`°æí
(
buf
) + 1);

980 
	`dﬁog
(
¥i‹ôy
, 
buf
, 
¥efixÀn
, 
d©Æí
);

982 
	`‰ì
(
bigbuf
);

983 
î∫o
 = 
î∫o_s
;

984 
	}
}

987 
	$sig«l¶og
(
¥i‹ôy
, 
msgv
)

988 c⁄° 
¥i‹ôy
;

989 c⁄° *
msgv
[];

991 c⁄° *
fun˘i⁄
 = "signalslog()";

992 c⁄° 
î∫o_s
 = 
î∫o
;

993 
size_t
 
bufu£d
, 
msgÀn
, 
¥efixÀn
, 
i
;

994 #i‡
HAVE_LIVEDEBUG


995 
buf
[
SOCKS_RINGBUFLEN
];

998 
buf
[
REGULARBUFLEN
];

1002 
¥efixÀn
 = 
bufu£d
 = 
	`gëlog¥efix
(
¥i‹ôy
, 
buf
, (buf));

1004 i‡(
msgv
 =
NULL
)

1007 
i
 = 0; 
msgv
[i] !
NULL
; ++i) {

1008 
msgÀn
 = 
	`MIN
(
	`°æí
(
msgv
[
i
]), (
buf
Ë- 
bufu£d
 - 1);

1009 
	`mem˝y
(&
buf
[
bufu£d
], 
msgv
[
i
], 
msgÀn
);

1010 
bufu£d
 +
msgÀn
;

1013 
	`SASSERTX
(
bufu£d
 < (
buf
));

1014 
buf
[
bufu£d
++] = 
NUL
;

1016 
	`ADDNL
(&
bufu£d
, 
buf
, (buf));

1018 
	`SASSERTX
(
buf
[
bufu£d
 - 1] =
NUL
);

1019 
	`SASSERTX
(
buf
[
bufu£d
 - 2] == '\n');

1021 
msgÀn
 = 
bufu£d
 - 1 - 
¥efixÀn
;

1023 i‡(
¥i‹ôy
 =
LOG_DEBUG
 && !
sockscf
.
›ti⁄
.
debug
) {

1024 #i‡
HAVE_LIVEDEBUG


1025 i‡(!
d⁄t_add_to_rb
)

1026 
	`socks_addt‹b
(
buf
, 
bufu£d
);

1029 
î∫o
 = 
î∫o_s
;

1033 
	`dﬁog
(
¥i‹ôy
, 
buf
, 
¥efixÀn
, 
msgÀn
);

1035 #i‡
HAVE_LIVEDEBUG


1036 i‡(!
d⁄t_add_to_rb
)

1037 
	`socks_addt‹b
(
buf
, 
bufu£d
);

1040 
î∫o
 = 
î∫o_s
;

1041 
	}
}

1045 
	$dﬁog
(
¥i‹ôy
, 
buf
, 
¥efixÀn
, 
mesßgñí
)

1046 c⁄° 
¥i‹ôy
;

1047 c⁄° *
buf
;

1048 c⁄° 
size_t
 
¥efixÀn
;

1049 c⁄° 
size_t
 
mesßgñí
;

1051 
√edlock
 = 0, 
logged
 = 0;

1056 i‡((
sockscf
.
îæog
.
ty≥
 & 
LOGTYPE_SYSLOG
)

1057 || (
sockscf
.
log
.
ty≥
 & 
LOGTYPE_SYSLOG
)) {

1058 i‡(
¥i‹ôy
 <
LOG_WARNING
) {

1059 i‡(
sockscf
.
îæog
.
ty≥
 & 
LOGTYPE_SYSLOG
) {

1065 i‡(!
sockscf
.
°©e
.
ösig«l
 || 
¥i‹ôy
 <
LOG_CRIT
) {

1066 
	`sy¶og
(
¥i‹ôy
 | 
sockscf
.
îæog
.
Ácûôy
,

1067 "%s: %s", 
	`logÀvñ2°rög
(
¥i‹ôy
), &
buf
[
¥efixÀn
]);

1069 
logged
 = 1;

1074 i‡(
sockscf
.
log
.
ty≥
 & 
LOGTYPE_SYSLOG
) {

1075 i‡(!
sockscf
.
°©e
.
ösig«l
 || 
¥i‹ôy
 <
LOG_CRIT
) {

1076 
	`sy¶og
(
¥i‹ôy
 | 
sockscf
.
log
.
Ácûôy
,

1077 "%s: %s", 
	`logÀvñ2°rög
(
¥i‹ôy
), &
buf
[
¥efixÀn
]);

1079 
logged
 = 1;

1090 i‡((
sockscf
.
log
.
ty≥
 & 
LOGTYPE_FILE
)

1091 || (
¥i‹ôy
 <
LOG_WARNING
 && (
sockscf
.
îæog
.
ty≥
 & 
LOGTYPE_FILE
))

1092 || 
HAVE_LIVEDEBUG
) {

1093 i‡(
sockscf
.
loglock
 != -1) {

1094 
√edlock
 = 1;

1095 
	`socks_lock
(
sockscf
.
loglock
, 0, 0, 1, 1);

1099 
√edlock
 = 0;

1103 i‡(
¥i‹ôy
 <
LOG_WARNING
) {

1104 i‡(
sockscf
.
îæog
.
ty≥
 & 
LOGTYPE_FILE
) {

1105 
size_t
 
i
;

1107 
i
 = 0; i < 
sockscf
.
îæog
.
fûíoc
; ++i) {

1108 
	`wrôe
(
sockscf
.
îæog
.
fûíov
[
i
], 
buf
, 
¥efixÀn
 + 
mesßgñí
)

1109 =-1 && 
î∫o
 =
EINTR
)

1112 
logged
 = 1;

1118 i‡(
sockscf
.
log
.
ty≥
 & 
LOGTYPE_FILE
) {

1119 
size_t
 
i
;

1121 
i
 = 0; i < 
sockscf
.
log
.
fûíoc
; ++i) {

1122 
size_t
 
ªåõs
 = 0;

1124 
	`wrôe
(
sockscf
.
log
.
fûíov
[
i
], 
buf
, 
¥efixÀn
 + 
mesßgñí
) == -1

1125 && 
î∫o
 =
EINTR


1126 && 
ªåõs
++ < 10)

1129 
logged
 = 1;

1133 i‡(
√edlock
)

1134 
	`socks_u∆ock
(
sockscf
.
loglock
, 0, 0);

1140 i‡(!
logged
) {

1141 i‡(!
sockscf
.
°©e
.
öôed
 && 
¥i‹ôy
 <
LOG_WARNING
) {

1142 #i‡
SOCKS_CLIENT


1144 i‡(
	`ißây
(
	`fûío
(
°dîr
)))

1145 ()
	`wrôe
(
	`fûío
(
°dîr
), 
buf
, 
¥efixÀn
 + 
mesßgñí
);

1149 ()
	`wrôe
(
	`fûío
(
°dîr
), 
buf
, 
¥efixÀn
 + 
mesßgñí
);

1154 
	}
}

1157 
	$›ílogfûe
(
logfûe
, 
we¸óãd
)

1158 c⁄° *
logfûe
;

1159 *
we¸óãd
;

1161 c⁄° *
fun˘i⁄
 = "openlogfile()";

1162 
p
, 
Êag°ﬂdd
, 
fd
;

1164 *
we¸óãd
 = 0;

1166 i‡(
	`°rcmp
(
logfûe
, "stdout") == 0) {

1167 
fd
 = 
	`fûío
(
°dout
);

1168 
Êag°ﬂdd
 = 0;

1170 i‡(
	`°rcmp
(
logfûe
, "stderr") == 0) {

1171 
fd
 = 
	`fûío
(
°dîr
);

1172 
Êag°ﬂdd
 = 0;

1175 c⁄° 
mode_t
 
›ímode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
;

1176 c⁄° 
›íÊags
 = 
O_WRONLY
 | 
O_APPEND
;

1178 #i‡!
SOCKS_CLIENT


1179 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

1182 i‡((
fd
 = 
	`›í
(
logfûe
, 
›íÊags
, 
›ímode
)) == -1)

1183 i‡((
fd
 = 
	`›í
(
logfûe
, 
›íÊags
 | 
O_CREAT
, 
›ímode
)) != -1)

1184 *
we¸óãd
 = 1;

1186 #i‡!
SOCKS_CLIENT


1187 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

1190 
Êag°ﬂdd
 = 
FD_CLOEXEC
;

1193 i‡(
fd
 == -1) {

1194 
	`sw¨n
("%s: couldÇot open or createÜogfile \"%s\" for writing",

1195 
fun˘i⁄
, 
logfûe
);

1200 i‡((
p
 = 
	`f˙é
(
fd
, 
F_GETFD
, 0)) == -1)

1201 
	`sw¨n
("%s: fcntl(F_GETFD) onÜogfile \"%s\", fd %d, failed",

1202 
fun˘i⁄
, 
logfûe
, 
fd
);

1204 i‡(
	`f˙é
(
fd
, 
F_SETFD
, 
p
 | 
Êag°ﬂdd
) == -1)

1205 
	`sw¨n
("%s: fcntl(F_SETFD, 0x%x) onÜogfile \"%s\", fd %d, failed",

1206 
fun˘i⁄
, 
p
 | 
Êag°ﬂdd
, 
logfûe
, 
fd
);

1209  
fd
;

1210 
	}
}

1212 
size_t


1213 
	$gëlog¥efix
(
¥i‹ôy
, 
buf
, 
buÊí
)

1214 c⁄° 
¥i‹ôy
;

1215 *
buf
;

1216 
size_t
 
buÊí
;

1218 c⁄° *
p
;

1219 
time_t
 
œ°_£c⁄d¢ow
;

1220 
œ°°r
[128];

1221 
size_t
 
œ°°r_Ànu£d
;

1222 
timevÆ
 
timíow
;

1223 
size_t
 
i
, 
toc›y
, 
Ànu£d
;

1224 
time_t
 
£c⁄d¢ow
;

1225 
pid_t
 
pid
;

1226 
s_°rög
[22 ],

1227 
us_°rög
[(
s_°rög
)], 
pid_°rög
[(s_string)];

1229 i‡(
buÊí
 == 0)

1232 
	`gëtimeofday
(&
timíow
, 
NULL
);

1234 i‡(
sockscf
.
°©e
.
pid
 == 0)

1235 
pid
 = 
	`gëpid
();

1237 
pid
 = 
sockscf
.
°©e
.pid;

1239 
Ànu£d
 = 0;

1241 i‡((
£c⁄d¢ow
 = (
time_t
)
timíow
.
tv_£c
Ë=
œ°_£c⁄d¢ow
) {

1242 c⁄° 
size_t
 
toc›y
 = 
	`MIN
(
buÊí
 - 
Ànu£d
, 
œ°°r_Ànu£d
);

1244 
	`mem˝y
(&
buf
[
Ànu£d
], 
œ°°r
, 
toc›y
);

1245 
Ànu£d
 +
toc›y
;

1248 
tm
 *tm;

1250 i‡(
sockscf
.
°©e
.
ösig«l


1251 || (
tm
 = 
	`loˇ…ime
(&
£c⁄d¢ow
)Ë=
NULL
) {

1255 c⁄° 
p
[] = "<noÜocaltimeávailable> ";

1256 c⁄° 
size_t
 
toc›y
 = 
	`MIN
(
buÊí
 - 
Ànu£d
, (
p
) - 1);

1258 
	`mem˝y
(&
buf
[
Ànu£d
], 
p
, 
toc›y
);

1259 
Ànu£d
 +
toc›y
;

1262 c⁄° 
size_t
 
Àn
 = 
	`°r·ime
(&
buf
[
Ànu£d
], 
buÊí
 -Üenused,

1263 "%h %ê%T ", 
tm
);

1265 
œ°°r_Ànu£d
 = 
	`MIN
((
œ°°r
Ë- 1, 
Àn
);

1266 
	`mem˝y
(
œ°°r
, &
buf
[
Ànu£d
], 
œ°°r_Ànu£d
);

1267 
œ°_£c⁄d¢ow
 = 
£c⁄d¢ow
;

1269 
Ànu£d
 +
Àn
;

1279 
	`¢¥ötf
(&
buf
[
Ànu£d
], 
buÊí
 -Üenused,

1281 ()
timíow
.
tv_£c
,

1282 ()
timíow
.
tv_u£c
,

1283 
__¥og«me
,

1284 ()
pid
,

1285 
	`logÀvñ2°rög
(
¥i‹ôy
));

1289 
	`…ﬂ
(()
timíow
.
tv_£c
, 
s_°rög
, (s_string));

1290 
	`…ﬂ
(()
timíow
.
tv_u£c
, 
us_°rög
, (us_string));

1291 
	`…ﬂ
(()
pid
, 
pid_°rög
, (pid_string));

1293 
	#WANTED_DIGITS
 (6Ë

	)

1295 #i‡
DIAGNOSTIC


1296 
	`SASSERTX
(
	`°æí
(
us_°rög
Ë<
WANTED_DIGITS
);

1299 i‡((
i
 = 
	`°æí
(
us_°rög
)Ë< 
WANTED_DIGITS
) {

1300 c⁄° 
size_t
 
zîos_to_add
 = 
WANTED_DIGITS
 - 
i
;

1301 
size_t
 
added
;

1302 
debug
[(
us_°rög
)];

1304 
	`mem˝y
(
debug
, 
us_°rög
, (debug));

1306 
	`SASSERTX
(
us_°rög
[
i
] =
NUL
);

1307 
	`memmove
(&
us_°rög
[
zîos_to_add
], us_°rög, 
i
 + 1);

1309 
added
 = 0;ádded < 
zîos_to_add
; ++added)

1310 
us_°rög
[
added
] = '0';

1312 
	`SASSERTX
(
us_°rög
[
i
 + 
zîos_to_add
] =
NUL
);

1314 #i‡
DIAGNOSTIC


1315 
	`SASSERTX
(
	`°æí
(
us_°rög
Ë=
WANTED_DIGITS
);

1319 #i‡
DIAGNOSTIC


1320 
	`SASSERTX
(
	`°æí
(
us_°rög
Ë=
WANTED_DIGITS
);

1322 
	`SASSERTX
(
buÊí
 - 
Ànu£d
 >

1323 
	`°æí
("(")

1324 + 
	`°æí
(
s_°rög
Ë+ såÀn("."Ë+ såÀn(
us_°rög
)

1325 + 
	`°æí
(") ")

1326 + 
	`°æí
(
__¥og«me
)

1327 + 
	`°æí
("["Ë+ såÀn(
pid_°rög
) + strlen("]: ")

1328 + 
	`°æí
(
	`logÀvñ2°rög
(
¥i‹ôy
)) + strlen(": "));

1331 
buf
[
Ànu£d
++] = '(';

1333 
p
 = 
s_°rög
;

1334 
toc›y
 = 
	`MIN
(
buÊí
 - 
Ànu£d
, 
	`°æí
(
p
));

1335 
	`mem˝y
(&
buf
[
Ànu£d
], 
p
, 
toc›y
);

1336 
Ànu£d
 +
toc›y
;

1338 
buf
[
Ànu£d
++] = '.';

1340 
p
 = 
us_°rög
;

1341 
toc›y
 = 
	`MIN
(
buÊí
 - 
Ànu£d
, 
	`°æí
(
p
));

1342 
	`mem˝y
(&
buf
[
Ànu£d
], 
p
, 
toc›y
);

1343 
Ànu£d
 +
toc›y
;

1345 
buf
[
Ànu£d
++] = ')';

1346 
buf
[
Ànu£d
++] = ' ';

1348 
p
 = 
__¥og«me
;

1349 
toc›y
 = 
	`MIN
(
buÊí
 - 
Ànu£d
, 
	`°æí
(
p
));

1350 
	`mem˝y
(&
buf
[
Ànu£d
], 
p
, 
toc›y
);

1351 
Ànu£d
 +
toc›y
;

1353 
buf
[
Ànu£d
++] = '[';

1355 
p
 = 
pid_°rög
;

1356 
toc›y
 = 
	`MIN
(
buÊí
 - 
Ànu£d
, 
	`°æí
(
p
));

1357 
	`mem˝y
(&
buf
[
Ànu£d
], 
p
, 
toc›y
);

1358 
Ànu£d
 +
toc›y
;

1360 
buf
[
Ànu£d
++] = ']';

1361 
buf
[
Ànu£d
++] = ':';

1362 
buf
[
Ànu£d
++] = ' ';

1364 
p
 = 
	`logÀvñ2°rög
(
¥i‹ôy
);

1365 
toc›y
 = 
	`MIN
(
buÊí
 - 
Ànu£d
, 
	`°æí
(
p
));

1366 
	`mem˝y
(&
buf
[
Ànu£d
], 
p
, 
toc›y
);

1368 
Ànu£d
 +
toc›y
;

1369 
buf
[
Ànu£d
++] = ':';

1370 
buf
[
Ànu£d
++] = ' ';

1372 
buf
[
Ànu£d
++] = 
NUL
;

1374 --
Ànu£d
;

1375 
	`SASSERTX
(
buf
[
Ànu£d
] =
NUL
);

1377  
Ànu£d
;

1378 
	}
}

1381 
	$socks_logm©ch
(
d
, 
log
)

1382 
d
;

1383 c⁄° 
logty≥_t
 *
log
;

1385 
size_t
 
i
;

1387 i‡(
d
 < 0)

1390 
i
 = 0; i < 
log
->
fûíoc
; ++i)

1391 i‡(
d
 =
log
->
fûíov
[
i
])

1395 
	}
}

1399 
	$¶og°ack
()

1401 #i‡
HAVE_BACKTRACE


1402 c⁄° *
fun˘i⁄
 = "slogstack()";

1403 *
¨øy
[20];

1404 
size_t
 
i
, 
size
;

1405 **
°rögs
;

1407 
size
 = 
	`backåa˚
(
¨øy
, ()
	`ELEMENTS
(array));

1408 
°rögs
 = 
	`backåa˚_symbﬁs
(
¨øy
, 
size
);

1410 i‡(
°rögs
 =
NULL
) {

1411 
	`sw¨n
("%s: såög†NULL", 
fun˘i⁄
);

1415 
i
 = 1; i < 
size
; i++)

1416 
	`¶og
(
LOG_INFO
, "%s: stackframe #%lu: %s\n",

1417 
fun˘i⁄
, ()
i
, 
°rögs
[i]);

1419 
	`‰ì
(
°rögs
);

1421 
	}
}

1423 c⁄° 
logÀvñ_t
 *

1424 
	$logÀvñ
(
«me
)

1425 c⁄° *
«me
;

1427 c⁄° 
logÀvñ_t
 
logÀvñv
[
MAXLOGLEVELS
] = {

1428 { "emîg", 
LOG_EMERG
 },

1429 { "Æît", 
LOG_ALERT
 },

1430 { "¸ô", 
LOG_CRIT
 },

1431 { "îr", 
LOG_ERR
 },

1432 { "w¨nög", 
LOG_WARNING
 },

1433 { "nŸi˚", 
LOG_NOTICE
 },

1434 { "öfo", 
LOG_INFO
 },

1435 { "debug", 
LOG_DEBUG
 },

1437 
size_t
 
i
;

1439 
	`CTASSERT
(
LOG_EMERG
 == 0);

1440 
	`CTASSERT
(
LOG_DEBUG
 == 7);

1441 
	`CTASSERT
(
LOG_DEBUG
 < 
MAXLOGLEVELS
);

1442 
	`CTASSERT
(
LOG_DEBUG
 < (
logÀvñv
));

1444 
i
 = 0; i < 
	`ELEMENTS
(
logÀvñv
); ++i)

1445 i‡(
	`°rcmp
(
«me
, 
logÀvñv
[
i
].name) == 0)

1446  &
logÀvñv
[
i
];

1448  
NULL
;

1449 
	}
}

1452 c⁄° 
sy¶ogÁcûôy
 *

1453 
	$sy¶ogÁcûôy
(
«me
)

1454 c⁄° *
«me
;

1456 
sy¶ogÁcûôy
 
sy¶ogÁcûôyv
[] = {

1458 { "u£r", 
LOG_USER
 },

1459 { "auth", 
LOG_AUTH
 },

1460 { "d´m⁄", 
LOG_DAEMON
 },

1461 { "loˇl0", 
LOG_LOCAL0
 },

1462 { "loˇl1", 
LOG_LOCAL1
 },

1463 { "loˇl2", 
LOG_LOCAL2
 },

1464 { "loˇl3", 
LOG_LOCAL3
 },

1465 { "loˇl4", 
LOG_LOCAL4
 },

1466 { "loˇl5", 
LOG_LOCAL5
 },

1467 { "loˇl6", 
LOG_LOCAL6
 },

1468 { "loˇl7", 
LOG_LOCAL7
 },

1473 #ifde‡
LOG_AUTHPRIV


1474 { "auth¥iv", 
LOG_AUTHPRIV
 },

1478 
size_t
 
i
;

1480 
i
 = 0; i < 
	`ELEMENTS
(
sy¶ogÁcûôyv
); ++i)

1481 i‡(
	`°rcmp
(
«me
, 
sy¶ogÁcûôyv
[
i
].name) == 0)

1482  &
sy¶ogÁcûôyv
[
i
];

1484  
NULL
;

1485 
	}
}

1488 #i‡
HAVE_LIVEDEBUG


1491 
	$socks_addt‹b
(
°r
, 
Àn›t
)

1492 c⁄° *
°r
;

1493 c⁄° 
size_t
 
Àn›t
;

1495 
ssize_t
 
ovîshoŸ
;

1496 
size_t
 
Àn
;

1498 i‡(
d⁄t_add_to_rb
)

1501 i‡(
Àn›t
 <= 1)

1504 #i‡
DIAGNOSTIC


1505 
	`SASSERTX
(
Àn›t
 =
	`°æí
(
°r
) + 1);

1508 i‡(
Àn›t
 >(
rögbuf„r
))

1509 
Àn
 = (
rögbuf„r
) - 1 - 1;

1511 
Àn
 = 
Àn›t
 - 1;

1513 
ovîshoŸ
 = (
rögbuf_cuºoff
 + 
Àn
Ë- ((
rögbuf„r
) - 1);

1514 i‡(
ovîshoŸ
 > 0) {

1515 
	`memmove
(
rögbuf„r
 + 
rögbuf_cuºoff
, 
°r
, 
Àn
 - 
ovîshoŸ
);

1516 
	`memmove
(
rögbuf„r
, 
°r
 + 
Àn
 - 
ovîshoŸ
, (
size_t
)overshoot);

1517 
rögbuf_cuºoff
 = 
ovîshoŸ
;

1520 
	`memmove
(
rögbuf„r
 + 
rögbuf_cuºoff
, 
°r
, 
Àn
);

1521 
rögbuf_cuºoff
 +
Àn
;

1522 i‡(
rögbuf_cuºoff
 >(
rögbuf„r
) - 1)

1523 
rögbuf_cuºoff
 = 0;

1526 
rögbuf„r
[
rögbuf_cuºoff
] = 
NUL
;

1527 
	`SASSERTX
(
rögbuf„r
[‘ögbuf„rË- 1] =
NUL
);

1530 
	}
}

1533 
	$socks_Êushrb
()

1535 c⁄° *
fun˘i⁄
 = "socks_flushrb()";

1536 c⁄° *
msgv
[]

1537 { 
fun˘i⁄
,

1540 
rögbuf„r
 + 
rögbuf_cuºoff
 + 1,

1541 
rögbuf„r
,

1543 
NULL


1545 c⁄° 
ﬁd_d⁄t_add_to_rb
 = 
d⁄t_add_to_rb
;

1547 
d⁄t_add_to_rb
 = 1;

1549 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

1551 
d⁄t_add_to_rb
 = 
ﬁd_d⁄t_add_to_rb
;

1552 
	}
}

1554 #i‡
SOCKS_CLIENT


1556 
	$©exô_Êushrb
()

1558 c⁄° *
fun˘i⁄
 = "atexit_flushrb()";

1560 i‡(
sockscf
.
°©e
.
öã∫Æîr‹dëe˘ed
 && !sockscf.
›ti⁄
.
debug
) {

1561 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

1562 
	`socks_Êushrb
();

1564 
	}
}

	@lib/method.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

50 
	$mëhodisvÆid
(
mëhod
, 
ruÀty≥
)

51 c⁄° 
mëhod
;

52 c⁄° 
obje˘ty≥_t
 
ruÀty≥
;

55 
ruÀty≥
) {

56 
obje˘_¸uÀ
:

57 #i‡
HAVE_SOCKS_HOSTID


58 
obje˘_hruÀ
:

61 
mëhod
) {

62 
AUTHMETHOD_NONE
:

63 
AUTHMETHOD_RFC931
:

64 
AUTHMETHOD_PAM_ANY
:

65 
AUTHMETHOD_PAM_ADDRESS
:

74 
obje˘_§uÀ
:

79 
	`SERRX
(
ruÀty≥
);

83 
	}
}

85 #i‡!
SOCKS_CLIENT


87 
	$mëhodˇ≈rovide
(
mëhod
, 
wh©
)

88 c⁄° 
mëhod
;

89 c⁄° 
mëhodöfo_t
 
wh©
;

91 c⁄° *
fun˘i⁄
 = "methodcanprovide()";

93 
mëhod
) {

94 
AUTHMETHOD_NOTSET
:

97 
AUTHMETHOD_NONE
:

100 
AUTHMETHOD_PAM_ANY
:

103 
AUTHMETHOD_BSDAUTH
:

104 
AUTHMETHOD_GSSAPI
:

105 
AUTHMETHOD_PAM_ADDRESS
:

106 
AUTHMETHOD_PAM_USERNAME
:

107 
AUTHMETHOD_RFC931
:

108 
AUTHMETHOD_UNAME
:

109 
wh©
) {

110 
u£∫ame
:

120 
	`SERRX
(
mëhod
);

124 
	}
}

127 
	$mëhodw‹kswôh
(
mëhod
, 
wh©
)

128 c⁄° 
mëhod
;

129 c⁄° 
mëhodöfo_t
 
wh©
;

131 c⁄° *
fun˘i⁄
 = "methodworkswith()";

133 
mëhod
) {

134 
AUTHMETHOD_NOTSET
:

137 
AUTHMETHOD_NONE
:

138 
wh©
) {

139 
t˝ª∂õs
:

140 
ud¥ïlõs
:

141 
ª∂õs
:

145 
	`SERRX
(
wh©
);

149 
AUTHMETHOD_PAM_ANY
:

150 
AUTHMETHOD_PAM_ADDRESS
:

151 
AUTHMETHOD_RFC931
:

152 
wh©
) {

153 
ª∂õs
:

154 
ud¥ïlõs
:

157 
t˝ª∂õs
:

161 
	`SERRX
(
wh©
);

166 
wh©
) {

167 
ud¥ïlõs
:

168 
t˝ª∂õs
:

169 
ª∂õs
:

173 
	`SERRX
(
wh©
);

179 
	}
}

183 
	$auth«me
(
auth
)

184 c⁄° 
authmëhod_t
 *
auth
;

187 i‡(
auth
 =
NULL
)

188  
NULL
;

190 
auth
->
mëhod
) {

191 
AUTHMETHOD_NOTSET
:

192 
AUTHMETHOD_NONE
:

193 
AUTHMETHOD_NOACCEPT
:

194  
NULL
;

196 
AUTHMETHOD_UNAME
:

197  (c⁄° *)
auth
->
md©a
.
u«me
.
«me
;

199 #i‡
HAVE_LIBWRAP


200 
AUTHMETHOD_RFC931
:

201  (c⁄° *)
auth
->
md©a
.
rfc931
.
«me
;

204 #i‡
HAVE_PAM


205 
AUTHMETHOD_PAM_ANY
:

206 
AUTHMETHOD_PAM_ADDRESS
:

207 
AUTHMETHOD_PAM_USERNAME
:

208  (c⁄° *)
auth
->
md©a
.
∑m
.
«me
;

211 #i‡
HAVE_BSDAUTH


212 
AUTHMETHOD_BSDAUTH
:

213  (c⁄° *)
auth
->
md©a
.
bsd
.
«me
;

216 #i‡
HAVE_GSSAPI


217 
AUTHMETHOD_GSSAPI
:

218  (c⁄° *)
auth
->
md©a
.
gsßpi
.
«me
;

222 
	`SERRX
(
auth
->
mëhod
);

226 
	}
}

229 
	$buûd_addr°r_§c
(
ho°idv
, 
ho°idc
, 
≥î
, 
¥oxy_ext
, 
¥oxy
, 
loˇl
,

230 
≥îauth
, 
¥oxyauth
, 
°r
, 
°rsize
)

231 c⁄° 
ö_addr
 *
ho°idv
;

232 c⁄° 
ho°idc
;

233 c⁄° 
socksho°_t
 *
≥î
;

234 c⁄° 
socksho°_t
 *
¥oxy_ext
;

235 c⁄° 
socksho°_t
 *
¥oxy
;

236 c⁄° 
socksho°_t
 *
loˇl
;

237 c⁄° 
authmëhod_t
 *
≥îauth
;

238 c⁄° 
authmëhod_t
 *
¥oxyauth
;

239 *
°r
;

240 
size_t
 
°rsize
;

242 c⁄° *
fun˘i⁄
 = "build_addrstr_src()";

243 
size_t
 
°ru£d
;

244 
≥î°r
[
MAXSOCKSHOSTSTRING
], 
≥îauth°r
[
MAXAUTHINFOLEN
],

245 
¥oxyauth°r
[
MAXAUTHINFOLEN
], 
p°r
[
MAXSOCKSHOSTSTRING
],

246 
≥_°r
[
MAXSOCKSHOSTSTRING
 + ("[]")], 
l°r
[MAXSOCKSHOSTSTRING];

248 
°ru£d
 = 0;

249 i‡(
ho°idv
 !
NULL
 && 
ho°idc
 > 0) {

250 
size_t
 
i
;

252 
i
 = 0; i < 
ho°idc
; ++i) {

253 
¡›
[
MAXSOCKADDRSTRING
];

255 i‡(
	`öë_¡›
(
AF_INET
, &
ho°idv
[
i
], 
¡›
, “t›)Ë=
NULL
) {

256 
	`¶og
(
LOG_DEBUG
, "%s: inet_ntop(3) failed on %s %x: %s",

257 
fun˘i⁄
,

258 
	`©y≥2°rög
(
SOCKS_ADDR_IPV4
),

259 
ho°idv
[
i
].
s_addr
,

260 
	`°ªº‹
(
î∫o
));

262 
	`¢¥ötf
(
¡›
, (ntop), "<unknown>");

265 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

267 
i
 > 0 ? " " : "",

268 
¡›
);

271 i‡((
°ru£d
 + 1Ë< 
°rsize
) {

272 
°r
[
°ru£d
] = ' ';

273 
°r
[
°ru£d
 + 1] = 
NUL
;

274 
°ru£d
 += 1;

278 i‡((
¥oxy_ext
Ë=
NULL
)

279 *
≥_°r
 = 
NUL
;

281 
	`¢¥ötf
(
≥_°r
, (pe_str),

282 "[%s] ", 
	`socksho°2°rög
(
¥oxy_ext
, 
NULL
, 0));

284 
	`¢¥ötf
(&
°r
[
°ru£d
], 
°rsize
 - strused,

290 
	`authöfo
((
≥îauth
), 
≥îauth°r
, (peerauthstr)),

291 (
≥î
Ë=
NULL
 ?

292 "0.0.0.0.0" : 
	`socksho°2°rög
((
≥î
), 
≥î°r
, (peerstr)),

294 
≥_°r
,

296 
	`authöfo
((
¥oxyauth
), 
¥oxyauth°r
, (proxyauthstr)),

297 (
¥oxy
Ë=
NULL
 ?

298 "" : 
	`socksho°2°rög
((
¥oxy
), 
p°r
, (pstr)),

299 (
¥oxy
Ë=
NULL
 ? "" : " ",

301 (
loˇl
Ë=
NULL
 ?

302 "0.0.0.0.0" : 
	`socksho°2°rög
((
loˇl
), 
l°r
, (lstr)));

304  
°r
;

305 
	}
}

308 
	$buûd_addr°r_d°
(
loˇl
, 
¥oxy
, 
¥oxy_ext
, 
≥î
,

309 
≥îauth
, 
¥oxyauth
, 
ho°idv
, 
ho°idc
, 
°r
, 
°rsize
)

310 c⁄° 
socksho°_t
 *
loˇl
;

311 c⁄° 
socksho°_t
 *
¥oxy
;

312 c⁄° 
socksho°_t
 *
¥oxy_ext
;

313 c⁄° 
socksho°_t
 *
≥î
;

314 c⁄° 
authmëhod_t
 *
≥îauth
;

315 c⁄° 
authmëhod_t
 *
¥oxyauth
;

316 c⁄° 
ö_addr
 *
ho°idv
;

317 c⁄° 
ho°idc
;

318 *
°r
;

319 
size_t
 
°rsize
;

321 c⁄° *
fun˘i⁄
 = "build_addrstr_dst()";

322 
size_t
 
°ru£d
;

323 
≥î°r
[
MAXSOCKSHOSTSTRING
], 
≥îauth°r
[
MAXAUTHINFOLEN
],

324 
¥oxyauth°r
[
MAXAUTHINFOLEN
], 
p°r
[
MAXSOCKSHOSTSTRING
],

325 
≥_°r
[
MAXSOCKSHOSTSTRING
 + ("[]")], 
l°r
[MAXSOCKSHOSTSTRING];

327 i‡((
¥oxy_ext
Ë=
NULL
)

328 *
≥_°r
 = 
NUL
;

330 
	`¢¥ötf
(
≥_°r
, (pe_str),

331 "[%s] ", 
	`socksho°2°rög
(
¥oxy_ext
, 
NULL
, 0));

333 
°ru£d
 =

334 
	`¢¥ötf
((
°r
), (
°rsize
),

340 
loˇl
 =
NULL
 ?

341 "0.0.0.0.0" : 
	`socksho°2°rög
(
loˇl
, 
l°r
, (lstr)),

343 
	`authöfo
(
¥oxyauth
, 
¥oxyauth°r
, (proxyauthstr)),

344 
¥oxy
 =
NULL
 ?

345 "" : 
	`socksho°2°rög
(
¥oxy
, 
p°r
, (pstr)),

346 
¥oxy
 =
NULL
 ? "" : " ",

348 
≥_°r
,

350 
	`authöfo
(
≥îauth
, 
≥îauth°r
, (peerauthstr)),

351 
≥î
 =
NULL
 ?

352 "0.0.0.0.0" : 
	`socksho°2°rög
(
≥î
, 
≥î°r
, (peerstr)));

354 i‡(
ho°idv
 !
NULL
 && 
ho°idc
 > 0) {

355 
ssize_t
 
i
;

357 i‡((
°ru£d
 + 1Ë< 
°rsize
) {

358 
°r
[
°ru£d
] = ' ';

359 
°r
[
°ru£d
 + 1] = 
NUL
;

360 
°ru£d
 += 1;

363 
i
 = 
ho°idc
 - 1; i >= 0; --i) {

364 
¡›
[
MAXSOCKADDRSTRING
];

366 i‡(
	`öë_¡›
(
AF_INET
, &
ho°idv
[
i
], 
¡›
, “t›)Ë=
NULL
) {

367 
	`¶og
(
LOG_DEBUG
, "%s: inet_ntop(3) failed on %s %x: %s",

368 
fun˘i⁄
,

369 
	`©y≥2°rög
(
SOCKS_ADDR_IPV4
),

370 
ho°idv
[
i
].
s_addr
,

371 
	`°ªº‹
(
î∫o
));

373 
	`¢¥ötf
(
¡›
, (ntop), "<unknown>");

376 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

378 (
i
 =((
ssize_t
)
ho°idc
) - 1) ? "" : " ",

379 
¡›
);

383  
°r
;

384 
	}
}

387 
	$authöfo
(
auth
, 
öfo
, 
öfﬁí
)

388 c⁄° 
authmëhod_t
 *
auth
;

389 *
öfo
;

390 
size_t
 
öfﬁí
;

392 c⁄° *
«me
, *
mëhod
, *
mëhodöfo
 = 
NULL
;

394 i‡(
öfo
 =
NULL
 || 
öfﬁí
 == 0) {

395 
buf
[
MAXAUTHINFOLEN
];

397 
öfo
 = 
buf
;

398 
öfﬁí
 = (
buf
);

401 i‡(
auth
 !
NULL
) {

402 
«me
 = 
	`auth«me
(
auth
);

403 
mëhod
 = 
	`mëhod2°rög
(
auth
->method);

405 #i‡
HAVE_GSSAPI


406 i‡(
auth
->
mëhod
 =
AUTHMETHOD_GSSAPI
)

407 
mëhodöfo


408 
	`gsßpùrŸe˘i⁄2°rög
(
auth
->
md©a
.
gsßpi
.
°©e
.
¥Ÿe˘i⁄
);

412 
«me
 = 
mëhod
 = 
NULL
;

414 i‡(
«me
 =
NULL
 || *«mê=
NUL
)

415 *
öfo
 = 
NUL
;

417 
	`¢¥ötf
(
öfo
, 
öfﬁí
, "%s%s%s%%%s@",

418 
mëhod
,

419 
mëhodöfo
 =
NULL
 ? "" : "/",

420 
mëhodöfo
 =
NULL
 ? "" : methodinfo,

421 
«me
);

423  
öfo
;

424 
	}
}

	@lib/parse_util.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 
∑rsögc⁄fig
;

50 *
©y≥
;

51 
yylöío
;

52 *
yyãxt
;

55 
gë∑rsögîr‹
(*
buf
, c⁄° 
size_t
 
buÊí
);

63 
	$yyîr‹
(c⁄° *
fmt
, ...)

65 
va_li°
 
≠
;

66 
buf
[2048];

67 
size_t
 
bufu£d
;

69 i‡(
∑rsögc⁄fig
) {

70 
¥efix
[512];

72 
bufu£d
 = 
	`¢¥ötf
(
buf
, (buf), "%s: ",

73 
	`gë∑rsögîr‹
(
¥efix
, (prefix)));

76 
bufu£d
 = 0;

78 
	`va_°¨t
(
≠
, 
fmt
);

79 
	`v¢¥ötf
(&
buf
[
bufu£d
], (bufË- bufu£d, 
fmt
, 
≠
);

80 
	`va_íd
(
≠
);

82 i‡(
î∫o
 == 0)

83 
	`£ºx
("%s. PÀa£ sìÅhê%†m™uÆ f‹ m‹êöf‹m©i⁄", 
buf
, 
PRODUCT
);

85 
	`£ºx
("%s: %s. Please seeÅhe %s manual for more information",

86 
buf
, 
	`°ªº‹
(
î∫o
), 
PRODUCT
);

87 
	}
}

90 
	$yyîr‹x
(c⁄° *
fmt
, ...)

92 
va_li°
 
≠
;

93 
buf
[2048];

94 
size_t
 
bufu£d
;

96 i‡(
∑rsögc⁄fig
) {

97 
¥efix
[512];

99 
bufu£d
 = 
	`¢¥ötf
(
buf
, (buf), "%s: ",

100 
	`gë∑rsögîr‹
(
¥efix
, (prefix)));

103 
bufu£d
 = 0;

105 
	`va_°¨t
(
≠
, 
fmt
);

106 
	`v¢¥ötf
(&
buf
[
bufu£d
], (bufË- bufu£d, 
fmt
, 
≠
);

107 
	`va_íd
(
≠
);

109 
	`£ºx
("%s. PÀa£ sìÅhê%†m™uÆ f‹ m‹êöf‹m©i⁄", 
buf
, 
PRODUCT
);

110 
	}
}

113 
	$yyw¨n
(c⁄° *
fmt
, ...)

115 
va_li°
 
≠
;

116 
buf
[2048];

117 
size_t
 
bufu£d
;

119 i‡(
∑rsögc⁄fig
) {

120 
¥efix
[512];

122 
bufu£d
 = 
	`¢¥ötf
(
buf
, (buf), "%s: ",

123 
	`gë∑rsögîr‹
(
¥efix
, (prefix)));

126 
bufu£d
 = 0;

128 
	`va_°¨t
(
≠
, 
fmt
);

129 
	`v¢¥ötf
(&
buf
[
bufu£d
], (bufË- bufu£d, 
fmt
, 
≠
);

130 
	`va_íd
(
≠
);

132 i‡(
î∫o
 == 0)

133 
	`sw¨nx
("%s. Please seeÅhe %s manual for more information",

134 
buf
, 
PRODUCT
);

136 
	`sw¨nx
("%s. %s. Please seeÅhe %s manual for more information",

137 
buf
, 
	`°ªº‹
(
î∫o
), 
PRODUCT
);

138 
	}
}

141 
	$yyw¨nx
(c⁄° *
fmt
, ...)

143 
va_li°
 
≠
;

144 
buf
[2048];

145 
size_t
 
bufu£d
;

147 i‡(
∑rsögc⁄fig
) {

148 
¥efix
[512];

150 
bufu£d
 = 
	`¢¥ötf
(
buf
, (buf), "%s: ",

151 
	`gë∑rsögîr‹
(
¥efix
, (prefix)));

154 
bufu£d
 = 0;

156 
	`va_°¨t
(
≠
, 
fmt
);

157 
	`v¢¥ötf
(&
buf
[
bufu£d
], (bufË- bufu£d, 
fmt
, 
≠
);

158 
	`va_íd
(
≠
);

160 
	`sw¨nx
("%s. PÀa£ sìÅhê%†m™uÆ f‹ m‹êöf‹m©i⁄", 
buf
, 
PRODUCT
);

161 
	}
}

164 
	$yylog
(c⁄° 
logÀvñ
, c⁄° *
fmt
, ...)

166 
va_li°
 
≠
;

167 
buf
[2048];

168 
size_t
 
bufu£d
;

170 i‡(
∑rsögc⁄fig
) {

171 
¥efix
[512];

173 
bufu£d
 = 
	`¢¥ötf
(
buf
, (buf), "%s: ",

174 
	`gë∑rsögîr‹
(
¥efix
, (prefix)));

177 
bufu£d
 = 0;

179 
	`va_°¨t
(
≠
, 
fmt
);

180 
	`v¢¥ötf
(&
buf
[
bufu£d
], (bufË- bufu£d, 
fmt
, 
≠
);

181 
	`va_íd
(
≠
);

183 
	`¶og
(
logÀvñ
, "%s. Please seeÅhe %s manual for more information",

184 
buf
, 
PRODUCT
);

185 
	}
}

189 
	$yyîr‹x_ha¢ëmask
()

192 
	`yyîr‹x
("AÇetmask has been specified forÅhis %s, butÇoÇetmask "

194 
	`©y≥2°rög
(*
©y≥
));

195 
	}
}

198 
	$yyîr‹x_n⁄ëmask
()

201 
	`yyîr‹x
("NoÇetmask has been specified forÅhis %s, butáÇetmask "

205 
	`©y≥2°rög
(*
©y≥
));

206 
	}
}

209 
	$yyîr‹x_nﬁib
(
libøry
)

210 c⁄° *
libøry
;

213 
	`yyîr‹x
("in orderÅo setÅhe given keyword/value, %s must beÜinked "

220 
PRODUCT
,

221 
libøry
,

222 
PRODUCT
,

223 
libøry
,

224 
libøry
,

225 
PRODUCT
,

226 
PRODUCT
);

227 
	}
}

230 
	$yyw¨nx_dïªˇãd
(
ﬁdkeyw‹d
, 
√wkeyw‹d
)

231 c⁄° *
ﬁdkeyw‹d
;

232 c⁄° *
√wkeyw‹d
;

235 i‡(
√wkeyw‹d
 =
NULL
)

236 
	`yyw¨nx
("keyword \"%s\" is deprecatedándÇoÜonger used. "

238 
ﬁdkeyw‹d
, 
PRODUCT
, 
sockscf
.
›ti⁄
.
c⁄figfûe
);

240 
	`yyw¨nx
("keyword \"%s\" is deprecated -ássumingÅheÇew keyword \"%s\" "

243 
ﬁdkeyw‹d
,

244 
√wkeyw‹d
,

245 
PRODUCT
,

246 
sockscf
.
›ti⁄
.
c⁄figfûe
);

247 
	}
}

251 
	$gë∑rsögîr‹
(
buf
, 
buÊí
)

252 *
buf
;

253 c⁄° 
size_t
 
buÊí
;

256 c⁄° *
°rù
 = " \n\t";

257 
visbuf1
[100], 
visbuf2
[(visbuf1)], 
yyãxtvis
[100],

258 *
l1
 = 
¥eviou¶exlöe
, *
l2
 = 
cuºíéexlöe
;

260 
	`SKIPLEADING
(
l1
, 
°rù
);

261 
	`STRIPTRAILING
(
l1
, 
	`°æí
÷1), 
°rù
);

263 
	`SKIPLEADING
(
l2
, 
°rù
);

264 
	`STRIPTRAILING
(
l2
, 
	`°æí
÷2), 
°rù
);

266 
	`¢¥öt‚
(
buf
, 
buÊí
,

268 
sockscf
.
›ti⁄
.
c⁄figfûe
,

269 
yylöío
,

270 
	`°r2vis
(
l1
, 
	`°æí
÷1), 
visbuf1
, (visbuf1)),

271 
	`°r2vis
(
l2
, 
	`°æí
÷2), 
visbuf2
, (visbuf2)),

272 (
yyãxt
 =
NULL
 || *yyãxà=
NUL
) ?

273 "<°¨ào‡löe>" : 
	`°r2vis
(
yyãxt
,

274 
	`°æí
(
yyãxt
),

275 
yyãxtvis
,

276 (
yyãxtvis
)));

278 
yyãxtvis
[100];

280 
	`¢¥öt‚
(
buf
, 
buÊí
,

282 
sockscf
.
›ti⁄
.
c⁄figfûe
,

283 
yylöío
,

284 (
yyãxt
 =
NULL
 || *yyãxà=
NUL
) ?

285 "'°¨ào‡löe'" : 
	`°r2vis
(
yyãxt
,

286 
	`°æí
(
yyãxt
),

287 
yyãxtvis
,

288 (
yyãxtvis
)));

291  
buf
;

292 
	}
}

	@lib/protocol.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$socksho°2mem
(
ho°
, 
mem
, 
vîsi⁄
)

52 c⁄° 
socksho°_t
 *
ho°
;

53 *
mem
;

54 
vîsi⁄
;

57 
vîsi⁄
) {

58 
PROXY_SOCKS_V4
:

59 
PROXY_SOCKS_V4REPLY_VERSION
:

60 
	`SASSERTX
(
ho°
->
©y≥
 =
SOCKS_ADDR_IPV4
);

63 
	`mem˝y
(
mem
, &
ho°
->
p‹t
, (host->port));

64 
mem
 +(
ho°
->
p‹t
);

67 
	`mem˝y
(
mem
, &
ho°
->
addr
.
ùv4
, (host->addr.ipv4));

68 
mem
 +(
ho°
->
addr
.
ùv4
);

72 
PROXY_SOCKS_V5
:

74 
	`mem˝y
(
mem
, &
ho°
->
©y≥
, (host->atype));

75 
mem
 +(
ho°
->
©y≥
);

77 
ho°
->
©y≥
) {

78 
SOCKS_ADDR_IPV4
:

79 
	`mem˝y
(
mem
, &
ho°
->
addr
.
ùv4
.
s_addr
,

80 (
ho°
->
addr
.
ùv4
.
s_addr
));

81 
mem
 +(
ho°
->
addr
.
ùv4
.
s_addr
);

84 
SOCKS_ADDR_IPV6
:

85 
	`mem˝y
(
mem
, &
ho°
->
addr
.
ùv6
.
ù
, (host->addr.ipv6.ip));

86 
mem
 +(
ho°
->
addr
.
ùv6
.
ù
);

89 
SOCKS_ADDR_DOMAIN
:

91 *
mem
 = ()
	`°æí
(
ho°
->
addr
.
domaö
);

93 
	`mem˝y
(
mem
 + 1, 
ho°
->
addr
.
domaö
, (
size_t
)*mem);

94 
mem
 += *mem + 1;

98 
	`SERRX
(
ho°
->
©y≥
);

102 
	`mem˝y
(
mem
, &
ho°
->
p‹t
, (host->port));

103 
mem
 +(
ho°
->
p‹t
);

108 
	`SERRX
(
vîsi⁄
);

111  
mem
;

112 
	}
}

115 
	$mem2socksho°
(
ho°
, 
mem
, 
Àn
, 
vîsi⁄
)

116 
socksho°_t
 *
ho°
;

117 c⁄° *
mem
;

118 
size_t
 
Àn
;

119 
vîsi⁄
;

121 c⁄° *
fun˘i⁄
 = "mem2sockshost()";

123 
vîsi⁄
) {

124 
PROXY_SOCKS_V5
:

125 i‡(
Àn
 < 
MINSOCKSHOSTLEN
)

126  
NULL
;

128 i‡(
Àn
 < (
ho°
->
©y≥
))

129  
NULL
;

131 
	`mem˝y
(&
ho°
->
©y≥
, 
mem
, (host->atype));

132 
mem
 +(
ho°
->
©y≥
);

133 
Àn
 -(
ho°
->
©y≥
);

135 
ho°
->
©y≥
) {

136 
SOCKS_ADDR_IPV4
:

137 i‡(
Àn
 < (
ho°
->
addr
.
ùv4
))

138  
NULL
;

140 
	`mem˝y
(&
ho°
->
addr
.
ùv4
, 
mem
, (host->addr.ipv4));

141 
mem
 +(
ho°
->
addr
.
ùv4
);

142 
Àn
 -(
ho°
->
addr
.
ùv4
);

145 
SOCKS_ADDR_DOMAIN
: {

146 
size_t
 
domaöÀn
 = (size_t)*
mem
;

148 
mem
 += (*mem);

150 
	`OCTETIFY
(
domaöÀn
);

152 i‡(
Àn
 < 
domaöÀn
 + 1)

153  
NULL
;

155 
	`SASSERTX
(
domaöÀn
 < (
ho°
->
addr
.
domaö
));

157 
	`mem˝y
(
ho°
->
addr
.
domaö
, 
mem
, 
domaöÀn
);

158 
ho°
->
addr
.
domaö
[
domaöÀn
] = 
NUL
;

159 
mem
 +
domaöÀn
;

160 
Àn
 -
domaöÀn
 + 1;

164 
SOCKS_ADDR_IPV6
:

165 i‡(
Àn
 < (
ho°
->
addr
.
ùv6
.
ù
))

166  
NULL
;

168 
	`mem˝y
(&
ho°
->
addr
.
ùv6
.
ù
, 
mem
, (host->addr.ipv6.ip));

169 
mem
 +(
ho°
->
addr
.
ùv6
.
ù
);

170 
Àn
 -(
ho°
->
addr
.
ùv6
.
ù
);

172 
ho°
->
addr
.
ùv6
.
sc›eid
 = 0;

177 
	`¶og
(
LOG_NEGOTIATE
, "%s: unknownátype value: %d",

178 
fun˘i⁄
, 
ho°
->
©y≥
);

179  
NULL
;

182 i‡(
Àn
 < (
ho°
->
p‹t
))

183  
NULL
;

185 
	`mem˝y
(&
ho°
->
p‹t
, 
mem
, (host->port));

186 
mem
 +(
ho°
->
p‹t
);

187 
Àn
 -(
ho°
->
p‹t
);

192 
	`SERRX
(
vîsi⁄
);

195  
mem
;

196 
	}
}

199 
	$socks_£t_ª•⁄£vÆue
(
ª•⁄£
, 
vÆue
)

200 
ª•⁄£_t
 *
ª•⁄£
;

201 
vÆue
;

204 
ª•⁄£
->
vîsi⁄
) {

205 
PROXY_SOCKS_V4REPLY_VERSION
:

206 
PROXY_SOCKS_V5
:

207 
ª•⁄£
->
ª∂y
.
socks
 = ()
vÆue
;

210 
PROXY_UPNP
:

211 
ª•⁄£
->
ª∂y
.
u≤p
 = ()
vÆue
;

214 
PROXY_HTTP_10
:

215 
PROXY_HTTP_11
:

216 
ª•⁄£
->
ª∂y
.
hâp
 = ()
vÆue
;

220 
	`SERRX
(
ª•⁄£
->
vîsi⁄
);

222 
	}
}

225 
	$socks_gë_ª•⁄£vÆue
(
ª•⁄£
)

226 c⁄° 
ª•⁄£_t
 *
ª•⁄£
;

229 
ª•⁄£
->
vîsi⁄
) {

230 
PROXY_SOCKS_V4REPLY_VERSION
:

231 
PROXY_SOCKS_V5
:

232  
ª•⁄£
->
ª∂y
.
socks
;

234 
PROXY_UPNP
:

235  
ª•⁄£
->
ª∂y
.
u≤p
;

237 
PROXY_HTTP_10
:

238 
PROXY_HTTP_11
:

239  
ª•⁄£
->
ª∂y
.
hâp
;

242 
	`SERRX
(
ª•⁄£
->
vîsi⁄
);

246 
	}
}

249 
	$¥oxy¥Ÿocﬁisknown
(
vîsi⁄
)

250 c⁄° 
vîsi⁄
;

253 
vîsi⁄
) {

255 
PROXY_SOCKS_V4
:

256 
PROXY_SOCKS_V5
:

257 
PROXY_UPNP
:

258 
PROXY_HTTP_10
:

259 
PROXY_HTTP_11
:

265 
	}
}

268 
	$authmëhodisknown
(
mëhod
)

269 c⁄° 
mëhod
;

272 
mëhod
) {

273 
AUTHMETHOD_NOTSET
:

274 
AUTHMETHOD_NONE
:

275 
AUTHMETHOD_GSSAPI
:

276 
AUTHMETHOD_UNAME
:

277 
AUTHMETHOD_NOACCEPT
:

278 
AUTHMETHOD_RFC931
:

279 
AUTHMETHOD_PAM_ANY
:

280 
AUTHMETHOD_PAM_ADDRESS
:

281 
AUTHMETHOD_PAM_USERNAME
:

282 
AUTHMETHOD_BSDAUTH
:

288 
	}
}

291 
	$ch¨mëhod2ötmëhod
(
mëhodc
, 
ch¨mëhodv
, 
ötmëhodv
)

292 c⁄° 
size_t
 
mëhodc
;

293 c⁄° 
ch¨mëhodv
[];

294 
ötmëhodv
[];

296 
size_t
 
i
;

298 
i
 = 0; i < 
mëhodc
; ++i)

299 
ötmëhodv
[
i
] = ()
ch¨mëhodv
[i];

301  
ötmëhodv
;

302 
	}
}

	@lib/serr.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$£º
(c⁄° *
fmt
, ...)

54 i‡(
fmt
 !
NULL
) {

55 
va_li°
 
≠
;

56 
ssize_t
 
bufu£d
;

57 
buf
[2048];

59 
	`va_°¨t
(
≠
, 
fmt
);

60 
bufu£d
 = 
	`v¢¥ötf
(
buf
, (buf), 
fmt
, 
≠
);

61 
	`va_íd
(
≠
);

63 i‡(
bufu£d
 >(
ssize_t
)(
buf
)) {

64 
bufu£d
 = (
buf
) - 1;

65 
buf
[
bufu£d
] = 
NUL
;

68 
	`SASSERTX
(
buf
[
bufu£d
] =
NUL
);

70 i‡(
î∫o
 != 0)

71 
	`¢¥ötf
(&
buf
[
bufu£d
], (buf) - bufused,

72 ": %s", 
	`°ªº‹
(
î∫o
));

74 
	`¶og
(
LOG_ERR
, "%s", 
buf
);

77 #i‡
SOCKS_CLIENT


78 
	`exô
(
EXIT_FAILURE
);

80 
	`sockdexô
(
EXIT_FAILURE
);

82 
	}
}

85 
	$£ºx
(c⁄° *
fmt
, ...)

88 i‡(
fmt
 !
NULL
) {

89 
va_li°
 
≠
, 
≠c›y
;

91 
	`va_°¨t
(
≠
, 
fmt
);

92 
	`va_°¨t
(
≠c›y
, 
fmt
);

94 
	`v¶og
(
LOG_ERR
, 
fmt
, 
≠
, 
≠c›y
);

97 
	`va_íd
(
≠c›y
);

98 
	`va_íd
(
≠
);

101 #i‡
SOCKS_CLIENT


102 
	`exô
(
EXIT_FAILURE
);

104 
	`sockdexô
(
EXIT_FAILURE
);

106 
	}
}

109 
	$sw¨n
(c⁄° *
fmt
, ...)

112 i‡(
fmt
 !
NULL
) {

113 
va_li°
 
≠
;

114 
buf
[2048];

115 
ssize_t
 
bufu£d
;

117 
	`va_°¨t
(
≠
, 
fmt
);

118 
bufu£d
 = 
	`v¢¥ötf
(
buf
, (buf), 
fmt
, 
≠
);

119 
	`va_íd
(
≠
);

121 i‡(
bufu£d
 >(
ssize_t
)(
buf
)) {

122 
bufu£d
 = (
buf
) - 1;

123 
buf
[
bufu£d
] = 
NUL
;

126 i‡(
î∫o
 != 0)

127 
	`¢¥ötf
(&
buf
[
bufu£d
], (buf) - bufused,

128 ": %s", 
	`°ªº‹
(
î∫o
));

130 
	`¶og
(
LOG_WARNING
, "%s", 
buf
);

133 
	}
}

136 
	$sw¨nx
(c⁄° *
fmt
, ...)

139 i‡(
fmt
 !
NULL
) {

140 
va_li°
 
≠
, 
≠c›y
;

143 
	`va_°¨t
(
≠
, 
fmt
);

144 
	`va_°¨t
(
≠c›y
, 
fmt
);

146 
	`v¶og
(
LOG_WARNING
, 
fmt
, 
≠
, 
≠c›y
);

149 
	`va_íd
(
≠c›y
);

150 
	`va_íd
(
≠
);

152 
	}
}

	@lib/showconfig.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$showtimeout
(
timeout
)

52 c⁄° 
timeout_t
 *
timeout
;

55 
	`¶og
(
LOG_DEBUG
, "connectÅimeout: %lds%s",

56 ()
timeout
->
c⁄√˘
,

57 
timeout
->
c⁄√˘
 == 0 ? " (use kernel default)": "");

59 #i‡!
SOCKS_CLIENT


60 
	`¶og
(
LOG_DEBUG
, "negotiateÅimeout: %lds%s",

61 ()
timeout
->
√gŸüã
,

62 
timeout
->
√gŸüã
 == 0 ? " (use kernel default)" : "");

64 
	`¶og
(
LOG_DEBUG
, "i/oÅimeout:Åcp: %lds, udp: %lds",

65 ()
timeout
->
t˝io
, (Èimeout->
udpio
);

67 
	`¶og
(
LOG_DEBUG
, "tcp fin-wait-2Åimeout: %lds%s",

68 ()
timeout
->
t˝_fö_waô
,

69 
timeout
->
t˝_fö_waô
 == 0 ? " (use kernel default)" : "");

72 
	}
}

75 
	$show°©e
(
°©e
)

76 c⁄° 
£rvî°©e_t
 *
°©e
;

78 
buf
[1024];

79 
size_t
 
bufu£d
;

81 
	`¶og
(
LOG_DEBUG
, "command(s): %s",

82 
	`comm™ds2°rög
(&
°©e
->
comm™d
, 
buf
, (buf)));

84 
bufu£d
 = 
	`¢¥ötf
(
buf
, (buf), "extension(s): ");

85 i‡(
°©e
->
exãnsi⁄
.
böd
)

86 
	`¢¥ötf
(&
buf
[
bufu£d
], (buf) - bufused, "bind");

87 
	`¶og
(
LOG_DEBUG
, "%s", 
buf
);

89 
bufu£d
 = 
	`¢¥ötf
(
buf
, (buf), "protocol(s): ");

90 
	`¥Ÿocﬁs2°rög
(&
°©e
->
¥Ÿocﬁ
,

91 &
buf
[
bufu£d
], (buf) - bufused);

92 
	`¶og
(
LOG_DEBUG
, "%s", 
buf
);

94 
	`showmëhod
(
obje˘_¸uÀ
, 
°©e
->
cmëhodc
, sèã->
cmëhodv
);

95 
	`showmëhod
(
obje˘_§uÀ
, 
°©e
->
smëhodc
, sèã->
smëhodv
);

97 
	`¶og
(
LOG_DEBUG
, "proxyprotocol(s): %s",

98 
	`¥oxy¥Ÿocﬁs2°rög
(&
°©e
->
¥oxy¥Ÿocﬁ
, 
buf
, (buf)));

100 #i‡
HAVE_GSSAPI


101 i‡(
	`mëhodis£t
(
AUTHMETHOD_GSSAPI
, 
°©e
->
smëhodv
, sèã->
smëhodc
)) {

102 i‡(*
°©e
->
gsßpi£rvi˚«me
 !
NUL
)

103 
	`¶og
(
LOG_DEBUG
, "gsßpi.£rvi˚«me: %s", 
°©e
->
gsßpi£rvi˚«me
);

105 i‡(*
°©e
->
gsßpikeyèb
 !
NUL
)

106 
	`¶og
(
LOG_DEBUG
, "gsßpi.keyèb: %s", 
°©e
->
gsßpikeyèb
);

108 i‡(
°©e
->
gsßpõn¸y±i⁄
.
˛ór


109 || 
°©e
->
gsßpõn¸y±i⁄
.
öãgrôy


110 || 
°©e
->
gsßpõn¸y±i⁄
.
c⁄fidítülôy


111 || 
°©e
->
gsßpõn¸y±i⁄
.
≥rmesßge
)

112 
	`¶og
(
LOG_DEBUG
, "gssapi.encryption:%s%s%s%s",

113 
°©e
->
gsßpõn¸y±i⁄
.
˛ór
? " clear" :"",

114 
°©e
->
gsßpõn¸y±i⁄
.
öãgrôy
? " integrity" :"",

115 
°©e
->
gsßpõn¸y±i⁄
.
c⁄fidítülôy
? " confidentiality" :"",

116 
°©e
->
gsßpõn¸y±i⁄
.
≥rmesßge
? "Öermessage" :"");

118 i‡(
°©e
->
gsßpõn¸y±i⁄
.
√c
)

119 
	`¶og
(
LOG_DEBUG
, "clientcompatibility:ÇecgssapiÉnabled");

122 
	}
}

125 
	$showmëhod
(
ty≥
, 
mëhodc
, 
mëhodv
)

126 
obje˘ty≥_t
 
ty≥
;

127 
size_t
 
mëhodc
;

128 c⁄° *
mëhodv
;

130 
buf
[1024];

132 
	`¶og
(
LOG_DEBUG
, "%s(s): %s",

133 
ty≥
 =
obje˘_¸uÀ
 ? "clientmethod" : "socksmethod",

134 
	`mëhods2°rög
(
mëhodc
, 
mëhodv
, 
buf
, (buf)));

135 
	}
}

138 
	$showc⁄fig
(
sockscf
)

139 c⁄° 
c⁄fig
 *
sockscf
;

141 #i‡!
SOCKS_CLIENT


142 
fú°time
 = 1;

143 
size_t
 
bufu£d
;

144 #i‡
HAVE_SCHED_SETAFFINITY


145 
size_t
 
£tsize
;

149 
buf
[4096];

150 
size_t
 
i
;

152 #i‡!
SOCKS_CLIENT


153 
	`¶og
(
LOG_DEBUG
, "cmdline options:\n%s",

154 
	`›ti⁄s2°rög
(&
sockscf
->
›ti⁄
, "", 
buf
, (buf)));

156 
	`¶og
(
LOG_DEBUG
, "address-familiesÅoÜook for on internal interface: %s",

157 
	`öãrÁ˚¥Ÿocﬁ2°rög
(&
sockscf
->
öã∫Æ
.
¥Ÿocﬁ
, 
NULL
, 0));

159 
	`¶og
(
LOG_DEBUG
, "internaláddresses (%lu):",

160 ()
sockscf
->
öã∫Æ
.
addrc
);

161 
i
 = 0; i < 
sockscf
->
öã∫Æ
.
addrc
; ++i)

162 
	`¶og
(
LOG_DEBUG
, "\t%s %s",

163 
	`¥Ÿocﬁ2°rög
(
sockscf
->
öã∫Æ
.
addrv
[
i
].
¥Ÿocﬁ
),

164 
	`sockaddr2°rög2
(&
sockscf
->
öã∫Æ
.
addrv
[
i
].
addr
,

165 
ADDRINFO_ATYPE
 | 
ADDRINFO_PORT
,

166 
NULL
,

169 #i‡
HAVE_SCHED_SETSCHEDULER


170 
bufu£d
 = 0;

171 i‡(
sockscf
->
˝u
.
mŸhî
.
schedulög_is£t
)

172 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

174 
	`chûdty≥2°rög
(
PROC_MOTHER
),

175 
	`numîic2˝upﬁicy
(
sockscf
->
˝u
.
mŸhî
.
pﬁicy
),

176 
sockscf
->
˝u
.
mŸhî
.
∑øm
.
sched_¥i‹ôy
);

178 i‡(
sockscf
->
˝u
.
m⁄ô‹
.
schedulög_is£t
)

179 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

181 
	`chûdty≥2°rög
(
PROC_MONITOR
),

182 
	`numîic2˝upﬁicy
(
sockscf
->
˝u
.
m⁄ô‹
.
pﬁicy
),

183 
sockscf
->
˝u
.
m⁄ô‹
.
∑øm
.
sched_¥i‹ôy
);

186 i‡(
sockscf
->
˝u
.
√gŸüã
.
schedulög_is£t
)

187 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

189 
	`chûdty≥2°rög
(
PROC_NEGOTIATE
),

190 
	`numîic2˝upﬁicy
(
sockscf
->
˝u
.
√gŸüã
.
pﬁicy
),

191 
sockscf
->
˝u
.
√gŸüã
.
∑øm
.
sched_¥i‹ôy
);

193 i‡(
sockscf
->
˝u
.
ªque°
.
schedulög_is£t
)

194 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

196 
	`chûdty≥2°rög
(
PROC_REQUEST
),

197 
	`numîic2˝upﬁicy
(
sockscf
->
˝u
.
ªque°
.
pﬁicy
),

198 
sockscf
->
˝u
.
ªque°
.
∑øm
.
sched_¥i‹ôy
);

200 i‡(
sockscf
->
˝u
.
io
.
schedulög_is£t
)

201 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

203 
	`chûdty≥2°rög
(
PROC_IO
),

204 
	`numîic2˝upﬁicy
(
sockscf
->
˝u
.
io
.
pﬁicy
),

205 
sockscf
->
˝u
.
io
.
∑øm
.
sched_¥i‹ôy
);

207 i‡(
bufu£d
 != 0)

208 
	`¶og
(
LOG_DEBUG
, "˝u schedulög sëtögs: %s", 
buf
);

211 #i‡
HAVE_SCHED_SETAFFINITY


212 
bufu£d
 = 0;

213 
£tsize
 = 
	`˝u_gë_£tsize
();

214 i‡(
sockscf
->
˝u
.
mŸhî
.
afföôy_is£t
) {

215 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused, "%s: ",

216 
	`chûdty≥2°rög
(
PROC_MOTHER
));

218 
i
 = 0; i < 
£tsize
; ++i)

219 i‡(
	`˝u_is£t
(
i
, &
sockscf
->
˝u
.
mŸhî
.
mask
))

220 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

221 "%d ", ()
i
);

224 i‡(
sockscf
->
˝u
.
m⁄ô‹
.
afföôy_is£t
) {

225 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused, "%s%s: ",

226 
bufu£d
 ? ", " : "",

227 
	`chûdty≥2°rög
(
PROC_MONITOR
));

229 
i
 = 0; i < 
£tsize
; ++i)

230 i‡(
	`˝u_is£t
(
i
, &
sockscf
->
˝u
.
m⁄ô‹
.
mask
))

231 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

232 "%d ", ()
i
);

235 i‡(
sockscf
->
˝u
.
√gŸüã
.
afföôy_is£t
) {

236 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused, "%s%s: ",

237 
bufu£d
 ? ", " : "",

238 
	`chûdty≥2°rög
(
PROC_NEGOTIATE
));

240 
i
 = 0; i < 
£tsize
; ++i)

241 i‡(
	`˝u_is£t
(
i
, &
sockscf
->
˝u
.
√gŸüã
.
mask
))

242 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

243 "%d ", ()
i
);

246 i‡(
sockscf
->
˝u
.
ªque°
.
afföôy_is£t
) {

247 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused, "%s%s: ",

248 
bufu£d
 ? ", " : "",

249 
	`chûdty≥2°rög
(
PROC_REQUEST
));

251 
i
 = 0; i < 
£tsize
; ++i)

252 i‡(
	`˝u_is£t
(
i
, &
sockscf
->
˝u
.
ªque°
.
mask
))

253 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

254 "%d ", ()
i
);

257 i‡(
sockscf
->
˝u
.
io
.
afföôy_is£t
) {

258 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused, "%s%s: ",

259 
bufu£d
 ? ", " : "",

260 
	`chûdty≥2°rög
(
PROC_IO
));

262 
i
 = 0; i < 
£tsize
; ++i)

263 i‡(
	`˝u_is£t
(
i
, &
sockscf
->
˝u
.
io
.
mask
))

264 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

265 "%d ", ()
i
);

268 i‡(
bufu£d
 != 0)

269 
	`¶og
(
LOG_DEBUG
, "˝uáfföôy sëtögs: %s", 
buf
);

272 
	`¶og
(
LOG_DEBUG
, "global socket options onÅhe internal side:");

273 
i
 = 0; i < 
sockscf
->
sockë›ti⁄c
; ++i)

274 i‡(
sockscf
->
sockë›ti⁄v
[
i
].
isöã∫Æside
)

275 
	`¶og
(
LOG_DEBUG
, " option #%lu: %s, value %s\n",

276 ()
i
,

277 
	`sock›t2°rög
(&
sockscf
->
sockë›ti⁄v
[
i
], 
NULL
, 0),

278 
	`sock›tvÆ2°rög
(
sockscf
->
sockë›ti⁄v
[
i
].
›tvÆ
,

279 
sockscf
->
sockë›ti⁄v
[
i
].
›ây≥
,

280 
NULL
,

284 
	`¶og
(
LOG_DEBUG
, "address-familiesÅoÜook for onÉxternal interface: %s",

285 
	`öãrÁ˚¥Ÿocﬁ2°rög
(&
sockscf
->
exã∫Æ
.
¥Ÿocﬁ
, 
NULL
, 0));

287 
	`¶og
(
LOG_DEBUG
, "externaláddresses (%lu):",

288 ()
sockscf
->
exã∫Æ
.
addrc
);

289 
i
 = 0; i < 
sockscf
->
exã∫Æ
.
addrc
; ++i) {

290 
	`¶og
(
LOG_DEBUG
, "\t%s",

291 
	`ruÀaddr2°rög
(&
sockscf
->
exã∫Æ
.
addrv
[
i
],

292 
ADDRINFO_ATYPE
,

293 
NULL
,

297 
	`¶og
(
LOG_DEBUG
, "\thave IPv4 onÉxternaláddressÜist? %s. IPv6? %s",

298 
	`exã∫Æ_has_ßÁmûy
(
AF_INET
) ? "Yes" : "No",

299 
	`exã∫Æ_has_ßÁmûy
(
AF_INET6
) ?

300 
	`exã∫Æ_has_globÆ_ßÁmûy
(
AF_INET6
) ?

304 
	`¶og
(
LOG_DEBUG
, "global socket options onÅheÉxternal side:");

305 
i
 = 0; i < 
sockscf
->
sockë›ti⁄c
; ++i)

306 i‡(!
sockscf
->
sockë›ti⁄v
[
i
].
isöã∫Æside
)

307 
	`¶og
(
LOG_DEBUG
, " option #%lu: %s, value %s\n",

308 ()
i
,

309 
	`sock›t2°rög
(&
sockscf
->
sockë›ti⁄v
[
i
], 
NULL
, 0),

310 
	`sock›tvÆ2°rög
(
sockscf
->
sockë›ti⁄v
[
i
].
›tvÆ
,

311 
sockscf
->
sockë›ti⁄v
[
i
].
›ây≥
, 
NULL
, 0));

313 
	`¶og
(
LOG_DEBUG
, "externaláddressÑotation: %s",

314 
	`rŸ©i⁄2°rög
(
sockscf
->
exã∫Æ
.
rŸ©i⁄
));

316 
	`¶og
(
LOG_DEBUG
, "compatibility options: %s",

317 
	`com∑ts2°rög
(&
sockscf
->
com∑t
, 
buf
, (buf)));

319 
	`¶og
(
LOG_DEBUG
, "extensionsÉnabled: %s",

320 
	`exãnsi⁄s2°rög
(&
sockscf
->
exãnsi⁄
, 
buf
, (buf)));

322 
	`¶og
(
LOG_DEBUG
, "connect udp socketsÅo destination: %s",

323 
sockscf
->
udpc⁄√˘d°
 ? "yes" : "no");

325 
	`showlog•ecül
(&
sockscf
->
öã∫Æ
.
log
, 
INTERNALIF
);

326 
	`showlog•ecül
(&
sockscf
->
exã∫Æ
.
log
, 
EXTERNALIF
);

330 
	`¶og
(
LOG_DEBUG
, "logoutput goesÅo: %s",

331 
	`logty≥s2°rög
(&
sockscf
->
log
, 
buf
, (buf)));

333 
	`¶og
(
LOG_DEBUG
, "resolveprotocol: %s",

334 
	`ªsﬁvïrŸocﬁ2°rög
(
sockscf
->
ªsﬁvïrŸocﬁ
));

336 
	`showtimeout
(&
sockscf
->
timeout
);

338 
	`¶og
(
LOG_DEBUG
, "globalÑoute options: %s",

339 
	`rouã›ti⁄s2°rög
(&
sockscf
->
rouã›ti⁄s
, 
buf
, (buf)));

341 
	`¶og
(
LOG_DEBUG
, "directÑoute fallback: %s",

342 
sockscf
->
›ti⁄
.
dúe˘ÁŒback
 ? "enabled" : "disabled");

344 #i‡!
SOCKS_CLIENT


345 
	`§cho°s2°rög
(&
sockscf
->
§cho°
, "", 
buf
, (buf));

346 i‡(*
buf
 !
NUL
)

347 
	`¶og
(
LOG_DEBUG
, "§cho°:\n%s", 
buf
);

349 #i‡
COVENANT


350 
	`¶og
(
LOG_DEBUG
, "¥oxyÑólm: %s", 
sockscf
->
ªÆm«me
);

353 #i‡
HAVE_LIBWRAP


354 i‡(
sockscf
->
›ti⁄
.
ho°s_ac˚ss
)

355 
	`¶og
(
LOG_DEBUG
, "libwrap.hosts_access: yes");

357 
	`¶og
(
LOG_DEBUG
, "libwrap.hosts_access:Ço");

360 #i‡!
HAVE_PRIVILEGES


361 
	`¶og
(
LOG_DEBUG
, "euid: %d", ()
sockscf
->
öôül
.
euid
);

363 
	`¶og
(
LOG_DEBUG
, "userid:\n%s",

364 
	`u£rids2°rög
(&
sockscf
->
uid
, "", 
buf
, (buf)));

367 
bufu£d
 = 
	`¢¥ötf
(
buf
, (buf), "clientmethod(s): ");

368 
i
 = 0; (
size_t
)ò< 
sockscf
->
cmëhodc
; ++i)

369 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused, "%s%s",

370 
i
 > 0 ? ", " : "", 
	`mëhod2°rög
(
sockscf
->
cmëhodv
[i]));

372 
	`¶og
(
LOG_DEBUG
, "%s", 
buf
);

374 
bufu£d
 = 
	`¢¥ötf
(
buf
, (buf), "socksmethod(s): ");

375 
i
 = 0; (
size_t
)ò< 
sockscf
->
smëhodc
; ++i)

376 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

378 
i
 > 0 ? ", " : "",

379 
	`mëhod2°rög
(
sockscf
->
smëhodv
[
i
]));

381 
	`¶og
(
LOG_DEBUG
, "%s", 
buf
);

386 i‡(
sockscf
->
›ti⁄
.
debug
) {

387 
rouã_t
 *
rouã
;

388 #i‡!
SOCKS_CLIENT


389 
ruÀ_t
 *
ruÀ
;

390 
m⁄ô‹_t
 *
m⁄ô‹
;

392 
i
 = 0, 
ruÀ
 = 
sockscf
->
¸uÀ
;ÑuÀ !
NULL
;ÑuÀ =ÑuÀ->
√xt
)

393 ++
i
;

394 
	`¶og
(
LOG_DEBUG
, "%ss (%lu): ",

395 
	`obje˘ty≥2°rög
(
obje˘_¸uÀ
), ()
i
);

397 
ruÀ
 = 
sockscf
->
¸uÀ
;ÑuÀ !
NULL
;ÑuÀ =ÑuÀ->
√xt
)

398 
	`showruÀ
(
ruÀ
, 
obje˘_¸uÀ
);

400 #i‡
HAVE_SOCKS_HOSTID


401 
i
 = 0, 
ruÀ
 = 
sockscf
->
hruÀ
;ÑuÀ !
NULL
;ÑuÀ =ÑuÀ->
√xt
)

402 ++
i
;

403 
	`¶og
(
LOG_DEBUG
, "%ss (%lu): ",

404 
	`obje˘ty≥2°rög
(
obje˘_hruÀ
), ()
i
);

406 
ruÀ
 = 
sockscf
->
hruÀ
;ÑuÀ !
NULL
;ÑuÀ =ÑuÀ->
√xt
)

407 
	`showruÀ
(
ruÀ
, 
obje˘_hruÀ
);

410 
i
 = 0, 
ruÀ
 = 
sockscf
->
§uÀ
;ÑuÀ !
NULL
;ÑuÀ =ÑuÀ->
√xt
)

411 ++
i
;

412 
	`¶og
(
LOG_DEBUG
, "%ss (%lu): ",

413 
	`obje˘ty≥2°rög
(
obje˘_§uÀ
), ()
i
);

415 
ruÀ
 = 
sockscf
->
§uÀ
;ÑuÀ !
NULL
;ÑuÀ =ÑuÀ->
√xt
)

416 
	`showruÀ
(
ruÀ
, 
obje˘_§uÀ
);

419 
i
 = 0, 
rouã
 = 
sockscf
->rouã;Ñouã !
NULL
;Ñouã =Ñouã->
√xt
)

420 ++
i
;

421 
	`¶og
(
LOG_DEBUG
, "rouã†(%lu): ", ()
i
);

422 
rouã
 = 
sockscf
->rouã;Ñouã !
NULL
;Ñouã =Ñouã->
√xt
)

423 
	`socks_showrouã
(
rouã
);

425 #i‡!
SOCKS_CLIENT


426 
i
 = 0, 
m⁄ô‹
 = 
sockscf
->monitor;

427 
m⁄ô‹
 !
NULL
;

428 
m⁄ô‹
 = m⁄ô‹->
√xt
)

429 ++
i
;

431 
	`¶og
(
LOG_DEBUG
, "m⁄ô‹†(%lu): ", ()
i
);

432 
m⁄ô‹
 = 
sockscf
->m⁄ô‹; m⁄ô‹ !
NULL
; m⁄ô‹ = m⁄ô‹->
√xt
)

433 
	`showm⁄ô‹
(
m⁄ô‹
);

438 #i‡!
SOCKS_CLIENT


439 i‡(
fú°time
) {

440 
	`¶og
(
LOG_DEBUG
, "shmemconfigfd: %d, hostfd: %d, "

441 #i‡
HAVE_LDAP


445 
sockscf
->
shmemc⁄figfd
,

446 
sockscf
->
ho°fd
,

447 #i‡
HAVE_LDAP


448 
sockscf
->
ld≠fd
,

450 
sockscf
->
loglock
,

451 
sockscf
->
shmemfd
);

453 
fú°time
 = 0;

456 
	}
}

459 
	$socks_showrouã
(
rouã
)

460 c⁄° 
rouã_t
 *
rouã
;

462 
gw°rög
[
MAXGWSTRING
], 
addr
[
MAXRULEADDRSTRING
];

463 
size_t
 
i
;

465 
	`¶og
(
LOG_DEBUG
, "rouã #%d", 
rouã
->
numbî
);

467 
	`¶og
(
LOG_DEBUG
, "src: %s",

468 
	`ruÀaddr2°rög
(&
rouã
->
§c
, 
ADDRINFO_PORT
, 
addr
, (addr)));

470 
	`¶og
(
LOG_DEBUG
, "dst: %s",

471 
	`ruÀaddr2°rög
(&
rouã
->
d°
, 
ADDRINFO_PORT
, 
addr
, (addr)));

473 
	`¶og
(
LOG_DEBUG
, "gateway: %s",

474 
	`socksho°2°rög
(&
rouã
->
gw
.
addr
, 
gw°rög
, (gwstring)));

476 
	`show°©e
(&
rouã
->
gw
.
°©e
);

478 i‡(
rouã
->
rdr_‰om
.
©y≥
 !
SOCKS_ADDR_NOTSET
)

479 
	`¶og
(
LOG_DEBUG
, "redirect from: %s",

480 
	`ruÀaddr2°rög
(&
rouã
->
rdr_‰om
, 
ADDRINFO_PORT
, 
addr
, (addr)));

482 
i
 = 0; i < 
rouã
->
sockë›ti⁄c
; ++i)

483 
	`¶og
(
LOG_DEBUG
, "sockë›ti⁄ %s", 
rouã
->
sockë›ti⁄v
[
i
].
öfo
->
«me
);

485 
	`¶og
(
LOG_DEBUG
, "route state:áutoadded: %s, failed: %lu, badtime: %ld",

486 
rouã
->
°©e
.
autﬂdded
 ? "yes" : "no",

487 ()
rouã
->
°©e
.
Áûed
,

488 ()
rouã
->
°©e
.
badtime
);

489 
	}
}

491 #i‡!
SOCKS_CLIENT


494 
	$showlog•ecül
(
log
, 
side
)

495 c⁄° 
log•ecül_t
 *
log
;

496 c⁄° 
öãrÁ˚side_t
 
side
;

498 
size_t
 
i
;

500 i‡(
log
->
¥Ÿocﬁ
.
t˝
.
dißbÀd
.
isc⁄figuªd
) {

501 
	`¶og
(
LOG_DEBUG
,

505 
	`¥Ÿocﬁ2°rög
(
SOCKS_TCP
),

506 
	`öãrÁ˚side2°rög
(
side
),

507 
log
->
¥Ÿocﬁ
.
t˝
.
dißbÀd
.
e˙
 ? "" : "no ",

508 
log
->
¥Ÿocﬁ
.
t˝
.
dißbÀd
.
ßck
 ? "" : "no ",

509 
log
->
¥Ÿocﬁ
.
t˝
.
dißbÀd
.
time°amps
 ? "" : "no ",

510 
log
->
¥Ÿocﬁ
.
t˝
.
dißbÀd
.
wsˇÀ
 ? "" : "no ");

513 i‡(
log
->
¥Ÿocﬁ
.
t˝
.
íabÀd
.
isc⁄figuªd
) {

514 
	`¶og
(
LOG_DEBUG
,

518 
	`¥Ÿocﬁ2°rög
(
SOCKS_TCP
),

519 
	`öãrÁ˚side2°rög
(
side
),

520 
log
->
¥Ÿocﬁ
.
t˝
.
íabÀd
.
e˙
 ? "" : "no ",

521 
log
->
¥Ÿocﬁ
.
t˝
.
íabÀd
.
ßck
 ? "" : "no ",

522 
log
->
¥Ÿocﬁ
.
t˝
.
íabÀd
.
time°amps
 ? "" : "no ",

523 
log
->
¥Ÿocﬁ
.
t˝
.
íabÀd
.
wsˇÀ
 ? "" : "no ");

526 
i
 = 0; i < 
	`ELEMENTS
(
log
->
î∫o_logÀvñv
); ++i) {

527 i‡(
log
->
î∫o_logÀvñc
[
i
] > 0) {

528 
size_t
 
ii
;

530 
	`¶og
(
LOG_DEBUG
,

532 
	`öãrÁ˚side2°rög
(
side
),

533 
	`logÀvñ2°rög
(
i
), ()i);

535 
ii
 = 0; iò< 
log
->
î∫o_logÀvñc
[
i
]; ++ii)

536 
	`¶og
(
LOG_DEBUG
, "%d", 
log
->
î∫o_logÀvñv
[
i
][
ii
]);

540 
i
 = 0; i < 
	`ELEMENTS
(
log
->
gaõº_logÀvñv
); ++i) {

541 i‡(
log
->
gaõº_logÀvñc
[
i
] > 0) {

542 
size_t
 
ii
;

544 
	`¶og
(
LOG_DEBUG
,

546 
	`öãrÁ˚side2°rög
(
side
),

547 
	`logÀvñ2°rög
(
i
),

548 ()
i
);

550 
ii
 = 0; iò< 
log
->
gaõº_logÀvñc
[
i
]; ++ii)

551 
	`¶og
(
LOG_DEBUG
, "%d", 
log
->
gaõº_logÀvñv
[
i
][
ii
]);

555 
	}
}

	@lib/sockaddr.c

44 
	~"comm⁄.h
"

46 #i‡
HAVE_NET_IF_DL_H


47 
	~<√t/if_dl.h
>

50 c⁄° 
	grcsid
[] =

55 
	$sockaddøªeq
(
a
, 
b
, 
nocom∑ª
)

56 c⁄° 
sockaddr_°‹age
 *
a
;

57 c⁄° 
sockaddr_°‹age
 *
b
;

58 c⁄° 
size_t
 
nocom∑ª
;

61 i‡(
a
->
ss_Ámûy
 !
b
->ss_family)

64 #i‡
HAVE_SOCKADDR_STORAGE_SS_LEN


65 i‡(
a
->
ss_Àn
 !
b
->ss_len)

69 i‡(! (
nocom∑ª
 & 
ADDRINFO_PORT
))

70 i‡(
	`GET_SOCKADDRPORT
(
a
Ë!GET_SOCKADDRPORT(
b
))

73 
a
->
ss_Ámûy
) {

74 
AF_INET
:

75  
	`memcmp
(&
	`TOCIN
(
a
)->
sö_addr
,

76 &
	`TOCIN
(
b
)->
sö_addr
,

77 (
	`TOCIN
(
a
)->
sö_addr
)) == 0;

79 
AF_INET6
:

80 i‡(! (
nocom∑ª
 & 
ADDRINFO_SCOPEID
))

81 i‡(
	`TOCIN6
(
a
)->
sö6_sc›e_id
 !TOCIN6(
b
)->sin6_scope_id)

84 i‡(
	`TOCIN6
(
a
)->
sö6_Êowöfo
 !TOCIN6(
b
)->sin6_flowinfo)

87  
	`memcmp
(&
	`TOCIN6
(
a
)->
sö6_addr
,

88 &
	`TOCIN6
(
b
)->
sö6_addr
,

89 (
	`TOCIN6
(
a
)->
sö6_addr
)) == 0;

92  
	`memcmp
(
a
, 
b
, 
	`ßÀn
◊->
ss_Ámûy
)) == 0;

94 
	}
}

97 
	$sockaddr˝y
(
d°
, 
§c
, 
d°Àn
)

98 
sockaddr_°‹age
 *
d°
;

99 c⁄° 
sockaddr_°‹age
 *
§c
;

100 c⁄° 
size_t
 
d°Àn
;

102 c⁄° *
fun˘i⁄
 = "sockaddrcpy()";

103 c⁄° 
sockÀn_t
 
§˛í
 = 
	`ßÀn
(
§c
->
ss_Ámûy
),

104 
c›yÀn
 = 
	`MIN
(
d°Àn
, 
§˛í
);

106 i‡(
§˛í
 > 
c›yÀn
)

107 
	`sw¨nx
("%s:Åruncatingáddress %s (af: %lu): %lu/%lu bytesávailable",

108 
fun˘i⁄
,

109 
	`sockaddr2°rög
(
§c
, 
NULL
, 0),

110 ()
§c
->
ss_Ámûy
,

111 ()
d°Àn
,

112 ()
§˛í
);

114 i‡(
d°Àn
 > 
c›yÀn
)

115 
	`bzîo
((*)
d°
 + 
c›yÀn
, 
d°Àn
 - copylen);

118 
	`mem˝y
(
d°
, 
§c
, 
c›yÀn
);

120 
	}
}

123 
	$u§sockaddr˝y
(
d°
, 
§c
, 
d°Àn
)

124 
sockaddr_°‹age
 *
d°
;

125 c⁄° 
sockaddr_°‹age
 *
§c
;

126 c⁄° 
size_t
 
d°Àn
;

128 c⁄° *
fun˘i⁄
 = "usrsockaddrcpy()";

129 c⁄° 
sockÀn_t
 
§˛í
 = 
	`ßÀn
(
§c
->
ss_Ámûy
),

130 
c›yÀn
 = 
	`MIN
(
d°Àn
, 
§˛í
);

132 i‡(
c›yÀn
 < 
§˛í
)

133 
	`sw¨nx
("%s:Åruncatingáddress %s (af: %lu): %lu/%lu bytesávailable",

134 
fun˘i⁄
,

135 
	`sockaddr2°rög
(
§c
, 
NULL
, 0),

136 ()
§c
->
ss_Ámûy
,

137 ()
d°Àn
,

138 ()
§˛í
);

140 i‡(
c›yÀn
 < 
d°Àn
)

141 
	`bzîo
((*)
d°
 + 
c›yÀn
, 
d°Àn
 - copylen);

143 
	`mem˝y
(
d°
, 
§c
, 
c›yÀn
);

145 #i‡
HAVE_SOCKADDR_STORAGE_SS_LEN


146 
d°
->
ss_Àn
 = 
c›yÀn
;

148 
	}
}

150 
ß_Àn_ty≥


151 
	$ßÀn
(
Ámûy
)

152 c⁄° 
ß_Ámûy_t
 
Ámûy
;

156 
Ámûy
) {

157 
AF_INET
:

158  (
ß_Àn_ty≥
)(
sockaddr_ö
);

160 #ifde‡
AF_INET6


161 
AF_INET6
:

162  (
ß_Àn_ty≥
)(
sockaddr_ö6
);

165 #ifde‡
AF_LINK


166 
AF_LINK
:

167  (
ß_Àn_ty≥
)(
sockaddr_dl
);

170 #ifde‡
AF_UNSPEC


171 
AF_UNSPEC
:

172  (
ß_Àn_ty≥
)(
sockaddr
);

177 #i‡!
SOCKS_CLIENT


178 
	`SWARNX
(
Ámûy
);

181  (
ß_Àn_ty≥
)(
sockaddr
);

182 
	}
}

184 
ß_Àn_ty≥


185 
	$öaddæí
(
Ámûy
)

186 c⁄° 
ß_Ámûy_t
 
Ámûy
;

190 
Ámûy
) {

191 
AF_INET
:

192  (
ß_Àn_ty≥
)(
ö_addr
);

194 #ifde‡
AF_INET6


195 
AF_INET6
:

196  (
ß_Àn_ty≥
)(
ö6_addr
);

200 
	`SWARNX
(
Ámûy
);

203 
	}
}

207 
	$ßÁmûy_issuµ‹ãd
(
Ámûy
)

208 c⁄° 
ß_Ámûy_t
 
Ámûy
;

212 
Ámûy
) {

213 
AF_INET
:

214 
AF_INET6
:

222 
	}
}

224 
ß_Ámûy_t


225 
	$©y≥2ßÁmûy
(
©y≥
)

226 c⁄° 
©y≥
;

229 
©y≥
) {

230 
SOCKS_ADDR_IPV4
:

231  
AF_INET
;

233 
SOCKS_ADDR_IPV6
:

234  
AF_INET6
;

237 
	`SERRX
(
©y≥
);

238 
	}
}

241 
	$ßÁmûy2©y≥
(
ßÁmûy
)

242 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

245 
ßÁmûy
) {

246 
AF_INET
:

247  
SOCKS_ADDR_IPV4
;

249 
AF_INET6
:

250  
SOCKS_ADDR_IPV6
;

253 
	`SERRX
(
ßÁmûy
);

254 
	}
}

	@lib/socket.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
socks_c⁄√˘ho°
(
s
,

52 #i‡!
SOCKS_CLIENT


53 
side
,

55 
ho°
,

56 
œddr
,

57 
øddr
,

58 
timeout
,

59 
emsg
,

60 
emsgÀn
)

61 
	gs
;

62 #i‡!
SOCKS_CLIENT


63 c⁄° 
öãrÁ˚side_t
 
	gside
;

65 c⁄° 
socksho°_t
 *
	gho°
;

66 
sockaddr_°‹age
 *
	gœddr
;

67 
sockaddr_°‹age
 *
	gøddr
;

68 c⁄° 
	gtimeout
;

69 *
	gemsg
;

70 c⁄° 
size_t
 
	gemsgÀn
;

72 c⁄° *
	gfun˘i⁄
 = "socks_connecthost()";

73 
fd_£t
 *
	gw£t
;

74 #i‡
SOCKS_CLIENT


75 
öãrÁ˚side_t
 
	gside
 = 
EXTERNALIF
;

77 
dnsöfo_t
 
	gªsmem
;

78 
sockaddr_°‹age
 
	gœddr_mem
, 
	gøddr_mem
;

79 
addröfo
 
	ghöts
, *
	gªs
, *
	g√xt
;

80 
sockÀn_t
 
	gÀn
;

81 
	gaddr°r
[
MAXSOCKADDRSTRING
], 
	gho°°r
[
MAXSOCKSHOSTSTRING
],

82 
	gœddr°r
[
MAXSOCKADDRSTRING
];

83 
	gÁûed
, 
	grc
;

90 
	gî∫o
 = 0;

92 i‡(
	gw£t
 =
NULL
)

93 
w£t
 = 
Æloˇã_maxsize_fd£t
();

95 i‡(
	gœddr
 =
NULL
)

96 
œddr
 = &
œddr_mem
;

98 i‡(
	gøddr
 =
NULL
)

99 
øddr
 = &
øddr_mem
;

101 
	gÀn
 = (*
œddr
);

102 i‡(
gësock«me
(
s
, 
TOSA
(
œddr
), &
Àn
) == -1) {

103 
¢¥ötf
(
emsg
, 
emsgÀn
, "gësock«me(2ËÁûed: %s", 
°ªº‹
(
î∫o
));

107 
sockaddr2°rög
(
œddr
, 
œddr°r
, (laddrstr));

109 
¶og
(
LOG_NEGOTIATE
,

111 
fun˘i⁄
,

112 
socksho°2°rög
(
ho°
, 
ho°°r
, (hoststr)),

114 #i‡!
SOCKS_CLIENT


116 
öãrÁ˚side2°rög
(
side
),

124 
œddr°r
,

125 
s
,

126 
timeout
);

128 
bzîo
(
øddr
, (*raddr));

130 
	gho°
->
	g©y≥
) {

131 
	gSOCKS_ADDR_IPV4
:

132 
SOCKS_ADDR_IPV6
: {

133 
c⁄√˘_î∫o
, 
	gÊags
, 
	gch™ged_to_n⁄blockög
;

135 
	gch™ged_to_n⁄blockög
 = 0;

136 
	gÊags
 = -1;

138 i‡(
	gtimeout
 != -1) {

139 i‡((
Êags
 = 
f˙é
(
s
, 
F_GETFL
, 0)) == -1) {

140 
¢¥ötf
(
emsg
, 
emsgÀn
, "fcntl(F_GETFL) failed: %s",

141 
°ªº‹
(
î∫o
));

146 i‡(!(
	gÊags
 & 
	gO_NONBLOCK
)) {

147 
¶og
(
LOG_DEBUG
,

150 
fun˘i⁄
, 
s
, 
timeout
);

152 i‡(
f˙é
(
s
, 
F_SETFL
, 
Êags
 | 
O_NONBLOCK
) == -1) {

153 
¢¥ötf
(
emsg
, 
emsgÀn
,

155 
s
, 
°ªº‹
(
î∫o
));

160 
	gch™ged_to_n⁄blockög
 = 1;

164 
	gho°
->
	g©y≥
) {

165 
	gSOCKS_ADDR_IPV4
:

166 
SET_SOCKADDR
(
øddr
, 
AF_INET
);

167 
TOIN
(
øddr
)->
	gsö_addr
 = 
ho°
->
addr
.
ùv4
;

170 
	gSOCKS_ADDR_IPV6
:

171 
SET_SOCKADDR
(
øddr
, 
AF_INET6
);

172 
TOIN6
(
øddr
)->
	gsö6_addr
 = 
ho°
->
addr
.
ùv6
.
ù
;

173 
TOIN6
(
øddr
)->
	gsö6_sc›e_id
 = 
ho°
->
addr
.
ùv6
.
sc›eid
;

177 
SERRX
(
ho°
->
©y≥
);

180 
SET_SOCKADDRPORT
(
øddr
, 
ho°
->
p‹t
);

182 
	grc
 = 
c⁄√˘
(
s
, 
TOSA
(
øddr
), 
ßÀn
‘addr->
ss_Ámûy
));

183 
	gc⁄√˘_î∫o
 = 
î∫o
;

185 i‡(
	grc
 =0 || 
î∫o
 =
EINPROGRESS
) {

189 i‡(!
IPADDRISBOUND
(
œddr
)) {

190 
Àn
 = (*
œddr
);

191 i‡(
gësock«me
(
s
, 
TOSA
(
œddr
), &
Àn
) == -1) {

192 
¢¥ötf
(
emsg
, 
emsgÀn
,

194 
°ªº‹
(
î∫o
));

199 
sockaddr2°rög
(
œddr
, 
œddr°r
, (laddrstr));

203 
¢¥ötf
(
emsg
, 
emsgÀn
,

205 
ho°°r
, 
œddr°r
, 
s
, ()
rc
, 
°ªº‹
(
î∫o
));

207 
¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

209 i‡(
	gch™ged_to_n⁄blockög
) {

210 
SASSERTX
(
Êags
 != -1);

212 i‡(
f˙é
(
s
, 
F_SETFL
, 
Êags
 & ~
O_NONBLOCK
) == -1)

213 
sw¨n
("%s: failedÑeverting fd %d backÅo blocking",

214 
fun˘i⁄
, 
s
);

217 i‡(
	grc
 == 0)

225 
c⁄√˘_î∫o
 = 0;

227 
	gî∫o
 = 
c⁄√˘_î∫o
;

229 #i‡
SOCKS_CLIENT


235 i‡(
	grc
 == -1) {

236 i‡(
î∫o
 =
EINTR
) {

237 
¢¥ötf
(
emsg
, 
emsgÀn
, "connect(2)Åo %s from %s failed: %s",

238 
sockaddr2°rög
(
øddr
, 
NULL
, 0),

239 
œddr°r
,

240 
°ªº‹
(
î∫o
));

242  
	grc
;

245 i‡(!
	gch™ged_to_n⁄blockög
) {

251 
¢¥ötf
(
emsg
, 
emsgÀn
,

252 "n⁄-blockög c⁄√˘(2): %s", 
°ªº‹
(
î∫o
));

254  
	grc
;

259 
	gtimeout
 != 0

260 && 
rc
 == -1

261 && ( 
î∫o
 =
EINPROGRESS


262 #i‡!
SOCKS_CLIENT


263 || 
î∫o
 =
EINTR


266 
timevÆ
 
tvÆ
 = { 
timeout
, ()0 };

268 
FD_ZERO
(
w£t
);

269 
FD_SET
(
s
, 
w£t
);

271 
	grc
 = 
£À˘n
(
s
 + 1,

272 
NULL
,

273 
NULL
,

274 
NULL
,

275 
w£t
,

276 
NULL
,

277 
timeout
 >0 ? &
tvÆ
 : 
NULL
);

279 i‡(
	grc
 =-1 && 
î∫o
 =
EINTR
)

282 i‡(
	grc
 == 0)

283 
î∫o
 = 
ETIMEDOUT
;

285 
	gÀn
 = (
î∫o
);

286 
gësock›t
(
s
, 
SOL_SOCKET
, 
SO_ERROR
, &
î∫o
, &
Àn
);

289 i‡(
	gî∫o
 == 0)

290 
rc
 = 0;

292 
	grc
 = -1;

295 
¶og
(
LOG_NEGOTIATE
, "%s: connectÅo %s from %s on fd %d %s (%s)",

296 
fun˘i⁄
,

297 
sockaddr2°rög
(
øddr
, 
addr°r
, (addrstr)),

298 
œddr°r
,

299 
s
,

300 
rc
 == 0 ? "ok"

301 : 
î∫o
 =
EINPROGRESS
 ? "inÖrogress" : "failed",

302 
°ªº‹
(
î∫o
));

304 i‡(
	grc
 == -1) {

305 
log_c⁄√˘Áûed
(
side
, 
addr°r
);

307 
¢¥ötf
(
emsg
, 
emsgÀn
, "connect(2)Åo %s from %s %s: %s",

308 
sockaddr2°rög
(
øddr
, 
NULL
, 0),

309 
œddr°r
,

310 
î∫o
 =
EINPROGRESS
 ? "is inÖrogress" : "failed",

311 
°ªº‹
(
î∫o
));

314  
	grc
;

317 
	gSOCKS_ADDR_DOMAIN
: {

318 
sockÀn_t
 
Àn
;

319 
	gvisbuf
[
MAXHOSTNAMELEN
 * 4];

321 
bzîo
(&
höts
, (hints));

337 i‡(
	gœddr
->
	gss_Ámûy
 =
AF_INET
)

338 
höts
.
ai_Ámûy
 = 0;

340 
SASSERTX
(
œddr
->
ss_Ámûy
 =
AF_INET6
);

341 
	ghöts
.
	gai_Ámûy
 = 
œddr
->
ss_Ámûy
;

344 
	gÀn
 = (
höts
.
ai_sockty≥
);

345 i‡(
gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
höts
.
ai_sockty≥
, &
Àn
) != 0){

346 
¢¥ötf
(
emsg
, 
emsgÀn
,

349 
s
, 
°ªº‹
(
î∫o
));

354 i‡((
	grc
 = 
cgëaddröfo
(
ho°
->
addr
.
domaö
, 
NULL
, &
höts
, &
ªs
, &
ªsmem
))

356 
¢¥ötf
(
emsg
, 
emsgÀn
,

358 
°r2vis
(
ho°
->
addr
.
domaö
,

359 
°æí
(
ho°
->
addr
.
domaö
),

360 
visbuf
,

361 (
visbuf
)),

362 
gai_°ªº‹
(
rc
));

364 
	gî∫o
 = 
EHOSTUNREACH
;

368 #i‡
DIAGNOSTIC


369 
SASSERTX
(
höts
.
ai_Ámûy
 =0 || 
ªs
->ai_family == hints.ai_family);

370 
SASSERTX
(
ªs
->
ai_sockty≥
 =
höts
.ai_socktype);

377 
SERRX
(
ho°
->
©y≥
);

380 
SASSERTX
(
ho°
->
©y≥
 =
SOCKS_ADDR_DOMAIN
);

381 
SASSERTX
(
ªs
->
ai_addr
 !
NULL
);

387 
	gÁûed
 = 0;

388 
	g√xt
 = 
ªs
;

390 
socksho°_t
 
	g√who°
;

392 i‡(
	g√xt
->
	gai_Ámûy
 !
œddr
->
ss_Ámûy
) {

393 
¢¥ötf
(
emsg
, 
emsgÀn
,

396 
sockaddr2°rög
(
TOSS
(
√xt
->
ai_addr
), 
NULL
, 0),

397 
ho°°r
,

398 
ßÁmûy2°rög
(
œddr
->
ss_Ámûy
));

399 
	gî∫o
 = 
EAFNOSUPPORT
;

401 
	g√xt
 = 
√xt
->
ai_√xt
;

405 i‡(
	gÁûed
) {

406 
	g√w_s
;

408 i‡((
	g√w_s
 = 
sockë›tdup
(
s
, -1)) == -1) {

409 
¢¥ötf
(
emsg
, 
emsgÀn
, "socketoptdup() failed: %s",

410 
°ªº‹
(
î∫o
));

415 i‡(
dup2
(
√w_s
, 
s
) == -1) {

416 
¢¥ötf
(
emsg
, 
emsgÀn
, "dup2(ËÁûed: %s", 
°ªº‹
(
î∫o
));

417 
˛o£
(
√w_s
);

421 
˛o£
(
√w_s
);

427 i‡(
socks_böd
(
s
, 
œddr
, 1) != 0) {

428 
¢¥ötf
(
emsg
, 
emsgÀn
, "socks_böd(ËÁûed: %s", 
°ªº‹
(
î∫o
));

437 
sockaddr˝y
(
øddr
, 
TOSS
(
√xt
->
ai_addr
), (*raddr));

438 
SET_SOCKADDRPORT
(
øddr
, 
ho°
->
p‹t
);

440 
sockaddr2socksho°
(
øddr
, &
√who°
);

442 i‡(
	g√xt
->
	gai_√xt
 =
NULL
) {

453 
rc
 = 
socks_c⁄√˘ho°
(
s
,

454 #i‡!
SOCKS_CLIENT


455 
side
,

457 &
√who°
,

458 
œddr
,

459 
øddr
,

460 
timeout
,

461 
emsg
,

462 
emsgÀn
);

465 
	grc
 = 
socks_c⁄√˘ho°
(
s
,

466 #i‡!
SOCKS_CLIENT


467 
side
,

469 &
√who°
,

470 
œddr
,

471 
øddr
,

472 
sockscf
.
timeout
.
c⁄√˘
 ?

473 ()
sockscf
.
timeout
.
c⁄√˘
 : ()-1,

474 
emsg
,

475 
emsgÀn
);

477 i‡(
	grc
 == 0) {

478 
î∫o
 = 0;

480 i‡(
	gemsg
 !
NULL
)

481 *
emsg
 = 
NUL
;

489 
	gî∫o
) {

490 
	gETIMEDOUT
:

491 
EINVAL
:

492 
ECONNREFUSED
:

493 
ENETUNREACH
:

494 
EHOSTUNREACH
:

501 
	gÁûed
 = 1;

502 
	g√xt
 = 
√xt
->
ai_√xt
;

503 } 
	g√xt
 !
NULL
);

509 
SASSERTX
(
î∫o
 != 0);

511 i‡(
	gemsg
 !
NULL
)

512 
SASSERTX
(*
emsg
 !
NUL
);

517 #unde‡
sockë


519 
	$socks_sockë
(
domaö
, 
ty≥
, 
¥Ÿocﬁ
)

520 c⁄° 
domaö
;

521 c⁄° 
ty≥
;

522 c⁄° 
¥Ÿocﬁ
;

524 c⁄° *
fun˘i⁄
 = "socks_socket()";

525 
s
;

527 i‡((
s
 = 
	`sockë
(
domaö
, 
ty≥
, 
¥Ÿocﬁ
)) == -1)

530 #i‡!
SOCKS_CLIENT


531 i‡(
domaö
 =
AF_INET6
) {

532 
sockÀn_t
 
Àn
;

533 
vÆue
;

535 
vÆue
 = 1;

536 
Àn
 = (
vÆue
);

538 i‡(
	`£tsock›t
(
s
, 
IPPROTO_IPV6
, 
IPV6_V6ONLY
, &
vÆue
, 
Àn
) != 0)

539 
	`sw¨n
("%s: sësock›t(IPV6_V6ONLYË⁄ fd %d faûed", 
fun˘i⁄
, 
s
);

543  
s
;

544 
	}
}

548 
	$ac˚±n
(
s
, 
addr
, 
addæí
)

549 
s
;

550 
sockaddr_°‹age
 *
addr
;

551 
sockÀn_t
 *
addæí
;

553 c⁄° *
fun˘i⁄
 = "acceptn()";

554 
sockaddr_°‹age
 
fuŒaddr
;

555 
sockÀn_t
 
fuŒaddæí
 = (
fuŒaddr
);

556 
rc
;

558 #i‡
DEBUG


560 #ifde‡
SO_LISTENQLEN


561 i‡(
sockscf
.
›ti⁄
.
debug
) {

562 
sockÀn_t
 
Àn
;

563 
li°íqÀn
, 
li°íöq˛í
, 
Áûed
;

565 
Áûed
 = 0;

567 
Àn
 = (
li°íqÀn
);

568 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_LISTENQLEN
, &
li°íqÀn
, &
Àn
) == -1) {

569 
	`sw¨n
("%s: gësock›t(SO_LISTENQLENËÁûed", 
fun˘i⁄
);

570 
Áûed
 = 1;

573 
Àn
 = (
li°íöq˛í
);

574 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_LISTENINCQLEN
, &
li°íöq˛í
, &
Àn
)

576 
	`sw¨n
("%s: gësock›t(SO_LISTENINCQLENËÁûed", 
fun˘i⁄
);

577 
Áûed
 = 1;

580 i‡(!
Áûed
)

581 
	`¶og
(
LOG_DEBUG
, "%s: fd %d.Üistenqlen: %d,Üisteninqclen: %d",

582 
fun˘i⁄
, 
s
, 
li°íqÀn
, 
li°íöq˛í
);

588 (
rc
 = 
	`ac˚±
(
s
, 
	`TOSA
(&
fuŒaddr
), &
fuŒaddæí
)) == -1

589 && 
î∫o
 =
EINTR
)

590 #i‡!
SOCKS_CLIENT


596 ()
	`sockd_h™dÀdsig«ls
();

601 #i‡!
SOCKS_CLIENT
 && 
HAVE_LINUX_BUGS


602 i‡(
rc
 != -1) {

606 i‡(
	`f˙é
(
rc
, 
F_SETFL
, f˙é(
s
, 
F_GETFL
, 0)) != 0) {

607 
	`sw¨n
("%s:áttemptÅo workáround Linux bug via fcntl(2) failed",

608 
fun˘i⁄
);

610 
	`˛o£
(
rc
);

616 i‡(
rc
 != -1)

621 
	`sockaddr˝y
(
addr
, &
fuŒaddr
, (
size_t
)*
addæí
);

623 *
addæí
 = 
	`MIN
(*addæí, (
sockÀn_t
)
fuŒaddæí
);

625  
rc
;

626 
	}
}

629 
	$£ä⁄blockög
(
fd
, 
˘x
)

630 c⁄° 
fd
;

631 c⁄° *
˘x
;

633 
Êags
;

635 i‡((
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
, 0)) != -1

636 && 
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
 | 
O_NONBLOCK
) != -1)

637  
Êags
;

639 
	`sw¨n
("ÁûedÅÿmakêfd %d, u£d f‹ %s,Ç⁄-blockög", 
fd
, 
˘x
);

642 
	}
}

645 
	$£tblockög
(
fd
, 
˘x
)

646 c⁄° 
fd
;

647 c⁄° *
˘x
;

649 
Êags
;

651 i‡((
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
, 0)) != -1

652 && 
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
 & ~
O_NONBLOCK
) != -1)

653  
Êags
;

655 
	`sw¨n
("ÁûedÅÿmakêfd %d, u£d f‹ %s, blockög", 
fd
, 
˘x
);

658 
	}
}

661 
	$socks_sockëisf‹œn
(
s
)

662 c⁄° 
s
;

664 c⁄° *
fun˘i⁄
 = "socks_socketisforlan()";

665 
ö_addr
 
addr
;

666 
sockÀn_t
 
Àn
;

667 
âl
;

668 c⁄° 
î∫o_s
 = 
î∫o
;

675 
Àn
 = (
addr
);

676 i‡(
	`gësock›t
(
s
, 
IPPROTO_IP
, 
IP_MULTICAST_IF
, &
addr
, &
Àn
) != 0) {

677 
	`¶og
(
LOG_DEBUG
, "%s: getsockopt(IP_MULTICAST_IF) failed: %s",

678 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

680 
î∫o
 = 
î∫o_s
;

684 i‡(
addr
.
s_addr
 =
	`ht⁄l
(
INADDR_ANY
))

687 
Àn
 = (
âl
);

688 i‡(
	`gësock›t
(
s
, 
IPPROTO_IP
, 
IP_MULTICAST_TTL
, &
âl
, &
Àn
) != 0) {

689 
	`sw¨n
("%s: gësock›t(IP_MULTICAST_TTL)", 
fun˘i⁄
);

691 
î∫o
 = 
î∫o_s
;

695  
âl
 == 1;

696 
	}
}

698 
sockaddr_°‹age
 *

699 
	$sockëisc⁄√˘ed
(
s
, 
addr
, 
addæí
)

700 c⁄° 
s
;

701 
sockaddr_°‹age
 *
addr
;

702 
sockÀn_t
 
addæí
;

704 c⁄° *
fun˘i⁄
 = "socketisconnected()";

705 
sockÀn_t
 
Àn
;

706 
îr
;

708 i‡(
addr
 =
NULL
 || 
addæí
 == 0) {

709 
sockaddr_°‹age
 
addrmem
;

711 
addr
 = &
addrmem
;

714 
Àn
 = (
îr
);

715 ()
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_ERROR
, &
îr
, &
Àn
);

717 i‡(
îr
 == 0) {

718 i‡(
	`gë≥î«me
(
s
, 
	`TOSA
(
addr
), &
Àn
) == -1) {

723  
NULL
;

727  
NULL
;

729  
addr
;

730 
	}
}

733 
	$socks_ªböd
(
s
, 
¥Ÿocﬁ
, 
‰om
, 
to
, 
emsg
, 
emsgÀn
)

734 
s
;

735 
¥Ÿocﬁ
;

736 
sockaddr_°‹age
 *
‰om
;

737 c⁄° 
ruÀaddr_t
 *
to
;

738 *
emsg
;

739 c⁄° 
size_t
 
emsgÀn
;

741 c⁄° *
fun˘i⁄
 = "socks_rebind()";

742 
sockaddr_°‹age
 
toböd
;

744 
	`¶og
(
LOG_NEGOTIATE
, "%s: fd %d,Örotocol %s, from %s,Åo %s",

745 
fun˘i⁄
,

746 
s
,

747 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
),

748 
	`sockaddr2°rög
(
‰om
, 
NULL
, 0),

749 
	`ruÀaddr2°rög
(
to
, 
ADDRINFO_PORT
, 
NULL
, 0));

751 
	`ruÀaddr2sockaddr
(
to
, &
toböd
, 
¥Ÿocﬁ
);

752 i‡(!
	`IPADDRISBOUND
(&
toböd
)) {

753 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot convert %sÅoán IP-address",

754 
	`ruÀaddr2°rög
(
to
, 0, 
NULL
, 0));

755 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

757 
î∫o
 = 
EADDRNOTAVAIL
;

761 i‡(
	`IPADDRISBOUND
(
‰om
Ë|| 
	`PORTISBOUND
(from)) {

762 
æim_t
 
maxofûes
;

763 
i
, 
√w_s
, 
rc
;

769 i‡(
	`addrm©ch
(
to
, 
	`sockaddr2socksho°
(
‰om
, 
NULL
), NULL, 
¥Ÿocﬁ
, 0))

776 i‡((
√w_s
 = 
	`sockë›tdup
(
s
, -1)) == -1) {

777 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

779 
s
, 
	`°ªº‹
(
î∫o
));

781 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

793 
maxofûes
 = 
	`gëmaxofûes
(
so·limô
);

794 
i
 = 0; i < ()
maxofûes
; ++i) {

795 i‡(
i
 =
s
)

798 i‡(
	`fdisdup
(
i
, 
s
)) {

799 
	`¶og
(
LOG_INFO
,

801 
fun˘i⁄
, 
i
, 
s
);

803 i‡(
	`dup2
(
√w_s
, 
i
) == -1) {

804 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

806 
√w_s
, 
i
, 
	`°ªº‹
(
î∫o
));

808 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

809 
	`˛o£
(
√w_s
);

820 
rc
 = 
	`dup2
(
√w_s
, 
s
);

821 
	`˛o£
(
√w_s
);

823 i‡(
rc
 == -1) {

824 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot dup2(2) fd %dÅo %d: %s",

825 
√w_s
, 
s
, 
	`°ªº‹
(
î∫o
));

827 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

837 
	`SET_SOCKADDRPORT
(&
toböd
, 
	`GET_SOCKADDRPORT
(
‰om
));

838 i‡(
	`addrm©ch
(
to
, 
	`sockaddr2socksho°
(&
toböd
, 
NULL
), NULL, 
¥Ÿocﬁ
, 0)) {

839 i‡(
	`socks_böd
(
s
, &
toböd
, 0) == 0)

842 
	`SET_SOCKADDRPORT
(&
toböd
, 
	`ht⁄s
(0));

846 i‡(
	`socks_bödöønge
(
s
,

847 &
toböd
,

848 
¥Ÿocﬁ
 =
SOCKS_TCP
 ? 
to
->
p‹t
.
t˝
 :Åo->p‹t.
udp
,

849 
to
->
p‹ãnd
,

850 
to
->
›î©‹
) != 0) {

851 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot bind(2) fd %d inÑange %s: %s",

852 
s
, 
	`ruÀaddr2°rög
(
to
, 
ADDRINFO_PORT
, 
NULL
, 0), 
	`°ªº‹
(
î∫o
));

854 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

856 
î∫o
 = 
EADDRNOTAVAIL
;

860 
	`¶og
(
LOG_NEGOTIATE
, "%s: successfullyÑebound %s-fd %d. Newáddress is %s",

861 
fun˘i⁄
,

862 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
),

863 
s
,

864 
	`sockaddr2°rög
(&
toböd
, 
NULL
, 0));

867 
	}
}

870 
	$socks_bödöønge
(
s
, 
addr
, 
fú°
, 
œ°
, 
›
)

871 
s
;

872 
sockaddr_°‹age
 *
addr
;

873 
ö_p‹t_t
 
fú°
, 
œ°
;

874 c⁄° 
›î©‹_t
 
›
;

876 c⁄° *
fun˘i⁄
 = "socks_bindinrange()";

877 
ö_p‹t_t
 
p‹t
;

878 
exhau°ed
;

880 
	`¶og
(
LOG_DEBUG
, "%s: %s %u %s %u",

881 
fun˘i⁄
,

882 
	`sockaddr2°rög
(
addr
, 
NULL
, 0),

883 
	`¡ohs
(
fú°
),

884 
	`›î©‹2°rög
(
›
),

885 
	`¡ohs
(
œ°
));

893 
p‹t
 = 0;

894 
fú°
 = 
	`¡ohs
(first);

895 
œ°
 = 
	`¡ohs
(last);

896 
exhau°ed
 = 0;

899 i‡(
p‹t
 + 1 == 0)

900 
exhau°ed
 = 1;

903 
›
) {

904 
n⁄e
:

905 
p‹t
 = 0;

908 
eq
:

909 
p‹t
 = 
fú°
;

912 
√q
:

913 i‡(++
p‹t
 =
fú°
)

914 ++
p‹t
;

917 
ge
:

918 i‡(
p‹t
 < 
fú°
)

919 
p‹t
 = 
fú°
;

921 ++
p‹t
;

924 
gt
:

925 i‡(
p‹t
 <
fú°
)

926 
p‹t
 = 
fú°
 + 1;

928 ++
p‹t
;

931 
À
:

932 i‡(++
p‹t
 > 
fú°
)

933 
exhau°ed
 = 1;

936 
…
:

937 i‡(++
p‹t
 >
fú°
)

938 
exhau°ed
 = 1;

941 
ønge
:

942 i‡(
p‹t
 < 
fú°
)

943 
p‹t
 = 
fú°
;

945 ++
p‹t
;

947 i‡(
p‹t
 > 
œ°
)

948 
exhau°ed
 = 1;

952 
	`SERRX
(
›
);

955 i‡(
exhau°ed
) {

956 
	`¶og
(
LOG_NEGOTIATE
,

958 
fun˘i⁄
, 
fú°
, 
	`›î©‹2°rög
(
›
), 
œ°
);

963 
	`SET_SOCKADDRPORT
(
addr
, 
	`ht⁄s
(
p‹t
));

964 i‡(
	`socks_böd
(
s
, 
addr
, 0) == 0)

967 i‡(
î∫o
 =
EACCES
) {

968 i‡(
›
 =
gt
 || o∞=
ge
 || o∞=
ønge
)

969 
p‹t
 = 1023;

970 i‡(
›
 =
…
 || o∞=
À
)

971 
exhau°ed
 = 1;

974 i‡(
›
 =
eq
 || o∞=
n⁄e
)

976 } !
exhau°ed
);

979 
	}
}

982 
	$socks_böd
(
s
, 
addr
, 
ªåõs
)

983 
s
;

984 
sockaddr_°‹age
 *
addr
;

985 
size_t
 
ªåõs
;

987 c⁄° *
fun˘i⁄
 = "socks_bind()";

988 
p
;

990 
	`¶og
(
LOG_DEBUG
, "%s:ÅryingÅo bindáddress %s on fd %d. Retries is %lu",

991 
fun˘i⁄
, 
	`sockaddr2°rög
(
addr
, 
NULL
, 0), 
s
, ()
ªåõs
);

993 
î∫o
 = 0;

995 #i‡!
SOCKS_CLIENT


996 i‡(
	`PORTISRESERVED
(
	`GET_SOCKADDRPORT
(
addr
)))

997 
	`sockd_¥iv
(
SOCKD_PRIV_NET_ADDR
, 
PRIV_ON
);

1000 
p
 = 
	`böd
(
s
, 
	`TOSA
(
addr
), 
	`ßÀn
◊ddr->
ss_Ámûy
));

1002 #i‡!
SOCKS_CLIENT


1003 i‡(
	`PORTISRESERVED
(
	`GET_SOCKADDRPORT
(
addr
)))

1004 
	`sockd_¥iv
(
SOCKD_PRIV_NET_ADDR
, 
PRIV_OFF
);

1007 i‡(
p
 == 0) {

1008 
sockÀn_t
 
addæí
 = (*
addr
);

1009 
p
 = 
	`gësock«me
(
s
, 
	`TOSA
(
addr
), &
addæí
);

1013 
	`¶og
(
LOG_DEBUG
, "%s: failedÅo bind %s (%s)",

1014 
fun˘i⁄
, 
	`sockaddr2°rög
(
addr
, 
NULL
, 0), 
	`°ªº‹
(
î∫o
));

1019 
î∫o
) {

1020 
EINTR
:

1023 
EADDRINUSE
:

1024 i‡(
ªåõs
--) {

1025 
	`¶ìp
(1);

1036 i‡(
p
 == 0)

1037 
	`¶og
(
LOG_DEBUG
, "%s: boundáddress %s on fd %d",

1038 
fun˘i⁄
, 
	`sockaddr2°rög
(
addr
, 
NULL
, 0), 
s
);

1040  
p
;

1041 
	}
}

1044 
	$fdisdup
(
fd1
, 
fd2
)

1045 c⁄° 
fd1
;

1046 c⁄° 
fd2
;

1048 c⁄° *
fun˘i⁄
 = "fdisdup()";

1049 #i‡
HAVE_UNIQUE_SOCKET_INODES


1050 
°©
 
sb1
, 
sb2
;

1052 
sockÀn_t
 
Àn1
, 
Àn2
;

1053 
isdup
, 
rc1
, 
rc2
, 
î∫o1
, 
î∫o2
, 
Êags1
, 
Êags2
, 
√wÊags1
, 
√wÊags2
,

1054 
ã°Êag
 = 
SO_REUSEADDR
, 
£tÊag
;

1056 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, fd %d", 
fun˘i⁄
, 
fd1
, 
fd2
);

1058 i‡(
fd1
 =
fd2
)

1061 #i‡
HAVE_UNIQUE_SOCKET_INODES


1062 
rc1
 = 
	`f°©
(
fd1
, &
sb1
);

1063 
î∫o1
 = 
î∫o
;

1065 
rc2
 = 
	`f°©
(
fd2
, &
sb2
);

1066 
î∫o2
 = 
î∫o
;

1068 i‡(
rc1
 !
rc2
 || 
î∫o1
 !
î∫o2
) {

1069 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1070 
	`¶og
(
LOG_DEBUG
, "%s: failed dueÅo fstat() onÜine %d",

1071 
fun˘i⁄
, 
__LINE__
);

1076 i‡(
rc1
 == -1) {

1077 
	`SASSERTX
(
rc2
 =-1 && 
î∫o1
 =
î∫o2
);

1079 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1080 
	`¶og
(
LOG_DEBUG
, "%s: failed dueÅoÑc1 onÜine %d",

1081 
fun˘i⁄
, 
__LINE__
);

1086 i‡(
sb1
.
°_öo
 == 0)

1087 
	`¶og
(
LOG_DEBUG
, "%s: socket inode is 0. Assuming kernel does "

1090 
fun˘i⁄
);

1091 i‡(
sb1
.
°_dev
 !
sb2
.st_dev

1092 || 
sb1
.
°_öo
 !
sb2
.st_ino) {

1093 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1094 
	`¶og
(
LOG_DEBUG
, "%s: failed dueÅo inode-compare onÜine %d "

1097 
fun˘i⁄
, 
__LINE__
,

1098 ()
sb1
.
°_dev
, ()
sb2
.st_dev,

1099 ()
sb1
.
°_öo
, ()
sb2
.st_ino);

1105 
Àn1
 = (
Êags1
);

1106 
rc1
 = 
	`gësock›t
(
fd1
, 
SOL_SOCKET
, 
ã°Êag
, &
Êags1
, &
Àn1
);

1107 
î∫o1
 = 
î∫o
;

1109 
Àn2
 = (
Êags2
);

1110 
rc2
 = 
	`gësock›t
(
fd1
, 
SOL_SOCKET
, 
ã°Êag
, &
Êags2
, &
Àn2
);

1111 
î∫o2
 = 
î∫o
;

1113 i‡(
rc1
 !
rc2
 || 
î∫o1
 !
î∫o2
 || 
Êags1
 !
Êags2
) {

1114 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1115 
	`¶og
(
LOG_DEBUG
, "%s: failed dueÅo flags/errno/len-compare onÜine %d",

1116 
fun˘i⁄
, 
__LINE__
);

1155 i‡(
rc1
 =-1 && 
rc2
 == -1) {

1156 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1157 
	`¶og
(
LOG_DEBUG
,

1159 
fun˘i⁄
, 
	`°ªº‹
(
î∫o1
), 
__LINE__
);

1164 i‡(
rc1
 =-1 && 
î∫o1
 =
ENOTSOCK
) {

1165 
	`SWARNX
(
fd1
);

1167 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1168 
	`¶og
(
LOG_DEBUG
, "%s: failed dueÅoÉrrno = ENOTSOCK onÜine %d",

1169 
fun˘i⁄
, 
__LINE__
);

1174 
	`¶og
(
LOG_DEBUG
, "%s:állÜooksÉqual so far, doing finalÅest, flags = %d",

1175 
fun˘i⁄
, 
Êags1
);

1177 
	`SASSERTX
(
Êags1
 =
Êags2
);

1179 i‡(
Êags1
)

1183 
£tÊag
 = 0;

1188 
£tÊag
 = 1;

1190 i‡(
	`£tsock›t
(
fd1
, 
SOL_SOCKET
, 
ã°Êag
, &
£tÊag
, (setflag)) != 0) {

1191 i‡(
	`£tsock›t
(
fd2
, 
SOL_SOCKET
, 
ã°Êag
, &
£tÊag
, (setflag)) != 0)

1193 
	`¶og
(
LOG_DEBUG
, "%s: succeeded dueÅo setsockopt() failing onÜine %d",

1194 
fun˘i⁄
, 
__LINE__
);

1199 i‡(
	`£tsock›t
(
fd2
, 
SOL_SOCKET
, 
ã°Êag
, &
Êags2
, (flags2))

1201 
	`¶og
(
LOG_DEBUG
, "%s: couldÇotÑestore original flags on fd %d: %s",

1202 
fun˘i⁄
, 
fd2
, 
	`°ªº‹
(
î∫o
));

1204 
	`¶og
(
LOG_DEBUG
, "%s: failed dueÅo setsockopt() failing onÜine %d",

1205 
fun˘i⁄
, 
__LINE__
);

1211 
Àn1
 = (
√wÊags1
);

1212 
rc1
 = 
	`gësock›t
(
fd1
, 
SOL_SOCKET
, 
ã°Êag
, &
√wÊags1
, &
Àn1
);

1213 
î∫o1
 = 
î∫o
;

1215 
Àn2
 = (
√wÊags2
);

1216 
rc2
 = 
	`gësock›t
(
fd2
, 
SOL_SOCKET
, 
ã°Êag
, &
√wÊags2
, &
Àn2
);

1217 
î∫o2
 = 
î∫o
;

1219 i‡(
√wÊags1
 =
√wÊags2
) {

1220 
	`¶og
(
LOG_DEBUG
, "%s:Çewflags1 =Çewflags2 -> %d isá dup of %d",

1221 
fun˘i⁄
, 
fd1
, 
fd2
);

1223 
isdup
 = 1;

1225 i‡(
rc1
 =-1 && 
rc2
 ==Ñc1

1226 && 
î∫o1
 =
î∫o2
) {

1227 
	`¶og
(
LOG_DEBUG
, "%s: flagcheck failed, butÑc (%d)ándÉrrno (%d) is "

1231 
fun˘i⁄
, 
rc1
, 
î∫o1
, 
fd1
, 
fd2
);

1232 
isdup
 = 1;

1235 
isdup
 = 0;

1238 
	`SASSERTX
(
Êags1
 =
Êags2
);

1239 ()
	`£tsock›t
(
fd1
, 
SOL_SOCKET
, 
ã°Êag
, &
Êags1
, (flags1));

1240 ()
	`£tsock›t
(
fd2
, 
SOL_SOCKET
, 
ã°Êag
, &
Êags2
, (flags2));

1242 
	`¶og
(
LOG_DEBUG
, "%s: finalÅest indicates fd %d %s of fd %d",

1243 
fun˘i⁄
, 
fd1
, 
isdup
 ? "i†®dup" : "i†nŸá dup", 
fd2
);

1245  
isdup
;

1246 
	}
}

1249 
	$makedummyfd
(
_ßÁmûy
, 
_sockty≥
)

1250 c⁄° 
ß_Ámûy_t
 
_ßÁmûy
;

1251 c⁄° 
_sockty≥
;

1253 c⁄° *
fun˘i⁄
 = "makedummyfd()";

1254 
sockaddr_°‹age
 
addr
;

1255 
ß_Ámûy_t
 
ßÁmûy
;

1256 
sockty≥
, 
s
;

1258 i‡(
_ßÁmûy
 == 0)

1259 
ßÁmûy
 = 
AF_INET
;

1261 
ßÁmûy
 = 
_ßÁmûy
;

1263 i‡(
_sockty≥
 == 0)

1264 
sockty≥
 = 
SOCK_DGRAM
;

1266 
sockty≥
 = 
_sockty≥
;

1268 i‡((
s
 = 
	`sockë
(
ßÁmûy
, 
sockty≥
, 0)) == -1) {

1269 
	`sw¨n
("%s: failedÅo create dummysocket ofÅype %s, socktype %s",

1270 
fun˘i⁄
, 
	`ßÁmûy2°rög
(
ßÁmûy
), 
	`sockty≥2°rög
(
sockty≥
));

1275 i‡(
sockty≥
 =
SOCK_DGRAM
)

1276  
s
;

1290 
	`bzîo
(&
addr
, (addr));

1291 
	`SET_SOCKADDR
(&
addr
, 
ßÁmûy
);

1293 i‡(
ßÁmûy
 =
AF_INET
)

1294 
	`TOIN
(&
addr
)->
sö_addr
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

1296 
	`SASSERTX
(
ßÁmûy
 =
AF_INET6
);

1297 
	`mem˝y
(&
	`TOIN6
(&
addr
)->
sö6_addr
, &
ö6addr_™y
, (in6addr_any));

1300 
	`SET_SOCKADDRPORT
(&
addr
, 
	`ht⁄s
(0));

1302 i‡(
	`socks_böd
(
s
, 
	`TOSS
(&
addr
), 0) != 0) {

1303 
	`sw¨n
("%s: couldÇot bindáddress (%s)",

1304 
fun˘i⁄
, 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

1306  
s
;

1309 i‡(
	`li°í
(
s
, 1) != 0) {

1310 
	`sw¨n
("%s: couldÇŸÜi°í(2Ë⁄ sockë", 
fun˘i⁄
);

1311  
s
;

1314  
s
;

1316 
	}
}

	@lib/socketopt.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

50 
£tc⁄fsock›ti⁄
(c⁄° 
ö
, c⁄° 
out
, c⁄° 
ß_Ámûy_t
 
ßÁmûy
,

51 c⁄° 
¥Ÿocﬁ
, c⁄° 
is˛õ¡side
,

52 c⁄° 
whichtime
, c⁄° 
sockë›ti⁄_t
 *
›t
);

56 
	$sockë›ti⁄check
(c⁄° 
sockë›ti⁄_t
 *
›ti⁄
)

59 i‡(
›ti⁄
->
öfo
->
Àvñ
 != option->level

60 && !–(
›ti⁄
->
Àvñ
 =
IPPROTO_UDP
 || o±i⁄->Àvñ =
IPPROTO_TCP
)

61 && 
›ti⁄
->
öfo
->
Àvñ
 =
SOL_SOCKET
))

62 
	`yyw¨nx
("to our knowledge socket option \"%s\" isÇot validátÅhe "

64 
›ti⁄
->
öfo
->
«me
,

65 
	`sock›éevñ2°rög
(
›ti⁄
->
Àvñ
),

66 
›ti⁄
->
Àvñ
);

68 i‡(
›ti⁄
->
öfo
->
mask
 != 0) {

69 
	`SASSERTX
(
›ti⁄
->
öfo
->
›ây≥
 =
öt_vÆ


70 || 
›ti⁄
->
öfo
->
›ây≥
 =
uch¨_vÆ
);

72 i‡((~
›ti⁄
->
öfo
->
mask
 & o±i⁄->
›tvÆ
.
öt_vÆ
) != 0)

73 
	`yyw¨nx
("to our knowledge socket option %s canÇot haveÅhe value %d",

74 
›ti⁄
->
öfo
->
«me
, o±i⁄->
›tvÆ
.
öt_vÆ
);

76 
	}
}

79 
	$addedsockë›ti⁄
(
›tc
, 
›tv
, 
√w›ti⁄
)

80 
size_t
 *
›tc
;

81 
sockë›ti⁄_t
 **
›tv
;

82 c⁄° 
sockë›ti⁄_t
 *
√w›ti⁄
;

84 c⁄° *
fun˘i⁄
 = "addedsocketoption()";

85 *
√w›tv
;

87 
	`¶og
(
LOG_DEBUG
, "%s:ádding socket option %s. Currently have %lu options",

88 
fun˘i⁄
, 
	`sock›t2°rög
(
√w›ti⁄
, 
NULL
, 0), ()*
›tc
);

90 i‡(
√w›ti⁄
->
öfo
 !
NULL
 &&Çew›ti⁄->öfo->
ˇŒty≥
 =
övÆid
) {

91 
	`yyw¨nx
("option \"%s\"Çot user settable, ignoring",

92 
√w›ti⁄
->
öfo
->
«me
);

97 i‡((
√w›tv
 = 
	`ªÆloc
(*
›tv
, (**›tvË* (*
›tc
 + 1))Ë=
NULL
) {

98 
	`yyw¨n
("couldÇotállocate %lu bytes of memoryÅoÉxpandÜist of "

100 ()((**
›tv
Ë* (*
›tc
 + 1)));

105 *
›tv
 = 
√w›tv
;

106 (*
›tv
)[(*
›tc
)++] = *
√w›ti⁄
;

109 
	}
}

112 
	$£tc⁄fsock›ti⁄s
(
èrgë
, 
ö
, 
¥Ÿocﬁ
, 
is˛õ¡side
, 
›tc
, 
›tv
,

113 
whichloˇls
, 
whichglobÆs
)

114 c⁄° 
èrgë
;

115 c⁄° 
ö
;

116 c⁄° 
¥Ÿocﬁ
;

117 c⁄° 
is˛õ¡side
;

118 c⁄° 
size_t
 
›tc
;

119 c⁄° 
sockë›ti⁄_t
 *
›tv
;

120 c⁄° 
whichloˇls
;

121 c⁄° 
whichglobÆs
;

123 c⁄° *
fun˘i⁄
 = "setconfsockoptions()";

124 
sockaddr
 
addr
;

125 
sockÀn_t
 
Àn
;

126 
size_t
 
i
;

128 
	`¶og
(
LOG_DEBUG
,

131 
fun˘i⁄
,

132 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
),

133 
èrgë
,

134 
ö
,

135 
is˛õ¡side
 ? "internal" : "external");

137 
Àn
 = (
addr
);

138 i‡(
	`gësock«me
(
èrgë
, &
addr
, &
Àn
) != 0) {

139 
	`¶og
(
LOG_DEBUG
, "%s: getsockname(2) onÅarget-fd %d failed: %s",

140 
fun˘i⁄
, 
èrgë
, 
	`°ªº‹
(
î∫o
));

145 i‡(
whichglobÆs
) {

151 
	`¶og
(
LOG_DEBUG
,

154 
fun˘i⁄
,

155 ()
sockscf
.
sockë›ti⁄c
,

156 
whichglobÆs
,

157 
	`sockë£âime2°rög
(
whichglobÆs
));

159 
i
 = 0; i < 
sockscf
.
sockë›ti⁄c
; ++i)

160 
	`£tc⁄fsock›ti⁄
(
èrgë
,

161 
ö
,

162 
addr
.
ß_Ámûy
,

163 
¥Ÿocﬁ
,

164 
is˛õ¡side
,

165 
whichglobÆs
,

166 &
sockscf
.
sockë›ti⁄v
[
i
]);

169 i‡(
whichloˇls
) {

170 
	`¶og
(
LOG_DEBUG
,

173 
fun˘i⁄
, ()
›tc
, 
whichloˇls
);

175 
i
 = 0; i < 
›tc
; ++i)

176 
	`£tc⁄fsock›ti⁄
(
èrgë
,

177 
ö
,

178 
addr
.
ß_Ámûy
,

179 
¥Ÿocﬁ
,

180 
is˛õ¡side
,

181 
whichloˇls
,

182 &
›tv
[
i
]);

184 
	}
}

187 
	$£tc⁄fsock›ti⁄
(
èrgë
, 
ö
, 
ßÁmûy
, 
¥Ÿocﬁ
, 
is˛õ¡side
, 
whichtime
, 
›t
)

188 c⁄° 
èrgë
;

189 c⁄° 
ö
;

190 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

191 c⁄° 
¥Ÿocﬁ
;

192 c⁄° 
is˛õ¡side
;

193 c⁄° 
whichtime
;

194 c⁄° 
sockë›ti⁄_t
 *
›t
;

196 c⁄° *
fun˘i⁄
 = "setconfsockoption()";

197 
sockë›tvÆue_t
 
√wvÆue
;

198 
sockÀn_t
 
Àn
;

199 
rc
;

201 
	`¶og
(
LOG_DEBUG
,

204 
fun˘i⁄
,

205 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
),

206 
is˛õ¡side
 ? "internal" : "external",

207 
	`sock›t2°rög
(
›t
, 
NULL
, 0),

208 
	`sockë£âime2°rög
(
whichtime
),

209 
whichtime
,

210 
	`ßÁmûy2°rög
(
ßÁmûy
));

212 i‡(
›t
->
öfo
 !
NULL
) {

213 i‡(
ßÁmûy
 =
AF_INET
 && !
›t
->
öfo
->
ùv4_⁄
)

216 i‡(
ßÁmûy
 =
AF_INET6
 && !
›t
->
öfo
->
ùv6_⁄
)

219 i‡(((
whichtime
 & 
SOCKETOPT_ANYTIME
Ë&& 
›t
->
öfo
->
ˇŒty≥
 =
™ytime
)

220 || ((
whichtime
 & 
SOCKETOPT_PRE
Ë&& 
›t
->
öfo
->
ˇŒty≥
 =
¥e⁄ly
)

221 || ((
whichtime
 & 
SOCKETOPT_POST
Ë&& 
›t
->
öfo
->
ˇŒty≥
 =
po°⁄ly
))

227 i‡(
›t
->
isöã∫Æside
 && !
is˛õ¡side
)

230 i‡(!
›t
->
isöã∫Æside
 && 
is˛õ¡side
)

236 
	#ANY_L4_PROTOCOL
(
sockëÀvñ
) \

237 ((
sockëÀvñ
Ë=
SOL_SOCKET
 || (sockëÀvñË=
IPPROTO_IP
)

	)

239 i‡(
¥Ÿocﬁ
 =
SOCKS_TCP


240 && !(
	`ANY_L4_PROTOCOL
(
›t
->
Àvñ
Ë|| o±->Àvñ =
IPPROTO_TCP
))

243 i‡(
¥Ÿocﬁ
 =
SOCKS_UDP


244 && !(
	`ANY_L4_PROTOCOL
(
›t
->
Àvñ
Ë|| o±->Àvñ =
IPPROTO_UDP
))

247 
	`¶og
(
LOG_DEBUG
, "%s: sëtög %s", 
fun˘i⁄
, 
	`sock›t2°rög
(
›t
, 
NULL
, 0));

249 i‡(
›t
->
öfo
 !
NULL
) {

250 i‡(
›t
->
öfo
->
shi·
) {

251 
sockë›tvÆue_t
 
ﬁdvÆue
;

252 c⁄° 
mask
 = 
›t
->
öfo
->mask << o±->öfo->
shi·
;

254 
	`SASSERTX
(
›t
->
öfo
->
›ây≥
 =
öt_vÆ


255 || 
›t
->
öfo
->
›ây≥
 =
uch¨_vÆ
);

257 
	`bzîo
(&
ﬁdvÆue
, (oldvalue));

259 
›t
->
›ây≥
) {

260 
öt_vÆ
:

261 
√wvÆue
.
öt_vÆ
 = 
›t
->
›tvÆ
.öt_vÆ << o±->
öfo
->
shi·
;

262 
ﬁdvÆue
.
öt_vÆ
 &(~
mask
);

263 
√wvÆue
.
öt_vÆ
 |
ﬁdvÆue
.int_val;

266 
uch¨_vÆ
:

267 
√wvÆue
.
uch¨_vÆ

›t
->
›tvÆ
.uch¨_vÆ << o±->
öfo
->
shi·
;

268 
ﬁdvÆue
.
uch¨_vÆ
 &(~
mask
);

269 
√wvÆue
.
uch¨_vÆ
 |
ﬁdvÆue
.uchar_val;

273 
	`SERRX
(
›t
->
›ây≥
);

277 
√wvÆue
 = 
›t
->
›tvÆ
;

280 
√wvÆue
 = 
›t
->
›tvÆ
;

282 #i‡!
SOCKS_CLIENT


283 i‡(
›t
->
öfo
 !
NULL
 && o±->öfo->
√ed¥iv
)

284 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

287 
›t
->
›äame
) {

292 #i‡
HAVE_SOCKS_HOSTID


293 #ifde‡
TCP_IPA


294 
TCP_IPA
: {

295 
sockaddr_°‹age
 
øddr
;

296 
ö_addr
 
ho°idv
[
HAVE_MAX_HOSTIDS
];

297 
ho°idc
;

298 
gëøddr
, 
gëho°id
;

300 
√wvÆue
.
öt_vÆ
) {

301 
SOCKS_HOSTID_NONE
:

302 
gëøddr
 = 0;

303 
gëho°id
 = 0;

306 
SOCKS_HOSTID_SETCLIENT
:

307 
gëøddr
 = 1;

308 
gëho°id
 = 0;

311 
SOCKS_HOSTID_PASS
:

312 
SOCKS_HOSTID_ADDCLIENT
:

313 
gëøddr
 = 1;

314 
gëho°id
 = 1;

318 
	`SERRX
(0);

322 i‡(
gëøddr
) {

323 
Àn
 = (
øddr
);

324 i‡(
	`gë≥î«me
(
ö
, 
	`TOSA
(&
øddr
), &
Àn
) == -1) {

325 
	`¶og
(
LOG_DEBUG
,

328 
fun˘i⁄
, 
ö
, 
	`°ªº‹
(
î∫o
));

333 i‡(
gëho°id
) {

334 
	`SASSERTX
(
gëøddr
);

336 
ho°idc
 = 
	`gësockëho°id
(
ö
, 
	`ELEMENTS
(
ho°idv
), hostidv);

337 
	`¶og
(
LOG_DEBUG
, "%s:Ñetrieved %u hostids on fd %d from client %s",

338 
fun˘i⁄
,

339 ()
ho°idc
,

340 
ö
,

341 
	`sockaddr2°rög
(&
øddr
, 
NULL
, 0));

344 
√wvÆue
.
öt_vÆ
) {

345 
SOCKS_HOSTID_NONE
:

346 
ho°idc
 = 0;

349 
SOCKS_HOSTID_SETCLIENT
:

350 
ho°idv
[0] = 
	`TOIN
(&
øddr
)->
sö_addr
;

351 
ho°idc
 = 1;

354 
SOCKS_HOSTID_PASS
:

355 
	`SASSERTX
(
gëho°id
);

358 
SOCKS_HOSTID_ADDCLIENT
:

359 
	`SASSERTX
(
gëho°id
);

360 i‡((
size_t
)(
ho°idc
Ë+ 1 > 
	`ELEMENTS
(
ho°idv
)) {

361 
¡›
[
MAXSOCKADDRSTRING
];

363 
	`SASSERTX
(
gëøddr
);

365 i‡(
	`öë_¡›
(
AF_INET
,

366 &
ho°idv
[
ho°idc
 - 1],

367 
¡›
,

368 (
¡›
)Ë=
NULL
) {

369 
	`sw¨n
("%s: inet_ntop(3) failed on %s %x",

370 
fun˘i⁄
,

371 
	`©y≥2°rög
(
SOCKS_ADDR_IPV4
),

372 
ho°idv
[
ho°idc
 - 1].
s_addr
);

374 
	`¢¥ötf
(
¡›
, (ntop), "<unknown>");

377 
	`¶og
(
LOG_WARNING
,

381 
fun˘i⁄
,

382 
	`sockaddr2°rög
(&
øddr
, 
NULL
, 0),

383 ()
ho°idc
,

384 
¡›
);

386 
ho°idc
 = ()
	`ELEMENTS
(
ho°idv
) - 1;

389 
ho°idv
[
ho°idc
++] = 
	`TOIN
(&
øddr
)->
sö_addr
;

393 
	`SERRX
(
√wvÆue
.
öt_vÆ
);

397 
Àn
 = (*
ho°idv
Ë* 
ho°idc
;

398 i‡((
rc
 = 
	`£tsockëho°id
(
èrgë
, 
ho°idc
, 
ho°idv
)) != 0)

399 
	`sw¨n
("%s: setsockethostid() on fd %d failed",

400 
fun˘i⁄
, 
èrgë
);

411 
Àn
 = 
	`SOCKETOPTVALUETYPE2SIZE
(
›t
->
›ây≥
);

412 
rc
 = 
	`£tsock›t
(
èrgë
,

413 
›t
->
öfo
 =
NULL
 ? o±->
Àvñ
 : opt->info->level,

414 
›t
->
›äame
,

415 &
√wvÆue
,

416 
Àn
);

419 i‡(
rc
 != 0)

420 
	`sw¨n
("%s: failedÅo set socket option %s of size %lu",

421 
fun˘i⁄
, 
	`sock›t2°rög
(
›t
, 
NULL
, 0), ()
Àn
);

423 
	`¶og
(
LOG_DEBUG
, "%s: set option %sÅo %s (len %d)",

424 
fun˘i⁄
,

425 
	`sock›t2°rög
(
›t
, 
NULL
, 0),

426 
	`sock›tvÆ2°rög
(
√wvÆue
, 
›t
->
›ây≥
, 
NULL
, 0),

427 
Àn
);

430 #i‡!
SOCKS_CLIENT


431 i‡(
›t
->
öfo
 !
NULL
 && o±->öfo->
√ed¥iv
)

432 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

434 
	}
}

	@lib/sockopt.c

44 
	~"comm⁄.h
"

46 
	~"qos.h
"

48 c⁄° 
	grcsid
[] =

51 
	s›ti⁄
 {

52 
	mÀvñ
;

53 
	m›äame
;

54 *
	m›t°r
;

56 c⁄° 
›ti⁄
 
	g›ti⁄
[];

57 c⁄° 
sock›t_t
 
	gsock›ts
[];

58 c⁄° 
sock›tvÆsym_t
 
	gsock›tvÆsyms
[];

62 
	$sockë›tdup
(
s
, 
√w_s
)

63 
s
;

64 
√w_s
;

66 c⁄° *
fun˘i⁄
 = "socketoptdup()";

67 
i
;

68 
Êags
, 
î∫o_s
;

69 
sockÀn_t
 
Àn
;

70 
sockë›tvÆue_t
 
vÆ
;

72 
î∫o_s
 = 
î∫o
;

74 
	`¶og
(
LOG_DEBUG
, "%s: fd %d, fd %d", 
fun˘i⁄
, 
s
, 
√w_s
);

76 i‡(
√w_s
 == -1) {

77 
sockaddr_°‹age
 
addr
;

78 
domaö
;

80 
Àn
 = (
addr
);

81 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
addr
), &
Àn
) == -1) {

82 
	`sw¨n
("%s: gësock«me(2ËÁûed" , 
fun˘i⁄
);

86 
domaö
 = 
addr
.
ss_Ámûy
;

88 
Àn
 = (
vÆ
.
öt_vÆ
);

89 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
vÆ
, &
Àn
) == -1) {

90 
	`sw¨n
("%s: gësock›t(SO_TYPEËÁûed", 
fun˘i⁄
);

94 i‡((
√w_s
 = 
	`sockë
(
domaö
, 
vÆ
.
öt_vÆ
, 0)) == -1) {

95 
	`sw¨n
("%s: sockë(%d, %d)", 
fun˘i⁄
, 
domaö
, 
vÆ
.
öt_vÆ
);

100 
i
 = 0; i < 
HAVE_DUPSOCKOPT_MAX
; ++i) {

101 
Àn
 = (
vÆ
);

102 i‡(
	`gësock›t
(
s
, 
›ti⁄
[
i
].
Àvñ
, o±i⁄[i].
›äame
, &
vÆ
, &
Àn
) == -1) {

103 i‡(
î∫o
 !
ENOPROTOOPT
)

104 
	`¶og
(
LOG_DEBUG
, "%s: getsockopt(%d, %d) failed: %s",

105 
fun˘i⁄
, 
›ti⁄
[
i
].
Àvñ
, o±i⁄[i].
›äame
, 
	`°ªº‹
(
î∫o
));

110 i‡(
	`£tsock›t
(
√w_s
, 
›ti⁄
[
i
].
Àvñ
, o±i⁄[i].
›äame
, &
vÆ
, 
Àn
)

112 i‡(
î∫o
 !
ENOPROTOOPT
)

113 
	`¶og
(
LOG_DEBUG
, "%s: setsockopt(%d, %d) failed: %s",

114 
fun˘i⁄
, 
›ti⁄
[
i
].
Àvñ
, o±i⁄[i].
›äame
, 
	`°ªº‹
(
î∫o
));

117 i‡((
Êags
 = 
	`f˙é
(
s
, 
F_GETFL
, 0)) == -1

118 || 
	`f˙é
(
√w_s
, 
F_SETFL
, 
Êags
) == -1)

119 
	`sw¨n
("%s: f˙é(F_GETFL/F_SETFL)", 
fun˘i⁄
);

121 
î∫o
 = 
î∫o_s
;

122  
√w_s
;

123 
	}
}

125 #i‡
DEBUG


127 
	$¥ötsockë›ts
(
s
)

128 c⁄° 
s
;

130 c⁄° *
fun˘i⁄
 = "printsocketopts()";

131 
i
;

132 
Êags
, 
î∫o_s
;

133 
sockÀn_t
 
Àn
;

134 
sockë›tvÆue_t
 
vÆ
;

136 
î∫o_s
 = 
î∫o
;

138 
Àn
 = (
vÆ
);

139 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
vÆ
, &
Àn
) == -1) {

140 
	`sw¨n
("%s: gësock›t(SO_TYPE)", 
fun˘i⁄
);

144 
i
 = 0; i < 
HAVE_DUPSOCKOPT_MAX
; ++i) {

145 
Àn
 = (
vÆ
);

146 i‡(
	`gësock›t
(
s
, 
›ti⁄
[
i
].
Àvñ
, o±i⁄[i].
›äame
, &
vÆ
, &
Àn
) == -1) {

147 i‡(
î∫o
 !
ENOPROTOOPT
)

148 
	`sw¨n
("%s: gësock›t(%sËÁûed", 
fun˘i⁄
, 
›ti⁄
[
i
].
›t°r
);

153 
	`¶og
(
LOG_DEBUG
, "%s: value of socket option \"%s\" is %d\n",

154 
fun˘i⁄
, 
›ti⁄
[
i
].
›t°r
, 
vÆ
.
öt_vÆ
);

157 i‡((
Êags
 = 
	`f˙é
(
s
, 
F_GETFL
, 0)) == -1)

158 
	`sw¨n
("%s: f˙é(F_GETFL)", 
fun˘i⁄
);

160 
	`¶og
(
LOG_DEBUG
, "%s: vÆuêo‡fûê°©u†Êags: %d\n", 
fun˘i⁄
, 
Êags
);

162 i‡((
Êags
 = 
	`f˙é
(
s
, 
F_GETFD
, 0)) == -1)

163 
	`sw¨n
("fcntl(F_GETFD)");

165 
	`¶og
(
LOG_DEBUG
, "%s: value of file descriptor flags: %d\n",

166 
fun˘i⁄
, 
Êags
);

168 
î∫o
 = 
î∫o_s
;

169 
	}
}

174 
	$sock›ts_dump
()

176 c⁄° *
fun˘i⁄
 = "sockopts_dump()";

177 
i
;

179 
	`¶og
(
LOG_DEBUG
, "%s: socket optionÇame (level/value) (%dÉntries):",

180 
fun˘i⁄
, 
HAVE_SOCKOPTVAL_MAX
);

182 
i
 = 0; i < 
HAVE_SOCKOPTVAL_MAX
; i++)

183 
	`¶og
(
LOG_DEBUG
, "%s: %02d: %s (%d/%d)",

184 
fun˘i⁄
, 
i
, 
sock›ts
[i].
«me
, sock›ts[i].
Àvñ
, sock›ts[i].
vÆue
);

186 
	`¶og
(
LOG_DEBUG
, "%s: socket option symbolic values (%dÉntries):",

187 
fun˘i⁄
, 
HAVE_SOCKOPTVALSYM_MAX
);

189 
i
 = 0; i < 
HAVE_SOCKOPTVALSYM_MAX
; i++) {

190 c⁄° 
sock›t_t
 *
›t
;

192 
	`SASSERTX
(
sock›tvÆsyms
[
i
].
›tid
 < 
HAVE_SOCKOPTVAL_MAX
);

194 
›t
 = &
sock›ts
[
sock›tvÆsyms
[
i
].
›tid
];

196 
	`¶og
(
LOG_DEBUG
, "%s: %02d: %s: %s (%s)",

197 
fun˘i⁄
,

198 
i
,

199 
›t
->
«me
,

200 
sock›tvÆsyms
[
i
].
«me
,

201 
	`sock›tvÆ2°rög
(
sock›tvÆsyms
[
i
].
symvÆ
, 
›t
->
›ây≥
, 
NULL
, 0));

203 
	}
}

205 c⁄° 
sock›t_t
 *

206 
	$›äame2sock›t
(*
«me
)

208 
i
;

210 
i
 = 0; i < 
HAVE_SOCKOPTVAL_MAX
; i++) {

211 i‡(
	`°rcmp
(
«me
, 
sock›ts
[
i
].name) == 0)

212  &
sock›ts
[
i
];

215  
NULL
;

216 
	}
}

218 c⁄° 
sock›t_t
 *

219 
	$›tvÆ2sock›t
(
Àvñ
, 
vÆue
)

221 
i
;

223 
i
 = 0; i < 
HAVE_SOCKOPTVAL_MAX
; i++) {

224 i‡(
Àvñ
 =
sock›ts
[
i
].Àvñ && 
vÆue
 == sockopts[i].value)

225  &
sock›ts
[
i
];

228  
NULL
;

229 
	}
}

231 c⁄° 
sock›t_t
 *

232 
	$›tid2sock›t
(
size_t
 
›tid
)

234 
	`SASSERTX
(
›tid
 < 
HAVE_SOCKOPTVAL_MAX
);

236  &
sock›ts
[
›tid
];

237 
	}
}

239 c⁄° 
sock›tvÆsym_t
 *

240 
	$›tvÆ2vÆsym
(
size_t
 
›tid
, *
«me
)

242 
i
;

244 
i
 = 0; i < 
HAVE_SOCKOPTVALSYM_MAX
; i++) {

245 i‡(
›tid
 =
sock›tvÆsyms
[
i
].optid

246 && 
	`°rcmp
(
«me
, 
sock›tvÆsyms
[
i
].name) == 0)

247  &
sock›tvÆsyms
[
i
];

250  
NULL
;

251 
	}
}

256 
	~"sock›t_gí.c
"

	@lib/sockopt_gen.c

3 c⁄° 
›ti⁄
 
	g›ti⁄
[] = {

4 { 
SOL_SOCKET
, 
SO_BROADCAST
, "SO_BROADCAST" },

5 { 
SOL_SOCKET
, 
SO_DEBUG
, "SO_DEBUG" },

6 { 
SOL_SOCKET
, 
SO_DONTROUTE
, "SO_DONTROUTE" },

7 { 
SOL_SOCKET
, 
SO_KEEPALIVE
, "SO_KEEPALIVE" },

8 { 
SOL_SOCKET
, 
SO_LINGER
, "SO_LINGER" },

9 { 
SOL_SOCKET
, 
SO_OOBINLINE
, "SO_OOBINLINE" },

10 { 
SOL_SOCKET
, 
SO_RCVBUF
, "SO_RCVBUF" },

11 { 
SOL_SOCKET
, 
SO_RCVLOWAT
, "SO_RCVLOWAT" },

12 { 
SOL_SOCKET
, 
SO_RCVTIMEO
, "SO_RCVTIMEO" },

13 { 
SOL_SOCKET
, 
SO_SNDBUF
, "SO_SNDBUF" },

14 { 
SOL_SOCKET
, 
SO_SNDLOWAT
, "SO_SNDLOWAT" },

15 { 
SOL_SOCKET
, 
SO_SNDTIMEO
, "SO_SNDTIMEO" },

16 { 
SOL_SOCKET
, 
SO_TIMESTAMP
, "SO_TIMESTAMP" },

17 { 
IPPROTO_TCP
, 
TCP_MAXSEG
, "TCP_MAXSEG" },

18 { 
IPPROTO_TCP
, 
TCP_NODELAY
, "TCP_NODELAY" },

19 { 
IPPROTO_IP
, 
IP_TOS
, "IP_TOS" },

20 { 
IPPROTO_IP
, 
IP_TTL
, "IP_TTL" },

21 { 
SOL_SOCKET
, 
SO_REUSEADDR
, "SO_REUSEADDR" },

22 { 
SOL_SOCKET
, 
SO_REUSEPORT
, "SO_REUSEPORT" },

23 { 
IPPROTO_IP
, 
IP_HDRINCL
, "IP_HDRINCL" },

24 { 
IPPROTO_IP
, 
IP_HDRINCL
, "IP_HDRINCL" },

25 { 
IPPROTO_IP
, 
IP_MULTICAST_IF
, "IP_MULTICAST_IF" },

26 { 
IPPROTO_IP
, 
IP_MULTICAST_LOOP
, "IP_MULTICAST_LOOP" },

27 { 
IPPROTO_IP
, 
IP_MULTICAST_TTL
, "IP_MULTICAST_TTL" },

28 { 
IPPROTO_IP
, 
IP_OPTIONS
, "IP_OPTIONS" },

31 c⁄° 
sock›t_t
 
	gsock›ts
[] = {

32 { 0, 
öt_vÆ
, 
SO_BROADCAST
, 
SOCKS_SO_BROADCAST_LVL
, 
SOCKS_SO_BROADCAST_IPV4
, 
SOCKS_SO_BROADCAST_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_BROADCAST_NAME
 },

33 { 1, 
öt_vÆ
, 
SO_DEBUG
, 
SOCKS_SO_DEBUG_LVL
, 
SOCKS_SO_DEBUG_IPV4
, 
SOCKS_SO_DEBUG_IPV6
, 
™ytime
, 0, 0, 0, 1, 
SOCKS_SO_DEBUG_NAME
 },

34 { 2, 
öt_vÆ
, 
SO_DONTROUTE
, 
SOCKS_SO_DONTROUTE_LVL
, 
SOCKS_SO_DONTROUTE_IPV4
, 
SOCKS_SO_DONTROUTE_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_DONTROUTE_NAME
 },

35 { 3, 
öt_vÆ
, 
SO_KEEPALIVE
, 
SOCKS_SO_KEEPALIVE_LVL
, 
SOCKS_SO_KEEPALIVE_IPV4
, 
SOCKS_SO_KEEPALIVE_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_KEEPALIVE_NAME
 },

36 { 4, 
lögî_vÆ
, 
SO_LINGER
, 
SOCKS_SO_LINGER_LVL
, 
SOCKS_SO_LINGER_IPV4
, 
SOCKS_SO_LINGER_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_LINGER_NAME
 },

37 { 5, 
öt_vÆ
, 
SO_OOBINLINE
, 
SOCKS_SO_OOBINLINE_LVL
, 
SOCKS_SO_OOBINLINE_IPV4
, 
SOCKS_SO_OOBINLINE_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_OOBINLINE_NAME
 },

38 { 6, 
öt_vÆ
, 
SO_PRIORITY
, 
SOCKS_SO_PRIORITY_LVL
, 
SOCKS_SO_PRIORITY_IPV4
, 
SOCKS_SO_PRIORITY_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_PRIORITY_NAME
 },

39 { 7, 
öt_vÆ
, 
SO_RCVBUF
, 
SOCKS_SO_RCVBUF_LVL
, 
SOCKS_SO_RCVBUF_IPV4
, 
SOCKS_SO_RCVBUF_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_RCVBUF_NAME
 },

40 { 8, 
öt_vÆ
, 
SO_RCVBUFFORCE
, 
SOCKS_SO_RCVBUFFORCE_LVL
, 
SOCKS_SO_RCVBUFFORCE_IPV4
, 
SOCKS_SO_RCVBUFFORCE_IPV6
, 
¥e⁄ly
, 0, 0, 0, 1, 
SOCKS_SO_RCVBUFFORCE_NAME
 },

41 { 9, 
öt_vÆ
, 
SO_RCVLOWAT
, 
SOCKS_SO_RCVLOWAT_LVL
, 
SOCKS_SO_RCVLOWAT_IPV4
, 
SOCKS_SO_RCVLOWAT_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_RCVLOWAT_NAME
 },

42 { 10, 
timevÆ_vÆ
, 
SO_RCVTIMEO
, 
SOCKS_SO_RCVTIMEO_LVL
, 
SOCKS_SO_RCVTIMEO_IPV4
, 
SOCKS_SO_RCVTIMEO_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_RCVTIMEO_NAME
 },

43 { 11, 
öt_vÆ
, 
SO_SNDBUF
, 
SOCKS_SO_SNDBUF_LVL
, 
SOCKS_SO_SNDBUF_IPV4
, 
SOCKS_SO_SNDBUF_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_SNDBUF_NAME
 },

44 { 12, 
öt_vÆ
, 
SO_SNDBUFFORCE
, 
SOCKS_SO_SNDBUFFORCE_LVL
, 
SOCKS_SO_SNDBUFFORCE_IPV4
, 
SOCKS_SO_SNDBUFFORCE_IPV6
, 
¥e⁄ly
, 0, 0, 0, 1, 
SOCKS_SO_SNDBUFFORCE_NAME
 },

45 { 13, 
öt_vÆ
, 
SO_SNDLOWAT
, 
SOCKS_SO_SNDLOWAT_LVL
, 
SOCKS_SO_SNDLOWAT_IPV4
, 
SOCKS_SO_SNDLOWAT_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_SNDLOWAT_NAME
 },

46 { 14, 
timevÆ_vÆ
, 
SO_SNDTIMEO
, 
SOCKS_SO_SNDTIMEO_LVL
, 
SOCKS_SO_SNDTIMEO_IPV4
, 
SOCKS_SO_SNDTIMEO_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_SNDTIMEO_NAME
 },

47 { 15, 
öt_vÆ
, 
SO_TIMESTAMP
, 
SOCKS_SO_TIMESTAMP_LVL
, 
SOCKS_SO_TIMESTAMP_IPV4
, 
SOCKS_SO_TIMESTAMP_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_SO_TIMESTAMP_NAME
 },

48 { 16, 
öt_vÆ
, 
TCP_CORK
, 
SOCKS_TCP_CORK_LVL
, 
SOCKS_TCP_CORK_IPV4
, 
SOCKS_TCP_CORK_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_CORK_NAME
 },

49 { 17, 
öt_vÆ
, 
TCP_KEEPCNT
, 
SOCKS_TCP_KEEPCNT_LVL
, 
SOCKS_TCP_KEEPCNT_IPV4
, 
SOCKS_TCP_KEEPCNT_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_KEEPCNT_NAME
 },

50 { 18, 
öt_vÆ
, 
TCP_KEEPIDLE
, 
SOCKS_TCP_KEEPIDLE_LVL
, 
SOCKS_TCP_KEEPIDLE_IPV4
, 
SOCKS_TCP_KEEPIDLE_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_KEEPIDLE_NAME
 },

51 { 19, 
öt_vÆ
, 
TCP_KEEPINTVL
, 
SOCKS_TCP_KEEPINTVL_LVL
, 
SOCKS_TCP_KEEPINTVL_IPV4
, 
SOCKS_TCP_KEEPINTVL_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_KEEPINTVL_NAME
 },

52 { 20, 
öt_vÆ
, 
TCP_LINGER2
, 
SOCKS_TCP_LINGER2_LVL
, 
SOCKS_TCP_LINGER2_IPV4
, 
SOCKS_TCP_LINGER2_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_LINGER2_NAME
 },

53 { 21, 
öt_vÆ
, 
TCP_MAXSEG
, 
SOCKS_TCP_MAXSEG_LVL
, 
SOCKS_TCP_MAXSEG_IPV4
, 
SOCKS_TCP_MAXSEG_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_MAXSEG_NAME
 },

54 { 22, 
öt_vÆ
, 
TCP_MD5SIG
, 
SOCKS_TCP_MD5SIG_LVL
, 
SOCKS_TCP_MD5SIG_IPV4
, 
SOCKS_TCP_MD5SIG_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_MD5SIG_NAME
 },

55 { 23, 
öt_vÆ
, 
TCP_NODELAY
, 
SOCKS_TCP_NODELAY_LVL
, 
SOCKS_TCP_NODELAY_IPV4
, 
SOCKS_TCP_NODELAY_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_NODELAY_NAME
 },

56 { 24, 
öt_vÆ
, 
TCP_SYNCNT
, 
SOCKS_TCP_SYNCNT_LVL
, 
SOCKS_TCP_SYNCNT_IPV4
, 
SOCKS_TCP_SYNCNT_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_SYNCNT_NAME
 },

57 { 25, 
öt_vÆ
, 
TCP_WINDOW_CLAMP
, 
SOCKS_TCP_WINDOW_CLAMP_LVL
, 
SOCKS_TCP_WINDOW_CLAMP_IPV4
, 
SOCKS_TCP_WINDOW_CLAMP_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_TCP_WINDOW_CLAMP_NAME
 },

58 { 26, 
öt_vÆ
, 
UDP_CORK
, 
SOCKS_UDP_CORK_LVL
, 
SOCKS_UDP_CORK_IPV4
, 
SOCKS_UDP_CORK_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_UDP_CORK_NAME
 },

59 { 27, 
öt_vÆ
, 
IP_FREEBIND
, 
SOCKS_IP_FREEBIND_LVL
, 
SOCKS_IP_FREEBIND_IPV4
, 
SOCKS_IP_FREEBIND_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IP_FREEBIND_NAME
 },

60 { 28, 
öt_vÆ
, 
IP_MINTTL
, 
SOCKS_IP_MINTTL_LVL
, 
SOCKS_IP_MINTTL_IPV4
, 
SOCKS_IP_MINTTL_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IP_MINTTL_NAME
 },

61 { 29, 
öt_vÆ
, 
IP_MTU_DISCOVER
, 
SOCKS_IP_MTU_DISCOVER_LVL
, 
SOCKS_IP_MTU_DISCOVER_IPV4
, 
SOCKS_IP_MTU_DISCOVER_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IP_MTU_DISCOVER_NAME
 },

62 { 30, 
öt_vÆ
, 
IP_TOS
, 
SOCKS_IP_TOS_LVL
, 
SOCKS_IP_TOS_IPV4
, 
SOCKS_IP_TOS_IPV6
, 
™ytime
, 0, 0, 0, 0, 
SOCKS_IP_TOS_NAME
 },

63 { 31, 
öt_vÆ
, 
IP_TOS
, 
SOCKS_IP_TOS_LVL
, 
SOCKS_IP_TOS_IPV4
, 
SOCKS_IP_TOS_IPV6
, 
™ytime
, 2, 0x3F, 0, 0, 
SOCKS_IP_TOS_DSCP_NAME
 },

64 { 32, 
öt_vÆ
, 
IP_TOS
, 
SOCKS_IP_TOS_LVL
, 
SOCKS_IP_TOS_IPV4
, 
SOCKS_IP_TOS_IPV6
, 
™ytime
, 5, 0x7, 0, 0, 
SOCKS_IP_TOS_PREC_NAME
 },

65 { 33, 
öt_vÆ
, 
IP_TOS
, 
SOCKS_IP_TOS_LVL
, 
SOCKS_IP_TOS_IPV4
, 
SOCKS_IP_TOS_IPV6
, 
™ytime
, 1, 0xf, 0, 0, 
SOCKS_IP_TOS_TOS_NAME
 },

66 { 34, 
öt_vÆ
, 
IP_TTL
, 
SOCKS_IP_TTL_LVL
, 
SOCKS_IP_TTL_IPV4
, 
SOCKS_IP_TTL_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IP_TTL_NAME
 },

67 { 35, 
öt_vÆ
, 
IPV6_ADDRFORM
, 
SOCKS_IPV6_ADDRFORM_LVL
, 
SOCKS_IPV6_ADDRFORM_IPV4
, 
SOCKS_IPV6_ADDRFORM_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_ADDRFORM_NAME
 },

68 { 36, 
öt_vÆ
, 
IPV6_UNICAST_HOPS
, 
SOCKS_IPV6_UNICAST_HOPS_LVL
, 
SOCKS_IPV6_UNICAST_HOPS_IPV4
, 
SOCKS_IPV6_UNICAST_HOPS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_UNICAST_HOPS_NAME
 },

69 { 37, 
öt_vÆ
, 
IPV6_2292DSTOPTS
, 
SOCKS_IPV6_2292DSTOPTS_LVL
, 
SOCKS_IPV6_2292DSTOPTS_IPV4
, 
SOCKS_IPV6_2292DSTOPTS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_2292DSTOPTS_NAME
 },

70 { 38, 
öt_vÆ
, 
IPV6_2292HOPLIMIT
, 
SOCKS_IPV6_2292HOPLIMIT_LVL
, 
SOCKS_IPV6_2292HOPLIMIT_IPV4
, 
SOCKS_IPV6_2292HOPLIMIT_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_2292HOPLIMIT_NAME
 },

71 { 39, 
öt_vÆ
, 
IPV6_2292HOPOPTS
, 
SOCKS_IPV6_2292HOPOPTS_LVL
, 
SOCKS_IPV6_2292HOPOPTS_IPV4
, 
SOCKS_IPV6_2292HOPOPTS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_2292HOPOPTS_NAME
 },

72 { 40, 
öt_vÆ
, 
IPV6_2292PKTINFO
, 
SOCKS_IPV6_2292PKTINFO_LVL
, 
SOCKS_IPV6_2292PKTINFO_IPV4
, 
SOCKS_IPV6_2292PKTINFO_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_2292PKTINFO_NAME
 },

73 { 41, 
öt_vÆ
, 
IPV6_2292PKTOPTIONS
, 
SOCKS_IPV6_2292PKTOPTIONS_LVL
, 
SOCKS_IPV6_2292PKTOPTIONS_IPV4
, 
SOCKS_IPV6_2292PKTOPTIONS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_2292PKTOPTIONS_NAME
 },

74 { 42, 
öt_vÆ
, 
IPV6_2292RTHDR
, 
SOCKS_IPV6_2292RTHDR_LVL
, 
SOCKS_IPV6_2292RTHDR_IPV4
, 
SOCKS_IPV6_2292RTHDR_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_2292RTHDR_NAME
 },

75 { 43, 
öt_vÆ
, 
IPV6_ADDRFORM
, 
SOCKS_IPV6_ADDRFORM_LVL
, 
SOCKS_IPV6_ADDRFORM_IPV4
, 
SOCKS_IPV6_ADDRFORM_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_ADDRFORM_NAME
 },

76 { 44, 
öt_vÆ
, 
IPV6_AUTHHDR
, 
SOCKS_IPV6_AUTHHDR_LVL
, 
SOCKS_IPV6_AUTHHDR_IPV4
, 
SOCKS_IPV6_AUTHHDR_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_AUTHHDR_NAME
 },

77 { 45, 
öt_vÆ
, 
IPV6_CHECKSUM
, 
SOCKS_IPV6_CHECKSUM_LVL
, 
SOCKS_IPV6_CHECKSUM_IPV4
, 
SOCKS_IPV6_CHECKSUM_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_CHECKSUM_NAME
 },

78 { 46, 
öt_vÆ
, 
IPV6_DSTOPTS
, 
SOCKS_IPV6_DSTOPTS_LVL
, 
SOCKS_IPV6_DSTOPTS_IPV4
, 
SOCKS_IPV6_DSTOPTS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_DSTOPTS_NAME
 },

79 { 47, 
öt_vÆ
, 
IPV6_DSTOPTS
, 
SOCKS_IPV6_DSTOPTS_LVL
, 
SOCKS_IPV6_DSTOPTS_IPV4
, 
SOCKS_IPV6_DSTOPTS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_DSTOPTS_NAME
 },

80 { 48, 
öt_vÆ
, 
IPV6_HOPLIMIT
, 
SOCKS_IPV6_HOPLIMIT_LVL
, 
SOCKS_IPV6_HOPLIMIT_IPV4
, 
SOCKS_IPV6_HOPLIMIT_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_HOPLIMIT_NAME
 },

81 { 49, 
öt_vÆ
, 
IPV6_HOPLIMIT
, 
SOCKS_IPV6_HOPLIMIT_LVL
, 
SOCKS_IPV6_HOPLIMIT_IPV4
, 
SOCKS_IPV6_HOPLIMIT_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_HOPLIMIT_NAME
 },

82 { 50, 
öt_vÆ
, 
IPV6_HOPOPTS
, 
SOCKS_IPV6_HOPOPTS_LVL
, 
SOCKS_IPV6_HOPOPTS_IPV4
, 
SOCKS_IPV6_HOPOPTS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_HOPOPTS_NAME
 },

83 { 51, 
öt_vÆ
, 
IPV6_HOPOPTS
, 
SOCKS_IPV6_HOPOPTS_LVL
, 
SOCKS_IPV6_HOPOPTS_IPV4
, 
SOCKS_IPV6_HOPOPTS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_HOPOPTS_NAME
 },

84 { 52, 
öt_vÆ
, 
IPV6_IPSEC_POLICY
, 
SOCKS_IPV6_IPSEC_POLICY_LVL
, 
SOCKS_IPV6_IPSEC_POLICY_IPV4
, 
SOCKS_IPV6_IPSEC_POLICY_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_IPSEC_POLICY_NAME
 },

85 { 53, 
öt_vÆ
, 
IPV6_JOIN_ANYCAST
, 
SOCKS_IPV6_JOIN_ANYCAST_LVL
, 
SOCKS_IPV6_JOIN_ANYCAST_IPV4
, 
SOCKS_IPV6_JOIN_ANYCAST_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_JOIN_ANYCAST_NAME
 },

86 { 54, 
öt_vÆ
, 
IPV6_JOIN_GROUP
, 
SOCKS_IPV6_JOIN_GROUP_LVL
, 
SOCKS_IPV6_JOIN_GROUP_IPV4
, 
SOCKS_IPV6_JOIN_GROUP_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_JOIN_GROUP_NAME
 },

87 { 55, 
öt_vÆ
, 
IPV6_LEAVE_ANYCAST
, 
SOCKS_IPV6_LEAVE_ANYCAST_LVL
, 
SOCKS_IPV6_LEAVE_ANYCAST_IPV4
, 
SOCKS_IPV6_LEAVE_ANYCAST_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_LEAVE_ANYCAST_NAME
 },

88 { 56, 
öt_vÆ
, 
IPV6_LEAVE_GROUP
, 
SOCKS_IPV6_LEAVE_GROUP_LVL
, 
SOCKS_IPV6_LEAVE_GROUP_IPV4
, 
SOCKS_IPV6_LEAVE_GROUP_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_LEAVE_GROUP_NAME
 },

89 { 57, 
öt_vÆ
, 
IPV6_MTU
, 
SOCKS_IPV6_MTU_LVL
, 
SOCKS_IPV6_MTU_IPV4
, 
SOCKS_IPV6_MTU_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_MTU_NAME
 },

90 { 58, 
öt_vÆ
, 
IPV6_MTU_DISCOVER
, 
SOCKS_IPV6_MTU_DISCOVER_LVL
, 
SOCKS_IPV6_MTU_DISCOVER_IPV4
, 
SOCKS_IPV6_MTU_DISCOVER_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_MTU_DISCOVER_NAME
 },

91 { 59, 
öt_vÆ
, 
IPV6_NEXTHOP
, 
SOCKS_IPV6_NEXTHOP_LVL
, 
SOCKS_IPV6_NEXTHOP_IPV4
, 
SOCKS_IPV6_NEXTHOP_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_NEXTHOP_NAME
 },

92 { 60, 
öt_vÆ
, 
IPV6_PKTINFO
, 
SOCKS_IPV6_PKTINFO_LVL
, 
SOCKS_IPV6_PKTINFO_IPV4
, 
SOCKS_IPV6_PKTINFO_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_PKTINFO_NAME
 },

93 { 61, 
öt_vÆ
, 
IPV6_ROUTER_ALERT
, 
SOCKS_IPV6_ROUTER_ALERT_LVL
, 
SOCKS_IPV6_ROUTER_ALERT_IPV4
, 
SOCKS_IPV6_ROUTER_ALERT_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_ROUTER_ALERT_NAME
 },

94 { 62, 
öt_vÆ
, 
IPV6_RTHDR
, 
SOCKS_IPV6_RTHDR_LVL
, 
SOCKS_IPV6_RTHDR_IPV4
, 
SOCKS_IPV6_RTHDR_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_RTHDR_NAME
 },

95 { 63, 
öt_vÆ
, 
IPV6_RTHDRDSTOPTS
, 
SOCKS_IPV6_RTHDRDSTOPTS_LVL
, 
SOCKS_IPV6_RTHDRDSTOPTS_IPV4
, 
SOCKS_IPV6_RTHDRDSTOPTS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_RTHDRDSTOPTS_NAME
 },

96 { 64, 
öt_vÆ
, 
IPV6_TCLASS
, 
SOCKS_IPV6_TCLASS_LVL
, 
SOCKS_IPV6_TCLASS_IPV4
, 
SOCKS_IPV6_TCLASS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_TCLASS_NAME
 },

97 { 65, 
öt_vÆ
, 
IPV6_UNICAST_HOPS
, 
SOCKS_IPV6_UNICAST_HOPS_LVL
, 
SOCKS_IPV6_UNICAST_HOPS_IPV4
, 
SOCKS_IPV6_UNICAST_HOPS_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_UNICAST_HOPS_NAME
 },

98 { 66, 
öt_vÆ
, 
IPV6_V6ONLY
, 
SOCKS_IPV6_V6ONLY_LVL
, 
SOCKS_IPV6_V6ONLY_IPV4
, 
SOCKS_IPV6_V6ONLY_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_V6ONLY_NAME
 },

99 { 67, 
öt_vÆ
, 
IPV6_XFRM_POLICY
, 
SOCKS_IPV6_XFRM_POLICY_LVL
, 
SOCKS_IPV6_XFRM_POLICY_IPV4
, 
SOCKS_IPV6_XFRM_POLICY_IPV6
, 
¥e⁄ly
, 0, 0, 0, 0, 
SOCKS_IPV6_XFRM_POLICY_NAME
 },

100 { 68, 
öt_vÆ
, 
SO_ERROR
, 
SOCKS_SO_ERROR_LVL
, 
SOCKS_SO_ERROR_IPV4
, 
SOCKS_SO_ERROR_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_SO_ERROR_NAME
 },

101 { 69, 
öt_vÆ
, 
SO_REUSEADDR
, 
SOCKS_SO_REUSEADDR_LVL
, 
SOCKS_SO_REUSEADDR_IPV4
, 
SOCKS_SO_REUSEADDR_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_SO_REUSEADDR_NAME
 },

102 { 70, 
öt_vÆ
, 
SO_REUSEPORT
, 
SOCKS_SO_REUSEPORT_LVL
, 
SOCKS_SO_REUSEPORT_IPV4
, 
SOCKS_SO_REUSEPORT_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_SO_REUSEPORT_NAME
 },

103 { 71, 
öt_vÆ
, 
SO_ACCEPTCONN
, 
SOCKS_SO_ACCEPTCONN_LVL
, 
SOCKS_SO_ACCEPTCONN_IPV4
, 
SOCKS_SO_ACCEPTCONN_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_SO_ACCEPTCONN_NAME
 },

104 { 72, 
öt_vÆ
, 
SO_TYPE
, 
SOCKS_SO_TYPE_LVL
, 
SOCKS_SO_TYPE_IPV4
, 
SOCKS_SO_TYPE_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_SO_TYPE_NAME
 },

105 { 73, 
öt_vÆ
, 
IP_ADD_MEMBERSHIP
, 
SOCKS_IP_ADD_MEMBERSHIP_LVL
, 
SOCKS_IP_ADD_MEMBERSHIP_IPV4
, 
SOCKS_IP_ADD_MEMBERSHIP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_ADD_MEMBERSHIP_NAME
 },

106 { 74, 
öt_vÆ
, 
IP_ADD_SOURCE_MEMBERSHIP
, 
SOCKS_IP_ADD_SOURCE_MEMBERSHIP_LVL
, 
SOCKS_IP_ADD_SOURCE_MEMBERSHIP_IPV4
, 
SOCKS_IP_ADD_SOURCE_MEMBERSHIP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_ADD_SOURCE_MEMBERSHIP_NAME
 },

107 { 75, 
öt_vÆ
, 
IP_BLOCK_SOURCE
, 
SOCKS_IP_BLOCK_SOURCE_LVL
, 
SOCKS_IP_BLOCK_SOURCE_IPV4
, 
SOCKS_IP_BLOCK_SOURCE_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_BLOCK_SOURCE_NAME
 },

108 { 76, 
öt_vÆ
, 
IP_DROP_MEMBERSHIP
, 
SOCKS_IP_DROP_MEMBERSHIP_LVL
, 
SOCKS_IP_DROP_MEMBERSHIP_IPV4
, 
SOCKS_IP_DROP_MEMBERSHIP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_DROP_MEMBERSHIP_NAME
 },

109 { 77, 
öt_vÆ
, 
IP_DROP_MEMBERSHIP
, 
SOCKS_IP_DROP_MEMBERSHIP_LVL
, 
SOCKS_IP_DROP_MEMBERSHIP_IPV4
, 
SOCKS_IP_DROP_MEMBERSHIP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_DROP_MEMBERSHIP_NAME
 },

110 { 78, 
öt_vÆ
, 
IP_DROP_SOURCE_MEMBERSHIP
, 
SOCKS_IP_DROP_SOURCE_MEMBERSHIP_LVL
, 
SOCKS_IP_DROP_SOURCE_MEMBERSHIP_IPV4
, 
SOCKS_IP_DROP_SOURCE_MEMBERSHIP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_DROP_SOURCE_MEMBERSHIP_NAME
 },

111 { 79, 
öt_vÆ
, 
IP_DROP_SOURCE_MEMBERSHIP
, 
SOCKS_IP_DROP_SOURCE_MEMBERSHIP_LVL
, 
SOCKS_IP_DROP_SOURCE_MEMBERSHIP_IPV4
, 
SOCKS_IP_DROP_SOURCE_MEMBERSHIP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_DROP_SOURCE_MEMBERSHIP_NAME
 },

112 { 80, 
öt_vÆ
, 
IP_HDRINCL
, 
SOCKS_IP_HDRINCL_LVL
, 
SOCKS_IP_HDRINCL_IPV4
, 
SOCKS_IP_HDRINCL_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_HDRINCL_NAME
 },

113 { 81, 
öt_vÆ
, 
IP_HDRINCL
, 
SOCKS_IP_HDRINCL_LVL
, 
SOCKS_IP_HDRINCL_IPV4
, 
SOCKS_IP_HDRINCL_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_HDRINCL_NAME
 },

114 { 82, 
öt_vÆ
, 
IP_MULTICAST_IF
, 
SOCKS_IP_MULTICAST_IF_LVL
, 
SOCKS_IP_MULTICAST_IF_IPV4
, 
SOCKS_IP_MULTICAST_IF_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_MULTICAST_IF_NAME
 },

115 { 83, 
öt_vÆ
, 
IP_MULTICAST_LOOP
, 
SOCKS_IP_MULTICAST_LOOP_LVL
, 
SOCKS_IP_MULTICAST_LOOP_IPV4
, 
SOCKS_IP_MULTICAST_LOOP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_MULTICAST_LOOP_NAME
 },

116 { 84, 
öt_vÆ
, 
IP_MULTICAST_TTL
, 
SOCKS_IP_MULTICAST_TTL_LVL
, 
SOCKS_IP_MULTICAST_TTL_IPV4
, 
SOCKS_IP_MULTICAST_TTL_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_MULTICAST_TTL_NAME
 },

117 { 85, 
öt_vÆ
, 
IP_OPTIONS
, 
SOCKS_IP_OPTIONS_LVL
, 
SOCKS_IP_OPTIONS_IPV4
, 
SOCKS_IP_OPTIONS_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_OPTIONS_NAME
 },

118 { 86, 
öt_vÆ
, 
IP_RECVTOS
, 
SOCKS_IP_RECVTOS_LVL
, 
SOCKS_IP_RECVTOS_IPV4
, 
SOCKS_IP_RECVTOS_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_RECVTOS_NAME
 },

119 { 87, 
öt_vÆ
, 
IP_RECVTTL
, 
SOCKS_IP_RECVTTL_LVL
, 
SOCKS_IP_RECVTTL_IPV4
, 
SOCKS_IP_RECVTTL_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_RECVTTL_NAME
 },

120 { 88, 
öt_vÆ
, 
IP_RECVTTL
, 
SOCKS_IP_RECVTTL_LVL
, 
SOCKS_IP_RECVTTL_IPV4
, 
SOCKS_IP_RECVTTL_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_RECVTTL_NAME
 },

121 { 89, 
öt_vÆ
, 
IP_UNBLOCK_SOURCE
, 
SOCKS_IP_UNBLOCK_SOURCE_LVL
, 
SOCKS_IP_UNBLOCK_SOURCE_IPV4
, 
SOCKS_IP_UNBLOCK_SOURCE_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IP_UNBLOCK_SOURCE_NAME
 },

122 { 90, 
öt_vÆ
, 
IPV6_MULTICAST_HOPS
, 
SOCKS_IPV6_MULTICAST_HOPS_LVL
, 
SOCKS_IPV6_MULTICAST_HOPS_IPV4
, 
SOCKS_IPV6_MULTICAST_HOPS_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_MULTICAST_HOPS_NAME
 },

123 { 91, 
öt_vÆ
, 
IPV6_MULTICAST_IF
, 
SOCKS_IPV6_MULTICAST_IF_LVL
, 
SOCKS_IPV6_MULTICAST_IF_IPV4
, 
SOCKS_IPV6_MULTICAST_IF_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_MULTICAST_IF_NAME
 },

124 { 92, 
öt_vÆ
, 
IPV6_MULTICAST_LOOP
, 
SOCKS_IPV6_MULTICAST_LOOP_LVL
, 
SOCKS_IPV6_MULTICAST_LOOP_IPV4
, 
SOCKS_IPV6_MULTICAST_LOOP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_MULTICAST_LOOP_NAME
 },

125 { 93, 
öt_vÆ
, 
IPV6_ADD_MEMBERSHIP
, 
SOCKS_IPV6_ADD_MEMBERSHIP_LVL
, 
SOCKS_IPV6_ADD_MEMBERSHIP_IPV4
, 
SOCKS_IPV6_ADD_MEMBERSHIP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_ADD_MEMBERSHIP_NAME
 },

126 { 94, 
öt_vÆ
, 
IPV6_DROP_MEMBERSHIP
, 
SOCKS_IPV6_DROP_MEMBERSHIP_LVL
, 
SOCKS_IPV6_DROP_MEMBERSHIP_IPV4
, 
SOCKS_IPV6_DROP_MEMBERSHIP_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_DROP_MEMBERSHIP_NAME
 },

127 { 95, 
öt_vÆ
, 
IPV6_RECVDSTOPTS
, 
SOCKS_IPV6_RECVDSTOPTS_LVL
, 
SOCKS_IPV6_RECVDSTOPTS_IPV4
, 
SOCKS_IPV6_RECVDSTOPTS_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_RECVDSTOPTS_NAME
 },

128 { 96, 
öt_vÆ
, 
IPV6_RECVERR
, 
SOCKS_IPV6_RECVERR_LVL
, 
SOCKS_IPV6_RECVERR_IPV4
, 
SOCKS_IPV6_RECVERR_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_RECVERR_NAME
 },

129 { 97, 
öt_vÆ
, 
IPV6_RECVHOPLIMIT
, 
SOCKS_IPV6_RECVHOPLIMIT_LVL
, 
SOCKS_IPV6_RECVHOPLIMIT_IPV4
, 
SOCKS_IPV6_RECVHOPLIMIT_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_RECVHOPLIMIT_NAME
 },

130 { 98, 
öt_vÆ
, 
IPV6_RECVHOPOPTS
, 
SOCKS_IPV6_RECVHOPOPTS_LVL
, 
SOCKS_IPV6_RECVHOPOPTS_IPV4
, 
SOCKS_IPV6_RECVHOPOPTS_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_RECVHOPOPTS_NAME
 },

131 { 99, 
öt_vÆ
, 
IPV6_RECVPKTINFO
, 
SOCKS_IPV6_RECVPKTINFO_LVL
, 
SOCKS_IPV6_RECVPKTINFO_IPV4
, 
SOCKS_IPV6_RECVPKTINFO_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_RECVPKTINFO_NAME
 },

132 { 100, 
öt_vÆ
, 
IPV6_RECVRTHDR
, 
SOCKS_IPV6_RECVRTHDR_LVL
, 
SOCKS_IPV6_RECVRTHDR_IPV4
, 
SOCKS_IPV6_RECVRTHDR_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_RECVRTHDR_NAME
 },

133 { 101, 
öt_vÆ
, 
IPV6_RECVTCLASS
, 
SOCKS_IPV6_RECVTCLASS_LVL
, 
SOCKS_IPV6_RECVTCLASS_IPV4
, 
SOCKS_IPV6_RECVTCLASS_IPV6
, 
övÆid
, 0, 0, 0, 0, 
SOCKS_IPV6_RECVTCLASS_NAME
 },

136 c⁄° 
sock›tvÆsym_t
 
	gsock›tvÆsyms
[] = {

137 { 31, { .
öt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF11
 }, 
	gSOCKS_IP_TOS_DSCP_AF11_SYMNAME
 },

138 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF12
 }, 
	gSOCKS_IP_TOS_DSCP_AF12_SYMNAME
 },

139 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF13
 }, 
	gSOCKS_IP_TOS_DSCP_AF13_SYMNAME
 },

140 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF21
 }, 
	gSOCKS_IP_TOS_DSCP_AF21_SYMNAME
 },

141 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF22
 }, 
	gSOCKS_IP_TOS_DSCP_AF22_SYMNAME
 },

142 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF23
 }, 
	gSOCKS_IP_TOS_DSCP_AF23_SYMNAME
 },

143 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF31
 }, 
	gSOCKS_IP_TOS_DSCP_AF31_SYMNAME
 },

144 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF32
 }, 
	gSOCKS_IP_TOS_DSCP_AF32_SYMNAME
 },

145 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF33
 }, 
	gSOCKS_IP_TOS_DSCP_AF33_SYMNAME
 },

146 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF41
 }, 
	gSOCKS_IP_TOS_DSCP_AF41_SYMNAME
 },

147 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF42
 }, 
	gSOCKS_IP_TOS_DSCP_AF42_SYMNAME
 },

148 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_AF43
 }, 
	gSOCKS_IP_TOS_DSCP_AF43_SYMNAME
 },

149 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_CS0
 }, 
	gSOCKS_IP_TOS_DSCP_CS0_SYMNAME
 },

150 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_CS1
 }, 
	gSOCKS_IP_TOS_DSCP_CS1_SYMNAME
 },

151 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_CS2
 }, 
	gSOCKS_IP_TOS_DSCP_CS2_SYMNAME
 },

152 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_CS3
 }, 
	gSOCKS_IP_TOS_DSCP_CS3_SYMNAME
 },

153 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_CS4
 }, 
	gSOCKS_IP_TOS_DSCP_CS4_SYMNAME
 },

154 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_CS5
 }, 
	gSOCKS_IP_TOS_DSCP_CS5_SYMNAME
 },

155 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_CS6
 }, 
	gSOCKS_IP_TOS_DSCP_CS6_SYMNAME
 },

156 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_CS7
 }, 
	gSOCKS_IP_TOS_DSCP_CS7_SYMNAME
 },

157 { 31, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_DSCP_EF
 }, 
	gSOCKS_IP_TOS_DSCP_EF_SYMNAME
 },

158 { 32, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_PREC_NETCONTROL
 }, 
	gSOCKS_IP_TOS_PREC_NETCONTROL_SYMNAME
 },

159 { 32, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_PREC_INTERNETCONTROL
 }, 
	gSOCKS_IP_TOS_PREC_INTERNETCONTROL_SYMNAME
 },

160 { 32, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_PREC_CRITIC_ECP
 }, 
	gSOCKS_IP_TOS_PREC_CRITIC_ECP_SYMNAME
 },

161 { 32, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_PREC_FLASHOVERRIDE
 }, 
	gSOCKS_IP_TOS_PREC_FLASHOVERRIDE_SYMNAME
 },

162 { 32, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_PREC_FLASH
 }, 
	gSOCKS_IP_TOS_PREC_FLASH_SYMNAME
 },

163 { 32, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_PREC_IMMEDIATE
 }, 
	gSOCKS_IP_TOS_PREC_IMMEDIATE_SYMNAME
 },

164 { 32, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_PREC_PRIORITY
 }, 
	gSOCKS_IP_TOS_PREC_PRIORITY_SYMNAME
 },

165 { 32, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_PREC_ROUTINE
 }, 
	gSOCKS_IP_TOS_PREC_ROUTINE_SYMNAME
 },

166 { 33, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_TOS_LOWDELAY
 }, 
	gSOCKS_IP_TOS_TOS_LOWDELAY_SYMNAME
 },

167 { 33, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_TOS_THROUGHPUT
 }, 
	gSOCKS_IP_TOS_TOS_THROUGHPUT_SYMNAME
 },

168 { 33, { .
	göt_vÆ
 = 
SOCKS_IP_TOS_TOS_RELIABILITY
 }, 
	gSOCKS_IP_TOS_TOS_RELIABILITY_SYMNAME
 },

	@lib/tcpinfo.c

44 
	~"comm⁄.h
"

46 #i‡
HAVE_NETINET_TCP_FSM_H


47 
	~<√töë/t˝_fsm.h
>

50 c⁄° 
	grcsid
[] =

53 #i‡
HAVE_TCP_INFO


55 c⁄° *
t˝i_ˇ_°©e2°rög
(c⁄° 
vÆ
);

56 c⁄° *
t˝i_°©e2°rög
(c⁄° 
vÆ
);

57 c⁄° *
t˝i_›ti⁄s2°rög
(c⁄° 
vÆ
);

62 
	$gë_t˝öfo
(
fdc
, 
fdv
, 
buf
, 
buÊí
)

63 c⁄° 
size_t
 
fdc
;

64 
fdv
[];

65 *
buf
;

66 
size_t
 
buÊí
;

68 c⁄° *
fun˘i⁄
 = "get_tcpinfo()";

69 #i‡
HAVE_TCP_INFO


70 
t˝_öfo
 
öfo_0
, 
öfo_1
;

71 
sockÀn_t
 
Àn
;

72 
size_t
 
bufu£d
;

74 i‡(
fdc
 == 0)

75  
NULL
;

77 i‡(
buf
 =
NULL
 || 
buÊí
 == 0) {

78 
bufmem
[ (31 + 10)

83 
	`CTASSERT
((
bufmem
Ë> 
MAXTCPINFOLEN
);

85 
buf
 = 
bufmem
;

86 
buÊí
 = (
bufmem
);

89 i‡(
fdc
 > 0) {

90 
Àn
 = (
öfo_0
);

91 i‡(
	`gësock›t
(
fdv
[0], 
IPPROTO_TCP
, 
TCP_INFO
, &
öfo_0
, &
Àn
) != 0) {

92 
	`¶og
(
LOG_DEBUG
,

94 
fun˘i⁄
, 
fdv
[0], 
	`°ªº‹
(
î∫o
));

96 
fdv
[0] = -1;

100 i‡(
fdc
 > 1) {

101 
Àn
 = (
öfo_1
);

102 i‡(
	`gësock›t
(
fdv
[1], 
IPPROTO_TCP
, 
TCP_INFO
, &
öfo_1
, &
Àn
) != 0) {

103 
	`¶og
(
LOG_DEBUG
,

105 
fun˘i⁄
, 
fdv
[1], 
	`°ªº‹
(
î∫o
));

107 
fdv
[1] = -1;

111 
fdc
) {

113 i‡(
fdv
[0] == -1)

114  
NULL
;

118 i‡(
fdv
[0] == -1 && fdv[1] == -1)

119  
NULL
;

123 
	`SERRX
(
fdc
);

126 
bufu£d
 = 0;

128 
	#ADDATTR
(
fdc
, 
fdv
, 
©å
, 
_func
, 
t˝öfo_0
, 
t˝öfo_1
) \

130 c⁄° * (*
func
)(
vÆue
Ë(
_func
); \

132 i‡(
fdc
 == 1) { \

133 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufu£d], 
buÊí
 - bufused, \

136 ()((
t˝öfo_0
)->
©å
), \

137 
func
 =
NULL
 ? "" : " (", \

138 
func
 =
NULL
 ? "" : 
	`func
((
t˝öfo_0
)->
©å
), \

139 
func
 =
NULL
 ? "" : ")"); \

141 i‡(
fdc
 == 2) { \

142 i‡(
fdv
[0] >= 0 && fdv[1] >= 0) \

143 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufu£d], 
buÊí
 - bufused, \

146 ()((
t˝öfo_0
)->
©å
), \

147 
func
 =
NULL
 ? "" : " (", \

148 
func
 =
NULL
 ? "" : 
	`func
((
t˝öfo_0
)->
©å
), \

149 
func
 =
NULL
 ? "" : ")", \

150 ()((
t˝öfo_1
)->
©å
), \

151 
func
 =
NULL
 ? "" : " (", \

152 
func
 =
NULL
 ? "" : 
	`func
((
t˝öfo_1
)->
©å
), \

153 
func
 =
NULL
 ? "" : ")"); \

155 i‡(
fdv
[0] >= 0) { \

156 
	`SASSERTX
(
fdv
[1] == -1); \

158 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufu£d], 
buÊí
 - bufused, \

161 ()((
t˝öfo_0
)->
©å
), \

162 
func
 =
NULL
 ? "" : " (", \

163 
func
 =
NULL
 ? "" : 
	`func
((
t˝öfo_0
)->
©å
), \

164 
func
 =
NULL
 ? "" : ")"); \

166 i‡(
fdv
[1] >= 0) { \

167 
	`SASSERTX
(
fdv
[0] == -1); \

169 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufu£d], 
buÊí
 - bufused, \

172 ()((
t˝öfo_1
)->
©å
), \

173 
func
 =
NULL
 ? "" : " (", \

174 
func
 =
NULL
 ? "" : 
	`func
((
t˝öfo_1
)->
©å
), \

175 
func
 =
NULL
 ? "" : ")"); \

178 
	`SERRX
(0); \

182 
	`SERRX
(
fdc
); \

183 }  0)

	)

185 
	#ADDNL
() \

187 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufu£d], 
buÊí
 - bufused, "\n"); \

188 }  0)

	)

200 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_°©e
, 
t˝i_°©e2°rög
, &
öfo_0
, &
öfo_1
);

202 #i‡
HAVE_TCP_INFO_TCPI_CA_STATE


206 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_ˇ_°©e
, 
t˝i_ˇ_°©e2°rög
, &
öfo_0
, &
öfo_1
);

209 #i‡
HAVE_TCP_INFO_TCPI_RETRANSMITS


216 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_ªå™smôs
, 
NULL
, &
öfo_0
, &
öfo_1
);

219 #i‡
HAVE_TCP_INFO_TCPI_PROBES


233 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_¥obes
, 
NULL
, &
öfo_0
, &
öfo_1
);

236 #i‡
HAVE_TCP_INFO_TCPI_BACKOFF


247 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_backoff
, 
NULL
, &
öfo_0
, &
öfo_1
);

253 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_›ti⁄s
, 
t˝i_›ti⁄s2°rög
, &
öfo_0
, &
öfo_1
);

258 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_¢d_wsˇÀ
, 
NULL
, &
öfo_0
, &
öfo_1
);

263 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_rcv_wsˇÀ
, 
NULL
, &
öfo_0
, &
öfo_1
);

268 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_πo
, 
NULL
, &
öfo_0
, &
öfo_1
);

270 #i‡
HAVE_TCP_INFO_TCPI_ATO


274 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_©o
, 
NULL
, &
öfo_0
, &
öfo_1
);

280 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_¢d_mss
, 
NULL
, &
öfo_0
, &
öfo_1
);

286 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_rcv_mss
, 
NULL
, &
öfo_0
, &
öfo_1
);

288 #i‡
HAVE_TCP_INFO_TCPI_UNACKED


292 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_u«cked
, 
NULL
, &
öfo_0
, &
öfo_1
);

295 #i‡
HAVE_TCP_INFO_TCPI_SACKED


302 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_ßcked
, 
NULL
, &
öfo_0
, &
öfo_1
);

305 #i‡
HAVE_TCP_INFO_TCPI_LOST


310 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_lo°
, 
NULL
, &
öfo_0
, &
öfo_1
);

313 #i‡
HAVE_TCP_INFO_TCPI_RETRANS


318 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_ªå™s
, 
NULL
, &
öfo_0
, &
öfo_1
);

321 #i‡
HAVE_TCP_INFO_TCPI_FACKETS


325 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_Áckës
, 
NULL
, &
öfo_0
, &
öfo_1
);

335 
	`ADDNL
();

337 #i‡
HAVE_TCP_INFO_TCPI_LAST_DATA_SENT


341 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_œ°_d©a_£¡
, 
NULL
, &
öfo_0
, &
öfo_1
);

344 #i‡
HAVE_TCP_INFO_TCPI_LAST_ACK_SENT


349 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_œ°_ack_£¡
, 
NULL
, &
öfo_0
, &
öfo_1
);

352 #i‡
HAVE_TCP_INFO_TCPI_LAST_DATA_RECV


356 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_œ°_d©a_ªcv
, 
NULL
, &
öfo_0
, &
öfo_1
);

359 #i‡
HAVE_TCP_INFO_TCPI_LAST_ACK_RECV


363 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_œ°_ack_ªcv
, 
NULL
, &
öfo_0
, &
öfo_1
);

370 
	`ADDNL
();

372 #i‡
HAVE_TCP_INFO_TCPI_PMTU


377 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_pmtu
, 
NULL
, &
öfo_0
, &
öfo_1
);

380 #i‡
HAVE_TCP_INFO_TCPI_RCV_SSTHRESH


388 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_rcv_s°hªsh
, 
NULL
, &
öfo_0
, &
öfo_1
);

397 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_πt
, 
NULL
, &
öfo_0
, &
öfo_1
);

402 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_πtv¨
, 
NULL
, &
öfo_0
, &
öfo_1
);

407 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_¢d_s°hªsh
, 
NULL
, &
öfo_0
, &
öfo_1
);

412 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_¢d_cwnd
, 
NULL
, &
öfo_0
, &
öfo_1
);

414 #i‡
HAVE_TCP_INFO_TCPI_ADVMSS


420 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_advmss
, 
NULL
, &
öfo_0
, &
öfo_1
);

423 #i‡
HAVE_TCP_INFO_TCPI_REORDERING


428 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_ª‹dîög
, 
NULL
, &
öfo_0
, &
öfo_1
);

431 #i‡
HAVE_TCP_INFO_TCPI_RCV_RTT


436 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_rcv_πt
, 
NULL
, &
öfo_0
, &
öfo_1
);

439 #i‡
HAVE_TCP_INFO_TCPI_RCV_SPACE


445 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_rcv_•a˚
, 
NULL
, &
öfo_0
, &
öfo_1
);

449 
	`ADDNL
();

451 #i‡
HAVE_TCP_INFO_TCPI_TOTAL_RETRANS


460 
	`ADDATTR
(
fdc
, 
fdv
, 
t˝i_tŸÆ_ªå™s
, 
NULL
, &
öfo_0
, &
öfo_1
);

463  
buf
;

467  
NULL
;

470 
	}
}

472 #i‡
HAVE_TCP_INFO


474 c⁄° *
	$t˝i_ˇ_°©e2°rög
(
vÆ
)

475 c⁄° 
vÆ
;

478 #i‡
deföed
 
__löux__


479 
vÆ
) {

480 
TCP_CA_O≥n
:

483 
TCP_CA_Dis‹dî
:

486 
TCP_CA_CWR
:

489 
TCP_CA_Recovîy
:

492 
TCP_CA_Loss
:

498 
	}
}

500 c⁄° *
	$t˝i_°©e2°rög
(
vÆ
)

501 c⁄° 
vÆ
;

504 #i‡
	`deföed
(
__FªeBSD__
)

505 
vÆ
) {

506 
TCPS_CLOSED
:

509 
TCPS_LISTEN
:

512 
TCPS_SYN_SENT
:

515 
TCPS_SYN_RECEIVED
:

518 
TCPS_ESTABLISHED
:

521 
TCPS_CLOSE_WAIT
:

524 
TCPS_FIN_WAIT_1
:

527 
TCPS_CLOSING
:

530 
TCPS_LAST_ACK
:

533 
TCPS_FIN_WAIT_2
:

536 
TCPS_TIME_WAIT
:

540 #ñi‡
	`deföed
(
__löux__
)

542 
vÆ
) {

543 
TCP_ESTABLISHED
:

546 
TCP_SYN_SENT
:

549 
TCP_SYN_RECV
:

552 
TCP_FIN_WAIT1
:

555 
TCP_FIN_WAIT2
:

558 
TCP_TIME_WAIT
:

561 
TCP_CLOSE
:

564 
TCP_CLOSE_WAIT
:

567 
TCP_LAST_ACK
:

570 
TCP_LISTEN
:

573 
TCP_CLOSING
:

579 
	}
}

581 c⁄° *
	$t˝i_›ti⁄s2°rög
(
vÆ
)

582 c⁄° 
vÆ
;

584 
buf
[256];

585 
size_t
 
bufu£d
;

587 *
buf
 = 
NUL
;

588 
bufu£d
 = 0;

590 i‡(
vÆ
 & 
TCPI_OPT_TIMESTAMPS
)

591 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

593 *
buf
 =
NUL
 ? "" : ", ");

595 i‡(
vÆ
 & 
TCPI_OPT_SACK
)

596 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

598 *
buf
 =
NUL
 ? "" : ", ");

600 i‡(
vÆ
 & 
TCPI_OPT_WSCALE
)

601 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

603 *
buf
 =
NUL
 ? "" : ", ");

605 i‡(
vÆ
 & 
TCPI_OPT_ECN
)

606 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

608 *
buf
 =
NUL
 ? "" : ", ");

610  
buf
;

611 
	}
}

	@lib/time.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 
time_t


50 
	$time_m⁄Ÿ⁄ic
(
éoc
)

51 
time_t
 *
éoc
;

53 
timevÆ
 
äow
;

55 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

57 i‡(
éoc
 !
NULL
)

58 *
éoc
 = 
äow
.
tv_£c
;

60  
äow
.
tv_£c
;

61 
	}
}

63 
timevÆ
 *

64 
	$gëtimeofday_m⁄Ÿ⁄ic
(
tv
)

65 
timevÆ
 *
tv
;

67 c⁄° *
fun˘i⁄
 = "gettimeofday_monotonic()";

68 
timevÆ
 
tv_œ°time
;

69 
rc
;

71 #i‡
HAVE_CLOCK_GETTIME_MONOTONIC


72 
time•ec
 
ts
;

74 
rc
 = 
	`˛ock_gëtime
(
CLOCK_MONOTONIC
, &
ts
);

75 
	`SASSERT
(
rc
 == 0);

77 
	`SASSERTX
(
ts
.
tv_n£c
 <= 999999999);

80 
tv
->
tv_£c
 = 
ts
.tv_sec;

81 
tv
->
tv_u£c
 = 
ts
.
tv_n£c
 / 1000;

85 
rc
 = 
	`gëtimeofday
(
tv
, 
NULL
);

86 
	`SASSERT
(
rc
 == 0);

90 
	`SASSERTX
(
tv
->
tv_u£c
 <= 999999);

92 i‡(
	`timîis£t
(&
tv_œ°time
Ë&& 
	`timîcmp
(
tv
, &tv_lasttime, <)) {

93 
	`¶og
(
HAVE_CLOCK_GETTIME_MONOTONIC
 ? 
LOG_WARNING
 : 
LOG_DEBUG
,

96 
fun˘i⁄
,

97 ()
tv_œ°time
.
tv_£c
,

98 ()
tv_œ°time
.
tv_u£c
,

99 ()
tv
->
tv_£c
,

100 ()
tv
->
tv_u£c
);

102 *
tv
 = 
tv_œ°time
;

104 i‡(
tv
->
tv_u£c
 < 999999)

105 ++
tv
->
tv_u£c
;

113 
tv_œ°time
.
tv_£c
 = 
tv
->tv_sec;

114 
tv_œ°time
.
tv_u£c
 = 
tv
->tv_usec;

116  
tv
;

117 
	}
}

120 
	$tv2us
(
tv
)

121 c⁄° 
timevÆ
 *
tv
;

124  ()((
tv
)->
tv_£c
 * 1000000 + (tv)->
tv_u£c
);

125 
	}
}

127 
timevÆ
 *

128 
	$us2tv
(
us
, 
tv
)

129 c⁄° 
us
;

130 
timevÆ
 *
tv
;

133 i‡(
us
 < 1000000) {

134 
tv
->
tv_£c
 = 0;

135 
tv
->
tv_u£c
 = 
us
;

138 
tv
->
tv_£c
 = 
us
 / 1000000;

139 
tv
->
tv_u£c
 = 
us
 % 1000000;

142  
tv
;

143 
	}
}

	@lib/tostring.c

45 
	~"comm⁄.h
"

46 
	~"c⁄fig_∑r£.h
"

48 c⁄° 
	grcsid
[] =

51 c⁄° *
	g°rù°rög
 = ", \t\n";

54 
	$aihöts2°rög
(
höts
, 
buf
, 
buÊí
)

55 c⁄° 
addröfo
 *
höts
;

56 *
buf
;

57 
size_t
 
buÊí
;

59 i‡(
buf
 =
NULL
 || 
buÊí
 == 0) {

60 
_buf
[64];

62 
buf
 = 
_buf
;

63 
buÊí
 = (
_buf
);

66 *
buf
 = 
NUL
;

68 
	`¢¥ötf
(
buf
, 
buÊí
,

70 
höts
->
ai_Êags
,

71 
höts
->
ai_Ámûy
,

72 
höts
->
ai_sockty≥
,

73 
höts
->
ai_¥Ÿocﬁ
);

75  
buf
;

76 
	}
}

79 
	$fd£t2°rög
(
nfds
, 
£t
, 
docheck
, 
buf
, 
buÊí
)

80 c⁄° 
nfds
;

81 c⁄° 
fd_£t
 *
£t
;

82 c⁄° 
docheck
;

83 *
buf
;

84 
size_t
 
buÊí
;

86 
size_t
 
bufu£d
;

87 
i
, 
rc
;

89 i‡(
buf
 =
NULL
 || 
buÊí
 == 0) {

90 
_buf
[10240];

92 
buf
 = 
_buf
;

93 
buÊí
 = (
_buf
);

96 
bufu£d
 = 0;

97 *
buf
 = 
NUL
;

99 i‡(
£t
 =
NULL
)

100  
buf
;

102 
i
 = 0; i < 
nfds
; ++i) {

103 i‡(
	`FD_ISSET
(
i
, 
£t
)) {

104 
rc
 = 
	`¢¥ötf
(&
buf
[
bufu£d
], 
buÊí
 - bufused,

106 
i
, 
docheck
 ? (
	`fdis›í
(i) ? "" : "-invalid") : "");

107 
bufu£d
 +
rc
;

111  
buf
;

112 
	}
}

114 
öt32_t


115 
	$°rög2p‹äumbî
(
°rög
, 
emsg
, 
emsgÀn
)

116 c⁄° *
°rög
;

117 *
emsg
;

118 
size_t
 
emsgÀn
;

120 *
íd±r
, 
visbuf
[256];

121 
p‹äumbî
;

123 i‡(
emsg
 =
NULL
 || 
emsgÀn
 == 0) {

124 
_emsg
[256];

126 
emsg
 = 
_emsg
;

127 
emsgÀn
 = (
_emsg
);

130 
p‹äumbî
 = 
	`°πﬁ
(
°rög
, &
íd±r
, 10);

132 i‡(*
íd±r
 =
NUL
 || *íd±∏='/' || 
	`is•a˚
(*endptr)) {

133 i‡(
p‹äumbî
 >0 &&Ö‹äumbî <
IP_MAXPORT
)

134  (
öt32_t
)
p‹äumbî
;

136 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

139 
p‹äumbî
, 
IP_MAXPORT
);

145 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

148 
	`°r2vis
(
°rög
, 
	`°æí
(°rög), 
visbuf
, (visbuf)),

149 
IP_MAXPORT
);

152 
	}
}

155 
	$¥oxy¥Ÿocﬁs2°rög
(
¥oxy¥Ÿocﬁs
, 
°r
, 
°rsize
)

156 c⁄° 
¥oxy¥Ÿocﬁ_t
 *
¥oxy¥Ÿocﬁs
;

157 *
°r
;

158 
size_t
 
°rsize
;

160 
size_t
 
°ru£d
;

162 i‡(
°rsize
 == 0) {

163 
buf
[256];

165 
°r
 = 
buf
;

166 
°rsize
 = (
buf
);

169 *
°r
 = 
NUL
;

170 
°ru£d
 = 0;

172 i‡(
¥oxy¥Ÿocﬁs
->
socks_v4
)

173 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

174 
	`QUOTE
(
PROXY_SOCKS_V4s
));

176 i‡(
¥oxy¥Ÿocﬁs
->
socks_v5
)

177 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

178 
	`QUOTE
(
PROXY_SOCKS_V5s
));

180 i‡(
¥oxy¥Ÿocﬁs
->
hâp
)

181 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

182 
	`QUOTE
("HTTP"));

184 i‡(
¥oxy¥Ÿocﬁs
->
u≤p
)

185 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

186 
	`QUOTE
(
PROXY_UPNPs
));

188 i‡(
¥oxy¥Ÿocﬁs
->
dúe˘
)

189 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

190 
	`QUOTE
(
PROXY_DIRECTs
));

192 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

193  
°r
;

194 
	}
}

197 
	$¥Ÿocﬁs2°rög
(
¥Ÿocﬁs
, 
°r
, 
°rsize
)

198 c⁄° 
¥Ÿocﬁ_t
 *
¥Ÿocﬁs
;

199 *
°r
;

200 
size_t
 
°rsize
;

202 
size_t
 
°ru£d
;

204 i‡(
°rsize
 == 0) {

205 
buf
[16];

207 
°r
 = 
buf
;

208 
°rsize
 = (
buf
);

211 *
°r
 = 
NUL
;

212 
°ru£d
 = 0;

214 i‡(
¥Ÿocﬁs
->
t˝
)

215 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

216 
	`QUOTE
(
PROTOCOL_TCPs
));

218 i‡(
¥Ÿocﬁs
->
udp
)

219 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

220 
	`QUOTE
(
PROTOCOL_UDPs
));

222 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

223  
°r
;

224 
	}
}

227 
	$socks_∑ckë2°rög
(
∑ckë
, 
i§eque°
)

228 c⁄° *
∑ckë
;

229 
i§eque°
;

231 
buf
[1024];

232 
h°r
[
MAXSOCKSHOSTSTRING
];

233 
vîsi⁄
;

234 c⁄° 
ªque°_t
 *
ªque°
 = 
NULL
;

235 c⁄° 
ª•⁄£_t
 *
ª•⁄£
 = 
NULL
;

237 i‡(
i§eque°
) {

238 
ªque°
 = (c⁄° 
ªque°_t
 *)
∑ckë
;

239 
vîsi⁄
 = 
ªque°
->version;

242 
ª•⁄£
 = (c⁄° 
ª•⁄£_t
 *)
∑ckë
;

243 
vîsi⁄
 = 
ª•⁄£
->version;

246 
vîsi⁄
) {

247 
PROXY_SOCKS_V4
:

248 
PROXY_SOCKS_V4REPLY_VERSION
:

249 i‡(
i§eque°
)

250 
	`¢¥ötf
(
buf
, (buf),

252 
ªque°
->
vîsi⁄
,

253 
ªque°
->
comm™d
,

254 
	`socksho°2°rög
(&
ªque°
->
ho°
, 
h°r
, (hstr)));

256 
	`¢¥ötf
(
buf
, (buf),

258 
ª•⁄£
->
vîsi⁄
,

259 
ª•⁄£
->
ª∂y
.
socks
,

260 
	`socksho°2°rög
(&
ª•⁄£
->
ho°
, 
h°r
, (hstr)));

264 
PROXY_SOCKS_V5
:

265 i‡(
i§eque°
)

266 
	`¢¥ötf
(
buf
, (buf),

268 
ªque°
->
vîsi⁄
,

269 
ªque°
->
comm™d
,

270 
ªque°
->
Êag
,

271 
ªque°
->
ho°
.
©y≥
,

272 
	`socksho°2°rög
(&
ªque°
->
ho°
, 
h°r
, (hstr)));

274 
	`¢¥ötf
(
buf
, (buf),

276 
ª•⁄£
->
vîsi⁄
,

277 
ª•⁄£
->
ª∂y
.
socks
,

278 
ª•⁄£
->
Êag
,

279 
ª•⁄£
->
ho°
.
©y≥
,

280 
	`socksho°2°rög
(&
ª•⁄£
->
ho°
, 
h°r
, (hstr)));

284 
PROXY_HTTP_10
:

285 
PROXY_HTTP_11
:

286 i‡(
i§eque°
)

287 
	`¢¥ötf
(
buf
, (buf),

289 
ªque°
->
vîsi⁄
,

290 
ªque°
->
comm™d
,

291 
ªque°
->
ho°
.
©y≥
,

292 
	`socksho°2°rög
(&
ªque°
->
ho°
, 
h°r
, (hstr)));

294 
	`¢¥ötf
(
buf
, (buf),

296 
ª•⁄£
->
vîsi⁄
,

297 
ª•⁄£
->
ª∂y
.
hâp
,

298 
ª•⁄£
->
ho°
.
©y≥
,

299 
	`socksho°2°rög
(&
ª•⁄£
->
ho°
, 
h°r
, (hstr)));

304 
	`SERRX
(
vîsi⁄
);

307  
buf
;

308 
	}
}

310 
›î©‹_t


311 
	$°rög2›î©‹
(
°rög
)

312 c⁄° *
°rög
;

315 i‡(
	`°rcmp
(
°rög
, "eq") == 0 || strcmp(string, "=") == 0)

316  
eq
;

318 i‡(
	`°rcmp
(
°rög
, "ne") == 0 || strcmp(string, "!=") == 0)

319  
√q
;

321 i‡(
	`°rcmp
(
°rög
, "ge") == 0 || strcmp(string, ">=") == 0)

322  
ge
;

324 i‡(
	`°rcmp
(
°rög
, "le") == 0 || strcmp(string, "<=") == 0)

325  
À
;

327 i‡(
	`°rcmp
(
°rög
, "gt") == 0 || strcmp(string, ">") == 0)

328  
gt
;

330 i‡(
	`°rcmp
(
°rög
, "lt") == 0 || strcmp(string, "<") == 0)

331  
…
;

334 
	`SERRX
(0);

337 
	}
}

340 
	$›î©‹2°rög
(
›î©‹
)

341 
›î©‹_t
 
›î©‹
;

344 
›î©‹
) {

345 
n⁄e
:

346  
	`QUOTE
("none");

348 
eq
:

349  
	`QUOTE
("eq");

351 
√q
:

352  
	`QUOTE
("neq");

354 
ge
:

355  
	`QUOTE
("ge");

357 
À
:

358  
	`QUOTE
("le");

360 
gt
:

361  
	`QUOTE
("gt");

363 
…
:

364  
	`QUOTE
("lt");

366 
ønge
:

367  
	`QUOTE
("range");

370 
	`SERRX
(
›î©‹
);

374 
	}
}

377 
	$ruÀaddr2°rög
(
addªss
, 
ö˛udeöfo
, 
°rög
, 
Àn
)

378 c⁄° 
ruÀaddr_t
 *
addªss
;

379 c⁄° 
size_t
 
ö˛udeöfo
;

380 *
°rög
;

381 
size_t
 
Àn
;

383 c⁄° *
fun˘i⁄
 = "ruleaddr2string()";

384 
ssize_t
 
Ànu£d
;

386 i‡(
°rög
 =
NULL
 || 
Àn
 == 0) {

387 
addr°rög
[
MAXRULEADDRSTRING
];

389 
°rög
 = 
addr°rög
;

390 
Àn
 = (
addr°rög
);

393 
Ànu£d
 = 0;

395 i‡(
ö˛udeöfo
 & 
ADDRINFO_ATYPE
)

396 
Ànu£d
 +
	`¢¥ötf
(
°rög
, 
Àn
, "%†", 
	`©y≥2°rög
(
addªss
->
©y≥
));

398 
addªss
->
©y≥
) {

399 
SOCKS_ADDR_IPV4
: {

400 
¡›
[
MAXSOCKADDRSTRING
];

402 i‡(
	`öë_¡›
(
AF_INET
, &
addªss
->
addr
.
ùv4
.
ù
, 
¡›
, (ntop))

403 =
NULL
)

404 
	`£º
("%s: inet_ntop(3) failed on %s %x",

405 
fun˘i⁄
,

406 
	`©y≥2°rög
(
addªss
->
©y≥
),

407 
addªss
->
addr
.
ùv4
.
ù
.
s_addr
);

409 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused, "%s/%d",

410 
¡›
,

411 
	`bôcou¡
(()

412 
addªss
->
addr
.
ùv4
.
mask
.
s_addr
));

416 
SOCKS_ADDR_IPV6
: {

417 
¡›
[
MAXSOCKADDRSTRING
];

419 i‡(
	`öë_¡›
(
AF_INET6
, &
addªss
->
addr
.
ùv6
.
ù
, 
¡›
, (ntop))

420 =
NULL
)

421 
	`£º
("%s: i√t_¡›(3ËÁûed o¿%†" 
IP6_FMTSTR
,

422 
fun˘i⁄
,

423 
	`©y≥2°rög
(
addªss
->
©y≥
),

424 
	`IP6_ELEMENTS
(&
addªss
->
addr
.
ùv6
.
ù
));

426 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused, "%s/%u",

427 
¡›
, 
addªss
->
addr
.
ùv6
.
maskbôs
);

431 
SOCKS_ADDR_IPVANY
:

432 
	`SASSERTX
(
addªss
->
addr
.
ùv™y
.
ù
.
s_addr
 =
	`ht⁄l
(0));

433 
	`SASSERTX
(
addªss
->
addr
.
ùv™y
.
mask
.
s_addr
 =
	`ht⁄l
(0));

435 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused, "%d/%d",

436 
	`¡ohl
(
addªss
->
addr
.
ùv™y
.
ù
.
s_addr
),

437 
	`bôcou¡
(()

438 
addªss
->
addr
.
ùv™y
.
mask
.
s_addr
));

441 
SOCKS_ADDR_DOMAIN
:

442 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused,

443 "%s", 
addªss
->
addr
.
domaö
);

446 
SOCKS_ADDR_IFNAME
:

447 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused,

448 "%s", 
addªss
->
addr
.
i‚ame
);

452 
	`SERRX
(
addªss
->
©y≥
);

455 i‡(
ö˛udeöfo
 & 
ADDRINFO_PORT
) {

456 
addªss
->
›î©‹
) {

457 
n⁄e
:

460 
eq
:

461 
√q
:

462 
ge
:

463 
À
:

464 
gt
:

465 
…
:

466 i‡(
addªss
->
p‹t
.
t˝
 =addªss->p‹t.
udp
)

467 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused,

469 
	`›î©‹2°rög
(
addªss
->
›î©‹
),

470 
	`¡ohs
(
addªss
->
p‹t
.
t˝
));

472 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused,

474 
	`›î©‹2°rög
(
addªss
->
›î©‹
),

475 
	`¡ohs
(
addªss
->
p‹t
.
t˝
),

476 
	`¡ohs
(
addªss
->
p‹t
.
udp
));

479 
ønge
:

480 
	`SASSERTX
(
addªss
->
p‹t
.
t˝
 =addªss->p‹t.
udp
);

481 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused,

483 
	`›î©‹2°rög
(
addªss
->
›î©‹
),

484 
	`¡ohs
(
addªss
->
p‹t
.
t˝
),

485 
	`¡ohs
(
addªss
->
p‹ãnd
));

489 
	`SERRX
(
addªss
->
›î©‹
);

493  
°rög
;

494 
	}
}

497 
	$¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
)

498 
¥Ÿocﬁ
;

501 
¥Ÿocﬁ
) {

502 
SOCKS_TCP
:

503  
	`QUOTE
(
PROTOCOL_TCPs
);

505 
SOCKS_UDP
:

506  
	`QUOTE
(
PROTOCOL_UDPs
);

509 
	`SERRX
(
¥Ÿocﬁ
);

513 
	}
}

516 
	$ªsﬁvïrŸocﬁ2°rög
(
ªsﬁvïrŸocﬁ
)

517 
ªsﬁvïrŸocﬁ
;

519 
ªsﬁvïrŸocﬁ
) {

520 
RESOLVEPROTOCOL_TCP
:

521  
	`QUOTE
(
PROTOCOL_TCPs
);

523 
RESOLVEPROTOCOL_UDP
:

524  
	`QUOTE
(
PROTOCOL_UDPs
);

526 
RESOLVEPROTOCOL_FAKE
:

527  
	`QUOTE
("fake");

530 
	`SERRX
(
ªsﬁvïrŸocﬁ
);

534 
	}
}

537 
	$comm™d2°rög
(
comm™d
)

538 
comm™d
;

541 
comm™d
) {

542 
SOCKS_BIND
:

543  
	`QUOTE
(
SOCKS_BINDs
);

545 
SOCKS_CONNECT
:

546  
	`QUOTE
(
SOCKS_CONNECTs
);

548 
SOCKS_UDPASSOCIATE
:

549  
	`QUOTE
(
SOCKS_UDPASSOCIATEs
);

552 
SOCKS_ACCEPT
:

553  
	`QUOTE
(
SOCKS_ACCEPTs
);

555 
SOCKS_BINDREPLY
:

556  
	`QUOTE
(
SOCKS_BINDREPLYs
);

558 
SOCKS_UDPREPLY
:

559  
	`QUOTE
(
SOCKS_UDPREPLYs
);

561 
SOCKS_DISCONNECT
:

562  
	`QUOTE
(
SOCKS_DISCONNECTs
);

564 
SOCKS_BOUNCETO
:

565  
	`QUOTE
(
SOCKS_BOUNCETOs
);

567 
SOCKS_HOSTID
:

568  
	`QUOTE
(
SOCKS_HOSTIDs
);

570 
SOCKS_UNKNOWN
:

571  
	`QUOTE
(
SOCKS_UNKNOWNs
);

574 
	`SERRX
(
comm™d
);

578 
	}
}

581 
	$comm™ds2°rög
(
comm™d
, 
°r
, 
°rsize
)

582 c⁄° 
comm™d_t
 *
comm™d
;

583 *
°r
;

584 
size_t
 
°rsize
;

586 
size_t
 
°ru£d
;

588 i‡(
°rsize
 == 0) {

589 
buf
[128];

591 
°r
 = 
buf
;

592 
°rsize
 = (
buf
);

595 *
°r
 = 
NUL
;

596 
°ru£d
 = 0;

598 i‡(
comm™d
->
böd
)

599 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

600 
	`comm™d2°rög
(
SOCKS_BIND
));

602 i‡(
comm™d
->
bödª∂y
)

603 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

604 
	`comm™d2°rög
(
SOCKS_BINDREPLY
));

606 i‡(
comm™d
->
c⁄√˘
)

607 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

608 
	`comm™d2°rög
(
SOCKS_CONNECT
));

610 i‡(
comm™d
->
ud∑ssocüã
)

611 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

612 
	`comm™d2°rög
(
SOCKS_UDPASSOCIATE
));

614 i‡(
comm™d
->
ud¥ïly
)

615 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

616 
	`comm™d2°rög
(
SOCKS_UDPREPLY
));

618 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

619  
°r
;

620 
	}
}

623 
	$mëhod2°rög
(
mëhod
)

624 
mëhod
;

627 
mëhod
) {

628 
AUTHMETHOD_NOTSET
:

629  
	`QUOTE
(
AUTHMETHOD_NOTSETs
);

631 
AUTHMETHOD_NONE
:

632  
	`QUOTE
(
AUTHMETHOD_NONEs
);

634 
AUTHMETHOD_GSSAPI
:

635  
	`QUOTE
(
AUTHMETHOD_GSSAPIs
);

637 
AUTHMETHOD_UNAME
:

638  
	`QUOTE
(
AUTHMETHOD_UNAMEs
);

640 
AUTHMETHOD_NOACCEPT
:

641  
	`QUOTE
(
AUTHMETHOD_NOACCEPTs
);

643 
AUTHMETHOD_RFC931
:

644  
	`QUOTE
(
AUTHMETHOD_RFC931s
);

646 
AUTHMETHOD_PAM_ANY
:

647  
	`QUOTE
(
AUTHMETHOD_PAM_ANYs
);

649 
AUTHMETHOD_PAM_ADDRESS
:

650  
	`QUOTE
(
AUTHMETHOD_PAM_ADDRESSs
);

652 
AUTHMETHOD_PAM_USERNAME
:

653  
	`QUOTE
(
AUTHMETHOD_PAM_USERNAMEs
);

655 
AUTHMETHOD_BSDAUTH
:

656  
	`QUOTE
(
AUTHMETHOD_BSDAUTHs
);

663 
	}
}

666 
	$¥oxy¥Ÿocﬁ2°rög
(
vîsi⁄
)

667 
vîsi⁄
;

670 
vîsi⁄
) {

671 
PROXY_SOCKS_V4
:

672  
	`QUOTE
(
PROXY_SOCKS_V4s
);

674 
PROXY_SOCKS_V5
:

675  
	`QUOTE
(
PROXY_SOCKS_V5s
);

677 
PROXY_HTTP_10
:

678  
	`QUOTE
(
PROXY_HTTP_10s
);

680 
PROXY_HTTP_11
:

681  
	`QUOTE
(
PROXY_HTTP_11s
);

683 
PROXY_UPNP
:

684  
	`QUOTE
(
PROXY_UPNPs
);

686 
PROXY_DIRECT
:

687  
	`QUOTE
(
PROXY_DIRECTs
);

690 
	`SERRX
(
vîsi⁄
);

694 
	}
}

697 
	$mëhods2°rög
(
mëhodc
, 
mëhodv
, 
°r
, 
°rsize
)

698 
size_t
 
mëhodc
;

699 c⁄° 
mëhodv
[];

700 *
°r
;

701 
size_t
 
°rsize
;

703 
size_t
 
°ru£d
;

704 
size_t
 
i
;

706 i‡(
°rsize
 == 0) {

707 
buf
[512];

709 
°r
 = 
buf
;

710 
°rsize
 = (
buf
);

713 *
°r
 = 
NUL
;

714 
°ru£d
 = 0;

716 
i
 = 0; i < 
mëhodc
; ++i)

717 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

718 "%s, ", 
	`mëhod2°rög
(
mëhodv
[
i
]));

720 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

721  
°r
;

722 
	}
}

725 
	$°rög2mëhod
(
mëhod«me
)

726 c⁄° *
mëhod«me
;

729 *
mëhod«me
;

730 
mëhod
;

731 } 
mëhod
[] = {

732 { 
AUTHMETHOD_NONEs
, 
AUTHMETHOD_NONE
 },

733 { 
AUTHMETHOD_UNAMEs
, 
AUTHMETHOD_UNAME
 },

734 { 
AUTHMETHOD_GSSAPIs
, 
AUTHMETHOD_GSSAPI
 },

735 { 
AUTHMETHOD_RFC931s
, 
AUTHMETHOD_RFC931
 },

736 { 
AUTHMETHOD_PAM_ANYs
, 
AUTHMETHOD_PAM_ANY
 },

737 { 
AUTHMETHOD_PAM_ADDRESSs
, 
AUTHMETHOD_PAM_ADDRESS
 },

738 { 
AUTHMETHOD_PAM_USERNAMEs
, 
AUTHMETHOD_PAM_USERNAME
 },

739 { 
AUTHMETHOD_BSDAUTHs
, 
AUTHMETHOD_BSDAUTH
 }

741 
size_t
 
i
;

743 
i
 = 0; i < 
	`ELEMENTS
(
mëhod
); ++i)

744 i‡(
	`°rcmp
(
mëhod
[
i
].
mëhod«me
, methodname) == 0)

745  
mëhod
[
i
].method;

748 
	}
}

751 
	$socksho°2°rög2
(
ho°
, 
ö˛udeöfo
, 
°rög
, 
Àn
)

752 c⁄° 
socksho°_t
 *
ho°
;

753 c⁄° 
size_t
 
ö˛udeöfo
;

754 *
°rög
;

755 
size_t
 
Àn
;

757 
size_t
 
Ànu£d
;

758 
visbuf
[(*
ho°
) * 4];

760 i‡(
°rög
 =
NULL
 || 
Àn
 == 0) {

761 
h°r
[(
visbuf
)];

763 
°rög
 = 
h°r
;

764 
Àn
 = (
h°r
);

767 
Ànu£d
 = 0;

769 i‡(
ö˛udeöfo
 & 
ADDRINFO_ATYPE
)

770 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused, "%s ",

771 
	`©y≥2°rög
(
ho°
->
©y≥
));

773 
ho°
->
©y≥
) {

774 
SOCKS_ADDR_IPV4
: {

775 
b
[
	`MAX
(
INET_ADDRSTRLEN
, 32)];

777 i‡(
	`öë_¡›
(
AF_INET
, &
ho°
->
addr
.
ùv4
, 
b
, (b)Ë=
NULL
)

778 
	`STRCPY_ASSERTSIZE
(
b
, "<nonsenseáddress>");

780 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üíu£d, "%s", 
b
);

784 
SOCKS_ADDR_IPV6
: {

785 
b
[
	`MAX
(
INET6_ADDRSTRLEN
, 32)];

787 i‡(
	`öë_¡›
(
AF_INET6
, &
ho°
->
addr
.
ùv6
, 
b
, (b)Ë=
NULL
)

788 
	`STRCPY_ASSERTSIZE
(
b
, "<nonsenseáddress>");

790 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üíu£d, "%s", 
b
);

794 
SOCKS_ADDR_DOMAIN
:

795 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused, "%s",

796 
	`°r2vis
(
ho°
->
addr
.
domaö
,

797 
	`°æí
(
ho°
->
addr
.
domaö
),

798 
visbuf
,

799 (
visbuf
)));

802 
SOCKS_ADDR_IFNAME
:

803 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused, "%s",

804 
	`°r2vis
(
ho°
->
addr
.
i‚ame
,

805 
	`°æí
(
ho°
->
addr
.
i‚ame
),

806 
visbuf
,

807 (
visbuf
)));

810 
SOCKS_ADDR_URL
:

811 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused, "%s",

812 
	`°r2vis
(
ho°
->
addr
.
uæ«me
,

813 
	`°æí
(
ho°
->
addr
.
uæ«me
),

814 
visbuf
,

815 (
visbuf
)));

819 
	`SERRX
(
ho°
->
©y≥
);

822 i‡(
ö˛udeöfo
 & 
ADDRINFO_PORT
) {

823 
ho°
->
©y≥
) {

824 
SOCKS_ADDR_IPV4
:

825 
SOCKS_ADDR_IPV6
:

826 
SOCKS_ADDR_DOMAIN
:

827 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused,

828 ".%d", 
	`¡ohs
(
ho°
->
p‹t
));

833  
°rög
;

834 
	}
}

837 
	$socksho°2°rög
(
ho°
, 
°rög
, 
Àn
)

838 c⁄° 
socksho°_t
 *
ho°
;

839 *
°rög
;

840 
size_t
 
Àn
;

843  
	`socksho°2°rög2
(
ho°
, 
ADDRINFO_PORT
, 
°rög
, 
Àn
);

844 
	}
}

847 
	$sockaddr2°rög
(
addr
, 
°rög
, 
Àn
)

848 c⁄° 
sockaddr_°‹age
 *
addr
;

849 *
°rög
;

850 
size_t
 
Àn
;

852 i‡(
°rög
 =
NULL
 || 
Àn
 == 0) {

853 
addr°rög
[
MAXSOCKADDRSTRING
];

855 
°rög
 = 
addr°rög
;

856 
Àn
 = (
addr°rög
);

860  
	`sockaddr2°rög2
(
addr
, 
ADDRINFO_PORT
, 
°rög
, 
Àn
);

861 
	}
}

865 
	$sockaddr2°rög2
(
addr
, 
ö˛udeöfo
, 
°rög
, 
Àn
)

866 c⁄° 
sockaddr_°‹age
 *
addr
;

867 c⁄° 
size_t
 
ö˛udeöfo
;

868 *
°rög
;

869 
size_t
 
Àn
;

871 
size_t
 
Ànu£d
 = 0;

873 i‡(
°rög
 =
NULL
 || 
Àn
 == 0) {

874 
addr°rög
[
	`MAX
(
MAXSOCKADDRSTRING
, 256)];

876 
°rög
 = 
addr°rög
;

877 
Àn
 = (
addr°rög
);

880 i‡(
ö˛udeöfo
 & 
ADDRINFO_ATYPE
)

881 
Ànu£d
 +
	`¢¥ötf
(&
°rög
[Ànu£d], 
Àn
 -Üenused, "%s ",

882 
	`ßÁmûy2°rög
(
addr
->
ss_Ámûy
));

884 
addr
->
ss_Ámûy
) {

885 
AF_INET
:

886 
AF_INET6
: {

887 i‡(
	`öë_¡›
(
addr
->
ss_Ámûy
,

888 
	`GET_SOCKADDRADDR
(
addr
),

889 &
°rög
[
Ànu£d
],

890 
Àn
 - 
Ànu£d
Ë!
NULL
) {

891 i‡(
addr
->
ss_Ámûy
 =
AF_INET6


892 && 
ö˛udeöfo
 & 
ADDRINFO_SCOPEID


893 && 
	`TOCIN6
(
addr
)->
sö6_sc›e_id
 != 0) {

894 
Ànu£d
 = 
	`°æí
(
°rög
);

896 
	`¢¥ötf
(&
°rög
[
Ànu£d
], 
Àn
 -Üenused,

897 "%u", ()
	`TOCIN6
(
addr
)->
sö6_sc›e_id
);

900 i‡(
ö˛udeöfo
 & 
ADDRINFO_PORT
) {

901 
Ànu£d
 = 
	`°æí
(
°rög
);

903 
	`¢¥ötf
(&
°rög
[
Ànu£d
], 
Àn
 -Üenused,

904 ".%d", 
	`¡ohs
(
	`GET_SOCKADDRPORT
(
addr
)));

908 
addr°r
[
MAXSOCKADDRSTRING
];

910 
addr
->
ss_Ámûy
) {

911 
AF_INET
:

912 
	`¢¥ötf
(
addr°r
, (addrstr),

913 "0x%x", 
	`TOCIN
(
addr
)->
sö_addr
.
s_addr
);

916 
AF_INET6
:

917 
	`¢¥ötf
(
addr°r
, (addrstr),

918 
IP6_FMTSTR
, 
	`IP6_ELEMENTS
(&
	`TOCIN6
(
addr
)->
sö6_addr
));

922 
	`SERRX
(
addr
->
ss_Ámûy
);

925 
	`¢¥ötf
(
°rög
, 
Àn
,

927 
addr
->
ss_Ámûy
,

928 
	`°ªº‹
(
î∫o
),

929 
addr°r
);

931 
î∫o
 = 0;

938 
	`¢¥ötf
(
°rög
, 
Àn
, "<undecodedá‡%d>", 
addr
->
ss_Ámûy
);

941  
°rög
;

942 
	}
}

945 
	$addr2hex°rög
(
addr
, 
ßÁmûy
, 
°rög
, 
Àn
)

946 c⁄° *
addr
;

947 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

948 *
°rög
;

949 
size_t
 
Àn
;

951 i‡(
°rög
 =
NULL
 || 
Àn
 == 0) {

952 
°rögmem
[(
IP6_FMTSTR
)];

954 
°rög
 = 
°rögmem
;

955 
Àn
 = (
°rögmem
);

958 
ßÁmûy
) {

959 
AF_INET
:

960 
	`¢¥ötf
(
°rög
, 
Àn
, "0x%x", ((c⁄° 
ö_addr
 *)
addr
)->
s_addr
);

963 
AF_INET6
:

964 
	`¢¥ötf
(
°rög
, 
Àn
,

965 
IP6_FMTSTR
,

966 
	`IP6_ELEMENTS
(((c⁄° 
ö6_addr
 *)
addr
)));

970 
	`SERRX
(
ßÁmûy
);

973  
°rög
;

974 
	}
}

976 
udphódî_t
 *

977 
	$°rög2udphódî
(
d©a
, 
Àn
, 
hódî
)

978 c⁄° *
d©a
;

979 
size_t
 
Àn
;

980 
udphódî_t
 *
hódî
;

983 
	`bzîo
(
hódî
, (*header));

985 i‡(
Àn
 < 
MINSOCKSUDPHLEN
)

986  
NULL
;

988 i‡(
Àn
 < (
hódî
->
Êag
))

989  
NULL
;

991 
	`mem˝y
(&
hódî
->
Êag
, 
d©a
, (header->flag));

992 
d©a
 +(
hódî
->
Êag
);

993 
Àn
 -(
hódî
->
Êag
);

995 i‡(
Àn
 < (
hódî
->
‰ag
))

996  
NULL
;

998 
	`mem˝y
(&
hódî
->
‰ag
, 
d©a
, (header->frag));

999 
d©a
 +(
hódî
->
‰ag
);

1000 
Àn
 -(
hódî
->
‰ag
);

1002 i‡(
	`mem2socksho°
(&
hódî
->
ho°
,

1003 (c⁄° *)
d©a
,

1004 
Àn
,

1005 
PROXY_SOCKS_V5
Ë=
NULL
) {

1006 
	`bzîo
(
hódî
, (*header));

1007  
NULL
;

1010  
hódî
;

1011 
	}
}

1014 
	$exãnsi⁄s2°rög
(
exãnsi⁄s
, 
°r
, 
°rsize
)

1015 c⁄° 
exãnsi⁄_t
 *
exãnsi⁄s
;

1016 *
°r
;

1017 
size_t
 
°rsize
;

1019 
size_t
 
°ru£d
;

1021 i‡(
°rsize
 == 0) {

1022 
buf
[16];

1024 
°r
 = 
buf
;

1025 
°rsize
 = (
buf
);

1028 *
°r
 = 
NUL
;

1029 
°ru£d
 = 0;

1031 i‡(
exãnsi⁄s
->
böd
)

1032 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

1033 
	`QUOTE
("bind"));

1035 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

1036  
°r
;

1037 
	}
}

1040 
	$°r2uµî
(
°rög
)

1041 *
°rög
;

1044 *
°rög
 !
NUL
) {

1045 *
°rög
 = ()
	`touµî
(*string);

1046 ++
°rög
;

1049  
°rög
;

1050 
	}
}

1053 
	$sock«me2°rög
(
s
, 
buf
, 
buÊí
)

1054 c⁄° 
s
;

1055 *
buf
;

1056 
size_t
 
buÊí
;

1058 c⁄° *
fun˘i⁄
 = "sockname2string()";

1059 
sockaddr_°‹age
 
addr
;

1060 
sockÀn_t
 
Àn
;

1062 i‡(
s
 == -1)

1063  
NULL
;

1065 i‡(
buÊí
 == 0) {

1066 
sbuf
[256];

1068 
buf
 = 
sbuf
;

1069 
buÊí
 = (
sbuf
);

1072 
Àn
 = (
addr
);

1073 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
addr
), &
Àn
) == -1) {

1074 
	`¶og
(
LOG_DEBUG
, "%s: getsockname(2) on fd %d failed: %s",

1075 
fun˘i⁄
, 
s
, 
	`°ªº‹
(
î∫o
));

1077  
NULL
;

1080 
	`sockaddr2°rög
(&
addr
, 
buf
, 
buÊí
);

1082  
buf
;

1083 
	}
}

1086 
	$≥î«me2°rög
(
s
, 
buf
, 
buÊí
)

1087 c⁄° 
s
;

1088 *
buf
;

1089 
size_t
 
buÊí
;

1091 c⁄° *
fun˘i⁄
 = "peername2string()";

1092 
sockaddr_°‹age
 
addr
;

1093 
sockÀn_t
 
Àn
;

1095 i‡(
s
 == -1)

1096  
NULL
;

1098 i‡(
buÊí
 == 0) {

1099 
sbuf
[256];

1101 
buf
 = 
sbuf
;

1102 
buÊí
 = (
sbuf
);

1105 
Àn
 = (
addr
);

1106 i‡(
	`gë≥î«me
(
s
, 
	`TOSA
(&
addr
), &
Àn
) == -1) {

1107 
	`¶og
(
LOG_DEBUG
, "%s: getpeername(2) on fd %d failed: %s",

1108 
fun˘i⁄
, 
s
, 
	`°ªº‹
(
î∫o
));

1110  
NULL
;

1113 
	`sockaddr2°rög
(&
addr
, 
buf
, 
buÊí
);

1115  
buf
;

1116 
	}
}

1119 
	$sockë2°rög
(
s
, 
buf
, 
buÊí
)

1120 c⁄° 
s
;

1121 *
buf
;

1122 
size_t
 
buÊí
;

1124 c⁄° *
fun˘i⁄
 = "socket2string()";

1125 c⁄° 
î∫o_s
 = 
î∫o
;

1126 
sockÀn_t
 
Àn
;

1127 
§c
[
MAXSOCKADDRSTRING
], 
d°
[MAXSOCKADDRSTRING], *
¥Ÿocﬁ
;

1128 
vÆ
;

1130 i‡(
buÊí
 == 0) {

1131 
sbuf
[256];

1133 
buf
 = 
sbuf
;

1134 
buÊí
 = (
sbuf
);

1137 i‡(
	`sock«me2°rög
(
s
, 
§c
, (§c)Ë=
NULL
)

1138 *
§c
 = 
NUL
;

1140 i‡(
	`≥î«me2°rög
(
s
, 
d°
, (d°)Ë=
NULL
)

1141 *
d°
 = 
NUL
;

1143 
Àn
 = (
vÆ
);

1144 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
vÆ
, &
Àn
) == -1)

1145 
¥Ÿocﬁ
 = 
NULL
;

1147 
vÆ
) {

1148 
SOCK_DGRAM
:

1149 
¥Ÿocﬁ
 = 
PROTOCOL_UDPs
;

1152 
SOCK_STREAM
:

1153 
¥Ÿocﬁ
 = 
PROTOCOL_TCPs
;

1157 
¥Ÿocﬁ
 = "unknown";

1160 
	`¢¥ötf
(
buf
, 
buÊí
,

1162 *
§c
 =
NUL
 ? "N/A" : src,

1163 *
d°
 =
NUL
 ? "N/A" : dst,

1164 
¥Ÿocﬁ
 =
NULL
 ? "N/A" :Örotocol);

1166 
î∫o
 = 
î∫o_s
;

1167  
buf
;

1168 
	}
}

1171 
	$©y≥2°rög
(
©y≥
)

1172 c⁄° 
©y≥
;

1175 
©y≥
) {

1176 
SOCKS_ADDR_IPV4
:

1179 
SOCKS_ADDR_IPV6
:

1182 
SOCKS_ADDR_IPVANY
:

1185 
SOCKS_ADDR_IFNAME
:

1188 
SOCKS_ADDR_DOMAIN
:

1191 
SOCKS_ADDR_URL
:

1195 
	`SERRX
(
©y≥
);

1199 
	}
}

1202 
	$ßÁmûy2°rög
(
af
)

1203 c⁄° 
ß_Ámûy_t
 
af
;

1206 
af
) {

1207 
AF_INET
:

1208  
	`©y≥2°rög
(
SOCKS_ADDR_IPV4
);

1210 
AF_INET6
:

1211  
	`©y≥2°rög
(
SOCKS_ADDR_IPV6
);

1213 
AF_UNSPEC
:

1216 
AF_LOCAL
:

1220 
buf
[("unknown socketáddress family: 65535")];

1222 
	`¢¥ötf
(
buf
, (buf), "<unknow¿sockëáddªs†Ámûy: %d>", 
af
);

1223  
buf
;

1228 
	}
}

1231 
	$sockty≥2°rög
(
sockty≥
)

1232 c⁄° 
sockty≥
;

1235 
sockty≥
) {

1236 
SOCK_STREAM
:

1239 
SOCK_DGRAM
:

1247 
	}
}

1250 
	$…ﬂ
(
l
, 
buf
, 
buÊí
)

1251 
l
;

1252 *
buf
;

1253 
size_t
 
buÊí
;

1255 *
p
;

1256 
size_t
 
bufu£d
;

1257 
add_möus
;

1259 i‡(
buf
 =
NULL
 || 
buÊí
 == 0) {

1261 
bufmem
[(("-") - 1) + ("18446744073709551616")];

1263 
buf
 = 
bufmem
;

1264 
buÊí
 = (
bufmem
);

1266 i‡(
buÊí
 == 1) {

1267 *
buf
 = 
NUL
;

1268  
buf
;

1271 
p
 = &
buf
[
buÊí
 - 1];

1272 *
p
 = 
NUL
;

1274 i‡(
l
 < 0) {

1275 
l
 = -l;

1276 
add_möus
 = 1;

1279 
add_möus
 = 0;

1282 *(--
p
Ë()((
l
 % 10) + '0');

1283 
l
 /= 10;

1284 } 
l
 !0 && 
p
 > 
buf
);

1286 i‡(
l
 != 0

1287 || (
p
 =
buf
 && 
add_möus
)) {

1288 
	`SASSERTX
(
p
 =
buf
);

1290 
î∫o
 = 
ERANGE
;

1291 *
buf
 = 
NUL
;

1293  
buf
;

1296 i‡(
add_möus
)

1297 *(--
p
) = '-';

1299 
bufu£d
 = (&
buf
[
buÊí
 - 1] - 
p
) + 1;

1300 
	`SASSERTX
(
p
 + (
bufu£d
 - 1Ë<&
buf
[
buÊí
 - 1]);

1302 
	`memmove
(
buf
, 
p
, 
bufu£d
);

1303 
	`SASSERTX
(
buf
[
bufu£d
 - 1] =
NUL
);

1305  
buf
;

1306 
	}
}

1308 #i‡
HAVE_GSSAPI


1310 
	$gsßpùrŸe˘i⁄2°rög
(
¥Ÿe˘i⁄
)

1311 c⁄° 
¥Ÿe˘i⁄
;

1313 
¥Ÿe˘i⁄
) {

1314 
SOCKS_GSSAPI_CLEAR
:

1317 
SOCKS_GSSAPI_INTEGRITY
:

1320 
SOCKS_GSSAPI_CONFIDENTIALITY
:

1323 
SOCKS_GSSAPI_PERMESSAGE
:

1328 
	}
}

1332 
	$rouã›ti⁄s2°rög
(
›ti⁄s
, 
°r
, 
°rsize
)

1333 c⁄° 
rouã›ti⁄s_t
 *
›ti⁄s
;

1334 *
°r
;

1335 
size_t
 
°rsize
;

1337 
size_t
 
°ru£d
;

1339 i‡(
°rsize
 == 0) {

1340 
buf
[512];

1342 
°r
 = 
buf
;

1343 
°rsize
 = (
buf
);

1346 *
°r
 = 
NUL
;

1347 
°ru£d
 = 0;

1349 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

1351 ()
›ti⁄s
->
badexpúe
);

1353 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

1355 ()
›ti⁄s
->
maxÁû
);

1357  
°r
;

1358 
	}
}

1361 
	$logty≥s2°rög
(
logty≥s
, 
°r
, 
°rsize
)

1362 c⁄° 
logty≥_t
 *
logty≥s
;

1363 *
°r
;

1364 
size_t
 
°rsize
;

1366 
size_t
 
°ru£d
;

1367 
size_t
 
i
;

1369 i‡(
°rsize
 == 0) {

1370 
buf
[512];

1372 
°r
 = 
buf
;

1373 
°rsize
 = (
buf
);

1376 *
°r
 = 
NUL
;

1377 
°ru£d
 = 0;

1379 i‡(
logty≥s
->
ty≥
 & 
LOGTYPE_SYSLOG
)

1380 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "\"syslog.%s\", ",

1381 
logty≥s
->
Ácûôy«me
);

1383 i‡(
logty≥s
->
ty≥
 & 
LOGTYPE_FILE
)

1384 
i
 = 0; i < 
logty≥s
->
fûíoc
; ++i)

1385 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "\"%s\", ",

1386 
logty≥s
->
‚amev
[
i
]);

1388 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

1389  
°r
;

1390 
	}
}

1393 
	$logÀvñ2°rög
(
logÀvñ
)

1394 c⁄° 
logÀvñ
;

1397 
logÀvñ
) {

1398 
LOG_EMERG
:

1401 
LOG_ALERT
:

1404 
LOG_CRIT
:

1407 
LOG_ERR
:

1410 
LOG_WARNING
:

1413 
LOG_NOTICE
:

1416 
LOG_INFO
:

1419 
LOG_DEBUG
:

1423 
	`SWARNX
(
logÀvñ
);

1426 
	}
}

1429 
	$sig«l2°rög
(
sig
)

1430 c⁄° 
sig
;

1433 
sig
) {

1434 #ifde‡
SIGABRT


1435 
SIGABRT
:

1439 #ifde‡
SIGALRM


1440 
SIGALRM
:

1444 #ifde‡
SIGBUS


1445 
SIGBUS
:

1449 #ifde‡
SIGCANCEL


1450 
SIGCANCEL
:

1454 #ifde‡
SIGCHLD


1455 
SIGCHLD
:

1459 #i‡(
deföed
 
SIGCLD
Ë&& SIGCLD !
SIGCHLD


1460 
SIGCLD
:

1464 #ifde‡
SIGCONT


1465 
SIGCONT
:

1469 #ifde‡
SIGEMT


1470 
SIGEMT
:

1474 #ifde‡
SIGFPE


1475 
SIGFPE
:

1479 #ifde‡
SIGFREEZE


1480 
SIGFREEZE
:

1484 #ifde‡
SIGHUP


1485 
SIGHUP
:

1489 #ifde‡
SIGILL


1490 
SIGILL
:

1494 #ifde‡
SIGINFO


1495 
SIGINFO
:

1499 #ifde‡
SIGINT


1500 
SIGINT
:

1504 #ifde‡
SIGIO


1505 
SIGIO
:

1509 #i‡(
deföed
 
SIGIOT
Ë&& SIGIOT !
SIGABRT


1510 
SIGIOT
:

1514 #ifde‡
SIGJVM1


1515 
SIGJVM1
:

1519 #ifde‡
SIGJVM2


1520 
SIGJVM2
:

1524 #ifde‡
SIGKILL


1525 
SIGKILL
:

1529 #i‡(
deföed
 
SIGLOST
Ë&& (!deföed 
SIGABRT
 || SIGLOST != SIGABRT)

1530 
SIGLOST
:

1534 #i‡(
deföed
 
SIGLWP
Ë&& (!deföed 
SIGTHR
 || SIGLWP != SIGTHR)

1535 
SIGLWP
:

1539 #ifde‡
SIGPIPE


1540 
SIGPIPE
:

1544 #i‡(
deföed
 
SIGPOLL
Ë&& SIGPOLL !
SIGIO


1545 
SIGPOLL
:

1549 #ifde‡
SIGPROF


1550 
SIGPROF
:

1554 #ifde‡
SIGPWR


1555 
SIGPWR
:

1559 #ifde‡
SIGQUIT


1560 
SIGQUIT
:

1564 #ifde‡
SIGSEGV


1565 
SIGSEGV
:

1569 #ifde‡
SIGSTKFLT


1570 
SIGSTKFLT
:

1574 #ifde‡
SIGSTOP


1575 
SIGSTOP
:

1579 #ifde‡
SIGSYS


1580 
SIGSYS
:

1584 #ifde‡
SIGTERM


1585 
SIGTERM
:

1589 #ifde‡
SIGTHAW


1590 
SIGTHAW
:

1594 #ifde‡
SIGTHR


1595 
SIGTHR
:

1599 #ifde‡
SIGTRAP


1600 
SIGTRAP
:

1604 #ifde‡
SIGTSTP


1605 
SIGTSTP
:

1609 #ifde‡
SIGTTIN


1610 
SIGTTIN
:

1614 #ifde‡
SIGTTOU


1615 
SIGTTOU
:

1619 #ifde‡
SIGURG


1620 
SIGURG
:

1624 #ifde‡
SIGUSR1


1625 
SIGUSR1
:

1629 #ifde‡
SIGUSR2


1630 
SIGUSR2
:

1634 #ifde‡
SIGVTALRM


1635 
SIGVTALRM
:

1639 #ifde‡
SIGWAITING


1640 
SIGWAITING
:

1644 #ifde‡
SIGWINCH


1645 
SIGWINCH
:

1649 #ifde‡
SIGXCPU


1650 
SIGXCPU
:

1654 #ifde‡
SIGXFSZ


1655 
SIGXFSZ
:

1659 #ifde‡
SIGXRES


1660 
SIGXRES
:

1666 
	}
}

1669 #unde‡
°ªº‹


1671 
	$socks_°ªº‹
(
îr
)

1672 c⁄° 
îr
;

1674 c⁄° 
î∫o_s
 = 
î∫o
;

1675 *
îr°r
;

1677 i‡(
sockscf
.
°©e
.
ösig«l
)

1680 i‡(
îr
 == 0)

1683 
îr°r
 = 
	`°ªº‹
(
îr
);

1685 i‡(
î∫o
 !
î∫o_s


1686 && 
î∫o
 !
EINVAL
)

1691 
î∫o
 = 
î∫o_s
;

1693  
îr°r
;

1694 
	}
}

1697 
	$sock›tvÆ2°rög
(
vÆue
, 
ty≥
, 
°r
, 
°rsize
)

1698 
sockë›tvÆue_t
 
vÆue
;

1699 
sockë›tvÆue_ty≥_t
 
ty≥
;

1700 *
°r
;

1701 
size_t
 
°rsize
;

1703 
size_t
 
°ru£d
;

1705 i‡(
°rsize
 == 0) {

1706 
buf
[100];

1708 
°r
 = 
buf
;

1709 
°rsize
 = (
buf
);

1712 *
°r
 = 
NUL
;

1713 
°ru£d
 = 0;

1715 
ty≥
) {

1716 
öt_vÆ
:

1717 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%d",

1718 
vÆue
.
öt_vÆ
);

1721 
uch¨_vÆ
:

1722 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%u",

1723 ()
vÆue
.
uch¨_vÆ
);

1726 
lögî_vÆ
:

1727 
timevÆ_vÆ
:

1728 
ö_addr_vÆ
:

1729 
sockaddr_vÆ
:

1730 
ù›ti⁄_vÆ
:

1731 #i‡
HAVE_TCP_IPA


1732 
›ti⁄28_vÆ
:

1735 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

1740 
	`SERRX
(
ty≥
);

1743 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

1744  
°r
;

1745 
	}
}

1748 
	$sock›éevñ2°rög
(
Àvñ
)

1749 
Àvñ
;

1752 
Àvñ
) {

1753 #ifde‡
SOL_SOCKET


1754 
SOL_SOCKET
:

1758 #ifde‡
IPPROTO_TCP


1759 
IPPROTO_TCP
:

1763 #ifde‡
IPPROTO_UDP


1764 
IPPROTO_UDP
:

1768 #ifde‡
IPPROTO_IP


1769 
IPPROTO_IP
:

1774 
	`SERRX
(
Àvñ
);

1778 
	}
}

1781 
	$sock›tvÆty≥2°rög
(
ty≥
)

1782 
sockë›tvÆue_ty≥_t
 
ty≥
;

1785 
ty≥
) {

1786 
öt_vÆ
:

1789 
lögî_vÆ
:

1792 
timevÆ_vÆ
:

1795 
ö_addr_vÆ
:

1798 
uch¨_vÆ
:

1801 
sockaddr_vÆ
:

1804 
ù›ti⁄_vÆ
:

1806 #i‡
HAVE_TCP_IPA


1807 
›ti⁄28_vÆ
:

1812 
	`SERRX
(
ty≥
);

1816 
	}
}

1819 
	$sock›t2°rög
(
›t
, 
°r
, 
°rsize
)

1820 c⁄° 
sockë›ti⁄_t
 *
›t
;

1821 *
°r
;

1822 
size_t
 
°rsize
;

1824 
size_t
 
°ru£d
;

1826 i‡(
°rsize
 == 0) {

1827 
buf
[100];

1829 
°r
 = 
buf
;

1830 
°rsize
 = (
buf
);

1833 
°ru£d
 = 
	`¢¥ötf
(
°r
, 
°rsize
,

1835 
›t
->
öfo
 =
NULL
 ? "<unknown>" : o±->öfo->
«me
,

1836 
›t
->
›äame
,

1837 
	`sock›éevñ2°rög
(
›t
->
öfo
 =
NULL
 ?

1838 
›t
->
Àvñ
 : o±->
öfo
->level),

1839 
›t
->
öfo
 =
NULL
 ? o±->
Àvñ
 : opt->info->level,

1840 
›t
->
öfo
 =
NULL
 ? -1 : ()›t->öfo->
ˇŒty≥
,

1841 
›t
->
öfo
 =
NULL
 ?

1842 "<unknown>" : 
›t
->
isöã∫Æside
 ?

1846 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

1848 
	`sock›tvÆ2°rög
(
›t
->
›tvÆ
, o±->
›ây≥
, 
NULL
, 0),

1849 
	`sock›tvÆty≥2°rög
(
›t
->
›ây≥
));

1852 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

1853  
°r
;

1854 
	}
}

1858 
	$sockë£âime2°rög
(
whichtime
)

1859 c⁄° 
whichtime
;

1861 c⁄° *
fun˘i⁄
 = "socketsettime2string()";

1863 
whichtime
) {

1864 
SOCKETOPT_PRE
:

1867 
SOCKETOPT_POST
:

1870 
SOCKETOPT_ANYTIME
:

1874 i‡(
whichtime
 =(
SOCKETOPT_PRE
 | 
SOCKETOPT_POST
))

1877 i‡(
whichtime
 =(
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
))

1880 i‡(
whichtime
 =(
SOCKETOPT_POST
 | 
SOCKETOPT_ANYTIME
))

1883 
	`sw¨nx
("%s: unknow¿vÆue: %d", 
fun˘i⁄
, 
whichtime
);

1885 
	}
}

1887 #i‡!
SOCKS_CLIENT


1890 
	$öãrÁ˚side2°rög
(
side
)

1891 c⁄° 
öãrÁ˚side_t
 
side
;

1894 
side
) {

1895 
INTERNALIF
:

1898 
EXTERNALIF
:

1902 
	`SERRX
(
side
);

1906 
	}
}

1909 
	$öãrÁ˚¥Ÿocﬁ2°rög
(
iÂrŸo
, 
°r
, 
°rsize
)

1910 c⁄° 
öãrÁ˚¥Ÿocﬁ_t
 *
iÂrŸo
;

1911 *
°r
;

1912 
size_t
 
°rsize
;

1915 i‡(
°rsize
 == 0) {

1916 
buf
[1024];

1918 
°r
 = 
buf
;

1919 
°rsize
 = (
buf
);

1922 
	`¢¥ötf
(
°r
, 
°rsize
, "%s: %s, %s: %s",

1923 
	`ßÁmûy2°rög
(
AF_INET
), 
iÂrŸo
->
ùv4
 ? "yes" : "no",

1924 
	`ßÁmûy2°rög
(
AF_INET6
), 
iÂrŸo
->
ùv6
 ? "yes" : "no");

1927  
°r
;

1928 
	}
}

1932 
	$√tw‹kã°2°rög
(
ã°
, 
°r
, 
°rsize
)

1933 c⁄° 
√tw‹kã°_t
 *
ã°
;

1934 *
°r
;

1935 
size_t
 
°rsize
;

1938 i‡(
°rsize
 == 0) {

1939 
buf
[1024];

1941 
°r
 = 
buf
;

1942 
°rsize
 = (
buf
);

1945 
	`¢¥ötf
(
°r
, 
°rsize
, "mtu.dŸe°: %d", 
ã°
->
mtu
.
dŸe°
);

1947  
°r
;

1948 
	}
}

1951 
	$addrsc›e2°rög
(
sc›e
)

1952 c⁄° 
ùv6_addrsc›e_t
 
sc›e
;

1954 
sc›e
) {

1955 
addrsc›e_globÆ
:

1958 
addrsc›e_lökloˇl
:

1961 
addrsc›e_nodñoˇl
:

1965 
	`SERRX
(
sc›e
);

1967 
	}
}

1970 
	$Æ¨mside2°rög
(
Æ¨mside
)

1971 c⁄° 
size_t
 
Æ¨mside
;

1974 
Æ¨mside
) {

1975 
ALARM_INTERNAL
:

1978 
ALARM_INTERNAL_RECV
:

1981 
ALARM_INTERNAL_SEND
:

1984 
ALARM_EXTERNAL
:

1987 
ALARM_EXTERNAL_RECV
:

1990 
ALARM_EXTERNAL_SEND
:

1993 
ALARM_RECV
:

1996 
ALARM_SEND
:

2000 
	`SERRX
(
Æ¨mside
);

2002 
	}
}

2005 
	$˛õ¡öfo2°rög
(
cöfo
, 
°r
, 
°rsize
)

2006 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

2007 *
°r
;

2008 
size_t
 
°rsize
;

2010 c⁄° *
fun˘i⁄
 = "clientinfo2string()";

2011 
size_t
 
°ru£d
;

2013 i‡(
°rsize
 == 0) {

2014 
buf
[1024];

2016 
°r
 = 
buf
;

2017 
°rsize
 = (
buf
);

2020 
°ru£d
 = 0;

2022 #i‡
HAVE_SOCKS_HOSTID


2024 
size_t
 
i
;

2026 
i
 = 0; i < (
size_t
)
cöfo
->
ho°idc
; ++i) {

2027 
¡›
[
MAXSOCKADDRSTRING
];

2029 i‡(
	`öë_¡›
(
AF_INET
, &
cöfo
->
ho°idv
[
i
], 
¡›
, “t›)Ë=
NULL
) {

2030 
	`¶og
(
LOG_DEBUG
, "%s: inet_ntop(3) failed on %s %x: %s",

2031 
fun˘i⁄
,

2032 
	`©y≥2°rög
(
SOCKS_ADDR_IPV4
),

2033 
cöfo
->
ho°idv
[
i
].
s_addr
,

2034 
	`°ªº‹
(
î∫o
));

2036 
	`¢¥ötf
(
¡›
, (ntop), "<unknown>");

2037 
î∫o
 = 0;

2040 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - såu£d, "[%s] ", 
¡›
);

2045 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s",

2046 
	`sockaddr2°rög
(&
cöfo
->
‰om
, 
NULL
, 0));

2048  
°r
;

2049 
	}
}

2052 
	$°©ekey2°rög
(
key
)

2053 c⁄° 
°©ekey_t
 
key
;

2056 
key
) {

2057 
key_un£t
:

2060 
key_‰om
:

2063 
key_ho°id
:

2067 
	`SERRX
(
key
);

2071 
	}
}

2073 
°©ekey_t


2074 
	$°rög2°©ekey
(
°rög
)

2075 c⁄° *
°rög
;

2078 i‡(
	`°rcmp
(
°rög
, "from") == 0)

2079  
key_‰om
;

2080 i‡(
	`°rcmp
(
°rög
, "hostid") == 0)

2081  
key_ho°id
;

2083  
key_un£t
;

2084 
	}
}

2087 
	$obje˘ty≥2°rög
(
ty≥
)

2088 c⁄° 
obje˘ty≥_t
 
ty≥
;

2091 
ty≥
) {

2092 
obje˘_sockaddr
:

2095 
obje˘_socksho°
:

2098 
obje˘_¸uÀ
:

2101 #i‡
HAVE_SOCKS_HOSTID


2102 
obje˘_hruÀ
:

2106 
obje˘_§uÀ
:

2109 
obje˘_m⁄ô‹
:

2113 
	`SERRX
(
ty≥
);

2117  
NULL
;

2118 
	}
}

2122 
	$›ti⁄s2°rög
(
›ti⁄s
, 
¥efix
, 
°r
, 
°rsize
)

2123 c⁄° 
›ti⁄_t
 *
›ti⁄s
;

2124 c⁄° *
¥efix
;

2125 *
°r
;

2126 
size_t
 
°rsize
;

2128 
size_t
 
°ru£d
;

2130 i‡(
°rsize
 == 0) {

2131 
buf
[1024];

2133 
°r
 = 
buf
;

2134 
°rsize
 = (
buf
);

2137 *
°r
 = 
NUL
;

2138 
°ru£d
 = 0;

2140 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2142 
¥efix
, 
›ti⁄s
->
d´m⁄
);

2144 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2146 
¥efix
, ()
›ti⁄s
->
£rvîc
);

2148 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2150 
¥efix
, 
›ti⁄s
->
vîify⁄ly
 ? "yes" : "no");

2152 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2154 
¥efix
, 
›ti⁄s
->
debug
);

2156 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2158 
¥efix
,

2159 
›ti⁄s
->
c⁄figfûe
 =
NULL
 ?

2160 
SOCKD_CONFIGFILE
 : 
›ti⁄s
->
c⁄figfûe
);

2162 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2164 
¥efix
, 
›ti⁄s
->
debug
);

2166 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2168 
¥efix
, 
›ti⁄s
->
kì∑live
);

2170 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2172 
¥efix
,

2173 
›ti⁄s
->
pidfûe
 =
NULL
 ?

2174 
SOCKD_PIDFILE
 : 
›ti⁄s
->
pidfûe
);

2176 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

2177  
°r
;

2178 
	}
}

2181 
	$logs2°rög
(
logs
, 
°r
, 
°rsize
)

2182 c⁄° 
log_t
 *
logs
;

2183 *
°r
;

2184 
size_t
 
°rsize
;

2186 
size_t
 
°ru£d
;

2188 i‡(
°rsize
 == 0) {

2189 
buf
[128];

2191 
°r
 = 
buf
;

2192 
°rsize
 = (
buf
);

2195 *
°r
 = 
NUL
;

2196 
°ru£d
 = 0;

2198 i‡(
logs
->
c⁄√˘
)

2199 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

2200 
	`QUOTE
(
SOCKS_LOG_CONNECTs
));

2202 i‡(
logs
->
disc⁄√˘
)

2203 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

2204 
	`QUOTE
(
SOCKS_LOG_DISCONNECTs
));

2206 i‡(
logs
->
d©a
)

2207 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

2208 
	`QUOTE
(
SOCKS_LOG_DATAs
));

2210 i‡(
logs
->
îr‹
)

2211 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

2212 
	`QUOTE
(
SOCKS_LOG_ERRORs
));

2214 i‡(
logs
->
io›î©i⁄
)

2215 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

2216 
	`QUOTE
(
SOCKS_LOG_IOOPERATIONs
));

2218 i‡(
logs
->
t˝öfo
)

2219 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

2220 
	`QUOTE
(
SOCKS_LOG_TCPINFOs
));

2222 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

2223  
°r
;

2224 
	}
}

2227 
	$chûdty≥2°rög
(
ty≥
)

2228 
ty≥
;

2231 
ty≥
) {

2232 
PROC_MOTHER
:

2235 
PROC_MONITOR
:

2238 
PROC_NEGOTIATE
:

2241 
PROC_REQUEST
:

2244 
PROC_IO
:

2248 
	`SERRX
(
ty≥
);

2252 
	}
}

2255 
	$vîdi˘2°rög
(
vîdi˘
)

2256 
vîdi˘
;

2259 
vîdi˘
) {

2260 
VERDICT_PASS
:

2261  
	`QUOTE
(
VERDICT_PASSs
);

2263 
VERDICT_BLOCK
:

2264  
	`QUOTE
(
VERDICT_BLOCKs
);

2267 
	`SERRX
(
vîdi˘
);

2269 
	}
}

2272 
	$li°2°rög
(
li°
, 
°r
, 
°rsize
)

2273 c⁄° 
löked«me_t
 *
li°
;

2274 *
°r
;

2275 
size_t
 
°rsize
;

2277 
size_t
 
°ru£d
;

2279 i‡(
°rsize
)

2280 *
°r
 = 
NUL
;

2282  
°r
;

2284 
°ru£d
 = 0;

2285 ; 
li°
 !
NULL
;Üi° =Üi°->
√xt
)

2286 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "\"%s\", ",

2287 
li°
->
«me
);

2289  
°r
;

2290 
	}
}

2293 
	$com∑ts2°rög
(
com∑ts
, 
°r
, 
°rsize
)

2294 c⁄° 
com∑t_t
 *
com∑ts
;

2295 *
°r
;

2296 
size_t
 
°rsize
;

2298 
size_t
 
°ru£d
;

2300 i‡(
°rsize
 == 0) {

2301 
buf
[32];

2303 
°r
 = 
buf
;

2304 
°rsize
 = (
buf
);

2307 *
°r
 = 
NUL
;

2308 
°ru£d
 = 0;

2310 i‡(
com∑ts
->
ßmï‹t
)

2311 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused, "%s, ",

2312 
	`QUOTE
("sameport"));

2314 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

2315  
°r
;

2316 
	}
}

2319 
	$§cho°s2°rög
(
§cho°
, 
¥efix
, 
°r
, 
°rsize
)

2320 c⁄° 
§cho°_t
 *
§cho°
;

2321 c⁄° *
¥efix
;

2322 *
°r
;

2323 
size_t
 
°rsize
;

2325 
size_t
 
°ru£d
;

2327 i‡(
°rsize
 == 0) {

2328 
buf
[32];

2330 
°r
 = 
buf
;

2331 
°rsize
 = (
buf
);

2334 *
°r
 = 
NUL
;

2335 
°ru£d
 = 0;

2337 i‡(
§cho°
->
nodnsmism©ch
)

2338 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2339 "\"%¢odnsmism©ch\", ", 
¥efix
);

2341 i‡(
§cho°
->
nodnsunknown
)

2342 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2343 "\"%¢odnsunknown\",", 
¥efix
);

2345 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

2346  
°r
;

2347 
	}
}

2350 
	$uid2«me
(
uid
)

2351 
uid_t
 
uid
;

2353 
∑sswd
 *
pw
;

2355 i‡((
pw
 = 
	`gëpwuid
(
uid
)Ë=
NULL
)

2356  
NULL
;

2358  
pw
->
pw_«me
;

2359 
	}
}

2362 
	$timeouây≥2°rög
(
ty≥
)

2363 
timeouây≥_t
 
ty≥
;

2366 
ty≥
) {

2367 
TIMEOUT_NEGOTIATE
:

2370 
TIMEOUT_CONNECT
:

2373 
TIMEOUT_IO
:

2376 
TIMEOUT_TCP_FIN_WAIT
:

2380 
	`SERRX
(
ty≥
);

2384 
	}
}

2387 
	$timeouts2°rög
(
timeouts
, 
¥efix
, 
°r
, 
°rsize
)

2388 c⁄° 
timeout_t
 *
timeouts
;

2389 c⁄° *
¥efix
;

2390 *
°r
;

2391 
size_t
 
°rsize
;

2393 
size_t
 
°ru£d
;

2395 i‡(
°rsize
 == 0) {

2396 
buf
[64];

2398 
°r
 = 
buf
;

2399 
°rsize
 = (
buf
);

2402 *
°r
 = 
NUL
;

2403 
°ru£d
 = 0;

2405 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2407 
¥efix
, ()
timeouts
->
√gŸüã
);

2409 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2411 
¥efix
,

2412 ()
timeouts
->
t˝io
,

2413 ()
timeouts
->
udpio
);

2415 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

2416  
°r
;

2417 
	}
}

2420 
	$rŸ©i⁄2°rög
(
rŸ©i⁄
)

2421 
rŸ©i⁄
;

2424 
rŸ©i⁄
) {

2425 
ROTATION_NONE
:

2428 
ROTATION_SAMESAME
:

2431 
ROTATION_ROUTE
:

2435 
	`SERRX
(
rŸ©i⁄
);

2439 
	}
}

2442 
	$¥iv›2°rög
(
›
)

2443 c⁄° 
¥iv_›_t
 
›
;

2445 
›
) {

2446 
PRIV_ON
:

2449 
PRIV_OFF
:

2455 
	`SERRX
(
›
);

2456 
	}
}

2460 #i‡
HAVE_SCHED_SETAFFINITY


2462 
	$˝u£t2°rög
(
£t
, 
°r
, 
°rsize
)

2463 c⁄° 
˝u_£t_t
 *
£t
;

2464 *
°r
;

2465 
size_t
 
°rsize
;

2467 c⁄° 
size_t
 
£tsize
 = 
	`˝u_gë_£tsize
();

2468 
size_t
 
i
, 
°ru£d
;

2470 i‡(
°rsize
 == 0) {

2471 
buf
[2048];

2473 
°r
 = 
buf
;

2474 
°rsize
 = (
buf
);

2477 *
°r
 = 
NUL
;

2478 
°ru£d
 = 0;

2480 
i
 = 0; i < 
£tsize
; ++i)

2481 i‡(
	`˝u_is£t
(
i
, 
£t
))

2482 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - såu£d, "%ld ", ()
i
);

2484  
°r
;

2485 
	}
}

2489 #i‡!
HAVE_PRIVILEGES


2491 
	$u£rids2°rög
(
u£rids
, 
¥efix
, 
°r
, 
°rsize
)

2492 c⁄° 
u£rid_t
 *
u£rids
;

2493 c⁄° *
¥efix
;

2494 *
°r
;

2495 
size_t
 
°rsize
;

2497 
size_t
 
°ru£d
;

2499 i‡(
°rsize
 == 0) {

2500 
buf
[128];

2502 
°r
 = 
buf
;

2503 
°rsize
 = (
buf
);

2506 *
°r
 = 
NUL
;

2507 
°ru£d
 = 0;

2509 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2511 
¥efix
, 
	`uid2«me
(
u£rids
->
¥ivûeged_uid
));

2513 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2515 
¥efix
, 
	`uid2«me
(
u£rids
->
u≈rivûeged_uid
));

2517 
°ru£d
 +
	`¢¥ötf
(&
°r
[°ru£d], 
°rsize
 - strused,

2519 
¥efix
, 
	`uid2«me
(
u£rids
->
libwøp_uid
));

2521 
	`STRIPTRAILING
(
°r
, 
°ru£d
, 
°rù°rög
);

2522  
°r
;

2523 
	}
}

2526 #i‡
COVENANT


2528 
	$hâpcode2°rög
(
vîsi⁄
, 
code
)

2529 c⁄° 
vîsi⁄
;

2530 c⁄° 
code
;

2532 
¥efix
[16], 
buf
[64];

2534 
	`SASSERTX
(
vîsi⁄
 =
PROXY_HTTP_10


2535 || 
vîsi⁄
 =
PROXY_HTTP_11
);

2537 
	`¢¥ötf
(
¥efix
, (prefix), "HTTP/1.%d %d",

2538 
vîsi⁄
 =
PROXY_HTTP_10
 ? 0 : 1, 
code
);

2540 
code
) {

2541 
HTTP_SUCCESS
:

2542 
	`¢¥ötf
(
buf
, (buf), "%†Suc˚ss", 
¥efix
);

2545 
HTTP_FORBIDDEN
:

2546 
	`¢¥ötf
(
buf
, (buf), "%†NŸáŒowed", 
¥efix
);

2549 
HTTP_NOTALLOWED
:

2550 
	`¢¥ötf
(
buf
, (buf), "%†NŸáuth‹ized", 
¥efix
);

2553 
HTTP_PROXYAUTHREQUIRED
:

2554 
	`¢¥ötf
(
buf
, (buf), "%†NŸáuth‹ized", 
¥efix
);

2557 
HTTP_HOSTUNREACH
:

2558 
	`¢¥ötf
(
buf
, (buf), "%†NŸÑóchabÀ", 
¥efix
);

2561 
HTTP_FAILURE
:

2562 
	`¢¥ötf
(
buf
, (buf), "%†Unknow¿¥oxy sîvîÉº‹", 
¥efix
);

2566 
	`SERRX
(
code
);

2569  
buf
;

2570 
	}
}

	@lib/udp.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
ssize_t


52 
	$R£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
_to
, 
tﬁí
)

53 
s
;

54 c⁄° *
msg
;

55 
size_t
 
Àn
;

56 
Êags
;

57 c⁄° 
sockaddr
 *
_to
;

58 
sockÀn_t
 
tﬁí
;

60 c⁄° *
fun˘i⁄
 = "Rsendto()";

61 
socksfd_t
 
socksfd
;

62 
socksho°_t
 
toho°
;

63 
sockaddr_°‹age
 
tomem
, *
to
;

64 
size_t
 
∆í
;

65 
sockÀn_t
 
ty≥Àn
;

66 
ssize_t
 
n
;

67 
§c°r
[
MAXSOCKADDRSTRING
], 
d°°r
[(§c°r)], 
nmsg
[
SOCKD_BUFSIZE
];

68 
ty≥
;

70 
	`˛õ¡öô
();

72 i‡(
_to
 =
NULL
)

73 
to
 = 
NULL
;

75 
to
 = &
tomem
;

76 
	`u§sockaddr˝y
(
to
, 
	`TOCSS
(
_to
), 
	`ßÀn
(_to->
ß_Ámûy
));

79 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Üen %lu,áddress %s",

80 
fun˘i⁄
,

81 
s
,

82 ()
Àn
,

83 
to
 =
NULL
 ? "NULL" : 
	`sockaddr2°rög
(to, NULL, 0));

85 i‡(
to
 !
NULL
 &&Åo->
ss_Ámûy
 !
AF_INET
) {

86 
	`¶og
(
LOG_DEBUG
, "%s: unsupportedáddress family '%d', system fallback",

87 
fun˘i⁄
, 
to
->
ss_Ámûy
);

89  
	`£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
	`TOCSA
(
to
), 
tﬁí
);

92 
ty≥Àn
 = (
ty≥
);

93 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
ty≥
, &
ty≥Àn
) != 0) {

94 
	`sw¨n
("%s: gësock›t(SO_TYPE)", 
fun˘i⁄
);

98 i‡(
ty≥
 !
SOCK_DGRAM
 &&Åy≥ !
SOCK_STREAM
) {

99 
n
 = 
	`£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
	`TOCSA
(
to
), 
tﬁí
);

101 
	`¶og
(
LOG_DEBUG
,

104 
fun˘i⁄
, 
s
, ()
n
);

106  
n
;

109 i‡(
ty≥
 =
SOCK_DGRAM
) {

110 
emsg
[256];

112 
socksfd
.
rouã
 = 
	`udp£tup
(
s
, 
to
, 
SOCKS_SEND
, 0, 
emsg
, (emsg));

113 i‡(
socksfd
.
rouã
 =
NULL
) {

114 i‡(
to
 =
NULL
) {

119 
n
 = 
	`£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
	`TOCSA
(
to
), 
tﬁí
);

121 
	`¶og
(
LOG_DEBUG
,

124 
fun˘i⁄
, 
s
, ()
n
, 
	`°ªº‹
(
î∫o
));

126  
n
;

130 
	`¶og
(
LOG_DEBUG
,

133 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(
to
, 
NULL
, 0), 
emsg
);

135 
î∫o
 = 
ENETUNREACH
;

140 
	`¶og
(
LOG_DEBUG
,

142 
fun˘i⁄
,

143 
s
,

144 
	`¥oxy¥Ÿocﬁs2°rög
(&
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
,

145 
NULL
,

148 i‡(
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
)

149  
	`£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
	`TOSA
(
to
), 
tﬁí
);

151 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1))

152 
	`SERRX
(
s
);

156 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1)) {

157 
	`¶og
(
LOG_DEBUG
, "%s: unknow¿fd %d, goög dúe˘", 
fun˘i⁄
, 
s
);

159  
	`£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
	`TOSA
(
to
), 
tﬁí
);

162 i‡(
socksfd
.
°©e
.
îr
 != 0) {

163 
	`¶og
(
LOG_DEBUG
, "%s: session on fd %dálready failed withÉrrno %d",

164 
fun˘i⁄
, 
s
, 
socksfd
.
°©e
.
îr
);

166 
î∫o
 = 
socksfd
.
°©e
.
îr
;

170 i‡(
socksfd
.
°©e
.
issysˇŒ


171 || 
socksfd
.
°©e
.
vîsi⁄
 =
PROXY_DIRECT


172 || 
socksfd
.
°©e
.
vîsi⁄
 =
PROXY_UPNP
) {

173 
n
 = 
	`£ndto
(
s
, 
msg
, 
Àn
, 
Êags
, 
	`TOSA
(
to
), 
tﬁí
);

175 
	`¶og
(
LOG_DEBUG
, "%s: sendto(2)Åo %s on fd %dÑeturned %ld (%s)",

176 
fun˘i⁄
,

177 
to
 =
NULL
 ?

178 "NULL" : 
	`sockaddr2°rög
(
to
, 
NULL
, 0),

179 
s
,

180 ()
n
,

181 
	`°ªº‹
(
î∫o
));

183  
n
;

186 i‡(
to
 =
NULL
) {

187 i‡(
socksfd
.
°©e
.
udpc⁄√˘
) {

188 
	`SASSERTX
(
ty≥
 =
SOCK_DGRAM
);

189 
toho°
 = 
socksfd
.
f‹us
.
c⁄√˘ed
;

192 
	`SASSERTX
(
ty≥
 =
SOCK_STREAM
);

194 i‡(
socksfd
.
°©e
.
ö¥ogªss
) {

195 
	`SASSERTX
(
socksfd
.
°©e
.
comm™d
 =
SOCKS_CONNECT
);

197 
	`¶og
(
LOG_INFO
,

199 
fun˘i⁄
, 
s
);

241 i‡(
tﬁí
 == 0)

242 
î∫o
 = 
ENOTCONN
;

244 
î∫o
 = 
EAGAIN
;

249 
n
 = 
	`socks_£ndto
(
s
,

250 
msg
,

251 
Àn
,

252 
Êags
,

253 
NULL
,

255 
NULL
,

256 &
socksfd
.
°©e
.
auth
);

258 
	`¶og
(
LOG_DEBUG
, "%s: %s: %s: %s -> %s (%ld)",

259 
fun˘i⁄
,

260 
	`¥oxy¥Ÿocﬁ2°rög
(
socksfd
.
°©e
.
vîsi⁄
),

261 
	`¥Ÿocﬁ2°rög
(
SOCKS_TCP
),

262 
	`sockaddr2°rög
(&
socksfd
.
loˇl
,

263 
d°°r
,

264 (
d°°r
)),

265 
	`sockaddr2°rög
(&
socksfd
.
£rvî
,

266 
§c°r
,

267 (
§c°r
)),

268 ()
n
);

271 ()
	`socks_addaddr
(
s
, &
socksfd
, 1);

273  
n
;

277 
	`Ákesockaddr2socksho°
(
to
, &
toho°
);

279 
	`SASSERTX
(
ty≥
 =
SOCK_DGRAM
);

286 
	`mem˝y
(
nmsg
, 
msg
, 
Àn
);

287 
∆í
 = 
Àn
;

288 i‡(
	`udphódî_add
(&
toho°
, 
nmsg
, &
∆í
, “msg)Ë=
NULL
)

291 
n
 = 
	`socks_£ndto
(
s
,

292 
nmsg
,

293 
∆í
,

294 
Êags
,

295 
socksfd
.
°©e
.
udpc⁄√˘
 ? 
NULL
 : &socksfd.
ª∂y
,

296 
socksfd
.
°©e
.
udpc⁄√˘
 ?

297 (
sockÀn_t
)0 : 
	`ßÀn
(
socksfd
.
ª∂y
.
ss_Ámûy
),

298 
NULL
,

299 &
socksfd
.
°©e
.
auth
);

301 
n
 -(
ssize_t
)(
∆í
 - 
Àn
);

303 
	`¶og
(
LOG_DEBUG
,

305 
fun˘i⁄
,

306 
	`¥oxy¥Ÿocﬁ2°rög
(
socksfd
.
°©e
.
vîsi⁄
),

307 
	`¥Ÿocﬁ2°rög
(
SOCKS_UDP
),

308 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
d°°r
, (dststr)),

309 
	`sockaddr2°rög
(&
socksfd
.
ª∂y
, 
§c°r
, (srcstr)),

310 
	`socksho°2°rög
(&
toho°
, 
NULL
, 0),

311 ()
n
);

314 ()
	`socks_addaddr
(
s
, &
socksfd
, 1);

316  
	`MAX
(-1, 
n
);

317 
	}
}

319 
ssize_t


320 
	$Rªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
)

321 
s
;

322 *
buf
;

323 
size_t
 
Àn
;

324 
Êags
;

325 
sockaddr
 *
‰om
;

326 
sockÀn_t
 *
‰omÀn
;

328 c⁄° *
fun˘i⁄
 = "Rrecvfrom()";

329 
socksfd_t
 
socksfd
;

330 
udphódî_t
 
hódî
;

331 
sockaddr_°‹age
 
√w‰om
;

332 
sockÀn_t
 
ty≥Àn
, 
√w‰omÀn
;

333 
§c°r
[
MAXSOCKSHOSTSTRING
], 
d°°r
[(§c°r)], *
√wbuf
;

334 
size_t
 
∑ylﬂdoff£t
, 
√wÀn
;

335 
ssize_t
 
n
;

336 
ty≥
, 
is‰om¥oxy
;

338 
agaö
:

340 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Üí %lu", 
fun˘i⁄
, 
s
, ()
Àn
);

342 
ty≥Àn
 = (
ty≥
);

343 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
ty≥
, &
ty≥Àn
) != 0) {

344 
	`sw¨n
("%s: gësock›t(SO_TYPE)", 
fun˘i⁄
);

348 i‡(
ty≥
 !
SOCK_DGRAM
 &&Åy≥ !
SOCK_STREAM
) {

349 
n
 = 
	`ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

351 
	`¶og
(
LOG_DEBUG
,

354 
fun˘i⁄
, 
s
, ()
n
);

356  
n
;

359 i‡(
	`socks_addrisours
(
s
, &
socksfd
, 1)) {

360 i‡(
socksfd
.
°©e
.
îr
 != 0) {

361 
	`¶og
(
LOG_DEBUG
, "%s: session on fd %dálready failed withÉrrno %d",

362 
fun˘i⁄
, 
s
, 
socksfd
.
°©e
.
îr
);

364 
î∫o
 = 
socksfd
.
°©e
.
îr
;

368 i‡(
socksfd
.
°©e
.
issysˇŒ


369 || 
socksfd
.
°©e
.
vîsi⁄
 =
PROXY_DIRECT


370 || 
socksfd
.
°©e
.
vîsi⁄
 =
PROXY_UPNP
) {

371 
n
 = 
	`ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

373 
	`¶og
(
LOG_DEBUG
, "%s:Ñecvfrom(2) on fd %dÑeturned %ld (%s)",

374 
fun˘i⁄
, 
s
, ()
n
, 
	`°ªº‹
(
î∫o
));

376  
n
;

380 
	`socks_rmaddr
(
s
, 1);

382 i‡(
ty≥
 !
SOCK_DGRAM
)

383  
	`ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

385 
	`bzîo
(&
socksfd
, (socksfd));

388 i‡(
ty≥
 =
SOCK_DGRAM
) {

389 
emsg
[256];

391 
socksfd
.
rouã


392 
	`udp£tup
(
s
, 
	`TOSS
(
‰om
), 
SOCKS_RECV
, 0, 
emsg
, (emsg));

394 i‡(
socksfd
.
rouã
 =
NULL
) {

395 
	`¶og
(
LOG_DEBUG
,

398 
fun˘i⁄
, 
s
, 
emsg
);

400  
	`ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

403 
	`¶og
(
LOG_DEBUG
,

405 
fun˘i⁄
,

406 
s
,

407 
	`¥oxy¥Ÿocﬁs2°rög
(&
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
,

408 
NULL
,

411 i‡(
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
)

412  
	`ªcv‰om
(
s
, 
buf
, 
Àn
, 
Êags
, 
‰om
, 
‰omÀn
);

414 i‡(!
	`socks_addrisours
(
s
, &
socksfd
, 1))

415 
	`SERRX
(
s
);

418 
	`SASSERTX
(
	`socks_addrisours
(
s
, &
socksfd
, 1));

424 i‡(
socksfd
.
°©e
.
¥Ÿocﬁ
.
t˝
) {

425 c⁄° 
socksho°_t
 *
f‹us
;

427 
	`SASSERTX
(
ty≥
 =
SOCK_STREAM
);

429 i‡(
socksfd
.
°©e
.
ö¥ogªss
) {

430 
	`SASSERTX
(
socksfd
.
°©e
.
comm™d
 =
SOCKS_CONNECT
);

432 
	`¶og
(
LOG_INFO
,

434 
fun˘i⁄
, 
s
);

439 i‡(
‰omÀn
 == 0)

440 
î∫o
 = 
ENOTCONN
;

442 
î∫o
 = 
EAGAIN
;

447 
n
 = 
	`socks_ªcv‰omn
(
s
,

448 
buf
,

449 
Àn
,

451 
Êags
,

452 
	`TOSS
(
‰om
),

453 
‰omÀn
,

454 
NULL
,

455 &
socksfd
.
°©e
.
auth
);

457 
socksfd
.
°©e
.
comm™d
) {

458 
SOCKS_CONNECT
:

459 
f‹us
 = &
socksfd
.f‹us.
c⁄√˘ed
;

462 
SOCKS_BIND
:

463 
f‹us
 = &
socksfd
.f‹us.
ac˚±ed
;

465 i‡(
f‹us
->
©y≥
 =
SOCKS_ADDR_NOTSET
) {

466 
	`¶og
(
LOG_DEBUG
, "%s:ÅryingÅoÑead from fd %d, which is "

468 
fun˘i⁄
, 
s
);

470 
f‹us
 = 
NULL
;

471 
n
 = -1;

472 
î∫o
 = 
ENOTCONN
;

477 
	`SERRX
(
socksfd
.
°©e
.
comm™d
);

480 
	`¶og
(
LOG_DEBUG
, "%s: %s: %s: %s -> %s (%ld)",

481 
fun˘i⁄
,

482 
	`¥oxy¥Ÿocﬁ2°rög
(
socksfd
.
°©e
.
vîsi⁄
),

483 
	`¥Ÿocﬁ2°rög
(
SOCKS_TCP
),

484 
f‹us
 =
NULL
 ?

485 "<NULL>" : 
	`socksho°2°rög
(
f‹us
, 
§c°r
, (srcstr)),

486 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
d°°r
, (dststr)),

487 ()
n
);

490 ()
	`socks_addaddr
(
s
, &
socksfd
, 1);

492  
n
;

495 
	`SASSERTX
(
socksfd
.
°©e
.
¥Ÿocﬁ
.
udp
);

501 
√wÀn
 = 
Àn
 + (
hódî
);

502 i‡((
√wbuf
 = 
	`mÆloc
((*√wbufË* 
√wÀn
)Ë=
NULL
) {

503 
î∫o
 = 
ENOBUFS
;

507 
√w‰omÀn
 = (
√w‰om
);

508 i‡((
n
 = 
	`socks_ªcv‰om
(
s
,

509 
√wbuf
,

510 
√wÀn
,

511 
Êags
,

512 &
√w‰om
,

513 &
√w‰omÀn
,

514 
NULL
,

515 &
socksfd
.
°©e
.
auth
)) == -1) {

516 
	`‰ì
(
√wbuf
);

517  
n
;

520 
	`SASSERTX
(
√w‰omÀn
 > 0);

522 i‡(
	`sockaddøªeq
(&
√w‰om
, &
socksfd
.
ª∂y
, 0)) {

523 
is‰om¥oxy
 = 1;

525 i‡(
	`°rög2udphódî
(
√wbuf
, (
size_t
)
n
, &
hódî
Ë=
NULL
) {

526 
	`sw¨nx
("%s: unrecognized socks udpÖacket from %s",

527 
fun˘i⁄
, 
	`sockaddr2°rög
(&
√w‰om
, 
NULL
, 0));

529 
	`‰ì
(
√wbuf
);

531 
î∫o
 = 
EAGAIN
;

535 
	`¶og
(
LOG_DEBUG
, "%s:Öroxy serverát %s says udpÖacket is from %s",

536 
fun˘i⁄
,

537 
	`sockaddr2°rög
(&
√w‰om
, 
NULL
, 0),

538 
	`socksho°2°rög
(&
hódî
.
ho°
, 
NULL
, 0));

541 
	`Ákesocksho°2sockaddr
(&
hódî
.
ho°
, &
√w‰om
);

544 
n
 -(
ssize_t
)
	`HEADERSIZE_UDP
(&
hódî
);

545 
∑ylﬂdoff£t
 = 
	`HEADERSIZE_UDP
(&
hódî
);

548 
is‰om¥oxy
 = 0;

550 
	`¶og
(
LOG_DEBUG
, "%s:Öacket is from %s,Çot fromÅheÖroxy server (%s)",

551 
fun˘i⁄
,

552 
	`sockaddr2°rög
(&
√w‰om
, 
§c°r
, (srcstr)),

553 
	`sockaddr2°rög
(&
socksfd
.
ª∂y
, 
d°°r
, (dststr)));

555 
∑ylﬂdoff£t
 = 0;

558 
	`SASSERTX
(
n
 >= 0);

560 i‡(
socksfd
.
°©e
.
udpc⁄√˘
) {

565 
dr›ô
 = 0;

567 i‡(
is‰om¥oxy
) {

574 i‡(
socksfd
.
f‹us
.
c⁄√˘ed
.
©y≥
 =
SOCKS_ADDR_IPV4


575 && !
	`socksho°¨ìq
(&
hódî
.
ho°
, &
socksfd
.
f‹us
.
c⁄√˘ed
)) {

576 
	`¶og
(
LOG_INFO
,

579 
fun˘i⁄
,

580 
	`socksho°2°rög
(&
socksfd
.
f‹us
.
c⁄√˘ed
,

581 
d°°r
,

582 (
d°°r
)),

583 
	`socksho°2°rög
(&
hódî
.
ho°
, 
§c°r
, (srcstr)));

585 
dr›ô
 = 1;

589 
	`¶og
(
LOG_INFO
,

592 
fun˘i⁄
,

593 
	`socksho°2°rög
(&
socksfd
.
f‹us
.
c⁄√˘ed
, 
NULL
, 0),

594 
	`sockaddr2°rög
(&
socksfd
.
ª∂y
,

595 
§c°r
,

596 (
§c°r
)),

597 
	`sockaddr2°rög
(&
√w‰om
,

598 
d°°r
,

599 (
d°°r
)));

600 
dr›ô
 = 1;

603 i‡(
dr›ô
) {

604 
	`‰ì
(
√wbuf
);

606 i‡(
	`fdisblockög
(
s
)) {

607 
	`¶og
(
LOG_DEBUG
,

610 
fun˘i⁄
, 
s
);

612 
agaö
;

615 
î∫o
 = 
EAGAIN
;

620 
	`mem˝y
(
buf
, &
√wbuf
[
∑ylﬂdoff£t
], 
	`MIN
(
Àn
, (
size_t
)
n
));

621 
	`‰ì
(
√wbuf
);

623 
	`¶og
(
LOG_DEBUG
, "%s: %s: %s: %s -> %s%s%s (%ld)",

624 
fun˘i⁄
,

625 
	`¥oxy¥Ÿocﬁ2°rög
(
socksfd
.
°©e
.
vîsi⁄
),

626 
	`¥Ÿocﬁ2°rög
(
SOCKS_UDP
),

627 
	`sockaddr2°rög
(&
√w‰om
, 
§c°r
, (srcstr)),

628 
is‰om¥oxy
 ?

629 
	`sockaddr2°rög
(&
socksfd
.
ª∂y
, 
NULL
, 0) : "",

630 
is‰om¥oxy
 ? " -> " : "",

631 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
d°°r
, (dststr)),

632 ()(
n
));

634 i‡(
‰om
 !
NULL
) {

635 *
‰omÀn
 = 
	`MIN
(*‰omÀn, 
√w‰omÀn
);

636 
	`sockaddr˝y
(
	`TOSS
(
‰om
), &
√w‰om
, (
size_t
)*
‰omÀn
);

640 ()
	`socks_addaddr
(
s
, &
socksfd
, 1);

642  
	`MIN
(
Àn
, (
size_t
)
n
);

643 
	}
}

645 
rouã_t
 *

646 
	$udp£tup
(
s
, 
to
, 
ty≥
, 
shouldc⁄√˘
, 
emsg
, 
emsgÀn
)

647 
s
;

648 c⁄° 
sockaddr_°‹age
 *
to
;

649 
ty≥
;

650 
shouldc⁄√˘
;

651 *
emsg
;

652 c⁄° 
size_t
 
emsgÀn
;

654 c⁄° *
fun˘i⁄
 = "udpsetup()";

655 
rouã_t
 
dúe˘rouã
;

656 
socksfd_t
 
socksfd
;

657 
authmëhod_t
 
auth
;

658 
socks_t
 
∑ckë
;

659 
socksho°_t
 
§c
, 
d°
;

660 
sockaddr_°‹age
 
addr
;

661 
sockÀn_t
 
Àn
;

663 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Åype = %s,Åo = %s, shouldconnect = %d",

664 
fun˘i⁄
,

665 
s
,

666 
ty≥
 =
SOCKS_RECV
 ? "receive" : "send",

667 (
to
 =
NULL
 || 
ty≥
 =
SOCKS_RECV
) ?

668 "N/A" : 
	`sockaddr2°rög
(
to
, 
NULL
, 0),

669 
shouldc⁄√˘
);

671 
î∫o
 = 0;

677 
dúe˘rouã
.
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
 = 1;

679 
	`bzîo
(&
socksfd
, (socksfd));

680 
Àn
 = (
addr
);

681 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
addr
), &
Àn
) != 0) {

682 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "gësock«me(sËÁûed: %s", 
	`°ªº‹
(
î∫o
));

683  
NULL
;

686 
	`¶og
(
LOG_DEBUG
, "%s:Üocaláddress of fd %d is %s",

687 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

689 
	`TOSA
(&
addr
)->
ß_Ámûy
) {

690 
AF_INET
:

694 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "unsuµ‹ãdá‡%d", 
	`TOSA
(&
addr
)->
ß_Ámûy
);

695  
NULL
;

698 i‡(
	`socks_addrisours
(
s
, &
socksfd
, 1)) {

699 i‡(
socksfd
.
°©e
.
comm™d
 =
SOCKS_UDPASSOCIATE
) {

700 
	`¶og
(
LOG_DEBUG
, "%s:Åhög†Æªady së u∞f‹ fd %d", 
fun˘i⁄
, 
s
);

701  
socksfd
.
rouã
;

704 
	`¶og
(
LOG_DEBUG
, "%s: socket wasÖreviously used for command %s",

705 
fun˘i⁄
, 
	`comm™d2°rög
(
socksfd
.
°©e
.
comm™d
));

708 
	`socks_rmaddr
(
s
, 1);

710 i‡(
	`socks_sockëisf‹œn
(
s
)) {

711 
	`¶og
(
LOG_INFO
, "%s: fd %d i†f‹Ü™ o∆y", 
fun˘i⁄
, 
s
);

712  &
dúe˘rouã
;

715 
	`bzîo
(&
socksfd
, (socksfd));

716 
socksfd
.
c⁄åﬁ
 = -1;

717 
socksfd
.
loˇl
 = 
addr
;

719 
ty≥
) {

720 
SOCKS_RECV
:

731 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

732 "%s:áâem±edÑe˚ivê⁄ uƒegi°îed fd %d", 
fun˘i⁄
, 
s
);

734  
NULL
;

736 
SOCKS_SEND
:

737 i‡(
to
 =
NULL
) {

742 
sockÀn_t
 
addæí
 = (
addr
);

743 i‡(
	`gë≥î«me
(
s
, 
	`TOSA
(&
addr
), &
addæí
) == 0) {

744 
vÆ
;

746 
Àn
 = (
vÆ
);

747 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
vÆ
, &
Àn
) != 0) {

748 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "getsockopt(SO_TYPE) failed: %s",

749 
	`°ªº‹
(
î∫o
));

751  
NULL
;

754 
vÆ
) {

755 
SOCK_DGRAM
:

756 
	`¶og
(
LOG_INFO
,

759 
fun˘i⁄
,

760 
s
,

761 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

765 
SOCK_STREAM
:

766 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

769 
s
,

770 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

771  
NULL
;

774  &
dúe˘rouã
;

777 
to
 = &
addr
;

778 
shouldc⁄√˘
 = 1;

781 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "unknow¿fd %dándÇÿto-addr", 
s
);

782  
NULL
;

788 
	`SERRX
(
ty≥
);

791 
	`sockaddr2socksho°
(&
socksfd
.
loˇl
, &
§c
);

792 
	`Ákesockaddr2socksho°
(
to
, &
d°
);

794 
	`bzîo
(&
auth
, (auth));

795 
auth
.
mëhod
 = 
AUTHMETHOD_NOTSET
;

797 
	`bzîo
(&
∑ckë
, (packet));

798 
∑ckë
.
vîsi⁄
 = 
PROXY_DIRECT
;;

799 
∑ckë
.
ªq
.
vîsi⁄
 =Öacket.version;

800 
∑ckë
.
ªq
.
comm™d
 = 
SOCKS_UDPASSOCIATE
;

806 
∑ckë
.
ªq
.
Êag
 |
SOCKS_USECLIENTPORT
;

809 
∑ckë
.
ªq
.
ho°
 = 
§c
;

810 
∑ckë
.
ªq
.
¥Ÿocﬁ
 = 
SOCKS_UDP
;

811 
∑ckë
.
ªq
.
auth
 = &auth;

813 i‡((
socksfd
.
rouã
 = 
	`socks_ªque°pﬁish
(&
∑ckë
.
ªq
, &
§c
, &
d°
)Ë=
NULL
) {

814 
§c°r
[
MAXSOCKSHOSTSTRING
], 
d°°r
[(srcstr)];

816 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "noÑoute from %sÅo %s found",

817 
	`socksho°2°rög
(&
§c
, 
§c°r
, (srcstr)),

818 
	`socksho°2°rög
(&
d°
, 
d°°r
, (dststr)));

820  
NULL
;

823 i‡(
socksfd
.
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

824 
	`¶og
(
LOG_DEBUG
, "%s: dúe˘ sy°em cÆl†f‹ fd %d", 
fun˘i⁄
, 
s
);

826 
dúe˘rouã
 = *
socksfd
.
rouã
;

827  &
dúe˘rouã
;

831 
∑ckë
.
vîsi⁄
 =Öackë.
ªq
.version) {

832 
PROXY_SOCKS_V5
:

833 
PROXY_UPNP
:

834 i‡((
socksfd
.
c⁄åﬁ
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0)) == -1) {

835 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

836 "ÁûedÅÿ¸óã c⁄åﬁ sockë: %s", 
	`°ªº‹
(
î∫o
));

837  
NULL
;

840 
	`¶og
(
LOG_DEBUG
, "%s: control fd %d created for data fd %d",

841 
fun˘i⁄
, 
socksfd
.
c⁄åﬁ
, 
s
);

844 
PROXY_DIRECT
:

848 
	`SERRX
(
∑ckë
.
vîsi⁄
);

851 i‡(
	`socks_rouã£tup
(
socksfd
.
c⁄åﬁ
, 
s
, socksfd.
rouã
, 
emsg
, 
emsgÀn
)

853 
	`sw¨nx
("%s: socks_rouã£tup(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

855 i‡(
socksfd
.
c⁄åﬁ
 != -1)

856 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

858  
NULL
;

864 
Àn
 = (
socksfd
.
loˇl
);

865 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), &
Àn
) != 0) {

866 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "gësock«me(sËÁûed: %s", 
	`°ªº‹
(
î∫o
));

867  
NULL
;

870 
	`¶og
(
LOG_DEBUG
, "%s:Üocaláddress of fd %d (data-fd) is %s",

871 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
NULL
, 0));

873 
	`sockaddr2socksho°
(&
socksfd
.
loˇl
, &
§c
);

875 i‡((
socksfd
.
rouã
 = 
	`socks_c⁄√˘rouã
(socksfd.
c⁄åﬁ
,

876 &
∑ckë
,

877 &
§c
,

878 &
d°
,

879 
emsg
,

880 
emsgÀn
)Ë=
NULL
) {

881 
	`sw¨nx
("couldÇŸ c⁄√˘Ñouã: %s", 
emsg
);

883 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

884  
NULL
;

893 i‡(
	`PORTISBOUND
(&
socksfd
.
loˇl
))

894 
	`¶og
(
LOG_DEBUG
, "%s: fd %dálready boundÅo %s, usingÅhat",

895 
fun˘i⁄
, 
s
, 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
NULL
, 0));

905 
Àn
 = (
socksfd
.
loˇl
);

906 i‡(
	`gësock«me
(
socksfd
.
c⁄åﬁ
, 
	`TOSA
(&socksfd.
loˇl
), &
Àn
) != 0) {

907 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "getsockname(socksfd.control) failed: %s",

908 
	`°ªº‹
(
î∫o
));

910 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

911  
NULL
;

913 
	`SET_SOCKADDRPORT
(&
socksfd
.
loˇl
, 
	`ht⁄s
(0));

915 i‡(
	`böd
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), 
	`ßÀn
(socksfd.loˇl.
ss_Ámûy
)) != 0) {

916 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "bind() of fd %d (s)Åoáddress %s failed: %s",

917 
s
,

918 
	`sockaddr2°rög
(&
socksfd
.
loˇl
, 
NULL
, 0),

919 
	`°ªº‹
(
î∫o
));

921 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

922  
NULL
;

925 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
socksfd
.
loˇl
), &
Àn
) != 0) {

926 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "getsockname() on fd %d (s) failed: %s",

927 
s
, 
	`°ªº‹
(
î∫o
));

929 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

930  
NULL
;

934 
	`sockaddr2socksho°
(&
socksfd
.
loˇl
, &
∑ckë
.
ªq
.
ho°
);

936 i‡(
	`socks_√gŸüã
(
s
,

937 
socksfd
.
c⁄åﬁ
,

938 &
∑ckë
,

939 
socksfd
.
rouã
,

940 
emsg
,

941 
emsgÀn
) != 0) {

942 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

944 
	`sw¨nx
("%s: socks_√gŸüã(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

945  
NULL
;

948 
	`upd©e_a·î_√gŸüã
(&
∑ckë
, &
socksfd
);

949 
socksfd
.
°©e
.
¥Ÿocﬁ
.
udp
 = 1;

951 i‡(
socksfd
.
°©e
.
vîsi⁄
 =
PROXY_UPNP
)

952 
	`socksho°2sockaddr
(&
∑ckë
.
ªs
.
ho°
, &
socksfd
.
ªmŸe
);

954 
	`socksho°2sockaddr
(&
∑ckë
.
ªs
.
ho°
, &
socksfd
.
ª∂y
);

956 
Àn
 = (
socksfd
.
£rvî
);

957 i‡(
	`gë≥î«me
(
socksfd
.
c⁄åﬁ
, 
	`TOSA
(&socksfd.
£rvî
), &
Àn
) != 0) {

958 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

960 
socksfd
.
c⁄åﬁ
, 
	`°ªº‹
(
î∫o
));

962 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

963  
NULL
;

967 i‡(
shouldc⁄√˘
) {

968 
l°r
[
MAXSOCKADDRSTRING
], 
p°r
[(lstr)];

969 
rc
;

971 
socksfd
.
°©e
.
udpc⁄√˘
 = 1;

973 
socksfd
.
°©e
.
vîsi⁄
) {

974 
PROXY_SOCKS_V5
:

975 
	`Ákesockaddr2socksho°
(
to
, &
socksfd
.
f‹us
.
c⁄√˘ed
);

977 
rc
 = 
	`c⁄√˘
(
s
,

978 
	`TOSA
(&
socksfd
.
ª∂y
),

979 
	`ßÀn
(
socksfd
.
ª∂y
.
ss_Ámûy
));

981 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

983 
s
,

984 
	`sockaddr2°rög
(&
socksfd
.
loˇl
,

985 
l°r
,

986 (
l°r
)),

987 
	`¥oxy¥Ÿocﬁ2°rög
(
socksfd
.
°©e
.
vîsi⁄
),

988 
	`sockaddr2°rög
(&
socksfd
.
ª∂y
,

989 
p°r
,

990 (
p°r
)),

991 
rc
 == 0 ? "succeeded" : "failed",

992 
	`°ªº‹
(
î∫o
));

994 
	`¶og
(
rc
 =0 ? 
LOG_INFO
 : 
LOG_WARNING
, "%s: %s", 
fun˘i⁄
, 
emsg
);

996 i‡(
rc
 != 0) {

997 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

998  
NULL
;

1003 
PROXY_UPNP
:

1004 
rc
 = 
	`c⁄√˘
(
s
, 
	`TOCSA
(
to
), 
	`ßÀn
—o->
ss_Ámûy
));

1005 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1007 
s
,

1008 
	`sockaddr2°rög
(&
socksfd
.
loˇl
,

1009 
l°r
,

1010 (
l°r
)),

1011 
	`sockaddr2°rög
(
to
, 
p°r
, (pstr)),

1012 
rc
 == 0 ? "succeeded" : "failed",

1013 
	`°ªº‹
(
î∫o
));

1016 
	`¶og
(
rc
 =0 ? 
LOG_INFO
 : 
LOG_WARNING
, "%s: %s", 
fun˘i⁄
, 
emsg
);

1018 i‡(
rc
 != 0)

1019  
NULL
;

1024 
	`SERRX
(
socksfd
.
°©e
.
vîsi⁄
);

1029 i‡(
socksfd
.
°©e
.
vîsi⁄
 =
PROXY_UPNP
) {

1034 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

1035 
socksfd
.
c⁄åﬁ
 = 
s
;

1038 i‡(
	`socks_addaddr
(
s
, &
socksfd
, 1Ë=
NULL
) {

1039 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "socks_addaddr(ËÁûed: %s", 
	`°ªº‹
(
î∫o
));

1041 
	`˛o£
(
socksfd
.
c⁄åﬁ
);

1042  
NULL
;

1045  
socksfd
.
rouã
;

1046 
	}
}

	@lib/udp_util.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

50 
	$udphódî_add
(
ho°
, 
msg
, 
Àn
, 
msgsize
)

51 c⁄° 
socksho°_t
 *
ho°
;

52 *
msg
;

53 
size_t
 *
Àn
;

54 c⁄° 
size_t
 
msgsize
;

56 c⁄° *
fun˘i⁄
 = "udpheader_add()";

57 
udphódî_t
 
hódî
;

58 *
off£t
;

60 
	`bzîo
(&
hódî
, (header));

61 
hódî
.
ho°
 = *host;

63 i‡(
msgsize
 < (
size_t
)(*
Àn
 + 
	`HEADERSIZE_UDP
(&
hódî
))) {

64 
	`sw¨nx
("%s: couldÇotÖrefix socks udp header of size %luÅo udp "

66 
fun˘i⁄
,

67 ()
	`HEADERSIZE_UDP
(&
hódî
),

68 ()*
Àn
,

69 ()
msgsize
);

71 
î∫o
 = 
EMSGSIZE
;

72  
NULL
;

75 
	`¶og
(
LOG_DEBUG
,

77 
fun˘i⁄
,

78 
	`socksho°2°rög
(&
hódî
.
ho°
, 
NULL
, 0),

79 ()*
Àn
,

80 ()
msgsize
);

83 
	`memmove
((*)
msg
 + 
	`HEADERSIZE_UDP
(&
hódî
), msg, *
Àn
);

84 
off£t
 = 
msg
;

86 
	`mem˝y
(
off£t
, &
hódî
.
Êag
, (header.flag));

87 
off£t
 +(
hódî
.
Êag
);

89 
	`mem˝y
(
off£t
, &
hódî
.
‰ag
, (header.frag));

90 
off£t
 +(
hódî
.
‰ag
);

92 
off£t
 = 
	`socksho°2mem
(&
hódî
.
ho°
, off£t, 
PROXY_SOCKS_V5
);

93 
off£t
 +*
Àn
;

95 *
Àn
 = (*)
off£t
 - (*)
msg
;

97  
msg
;

98 
	}
}

	@lib/upnp.c

44 c⁄° 
	grcsid
[] =

47 
	~"comm⁄.h
"

49 
	~"u≤p.h
"

51 #i‡
HAVE_LIBMINIUPNP


53 #i‡
SOCKS_CLIENT


54 
siga˘i⁄
 
	gﬁdsig
;

55 
sigh™dÀr
(
sig
);

56 
©exô_u≤p˛ónup
();

62 
	$socks_öôu≤p
(
gw
, 
emsg
, 
emsgÀn
)

63 
g©eway_t
 *
gw
;

64 *
emsg
;

65 c⁄° 
size_t
 
emsgÀn
;

67 c⁄° *
fun˘i⁄
 = "socks_initupnp()";

68 #i‡
HAVE_LIBMINIUPNP


69 
UPNPDev
 *
dev
;

70 
UPNPUæs
 
uæ
;

71 
IGDd©as
 
d©a
;

72 
myaddr
[
INET_ADDRSTRLEN
], 
addr°rög
[
MAXSOCKSHOSTSTRING
], 
vbuf
[1024];

73 
devty≥
, 
rc
;

75 i‡(*
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
 !
NUL
) {

76 
	`¶og
(
LOG_DEBUG
, "%s:álready inited with controlurl %s",

77 
fun˘i⁄
,

78 
	`°r2vis
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
,

79 
	`°æí
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
),

80 
vbuf
,

81 (
vbuf
)));

86 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

88 
	`bzîo
(&
uæ
, (url));

89 
	`bzîo
(&
d©a
, (data));

90 
î∫o
 = 0;

92 i‡(
gw
->
addr
.
©y≥
 =
SOCKS_ADDR_URL
) {

93 
	`¶og
(
LOG_NEGOTIATE
, "%s:ÅryingÅo use UPNP IGDát %s",

94 
fun˘i⁄
, 
	`°r2vis
(
gw
->
addr
.addr.
uæ«me
,

95 
	`°æí
(
gw
->
addr
.addr.
uæ«me
),

96 
vbuf
,

97 (
vbuf
)));

99 i‡(
	`UPNP_GëIGDFromUæ
(
gw
->
addr
.addr.
uæ«me
,

100 &
uæ
,

101 &
d©a
,

102 
myaddr
,

103 (
myaddr
)) != 1) {

104 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "failedÅo contact UPNP IGDát url %s: %s",

105 
vbuf
, 
	`°ªº‹
(
î∫o
));

106 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

108 i‡(
î∫o
 == 0)

109 
î∫o
 = 
ENETUNREACH
;

114 
	`¶og
(
LOG_DEBUG
, "%s: UPNP_GetIGDFromUrl() url %s was successful",

115 
fun˘i⁄
, 
vbuf
);

117 
rc
 = 0;

120 
UPNPDev
 *
p
;

121 
sockaddr_°‹age
 
addr
;

122 
comm™d_t
 
comm™ds
;

123 
¥Ÿocﬁ_t
 
¥Ÿocﬁs
;

125 
	`¶og
(
LOG_NEGOTIATE
, "%s: searching for UPNP IGD usingáddress %s",

126 
fun˘i⁄
, 
	`socksho°2°rög
(&
gw
->
addr
, 
NULL
, 0));

128 
	`socksho°2sockaddr
(&
gw
->
addr
, &addr);

129 i‡(
	`öë_¡›
(
addr
.
ss_Ámûy
,

130 
	`GET_SOCKADDRADDR
(&
addr
),

131 
addr°rög
,

132 (
addr°rög
)Ë=
NULL
) {

133 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

135 
fun˘i⁄
,

136 
	`socksho°2°rög
(&
gw
->
addr
, 
NULL
, 0),

137 
	`°ªº‹
(
î∫o
));

139 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

143 
	`¶og
(
LOG_NEGOTIATE
,

146 
fun˘i⁄
, 
addr°rög
, 
	`socksho°2°rög
(&
gw
->
addr
, 
NULL
, 0), 
î∫o
);

148 #i‡
SOCKS_CLIENT
 && 
SOCKSLIBRARY_DYNAMIC


149 
	`socks_m¨k_io_as_«tive
();

152 
î∫o
 = 0;

153 
dev
 = 
	`u≤pDiscovî
(
UPNP_DISCOVERYTIME_MS
,

154 
addr°rög
,

155 
NULL
,

157 #i‡
HAVE_LIBMINIUPNP17


159 &
rc


163 #i‡
SOCKS_CLIENT
 && 
SOCKSLIBRARY_DYNAMIC


164 
	`socks_m¨k_io_as_n‹mÆ
();

167 i‡(
dev
 =
NULL
) {

168 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "u≤pDiscovî(ËÁûed: %s", 
	`°ªº‹
(
î∫o
));

169 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

171 i‡(
î∫o
 == 0)

172 
î∫o
 = 
ENETUNREACH
;

177 
	`¶og
(
LOG_NEGOTIATE
,

178 "%s: u≤∞devi˚†found. Addög dúe˘Ñouã†f‹Åhem", 
fun˘i⁄
);

180 
	`bzîo
(&
comm™ds
, (commands));

181 
	`bzîo
(&
¥Ÿocﬁs
, (protocols));

183 
p
 = 
dev
;Ö !
NULL
;Ö =Ö->
pNext
) {

184 
sockaddr_°‹age
 
ßddr
, 
smask
;

185 
gaõº
;

187 i‡(
	`uæ°rög2sockaddr
(
p
->
descURL
, &
ßddr
, &
gaõº
, 
emsg
, 
emsgÀn
)

188 =
NULL
) {

189 
	`log_ªsﬁveÁûed
(
p
->
descURL
, 
EXTERNALIF
, 
gaõº
);

193 
	`bzîo
(&
smask
, (smask));

194 
	`SET_SOCKADDR
(&
smask
, 
AF_INET
);

195 
	`TOIN
(&
smask
)->
sö_addr
.
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

197 
comm™ds
.
c⁄√˘
 = 1;

198 
comm™ds
.
ud∑ssocüã
 = 1;

200 
¥Ÿocﬁs
.
t˝
 = 1;

201 
¥Ÿocﬁs
.
udp
 = 1;

203 
	`socks_autﬂdd_dúe˘rouã
(&
comm™ds
, &
¥Ÿocﬁs
, &
ßddr
, &
smask
);

206 
devty≥
 = 
	`UPNP_GëVÆidIGD
(
dev
, &
uæ
, &
d©a
, 
myaddr
, (myaddr));

207 
devty≥
) {

208 
UPNP_NO_IGD
:

209 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "no UPNP IGD discovered onÜocalÇetwork");

210 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

211 
rc
 = -1;

214 
UPNP_CONNECTED_IGD
:

215 
	`¶og
(
LOG_NEGOTIATE
, "%s: UPNP IGD discoveredát url %s",

216 
fun˘i⁄
,

217 
	`°r2vis
(
uæ
.
c⁄åﬁURL
,

218 
	`°æí
(
uæ
.
c⁄åﬁURL
),

219 
vbuf
,

220 (
vbuf
)));

221 
rc
 = 0;

224 
UPNP_DISCONNECTED_IGD
:

225 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

227 
	`°r2vis
(
uæ
.
c⁄åﬁURL
,

228 
	`°æí
(
uæ
.
c⁄åﬁURL
),

229 
vbuf
,

230 (
vbuf
)));

232 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

233 
rc
 = -1;

236 
UPNP_UNKNOWN_DEVICE
:

237 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

239 
fun˘i⁄
,

240 
	`°r2vis
(
uæ
.
c⁄åﬁURL
,

241 
	`°æí
(
uæ
.
c⁄åﬁURL
),

242 
vbuf
,

243 (
vbuf
)));

245 
	`sw¨nx
("%s: %s", 
emsg
, 
fun˘i⁄
);

247 
rc
 = -1;

251 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

253 
fun˘i⁄
, 
devty≥
, 
	`°ªº‹
(
î∫o
));

255 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

256 
rc
 = -1;

259 
	`‰ìUPNPDevli°
(
dev
);

262 i‡(
rc
 == 0) {

263 
visbuf2
[(
vbuf
)];

265 
	`SASSERTX
(
uæ
.
c⁄åﬁURL
 !
NULL
);

266 
	`STRCPY_ASSERTLEN
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
, 
uæ
.
c⁄åﬁURL
);

268 #i‡
HAVE_LIBMINIUPNP13


269 
	`STRCPY_ASSERTLEN
(
gw
->
°©e
.
d©a
.
u≤p
.
£rvi˚ty≥
, data.servicetype);

271 #ñi‡
HAVE_LIBMINIUPNP14
 || 
HAVE_LIBMINIUPNP17


272 
	`STRCPY_ASSERTLEN
(
gw
->
°©e
.
d©a
.
u≤p
.
£rvi˚ty≥
, d©a.
CIF
.servicetype);

278 
	`¶og
(
LOG_NEGOTIATE
, "%s: inited ok. controlurl: %s, servicetype: %s",

279 
fun˘i⁄
,

280 
	`°r2vis
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
,

281 
	`°æí
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
),

282 
vbuf
,

283 (
vbuf
)),

284 
	`°r2vis
(
gw
->
°©e
.
d©a
.
u≤p
.
£rvi˚ty≥
,

285 
	`°æí
(
gw
->
°©e
.
d©a
.
u≤p
.
£rvi˚ty≥
),

286 
visbuf2
,

287 (
visbuf2
)));

290 i‡(
î∫o
 == 0)

291 
î∫o
 = 
ENETUNREACH
;

294 
	`FªeUPNPUæs
(&
uæ
);

296  
rc
;

302 
	}
}

305 
	$u≤p_√gŸüã
(
s
, 
∑ckë
, 
gw
, 
emsg
, 
emsgÀn
)

306 c⁄° 
s
;

307 
socks_t
 *
∑ckë
;

308 
g©eway_t
 *
gw
;

309 *
emsg
;

310 c⁄° 
size_t
 
emsgÀn
;

312 c⁄° *
fun˘i⁄
 = "upnp_negotiate()";

313 #i‡
HAVE_LIBMINIUPNP


314 
sockaddr_°‹age
 
addr
;

315 
sockÀn_t
 
addæí
;

316 
°øddr
[
INET6_ADDRSTRLEN
], 
°Ω‹t
[("65535")], 
vbuf
[1024];

317 
rc
;

320 
	`¶og
(
LOG_DEBUG
, "%s: command %s",

321 
fun˘i⁄
, 
	`comm™d2°rög
(
∑ckë
->
ªq
.
comm™d
));

323 #i‡!
HAVE_LIBMINIUPNP


324 
	`SERRX
(0);

327 
∑ckë
->
ªs
.
vîsi⁄
 = 
PROXY_UPNP
;

329 
∑ckë
->
ªq
.
comm™d
) {

330 
SOCKS_CONNECT
: {

345 i‡(
	`socks_c⁄√˘ho°
(
s
,

346 #i‡!
SOCKS_CLIENT


347 
EXTERNALIF
,

349 &
∑ckë
->
ªq
.
ho°
,

350 
NULL
,

351 
NULL
,

352 
sockscf
.
timeout
.
c⁄√˘


353 ? ()
sockscf
.
timeout
.
c⁄√˘
 : ()-1,

354 
emsg
,

355 
emsgÀn
) != 0)

356 i‡(
î∫o
 !
EINPROGRESS
) {

357 
	`¶og
(
LOG_NEGOTIATE
, "%s: socks_connecthost(%s) failed: %s",

358 
fun˘i⁄
,

359 
	`socksho°2°rög
(&
∑ckë
->
ªq
.
ho°
, 
NULL
, 0),

360 
emsg
);

362 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
,

363 
	`î∫o2ª∂y
(
î∫o
, 
PROXY_UPNP
));

370 
SOCKS_UDPASSOCIATE
: {

380 c⁄° 
î∫o_s
 = 
î∫o
;

382 
∑ckë
->
ªs
.
ho°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

384 #i‡
SOCKS_CLIENT


389 
	`¶og
(
LOG_NEGOTIATE
,

392 
fun˘i⁄
, 
	`socksho°2°rög
(&
gw
->
addr
, 
NULL
, 0));

394 
∑ckë
->
ªs
.
ho°
.
addr
.
ùv4
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

397 i‡(
	`socks_öôu≤p
(
gw
, 
emsg
, 
emsgÀn
) != 0) {

398 
	`sw¨nx
("%s: socks_initupnp() couldÇot init upnp state: %s",

399 
fun˘i⁄
, 
emsg
);

401 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

405 i‡((
rc
 = 
	`UPNP_GëExã∫ÆIPAddªss
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
,

406 
gw
->
°©e
.
d©a
.
u≤p
.
£rvi˚ty≥
,

407 
°øddr
)Ë!
UPNPCOMMAND_SUCCESS
) {

408 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

411 
	`°r2vis
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
,

412 
	`°æí
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
),

413 
vbuf
,

414 (
vbuf
)),

415 
rc
);

417 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

419 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

423 
	`¶og
(
LOG_NEGOTIATE
, "%s: server will useáddress %s on our behalf",

424 
fun˘i⁄
,

425 
	`°r2vis
(
°øddr
, 
	`°æí
(°øddr), 
vbuf
, (vbuf)));

427 i‡(
	`socks_öë_±⁄
(
AF_INET
,

428 
°øddr
,

429 &
∑ckë
->
ªs
.
ho°
.
addr
.
ùv4
,

430 
NULL
) == 1)

431 
∑ckë
->
ªs
.
ho°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

432 i‡(
	`socks_öë_±⁄
(
AF_INET6
,

433 
°øddr
,

434 &
∑ckë
->
ªs
.
ho°
.
addr
.
ùv6
,

435 
NULL
) == 1)

436 
∑ckë
->
ªs
.
ho°
.
©y≥
 = 
SOCKS_ADDR_IPV6
;

438 
	`¶og
(
LOG_NOTICE
,

440 
fun˘i⁄
,

441 
	`°r2vis
(
°øddr
,

442 
	`°æí
(
°øddr
),

443 
vbuf
,

444 (
vbuf
)),

445 
	`°ªº‹
(
î∫o
));

448 
addæí
 = (
addr
);

449 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
addr
), &
addæí
) != 0) {

450 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

451 "gësock«me(sË⁄ sockë faûed: %s", 
	`°ªº‹
(
î∫o
));

456 
	`¶og
(
LOG_NEGOTIATE
,

459 
fun˘i⁄
, 
	`¡ohs
(
∑ckë
->
ªs
.
ho°
.
p‹t
));

461 
∑ckë
->
ªs
.
ho°
.
p‹t
 = 
	`GET_SOCKADDRPORT
(&
addr
);

462 
î∫o
 = 
î∫o_s
;

467 
SOCKS_BIND
: {

474 #i‡
SOCKS_CLIENT


475 
©exô_ªgi°îed
;

477 c⁄° 
î∫ovÆ
 = 
EADDRNOTAVAIL
;

478 
sockaddr_°‹age
 
exèddr
;

479 
sockÀn_t
 
Àn
;

480 
buf
[256], 
¥Ÿocﬁ
[16];

481 
vÆ
;

483 
addæí
 = (
addr
);

484 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
addr
), &
addæí
) != 0) {

485 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

486 "gësock«me(sË⁄ sockë faûed: %s", 
	`°ªº‹
(
î∫o
));

488 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

492 i‡(!
	`PORTISBOUND
(&
addr
)) {

493 
	`¶og
(
LOG_NEGOTIATE
,

496 
fun˘i⁄
);

498 i‡(
	`socks_böd
(
s
, &
addr
, 0) != 0) {

499 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

502 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0), 
s
, 
	`°ªº‹
(
î∫o
));

504 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

506 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

511 i‡(
	`socks_öôu≤p
(
gw
, 
emsg
, 
emsgÀn
) != 0) {

512 
	`sw¨nx
("%s: socks_initupnp() couldÇot init upnp state: %s",

513 
fun˘i⁄
, 
emsg
);

515 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

517 
î∫o
 = 
î∫ovÆ
;

521 i‡((
rc
 = 
	`UPNP_GëExã∫ÆIPAddªss
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
,

522 
gw
->
°©e
.
d©a
.
u≤p
.
£rvi˚ty≥
,

523 
°øddr
)Ë!
UPNPCOMMAND_SUCCESS
) {

524 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

527 
rc
);

529 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

531 
î∫o
 = 
î∫ovÆ
;

535 
exèddr
 = 
addr
;

537 i‡((
rc
 = 
	`socks_öë_±⁄
(
exèddr
.
ss_Ámûy
,

538 
°øddr
,

539 (*)
	`GET_SOCKADDRADDR
(&
exèddr
),

540 
NULL
)) != 1) {

541 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

545 
	`ßÁmûy2°rög
(
exèddr
.
ss_Ámûy
),

546 
	`°r2vis
(
°øddr
, 
	`°æí
(°øddr), 
vbuf
, (vbuf)),

547 
rc
,

548 
	`°ªº‹
(
î∫o
));

550 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

552 
î∫o
 = 
î∫ovÆ
;

556 
	`sockaddr2socksho°
(&
exèddr
, &
∑ckë
->
ªs
.
ho°
);

558 
	`¶og
(
LOG_NEGOTIATE
,

560 
fun˘i⁄
,

561 
	`°r2vis
(
°øddr
, 
	`°æí
(°øddr), 
vbuf
, (vbuf)));

563 i‡(!
	`ADDRISBOUND
(&
addr
)) {

569 
sockaddr_°‹age
 
tm∑ddr
;

571 
∑ckë
->
gw
.
addr
.
©y≥
) {

572 
SOCKS_ADDR_IFNAME
: {

573 
sockaddr_°‹age
 
mask
;

575 i‡(
	`i‚ame2sockaddr
(
∑ckë
->
gw
.
addr
.addr.
i‚ame
,

577 &
tm∑ddr
,

578 &
mask
Ë=
NULL
) {

579 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

582 
∑ckë
->
gw
.
addr
.addr.
i‚ame
);

583 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

585 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

587 
î∫o
 = 
î∫ovÆ
;

592 
	`SET_SOCKADDRADDR
((&
addr
), 
	`GET_SOCKADDRADDR
(&
tm∑ddr
));

596 
SOCKS_ADDR_URL
: {

597 
sockÀn_t
 
tm∑ddæí
;

598 
Àmsg
[256] ;

599 
ss
, 
gaõº
;

601 i‡(
	`uæ°rög2sockaddr
(
∑ckë
->
gw
.
addr
.addr.
uæ«me
,

602 &
tm∑ddr
,

603 &
gaõº
,

604 
Àmsg
,

605 (
Àmsg
)Ë=
NULL
) {

607 
	`log_ªsﬁveÁûed
(
∑ckë
->
gw
.
addr
.addr.
uæ«me
,

608 
EXTERNALIF
,

609 
gaõº
);

611 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

613 
	`°r2vis
(
∑ckë
->
gw
.
addr
.addr.
uæ«me
,

614 
	`°æí
(
∑ckë
->
gw
.
addr
.addr.
uæ«me
),

615 
vbuf
,

616 (
vbuf
)),

618 
Àmsg
);

620 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

622 
î∫o
 = 
î∫ovÆ
;

635 i‡((
ss
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0)) == -1) {

636 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "socket() failed: %s",

637 
	`°ªº‹
(
î∫o
));

638 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

640 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

644 i‡(
	`c⁄√˘
(
ss
, 
	`TOSA
(&
tm∑ddr
), 
	`ßÀn
—m∑ddr.
ss_Ámûy
))

646 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

648 
	`sockaddr2°rög
(&
tm∑ddr
, 
NULL
, 0),

649 
	`°ªº‹
(
î∫o
));

650 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

652 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

653 
	`˛o£
(
ss
);

656 
î∫o
 = 
î∫ovÆ
;

660 
tm∑ddæí
 = (
tm∑ddr
);

661 i‡(
	`gësock«me
(
ss
, 
	`TOSA
(&
tm∑ddr
), &
tm∑ddæí
) != 0) {

662 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

663 "gësock«me(ssËÁûed: %s", 
	`°ªº‹
(
î∫o
));

665 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

666 
	`˛o£
(
ss
);

669 
î∫o
 = 
î∫ovÆ
;

673 
	`˛o£
(
ss
);

674 
	`SET_SOCKADDRADDR
((&
addr
), 
	`GET_SOCKADDRADDR
(&
tm∑ddr
));

680 
	`SERRX
(
∑ckë
->
gw
.
addr
.
©y≥
);

684 i‡(
	`öë_¡›
(
addr
.
ss_Ámûy
,

685 
	`GET_SOCKADDRADDR
(&
addr
),

686 
°øddr
,

687 (
°øddr
)Ë=
NULL
) {

688 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

690 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0), 
	`°ªº‹
(
î∫o
));

692 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

694 
î∫o
 = 
î∫ovÆ
;

698 
Àn
 = (
vÆ
);

699 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_TYPE
, &
vÆ
, &
Àn
) != 0) {

700 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

701 "gësock›t(sËÁûed: %s", 
	`°ªº‹
(
î∫o
));

702 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

706 
vÆ
) {

707 
SOCK_DGRAM
:

708 
	`¢¥ötf
(
¥Ÿocﬁ
, ’rŸocﬁ), 
PROTOCOL_UDPs
);

711 
SOCK_STREAM
:

712 
	`¢¥ötf
(
¥Ÿocﬁ
, ’rŸocﬁ), 
PROTOCOL_TCPs
);

716 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "unknow¿¥ŸocﬁÅy≥ %d", 
vÆ
);

717 
	`sw¨nx
("%s: fd %d (sockë s): %s", 
fun˘i⁄
, 
s
, 
emsg
);

719 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

721 
î∫o
 = 
î∫ovÆ
;

725 
	`¢¥ötf
(
°Ω‹t
, (strport),

726 "%d", 
	`¡ohs
(
	`GET_SOCKADDRPORT
(&
addr
)));

728 
	`¢¥ötf
(
buf
, (buf), "%s (%s/client v%s viaÜibminiupnpc)",

729 
__¥og«me
, 
PRODUCT
, 
VERSION
);

731 
	`¶og
(
LOG_NEGOTIATE
,

734 
fun˘i⁄
,

735 
¥Ÿocﬁ
,

736 
s
,

737 
	`°r2vis
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
,

738 
	`°æí
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
),

739 
vbuf
,

740 (
vbuf
)),

741 
°Ω‹t
,

742 
	`°r2vis
(
°øddr
, 
	`°æí
(°øddr), 
vbuf
, (vbuf)),

743 
°Ω‹t
);

745 
	`°r2uµî
(
¥Ÿocﬁ
);

746 i‡((
rc
 = 
	`UPNP_AddP‹tM≠pög
(
gw
->
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
,

747 
gw
->
°©e
.
d©a
.
u≤p
.
£rvi˚ty≥
,

748 
°Ω‹t
,

749 
°Ω‹t
,

750 
°øddr
,

751 
buf
,

752 
¥Ÿocﬁ
,

753 
NULL


754 #i‡
HAVE_LIBMINIUPNP17


757 )Ë!
UPNPCOMMAND_SUCCESS
) {

758 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

759 "UPNP_AddP‹tM≠pög(ËÁûed: %s", 
	`°ru≤≥º‹
(
rc
));

761 
	`¶og
(
LOG_NEGOTIATE
, "%s: %s", 
fun˘i⁄
, 
emsg
);

763 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_FAILURE
);

765 
î∫o
 = 
î∫ovÆ
;

769 
	`¶og
(
LOG_NEGOTIATE
,

770 "%s:áddôi⁄ o‡p‹àm≠pög suc˚eded", 
fun˘i⁄
);

772 #i‡
SOCKS_CLIENT


773 i‡(!
©exô_ªgi°îed
) {

774 
siga˘i⁄
 
oursig
;

775 
size_t
 
i
;

776 
sig«lv
[] = { 
SIGINT
 };

778 
	`¶og
(
LOG_DEBUG
, "%s:Ñegistering cleanup function withátexit(3)",

779 
fun˘i⁄
);

781 i‡(
	`©exô
(
©exô_u≤p˛ónup
) != 0) {

782 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

784 
	`°ªº‹
(
î∫o
));

785 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

789 
©exô_ªgi°îed
 = 1;

791 
i
 = 0; i < 
	`ELEMENTS
(
sig«lv
); ++i) {

792 i‡(
	`siga˘i⁄
(
sig«lv
[
i
], 
NULL
, &
ﬁdsig
) != 0) {

793 
	`sw¨n
("%s: siga˘i⁄(%d)", 
fun˘i⁄
, 
sig«lv
[
i
]);

797 
oursig
 = 
ﬁdsig
;

798 
oursig
.
ß_h™dÀr
 = 
sigh™dÀr
;

799 
oursig
.
ß_Êags
 |
SA_SIGINFO
;

801 i‡(
	`siga˘i⁄
(
sig«lv
[
i
], &
oursig
, 
NULL
) != 0) {

802 
	`sw¨n
("%s: siga˘i⁄(%d)", 
fun˘i⁄
, 
sig«lv
[
i
]);

812 
	`SERRX
(
∑ckë
->
ªq
.
comm™d
);

815 
	`socks_£t_ª•⁄£vÆue
(&
∑ckë
->
ªs
, 
UPNP_SUCCESS
);

820 
	}
}

822 #i‡
HAVE_LIBMINIUPNP


824 #i‡
SOCKS_CLIENT


826 
	$sigh™dÀr
(
sig
)

827 
sig
;

829 c⁄° *
fun˘i⁄
 = "sighandler()";

831 
	`¶og
(
LOG_DEBUG
, 
fun˘i⁄
);

832 
	`u≤p˛ónup
(-1);

835 i‡(
	`siga˘i⁄
(
SIGINT
, &
ﬁdsig
, 
NULL
) != 0)

836 
	`£º
("%s:Ñe°‹ög old sig«»h™dÀ∏Áûed", 
fun˘i⁄
);

838 
	`øi£
(
SIGINT
);

839 
	}
}

842 #i‡
SOCKS_CLIENT


844 
	$u≤p˛ónup
(
s
)

845 c⁄° 
s
;

847 c⁄° *
fun˘i⁄
 = "upnpcleanup()";

848 
socksfd_t
 
socksfd
;

849 
rc
, 
cuºít
, 
œ°
;

851 
	`¶og
(
LOG_DEBUG
, "%s: fd %d", 
fun˘i⁄
, 
s
);

853 i‡(
s
 == -1) {

854 
cuºít
 = 0;

855 
œ°
 = 
	`gëmaxofûes
(
so·limô
) - 1;

858 
cuºít
 = 
s
;

859 
œ°
 = 
s
;

862 ; 
cuºít
 <
œ°
; ++current) {

863 
dñëög
;

864 
p‹t
[("65535")], 
¥Ÿocﬁ
[("TCP")];

866 i‡(
dñëög
 =
cuºít
)

869 i‡(
	`socks_gëaddr
(
cuºít
, &
socksfd
, 0 ) =
NULL
)

872 i‡(
socksfd
.
°©e
.
vîsi⁄
 !
PROXY_UPNP
)

875 
	`¶og
(
LOG_NEGOTIATE
,

878 
fun˘i⁄
,

879 
cuºít
,

880 
	`comm™d2°rög
(
socksfd
.
°©e
.
comm™d
),

881 
socksfd
.
°©e
.
ac˚±≥ndög
 ? "yes" : "no");

883 i‡(
socksfd
.
°©e
.
comm™d
 !
SOCKS_BIND
)

890 i‡(!
socksfd
.
°©e
.
ac˚±≥ndög
)

893 
	`¢¥ötf
(
p‹t
, (port),

894 "%d", 
	`¡ohs
(
	`GET_SOCKADDRPORT
(&
socksfd
.
ªmŸe
)));

896 i‡(
socksfd
.
°©e
.
¥Ÿocﬁ
.
t˝
)

897 
	`¢¥ötf
(
¥Ÿocﬁ
, ’rŸocﬁ), 
PROTOCOL_TCPs
);

898 i‡(
socksfd
.
°©e
.
¥Ÿocﬁ
.
udp
)

899 
	`¢¥ötf
(
¥Ÿocﬁ
, ’rŸocﬁ), 
PROTOCOL_UDPs
);

901 
	`SWARNX
(0);

905 
	`¶og
(
LOG_NEGOTIATE
, "%s: deletingÖort mapping forÉxternal %sÖort %s",

906 
fun˘i⁄
, 
¥Ÿocﬁ
, 
p‹t
);

908 
	`°r2uµî
(
¥Ÿocﬁ
);

915 
dñëög
 = 
cuºít
;

917 
rc
 = 
	`UPNP_DñëeP‹tM≠pög
(
socksfd
.
rouã
->
gw
.
°©e
.
d©a
.
u≤p
.
c⁄åﬁuæ
,

918 
socksfd
.
rouã
->
gw
.
°©e
.
d©a
.
u≤p
.
£rvi˚ty≥
,

919 
p‹t
,

920 
¥Ÿocﬁ
,

921 
NULL
);

923 i‡(
rc
 !
UPNPCOMMAND_SUCCESS
)

924 
	`sw¨nx
("%s: UPNP_DeletePortMapping(%s, %s) failed: %s",

925 
fun˘i⁄
, 
p‹t
, 
¥Ÿocﬁ
, 
	`°ru≤≥º‹
(
rc
));

927 
	`¶og
(
LOG_NEGOTIATE
, "%s: deletedÖort mapping forÉxternal %sÖort %s",

928 
fun˘i⁄
, 
¥Ÿocﬁ
, 
p‹t
);

930 
dñëög
 = -1;

932 
	}
}

935 
	$©exô_u≤p˛ónup
()

937 c⁄° *
fun˘i⁄
 = "atexit_upnpcleanup()";

939 
	`¶og
(
LOG_DEBUG
, 
fun˘i⁄
);

940 
	`u≤p˛ónup
(-1);

941 
	}
}

945 
	$u≤p˛ónup
(
s
)

946 c⁄° 
s
;

949 
	}
}

	@lib/userio.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

51 
	$socks_gëu£∫ame
(
ho°
, 
buf
, 
buÊí
)

52 c⁄° 
socksho°_t
 *
ho°
;

53 *
buf
;

54 
size_t
 
buÊí
;

56 c⁄° *
fun˘i⁄
 = "socks_getusername()";

57 *
«me
;

59 i‡((
«me
 = 
	`socks_gëív
(
ENV_SOCKS_USERNAME
, 
d⁄tˇª
)Ë!
NULL


60 || (
«me
 = 
	`socks_gëív
(
ENV_SOCKS_USER
, 
d⁄tˇª
)Ë!
NULL


61 || (
«me
 = 
	`socks_gëív
(
ENV_SOCKS5_USER
, 
d⁄tˇª
)Ë!
NULL
)

62 
	`¶og
(
LOG_NEGOTIATE
,

63 "%s: usög sock†u£∫amê‰omÉnvú⁄mít: \"%s\"", 
fun˘i⁄
, 
«me
);

64 #i‡
SOCKS_CLIENT


66 
∑sswd
 *
pw
;

68 i‡((
pw
 = 
	`gëpwuid
(
	`gëuid
())Ë!
NULL
)

69 
«me
 = 
pw
->
pw_«me
;

71 
«me
 = 
	`gëlogö
();

75 i‡(
«me
 =
NULL
)

76  
NULL
;

78 i‡(
	`°æí
(
«me
Ë>
buÊí
) {

79 
	`sw¨nx
("%s: socks username %lu charactersÅooÜong,Åruncated",

80 
fun˘i⁄
, ()((
	`°æí
(
«me
Ë+ 1Ë- 
buÊí
));

81 
«me
[
buÊí
 - 1] = 
NUL
;

84 
	`°r˝y
(
buf
, 
«me
);

85  
buf
;

86 
	}
}

89 
	$socks_gë∑ssw‹d
(
ho°
, 
u£r
, 
buf
, 
buÊí
)

90 c⁄° 
socksho°_t
 *
ho°
;

91 c⁄° *
u£r
;

92 *
buf
;

93 
size_t
 
buÊí
;

95 c⁄° *
fun˘i⁄
 = "socks_getpassword()";

96 *
∑ssw‹d
;

97 
∑ssw‹d_is_‰om_ív
;

99 i‡((
∑ssw‹d
 = 
	`socks_gëív
(
ENV_SOCKS_PASSWORD
, 
d⁄tˇª
)Ë!
NULL


100 || (
∑ssw‹d
 = 
	`socks_gëív
(
ENV_SOCKS_PASSWD
, 
d⁄tˇª
)Ë!
NULL


101 || (
∑ssw‹d
 = 
	`socks_gëív
(
ENV_SOCKS5_PASSWD
, 
d⁄tˇª
)Ë!
NULL
)

102 
∑ssw‹d_is_‰om_ív
 = 1;

104 #i‡
SOCKS_CLIENT
 && 
HAVE_GETPASS


105 
¥om±
[256 + 
MAXSOCKSHOSTSTRING
];

106 
h°rög
[
MAXSOCKSHOSTSTRING
];

108 
	`¢¥ötf
(
¥om±
, (prompt), "%s@%s socksÖassword: ",

109 
u£r
, 
	`socksho°2°rög
(
ho°
, 
h°rög
, (hstring)));

111 
∑ssw‹d
 = 
	`gë∑ss
(
¥om±
);

115 
∑ssw‹d
 = 
NULL
;

118 
∑ssw‹d_is_‰om_ív
 = 0;

121 i‡(
∑ssw‹d
 =
NULL
)

122  
NULL
;

124 i‡(
	`°æí
(
∑ssw‹d
Ë>
buÊí
) {

125 
	`sw¨nx
("%s: socksÖassword is %lu charactersÅooÜong;Åruncated",

126 
fun˘i⁄
, ()((
	`°æí
(
∑ssw‹d
Ë+ 1Ë- 
buÊí
));

128 
∑ssw‹d
[
buÊí
 - 1] = 
NUL
;

131 
	`°r˝y
(
buf
, 
∑ssw‹d
);

133 i‡(!
∑ssw‹d_is_‰om_ív
)

134 
	`bzîo
(
∑ssw‹d
, 
	`°æí
(password));

136  
buf
;

137 
	}
}

140 
	$socks_gëív
(
«me
, 
vÆue
)

141 c⁄° *
«me
;

142 
vÆue_t
 
vÆue
;

144 *
p
 = 
NULL
;

146 #i‡
SOCKS_CLIENT


147 #i‡
HAVE_CONFENV_DISABLE


148 c⁄° *
ß„«mes
[] = { 
ENV_SOCKS_BINDLOCALONLY
,

149 
ENV_SOCKS_DEBUG
,

150 
ENV_SOCKS_DISABLE_THREADLOCK
,

151 
ENV_SOCKS_DIRECTROUTE_FALLBACK
,

152 
ENV_SOCKS_PASSWORD
,

153 
ENV_SOCKS_PASSWD
,

154 
ENV_SOCKS5_PASSWD
,

155 
ENV_SOCKS_USERNAME
,

156 
ENV_SOCKS_USER
,

157 
ENV_SOCKS5_USER
,

159 
size_t
 
i
;

162 i‡(
	`°rcmp
(
«me
, 
ENV_SOCKS_CONF
) == 0

163 || 
	`°rcmp
(
«me
, 
ENV_SOCKS_LOGOUTPUT
) == 0

164 || 
	`°rcmp
(
«me
, 
ENV_SOCKS_ERRLOGOUTPUT
) == 0

165 || 
	`°rcmp
(
«me
, 
ENV_TMPDIR
) == 0) {

171 i‡(
	`is£tugid
())

172  
NULL
;

174  
	`gëív
(
«me
);

177 #i‡
HAVE_CONFENV_DISABLE


181 
i
 = 0; i < 
	`ELEMENTS
(
ß„«mes
); ++i)

182 i‡(
	`°rcmp
(
«me
, 
ß„«mes
[
i
]) == 0) {

183 
p
 = 
	`gëív
(
«me
);

188 
p
 = 
	`gëív
(
«me
);

192 
p
 = 
	`gëív
(
«me
);

195 i‡(
p
 =
NULL
 || 
vÆue
 =
d⁄tˇª
) {

199 i‡(
	`°rcmp
(
«me
, 
ENV_SOCKS_DIRECTROUTE_FALLBACK
) == 0)

200 
p
 = (
SOCKS_DIRECTROUTE_FALLBACK
 ? "yes" : "no");

202  
p
;

205 
vÆue
) {

206 
i°rue
:

207 i‡(
	`°rˇ£cmp
(
p
, "yes") == 0

208 || 
	`°rˇ£cmp
(
p
, "true") == 0

209 || 
	`°rˇ£cmp
(
p
, "1") == 0)

210  
p
;

211  
NULL
;

213 
isÁl£
:

214 i‡(
	`°rˇ£cmp
(
p
, "no") == 0

215 || 
	`°rˇ£cmp
(
p
, "false") == 0

216 || 
	`°rˇ£cmp
(
p
, "0") == 0)

217  
p
;

218  
NULL
;

221 
	`SERRX
(
vÆue
);

225 
	}
}

	@lib/util.c

45 
	~"comm⁄.h
"

47 
	~"vis_com∑t.h
"

49 c⁄° 
	grcsid
[] =

53 
	$°rcheck
(
°rög
)

54 c⁄° *
°rög
;

56  
°rög
 =
NULL
 ? 
NOMEM
 : string;

57 
	}
}

60 
	$sockscode
(
vîsi⁄
, 
code
)

61 c⁄° 
vîsi⁄
;

62 c⁄° 
code
;

65 
	`SASSERTX
(
code
 >= 0);

67 
vîsi⁄
) {

68 
PROXY_SOCKS_V4
:

69 
PROXY_SOCKS_V4REPLY_VERSION
:

70 
code
) {

71 
SOCKS_SUCCESS
:

72  
SOCKSV4_SUCCESS
;

75  
SOCKSV4_FAIL
;

79 
PROXY_SOCKS_V5
:

80  ()
code
;

82 
PROXY_HTTP_10
:

83 
PROXY_HTTP_11
:

84 
code
) {

85 
SOCKS_SUCCESS
:

86  
HTTP_SUCCESS
;

88 
SOCKS_FAILURE
:

89  
HTTP_FAILURE
;

91 
SOCKS_NOTALLOWED
:

92  
HTTP_NOTALLOWED
;

94 
SOCKS_NETUNREACH
:

95 
SOCKS_HOSTUNREACH
:

96 
SOCKS_CONNREFUSED
:

97  
HTTP_HOSTUNREACH
;

100  
HTTP_FAILURE
;

104 
PROXY_UPNP
:

105 
code
) {

106 
SOCKS_SUCCESS
:

107  
UPNP_SUCCESS
;

109 
SOCKS_FAILURE
:

110  
UPNP_FAILURE
;

113  
UPNP_FAILURE
;

119 
	`SERRX
(
vîsi⁄
);

123 
	}
}

126 
	$î∫o2ª∂y
(
î∫um
, 
vîsi⁄
)

127 
î∫um
;

128 
vîsi⁄
;

131 
î∫um
) {

132 
ENETDOWN
:

133 
ENETUNREACH
:

134  
	`sockscode
(
vîsi⁄
, 
SOCKS_NETUNREACH
);

136 
EHOSTDOWN
:

137 
EHOSTUNREACH
:

138  
	`sockscode
(
vîsi⁄
, 
SOCKS_HOSTUNREACH
);

140 
ECONNREFUSED
:

141 
ECONNRESET
:

142  
	`sockscode
(
vîsi⁄
, 
SOCKS_CONNREFUSED
);

144 
ETIMEDOUT
:

145  
	`sockscode
(
vîsi⁄
, 
SOCKS_TTLEXPIRED
);

148  
	`sockscode
(
vîsi⁄
, 
SOCKS_FAILURE
);

149 
	}
}

151 
sockaddr_°‹age
 *

152 
	$öt_socksho°2sockaddr2
(
ho°
, 
addr
, 
addæí
, 
gaõº
, 
emsg
, 
emsgÀn
)

153 c⁄° 
socksho°_t
 *
ho°
;

154 
sockaddr_°‹age
 *
addr
;

155 
size_t
 
addæí
;

156 *
gaõº
;

157 *
emsg
;

158 
size_t
 
emsgÀn
;

160 c⁄° *
fun˘i⁄
 = "int_sockshost2sockaddr2()";

161 
emsgmem
[1024 + 
MAXHOSTNAMELEN
 * 4];

163 i‡(
emsg
 =
NULL
 || 
emsgÀn
 == 0) {

164 
emsg
 = 
emsgmem
;

165 
emsgÀn
 = (
emsgmem
);

168 *
emsg
 = 
NUL
;

169 *
gaõº
 = 0;

171 i‡(
addr
 =
NULL
) {

172 
sockaddr_°‹age
 
addrmem
;

174 
addr
 = &
addrmem
;

175 
addæí
 = (
addrmem
);

178 
	`bzîo
(
addr
, 
addæí
);

180 
ho°
->
©y≥
) {

181 
SOCKS_ADDR_IPV4
:

182 
SOCKS_ADDR_IPV6
: {

183 
sockaddr_°‹age
 
ss
;

185 
	`bzîo
(&
ss
, (ss));

187 i‡(
ho°
->
©y≥
 =
SOCKS_ADDR_IPV4
) {

188 
	`SET_SOCKADDR
(&
ss
, 
AF_INET
);

189 
	`TOIN
(&
ss
)->
sö_addr
 = 
ho°
->
addr
.
ùv4
;

192 
	`SET_SOCKADDR
(&
ss
, 
AF_INET6
);

193 
	`TOIN6
(&
ss
)->
sö6_addr
 = 
ho°
->
addr
.
ùv6
.
ù
;

194 
	`TOIN6
(&
ss
)->
sö6_sc›e_id
 = 
ho°
->
addr
.
ùv6
.
sc›eid
;

197 
	`sockaddr˝y
(
addr
, &
ss
, 
	`ßÀn
(ss.
ss_Ámûy
));

198 
	`SET_SOCKADDRPORT
(
addr
, 
ho°
->
p‹t
);

202 
SOCKS_ADDR_DOMAIN
: {

203 
addröfo
 
höts
, *
ªs
;

204 
dnsöfo_t
 
ªsmem
;

206 
	`bzîo
(&
höts
, (hints));

208 
	`£t_höts_ai_Ámûy
(&
höts
.
ai_Ámûy
);

210 *
gaõº
 = 
	`cgëaddröfo
(
ho°
->
addr
.
domaö
, 
NULL
, &
höts
, &
ªs
, &
ªsmem
);

212 i‡(*
gaõº
 == 0) {

213 i‡(
ªs
->
ai_addæí
 <
addæí
) {

214 
	`sockaddr˝y
(
addr
, 
	`TOSS
(
ªs
->
ai_addr
), 
addæí
);

215 
	`SET_SOCKADDRPORT
(
addr
, 
ho°
->
p‹t
);

218 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

221 ()
ªs
->
ai_addæí
,

222 ()
addæí
);

224 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

225 
addr
->
ss_Ámûy
 = 
AF_UNSPEC
;

229 
visbuf
[
MAXHOSTNAMELEN
 * 4];

231 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

233 
	`°r2vis
(
ho°
->
addr
.
domaö
,

234 
	`°æí
(
ho°
->
addr
.
domaö
),

235 
visbuf
,

236 (
visbuf
)),

237 
	`gai_°ªº‹
(*
gaõº
));

239 
	`¶og
(
LOG_NEGOTIATE
, "%s: %s", 
fun˘i⁄
, 
emsg
);

240 
addr
->
ss_Ámûy
 = 
AF_UNSPEC
;

246 
SOCKS_ADDR_IFNAME
: {

247 
sockaddr_°‹age
 
a
, 
m
;

249 i‡(
	`i‚ame2sockaddr
(
ho°
->
addr
.
i‚ame
, 0, &
a
, &
m
Ë!
NULL
) {

250 
	`sockaddr˝y
(
addr
, &
a
, 
addæí
);

251 
	`SET_SOCKADDRPORT
(
addr
, 
ho°
->
p‹t
);

254 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

256 
	`socksho°2°rög2
(
ho°
, 
ADDRINFO_ATYPE
, 
NULL
, 0));

258 
	`¶og
(
LOG_NEGOTIATE
, "%s: %s", 
fun˘i⁄
, 
emsg
);

260 
addr
->
ss_Ámûy
 = 
AF_UNSPEC
;

266 
SOCKS_ADDR_URL
:

267 
	`uæ°rög2sockaddr
(
ho°
->
addr
.
uæ«me
,áddr, 
gaõº
, 
emsg
, 
emsgÀn
);

271 
	`SERRX
(
ho°
->
©y≥
);

274 
	`SASSERTX
(
addr
->
ss_Ámûy
 =
AF_UNSPEC


275 || 
addr
->
ss_Ámûy
 =
AF_INET


276 || 
addr
->
ss_Ámûy
 =
AF_INET6
);

278  
addr
;

279 
	}
}

281 
sockaddr_°‹age
 *

282 
	$öt_socksho°2sockaddr
(
ho°
, 
addr
, 
addæí
)

283 c⁄° 
socksho°_t
 *
ho°
;

284 
sockaddr_°‹age
 *
addr
;

285 
size_t
 
addæí
;

287 
p
;

289  
	`öt_socksho°2sockaddr2
(
ho°
, 
addr
, 
addæí
, &
p
, 
NULL
, 0);

290 
	}
}

293 
socksho°_t
 *

294 
	$sockaddr2socksho°
(
addr
, 
ho°
)

295 c⁄° 
sockaddr_°‹age
 *
addr
;

296 
socksho°_t
 *
ho°
;

299 i‡(
ho°
 =
NULL
) {

300 
socksho°_t
 
_ho°
;

302 
ho°
 = &
_ho°
;

305 
addr
->
ss_Ámûy
) {

306 
AF_INET
:

307 
ho°
->
©y≥
 = 
SOCKS_ADDR_IPV4
;

308 
ho°
->
addr
.
ùv4
 = 
	`TOCIN
◊ddr)->
sö_addr
;

309 
ho°
->
p‹t
 = 
	`TOCIN
(
addr
)->
sö_p‹t
;

312 
AF_INET6
:

313 
ho°
->
©y≥
 = 
SOCKS_ADDR_IPV6
;

314 
ho°
->
addr
.
ùv6
.
ù
 = 
	`TOCIN6
◊ddr)->
sö6_addr
;

315 
ho°
->
addr
.
ùv6
.
sc›eid
 = 
	`TOCIN6
◊ddr)->
sö6_sc›e_id
;

316 
ho°
->
p‹t
 = 
	`TOCIN6
(
addr
)->
sö6_p‹t
;

320 
	`SERRX
(
addr
->
ss_Ámûy
);

323  
ho°
;

324 
	}
}

327 
	$sockaddr2ho°«me
(
ß
, 
ho°«me
, 
ho°«mñí
)

328 c⁄° 
sockaddr_°‹age
 *
ß
;

329 *
ho°«me
;

330 c⁄° 
size_t
 
ho°«mñí
;

332 c⁄° *
fun˘i⁄
 = "sockaddr2hostname()";

333 
vbuf
[
MAXHOSTNAMELEN
 * 4];

334 
rc
;

336 
rc
 = 
	`gë«meöfo
(
	`TOCSA
(
ß
),

337 
	`ßÀn
(
ß
->
ss_Ámûy
),

338 
ho°«me
,

339 
ho°«mñí
,

340 
NULL
,

342 
NI_NAMEREQD
);

344 i‡(
rc
 != 0) {

345 
	`¶og
(
LOG_DEBUG
, "%s: getnameinfo(%s) failed: %s",

346 
fun˘i⁄
,

347 
	`sockaddr2°rög2
(
ß
, 0, 
NULL
, 0),

348 
	`gai_°ªº‹
(
rc
));

350  
rc
;

353 
	`¶og
(
LOG_DEBUG
, "%s: %sÑesolvedÅo \"%s\"",

354 
fun˘i⁄
,

355 
	`sockaddr2°rög2
(
ß
, 0, 
NULL
, 0),

356 
	`°r2vis
(
ho°«me
, 
	`°æí
(ho°«me), 
vbuf
, (vbuf)));

358  
rc
;

359 
	}
}

362 
sockaddr_°‹age
 *

363 
	$öt_ruÀaddr2sockaddr2
(
addªss
, 
ß
, 
Àn
, 
¥Ÿocﬁ
, 
gaõº
, 
emsg
, 
emsgÀn
)

364 c⁄° 
ruÀaddr_t
 *
addªss
;

365 
sockaddr_°‹age
 *
ß
;

366 
size_t
 
Àn
;

367 c⁄° 
¥Ÿocﬁ
;

368 *
gaõº
;

369 *
emsg
;

370 c⁄° 
size_t
 
emsgÀn
;

372 
socksho°_t
 
ho°
;

374 i‡(
ß
 =
NULL
) {

375 
sockaddr_°‹age
 
ßmem
;

377 
ß
 = &
ßmem
;

378 
Àn
 = (
ßmem
);

381 
	`ruÀaddr2socksho°
(
addªss
, &
ho°
, 
¥Ÿocﬁ
);

382  
	`öt_socksho°2sockaddr2
(&
ho°
, 
ß
, 
Àn
, 
gaõº
, 
emsg
, 
emsgÀn
);

383 
	}
}

385 
sockaddr_°‹age
 *

386 
	$öt_ruÀaddr2sockaddr
(
addªss
, 
ß
, 
Àn
, 
¥Ÿocﬁ
)

387 c⁄° 
ruÀaddr_t
 *
addªss
;

388 
sockaddr_°‹age
 *
ß
;

389 
size_t
 
Àn
;

390 c⁄° 
¥Ÿocﬁ
;

392 
gaõº
;

394  
	`öt_ruÀaddr2sockaddr2
(
addªss
, 
ß
, 
Àn
, 
¥Ÿocﬁ
, &
gaõº
, 
NULL
, 0);

395 
	}
}

397 
socksho°_t
 *

398 
	$ruÀaddr2socksho°
(
addªss
, 
ho°
, 
¥Ÿocﬁ
)

399 c⁄° 
ruÀaddr_t
 *
addªss
;

400 
socksho°_t
 *
ho°
;

401 
¥Ÿocﬁ
;

403 c⁄° *
fun˘i⁄
 = "ruleaddr2sockshost()";

405 i‡(
ho°
 =
NULL
) {

406 
socksho°_t
 
ho°mem
;

408 
ho°
 = &
ho°mem
;

411 
ho°
->
©y≥
 = 
addªss
->atype) {

412 
SOCKS_ADDR_IPV4
:

413 
ho°
->
addr
.
ùv4
 = 
addªss
->addr.ùv4.
ù
;

416 
SOCKS_ADDR_IPV6
:

417 
ho°
->
addr
.
ùv6
.
ù
 = 
addªss
->addr.ipv6.ip;

418 
ho°
->
addr
.
ùv6
.
sc›eid
 = 
addªss
->addr.ipv6.scopeid;

421 
SOCKS_ADDR_DOMAIN
:

422 
	`STRCPY_ASSERTSIZE
(
ho°
->
addr
.
domaö
, 
addªss
->addr.domain);

425 
SOCKS_ADDR_IFNAME
: {

426 
sockaddr_°‹age
 
addr
, 
p
;

428 i‡(
	`i‚ame2sockaddr
(
addªss
->
addr
.
i‚ame
, 0, &addr, &
p
Ë=
NULL
){

429 
	`sw¨nx
("%s: cannot find interfaceÇamed %s with IP configured. "

431 
fun˘i⁄
, 
addªss
->
addr
.
i‚ame
, 
INADDR_ANY
);

433 
ho°
->
©y≥
 = 
SOCKS_ADDR_IPV4
;

434 
ho°
->
addr
.
ùv4
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

437 
addr
.
ss_Ámûy
) {

438 
AF_INET
:

439 
ho°
->
addr
.
ùv4
 = 
	`TOIN
(&addr)->
sö_addr
;

442 
AF_INET6
:

443 
ho°
->
addr
.
ùv6
.
ù
 = 
	`TOIN6
(&addr)->
sö6_addr
;

444 
ho°
->
addr
.
ùv6
.
sc›eid
 = 
	`TOIN6
(&addr)->
sö6_sc›e_id
;

448 
	`SERRX
(
addr
.
ss_Ámûy
);

452 
ho°
->
©y≥
 = 
	`ßÁmûy2©y≥
(
addr
.
ss_Ámûy
);

459 
	`SERRX
(
addªss
->
©y≥
);

462 
¥Ÿocﬁ
) {

463 
SOCKS_TCP
:

464 
ho°
->
p‹t
 = 
addªss
->p‹t.
t˝
;

467 
SOCKS_UDP
:

468 
ho°
->
p‹t
 = 
addªss
->p‹t.
udp
;

472 
	`SERRX
(
¥Ÿocﬁ
);

475  
ho°
;

476 
	}
}

478 
ruÀaddr_t
 *

479 
	$socksho°2ruÀaddr
(
ho°
, 
addr
)

480 c⁄° 
socksho°_t
 *
ho°
;

481 
ruÀaddr_t
 *
addr
;

484 i‡(
addr
 =
NULL
) {

485 
ruÀaddr_t
 
addrmem
;

487 
addr
 = &
addrmem
;

490 
addr
->
©y≥
 = 
ho°
->atype) {

491 
SOCKS_ADDR_IPV4
:

492 
addr
->addr.
ùv4
.
ù
 = 
ho°
->addr.ipv4;

493 
addr
->addr.
ùv4
.
mask
.
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

496 
SOCKS_ADDR_IPV6
:

497 
addr
->addr.
ùv6
.
ù
 = 
ho°
->addr.ipv6.ip;

498 
addr
->addr.
ùv6
.
maskbôs
 = 
IPV6_NETMASKBITS
;

499 
addr
->addr.
ùv6
.
sc›eid
 = 
ho°
->addr.ipv6.scopeid;

502 
SOCKS_ADDR_DOMAIN
:

503 
	`STRCPY_ASSERTSIZE
(
addr
->addr.
domaö
, 
ho°
->addr.domain);

507 
	`SERRX
(
ho°
->
©y≥
);

511 i‡(
ho°
->
p‹t
 =
	`ht⁄s
(0)) {

512 
addr
->
›î©‹
 = 
n⁄e
;

513 
addr
->
p‹t
.
t˝
 =áddr->p‹t.
udp
 =áddr->
p‹ãnd
 = 
	`ht⁄s
(0);

516 
addr
->
›î©‹
 = 
eq
;

517 
addr
->
p‹t
.
t˝
 = 
ho°
->port;

518 
addr
->
p‹t
.
udp
 = 
ho°
->port;

519 
addr
->
p‹ãnd
 = 
ho°
->
p‹t
;

522  
addr
;

523 
	}
}

525 
ruÀaddr_t
 *

526 
	$sockaddr2ruÀaddr
(
addr
, 
ruÀaddr
)

527 c⁄° 
sockaddr_°‹age
 *
addr
;

528 
ruÀaddr_t
 *
ruÀaddr
;

530 
socksho°_t
 
ho°
;

532 
	`sockaddr2socksho°
(
addr
, &
ho°
);

533 
	`socksho°2ruÀaddr
(&
ho°
, 
ruÀaddr
);

535  
ruÀaddr
;

536 
	}
}

538 
sockaddr_°‹age
 *

539 
	$öt_ho°«me2sockaddr
(
«me
, 
ödex
, 
addr
, 
addæí
)

540 c⁄° *
«me
;

541 
size_t
 
ödex
;

542 
sockaddr_°‹age
 *
addr
;

543 
size_t
 
addæí
;

545 
rc
;

547  
	`öt_ho°«me2sockaddr2
(
«me
, 
ödex
, 
addr
, 
addæí
, &
rc
, 
NULL
, 0);

548 
	}
}

551 
sockaddr_°‹age
 *

552 
	$öt_ho°«me2sockaddr2
(
«me
, 
ödex
, 
addr
, 
addæí
, 
gaõº
, 
emsg
, 
emsgÀn
)

553 c⁄° *
«me
;

554 
size_t
 
ödex
;

555 
sockaddr_°‹age
 *
addr
;

556 
size_t
 
addæí
;

557 *
gaõº
;

558 *
emsg
;

559 
size_t
 
emsgÀn
;

561 c⁄° *
fun˘i⁄
 = "int_hostname2sockaddr()";

562 
addröfo
 *
ai
, 
höts
;

563 
dnsöfo_t
 
aimem
;

564 
size_t
 
i
;

565 
emsgmem
[1024 + 
MAXHOSTNAMELEN
 * 4];

567 i‡(
emsg
 =
NULL
 || 
emsgÀn
 == 0) {

568 
emsg
 = 
emsgmem
;

569 
emsgÀn
 = (
emsgmem
);

572 *
emsg
 = 
NUL
;

573 *
gaõº
 = 0;

575 
	`bzîo
(
addr
, 
addæí
);

576 
	`SET_SOCKADDR
(
addr
, 
AF_UNSPEC
);

578 
	`bzîo
(&
höts
, (hints));

579 i‡((*
gaõº
 = 
	`cgëaddröfo
(
«me
, 
NULL
, &
höts
, &
ai
, &
aimem
)) != 0) {

580 
visbuf
[
MAXHOSTNAMELEN
 * 4];

582 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇotÑesolve hostname \"%s\": %s",

583 
	`°r2vis
(
«me
, 
	`°æí
“ame), 
visbuf
, (visbuf)),

584 
	`gai_°ªº‹
(*
gaõº
));

586 
	`¶og
(
LOG_DEBUG
, "%s: couldÇotÑesolve hostname \"%s\": %s",

587 
fun˘i⁄
, 
visbuf
, 
	`gai_°ªº‹
(*
gaõº
));

589  
NULL
;

592 
i
 = 0;

594 
	`SASSERTX
(
ai
->
ai_addr
 !
NULL
);

596 i‡(
i
 =
ödex
) {

597 
	`sockaddr˝y
(
addr
, 
	`TOSS
(
ai
->
ai_addr
), 
addæí
);

598  
addr
;

601 ++
i
;

602 
ai
 =ái->
ai_√xt
;

603 } 
ai
 !
NULL
);

605  
NULL
;

606 
	}
}

609 
sockaddr_°‹age
 *

610 
	$öt_i‚ame2sockaddr
(
i‚ame
, 
ödex
, 
addr
, 
addæí
, 
mask
, 
maskÀn
)

611 c⁄° *
i‚ame
;

612 
size_t
 
ödex
;

613 
sockaddr_°‹age
 *
addr
;

614 
size_t
 
addæí
;

615 
sockaddr_°‹age
 *
mask
;

616 
size_t
 
maskÀn
;

618 c⁄° *
fun˘i⁄
 = "int_ifname2sockaddr()";

619 
iÁddrs
 
iÁ
, *
iÁp
 = &iÁ, *
iÁ˚
;

620 
size_t
 
i
, 
ªÆödex
;

621 
foundi‚ame
, 
foundaddr
;

623 i‡(
	`gëiÁddrs
(&
iÁp
) != 0) {

624 
	`sw¨n
("%s: gëiÁddrs(ËÁûed", 
fun˘i⁄
);

625  
NULL
;

628 
iÁ˚
 = 
iÁp
, 
i
 = 0, 
ªÆödex
 = 0, 
foundi‚ame
 = 
foundaddr
 = 0;

629 
i
 <
ödex
 && 
iÁ˚
 !
NULL
;

630 
iÁ˚
 = iÁ˚->
iÁ_√xt
, ++
ªÆödex
) {

631 i‡(
	`°rcmp
(
iÁ˚
->
iÁ_«me
, 
i‚ame
) != 0)

634 
foundi‚ame
 = 1;

636 i‡(
iÁ˚
->
iÁ_addr
 =
NULL
) {

637 
	`¶og
(
LOG_DEBUG
,

639 
fun˘i⁄
, 
iÁ˚
->
iÁ_«me
, ()
ªÆödex
);

644 i‡(
iÁ˚
->
iÁ_√tmask
 =
NULL
) {

645 
	`¶og
(
LOG_DEBUG
,

647 
fun˘i⁄
,

648 
iÁ˚
->
iÁ_«me
,

649 
	`sockaddr2°rög
(
	`TOSS
(
iÁ˚
->
iÁ_addr
), 
NULL
, 0));

654 i‡(
iÁ˚
->
iÁ_addr
->
ß_Ámûy
 !
AF_INET


655 && 
iÁ˚
->
iÁ_addr
->
ß_Ámûy
 !
AF_INET6
) {

656 
	`¶og
(
LOG_DEBUG
,

659 
fun˘i⁄
, 
iÁ˚
->
iÁ_«me
, ()
ödex
);

668 i‡(
i
 !
ödex
) {

669 ++
i
;

673 
foundaddr
 = 1;

675 
	`sockaddr˝y
(
addr
, 
	`TOSS
(
iÁ˚
->
iÁ_addr
), 
addæí
);

677 i‡(
mask
 !
NULL
)

678 
	`sockaddr˝y
(
mask
, 
	`TOSS
(
iÁ˚
->
iÁ_√tmask
), 
maskÀn
);

683 
	`‰ìiÁddrs
(
iÁp
);

685 i‡(!
foundi‚ame
) {

686 
	`¶og
(
LOG_DEBUG
, "%s:Ço interface withÅheÇame \"%s\" found",

687 
fun˘i⁄
, 
i‚ame
);

689  
NULL
;

692 i‡(!
foundaddr
) {

693 i‡(
ödex
 == 0) {

694 
visbuf
[
MAXIFNAMELEN
 * 4];

696 
	`sw¨nx
("%s: interface \"%s\" hasÇo usable IP-addresses configured",

697 
fun˘i⁄
,

698 
	`°r2vis
(
i‚ame
, 
	`°æí
(i‚ame), 
visbuf
, (visbuf)));

702  
NULL
;

705  
addr
;

706 
	}
}

709 
	$sockaddr2i‚ame
(
addr
, 
i‚ame
, 
iÊí
)

710 
sockaddr_°‹age
 *
addr
;

711 *
i‚ame
;

712 
size_t
 
iÊí
;

714 c⁄° *
fun˘i⁄
 = "sockaddr2ifname()";

715 
iÁddrs
 
iÁ
, *
iÁp
 = &iÁ, *
iÁ˚
;

716 
size_t
 
nocom∑ª
;

718 i‡(
i‚ame
 =
NULL
 || 
iÊí
 == 0) {

719 
i‚ame_mem
[
MAXIFNAMELEN
];

721 
i‚ame
 = 
i‚ame_mem
;

722 
iÊí
 = (
i‚ame_mem
);

730 
nocom∑ª
 = 
ADDRINFO_PORT
;

732 i‡(
addr
->
ss_Ámûy
 =
AF_INET6


733 && 
	`TOIN6
(
addr
)->
sö6_sc›e_id
 == 0)

737 
nocom∑ª
 |
ADDRINFO_SCOPEID
;

739 i‡(
	`gëiÁddrs
(&
iÁp
) != 0)

740  
NULL
;

742 
iÁ˚
 = 
iÁp
; iÁ˚ !
NULL
; iÁ˚ = iÁ˚->
iÁ_√xt
) {

743 i‡(
iÁ˚
->
iÁ_addr
 !
NULL


744 && 
	`sockaddøªeq
(
	`TOSS
(
iÁ˚
->
iÁ_addr
), 
addr
, 
nocom∑ª
)) {

745 
	`°∫˝y
(
i‚ame
, 
iÁ˚
->
iÁ_«me
, 
iÊí
 - 1);

746 
i‚ame
[
iÊí
 - 1] = 
NUL
;

748 
	`¶og
(
LOG_DEBUG
, "%s:áddress %s belongsÅo interface %s (af: %s)",

749 
fun˘i⁄
,

750 
	`sockaddr2°rög
(
addr
, 
NULL
, 0),

751 
i‚ame
,

752 
	`ßÁmûy2°rög
(
iÁ˚
->
iÁ_addr
->
ß_Ámûy
));

754 
	`‰ìiÁddrs
(
iÁp
);

755  
i‚ame
;

758 
	`¶og
(
LOG_DEBUG
,

760 
fun˘i⁄
,

761 
	`sockaddr2°rög
(
addr
, 
NULL
, 0),

762 
iÁ˚
->
iÁ_«me
,

763 
iÁ˚
->
iÁ_addr
 =
NULL
 ?

764 "<nÿaddªss>" : 
	`ßÁmûy2°rög
(
iÁ˚
->
iÁ_addr
->
ß_Ámûy
));

767 
	`‰ìiÁddrs
(
iÁp
);

768  
NULL
;

769 
	}
}

772 
	$socksho°¨ìq
(
a
, 
b
)

773 c⁄° 
socksho°_t
 *
a
;

774 c⁄° 
socksho°_t
 *
b
;

777 i‡(
a
->
©y≥
 !
b
->atype)

780 i‡(
a
->
p‹t
 !
b
->port)

783 
a
->
©y≥
) {

784 
SOCKS_ADDR_IPV4
:

785 i‡(
	`memcmp
(&
a
->
addr
.
ùv4
, &
b
->addr.ipv4, (a->addr.ipv4)) != 0)

789 
SOCKS_ADDR_IPV6
:

790 i‡(
	`memcmp
(&
a
->
addr
.
ùv6
, &
b
->addr.ipv6, (a->addr.ipv6)) != 0)

794 
SOCKS_ADDR_DOMAIN
:

795 i‡(
	`°rcmp
(
a
->
addr
.
domaö
, 
b
->addr.domain) != 0)

800 
	`SERRX
(
a
->
©y≥
);

804 
	}
}

807 
	$fd£t›
(
highe°fd
, 
›
, 
a
, 
b
, 
ªsu…
)

808 
highe°fd
;

809 
›
;

810 c⁄° 
fd_£t
 *
a
;

811 c⁄° 
fd_£t
 *
b
;

812 
fd_£t
 *
ªsu…
;

814 
i
, 
bôs
;

816 
bôs
 = -1;

817 
›
) {

819 
	`FD_ZERO
(
ªsu…
);

820 
i
 = 0; i <
highe°fd
; ++i)

821 i‡(
	`FD_ISSET
(
i
, 
a
Ë&& FD_ISSET(i, 
b
)) {

822 
	`FD_SET
(
i
, 
ªsu…
);

823 
bôs
 = 
	`MAX
(
i
, bits);

829 
	`FD_ZERO
(
ªsu…
);

830 
i
 = 0; i <
highe°fd
; ++i)

831 i‡(
	`FD_ISSET
(
i
, 
a
Ë!FD_ISSET(i, 
b
)) {

832 
	`FD_SET
(
i
, 
ªsu…
);

833 
bôs
 = 
	`MAX
(
i
, bits);

836 
	`FD_CLR
(
i
, 
ªsu…
);

845 
i
 = 0; i <
highe°fd
; ++i)

846 i‡(
	`FD_ISSET
(
i
, 
a
Ë|| FD_ISSET(i, 
b
)) {

847 
	`FD_SET
(
i
, 
ªsu…
);

848 
bôs
 = 
	`MAX
(
i
, bits);

853 
	`SERRX
(
›
);

856  
bôs
;

857 
	}
}

860 
	$mëhodis£t
(
mëhod
, 
mëhodv
, 
mëhodc
)

861 
mëhod
;

862 c⁄° *
mëhodv
;

863 
size_t
 
mëhodc
;

865 c⁄° *
fun˘i⁄
 = "methodisset()";

866 
size_t
 
i
;

868 i‡(
sockscf
.
›ti⁄
.
debug
)

869 
	`¶og
(
LOG_DEBUG
,

871 
fun˘i⁄
,

872 
	`mëhod2°rög
(
mëhod
),

873 ()
mëhodc
,

874 
	`mëhods2°rög
(
mëhodc
, 
mëhodv
, 
NULL
, 0));

876 
i
 = 0; i < 
mëhodc
; ++i)

877 i‡(
mëhodv
[
i
] =
mëhod
)

881 
	}
}

884 
	$°r2vis
(
°rög
, 
Àn
, 
vis°rög
, 
vi¶í
)

885 c⁄° *
°rög
;

886 
size_t
 
Àn
;

887 *
vis°rög
;

888 
size_t
 
vi¶í
;

890 c⁄° 
visÊag
 = 
VIS_TAB
 | 
VIS_NL
 | 
VIS_CSTYLE
 | 
VIS_OCTAL
;

892 i‡(
vis°rög
 =
NULL
) {

893 
	`SERRX
(0);

896 i‡((
vis°rög
 = 
	`mÆloc
(((*vis°rögË* 
Àn
 * 4Ë+ 1)Ë=
NULL
)

897  
NULL
;

899 
vi¶í
 = 
Àn
 * 4 + 1;

902 
Àn
 = 
	`MIN
÷í, (
vi¶í
 / 4) - 1);

903 
	`°rvisx
(
vis°rög
, 
°rög
, 
Àn
, 
visÊag
);

905  
vis°rög
;

906 
	}
}

909 
	$socks_mklock
(
ãm∂©e
, 
√w«me
, 
√w«mñí
)

910 c⁄° *
ãm∂©e
;

911 *
√w«me
;

912 c⁄° 
size_t
 
√w«mñí
;

914 c⁄° *
fun˘i⁄
 = "socks_mklock()";

915 
√wãm∂©e
[
PATH_MAX
];

916 
size_t
 
Àn
;

917 *
¥efix
;

918 
s
, 
Êag
;

920 i‡((
¥efix
 = 
	`socks_gëív
(
ENV_TMPDIR
, 
d⁄tˇª
)Ë!
NULL
)

921 i‡(*
¥efix
 =
NUL
)

922 
¥efix
 = 
NULL
;

924 i‡(
¥efix
 =
NULL
)

925 
¥efix
 = "/tmp";

927 
Àn
 = 
	`°æí
(
¥efix
Ë+ såÀn("/"Ë+ såÀn(
ãm∂©e
) + 1;

928 i‡(
Àn
 > (
√wãm∂©e
))

929 
	`£º
("%s:Åhe combination of \"%s\"ánd \"%s\""

931 
fun˘i⁄
, 
¥efix
, 
ãm∂©e
, ()(
√wãm∂©e
));

933 i‡(
√w«mñí
 !0 && 
Àn
 >Çewnamelen)

934 
	`£º
("%s:Åhe combination of \"%s\"ánd \"%s\""

936 
fun˘i⁄
, 
¥efix
, 
ãm∂©e
, ()
√w«mñí
);

938 i‡(*
¥efix
 !
NUL
)

939 
	`¢¥ötf
(
√wãm∂©e
, 
Àn
, "%s/%s", 
¥efix
, 
ãm∂©e
);

941 
	`¢¥ötf
(
√wãm∂©e
, 
Àn
, "%s", 
ãm∂©e
);

943 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

944 
	`¶og
(
LOG_DEBUG
, "%s:Çewtemplate = \"%s\",Örefix = \"%s\" "

946 
fun˘i⁄
, 
√wãm∂©e
, 
¥efix
,

947 ()
	`gëuid
(), ()
	`gëeuid
(), ()
	`gëgid
(), ()
	`gëegid
());

949 i‡(
	`°r°r
(
√wãm∂©e
, "XXXXXX"Ë!
NULL
) {

950 c⁄° 
mode_t
 
ﬁdumask
 = 
	`umask
(
S_IWGRP
 | 
S_IWOTH
);

952 i‡((
s
 = 
	`mk°emp
(
√wãm∂©e
)) == -1)

953 
	`sw¨n
("%s: mkstemp(%s) usingÉuid/egid %d/%d failed",

954 
fun˘i⁄
, 
√wãm∂©e
, ()
	`gëeuid
(), ()
	`gëegid
());

956 ()
	`umask
(
ﬁdumask
);

958 #i‡
HAVE_SOLARIS_BUGS


959 i‡(
s
 =-1 && *
√wãm∂©e
 =
NUL
) {

963 i‡(*
¥efix
 !
NUL
)

964 
	`¢¥ötf
(
√wãm∂©e
, 
Àn
, "%s/%s", 
¥efix
, 
ãm∂©e
);

966 
	`¢¥ötf
(
√wãm∂©e
, 
Àn
, "%s", 
ãm∂©e
);

971 
s
 = 
	`›í
(
√wãm∂©e
, 
O_RDWR
 | 
O_CREAT
 | 
O_EXCL
, 0600);

972 
	`sw¨n
("%s: o≥n(%s)", 
fun˘i⁄
, 
√wãm∂©e
);

975 i‡(
s
 == -1) {

976 i‡(*
¥efix
 =
NUL
) {

977 
	`¶og
(
LOG_DEBUG
, "%s: failedÅo create \"%s\" (%s)ánd TMPDIR isÇot "

979 
fun˘i⁄
, 
√wãm∂©e
, 
	`°ªº‹
(
î∫o
));

981 i‡(
	`£ãnv
("TMPDIR", "/tmp", 1) != 0)

982 
	`£º
("%s: couldÇŸ sëív(\"TMPDIR\", \"/tmp\")", 
fun˘i⁄
);

984 
	`SASSERT
(
	`socks_gëív
(
ENV_TMPDIR
, 
d⁄tˇª
Ë!
NULL
);

986  
	`socks_mklock
(
ãm∂©e
, 
√w«me
, 
√w«mñí
);

992 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

993 
	`¶og
(
LOG_DEBUG
, "%s: cª©ed fûê%s", 
fun˘i⁄
, 
√wãm∂©e
);

995 i‡(
√w«mñí
 == 0) {

996 i‡(
	`u∆ök
(
√wãm∂©e
) == -1) {

997 
	`sw¨n
("%s: u∆ök(%s)", 
fun˘i⁄
, 
√wãm∂©e
);

998 
	`˛o£
(
s
);

1004 
	`°r˝y
(
√w«me
, 
√wãm∂©e
);

1006 i‡((
Êag
 = 
	`f˙é
(
s
, 
F_GETFD
, 0)) == -1

1007 || 
	`f˙é
(
s
, 
F_SETFD
, 
Êag
 | 
FD_CLOEXEC
) == -1)

1008 
	`sw¨n
("%s: f˙é(F_GETFD/F_SETFD)", 
fun˘i⁄
);

1010  
s
;

1011 
	}
}

1014 
	$socks_lock
(
d
, 
off£t
, 
Àn
, 
ex˛usive
, 
waô
)

1015 c⁄° 
d
;

1016 c⁄° 
off_t
 
off£t
;

1017 c⁄° 
off_t
 
Àn
;

1018 c⁄° 
ex˛usive
;

1019 c⁄° 
waô
;

1021 c⁄° *
fun˘i⁄
 = "socks_lock()";

1022 
Êock
 
lock
;

1023 
rc
;

1027 i‡(
d
 == -1)

1030 
lock
.
l_°¨t
 = 
off£t
;

1031 
lock
.
l_Àn
 = 
Àn
;

1032 
lock
.
l_whí˚
 = 
SEEK_SET
;

1033 
lock
.
l_ty≥
 = 
ex˛usive
 ? 
F_WRLCK
 : 
F_RDLCK
;

1035 #i‡
DIAGNOSTIC
 && 0

1037 
Êock
 
dügöfo
 = 
lock
;

1039 i‡(
d
 !
sockscf
.
loglock
 && 
	`f˙é
(d, 
F_GETLK
, &
dügöfo
) != -1)

1040 i‡(
dügöfo
.
l_ty≥
 !
F_UNLCK
)

1041 
	`¶og
(
LOG_DEBUG
, "%s:Üock %d is currently held byÖid %ld",

1042 
fun˘i⁄
, 
d
, ()
dügöfo
.
l_pid
);

1047 
rc
 = 
	`f˙é
(
d
, 
waô
 ? 
F_SETLKW
 : 
F_SETLK
, &
lock
);

1048 
rc
 =-1 && 
waô
 && (
	`ERRNOISTMP
(
î∫o
Ë||Éºnÿ=
EACCES
));

1050 i‡(
rc
 == -1) {

1051 i‡(!
sockscf
.
°©e
.
öôed


1052 && 
sockscf
.
loglock
 =
d


1053 && 
sockscf
.
loglock
 == 0) {

1054 
sockscf
.
loglock
 = -1;

1058 
	`SASSERT
(
	`ERRNOISTMP
(
î∫o
Ë||Éºnÿ=
EACCES
);

1059 
	`SASSERT
(!
waô
);

1062  
rc
;

1063 
	}
}

1066 
	$socks_u∆ock
(
d
, 
off£t
, 
Àn
)

1067 
d
;

1068 c⁄° 
off_t
 
off£t
;

1069 c⁄° 
off_t
 
Àn
;

1072 
Êock
 
lock
;

1076 i‡(
d
 == -1)

1079 
lock
.
l_°¨t
 = 
off£t
;

1080 
lock
.
l_Àn
 = 
Àn
;

1081 
lock
.
l_ty≥
 = 
F_UNLCK
;

1082 
lock
.
l_whí˚
 = 
SEEK_SET
;

1084 i‡(
	`f˙é
(
d
, 
F_SETLK
, &
lock
) == -1)

1085 
	`SERR
(
î∫o
);

1086 
	}
}

1089 
	$fdis›í
(
fd
)

1090 c⁄° 
fd
;

1092 c⁄° 
î∫o_s
 = 
î∫o
;

1093 c⁄° 
rc
 = 
	`f˙é
(
fd
, 
F_GETFD
, 0);

1095 
î∫o
 = 
î∫o_s
;

1096  
rc
 != -1;

1097 
	}
}

1100 
	$fdisblockög
(
fd
)

1101 c⁄° 
fd
;

1103 c⁄° *
fun˘i⁄
 = "fdisblocking()";

1104 
p
;

1106 i‡((
p
 = 
	`f˙é
(
fd
, 
F_GETFL
, 0)) == -1) {

1107 
	`sw¨n
("%s: f˙é(F_GETFL)", 
fun˘i⁄
);

1111  !(
p
 & 
O_NONBLOCK
);

1112 
	}
}

1115 
	$˛o£v
(
ic
, 
iv
)

1116 
size_t
 
ic
;

1117 *
iv
;

1119 
size_t
 
i
;

1121 
i
 = 0; i < 
ic
; ++i)

1122 i‡(
iv
[
i
] >= 0)

1123 i‡(
	`˛o£
(
iv
[
i
]) != 0)

1124 
	`SWARN
(
iv
[
i
]);

1125 
	}
}

1132 
	$bôcou¡
(
numbî
)

1133 
numbî
;

1135 
bôs£t
;

1137 
bôs£t
 = 0; 
numbî
 > 0;Çumber >>= 1)

1138 i‡(
numbî
 & 1)

1139 ++
bôs£t
;

1141  
bôs£t
;

1142 
	}
}

1145 
	$bôcou¡_ö6addr
(
ö6addr
)

1146 c⁄° 
ö6_addr
 *
ö6addr
;

1148 
size_t
 
i
;

1149 
bôs£t
;

1151 
i
 = 0, 
bôs£t
 = 0; i < 
	`ELEMENTS
(
ö6addr
->
s6_addr
); ++i)

1152 
bôs£t
 +
	`bôcou¡
(()
ö6addr
->
s6_addr
[
i
]);

1154  
bôs£t
;

1155 
	}
}

1158 
fd_£t
 *

1159 
	$Æloˇã_maxsize_fd£t
()

1161 c⁄° *
fun˘i⁄
 = "allocate_maxsize_fdset()";

1162 
fd_£t
 *
£t
;

1164 #i‡
SOCKS_CLIENT


1165 
sockscf
.
°©e
.
max›ífûes
 = 
	`gëmaxofûes
(
h¨dlimô
);

1166 i‡(
sockscf
.
°©e
.
max›ífûes
 =(
æim_t
)
RLIM_INFINITY
)

1171 
sockscf
.
°©e
.
max›ífûes
 = 
	`gëmaxofûes
(
so·limô
);

1174 
	`SASSERTX
(
sockscf
.
°©e
.
max›ífûes
 < (
æim_t
)
RLIM_INFINITY
);

1175 
	`SASSERTX
(
sockscf
.
°©e
.
max›ífûes
 > 0);

1177 i‡((
£t
 = 
	`mÆloc
(
	`MAX
((
fd_£t
), 
	`SOCKD_FD_SIZE
()))Ë=
NULL
)

1178 
	`£º
("%s: malloc() of %lu bytes for fd_set failed",

1179 
fun˘i⁄
, ()
	`MAX
((
fd_£t
), 
	`SOCKD_FD_SIZE
()));

1181 #i‡
DEBUG


1182 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1183 
	`¶og
(
LOG_DEBUG
, "%s:állocated %lu bytes",

1184 
fun˘i⁄
, ()
	`SOCKD_FD_SIZE
());

1187  
£t
;

1188 
	}
}

1190 
æim_t


1191 
	$gëmaxofûes
(
limôty≥_t
 
ty≥
)

1193 c⁄° *
fun˘i⁄
 = "getmaxofiles()";

1194 
æimô
Ñlimit;

1195 
æim_t
 
limô
;

1197 i‡(
	`gëæimô
(
RLIMIT_OFILE
, &
æimô
) != 0)

1198 
	`£º
("%s: gëæimô(RLIMIT_OFILE)", 
fun˘i⁄
);

1200 i‡(
ty≥
 =
so·limô
)

1201 
limô
 = 
æimô
.
æim_cur
;

1202 i‡(
ty≥
 =
h¨dlimô
)

1203 #i‡
HAVE_DARWIN


1204 
limô
 = 
	`MIN
(
æimô
.
æim_max
, 
OPEN_MAX
);

1206 
limô
 = 
æimô
.
æim_max
;

1209 
	`SERRX
(
ty≥
);

1212 #i‡!
SOCKS_CLIENT
 && 
FD_SETSIZE_LIMITS_SELECT


1218 i‡(
limô
 >
FD_SETSIZE
) {

1219 
logged
;

1221 i‡(!
logged
) {

1222 
	`¶og
(
LOG_INFO
,

1225 
fun˘i⁄
, ()
limô
, ()
FD_SETSIZE
);

1227 
logged
 = 1;

1230 
limô
 = 
FD_SETSIZE
 - 1;

1234 i‡(
ty≥
 =
so·limô
 && 
limô
 =(
æim_t
)
RLIM_INFINITY
) {

1235 
logged
;

1236 c⁄° 
æim_t
 
ªdu˚d
 = 65356;

1238 i‡(!
logged
) {

1239 
	`¶og
(
LOG_INFO
,

1241 
fun˘i⁄
, ()
RLIM_INFINITY
, ()
ªdu˚d
);

1243 
logged
 = 1;

1246 
limô
 = 
ªdu˚d
;

1249  
limô
;

1250 
	}
}

1253 
	$socks_sigblock
(
sig
, 
ﬁd£t
)

1254 c⁄° 
sig
;

1255 
sig£t_t
 *
ﬁd£t
;

1257 c⁄° *
fun˘i⁄
 = "socks_sigblock()";

1258 
sig£t_t
 
√wmask
;

1260 i‡(
sig
 == -1)

1261 ()
	`sigfûl£t
(&
√wmask
);

1263 ()
	`sigem±y£t
(&
√wmask
);

1264 ()
	`sigadd£t
(&
√wmask
, 
sig
);

1267 i‡(
	`sig¥ocmask
(
SIG_BLOCK
, &
√wmask
, 
ﬁd£t
) != 0)

1268 
	`sw¨n
("%s: sig¥ocmask()", 
fun˘i⁄
);

1269 
	}
}

1272 
	$socks_sigunblock
(
ﬁd£t
)

1273 c⁄° 
sig£t_t
 *
ﬁd£t
;

1275 c⁄° *
fun˘i⁄
 = "socks_sigunblock()";

1277 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, 
ﬁd£t
, 
NULL
) != 0)

1278 
	`sw¨n
("%s: sig¥ocmask()", 
fun˘i⁄
);

1279 
	}
}

1283 
	$socks_msgha£º‹s
(
¥efix
, 
msg
)

1284 c⁄° *
¥efix
;

1285 c⁄° 
msghdr
 *
msg
;

1287 i‡(
msg
->
msg_Êags
 & 
MSG_TRUNC
) {

1288 
	`sw¨nx
("%s: msg i†åunˇãd ... mesßgêdisˇrded", 
¥efix
);

1290 i‡(
	`CMSG_TOTLEN
(*
msg
) > 0)

1291 
	`sw¨nx
("%s: XXX should clo£Ñe˚ived des¸ùt‹s", 
¥efix
);

1296 i‡(
msg
->
msg_Êags
 & 
MSG_CTRUNC
) {

1297 
	`sw¨nx
("%s: cmsg wa†åunˇãd ... mesßgêdisˇrded", 
¥efix
);

1302 
	}
}

1305 
	$£c⁄ds2days
(
£c⁄ds
, 
days
, 
hours
, 
möuãs
)

1306 *
£c⁄ds
;

1307 *
days
;

1308 *
hours
;

1309 *
möuãs
;

1312 i‡(*
£c⁄ds
 >= 3600 * 24) {

1313 *
days
 = *
£c⁄ds
 / (3600 * 24);

1314 *
£c⁄ds
 -(
time_t
)(*
days
 * 3600 * 24);

1317 *
days
 = 0;

1319 i‡(*
£c⁄ds
 >= 3600) {

1320 *
hours
 = *
£c⁄ds
 / 3600;

1321 *
£c⁄ds
 -(
time_t
)(*
hours
 * 3600);

1324 *
hours
 = 0;

1326 i‡(*
£c⁄ds
 >= 60) {

1327 *
möuãs
 = *
£c⁄ds
 / 60;

1328 *
£c⁄ds
 -(
time_t
)(*
möuãs
 * 60);

1331 *
möuãs
 = 0;

1333 #i‡
DIAGNOSTIC


1334 
	`SASSERTX
(*
£c⁄ds
 < 60);

1335 
	`SASSERTX
(*
möuãs
 < 60);

1336 
	`SASSERTX
(*
hours
 < 24);

1339 
	}
}

1341 
sockaddr_°‹age
 *

1342 
	$öt_uæ°rög2sockaddr
(
°rög
, 
ßddr
, 
ßddæí
, 
gaõº
, 
emsg
, 
emsgÀn
)

1343 c⁄° *
°rög
;

1344 
sockaddr_°‹age
 *
ßddr
;

1345 
size_t
 
ßddæí
;

1346 *
gaõº
;

1347 *
emsg
;

1348 
size_t
 
emsgÀn
;

1350 c⁄° *
fun˘i⁄
 = "int_urlstring2sockaddr()";

1351 c⁄° *
hâµªfix
 = "http://";

1352 
buf
[1024], 
vbuf
[(bufË* 4], 
v°rög
[(vbuf)],

1353 
emsgmem
[1024], *
p‹t
, *
s
;

1354 
p‹äumbî
;

1355 
havï‹t£p
;

1357 *
gaõº
 = 0;

1359 
	`bzîo
(
ßddr
, 
ßddæí
);

1360 
	`SET_SOCKADDR
(
ßddr
, 
AF_UNSPEC
);

1362 i‡(
emsg
 =
NULL
) {

1363 
emsg
 = 
emsgmem
;

1364 
emsgÀn
 = (
emsgmem
);

1367 
	`¶og
(
LOG_DEBUG
, "%s: stringÅoÖarse is \"%s\"",

1368 
fun˘i⁄
, 
	`°r2vis
(
°rög
, 
	`°æí
(°rög), 
v°rög
, (vstring)));

1370 i‡(
	`°r°r
(
°rög
, 
hâµªfix
Ë=
NULL
) {

1371 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1373 
hâµªfix
, 
v°rög
);

1375 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

1376  
NULL
;

1379 
°rög
 +
	`°æí
(
hâµªfix
);

1381 
	`¢¥ötf
(
buf
, (buf), "%s", 
°rög
);

1383 i‡((
s
 = 
	`°rchr
(
buf
, ':')Ë=
NULL
) {

1384 
	`¶og
(
LOG_DEBUG
, "%s: couldÇot findÖort separator in \"%s\"",

1385 
fun˘i⁄
, 
v°rög
);

1387 
havï‹t£p
 = 0;

1390 
havï‹t£p
 = 1;

1391 *
s
 = 
NUL
;

1394 i‡(*
buf
 =
NUL
) {

1395 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1396 "couldÇŸ födáddªs†°rög i¿\"%s\"", 
v°rög
);

1398 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

1399  
NULL
;

1402 
	`¶og
(
LOG_DEBUG
, "%s:Öre-portnumber string (%s): \"%s\"",

1403 
fun˘i⁄
,

1404 
havï‹t£p
 ? "portnumber comesÜater" : "noÖortnumber given",

1405 
	`°r2vis
(
buf
, 
	`°æí
(buf), 
vbuf
, (vbuf)));

1407 i‡(
	`socks_öë_±⁄
(
ßddr
->
ss_Ámûy
, 
buf
, &(
	`TOIN
(ßddr)->
sö_addr
), 
NULL
)

1409 
ho°ít
 *hostent;

1410 *
ï
;

1412 
î∫o
 = 0;

1413 ()
	`°πﬁ
(
buf
, &
ï
, 10);

1415 i‡(*
ï
 =
NUL
 || 
î∫o
 =
ERANGE
) {

1417 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1419 
	`°r2vis
(
buf
, 
	`°æí
(buf), 
vbuf
, (vbuf)));

1421 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

1422  
NULL
;

1425 i‡((
ho°ít
 = 
	`gëho°by«me
(
buf
)Ë=
NULL


1426 || 
ho°ít
->
h_addr
 =
NULL
) {

1427 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇotÑesolve hostname \"%s\"",

1428 
	`°r2vis
(
buf
, 
	`°æí
(buf), 
vbuf
, (vbuf)));

1430 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

1431  
NULL
;

1434 
	`SET_SOCKADDR
(
ßddr
, (
uöt8_t
)
ho°ít
->
h_addπy≥
);

1435 
	`mem˝y
(&
	`TOIN
(
ßddr
)->
sö_addr
,

1436 
ho°ít
->
h_addr_li°
[0],

1437 (
size_t
)
ho°ít
->
h_Àngth
);

1441 i‡(
havï‹t£p
) {

1442 i‡((
p‹t
 = 
	`°rchr
(
°rög
, ':')Ë=
NULL
) {

1443 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1445 
	`°r2vis
(
°rög
, 
	`°æí
(°rög), 
vbuf
, (vbuf)));

1447  
NULL
;

1449 ++
p‹t
;

1451 i‡((
p‹äumbî
 = 
	`°rög2p‹äumbî
(
p‹t
, 
emsg
, 
emsgÀn
)) == -1)

1452  
NULL
;

1455 
p‹äumbî
 = 
SOCKD_HTTP_PORT
;

1457 
	`TOIN
(
ßddr
)->
sö_p‹t
 = 
	`ht⁄s
((
ö_p‹t_t
)
p‹äumbî
);

1459 
	`¶og
(
LOG_DEBUG
, "%s:Ñeturningáddr %s",

1460 
fun˘i⁄
, 
	`sockaddr2°rög
(
ßddr
, 
NULL
, 0));

1462  
ßddr
;

1463 
	}
}

1465 #unde‡
¢¥ötf


1466 
size_t


1467 
	$¢¥öt‚
(*
°r
, 
size_t
 
size
, c⁄° *
f‹m©
, ...)

1469 c⁄° 
î∫o_s
 = 
î∫o
;

1470 
va_li°
 
≠
;

1471 
ssize_t
 
rc
;

1473 i‡(
size
 <0 || 
°r
 =
NULL
)

1476 
	`va_°¨t
(
≠
, 
f‹m©
);

1477 
rc
 = 
	`v¢¥ötf
(
°r
, 
size
, 
f‹m©
, 
≠
);

1478 
	`va_íd
(
≠
);

1480 
î∫o
 = 
î∫o_s
;

1482 i‡(
rc
 <= 0) {

1483 *
°r
 = 
NUL
;

1484 
rc
 = 0;

1486 i‡(
rc
 >(
ssize_t
)
size
) {

1487 
rc
 = (
ssize_t
)(
size
 - 1);

1488 
°r
[
rc
] = 
NUL
;

1491 i‡(
size
 > 0)

1492 
	`SASSERTX
(
°r
[
rc
] =
NUL
);

1494  (
size_t
)
rc
;

1495 
	}
}

1502 
	$˛o£n
(
d
)

1503 
d
;

1505 
rc
;

1507 #unde‡
˛o£


1508 (
rc
 = 
	`˛o£
(
d
)Ë=-1 && 
î∫o
 =
EINTR
)

1511 i‡(
rc
 =-1 && 
î∫o
 !
EBADF
) {

1523 
î∫o
 = 0;

1524 
rc
 = 0;

1527  
rc
;

1528 
	}
}

	@libscompat/daemon.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

40 
	$d´m⁄
(
nochdú
, 
no˛o£
)

42 
fd
;

44 
	`f‹k
()) {

50 
	`_exô
(0);

53 i‡(
	`£tsid
() == -1)

56 i‡(!
nochdú
)

57 ()
	`chdú
("/");

59 i‡(!
no˛o£
 && (
fd
 = 
	`›í
("/dev/nuŒ", 
O_RDWR
, 0)) != -1) {

60 ()
	`dup2
(
fd
, 
STDIN_FILENO
);

61 ()
	`dup2
(
fd
, 
STDOUT_FILENO
);

62 ()
	`dup2
(
fd
, 
STDERR_FILENO
);

63 i‡(
fd
 > 2)

64 ()
	`˛o£
 (
fd
);

67 
	}
}

	@libscompat/difftime.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

18 
	~"¥iv©e.h
"

20 #i‚de‡
TYPE_SIGNED


21 
	#TYPE_SIGNED
(
ty≥
Ë((—y≥Ë-1Ë< 0)

	)

29 #i‚de‡
TYPE_INTEGRAL


30 
	#TYPE_INTEGRAL
(
ty≥
Ë((—y≥Ë0.5Ë!0.5)

	)

35 
	$dif·ime
(
time1
, 
time0
)

36 c⁄° 
time_t
 
time1
;

37 c⁄° 
time_t
 
time0
;

44 i‡( (Ë>  (
time_t
))

45  (Ë
time1
 - (Ë
time0
;

46 i‡(!
	`TYPE_INTEGRAL
(
time_t
)) {

50  
time1
 - 
time0
;

52 i‡(!
	`TYPE_SIGNED
(
time_t
)) {

58 i‡(
time1
 >
time0
)

59  
time1
 - 
time0
;

60  -((Ë(
time0
 - 
time1
));

67 i‡((
time1
 < 0Ë=(
time0
 < 0))

68  
time1
 - 
time0
;

73 i‡( (Ë<  (
time_t
))

74  (Ë
time1
 - (Ë
time0
;

78 i‡(
time1
 >= 0 )

79  (Ë
time1
 +

80 (Ë(-(
time0
 + 1)) + 1;

81  -(Ë((Ë
time0
 +

82 (Ë(-(
time1
 + 1)) + 1);

83 
	}
}

	@libscompat/getifaddrs.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

52 #i‡
PRERELEASE


53 
	#IFCONF_STARTENT
 4

	)

55 
	#IFCONF_STARTENT
 10

	)

57 
	#IFCONF_MAXENT
 1000

	)

59 
	siÁwøp
 {

60 
iÁddrs
 *
	miÁddrs
;

61 
iÁddrs
 *
	m¥ev
;

64 
sockaddr
 *

65 
gëifvÆ
(
s
, 
Êag
, 
i‰eq
 *i‰eq, 
sockaddr
 *
addr
,

66 
uöt8_t
 
addæí
);

72 
lifc⁄f_add
(
iÁwøp
 *ifawrap);

79 
iÁddrs_add
(
iÁwøp
 *ifawrap,

80 *
«me
, 
Êags
,

81 
sockaddr
 *
addr
, sockadd∏*
√tmask
,

82 
sockaddr
 *
d°addr
, sockadd∏*
d©a
, 
size_t
 
addæí
);

89 
	$gëiÁddrs
(
iÁddrs
 **
iÁp
)

91 
sockaddr_°‹age
 
i_addr
, 
i_√tmask
, 
i_brﬂdd°
;

92 
sockaddr
 *
p_addr
, *
p_√tmask
, *
p_brﬂdd°
;

93 
iÁwøp
 ifawrap;

94 
ifc⁄f
 ifconf;

95 
i‰eq
 *ifreq;

96 
i‰eq
 
i‰eq2
;

97 
size_t
 
addæí
;

98 
Êags
;

99 
addrskù
;

100 
¥evÀn
;

101 
bad«me
;

102 *
nbuf
;

103 *
buf
;

104 *
p
;

105 
˙t
;

106 
Àn
;

107 
i
;

108 
s
;

110 i‡((
s
 = 
	`sockë
(
AF_INET
, 
SOCK_DGRAM
, 0)) == -1)

113 
	`bzîo
(&
ifc⁄f
, (ifconf));

115 i‡(
	`io˘l
(
s
, 
SIOCGIFCONF
, &
ifc⁄f
Ë!-1 && ifc⁄f.
ifc_Àn
 != 0) {

116 
Àn
 = 
ifc⁄f
.
ifc_Àn
;

117 i‡((
buf
 = 
	`mÆloc
(
Àn
)Ë=
NULL
) {

118 
	`˛o£
(
s
);

121 
ifc⁄f
.
ifc_Àn
 = 
Àn
;

122 
ifc⁄f
.
ifc_buf
 = 
buf
;

123 i‡(
	`io˘l
(
s
, 
SIOCGIFCONF
, &
ifc⁄f
) == -1) {

124 
	`‰ì
(
buf
);

125 
	`˛o£
(
s
);

129 
buf
 = 
NULL
;

130 
¥evÀn
 = 0;

131 
˙t
 = 
IFCONF_STARTENT
;

134 
Àn
 = (
i‰eq
Ë* 
˙t
;

135 i‡((
nbuf
 = 
	`ªÆloc
(
buf
, 
Àn
)Ë=
NULL
) {

136 
	`‰ì
(
buf
);

137 
	`˛o£
(
s
);

140 
buf
 = 
nbuf
;

142 
ifc⁄f
.
ifc_Àn
 = 
Àn
;

143 
ifc⁄f
.
ifc_buf
 = 
buf
;

145 i‡(
	`io˘l
(
s
, 
SIOCGIFCONF
, &
ifc⁄f
Ë=-1 && 
î∫o
 !
EINVAL
) {

146 
	`‰ì
(
buf
);

147 
	`˛o£
(
s
);

152 i‡(
ifc⁄f
.
ifc_Àn
 > 0 && ifc⁄f.ifc_À¿=
¥evÀn
)

155 
¥evÀn
 = 
ifc⁄f
.
ifc_Àn
;

156 
˙t
 *= 2;

158 i‡(
˙t
 >
IFCONF_MAXENT
) {

160 
	`‰ì
(
buf
);

161 
	`˛o£
(
s
);

167 
iÁwøp
.
iÁddrs
 = 
NULL
;

168 
p
 = 
ifc⁄f
.
ifc_buf
;

169 
p
 < 
ifc⁄f
.
ifc_buf
 + ifc⁄f.
ifc_Àn
) {

170 
i‰eq
 = (i‰eq *)
p
;

172 
p_addr
 = 
p_√tmask
 = 
p_brﬂdd°
 = 
NULL
;

173 
	`bzîo
(&
i_addr
, (i_addr));

174 
	`bzîo
(&
i_√tmask
, (i_netmask));

175 
	`bzîo
(&
i_brﬂdd°
, (i_broaddst));

178 
bad«me
 = 0;

179 i‡(
i‰eq
->
i‰_«me
[0] == '\0')

180 
bad«me
 = 1;

182 
i
 = 0; (
size_t
)ò< (
i‰eq
->
i‰_«me
); i++) {

183 i‡(
i‰eq
->
i‰_«me
[
i
] == '\0')

185 i‡(!
	`isgøph
(
i‰eq
->
i‰_«me
[
i
])) {

186 
bad«me
 = 1;

190 i‡(
bad«me
) {

191 
	`‰ì
(
buf
);

192 
	`˛o£
(
s
);

193 
î∫o
 = 
EFAULT
;

197 #i‡
HAVE_SOCKADDR_SA_LEN


199 
addæí
 = 
	`MAX
((
sockaddr
), 
i‰eq
->
i‰_addr
.
ß_Àn
);

203 
i‰eq
->
i‰_addr
.
ß_Ámûy
) {

204 
AF_INET6
:

205 
addæí
 = (
sockaddr_ö6
);

208 #ifde‡
AF_LINK


209 
AF_LINK
:

210 
addæí
 = (
sockaddr_dl
);

214 
AF_INET
:

216 
addæí
 = (
sockaddr
);

220 
addrskù
 = 
	`ROUNDUP
(
addæí
, (
uöt32_t
));

222 
p
 +
	`MAX
((
i‰eq
->
i‰_«me
Ë+ 
addrskù
, (ifreq));

224 
i‰eq
->
i‰_addr
.
ß_Ámûy
) {

225 
AF_INET
:

226 
AF_INET6
:

227 #ifde‡
AF_LINK


228 
AF_LINK
:

236 
i‰eq2
 = *
i‰eq
;

237 i‡(
	`io˘l
(
s
, 
SIOCGIFFLAGS
, &
i‰eq2
) == -1) {

238 
	`‰ì
(
buf
);

239 
	`˛o£
(
s
);

242 
Êags
 = 
i‰eq2
.
i‰_Êags
;

243 i‡((
Êags
 & 
IFF_UP
) == 0) {

247 
	`bzîo
(&
i_addr
, (i_addr));

248 
	`mem˝y
(&
i_addr
, &
i‰eq
->
i‰_addr
,

249 
	`MIN
((
i‰eq
->
i‰_addr
), (
i_addr
)));

250 
p_addr
 = (
sockaddr
 *)&
i_addr
;

252 #ifde‡
SIOCGIFNETMASK


253 
p_√tmask
 = 
	`gëifvÆ
(
s
, 
SIOCGIFNETMASK
, 
i‰eq
,

254 (
sockaddr
 *)&
i_√tmask
, 
addæí
);

257 #ifde‡
SIOCGIFBRDADDR


258 i‡(
Êags
 & 
IFF_BROADCAST
)

259 
p_brﬂdd°
 = 
	`gëifvÆ
(
s
, 
SIOCGIFBRDADDR
, 
i‰eq
,

260 (
sockaddr
 *)&
i_brﬂdd°
, 
addæí
);

263 #ifde‡
SIOCGIFDSTADDR


264 i‡(
p_brﬂdd°
 =
NULL
 && 
Êags
 & 
IFF_POINTOPOINT
)

265 
p_brﬂdd°
 = 
	`gëifvÆ
(
s
, 
SIOCGIFDSTADDR
, 
i‰eq
,

266 (
sockaddr
 *)&
i_brﬂdd°
, 
addæí
);

270 i‡(
	`iÁddrs_add
(&
iÁwøp
, 
i‰eq
->
i‰_«me
, 
Êags
, 
p_addr
, 
p_√tmask
,

271 
p_brﬂdd°
, 
NULL
, 
addæí
) == -1) {

272 i‡(
iÁwøp
.
iÁddrs
 !
NULL
) {

273 
	`‰ìiÁddrs
(
iÁwøp
.
iÁddrs
);

274 
	`‰ì
(
buf
);

275 
	`˛o£
(
s
);

281 #ifde‡
SIOCGLIFCONF


282 
	`lifc⁄f_add
(&
iÁwøp
);

285 
	`‰ì
(
buf
);

286 
	`˛o£
(
s
);

287 *
iÁp
 = 
iÁwøp
.
iÁddrs
;

289 
	}
}

291 
sockaddr
 *

292 
	$gëifvÆ
(
s
, 
Êag
, 
i‰eq
 *i‰eq, 
sockaddr
 *
addr
,

293 
uöt8_t
 
addæí
)

295 
hbuf
[
NI_MAXHOST
];

296 
i‰eq
 
i‰eq2
;

298 
i‰eq2
 = *
i‰eq
;

299 i‡(
	`io˘l
(
s
, 
Êag
, &
i‰eq2
) == -1)

300  
NULL
;

303 
i‰eq2
.
i‰_addr
.
ß_Ámûy
 = 
i‰eq
->ifr_addr.sa_family;

304 #i‡
HAVE_SOCKADDR_SA_LEN


305 
i‰eq2
.
i‰_addr
.
ß_Àn
 = 
addæí
;

309 i‡((
i‰eq2
.
i‰_addr
.
ß_Ámûy
 =
AF_INET


310 || 
i‰eq2
.
i‰_addr
.
ß_Ámûy
 =
AF_INET6
)

311 && (
	`gë«meöfo
((
sockaddr
 *)&
i‰eq2
.
i‰_addr
, 
addæí
,

312 
hbuf
, (hbuf),

313 
NULL
,

315 
NI_NUMERICHOST
 | 
NI_NUMERICSERV
)) != 0) {

316  
NULL
;

319 
	`mem˝y
(
addr
, &
i‰eq2
.
i‰_addr
, 
addæí
);

320  
addr
;

321 
	}
}

324 
	$iÁddrs_add
(
iÁwøp
 *iÁwøp, *
«me
, 
Êags
,

325 
sockaddr
 *
addr
, sockadd∏*
√tmask
,

326 
sockaddr
 *
d°addr
, sockadd∏*
d©a
, 
size_t
 
addæí
)

328 
size_t
 
«meoff
, 
addroff
, 
maskoff
, 
d°off
;

330 
size_t
 
d©aoff
;

332 
iÁddrs
 *
√w
;

333 
size_t
 
addrskù
;

334 
size_t
 
«mñí
;

335 
size_t
 
nsize
;

336 *
p
;

338 
«mñí
 = 
	`°æí
(
«me
) + 1;

340 
addrskù
 = 
	`ROUNDUP
(
addæí
, (
uöt32_t
));

342 
nsize
 = 0;

343 
nsize
 +
	`ROUNDUP
((
iÁddrs
), (
uöt32_t
));

344 
«meoff
 = 
nsize
;

346 
nsize
 +
	`ROUNDUP
(
«mñí
, (
uöt32_t
));

348 
nsize
 +
	`ROUNDUP
((
Êags
), (
uöt32_t
));

349 
addroff
 = 
nsize
;

351 i‡(
addr
 !
NULL
)

352 
nsize
 +
addrskù
;

353 
maskoff
 = 
nsize
;

355 i‡(
√tmask
 !
NULL
)

356 
nsize
 +
addrskù
;

357 
d°off
 = 
nsize
;

359 i‡(
d°addr
 !
NULL
)

360 
nsize
 +
addrskù
;

362 
d©aoff
 = 
nsize
;

365 i‡(
d©a
 !
NULL
)

366 
nsize
 +
addrskù
;

368 i‡((
√w
 = 
	`mÆloc
(
nsize
)Ë=
NULL
)

370 i‡(
iÁwøp
->
iÁddrs
 =
NULL
)

371 
iÁwøp
->
iÁddrs
 = 
√w
;

373 
iÁwøp
->
¥ev
->
iÁ_√xt
 = 
√w
;

374 
iÁwøp
->
¥ev
 = 
√w
;

376 
√w
->
iÁ_√xt
 = 
NULL
;

378 
p
 = (*)
√w
 + 
«meoff
;

379 
	`°∫˝y
(
p
, 
«me
, 
«mñí
 - 1);

380 
p
[
«mñí
 - 1] = '\0';

381 
√w
->
iÁ_«me
 = 
p
;

383 
√w
->
iÁ_Êags
 = 
Êags
;

385 i‡(
addr
 !
NULL
) {

386 
p
 = (*)
√w
 + 
addroff
;

387 
	`mem˝y
(
p
, 
addr
, 
addæí
);

388 
√w
->
iÁ_addr
 = (
sockaddr
 *)
p
;

390 
√w
->
iÁ_addr
 = 
NULL
;

392 i‡(
√tmask
 !
NULL
) {

393 
p
 = (*)
√w
 + 
maskoff
;

394 
	`mem˝y
(
p
, 
√tmask
, 
addæí
);

395 
√w
->
iÁ_√tmask
 = (
sockaddr
 *)
p
;

397 
√w
->
iÁ_√tmask
 = 
NULL
;

399 i‡(
d°addr
 !
NULL
) {

400 
p
 = (*)
√w
 + 
d°off
;

401 
	`mem˝y
(
p
, 
d°addr
, 
addæí
);

402 
√w
->
iÁ_d°addr
 = (
sockaddr
 *)
p
;

404 
√w
->
iÁ_d°addr
 = 
NULL
;

407 i‡(
d©a
 !
NULL
) {

408 
p
 = (*)
√w
 + 
d©aoff
;

409 
	`mem˝y
(
p
, 
d©a
, 
addæí
);

410 
√w
->
iÁ_d©a
 = (
sockaddr
 *)
p
;

413 
√w
->
iÁ_d©a
 = 
NULL
;

416 
	}
}

419 
	$‰ìiÁddrs
(
iÁddrs
 *
iÁp
)

421 
iÁddrs
 *
c
, *
n
;

423 
c
 = 
iÁp
;

424 
c
 !
NULL
) {

425 
n
 = 
c
->
iÁ_√xt
;

426 
	`‰ì
(
c
);

427 
c
 = 
n
;

429 
	}
}

431 #ifde‡
SIOCGLIFCONF


437 
sockaddr
 *

438 
gëifvÆ2
(
s
, 
Êag
, 
li‰eq
 *li‰eq, 
sockaddr
 *
addr
,

439 
uöt8_t
 
addæí
);

442 
	$lifc⁄f_add
(
iÁwøp
 *ifawrap)

444 
sockaddr_°‹age
 
i_addr
, 
i_√tmask
, 
i_brﬂdd°
;

445 
sockaddr
 *
p_addr
, *
p_√tmask
, *
p_brﬂdd°
;

446 
li‚um
Üifnum;

447 
lifc⁄f
Üifconf;

448 
li‰eq
 *lifreq;

449 
li‰eq
 
li‰eq2
;

450 
Êags
;

451 
size_t
 
addæí
;

452 
addrskù
;

453 
bad«me
;

454 *
buf
;

455 *
p
;

456 
i
;

457 
s
;

460 i‡((
s
 = 
	`sockë
(
AF_INET6
, 
SOCK_DGRAM
, 0)) == -1)

463 
	`bzîo
(&
li‚um
, (lifnum));

464 
li‚um
.
li‚_Ámûy
 = 
AF_UNSPEC
;

465 i‡((
i
 = 
	`io˘l
(
s
, 
SIOCGLIFNUM
, &
li‚um
)) == -1) {

466 
	`˛o£
(
s
);

470 i‡(
li‚um
.
li‚_cou¡
 == 0) {

471 
	`˛o£
(
s
);

475 
	`bzîo
(&
lifc⁄f
, (lifconf));

476 
lifc⁄f
.
lifc_Àn
 = 
li‚um
.
li‚_cou¡
 * (
li‰eq
);

480 i‡((
buf
 = 
	`mÆloc
(
lifc⁄f
.
lifc_Àn
)Ë=
NULL
) {

481 
	`˛o£
(
s
);

484 
lifc⁄f
.
lifc_buf
 = 
buf
;

486 i‡(
	`io˘l
(
s
, 
SIOCGLIFCONF
, &
lifc⁄f
) == -1) {

487 
	`‰ì
(
buf
);

488 
	`˛o£
(
s
);

492 
p
 = 
lifc⁄f
.
lifc_buf
;

493 
p
 < 
lifc⁄f
.
lifc_buf
 +Üifc⁄f.
lifc_Àn
) {

494 
li‰eq
 = (li‰eq *)
p
;

496 
p_addr
 = 
p_√tmask
 = 
p_brﬂdd°
 = 
NULL
;

497 
	`bzîo
(&
i_addr
, (i_addr));

498 
	`bzîo
(&
i_√tmask
, (i_netmask));

499 
	`bzîo
(&
i_brﬂdd°
, (i_broaddst));

502 
bad«me
 = 0;

503 i‡(
li‰eq
->
li‰_«me
[0] == '\0')

504 
bad«me
 = 1;

506 
i
 = 0; (
size_t
)ò< (
li‰eq
->
li‰_«me
); i++) {

507 i‡(
li‰eq
->
li‰_«me
[
i
] == '\0')

509 i‡(!
	`isgøph
(
li‰eq
->
li‰_«me
[
i
])) {

510 
bad«me
 = 1;

514 i‡(
bad«me
) {

515 
	`‰ì
(
buf
);

516 
	`˛o£
(
s
);

517 
î∫o
 = 
EFAULT
;

521 #i‡
HAVE_SOCKADDR_SA_LEN


523 
addæí
 = 
	`MAX
((
sockaddr
), 
li‰eq
->
li‰_addr
.
ß_Àn
);

527 
li‰eq
->
li‰_addr
.
ss_Ámûy
) {

528 
AF_INET6
:

529 
addæí
 = (
sockaddr_ö6
);

532 #ifde‡
AF_LINK


533 
AF_LINK
:

534 
addæí
 = (
sockaddr_dl
);

538 
AF_INET
:

540 
addæí
 = (
sockaddr
);

544 
addrskù
 = 
	`ROUNDUP
(
addæí
, (
uöt32_t
));

546 
p
 +
	`MAX
((
li‰eq
->
li‰_«me
Ë+ 
addrskù
, (lifreq));

550 
li‰eq
->
li‰_addr
.
ss_Ámûy
) {

551 
AF_INET6
:

558 
li‰eq2
 = *
li‰eq
;

559 i‡(
	`io˘l
(
s
, 
SIOCGLIFFLAGS
, &
li‰eq2
) == -1) {

560 
	`‰ì
(
buf
);

561 
	`˛o£
(
s
);

564 
Êags
 = 
li‰eq2
.
li‰_Êags
;

566 i‡((
Êags
 & 
IFF_UP
) == 0) {

571 
	`bzîo
(&
i_addr
, (i_addr));

572 
	`mem˝y
(&
i_addr
, &
li‰eq
->
li‰_addr
,

573 
	`MIN
((
li‰eq
->
li‰_addr
), (
i_addr
)));

574 
p_addr
 = (
sockaddr
 *)&
i_addr
;

576 #ifde‡
SIOCGLIFNETMASK


577 
p_√tmask
 = 
	`gëifvÆ2
(
s
, 
SIOCGLIFNETMASK
, 
li‰eq
,

578 (
sockaddr
 *)&
i_√tmask
, 
addæí
);

581 #ifde‡
SIOCGLIFBRDADDR


582 i‡(
Êags
 & 
IFF_BROADCAST
)

583 
p_brﬂdd°
 = 
	`gëifvÆ2
(
s
, 
SIOCGLIFBRDADDR
, 
li‰eq
,

584 (
sockaddr
 *)&
i_brﬂdd°
, 
addæí
);

587 #ifde‡
SIOCGLIFDSTADDR


588 i‡(
p_brﬂdd°
 =
NULL
 && 
Êags
 & 
IFF_POINTOPOINT
)

589 
p_brﬂdd°
 = 
	`gëifvÆ2
(
s
, 
SIOCGLIFDSTADDR
, 
li‰eq
,

590 (
sockaddr
 *)&
i_brﬂdd°
, 
addæí
);

594 i‡(
	`iÁddrs_add
(
iÁwøp
, 
li‰eq
->
li‰_«me
, 
Êags
, 
p_addr
, 
p_√tmask
,

595 
p_brﬂdd°
, 
NULL
, 
addæí
) == -1) {

596 i‡(
iÁwøp
->
iÁddrs
 !
NULL
) {

597 
	`‰ìiÁddrs
(
iÁwøp
->
iÁddrs
);

598 
	`‰ì
(
buf
);

599 
	`˛o£
(
s
);

605 
	`‰ì
(
buf
);

606 
	`˛o£
(
s
);

608 
	}
}

611 
sockaddr
 *

612 
	$gëifvÆ2
(
s
, 
Êag
, 
li‰eq
 *li‰eq, 
sockaddr
 *
addr
,

613 
uöt8_t
 
addæí
)

615 
hbuf
[
NI_MAXHOST
];

616 
li‰eq
 
li‰eq2
;

618 
li‰eq2
 = *
li‰eq
;

619 i‡(
	`io˘l
(
s
, 
Êag
, &
li‰eq2
) == -1)

620  
NULL
;

624 #i‡
HAVE_SOCKADDR_SA_LEN


625 
li‰eq2
.
li‰_addr
.
ss_Àn
 = 
addæí
;

629 i‡((
li‰eq2
.
li‰_addr
.
ss_Ámûy
 =
AF_INET


630 || 
li‰eq2
.
li‰_addr
.
ss_Ámûy
 =
AF_INET6
)

631 && (
	`gë«meöfo
((
sockaddr
 *)&
li‰eq2
.
li‰_addr
, 
addæí
,

632 
hbuf
, (hbuf),

633 
NULL
,

635 
NI_NUMERICHOST
 | 
NI_NUMERICSERV
)) != 0) {

636  
NULL
;

639 
	`mem˝y
(
addr
, &
li‰eq2
.
li‰_addr
, 
addæí
);

640  
addr
;

641 
	}
}

	@libscompat/hstrerror.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

52 
	~<√tdb.h
>

55 
	$h°ªº‹
(
îr
)

61 ()
îr
;

63 
	}
}

	@libscompat/ifaddrs.h

4 #unde‡
iÁ_brﬂdaddr


5 #unde‡
iÁ_d°addr


6 
	#iÁ_brﬂdaddr
 
iÁ_d°addr


	)

8 
	siÁddrs
 {

9 
iÁddrs
 *
	miÁ_√xt
;

10 *
	miÁ_«me
;

11 
	miÁ_Êags
;

12 
sockaddr
 *
	miÁ_addr
;

13 
sockaddr
 *
	miÁ_√tmask
;

14 
sockaddr
 *
	miÁ_d°addr
;

15 *
	miÁ_d©a
;

19 
gëiÁddrs
(
iÁddrs
 **
iÁp
);

21 
‰ìiÁddrs
(
iÁddrs
 *
iÁp
);

	@libscompat/in_cksum.c

1 #ifde‡
HAVE_CONFIG_H


2 
	~"autoc⁄f.h
"

5 
	~"osdï.h
"

7 c⁄° 
	grcsid
[] =

15 
uöt16_t


16 
	$ö_cksum
(
uöt16_t
 *
addr
, 
Àn
)

18 
∆e·
 = 
Àn
;

19 
uöt32_t
 
sum
 = 0;

20 
uöt16_t
 *
w
 = 
addr
;

21 
uöt16_t
 
™swî
 = 0;

28 
∆e·
 > 1) {

29 
sum
 +*
w
++;

30 
∆e·
 -= 2;

34 i‡(
∆e·
 == 1) {

35 *(*)(&
™swî
Ë*(*)
w
 ;

36 
sum
 +
™swî
;

40 
sum
 = (sum >> 16) + (sum & 0xffff);

41 
sum
 += (sum >> 16);

42 
™swî
 = ~
sum
;

44  
™swî
;

45 
	}
}

	@libscompat/in_cksum.h

1 
uöt16_t
 
ö_cksum
(uöt16_à*
addr
, 
Àn
);

	@libscompat/inet_ntoa.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

45 
	$öë_¡ﬂ
(
ö_addr
 
ö
)

47 
b
[18];

48 *
p
;

50 
p
 = (*)&
ö
;

51 
	#UC
(
b
Ë((()b)&0xff)

	)

52 ()
	`¢¥ötf
(
b
, (b),

53 "%u.%u.%u.%u", 
	`UC
(
p
[0]), UC(p[1]), UC(p[2]), UC(p[3]));

54  (
b
);

55 
	}
}

	@libscompat/inet_pton.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

27 #i‡
deföed
(
LIBC_SCCS
Ë&& !deföed(
löt
)

29 
	grcsid
[] = "$From: inet_pton.c,v 8.7 1996/08/05 08:31:35 vixie Exp $";

31 
	grcsid
[] = "$OpenBSD: inet_pton.c,v 1.2 1997/04/13 05:08:24 deraadt Exp $";

35 #i‚de‡
AF_INET6


36 
	#AF_INET6
 24

	)

38 #i‚de‡
INADDRSZ


39 
	#INADDRSZ
 4

	)

41 #i‚de‡
IN6ADDRSZ


42 
	#IN6ADDRSZ
 16

	)

44 #i‚de‡
INT16SZ


45 
	#INT16SZ
 2

	)

53 
öë_±⁄4
(c⁄° *
§c
, 
u_ch¨
 *
d°
);

54 
öë_±⁄6
(c⁄° *
§c
, 
u_ch¨
 *
d°
);

68 
	$öë_±⁄
(
af
, 
§c
, 
d°
)

69 
af
;

70 c⁄° *
§c
;

71 *
d°
;

73 
af
) {

74 
AF_INET
:

75  (
	`öë_±⁄4
(
§c
, 
d°
));

76 
AF_INET6
:

77  (
	`öë_±⁄6
(
§c
, 
d°
));

79 
î∫o
 = 
EAFNOSUPPORT
;

83 
	}
}

96 
	$öë_±⁄4
(
§c
, 
d°
)

97 c⁄° *
§c
;

98 
u_ch¨
 *
d°
;

100 c⁄° 
digôs
[] = "0123456789";

101 
ßw_digô
, 
o˘ës
, 
ch
;

102 
u_ch¨
 
tmp
[
INADDRSZ
], *
ç
;

104 
ßw_digô
 = 0;

105 
o˘ës
 = 0;

106 *(
ç
 = 
tmp
) = 0;

107 (
ch
 = *
§c
++) != '\0') {

108 c⁄° *
pch
;

110 i‡((
pch
 = 
	`°rchr
(
digôs
, 
ch
)Ë!
NULL
) {

111 
u_öt
 
√w
 = *
ç
 * 10 + (
pch
 - 
digôs
);

113 i‡(
√w
 > 255)

115 i‡(! 
ßw_digô
) {

116 i‡(++
o˘ës
 > 4)

118 
ßw_digô
 = 1;

120 *
ç
 = 
√w
;

121 } i‡(
ch
 ='.' && 
ßw_digô
) {

122 i‡(
o˘ës
 == 4)

124 *++
ç
 = 0;

125 
ßw_digô
 = 0;

129 i‡(
o˘ës
 < 4)

132 
	`mem˝y
(
d°
, 
tmp
, 
INADDRSZ
);

134 
	}
}

150 
	$öë_±⁄6
(
§c
, 
d°
)

151 c⁄° *
§c
;

152 
u_ch¨
 *
d°
;

154 c⁄° 
xdigôs_l
[] = "0123456789abcdef",

155 
xdigôs_u
[] = "0123456789ABCDEF";

156 
u_ch¨
 
tmp
[
IN6ADDRSZ
], *
ç
, *
ídp
, *
cﬁ⁄p
;

157 c⁄° *
xdigôs
, *
cuπok
;

158 
ch
, 
ßw_xdigô
;

159 
u_öt
 
vÆ
;

161 
	`mem£t
((
ç
 = 
tmp
), '\0', 
IN6ADDRSZ
);

162 
ídp
 = 
ç
 + 
IN6ADDRSZ
;

163 
cﬁ⁄p
 = 
NULL
;

165 i‡(*
§c
 == ':')

166 i‡(*++
§c
 != ':')

168 
cuπok
 = 
§c
;

169 
ßw_xdigô
 = 0;

170 
vÆ
 = 0;

171 (
ch
 = *
§c
++) != '\0') {

172 c⁄° *
pch
;

174 i‡((
pch
 = 
	`°rchr
((
xdigôs
 = 
xdigôs_l
), 
ch
)Ë=
NULL
)

175 
pch
 = 
	`°rchr
((
xdigôs
 = 
xdigôs_u
), 
ch
);

176 i‡(
pch
 !
NULL
) {

177 
vÆ
 <<= 4;

178 
vÆ
 |(
pch
 - 
xdigôs
);

179 i‡(
vÆ
 > 0xffff)

181 
ßw_xdigô
 = 1;

184 i‡(
ch
 == ':') {

185 
cuπok
 = 
§c
;

186 i‡(!
ßw_xdigô
) {

187 i‡(
cﬁ⁄p
)

189 
cﬁ⁄p
 = 
ç
;

192 i‡(
ç
 + 
INT16SZ
 > 
ídp
)

194 *
ç
++ = (
u_ch¨
Ë(
vÆ
 >> 8) & 0xff;

195 *
ç
++ = (
u_ch¨
Ë
vÆ
 & 0xff;

196 
ßw_xdigô
 = 0;

197 
vÆ
 = 0;

200 i‡(
ch
 ='.' && ((
ç
 + 
INADDRSZ
Ë<
ídp
) &&

201 
	`öë_±⁄4
(
cuπok
, 
ç
) > 0) {

202 
ç
 +
INADDRSZ
;

203 
ßw_xdigô
 = 0;

208 i‡(
ßw_xdigô
) {

209 i‡(
ç
 + 
INT16SZ
 > 
ídp
)

211 *
ç
++ = (
u_ch¨
Ë(
vÆ
 >> 8) & 0xff;

212 *
ç
++ = (
u_ch¨
Ë
vÆ
 & 0xff;

214 i‡(
cﬁ⁄p
 !
NULL
) {

219 c⁄° 
n
 = 
ç
 - 
cﬁ⁄p
;

220 
i
;

222 
i
 = 1; i <
n
; i++) {

223 
ídp
[- 
i
] = 
cﬁ⁄p
[
n
 - i];

224 
cﬁ⁄p
[
n
 - 
i
] = 0;

226 
ç
 = 
ídp
;

228 i‡(
ç
 !
ídp
)

230 
	`mem˝y
(
d°
, 
tmp
, 
IN6ADDRSZ
);

232 
	}
}

	@libscompat/issetugid.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

52 #i‡
HAVE_LIBC_ENABLE_SECURE


53 
__libc_íabÀ_£cuª
;

57 
	$is£tugid
()

59 #i‡
HAVE_LIBC_ENABLE_SECURE


60 i‡(!
__libc_íabÀ_£cuª
)

62 #ñi‡
HAVE_LIBC_ENABLE_SECURE_DISABLED


63 i‡(
	`gëuid
(Ë=
	`gëeuid
(Ë&& 
	`gëgid
(Ë=
	`gëegid
())

68 
	}
}

	@libscompat/memmove.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

41 #i‡
deföed
(
LIBC_SCCS
Ë&& !deföed(
löt
)

42 *
	grcsid
 = "$OpenBSD: bcopy.c,v 1.2 1996/08/19 08:33:58Åholo Exp $";

49 
	tw‹d
;

51 
	#wsize
 (
w‹d
)

	)

52 
	#wmask
 (
wsize
 - 1)

	)

54 #unde‡
memmove


62 
	$memmove
(
d°0
, 
§c0
, 
Àngth
)

63 *
d°0
;

64 c⁄° *
§c0
;

65 
size_t
 
Àngth
;

67 *
d°
 = 
d°0
;

68 c⁄° *
§c
 = 
§c0
;

69 
size_t
 
t
;

71 i‡(
Àngth
 =0 || 
d°
 =
§c
)

72 
d⁄e
;

77 
	#TLOOP
(
s
Ëi‡(
t
Ë
	`TLOOP1
(s)

	)

78 
	#TLOOP1
(
s
Ëdÿ{ s; } --
t
)

	)

80 i‡(()
d°
 < ()
§c
) {

84 
t
 = ()
§c
;

85 i‡((
t
 | ()
d°
Ë& 
wmask
) {

90 i‡((
t
 ^ ()
d°
Ë& 
wmask
 || 
Àngth
 < 
wsize
)

91 
t
 = 
Àngth
;

93 
t
 = 
wsize
 - (à& 
wmask
);

94 
Àngth
 -
t
;

95 
	`TLOOP1
(*
d°
++ = *
§c
++);

100 
t
 = 
Àngth
 / 
wsize
;

101 
	`TLOOP
(*(
w‹d
 *)
d°
 = *(w‹d *)
§c
; sr¯+
wsize
; dst += wsize);

102 
t
 = 
Àngth
 & 
wmask
;

103 
	`TLOOP
(*
d°
++ = *
§c
++);

110 
§c
 +
Àngth
;

111 
d°
 +
Àngth
;

112 
t
 = ()
§c
;

113 i‡((
t
 | ()
d°
Ë& 
wmask
) {

114 i‡((
t
 ^ ()
d°
Ë& 
wmask
 || 
Àngth
 <
wsize
)

115 
t
 = 
Àngth
;

117 
t
 &
wmask
;

118 
Àngth
 -
t
;

119 
	`TLOOP1
(*--
d°
 = *--
§c
);

121 
t
 = 
Àngth
 / 
wsize
;

122 
	`TLOOP
(
§c
 -
wsize
; 
d°
 -wsize; *(
w‹d
 *)dst = *(word *)src);

123 
t
 = 
Àngth
 & 
wmask
;

124 
	`TLOOP
(*--
d°
 = *--
§c
);

126 
d⁄e
:

127  (
d°0
);

128 
	}
}

	@libscompat/pselect.c

1 #ifde‡
HAVE_CONFIG_H


2 
	~"autoc⁄f.h
"

5 
	~"osdï.h
"

52 c⁄° 
	grcsid
[] =

55 
sockd_h™dÀdsig«ls
();

60 
ölöe
 

61 
	$p£À˘
(
nfds
, 
fd_£t
 *
r£t
, fd_£à*
w£t
, fd_£à*
x£t
,

62 c⁄° 
time•ec
 *
ts
, c⁄° 
sig£t_t
 *
sigmask
)

64 
timevÆ
 
tv
;

65 
sig£t_t
 
sm
;

66 
n
;

68 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, 
sigmask
, &
sm
) == -1)

71 i‡(
ts
 !
NULL
) {

72 
tv
.
tv_£c
 = 
ts
->tv_sec;

73 
tv
.
tv_u£c
 = 
ts
->
tv_n£c
 / 1000;

76 #i‡
SOCKS_SERVER
 || 
BAREFOOTD
 || 
COVENANT


77 i‡(
	`sockd_h™dÀdsig«ls
() != 0) {

78 i‡(
sigmask
 !
NULL
)

79 ()
	`sig¥ocmask
(
SIG_SETMASK
, &
sm
, 
NULL
);

81 
î∫o
 = 
EINTR
;

87 
n
 = 
	`£À˘
(
nfds
, 
r£t
, 
w£t
, 
x£t
, (
ts
 =
NULL
Ë? NULL : &
tv
);

89 i‡(
sigmask
 !
NULL
 && 
	`sig¥ocmask
(
SIG_SETMASK
, &
sm
, NULL) == -1)

92  
n
;

93 
	}
}

	@libscompat/seteuid.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

10 
	$£ãgid
(
gid_t
 
egid
)

12  
	`£åesgid
(-1, 
egid
, -1);

13 
	}
}

16 
	$£ãuid
(
uid_t
 
euid
)

18  
	`£åeuid
(-1, 
euid
);

19 
	}
}

	@libscompat/setproctitle.c

4 #ifde‡
HAVE_CONFIG_H


5 
	~"autoc⁄f.h
"

8 
	~"osdï.h
"

44 
	~<°d¨g.h
>

45 
	~<°dlib.h
>

46 
	~<uni°d.h
>

47 
	~<°rög.h
>

50 
	#SPT_NONE
 0

	)

51 
	#SPT_REUSEARGV
 2

	)

53 #i‚de‡
SPT_TYPE


54 
	#SPT_TYPE
 
SPT_NONE


	)

57 #i‚de‡
SPT_PADCHAR


58 
	#SPT_PADCHAR
 '\0'

	)

61 #i‡
deföed
(
SPT_TYPE
Ë&& SPT_TYPE =
SPT_REUSEARGV


62 *
	g¨gv_°¨t
 = 
NULL
;

63 
size_t
 
	g¨gv_ív_Àn
 = 0;

66 *
__¥og«me
;

69 
	$öô£çro˘ôÀ
(
¨gc
, *
¨gv
[])

71 #i‡
	`deföed
(
SPT_TYPE
Ë&& SPT_TYPE =
SPT_REUSEARGV


72 *
œ°¨gv
 = 
NULL
;

73 
i
;

81 i‡(
¨gc
 =0 || 
¨gv
[0] =
NULL
)

87 
i
 = 0; i < 
¨gc
; i++) {

88 i‡(
œ°¨gv
 =
NULL
 ||Üa°¨gv + 1 =
¨gv
[
i
])

89 
œ°¨gv
 = 
¨gv
[
i
] + 
	`°æí
(argv[i]);

91 
¨gv
[1] = 
NULL
;

92 
¨gv_°¨t
 = 
¨gv
[0];

93 
¨gv_ív_Àn
 = 
œ°¨gv
 - 
¨gv
[0];

96 
	}
}

99 
	$£çro˘ôÀ
(c⁄° *
fmt
, ...)

101 #i‡
	`deföed
(
SPT_TYPE
Ë&& SPT_TYPE =
SPT_REUSEARGV


102 
va_li°
 
≠
;

103 
buf
[1024];

104 
size_t
 
Àn
;

106 i‡(
¨gv_ív_Àn
 == 0)

109 
	`°æ˝y
(
buf
, 
__¥og«me
, (buf));

111 
	`va_°¨t
(
≠
, 
fmt
);

112 i‡(
fmt
 !
NULL
) {

113 
Àn
 = 
	`°æˇt
(
buf
, ": ", (buf));

114 i‡(
Àn
 < (
buf
))

115 
	`v¢¥ötf
(
buf
 + 
Àn
, (bufË-Üí , 
fmt
, 
≠
);

117 
	`va_íd
(
≠
);

121 
Àn
 = 
	`°æ˝y
(
¨gv_°¨t
, 
buf
, 
¨gv_ív_Àn
);

122 ; 
Àn
 < 
¨gv_ív_Àn
;Üen++)

123 
¨gv_°¨t
[
Àn
] = 
SPT_PADCHAR
;

125 
	}
}

	@libscompat/sockatmark.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

53 
	$sock©m¨k
(
s
)

54 
s
;

56 
¨gp
;

58 i‡(
	`io˘l
(
s
, 
SIOCATMARK
, &
¨gp
) == -1)

61  
¨gp
 == 0 ? 0 : 1;

62 
	}
}

	@libscompat/strlcpy.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

34 
size_t


35 
	$°æ˝y
(*
d°
, c⁄° *
§c
, 
size_t
 
siz
)

37 *
d
 = 
d°
;

38 c⁄° *
s
 = 
§c
;

39 
size_t
 
n
 = 
siz
;

42 i‡(
n
 != 0 && --n != 0) {

44 i‡((*
d
++ = *
s
++) == 0)

46 } --
n
 != 0);

50 i‡(
n
 == 0) {

51 i‡(
siz
 != 0)

52 *
d
 = '\0';

53 *
s
++)

57 (
s
 - 
§c
 - 1);

58 
	}
}

87 
size_t


88 
	$°æˇt
(*
d°
, c⁄° *
§c
, 
size_t
 
siz
)

90 *
d
 = 
d°
;

91 c⁄° *
s
 = 
§c
;

92 
size_t
 
n
 = 
siz
;

93 
size_t
 
dÀn
;

96 
n
-- !0 && *
d
 != '\0')

97 
d
++;

98 
dÀn
 = 
d
 - 
d°
;

99 
n
 = 
siz
 - 
dÀn
;

101 i‡(
n
 == 0)

102 (
dÀn
 + 
	`°æí
(
s
));

103 *
s
 != '\0') {

104 i‡(
n
 != 1) {

105 *
d
++ = *
s
;

106 
n
--;

108 
s
++;

110 *
d
 = '\0';

112 (
dÀn
 + (
s
 - 
§c
));

113 
	}
}

	@libscompat/strvis.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

39 
	~"vis_com∑t.h
"

41 
	#iso˘Æ
(
c
) \

42 ((()(
c
)Ë>'0' && (()(c)Ë<'7')

	)

43 
	#isvisibÀ
(
c
) \

44 ((()(
c
Ë<
UCHAR_MAX
 && 
	`ißscii
(()(c)) && \

45 (((
c
) != '*' && (c) != '?' && (c) != '[' && (c) != '#') || \

46 (
Êag
 & 
VIS_GLOB
Ë=0Ë&& 
	`isgøph
(()(
c
))) || \

47 ((
Êag
 & 
VIS_SP
Ë=0 && (
c
) == ' ') || \

48 ((
Êag
 & 
VIS_TAB
Ë=0 && (
c
) == '\t') || \

49 ((
Êag
 & 
VIS_NL
Ë=0 && (
c
) == '\n') || \

50 ((
Êag
 & 
VIS_SAFE
Ë&& ((
c
) == '\b' || \

51 (
c
) == '\007' || (c) == '\r' || \

52 
	`isgøph
(()(
c
)))))

	)

58 
	$vis
(*
d°
, 
c
, 
Êag
, 
√xtc
)

67 c⁄° 
åunˇã
 = ()
c
;

68 
c
 = 
åunˇã
;

70 i‡(
	`isvisibÀ
(
c
)) {

71 *
d°
++ = 
c
;

72 i‡(
c
 ='\\' && (
Êag
 & 
VIS_NOSLASH
) == 0)

73 *
d°
++ = '\\';

74 *
d°
 = '\0';

75  (
d°
);

78 i‡(
Êag
 & 
VIS_CSTYLE
) {

79 
c
) {

81 *
d°
++ = '\\';

82 *
d°
++ = 'n';

83 
d⁄e
;

85 *
d°
++ = '\\';

86 *
d°
++ = 'r';

87 
d⁄e
;

89 *
d°
++ = '\\';

90 *
d°
++ = 'b';

91 
d⁄e
;

93 *
d°
++ = '\\';

94 *
d°
++ = 'a';

95 
d⁄e
;

97 *
d°
++ = '\\';

98 *
d°
++ = 'v';

99 
d⁄e
;

101 *
d°
++ = '\\';

102 *
d°
++ = 't';

103 
d⁄e
;

105 *
d°
++ = '\\';

106 *
d°
++ = 'f';

107 
d⁄e
;

109 *
d°
++ = '\\';

110 *
d°
++ = 's';

111 
d⁄e
;

113 *
d°
++ = '\\';

114 *
d°
++ = '0';

115 i‡(
	`iso˘Æ
(
√xtc
)) {

116 *
d°
++ = '0';

117 *
d°
++ = '0';

119 
d⁄e
;

122 i‡(((
c
 & 0177Ë=' 'Ë|| (
Êag
 & 
VIS_OCTAL
) ||

123 ((
Êag
 & 
VIS_GLOB
Ë&& (
c
 == '*' || c == '?' || c == '[' || c == '#'))) {

124 *
d°
++ = '\\';

125 *
d°
++ = (()
c
 >> 6 & 07) + '0';

126 *
d°
++ = (()
c
 >> 3 & 07) + '0';

127 *
d°
++ = (()
c
 & 07) + '0';

128 
d⁄e
;

130 i‡((
Êag
 & 
VIS_NOSLASH
) == 0)

131 *
d°
++ = '\\';

132 i‡(
c
 & 0200) {

133 
c
 &= 0177;

134 *
d°
++ = 'M';

136 i‡(
	`is˙ål
(()
c
)) {

137 *
d°
++ = '^';

138 i‡(
c
 == 0177)

139 *
d°
++ = '?';

141 *
d°
++ = 
c
 + '@';

143 *
d°
++ = '-';

144 *
d°
++ = 
c
;

146 
d⁄e
:

147 *
d°
 = '\0';

148  (
d°
);

149 
	}
}

165 
	$°rvis
(*
d°
, c⁄° *
§c
, 
Êag
)

167 
c
;

168 *
°¨t
;

170 
°¨t
 = 
d°
; (
c
 = *
§c
);)

171 
d°
 = 
	`vis
(d°, 
c
, 
Êag
, *++
§c
);

172 *
d°
 = '\0';

173  (
d°
 - 
°¨t
);

174 
	}
}

177 
	$°∫vis
(*
d°
, c⁄° *
§c
, 
size_t
 
siz
, 
Êag
)

179 *
°¨t
, *
íd
;

180 
tbuf
[5];

181 
c
, 
i
;

183 
i
 = 0;

184 
°¨t
 = 
d°
, 
íd
 = sèπ + 
siz
 - 1; (
c
 = *
§c
) && dst <Énd; ) {

185 i‡(
	`isvisibÀ
(
c
)) {

186 
i
 = 1;

187 *
d°
++ = 
c
;

188 i‡(
c
 ='\\' && (
Êag
 & 
VIS_NOSLASH
) == 0) {

190 i‡(
d°
 < 
íd
)

191 *
d°
++ = '\\';

193 
d°
--;

194 
i
 = 2;

198 
§c
++;

200 
i
 = 
	`vis
(
tbuf
, 
c
, 
Êag
, *++
§c
) -Åbuf;

201 i‡(
d°
 + 
i
 <
íd
) {

202 
	`mem˝y
(
d°
, 
tbuf
, 
i
);

203 
d°
 +
i
;

205 
§c
--;

210 i‡(
siz
 > 0)

211 *
d°
 = '\0';

212 i‡(
d°
 + 
i
 > 
íd
) {

214 (
c
 = *
§c
))

215 
d°
 +
	`vis
(
tbuf
, 
c
, 
Êag
, *++
§c
) -Åbuf;

217  (
d°
 - 
°¨t
);

218 
	}
}

221 
	$°rvisx
(*
d°
, c⁄° *
§c
, 
size_t
 
Àn
, 
Êag
)

223 
c
;

224 *
°¨t
;

226 
°¨t
 = 
d°
; 
Àn
 > 1;Üen--) {

227 
c
 = *
§c
;

228 
d°
 = 
	`vis
(d°, 
c
, 
Êag
, *++
§c
);

230 i‡(
Àn
)

231 
d°
 = 
	`vis
(d°, *
§c
, 
Êag
, '\0');

232 *
d°
 = '\0';

233  (
d°
 - 
°¨t
);

234 
	}
}

	@libscompat/timers.h

2 #i‡!
HAVE_TIMER_MACROS


34 
	#timîadd
(
tvp
, 
uvp
, 
vvp
) \

36 (
vvp
)->
tv_£c
 = (
tvp
)->tv_£¯+ (
uvp
)->tv_sec; \

37 (
vvp
)->
tv_u£c
 = (
tvp
)->tv_u£¯+ (
uvp
)->tv_usec; \

38 i‡((
vvp
)->
tv_u£c
 >= 1000000) { \

39 (
vvp
)->
tv_£c
++; \

40 (
vvp
)->
tv_u£c
 -= 1000000; \

42 } 0)

	)

44 
	#timîsub
(
tvp
, 
uvp
, 
vvp
) \

46 (
vvp
)->
tv_£c
 = (
tvp
)->tv_£¯- (
uvp
)->tv_sec; \

47 (
vvp
)->
tv_u£c
 = (
tvp
)->tv_u£¯- (
uvp
)->tv_usec; \

48 i‡((
vvp
)->
tv_u£c
 < 0) { \

49 (
vvp
)->
tv_£c
--; \

50 (
vvp
)->
tv_u£c
 += 1000000; \

52 } 0)

	)

	@libscompat/vis_compat.h

2 #i‡
HAVE_STRVIS


3 
	~<vis.h
>

39 #i‚de‡
_VIS_H_


40 
	#_VIS_H_


	)

45 
	#VIS_OCTAL
 0x01

	)

46 
	#VIS_CSTYLE
 0x02

	)

52 
	#VIS_SP
 0x04

	)

53 
	#VIS_TAB
 0x08

	)

54 
	#VIS_NL
 0x10

	)

55 
	#VIS_WHITE
 (
VIS_SP
 | 
VIS_TAB
 | 
VIS_NL
)

	)

56 
	#VIS_SAFE
 0x20

	)

61 
	#VIS_NOSLASH
 0x40

	)

62 
	#VIS_GLOB
 0x100

	)

67 
	#UNVIS_VALID
 1

	)

68 
	#UNVIS_VALIDPUSH
 2

	)

69 
	#UNVIS_NOCHAR
 3

	)

70 
	#UNVIS_SYNBAD
 -1

	)

71 
	#UNVIS_ERROR
 -2

	)

76 
	#UNVIS_END
 1

	)

79 
	~<sys/cdefs.h
>

80 
	g__BEGIN_DECLS


83 *
vis
(*, , , );

84 
°rvis
(*, const *, );

85 
	$°∫vis
(*, c⁄° *, 
size_t
, )

86 
	`__ATTRIBUTE__
 ((
	`__BOUNDED__
(
__°rög__
,1,3)));

87 
	$°rvisx
(*, c⁄° *, 
size_t
, )

88 
	`__ATTRIBUTE__
 ((
	`__BOUNDED__
(
__°rög__
,1,3)));

89 
	`°runvis
(*, const *);

91 
	`unvis
(*, , *, );

92 
ssize_t
 
	$°∫unvis
(*, c⁄° *, 
size_t
)

93 
	`__ATTRIBUTE__
 ((
	`__BOUNDED__
(
__°rög__
,1,3)));

97 
__END_DECLS


	@libscompat/vsyslog.c

3 #ifde‡
HAVE_CONFIG_H


4 
	~"autoc⁄f.h
"

7 
	~"osdï.h
"

9 #unde‡
vsy¶og


42 #i‡
deföed
(
LIBC_SCCS
Ë&& !deföed(
löt
)

43 
	grcsid
[] = "$OpenBSD: syslog.c,v 1.8 1998/03/19 00:30:03 millert Exp $";

47 
	$vsy¶og
(
¥i
, 
fmt
, 
≠
)

48 
¥i
;

49 c⁄° *
fmt
;

50 
va_li°
 
≠
;

52 
ch
, *
t
;

54 
ßved_î∫o
;

55 
	#TBUF_LEN
 2048

	)

56 
	#FMT_LEN
 1024

	)

57 
tbuf
[
TBUF_LEN
], 
fmt_˝y
[
FMT_LEN
];

58 
fmt_À·
, 
¥Àn
;

60 
ßved_î∫o
 = 
î∫o
;

68 
t
 = 
fmt_˝y
, 
fmt_À·
 = 
FMT_LEN
; (
ch
 = *
fmt
); ++fmt) {

69 i‡(
ch
 ='%' && 
fmt
[1] == 'm') {

70 ++
fmt
;

71 
¥Àn
 = 
	`¢¥ötf
(
t
, 
fmt_À·
, "%s",

72 
	`°ªº‹
(
ßved_î∫o
));

73 i‡(
¥Àn
 >
fmt_À·
)

74 
¥Àn
 = 
fmt_À·
 - 1;

75 
t
 +
¥Àn
;

76 
fmt_À·
 -
¥Àn
;

78 i‡(
fmt_À·
 > 1) {

79 *
t
++ = 
ch
;

80 
fmt_À·
--;

84 *
t
 = '\0';

86 
¥Àn
 = 
	`v¢¥ötf
(
tbuf
, 
TBUF_LEN
, 
fmt_˝y
, 
≠
);

88 
	`sy¶og
(
¥i
, "%s", 
tbuf
);

91 
	}
}

	@sockd/accesscheck.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	$u£rm©ch
(
auth
, 
u£æi°
)

52 c⁄° 
authmëhod_t
 *
auth
;

53 c⁄° 
löked«me_t
 *
u£æi°
;

56 c⁄° *
«me
;

58 i‡((
«me
 = 
	`auth«me
(
auth
)Ë=
NULL
)

62 i‡(
	`°rcmp
(
«me
, 
u£æi°
->name) == 0)

64 (
u£æi°
 = u£æi°->
√xt
Ë!
NULL
);

66 i‡(
u£æi°
 =
NULL
)

69 
	}
}

72 
	$groupm©ch
(
auth
, 
grou∂i°
)

73 c⁄° 
authmëhod_t
 *
auth
;

74 c⁄° 
löked«me_t
 *
grou∂i°
;

76 c⁄° *
fun˘i⁄
 = "groupmatch()";

77 c⁄° *
u£∫ame
;

78 
∑sswd
 *
pw
;

79 
group
 *
grou≥¡
;

81 
	`SASSERTX
(
grou∂i°
 !
NULL
);

83 i‡((
u£∫ame
 = 
	`auth«me
(
auth
)Ë=
NULL
)

91 i‡((
pw
 = 
	`gëpw«m
(
u£∫ame
)Ë!
NULL


92 && (
grou≥¡
 = 
	`gëgrgid
(
pw
->
pw_gid
)Ë!
NULL
) {

93 c⁄° 
löked«me_t
 *
li°ít
 = 
grou∂i°
;

96 i‡(
	`°rcmp
(
grou≥¡
->
gr_«me
, 
li°ít
->
«me
) == 0)

98 (
li°ít
 =Üi°ít->
√xt
Ë!
NULL
);

101 i‡(
pw
 =
NULL
)

102 
	`¶og
(
LOG_DEBUG
, "%s: unknow¿u£∫amê\"%s\"", 
fun˘i⁄
, 
u£∫ame
);

103 i‡(
grou≥¡
 =
NULL
)

104 
	`¶og
(
LOG_DEBUG
, "%s: unknownÖrimary groupid %ld",

105 
fun˘i⁄
, ()
pw
->
pw_gid
);

113 **
grou≤ame
;

115 i‡((
grou≥¡
 = 
	`gëg∫am
(
grou∂i°
->
«me
)Ë=
NULL
) {

116 
	`sw¨n
("%s: unknow¿grou≤amê\"%s\"", 
fun˘i⁄
, 
grou∂i°
->
«me
);

120 
grou≤ame
 = 
grou≥¡
->
gr_mem
;

122 *
grou≤ame
 !
NULL
) {

123 i‡(
	`°rcmp
(
u£∫ame
, *
grou≤ame
) == 0)

126 ++
grou≤ame
;

128 } (
grou∂i°
 = grou∂i°->
√xt
Ë!
NULL
);

131 
	}
}

133 #i‡
HAVE_LDAP


135 
	$ld≠groupm©ch
(
auth
, 
ruÀ
)

136 c⁄° 
authmëhod_t
 *
auth
;

137 c⁄° 
ruÀ_t
 *
ruÀ
;

139 c⁄° *
fun˘i⁄
 = "ldapgroupmatch()";

140 c⁄° 
löked«me_t
 *
grou∂i°
;

141 c⁄° *
u£∫ame
;

142 *
u£rdomaö
, *
groupdomaö
;

143 
ªtvÆ
;

145 i‡((
u£∫ame
 = 
	`auth«me
(
auth
)Ë=
NULL
)

148 #i‡!
HAVE_GSSAPI


149 i‡(!
ruÀ
->
°©e
.
ld≠
.
ld≠uæ
)

150 
	`SERRX
(
ruÀ
->
°©e
.
ld≠
.
ld≠uæ
 !
NULL
);

153 i‡((
u£rdomaö
 = 
	`°rchr
(
u£∫ame
, '@')Ë!
NULL
)

154 ++
u£rdomaö
;

156 i‡(
u£rdomaö
 =
NULL
 && *
ruÀ
->
°©e
.
ld≠
.
domaö
 =
NUL
 &&ÑuÀ->°©e.ld≠.
ld≠uæ
 == NULL) {

157 
	`¶og
(
LOG_DEBUG
, "%s: cannot checkÜdap group membership for user %s: "

159 
fun˘i⁄
, 
u£∫ame
);

163 i‡((
ªtvÆ
 = 
	`ld≠_u£r_is_ˇched
(
u£∫ame
)) >= 0)

164  
ªtvÆ
;

167 
grou∂i°
 = 
ruÀ
->
ld≠group
;

169 
grou≤ame
[
MAXNAMELEN
];

171 
	`¶og
(
LOG_DEBUG
, "%s: checking if user %s is member ofÜdap group %s",

172 
fun˘i⁄
, 
u£∫ame
, 
grou∂i°
->
«me
);

174 
	`STRCPY_ASSERTLEN
(
grou≤ame
, 
grou∂i°
->
«me
);

176 i‡((
groupdomaö
 = 
	`°rchr
(
grou≤ame
, '@')Ë!
NULL
) {

177 *
groupdomaö
 = 
NUL
;

178 ++
groupdomaö
;

181 i‡(
groupdomaö
 !
NULL
 && 
u£rdomaö
 != NULL) {

182 i‡(
	`°rcmp
(
groupdomaö
, 
u£rdomaö
) != 0

183 && 
	`°rcmp
(
groupdomaö
, "") != 0) {

184 
	`¶og
(
LOG_DEBUG
, "%s: userdomain \"%s\" doesÇot match groupdomain "

187 
fun˘i⁄
, 
u£rdomaö
, 
groupdomaö
);

192 i‡(
	`ld≠groupm©ches
(
u£∫ame
, 
u£rdomaö
, 
grou≤ame
, 
groupdomaö
, 
ruÀ
)){

193 
	`ˇche_ld≠_u£r
(
u£∫ame
, 1);

196 } (
grou∂i°
 = grou∂i°->
√xt
Ë!
NULL
);

198 
	`ˇche_ld≠_u£r
(
u£∫ame
, 0);

200 
	}
}

204 
	$ac˚sscheck
(
s
, 
auth
, 
§c
, 
d°
, 
emsg
, 
emsgsize
)

205 
s
;

206 
authmëhod_t
 *
auth
;

207 c⁄° 
sockaddr_°‹age
 *
§c
, *
d°
;

208 *
emsg
;

209 
size_t
 
emsgsize
;

211 c⁄° *
fun˘i⁄
 = "accesscheck()";

212 
§c°r
[
MAXSOCKADDRSTRING
], 
d°°r
[(srcstr)];

213 
m©ch
, 
authªsu…isfixed
;

215 i‡(
sockscf
.
›ti⁄
.
debug
)

216 
	`¶og
(
LOG_DEBUG
, "%s: method: %s, %s -> %s ",

217 
fun˘i⁄
,

218 
	`mëhod2°rög
(
auth
->
mëhod
),

219 
§c
 =
NULL
 ?

220 "<unknown>" : 
	`sockaddr2°rög
(
§c
, 
§c°r
, (srcstr)),

221 
d°
 =
NULL
 ?

222 "<unknown>" : 
	`sockaddr2°rög
(
d°
, 
d°°r
, (dststr)));

233 i‡(
	`mëhodis£t
(
auth
->
mëhod
,áuth->
mëhodv
, (
size_t
Ôuth->
mëhodc
)) {

234 
	`¶og
(
LOG_DEBUG
, "%s: method %sálready checked, matches",

235 
fun˘i⁄
, 
	`mëhod2°rög
(
auth
->
mëhod
));

240 i‡(
	`mëhodis£t
(
auth
->
mëhod
,áuth->
badmëhodv
, (
size_t
Ôuth->
badmëhodc
)) {

241 
	`¢¥ötf
(
emsg
, 
emsgsize
,

244 
	`mëhod2°rög
(
auth
->
mëhod
));

246 
	`¶og
(
LOG_DEBUG
, "%s: method %sálready checked, doesÇot match",

247 
fun˘i⁄
, 
	`mëhod2°rög
(
auth
->
mëhod
));

252 
m©ch
 = 0;

254 
auth
->
mëhod
) {

259 
AUTHMETHOD_NONE
:

260 #i‡
HAVE_GSSAPI


261 
AUTHMETHOD_GSSAPI
:

263 
m©ch
 = 1;

266 
AUTHMETHOD_UNAME
:

267 i‡(
	`∑ssw‹dcheck
((c⁄° *)
auth
->
md©a
.
u«me
.
«me
,

268 (c⁄° *)
auth
->
md©a
.
u«me
.
∑ssw‹d
,

269 
emsg
,

270 
emsgsize
) == 0)

271 
m©ch
 = 1;

275 #i‡
HAVE_LIBWRAP


276 
AUTHMETHOD_RFC931
:

277 i‡(
	`∑ssw‹dcheck
((c⁄° *)
auth
->
md©a
.
rfc931
.
«me
,

278 
NULL
,

279 
emsg
,

280 
emsgsize
) == 0)

281 
m©ch
 = 1;

285 #i‡
HAVE_PAM


286 
AUTHMETHOD_PAM_ANY
:

287 
AUTHMETHOD_PAM_ADDRESS
:

288 
AUTHMETHOD_PAM_USERNAME
: {

289 #i‡
DIAGNOSTIC


290 c⁄° 
‰ìc


291 
	`‰ìdes¸ùt‹s
(
sockscf
.
›ti⁄
.
debug
 ? "°¨t" : 
NULL
, NULL);

294 i‡(
	`∑m_∑ssw‹dcheck
(
s
,

295 
§c
,

296 
d°
,

297 &
auth
->
md©a
.
∑m
,

298 
emsg
,

299 
emsgsize
) == 0)

300 
m©ch
 = 1;

302 #i‡
DIAGNOSTIC


303 i‡(
‰ìc


304 !
	`‰ìdes¸ùt‹s
(
sockscf
.
›ti⁄
.
debug
 ? "íd" : 
NULL
, NULL))

305 
	`sw¨nx
("%s:Üost %d file descriptor%s inÖam_passwordcheck()",

306 
fun˘i⁄
,

307 
‰ìc
 - 
	`‰ìdes¸ùt‹s
(
NULL
, NULL),

308 
‰ìc
 - 
	`‰ìdes¸ùt‹s
(
NULL
, NULL) == 1 ? "" : "s");

315 #i‡
HAVE_BSDAUTH


316 
AUTHMETHOD_BSDAUTH
: {

317 #i‡
DIAGNOSTIC


318 c⁄° 
‰ìc


319 
	`‰ìdes¸ùt‹s
(
sockscf
.
›ti⁄
.
debug
 ? "°¨t" : 
NULL
, NULL);

322 i‡(
	`bsdauth_∑ssw‹dcheck
(
s
,

323 
§c
,

324 
d°
,

325 &
auth
->
md©a
.
bsd
,

326 
emsg
,

327 
emsgsize
) == 0)

328 
m©ch
 = 1;

330 #i‡
DIAGNOSTIC


331 i‡(
‰ìc


332 !
	`‰ìdes¸ùt‹s
(
sockscf
.
›ti⁄
.
debug
 ? "íd" : 
NULL
, NULL))

333 
	`sw¨nx
("%s:Üost %d file descriptor%s in bsdauth_passwordcheck()",

334 
fun˘i⁄
,

335 
‰ìc
 - 
	`‰ìdes¸ùt‹s
(
NULL
, NULL),

336 
‰ìc
 - 
	`‰ìdes¸ùt‹s
(
NULL
, NULL) == 1 ? "" : "s");

343 
	`SERRX
(
auth
->
mëhod
);

352 
auth
->
mëhod
) {

353 #i‡
HAVE_PAM


354 
AUTHMETHOD_PAM_ANY
:

355 
AUTHMETHOD_PAM_ADDRESS
:

356 
AUTHMETHOD_PAM_USERNAME
:

357 i‡(*
sockscf
.
°©e
.
∑m£rvi˚«me
 =
NUL
)

358 
authªsu…isfixed
 = 0;

360 
authªsu…isfixed
 = 1;

364 #i‡
HAVE_BSDAUTH


365 
AUTHMETHOD_BSDAUTH
:

366 i‡(
sockscf
.
°©e
.
bsdauth°yÀ«me
 =
NULL
)

367 
authªsu…isfixed
 = 0;

369 
authªsu…isfixed
 = 1;

373 #i‡
HAVE_GSSAPI


374 
AUTHMETHOD_GSSAPI
:

375 i‡(*
sockscf
.
°©e
.
gsßpi£rvi˚«me
 =
NUL


376 || *
sockscf
.
°©e
.
gsßpikeyèb
 =
NUL
)

377 
authªsu…isfixed
 = 0;

379 
authªsu…isfixed
 = 1;

383 
AUTHMETHOD_NONE
:

384 
AUTHMETHOD_UNAME
:

385 
AUTHMETHOD_RFC931
:

386 
authªsu…isfixed
 = 1;

390 
	`SERRX
(
auth
->
mëhod
);

393 i‡(
authªsu…isfixed
) {

394 i‡(
m©ch
) {

395 
	`SASSERTX
(
auth
->
mëhodc
 + 1 <
	`ELEMENTS
◊uth->
mëhodv
));

396 
auth
->
mëhodv
[auth->
mëhodc
++] =áuth->
mëhod
;

399 
	`SASSERTX
(
auth
->
badmëhodc
 + 1 <
	`ELEMENTS
◊uth->
badmëhodv
));

400 
auth
->
badmëhodv
[auth->
badmëhodc
++] =áuth->
mëhod
;

415 i‡(
m©ch
)

416 
	`¶og
(
LOG_DEBUG
, "%s:áuthítiˇti⁄ m©ched", 
fun˘i⁄
);

418 
	`¶og
(
LOG_DEBUG
, "%s:Ço match foráuthentication%s %s",

419 
fun˘i⁄
,

420 
emsgsize
 > 0 ? ":" : "",

421 
emsgsize
 > 0 ? 
emsg
 : "");

423  
m©ch
;

424 
	}
}

	@sockd/auth_bsd.c

44 
	~"comm⁄.h
"

46 #i‡
HAVE_BSDAUTH


48 c⁄° 
	grcsid
[] =

51 
	~<logö_ˇp.h
>

52 
	~<bsd_auth.h
>

55 
	$bsdauth_∑ssw‹dcheck
(
s
, 
§c
, 
d°
, 
auth
, 
emsg
, 
emsgsize
)

56 
s
;

57 c⁄° 
sockaddr_°‹age
 *
§c
, *
d°
;

58 
authmëhod_bsd_t
 *
auth
;

59 *
emsg
;

60 
size_t
 
emsgsize
;

62 c⁄° *
fun˘i⁄
 = "bsdauth_passwordcheck()";

63 
∑ssw‹d
[
MAXPWLEN
], *
°yÀ
;

64 
vi¢ame
[
MAXNAMELEN
 * 4];

66 
rc
;

68 i‡(*
auth
->
°yÀ
 =
NUL
)

69 
°yÀ
 = 
NULL
;

71 
°yÀ
 = 
auth
->style;

74 
	`°∫˝y
(
∑ssw‹d
, (*)
auth
->password, (password) - 1);

75 
∑ssw‹d
[’assw‹dË- 1] = 
NUL
;

77 
	`°r2vis
((*)
auth
->
«me
,

78 
	`°æí
((*)
auth
->
«me
),

79 
vi¢ame
, (visname));

81 
	`¶og
(
LOG_DEBUG
, "%s: bsdauth styleÅo use for user \"%s\": %s",

82 
fun˘i⁄
, 
vi¢ame
, 
°yÀ
 =
NULL
 ? "default" : style);

88 
	`sockd_¥iv
(
SOCKD_PRIV_BSDAUTH
, 
PRIV_ON
);

89 
rc
 = 
	`auth_u£rokay
((*)
auth
->
«me
, 
°yÀ
, "auth-sockd", 
∑ssw‹d
);

90 
	`sockd_¥iv
(
SOCKD_PRIV_BSDAUTH
, 
PRIV_OFF
);

92 i‡(
rc
 == 0) {

93 
	`¶og
(
LOG_DEBUG
, "%s: bsdauth method failed for user \"%s\": (%s)",

94 
fun˘i⁄
, 
vi¢ame
, 
°yÀ
 =
NULL
 ? "default" : style);

96 
	`¢¥ötf
(
emsg
, 
emsgsize
, "%s:áuth_userokay failed: %s",

97 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

103 
	}
}

	@sockd/auth_pam.c

50 
	~"comm⁄.h
"

52 #i‡
HAVE_PAM


54 c⁄° 
	grcsid
[] =

58 
∑m_c⁄vîßti⁄
(
msgc
, c⁄° 
∑m_mesßge
 **
msgv
,

59 
∑m_ª•⁄£
 **
r•v
, *
authd©a
);

66 
	$∑m_∑ssw‹dcheck
(
s
, 
§c
, 
d°
, 
auth
, 
emsg
, 
emsgsize
)

67 
s
;

68 c⁄° 
sockaddr_°‹age
 *
§c
, *
d°
;

69 c⁄° 
authmëhod_∑m_t
 *
auth
;

70 *
emsg
;

71 
size_t
 
emsgsize
;

73 c⁄° *
fun˘i⁄
 = "pam_passwordcheck()";

74 
authmëhod_∑m_t
 
authd©a
 = *
auth
;

75 
∑m_c⁄v
 
∑mc⁄v
;

76 
∑m_h™dÀ_t
 *
∑mh
;

77 
size_t
 
i
;

78 
§c°r
[
MAXSOCKADDRSTRING
], 
visbuf
[
MAXNAMELEN
 * 4];

79 
rc
;

87 
ôem
;

88 c⁄° *
ôem«me
;

89 c⁄° *
vÆue
;

90 
¥öèbÀ
;

92 } 
∑mvÆ
[] = {

93 { ()
PAM_CONV
, "PAM_CONV", &
∑mc⁄v
, 0 },

94 { ()
PAM_RHOST
, "PAM_RHOST",

95 
§c
 =
NULL
 ?

96 "" : 
	`sockaddr2°rög2
(
§c
, 0, 
§c°r
, (srcstr)), 1 },

97 { ()
PAM_USER
, "PAM_USER", (*
auth
->
«me
 =
NUL
) ?

98 
DEFAULT_PAM_USER
 : (c⁄° *)
auth
->
«me
, 1 },

99 { ()
PAM_RUSER
, "PAM_RUSER", 
DEFAULT_PAM_RUSER
, 1 },

102 
	`¶og
(
LOG_DEBUG
, "%s: src %s, user \"%s\", servicename \"%s\",Émsgsize %ld",

103 
fun˘i⁄
,

104 
§c
 =
NULL
 ? "N/A" : 
	`sockaddr2°rög
(src, NULL, 0),

105 
	`°r2vis
((c⁄° *)
auth
->
«me
,

106 
	`°æí
((c⁄° *)
auth
->
«me
),

107 
visbuf
,

108 (
visbuf
)),

109 
auth
->
£rvi˚«me
,

110 ()
emsgsize
);

112 i‡(
§c
 =
NULL
) {

113 
	`¢¥ötf
(
emsg
, 
emsgsize
, "%s: NULL sr¯addªss:ÇŸ suµ‹ãd", 
fun˘i⁄
);

129 
∑mc⁄v
.
c⁄v
 = 
∑m_c⁄vîßti⁄
;

130 
∑mc⁄v
.
≠pd©a_±r
 = &
authd©a
;

132 
	`sockd_¥iv
(
SOCKD_PRIV_PAM
, 
PRIV_ON
);

133 
rc
 = 
	`∑m_°¨t
(
auth
->
£rvi˚«me
, 
NULL
, &
∑mc⁄v
, &
∑mh
);

134 
	`sockd_¥iv
(
SOCKD_PRIV_PAM
, 
PRIV_OFF
);

136 i‡(
rc
 !()
PAM_SUCCESS
) {

137 
	`¢¥ötf
(
emsg
, 
emsgsize
, "pam_start() failed: %s",

138 
	`∑m_°ªº‹
(
∑mh
, 
rc
));

143 
i
 = 0; i < 
	`ELEMENTS
(
∑mvÆ
); ++i) {

144 i‡(
∑mvÆ
[
i
].
¥öèbÀ
) {

145 
	`°r2vis
((c⁄° *)
∑mvÆ
[
i
].
vÆue
,

146 
	`°æí
((c⁄° *)
∑mvÆ
[
i
].
vÆue
),

147 
visbuf
,

148 (
visbuf
));

150 
	`¶og
(
LOG_DEBUG
, "%s: setting item \"%s\"Åo value \"%s\"",

151 
fun˘i⁄
, 
∑mvÆ
[
i
].
ôem«me
, 
visbuf
);

154 
	`¶og
(
LOG_DEBUG
, "%s: sëtög iãm %s", 
fun˘i⁄
, 
∑mvÆ
[
i
].
ôem«me
);

156 i‡((
rc
 = 
	`∑m_£t_ôem
(
∑mh
, 
∑mvÆ
[
i
].
ôem
,ÖamvÆ[i].
vÆue
))

157 !()
PAM_SUCCESS
) {

158 
	`¢¥ötf
(
emsg
, 
emsgsize
, "pam_set_item(%s)Åo \"%s\" failed: %s",

159 
∑mvÆ
[
i
].
ôem«me
, 
visbuf
, 
	`∑m_°ªº‹
(
∑mh
, 
rc
));

161 
	`∑m_íd
(
∑mh
, 
rc
);

166 
	`sockd_¥iv
(
SOCKD_PRIV_PAM
, 
PRIV_ON
);

168 i‡((
rc
 = 
	`∑m_authítiˇã
(
∑mh
, 0)Ë!()
PAM_SUCCESS
) {

169 
	`sockd_¥iv
(
SOCKD_PRIV_PAM
, 
PRIV_OFF
);

171 
	`¶og
(
LOG_DEBUG
, "%s:Öam_authenticate() failed: %s",

172 
fun˘i⁄
, 
	`∑m_°ªº‹
(
∑mh
, 
rc
));

174 
	`¢¥ötf
(
emsg
, 
emsgsize
, "pam_authenticate() for user \"%s\" failed: %s",

175 *
auth
->
«me
 =
NUL
 ?

176 "<nÿu£∏•ecifõd>" : 
	`°r2vis
((c⁄° *)
auth
->
«me
,

177 
	`°æí
((c⁄° *)
auth
->
«me
),

178 
visbuf
,

179 (
visbuf
)),

180 
	`∑m_°ªº‹
(
∑mh
, 
rc
));

182 
	`∑m_íd
(
∑mh
, 
rc
);

187 
rc
 = 
	`∑m_ac˘_mgmt
(
∑mh
, 
PAM_SILENT
);

189 
	`sockd_¥iv
(
SOCKD_PRIV_PAM
, 
PRIV_OFF
);

191 i‡(
rc
 !
PAM_SUCCESS
) {

192 
	`¶og
(
LOG_DEBUG
, "%s:Öam_acct_mgmt() failed: %s",

193 
fun˘i⁄
, 
	`∑m_°ªº‹
(
∑mh
, 
rc
));

195 
	`¢¥ötf
(
emsg
, 
emsgsize
, "∑m_ac˘_mgmt(): %s", 
	`∑m_°ªº‹
(
∑mh
, 
rc
));

197 
	`∑m_íd
(
∑mh
, 
rc
);

201 i‡((
rc
 = 
	`∑m_íd
(
∑mh
,Ñc)Ë!()
PAM_SUCCESS
)

202 
	`sw¨nx
("%s: strange ...Öam_end() failed: %s",

203 
fun˘i⁄
, 
	`∑m_°ªº‹
(
∑mh
, 
rc
));

205 
	`¶og
(
LOG_DEBUG
, "%s:Öamáuthítiˇti⁄ suc˚eded", 
fun˘i⁄
);

207 
	}
}

210 
	$∑m_c⁄vîßti⁄
(
msgc
, 
msgv
, 
r•v
, 
authd©a
)

211 
msgc
;

212 c⁄° 
∑m_mesßge
 **
msgv
;

213 
∑m_ª•⁄£
 **
r•v
;

214 *
authd©a
;

216 c⁄° 
authmëhod_∑m_t
 *
auth
 = 
authd©a
;

217 c⁄° *
fun˘i⁄
 = "pam_conversation()";

218 
i
, 
rc
;

220 i‡(
r•v
 =
NULL
 || 
msgv
 =NULL || 
auth
 =NULL || 
msgc
 < 1) {

221 
	`sw¨nx
("%s: cÆÀd wôh invÆid/u√x≥˘ed i≈ut", 
fun˘i⁄
);

222  ()
PAM_CONV_ERR
;

225 i‡(((*
r•v
Ë
	`mÆloc
(
msgc
 * (
∑m_ª•⁄£
))Ë=
NULL
) {

226 
	`sw¨n
("%s: malloc(%d * %lu)",

227 
fun˘i⁄
, 
msgc
, ()(
∑m_ª•⁄£
));

229  ()
PAM_CONV_ERR
;

233 
i
 = 0; i < 
msgc
; ++i) {

234 (*
r•v
)[
i
].
ª•_ªtcode
 = 0;

235 (*
r•v
)[
i
].
ª•
 = 
NULL
;

238 
rc
 = ()
PAM_SUCCESS
;

239 
i
 = 0; i < 
msgc
; ++i) {

240 
	`¶og
(
LOG_DEBUG
, "%s: msg_°yÀ = %d", 
fun˘i⁄
, 
msgv
[
i
]->
msg_°yÀ
);

242 
msgv
[
i
]->
msg_°yÀ
) {

243 
PAM_PROMPT_ECHO_OFF
:

244 i‡(((*
r•v
)[
i
].
ª•
 = 
	`°rdup
((c⁄° *)
auth
->
∑ssw‹d
))

245 =
NULL
) {

246 
	`sw¨n
("%s: strdup() ofÖassword,Üength %lu, failed",

247 
fun˘i⁄
,

248 ()
	`°æí
((c⁄° *)
auth
->
∑ssw‹d
));

250 
rc
 = ()
PAM_CONV_ERR
;

254 
PAM_ERROR_MSG
:

255 
	`¶og
(
LOG_INFO
, "%s: gotáÖamÉrror msg: %s",

256 
fun˘i⁄
, 
msgv
[
i
]->
msg
);

259 
PAM_TEXT_INFO
:

265 
	`¶og
(
LOG_DEBUG
, "%s: got unexpected PAM_TEXT_INFO: \"%s\"",

266 
fun˘i⁄
, 
msgv
[
i
]->
msg
);

270 
	`sw¨nx
("%s: unknown msg_style %d, ignored ...",

271 
fun˘i⁄
, 
msgv
[
i
]->
msg_°yÀ
);

276 i‡(
rc
 !()
PAM_SUCCESS
) {

277 
i
 = 0; i < 
msgc
; ++i)

278 
	`‰ì
((*
r•v
)[
i
].
ª•
);

280 
	`‰ì
(*
r•v
);

283  
rc
;

284 
	}
}

	@sockd/auth_password.c

45 
	~"comm⁄.h
"

47 #i‡
HAVE_SHADOW_H
 && 
HAVE_GETSPNAM


48 
	~<shadow.h
>

51 c⁄° 
	grcsid
[] =

55 
sockd_gë∑ssw‹dhash
(c⁄° *
logö
, *
pw
, c⁄° 
size_t
 
pwsize
,

56 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

66 
	$∑ssw‹dcheck
(
«me
, 
˛óπexçw
, 
emsg
, 
emsgÀn
)

67 c⁄° *
«me
;

68 c⁄° *
˛óπexçw
;

69 *
emsg
;

70 
size_t
 
emsgÀn
;

72 c⁄° *
fun˘i⁄
 = "passwordcheck()";

73 c⁄° *
p
;

74 
vis°rög
[
MAXNAMELEN
 * 4], 
pwhash
[
MAXPWLEN
], *
¸y±ed
;

75 
rc
;

77 
	`¶og
(
LOG_DEBUG
, "%s:Çame = %s,Öassword = %s",

78 
fun˘i⁄
,

79 
	`°r2vis
(
«me
,

80 
	`°æí
(
«me
),

81 
vis°rög
,

82 (
vis°rög
)),

83 
˛óπexçw
 =
NULL
 ? "<empty>" : "<cleartextpw>");

85 i‡(
˛óπexçw
 =
NULL
) {

91 i‡(
	`gëpw«m
(
«me
Ë=
NULL
) {

92 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "no user \"%s\" found in systemÖassword file",

93 
	`°r2vis
(
«me
,

94 
	`°æí
(
«me
),

95 
vis°rög
,

96 (
vis°rög
)));

111 
	`sockd_¥iv
(
SOCKD_PRIV_FILE_READ
, 
PRIV_ON
);

112 
p
 = 
	`sockd_gë∑ssw‹dhash
(
«me
,

113 
pwhash
,

114 (
pwhash
),

115 
emsg
,

116 
emsgÀn
);

117 
	`sockd_¥iv
(
SOCKD_PRIV_FILE_READ
, 
PRIV_OFF
);

119 i‡(
p
 =
NULL
)

126 
¸y±ed
 = 
	`¸y±
(
˛óπexçw
, 
pwhash
);

128 i‡(
¸y±ed
 =
NULL
) {

129 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

131 
	`°r2vis
(
«me
,

132 
	`°æí
(
«me
),

133 
vis°rög
,

134 (
vis°rög
)),

135 
	`°ªº‹
(
î∫o
));

137 
	`sw¨nx
("%s: Så™ge. Thi†shouldÇŸ h≠≥n: %s", 
fun˘i⁄
, 
emsg
);

138 
rc
 = -1;

141 i‡(
	`°rcmp
(
¸y±ed
, 
pwhash
) == 0)

142 
rc
 = 0;

144 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

146 
	`°r2vis
(
«me
,

147 
	`°æí
(
«me
),

148 
vis°rög
,

149 (
vis°rög
)));

150 
rc
 = -1;

154 
	`bzîo
(
pwhash
, (pwhash));

155  
rc
;

156 
	}
}

159 
	$sockd_gë∑ssw‹dhash
(
logö
, 
pw
, 
pwsize
, 
emsg
, 
emsgÀn
)

160 c⁄° *
logö
;

161 *
pw
;

162 c⁄° 
size_t
 
pwsize
;

163 *
emsg
;

164 c⁄° 
size_t
 
emsgÀn
;

166 c⁄° *
fun˘i⁄
 = "socks_getencrypedpassword()";

167 c⁄° *
pw_db
 = 
NULL
;

168 c⁄° 
î∫o_s
 = 
î∫o
;

169 
vis°rög
[
MAXNAMELEN
 * 4];

171 #i‡
HAVE_GETSPNAM


172 
•wd
 *spwd;

174 i‡((
•wd
 = 
	`gë•«m
(
logö
)Ë!
NULL
)

175 
pw_db
 = 
•wd
->
•_pwdp
;

177 #ñi‡
HAVE_GETPRPWNAM


186 
∑sswd
 *
pwd
;

188 i‡((
pwd
 = 
	`gëpw«m
(
logö
)Ë!
NULL
)

189 
pw_db
 = 
pwd
->
pw_∑sswd
;

192 i‡(
pw_db
 =
NULL
) {

193 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

196 
	`°r2vis
(
logö
, 
	`°æí
÷ogö), 
vis°rög
, (visstring)),

197 
	`°ªº‹
(
î∫o
));

199  
NULL
;

202 i‡(
	`°æí
(
pw_db
Ë+ 1 > 
pwsize
) {

203 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

207 
fun˘i⁄
,

208 
	`°r2vis
(
logö
,

209 
	`°æí
(
logö
),

210 
vis°rög
,

211 (
vis°rög
)),

212 ()(
pwsize
 - 1),

213 ()
	`°æí
(
pw_db
));

215 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

216  
NULL
;

219 
	`°r˝y
(
pw
, 
pw_db
);

227 
î∫o
 = 
î∫o_s
;

229  
pw
;

230 
	}
}

	@sockd/cpu.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

50 
	$sockd_£t˝u£âögs
(
ﬁd
, 
√w
)

51 c⁄° 
˝u£âög_t
 *
ﬁd
;

52 c⁄° 
˝u£âög_t
 *
√w
;

54 #i‡
HAVE_SCHED_SETSCHEDULER
 || 
HAVE_SCHED_SETAFFINITY


55 c⁄° *
fun˘i⁄
 = "sockd_setcpusettings()";

56 
rc
;

58 #i‡
HAVE_SCHED_SETSCHEDULER


59 
	`SASSERTX
(
ﬁd
->
schedulög_is£t
);

60 
	`SASSERTX
(
√w
->
schedulög_is£t
);

62 
	`¶og
(
LOG_DEBUG
, "%s: old cpu schedulingÖolicy/priority: %s/%d,Çew: %s/%d",

63 
fun˘i⁄
,

64 
	`numîic2˝upﬁicy
(
ﬁd
->
pﬁicy
),

65 
ﬁd
->
∑øm
.
sched_¥i‹ôy
,

66 
	`numîic2˝upﬁicy
(
√w
->
pﬁicy
),

67 
√w
->
∑øm
.
sched_¥i‹ôy
);

69 i‡(
ﬁd
->
pﬁicy
 !
√w
->policy

70 || 
ﬁd
->
∑øm
.
sched_¥i‹ôy
 !
√w
->param.sched_priority) {

71 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

72 
rc
 = 
	`sched_£tscheduÀr
(0, 
√w
->
pﬁicy
, &√w->
∑øm
);

73 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

75 i‡(
rc
 != 0) {

76 
	`sw¨n
("%s: couldÇot change cpu schedulingÖolicy/priority from "

78 
fun˘i⁄
,

79 
	`numîic2˝upﬁicy
(
ﬁd
->
pﬁicy
),

80 
ﬁd
->
∑øm
.
sched_¥i‹ôy
,

81 
	`numîic2˝upﬁicy
(
√w
->
pﬁicy
),

82 
√w
->
∑øm
.
sched_¥i‹ôy
,

83 
sockscf
.
°©e
.
havïrivs
 ? "" : " (normally specialÖrivileges "

89 
sockscf
.
°©e
.
˝u
.
pﬁicy
 = 
√w
->policy;

90 
sockscf
.
°©e
.
˝u
.
∑øm
 = 
√w
->param;

94 #i‡
HAVE_SCHED_SETAFFINITY


95 i‡(
√w
->
afföôy_is£t
 && (
	`˝u_equÆ
(&
ﬁd
->
mask
, &new->mask) == 0)) {

96 c⁄° 
size_t
 
£tsize
 = 
	`˝u_gë_£tsize
();

97 c⁄° 
˝uc
 = 
	`sysc⁄f
(
_SC_NPROCESSORS_ONLN
);

98 
size_t
 
i
, 
˝us_u£d
, 
ﬁd˝us_u£d
, 
îr˝us_u£d
;

99 
˝us
[2048], 
ﬁd˝us
[(˝us)], 
îr˝us
[(cpus)];

101 i‡(
˝uc
 == -1)

102 
	`£º
("sysconf(_SC_NPROCESSORS_ONLN) failed");

104 *
˝us
 = *
ﬁd˝us
 = *
îr˝us
 = 
NUL
;

105 
˝us_u£d
 = 
ﬁd˝us_u£d
 = 
îr˝us_u£d
 = 0;

106 
i
 = 0; i < 
£tsize
; ++i) {

107 i‡(
	`˝u_is£t
(
i
, &
ﬁd
->
mask
)) {

108 
ﬁd˝us_u£d
 +
	`¢¥ötf
(&
ﬁd˝us
[oldcpus_used],

109 (
ﬁd˝us
Ë- 
ﬁd˝us_u£d
,

110 "%ld ", ()
i
);

113 i‡(
	`˝u_is£t
(
i
, &
√w
->
mask
)) {

114 
˝us_u£d
 +
	`¢¥ötf
(&
˝us
[cpus_used],

115 (
˝us
Ë- 
˝us_u£d
,

116 "%ld ", ()
i
);

118 i‡(
i
 + 1 >(
size_t
)
˝uc
)

119 
îr˝us_u£d
 +
	`¢¥ötf
(&
îr˝us
[errcpus_used],

120 (
îr˝us
Ë- 
îr˝us_u£d
,

121 "%ld ", ()
i
);

125 
	`¶og
(
LOG_DEBUG
, "%s: old cpuáffinity: %s,Çew: %s",

126 
fun˘i⁄
,

127 *
ﬁd˝us
 =
NUL
 ? "<none set>" : oldcpus,

128 *
˝us
 =
NUL
 ? "<none set>" : cpus);

130 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

131 
rc
 = 
	`˝u_£èfföôy
(0, (
√w
->
mask
), &new->mask);

132 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

134 i‡(
rc
 != 0) {

135 i‡(*
îr˝us
 !
NUL
)

136 
	`sw¨n
("%s: failedÅo setÇew cpuáffinity. Probably becauseÅhe "

140 
fun˘i⁄
, 
˝uc
, 
îr˝us
);

142 
	`sw¨n
("%s: failedÅo setÇew cpuáffinity using mask %s",

143 
fun˘i⁄
, 
	`˝u£t2°rög
(&
√w
->
mask
, 
NULL
, 0));

148 
sockscf
.
°©e
.
˝u
.
mask
 = 
√w
->mask;

154 #i‡
HAVE_PROCESSOR_BIND


158 
	}
}

	@sockd/cpuaffinity.c

44 c⁄° 
	grcsid
[] =

56 
	#_GNU_SOURCE


	)

58 
	~"comm⁄.h
"

60 
	~<sched.h
>

62 #i‡
HAVE_SCHED_SETAFFINITY


64 #i‡!
HAVE_CPU_EQUAL


66 
CPU_EQUAL
(c⁄° 
˝u_£t_t
 *
£t1
, c⁄° cpu_£t_à*
£t2
);

69 
	$CPU_EQUAL
(
£t1
, 
£t2
)

70 c⁄° 
˝u_£t_t
 *
£t1
;

71 c⁄° 
˝u_£t_t
 *
£t2
;

73 
size_t
 
i
;

75 
i
 = 0; i < 
	`˝u_gë_£tsize
(); i++)

76 i‡(
	`CPU_ISSET
(
i
, 
£t1
Ë!CPU_ISSET(i, 
£t2
))

80 
	}
}

83 
size_t


84 
	$˝u_gë_£tsize
()

86  
CPU_SETSIZE
;

87 
	}
}

90 
	$˝u_£t
(
˝u
, 
£t
)

91 c⁄° 
˝u
;

92 
˝u_£t_t
 *
£t
;

94 
	`CPU_SET
(
˝u
, 
£t
);

95 
	}
}

98 
	$˝u_zîo
(
£t
)

99 
˝u_£t_t
 *
£t
;

101 
	`CPU_ZERO
(
£t
);

102 
	}
}

105 
	$˝u_equÆ
(
£t1
, 
£t2
)

106 c⁄° 
˝u_£t_t
 *
£t1
;

107 c⁄° 
˝u_£t_t
 *
£t2
;

109  
	`CPU_EQUAL
(
£t1
, 
£t2
);

110 
	}
}

113 
	$˝u_is£t
(
˝u
, 
£t
)

114 c⁄° 
˝u
;

115 c⁄° 
˝u_£t_t
 *
£t
;

117  
	`CPU_ISSET
(
˝u
, 
£t
);

118 
	}
}

121 
	$˝u_gëafföôy
(
pid
, 
˝u£tsize
, 
mask
)

122 
pid_t
 
pid
;

123 
size_t
 
˝u£tsize
;

124 
˝u_£t_t
 *
mask
;

126  
	`sched_gëafföôy
(
pid
, 
˝u£tsize
, 
mask
);

127 
	}
}

130 
	$˝u_£èfföôy
(
pid
, 
˝u£tsize
, 
mask
)

131 
pid_t
 
pid
;

132 
size_t
 
˝u£tsize
;

133 c⁄° 
˝u_£t_t
 *
mask
;

135  
	`sched_£èfföôy
(
pid
, 
˝u£tsize
, 
mask
);

136 
	}
}

139 
	$sockd_˝u£t_isok
(
£t
)

140 c⁄° 
˝u_£t_t
 *
£t
;

142 c⁄° *
fun˘i⁄
 = "sockd_cpumask_isok()";

143 c⁄° 
˝us
 = 
	`sysc⁄f
(
_SC_NPROCESSORS_ONLN
);

144 c⁄° 
size_t
 
£tsize
 = 
	`˝u_gë_£tsize
();

145 
i
;

147 i‡(
˝us
 == -1)

148 
	`£º
("%s: sysc⁄f(_SC_NPROCESSORS_ONLNËÁûed", 
fun˘i⁄
);

150 
i
 = 0; i < ()
£tsize
; ++i)

151 i‡(
	`˝u_is£t
(
i
, 
£t
Ë&& i + 1 > 
˝us
)

155 
	}
}

	@sockd/cpupolicy.c

44 
	#_GNU_SOURCE


	)

46 
	~"comm⁄.h
"

48 
	~<sched.h
>

50 c⁄° 
	grcsid
[] =

53 #i‡
HAVE_SCHED_SETSCHEDULER


55 
˝upﬁicy_t
 
	g˝upﬁicõs
[] = {

56 #ifde‡
SCHED_OTHER


57 { 
SCHED_OTHER
, "other" },

59 #ifde‡
SCHED_FIFO


60 { 
SCHED_FIFO
, "fifo" },

62 #ifde‡
SCHED_FIFO2


63 { 
SCHED_FIFO2
, "fifo2" },

65 #ifde‡
SCHED_FIFO3


66 { 
SCHED_FIFO3
, "fifo3" },

68 #ifde‡
SCHED_FIFO4


69 { 
SCHED_FIFO4
, "fifo4" },

71 #ifde‡
SCHED_RR


72 { 
SCHED_RR
, "rr" },

74 #ifde‡
SCHED_IDLE


75 { 
SCHED_IDLE
, "idle" },

77 #ifde‡
SCHED_BATCH


78 { 
SCHED_BATCH
, "batch" },

80 { -1, 
NULL
 },

84 
	$˝upﬁicy2numîic
(*
«me
)

86 
i
;

88 
i
 = 0; 
˝upﬁicõs
[i].
«me
 !
NULL
; i++) {

89 i‡(
	`°rcmp
(
«me
, 
˝upﬁicõs
[
i
].name) == 0)

90  
˝upﬁicõs
[
i
].
vÆue
;

94 
	}
}

97 
	$numîic2˝upﬁicy
(
vÆue
)

99 
i
;

101 
i
 = 0; 
˝upﬁicõs
[i].
«me
 !
NULL
; i++) {

102 i‡(
vÆue
 =
˝upﬁicõs
[
i
].value)

103  
˝upﬁicõs
[
i
].
«me
;

107 
	}
}

	@sockd/dante_udp.c

45 
	~"comm⁄.h
"

46 
	~"c⁄fig_∑r£.h
"

48 c⁄° 
	grcsid
[] =

52 
udphódî_t
 *

53 
gëud±¨gë
(c⁄° *
buf
, c⁄° 
size_t
 
buÊí
, 
udphódî_t
 *
hódî
,

54 
size_t
 *
hódîÀn
, *
emsg
, c⁄° size_à
emsgÀn
);

69 
‰omaddr_as_ex≥˘ed
(
sockaddr_°‹age
 *
ex≥˘ed
,

70 c⁄° 
sockaddr_°‹age
 *
‰om
,

71 *
emsg
, 
size_t
 
emsgÀn
);

84 
øwsockë
;

86 
io°©us_t


87 
	$io_udp_˛õ¡2èrgë
(
c⁄åﬁ
, 
˛õ¡
, 
twŸ¨gës
, 
ˇuth
, 
°©e
,

88 
˛og
, 
dlog
, 
badfd
, 
∑ckëruÀ
, 
bwu£d
)

89 
sockd_io_dúe˘i⁄_t
 *
c⁄åﬁ
;

90 
sockd_io_dúe˘i⁄_t
 *
˛õ¡
;

91 
sockd_io_dúe˘i⁄_t
 *
twŸ¨gës
;

92 c⁄° 
authmëhod_t
 *
ˇuth
;

93 
c⁄√˘i⁄°©e_t
 *
°©e
;

94 *
badfd
;

95 
iﬁogaddr_t
 *
˛og
;

96 
iﬁogaddr_t
 *
dlog
;

97 
ruÀ_t
 *
∑ckëruÀ
;

98 
size_t
 *
bwu£d
;

106 c⁄° *
fun˘i⁄
 = "io_udp_client2target()";

107 
io°©us_t
 
io°©us
 = 
IO_NOERROR
;

108 
ud±¨gë_t
 *
èrgë
 = 
NULL
;

109 
ªcv‰om_öfo_t
 
ªcvÊags
;

110 
£ndto_öfo_t
 
£ndtoÊags
;

111 
udphódî_t
 
hódî
;

112 
sockaddr_°‹age
 
‰om
, 
èrgëaddr
;

113 
sockÀn_t
 
Àn
;

114 
ssize_t
 
w
, 
r
;

115 
size_t
 
hódîÀn
, 
∑ylﬂdÀn
, 
emsgÀn
;

116 
ho°a
[
MAXSOCKSHOSTSTRING
], 
ho°b
[MAXSOCKSHOSTSTRING], 
emsg
[2048],

117 
buf
[
SOCKD_BUFSIZE
 + (
udphódî_t
)], *
∑ylﬂd
;

118 
ßmë¨gë
, 
gaõº
,

119 
doc⁄√˘
 = 0,

120 
≥rmô
 = 0,

121 
icmp_ty≥
 = 
ICMP_TYPE_UNREACHABLE
,

122 
icmp_code
 = 
ICMP_CODE_UNREACHABLE_PORT
;

124 
ªcvÊags
.
side
 = 
INTERNALIF
;

125 
ªcvÊags
.
≥î
 = 
˛õ¡
->
øddr
;

126 
ªcvÊags
.
ty≥
 = 
SOCK_DGRAM
;

128 
Àn
 = (
‰om
);

129 i‡((
r
 = 
	`socks_ªcv‰om
(
˛õ¡
->
s
,

130 
buf
,

131 (
buf
),

133 &
‰om
,

134 &
Àn
,

135 &
ªcvÊags
,

136 &
˛õ¡
->
auth
)) == -1) {

137 i‡(
	`ERRNOISPREVIOUSPACKET
(
î∫o
)) {

150 
sockaddr_°‹age
 *
∑ckë§c
;

151 
sockaddr_°‹age
 *
ª˚ived⁄addr
;

152 c⁄° 
ﬁdcomm™d
 = 
°©e
->
comm™d
;

153 
°©e
->
comm™d
 = 
SOCKS_UDPREPLY
;

155 i‡(
twŸ¨gës
->
d°c
 <= 1) {

156 *
badfd
 = 
twŸ¨gës
->
d°v
[0].
s
;

157 
	`SASSERTX
(*
badfd
 != -1);

159 
ª˚ived⁄addr
 = &
twŸ¨gës
->
d°v
[0].
œddr
;

160 
∑ckë§c
 = &
twŸ¨gës
->
d°v
[0].
øddr
;

166 *
badfd
 = -1;

167 
ª˚ived⁄addr
 = 
NULL
;

168 
∑ckë§c
 = 
NULL
;

171 
emsgÀn
 = 
	`¢¥ötf
(
emsg
, (emsg),

172 "%†(dñayedÉº‹)", 
	`°ªº‹
(
î∫o
));

174 
	`iﬁog
(
∑ckëruÀ
,

175 
°©e
,

176 
OPERATION_TMPERROR
,

177 
dlog
,

178 
˛og
,

179 
NULL
,

180 
NULL
,

181 
emsg
,

182 
emsgÀn
);

184 
°©e
->
comm™d
 = 
ﬁdcomm™d
;

186 
	`£nd_icm≥º‹
(
øwsockë
,

187 
ª˚ived⁄addr
,

188 
∑ckë§c
,

189 &
˛õ¡
->
øddr
,

192 
icmp_ty≥
,

193 
icmp_code
);

196  
IO_TMPERROR
;

199 *
badfd
 = 
˛õ¡
->
s
;

201 i‡(
	`ERRNOISTMP
(
î∫o
))

202  
IO_EAGAIN
;

204 
	`log_u√x≥˘ed_ud¥ecv_îr‹
(
fun˘i⁄
, 
˛õ¡
->
s
, 
î∫o
, 
INTERNALIF
);

205  
IO_IOERROR
;

209 
io°©us
 = 
	`io_∑ckë_ª˚ived
(&
ªcvÊags
, 
r
, &
‰om
, &
˛õ¡
->
œddr
);

211 i‡(
io°©us
 !
IO_NOERROR
) {

212 *
badfd
 = 
˛õ¡
->
s
;

213  
io°©us
;

216 
	`sockaddr2socksho°
(&
‰om
, &
˛og
->
≥î
);

217 
˛og
->
≥î_is£t
 = 1;

219 
	`¶og
(
LOG_DEBUG
, "%s:Ñeceived udpÖacket from %s,Üength: %ld",

220 
fun˘i⁄
, 
	`sockaddr2°rög
(&
‰om
, 
NULL
, 0), ()
r
);

227 *
emsg
 = 
NUL
;

229 i‡(!
˛õ¡
->
°©e
.
isc⁄√˘ed
) {

240 c⁄° 
blocked


241 !
	`‰omaddr_as_ex≥˘ed
(&
˛õ¡
->
øddr
, &
‰om
, 
emsg
, (emsg));

243 i‡(!
blocked
) {

244 
	`sockaddr2socksho°
(&
˛õ¡
->
øddr
, &˛õ¡->
ho°
);

247 i‡(
	`socks_c⁄√˘ho°
(
˛õ¡
->
s
,

248 
INTERNALIF
,

249 &
˛õ¡
->
ho°
,

250 
NULL
,

251 
NULL
,

253 
emsg
,

254 (
emsg
)) != 0 ) {

255 
	`sw¨nx
("%s: strange ... couldÇot connect(2) backÅoÇew UDP "

257 
fun˘i⁄
, 
	`sockaddr2°rög
(&
˛õ¡
->
øddr
, 
NULL
, 0), 
emsg
);

259 *
badfd
 = 
˛õ¡
->
s
;

260 
io°©us
 = 
IO_ERROR
;

263 
˛õ¡
->
°©e
.
isc⁄√˘ed
 = 1;

266 
	`SASSERTX
(!((
io°©us
 !
IO_NOERROR
Ë&& 
blocked
));

268 i‡(
io°©us
 !
IO_NOERROR
 || 
blocked
) {

269 
	`iﬁog
(
∑ckëruÀ
,

270 
°©e
,

271 
	`IOOP
(
blocked
, 
io°©us
),

272 
˛og
,

273 
dlog
,

274 
NULL
,

275 
NULL
,

276 
emsg
,

277 
	`°æí
(
emsg
));

279  
blocked
 ? 
IO_TMPERROR
 : 
io°©us
;

282 
	`SASSERTX
(
˛õ¡
->
°©e
.
isc⁄√˘ed
);

290 
	`SASSERTX
(
io°©us
 =
IO_NOERROR
);

292 i‡(
	`gëud±¨gë
(
buf
, (
size_t
)
r
, &
hódî
, &
hódîÀn
, 
emsg
, (emsg))

293 =
NULL
) {

294 
	`¶og
(
LOG_DEBUG
,

297 
fun˘i⁄
,

298 ()
r
,

299 
	`sockaddr2°rög
(&
˛õ¡
->
øddr
, 
ho°a
, (hosta)),

300 
	`sockaddr2°rög
(&
˛õ¡
->
œddr
, 
ho°b
, (hostb)),

301 
hódî
.
ho°
.
©y≥
 =
SOCKS_ADDR_NOTSET
 ?

302 "N/A" : 
	`socksho°2°rög
(&
hódî
.
ho°
, 
NULL
, 0),

303 
emsg
);

305 
icmp_code
 = 
ICMP_CODE_UNREACHABLE_DESTHOSTUNKNOWN
;

306 
io°©us
 = 
IO_TMPERROR
;

309 i‡(
hódî
.
ho°
.
©y≥
 !
SOCKS_ADDR_NOTSET
) {

314 
dlog
->
≥î
 = 
hódî
.
ho°
;

315 
dlog
->
≥î_is£t
 = 1;

318 
dlog
->
≥î_is£t
 = 0;

320 i‡(
io°©us
 =
IO_NOERROR
) {

321 
	`SASSERTX
(
hódî
.
ho°
.
©y≥
 !
SOCKS_ADDR_NOTSET
);

323 
	`SASSERTX
(
hódîÀn
 > 0);

324 
∑ylﬂd
 = 
buf
 + 
hódîÀn
;

325 
∑ylﬂdÀn
 = 
r
 - 
hódîÀn
;

327 
	`socksho°2sockaddr2
(&
hódî
.
ho°
,

328 &
èrgëaddr
,

329 &
gaõº
,

330 
emsg
,

331 (
emsg
));

333 i‡(
	`IPADDRISBOUND
(&
èrgëaddr
)) {

338 
	`sockaddr2socksho°
(&
èrgëaddr
, &
dlog
->
≥î
);

339 
	`SASSERTX
(
dlog
->
≥î_is£t
);

342 i‡(
gaõº
 != 0) {

343 
	`SASSERTX
(
hódî
.
ho°
.
©y≥
 =
SOCKS_ADDR_DOMAIN
);

344 
	`log_ªsﬁveÁûed
(
hódî
.
ho°
.
addr
.
domaö
, 
EXTERNALIF
, 
gaõº
);

346 
	`¢¥ötf
(
emsg
, (emsg),

348 
	`socksho°2°rög
(&
hódî
.
ho°
, 
NULL
, 0),

349 
	`gai_°ªº‹
(
gaõº
));

352 
	`¢¥ötf
(
emsg
, (emsg),

354 
	`socksho°2°rög
(&
hódî
.
ho°
, 
NULL
, 0),

355 
	`°ªº‹
(
î∫o
));

358 
io°©us
 = 
IO_TMPERROR
;

359 
icmp_code
 = 
ICMP_CODE_UNREACHABLE_DESTHOSTUNKNOWN
;

363 
	`bzîo
(&
èrgëaddr
, (targetaddr));

364 
	`SET_SOCKADDR
(&
èrgëaddr
, 
AF_INET
);

367 i‡(
io°©us
 !
IO_NOERROR
) {

368 
	`iﬁog
(
∑ckëruÀ
,

369 
°©e
,

370 
	`IOOP
(
∑ckëruÀ
->
vîdi˘
 =
VERDICT_BLOCK
, 
io°©us
),

371 
˛og
,

372 
dlog
,

373 
NULL
,

374 
NULL
,

375 
emsg
,

376 
	`°æí
(
emsg
));

386 
	`£nd_icm≥º‹
(
øwsockë
,

387 &
˛õ¡
->
œddr
,

388 &
˛õ¡
->
øddr
,

389 
	`IPADDRISBOUND
(&
èrgëaddr
Ë? &èrgëadd∏: 
NULL
,

392 
icmp_ty≥
,

393 
io°©us
 =
IO_NOERROR
 ?

394 
ICMP_CODE_UNREACHABLE_HOSTPROHIBITED
 : 
icmp_code
);

396  
IO_TMPERROR
;

404 
	`¶og
(
LOG_DEBUG
,

407 
fun˘i⁄
,

408 ()
r
,

409 ()
∑ylﬂdÀn
,

410 
	`sockaddr2°rög
(&
˛õ¡
->
øddr
, 
ho°a
, (hosta)),

411 
	`sockaddr2°rög
(&
˛õ¡
->
œddr
, 
ho°b
, (hostb)),

412 
	`socksho°2°rög
(&
hódî
.
ho°
, 
NULL
, 0));

418 i‡(
˛õ¡
->
°©e
.
u£_ßved_§uÀ
) {

419 
addèrgë
;

421 
	`SASSERTX
(
twŸ¨gës
->
d°c
 > 0);

429 
twŸ¨gës
->
d°c
) {

435 i‡(
twŸ¨gës
->
d°v
[0].
øddr
.
ss_Ámûy
 =
èrgëaddr
.ss_family) {

436 
èrgë
 = &
twŸ¨gës
->
d°v
[0];

437 
addèrgë
 = 0;

440 
addèrgë
 = 1;

449 i‡(
twŸ¨gës
->
d°v
[0].
øddr
.
ss_Ámûy
 =
èrgëaddr
.ss_family)

450 
èrgë
 = &
twŸ¨gës
->
d°v
[0];

452 
	`SASSERTX
(
twŸ¨gës
->
d°v
[1].
øddr
.
ss_Ámûy


453 =
èrgëaddr
.
ss_Ámûy
);

455 
èrgë
 = &
twŸ¨gës
->
d°v
[1];

458 
addèrgë
 = 0;

462 
	`SERRX
(
twŸ¨gës
->
d°c
);

465 i‡(
addèrgë
) {

466 
	`SASSERTX
(
twŸ¨gës
->
d°c
 == 1);

467 
	`SASSERTX
(
twŸ¨gës
->
d°v
[0].
øddr
.
ss_Ámûy
 !
èrgëaddr
.ss_family);

469 
	`¶og
(
LOG_DEBUG
,

472 
fun˘i⁄
,

473 
	`ßÁmûy2°rög
(
twŸ¨gës
->
d°v
[0].
øddr
.
ss_Ámûy
),

474 
	`ßÁmûy2°rög
(
èrgëaddr
.
ss_Ámûy
));

476 
	`SASSERTX
(
twŸ¨gës
->
d°v
[twŸ¨gës->
d°c
].
s
 == 0);

478 i‡(
	`öô˛õ¡
(
c⁄åﬁ
->
s
,

479 &
˛õ¡
->
œddr
,

480 &
˛õ¡
->
øddr
,

481 &
hódî
.
ho°
,

482 &
èrgëaddr
,

483 
∑ckëruÀ
,

484 
emsg
,

485 (
emsg
),

486 &
twŸ¨gës
->
d°v
[twŸ¨gës->
d°c
]Ë!
NULL
) {

487 
èrgë
 = 
	`add˛õ¡
(&
˛õ¡
->
œddr
,

488 &
twŸ¨gës
->
d°v
[twŸ¨gës->
d°c
],

489 &
twŸ¨gës
->
d°c
,

490 &
twŸ¨gës
->
d°cmax
,

491 &
twŸ¨gës
->
d°v
,

492 
°©e
,

493 
∑ckëruÀ
);

495 
	`SASSERTX
(
èrgë
 !
NULL
);

496 
	`SASSERTX
(
twŸ¨gës
->
d°c
 == 2);

498 
doc⁄√˘
 = 
sockscf
.
udpc⁄√˘d°
;

505 
io°©us
 = 
IO_TMPERROR
;

507 
	`iﬁog
(
∑ckëruÀ
,

508 
°©e
,

509 
	`IOOP
(
∑ckëruÀ
->
vîdi˘
 =
VERDICT_BLOCK
, 
io°©us
),

510 
˛og
,

511 
dlog
,

512 
NULL
,

513 
NULL
,

514 
emsg
,

515 
	`°æí
(
emsg
));

517 
	`£nd_icm≥º‹
(
øwsockë
,

518 &
˛õ¡
->
œddr
,

519 &
˛õ¡
->
øddr
,

520 &
èrgëaddr
,

523 
icmp_ty≥
,

524 
icmp_code
);

526  
io°©us
;

529 
ßmë¨gë
 = 0;

532 
ßmë¨gë
 = 
	`socksho°¨ìq
(&
èrgë
->
øddrho°
, &
hódî
.
ho°
);

534 
twŸ¨gës
->
s
 = 
èrgë
->s;

536 
	`sockaddr2socksho°
(&
èrgë
->
œddr
, &
dlog
->
loˇl
);

537 
dlog
->
loˇl_is£t
 = 1;

539 
	`¶og
(
LOG_DEBUG
,

540 "%s: u£_ßved_§uÀ së. UDPÖackë #%"
PRIu64
" from %s. "

543 
fun˘i⁄
,

544 
˛õ¡
->
ªad
.
∑ckës
 + 1,

545 
	`sockaddr2°rög
(&
˛õ¡
->
øddr
, 
NULL
, 0),

546 
	`socksho°2°rög
(&
hódî
.
ho°
, 
NULL
, 0),

547 ()
∑ckëruÀ
->
numbî
,

548 
	`vîdi˘2°rög
(
∑ckëruÀ
->
vîdi˘
),

549 
	`socksho°2°rög
(&
èrgë
->
øddrho°
, 
ho°a
, (hosta)),

550 
ßmë¨gë
 ? "" : "not ");

552 i‡(
ßmë¨gë
)

553 
≥rmô
 = (
∑ckëruÀ
->
vîdi˘
 =
VERDICT_PASS
);

555 
socksho°_t
 
èrgëho°
;

556 
˛õ¡°r
[
MAXSOCKADDRSTRING
], 
d°bef‹e
[
MAXSOCKSHOSTSTRING
],

557 
d°now
[
MAXSOCKSHOSTSTRING
];

559 
	`SASSERTX
(
io°©us
 =
IO_NOERROR
);

561 
≥rmô
 = 
	`ruÀ•îmô
(
c⁄åﬁ
->
s
,

562 &
c⁄åﬁ
->
øddr
,

563 &
c⁄åﬁ
->
œddr
,

564 
ˇuth
,

565 &
c⁄åﬁ
->
auth
,

566 
∑ckëruÀ
,

567 
°©e
,

568 &
˛õ¡
->
ho°
,

569 &
hódî
.
ho°
,

570 &
èrgëho°
,

571 
emsg
,

572 (
emsg
));

574 i‡(
≥rmô
)

575 
hódî
.
ho°
 = 
èrgëho°
;

577 i‡(!
addèrgë
)

578 
	`¶og
(
LOG_DEBUG
,

581 
fun˘i⁄
,

582 
	`sockaddr2°rög
(&
c⁄åﬁ
->
øddr
, 
˛õ¡°r
, (clientstr)),

583 
	`socksho°2°rög
(&
èrgë
->
øddrho°
,

584 
d°bef‹e
,

585 (
d°bef‹e
)),

586 
	`socksho°2°rög
(&
hódî
.
ho°
,

587 
d°now
,

588 (
d°now
)),

589 
≥rmô
 ?

604 i‡(
èrgë
->
isc⁄√˘ed
) {

605 
	`sockd_unc⁄√˘
(
èrgë
->
s
, &èrgë->
øddr
);

606 
èrgë
->
isc⁄√˘ed
 = 0;

609 
èrgë
->
øddrho°
 = 
hódî
.
ho°
;

610 
èrgë
->
øddr
 = 
èrgëaddr
;

612 i‡(
≥rmô
) {

614 
	`£tc⁄fsock›ti⁄s
(
èrgë
->
s
,

615 
˛õ¡
->
s
,

616 
SOCKS_UDP
,

618 
∑ckëruÀ
->
sockë›ti⁄c
,

619 
∑ckëruÀ
->
sockë›ti⁄v
,

620 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
,

625 i‡(
≥rmô
) {

626 i‡(
	`ªdúe˘
(
èrgë
->
s
,

627 &
èrgë
->
œddr
,

628 &
èrgë
->
øddrho°
,

629 
°©e
->
comm™d
,

630 &
∑ckëruÀ
->
rdr_‰om
,

631 &
∑ckëruÀ
->
rdr_to
) == 0)

632 
	`sockaddr2socksho°
(&
èrgë
->
œddr
, &
dlog
->
loˇl
);

634 
	`¢¥ötf
(
emsg
, (emsg),

635 "ªdúe˘ faûed: %s", 
	`°ªº‹
(
î∫o
));

637 i‡(
î∫o
 != 0)

638 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

640 
io°©us
 = 
IO_TMPERROR
;

648 
socksho°_t
 
èrgëho°
;

649 
addèrgë
;

651 
≥rmô
 = 
	`ruÀ•îmô
(
c⁄åﬁ
->
s
,

652 &
c⁄åﬁ
->
øddr
,

653 &
c⁄åﬁ
->
œddr
,

654 
ˇuth
,

655 &
c⁄åﬁ
->
auth
,

656 
∑ckëruÀ
,

657 
°©e
,

658 &
˛õ¡
->
ho°
,

659 &
hódî
.
ho°
,

660 &
èrgëho°
,

661 
emsg
,

662 (
emsg
));

664 i‡(
≥rmô
) {

670 
hódî
.
ho°
 = 
èrgëho°
;

672 
twŸ¨gës
->
d°c
) {

677 
addèrgë
 = 1;

685 i‡(
twŸ¨gës
->
d°v
[0].
øddr
.
ss_Ámûy


686 =
èrgëaddr
.
ss_Ámûy
) {

687 
èrgë
 = &
twŸ¨gës
->
d°v
[0];

688 
addèrgë
 = 0;

691 
addèrgë
 = 1;

700 i‡(
twŸ¨gës
->
d°v
[0].
øddr
.
ss_Ámûy
 =
èrgëaddr
.ss_family)

701 
èrgë
 = &
twŸ¨gës
->
d°v
[0];

703 
	`SASSERTX
(
twŸ¨gës
->
d°v
[1].
øddr
.
ss_Ámûy


704 =
èrgëaddr
.
ss_Ámûy
);

706 
èrgë
 = &
twŸ¨gës
->
d°v
[1];

709 
addèrgë
 = 0;

713 
	`SERRX
(
twŸ¨gës
->
d°c
);

716 i‡(
addèrgë
) {

717 
	`SASSERTX
(
twŸ¨gës
->
d°c
 < 2);

719 i‡(
	`öô˛õ¡
(
c⁄åﬁ
->
s
,

720 &
˛õ¡
->
œddr
,

721 &
˛õ¡
->
øddr
,

722 &
hódî
.
ho°
,

723 &
èrgëaddr
,

724 
∑ckëruÀ
,

725 
emsg
,

726 (
emsg
),

727 &
twŸ¨gës
->
d°v
[twŸ¨gës->
d°c
]Ë!
NULL
) {

728 
èrgë
 = 
	`add˛õ¡
(&
˛õ¡
->
œddr
,

729 &
twŸ¨gës
->
d°v
[twŸ¨gës->
d°c
],

730 &
twŸ¨gës
->
d°c
,

731 &
twŸ¨gës
->
d°cmax
,

732 &
twŸ¨gës
->
d°v
,

733 
°©e
,

734 
∑ckëruÀ
);

736 
	`SASSERTX
(
èrgë
 !
NULL
);

737 
	`SASSERTX
(
twŸ¨gës
->
d°c
 > 0);

739 
doc⁄√˘
 = 
sockscf
.
udpc⁄√˘d°
;

742 
io°©us
 = 
IO_TMPERROR
;

745 i‡(
èrgë
 !
NULL
) {

746 
	`sockaddr2socksho°
(&
èrgë
->
œddr
, &
dlog
->
loˇl
);

747 
dlog
->
loˇl_is£t
 = 1;

748 
twŸ¨gës
->
s
 = 
èrgë
->s;

756 i‡(
twŸ¨gës
->
d°c
 == 0) {

767 
ruÀ_t
 
åyruÀ
;

768 c⁄° 
åy_≥rmôs
 = 
	`ruÀ•îmô
(
c⁄åﬁ
->
s
,

769 &
c⁄åﬁ
->
øddr
,

770 &
c⁄åﬁ
->
œddr
,

771 
ˇuth
,

772 &
c⁄åﬁ
->
auth
,

773 &
åyruÀ
,

774 
°©e
,

775 &
˛õ¡
->
ho°
,

776 
NULL
,

777 
NULL
,

778 
NULL
,

781 i‡(!
åy_≥rmôs
) {

782 
	`¶og
(
LOG_DEBUG
,

789 
fun˘i⁄
,

790 
	`sockaddr2°rög
(&
˛õ¡
->
øddr
, 
ho°a
, (hosta)),

791 
	`sockaddr2°rög
(&
c⁄åﬁ
->
øddr
, 
ho°b
, (hostb)));

793 
io°©us
 = 
IO_BLOCK
;

798 i‡(
io°©us
 !
IO_NOERROR
 || !
≥rmô
) {

799 
	`iﬁog
(
∑ckëruÀ
,

800 
°©e
,

801 
	`IOOP
(!
≥rmô
, 
io°©us
),

802 
˛og
,

803 
dlog
,

804 
NULL
,

805 
NULL
,

806 
emsg
,

807 
	`°æí
(
emsg
));

809 
	`£nd_icm≥º‹
(
øwsockë
,

810 &
˛õ¡
->
œddr
,

811 &
˛õ¡
->
øddr
,

812 &
èrgëaddr
,

815 
icmp_ty≥
,

816 
io°©us
 =
IO_NOERROR
 ?

817 
ICMP_CODE_UNREACHABLE_HOSTPROHIBITED
 : 
icmp_code
);

819 i‡(
io°©us
 !
IO_NOERROR
)

820  
io°©us
;

822  
IO_TMPBLOCK
;

825 i‡(
addèrgë
) {

826 
ßmë¨gë
 = 0;

828 
	`¶og
(
LOG_DEBUG
, "%s:ÇewÅarget: %s",

829 
fun˘i⁄
, 
	`socksho°2°rög
(&
hódî
.
ho°
, 
ho°b
, (hostb)));

832 
ßmë¨gë
 = 
	`socksho°¨ìq
(&
hódî
.
ho°
, &
èrgë
->
øddrho°
);

834 
	`¶og
(
LOG_DEBUG
,

836 
fun˘i⁄
,

837 
	`socksho°2°rög
(&
èrgë
->
øddrho°
, 
ho°a
, (hosta)),

838 
	`socksho°2°rög
(&
hódî
.
ho°
, 
ho°b
, (hostb)),

839 
ßmë¨gë
 ? "sameás" : "different from");

842 i‡(
èrgë
->
isc⁄√˘ed
 && !
ßmë¨gë
) {

848 
	`sockd_unc⁄√˘
(
èrgë
->
s
, &èrgë->
øddr
);

849 
èrgë
->
isc⁄√˘ed
 = 0;

850 
èrgë
->
øddr
 = 
èrgëaddr
;

854 
	`SASSERTX
(
èrgë
 !
NULL
);

856 
èrgë
->
˛õ¡_ªad
.
byãs
 +
ªcvÊags
.
‰omsockë
;

857 
èrgë
->
˛õ¡_ªad
.
∑ckës
 += 1;

859 
˛õ¡
->
°©e
.
u£_ßved_§uÀ
 = 1;

861 i‡(
≥rmô
 && 
io°©us
 =
IO_NOERROR
) {

873 i‡(
doc⁄√˘
) {

874 
	`¶og
(
LOG_DEBUG
, "%s: connecting fd %dÅo %s, for client %s",

875 
fun˘i⁄
,

876 
èrgë
->
s
,

877 
	`socksho°2°rög
(&
hódî
.
ho°
, 
ho°a
, (hosta)),

878 
	`socksho°2°rög
(&
˛õ¡
->
ho°
, 
ho°b
, (hostb)));

880 i‡(
	`socks_c⁄√˘ho°
(
èrgë
->
s
,

881 
EXTERNALIF
,

882 &
hódî
.
ho°
,

883 
NULL
,

884 
NULL
,

886 
emsg
,

887 (
emsg
)) == -1) {

888 
	`iﬁog
(
∑ckëruÀ
,

889 
°©e
,

890 
OPERATION_TMPERROR
,

891 
˛og
,

892 
dlog
,

893 
NULL
,

894 
NULL
,

895 
emsg
,

896 
	`°æí
(
emsg
));

898 
io°©us
 = 
IO_TMPERROR
;

899  
io°©us
;

902 
èrgë
->
isc⁄√˘ed
 = 1;

905 
£ndtoÊags
.
side
 = 
EXTERNALIF
;

906 
w
 = 
	`socks_£ndto
(
èrgë
->
s
,

907 
∑ylﬂd
,

908 
∑ylﬂdÀn
,

910 
èrgë
->
isc⁄√˘ed
 ? 
NULL
 : &èrgë->
øddr
,

911 
èrgë
->
isc⁄√˘ed
 ?

912 (
sockÀn_t
)0 : (sockÀn_t)(
èrgë
->
øddr
),

913 &
£ndtoÊags
,

914 
NULL
);

916 i‡(
w
 >= 0) {

917 
io°©us
 = 
	`io_∑ckë_£¡
(
∑ylﬂdÀn
,

918 
w
,

919 &
ªcvÊags
.
ts
,

920 &
˛õ¡
->
øddr
,

921 &
èrgë
->
øddr
,

922 
emsg
,

923 (
emsg
));

925 *
bwu£d
 = 
w
;

927 
èrgë
->
èrgë_wrôãn
.
byãs
 +
£ndtoÊags
.
tosockë
;

928 
èrgë
->
èrgë_wrôãn
.
∑ckës
 += 1;

930 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
èrgë
->
œ°io
);

938 
twŸ¨gës
->
wrôãn
.
byãs
 +
£ndtoÊags
.
tosockë
;

939 
twŸ¨gës
->
wrôãn
.
∑ckës
 += 1;

942 
	`¢¥ötf
(
emsg
, (emsg), "sendto of %lu bytes failed: %s",

943 ()
∑ylﬂdÀn
, 
	`°ªº‹
(
î∫o
));

945 
io°©us
 = 
	`IOSTATUS_UDP_SEND_FAILED
(
î∫o
);

946 *
badfd
 = 
èrgë
->
s
;

950 
w
 = -1;

952 i‡(
io°©us
 !
IO_NOERROR
 || !
≥rmô
) {

953 
	`iﬁog
(
∑ckëruÀ
,

954 
°©e
,

955 
	`IOOP
(!
≥rmô
, 
io°©us
),

956 
˛og
,

957 
dlog
,

958 
NULL
,

959 
NULL
,

960 
emsg
,

961 
	`°æí
(
emsg
));

963 
	`£nd_icm≥º‹
(
øwsockë
,

964 &
˛õ¡
->
œddr
,

965 &
˛õ¡
->
øddr
,

966 &
èrgëaddr
,

969 
icmp_ty≥
,

970 
io°©us
 =
IO_NOERROR
 ?

971 
ICMP_CODE_UNREACHABLE_HOSTPROHIBITED
 : 
icmp_code
);

973 i‡(
io°©us
 !
IO_NOERROR
)

974  
io°©us
;

976  
IO_TMPBLOCK
;

979 
	`SASSERTX
(
w
 =(
ssize_t
)
∑ylﬂdÀn
);

981 
	`iﬁog
(
∑ckëruÀ
,

982 
°©e
,

983 
OPERATION_IO
,

984 
˛og
,

985 
dlog
,

986 
NULL
,

987 
NULL
,

988 
∑ylﬂd
,

989 
∑ylﬂdÀn
);

991  
IO_NOERROR
;

992 
	}
}

994 
io°©us_t


995 
	$io_udp_èrgë2˛õ¡
(
c⁄åﬁ
, 
˛õ¡
, 
twŸ¨gës
, 
°©e
,

996 
˛og
, 
dlog
, 
badfd
, 
∑ckëruÀ
, 
bwu£d
)

997 
sockd_io_dúe˘i⁄_t
 *
c⁄åﬁ
;

998 
sockd_io_dúe˘i⁄_t
 *
˛õ¡
;

999 
sockd_io_dúe˘i⁄_t
 *
twŸ¨gës
;

1000 
c⁄√˘i⁄°©e_t
 *
°©e
;

1001 
iﬁogaddr_t
 *
˛og
;

1002 
iﬁogaddr_t
 *
dlog
;

1003 *
badfd
;

1004 
ruÀ_t
 *
∑ckëruÀ
;

1005 
size_t
 *
bwu£d
;

1013 c⁄° *
fun˘i⁄
 = "io_udp_target2client()";

1014 
io°©us_t
 
io°©us
 = 
IO_NOERROR
;

1015 
ud±¨gë_t
 *
èrgë
 = 
NULL
;

1016 
£ndto_öfo_t
 
£ndtoÊags
;

1017 
ªcv‰om_öfo_t
 
ªcvÊags
;

1018 
sockaddr_°‹age
 
‰om
, 
ho°addr
;

1019 
sockÀn_t
 
Àn
;

1020 
ssize_t
 
w
, 
r
;

1021 
size_t
 
hódîÀn
, 
∑ylﬂdÀn
, 
emsgÀn
, 
‹igöÆÀn
;

1022 
ho°a
[
MAXSOCKSHOSTSTRING
], 
ho°b
[MAXSOCKSHOSTSTRING], 
emsg
[1024],

1023 
buf
[
SOCKD_BUFSIZE
 + (
udphódî_t
)], *
∑ylﬂd
;

1024 
ßme§c
, 
≥rmô
 = 0,

1025 
icmp_ty≥
 = 
ICMP_TYPE_UNREACHABLE
,

1026 
icmp_code
 = 
ICMP_CODE_UNREACHABLE_PORT
;

1028 
èrgë
 = 
	`˛õ¡ofsockë
(
twŸ¨gës
->
s
,ÅwŸ¨gës->
d°c
,ÅwŸ¨gës->
d°v
);

1029 
	`SASSERTX
(
èrgë
 !
NULL
);

1031 *
emsg
 = 
NUL
;

1033 
ªcvÊags
.
side
 = 
EXTERNALIF
;

1034 
ªcvÊags
.
≥î
 = 
twŸ¨gës
->
øddr
;

1035 
ªcvÊags
.
ty≥
 = 
SOCK_DGRAM
;

1037 
Àn
 = (
‰om
);

1038 i‡((
r
 = 
	`socks_ªcv‰om
(
twŸ¨gës
->
s
,

1039 
buf
,

1040 (
buf
),

1042 &
‰om
,

1043 &
Àn
,

1044 &
ªcvÊags
,

1045 &
twŸ¨gës
->
auth
)) == -1) {

1046 i‡(
	`ERRNOISPREVIOUSPACKET
(
î∫o
)) {

1056 c⁄° 
ﬁdcomm™d
 = 
°©e
->
comm™d
;

1057 
°©e
->
comm™d
 = 
SOCKS_UDPASSOCIATE
;

1059 *
badfd
 = 
˛õ¡
->
s
;

1061 
emsgÀn
 = 
	`¢¥ötf
(
emsg
, (emsg),

1062 "%†(dñayedÉº‹)", 
	`°ªº‹
(
î∫o
));

1064 
	`iﬁog
(
∑ckëruÀ
,

1065 
°©e
,

1066 
OPERATION_TMPERROR
,

1067 
˛og
,

1068 
dlog
,

1069 
NULL
,

1070 
NULL
,

1071 
emsg
,

1072 
emsgÀn
);

1074 
°©e
->
comm™d
 = 
ﬁdcomm™d
;

1076 
	`£nd_icm≥º‹
(
øwsockë
,

1077 &
˛õ¡
->
œddr
,

1078 &
˛õ¡
->
øddr
,

1079 &
twŸ¨gës
->
øddr
,

1082 
icmp_ty≥
,

1083 
icmp_code
);

1086  
IO_TMPERROR
;

1089 *
badfd
 = 
twŸ¨gës
->
s
;

1091 i‡(
	`ERRNOISTMP
(
î∫o
))

1092  
IO_EAGAIN
;

1094 
	`log_u√x≥˘ed_ud¥ecv_îr‹
(
fun˘i⁄
,

1095 
twŸ¨gës
->
s
,

1096 
î∫o
,

1097 
EXTERNALIF
);

1098  
IO_IOERROR
;

1102 
io°©us
 = 
	`io_∑ckë_ª˚ived
(&
ªcvÊags
, 
r
, &
‰om
, &
twŸ¨gës
->
œddr
);

1104 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
èrgë
->
œ°io
);

1106 i‡(
io°©us
 !
IO_NOERROR
) {

1107 *
badfd
 = 
twŸ¨gës
->
s
;

1108  
io°©us
;

1115 
∑ylﬂdÀn
 = 
r
;

1117 
èrgë
->
èrgë_ªad
.
byãs
 +
ªcvÊags
.
‰omsockë
;

1118 
èrgë
->
èrgë_ªad
.
∑ckës
 += 1;

1120 
	`¶og
(
LOG_DEBUG
,

1121 "%s: ud∞∑ckë #%"
PRIu64
" fromÅwotargets %sÑeceived for client %s "

1123 
fun˘i⁄
,

1124 
twŸ¨gës
->
ªad
.
∑ckës
,

1125 
	`sockaddr2°rög
(&
‰om
, 
ho°a
, (hosta)),

1126 
	`sockaddr2°rög
(&
˛õ¡
->
øddr
, 
ho°b
, (hostb)),

1127 
twŸ¨gës
->
s
,

1128 ()
r
,

1129 
twŸ¨gës
->
°©e
.
u£_ßved_§uÀ
);

1131 i‡(
twŸ¨gës
->
wrôãn
.
∑ckës
 == 0) {

1132 
	`¶og
(
LOG_DEBUG
,

1135 
fun˘i⁄
,

1136 
	`sockaddr2°rög
(&
˛õ¡
->
øddr
, 
NULL
, 0),

1137 ()
r
,

1138 
	`sockaddr2°rög
(&
twŸ¨gës
->
œddr
, 
ho°a
, (hosta)),

1139 
	`sockaddr2°rög
(&
‰om
, 
ho°b
, (hostb)));

1146 i‡(
twŸ¨gës
->
°©e
.
u£_ßved_§uÀ
) {

1151 i‡(
twŸ¨gës
->
°©e
.
isc⁄√˘ed
) {

1152 
	`¶og
(
LOG_DEBUG
, "%s: socket is connected. Kernel shouldÅake care "

1156 
fun˘i⁄
,

1157 
	`sockaddr2°rög
(&
‰om
, 
NULL
, 0),

1158 ()
∑ckëruÀ
->
numbî
,

1159 
	`vîdi˘2°rög
(
∑ckëruÀ
->
vîdi˘
));

1160 
ßme§c
 = 1;

1163 i‡(
	`IPADDRISBOUND
(&
twŸ¨gës
->
øddr
)) {

1164 i‡(! (
ßme§c
 = 
	`sockaddøªeq
(&
twŸ¨gës
->
øddr
, &
‰om
, 0))) {

1168 
	`¶og
(
LOG_DEBUG
,

1169 "%s: u£_ßved_§uÀ së. UDPÖackë #%"
PRIu64
" from %s. "

1173 
fun˘i⁄
,

1174 
twŸ¨gës
->
ªad
.
∑ckës
,

1175 
	`sockaddr2°rög
(&
‰om
, 
ho°a
, (hosta)),

1176 
	`socksho°2°rög
(&
˛õ¡
->
ho°
, 
ho°b
, (hostb)),

1177 
	`obje˘ty≥2°rög
(
∑ckëruÀ
->
ty≥
),

1178 ()
∑ckëruÀ
->
numbî
,

1179 
	`vîdi˘2°rög
(
∑ckëruÀ
->
vîdi˘
),

1180 
	`sockaddr2°rög
(&
twŸ¨gës
->
øddr
, 
NULL
, 0));

1184 
ßme§c
 = 0;

1188 
ßme§c
 = 0;

1190 i‡(
ßme§c
)

1191 
≥rmô
 = (
∑ckëruÀ
->
vîdi˘
 =
VERDICT_PASS
);

1197 
twŸ¨gës
->
øddr
 = 
‰om
;

1199 
	`sockaddr2socksho°
(&
twŸ¨gës
->
øddr
, &twŸ¨gës->
ho°
);

1200 
dlog
->
≥î
 = 
twŸ¨gës
->
ho°
;

1202 
	`¶og
(
LOG_DEBUG
,

1205 
fun˘i⁄
,

1206 
	`sockaddr2°rög
(&
twŸ¨gës
->
øddr
, 
ho°a
, (hosta)),

1207 
	`sockaddr2°rög
(&
˛õ¡
->
øddr
, 
ho°b
, (hostb)),

1208 
twŸ¨gës
->
s
,

1209 
twŸ¨gës
->
°©e
.
u£_ßved_§uÀ
,

1210 
ßme§c
);

1212 i‡(!
twŸ¨gës
->
°©e
.
u£_ßved_§uÀ
) {

1213 i‡(
˛õ¡
->
wrôãn
.
∑ckës
 > 0)

1214 
	`¶og
(
LOG_DEBUG
, "%s:Çot firstÖacketánd use_saved_sruleÇot set "

1216 
fun˘i⁄
);

1219 
	`SASSERTX
(
io°©us
 =
IO_NOERROR
);

1221 
≥rmô
 = 
	`ruÀ•îmô
(
c⁄åﬁ
->
s
,

1222 &
c⁄åﬁ
->
øddr
,

1223 &
c⁄åﬁ
->
œddr
,

1224 
NULL
,

1225 &
twŸ¨gës
->
auth
,

1226 
∑ckëruÀ
,

1227 
°©e
,

1228 &
twŸ¨gës
->
ho°
,

1229 &
˛õ¡
->
ho°
,

1230 
NULL
,

1231 
NULL
,

1234 i‡(
≥rmô
) {

1240 
sockaddr_°‹age
 
p
;

1242 i‡(
	`ªdúe˘
(
˛õ¡
->
s
,

1243 &
˛õ¡
->
œddr
,

1244 &
˛õ¡
->
ho°
,

1245 
°©e
->
comm™d
,

1246 &
∑ckëruÀ
->
rdr_‰om
,

1247 &
∑ckëruÀ
->
rdr_to
) == 0) {

1253 
	`sockaddr2socksho°
(&
˛õ¡
->
œddr
, &
˛og
->
loˇl
);

1254 
	`sockaddr2socksho°
(
	`socksho°2sockaddr
(&
˛õ¡
->
ho°
, &
p
),

1255 &
˛og
->
≥î
);

1258 
	`¢¥ötf
(
emsg
, (emsg),

1259 "ªdúe˘ faûed: %s", 
	`°ªº‹
(
î∫o
));

1261 
io°©us
 = 
IO_TMPERROR
;

1266 i‡(
io°©us
 !
IO_NOERROR
 || !
≥rmô
) {

1267 
	`iﬁog
(
∑ckëruÀ
,

1268 
°©e
,

1269 
	`IOOP
(!
≥rmô
, 
io°©us
),

1270 
dlog
,

1271 
˛og
,

1272 
NULL
,

1273 
NULL
,

1274 
emsg
,

1275 
	`°æí
(
emsg
));

1277 
	`£nd_icm≥º‹
(
øwsockë
,

1278 &
twŸ¨gës
->
œddr
,

1279 &
twŸ¨gës
->
øddr
,

1280 
	`socksho°2sockaddr
(&
˛õ¡
->
ho°
, &
ho°addr
),

1283 
icmp_ty≥
,

1284 
io°©us
 =
IO_NOERROR
 ?

1285 
ICMP_CODE_UNREACHABLE_HOSTPROHIBITED
 : 
icmp_code
);

1287 i‡(
io°©us
 !
IO_NOERROR
)

1288  
io°©us
;

1290  
IO_TMPBLOCK
;

1293 
twŸ¨gës
->
°©e
.
u£_ßved_§uÀ
 = 1;

1295 
£ndtoÊags
.
side
 = 
INTERNALIF
;

1297 
‹igöÆÀn
 = 
∑ylﬂdÀn
;

1298 
∑ylﬂd
 = 
	`udphódî_add
(
	`sockaddr2socksho°
(&
twŸ¨gës
->
øddr
, 
NULL
),

1299 
buf
,

1300 &
∑ylﬂdÀn
,

1301 (
buf
));

1303 
	`SASSERTX
(
∑ylﬂd
 =
buf
);

1304 
	`SASSERTX
(
∑ylﬂdÀn
 > (
size_t
)
r
);

1305 
	`SASSERTX
(
∑ylﬂdÀn
 - 
‹igöÆÀn
 >
MINSOCKSUDPHLEN
);

1307 
hódîÀn
 = 
∑ylﬂdÀn
 - 
‹igöÆÀn
;

1309 
w
 = 
	`socks_£ndto
(
˛õ¡
->
s
,

1310 
∑ylﬂd
,

1311 
∑ylﬂdÀn
,

1313 
˛õ¡
->
°©e
.
isc⁄√˘ed
 ? 
NULL
 : &˛õ¡->
øddr
,

1314 
˛õ¡
->
°©e
.
isc⁄√˘ed
 ?

1315 (
sockÀn_t
)0 : (sockÀn_t)(
˛õ¡
->
øddr
),

1316 &
£ndtoÊags
,

1317 &
˛õ¡
->
auth
);

1319 i‡(
w
 >= 0) {

1320 
io°©us
 = 
	`io_∑ckë_£¡
(
∑ylﬂdÀn
,

1321 
w
,

1322 &
ªcvÊags
.
ts
,

1323 &
twŸ¨gës
->
øddr
,

1324 &
˛õ¡
->
øddr
,

1325 
emsg
,

1326 (
emsg
));

1328 *
bwu£d
 = 
w
;

1330 
èrgë
->
˛õ¡_wrôãn
.
byãs
 +
£ndtoÊags
.
tosockë
;

1331 
èrgë
->
˛õ¡_wrôãn
.
∑ckës
 += 1;

1334 
	`¢¥ötf
(
emsg
, (emsg), "sendto of %lu bytes failed: %s",

1335 ()
∑ylﬂdÀn
, 
	`°ªº‹
(
î∫o
));

1337 
io°©us
 = 
	`IOSTATUS_UDP_SEND_FAILED
(
î∫o
);

1338 *
badfd
 = 
˛õ¡
->
s
;

1341 i‡(
io°©us
 !
IO_NOERROR
) {

1342 
	`iﬁog
(
∑ckëruÀ
,

1343 
°©e
,

1344 
	`IOOP
(!
≥rmô
, 
io°©us
),

1345 
dlog
,

1346 
˛og
,

1347 
NULL
,

1348 
NULL
,

1349 
emsg
,

1350 
	`°æí
(
emsg
));

1352 
	`£nd_icm≥º‹
(
øwsockë
,

1353 &
twŸ¨gës
->
œddr
,

1354 &
twŸ¨gës
->
øddr
,

1355 
	`socksho°2sockaddr
(&
˛õ¡
->
ho°
, &
ho°addr
),

1358 
icmp_ty≥
,

1359 
icmp_code
);

1361  
io°©us
;

1364 
	`SASSERTX
(
w
 =(
ssize_t
)
∑ylﬂdÀn
);

1366 
	`iﬁog
(
∑ckëruÀ
,

1367 
°©e
,

1368 
OPERATION_IO
,

1369 
dlog
,

1370 
˛og
,

1371 
NULL
,

1372 
NULL
,

1373 
∑ylﬂd
 + 
hódîÀn
,

1374 
∑ylﬂdÀn
 - 
hódîÀn
);

1376  
IO_NOERROR
;

1377 
	}
}

1381 
	$‰omaddr_as_ex≥˘ed
(
ex≥˘ed
, 
‰om
, 
emsg
, 
emsgÀn
)

1382 
sockaddr_°‹age
 *
ex≥˘ed
;

1383 c⁄° 
sockaddr_°‹age
 *
‰om
;

1384 *
emsg
;

1385 
size_t
 
emsgÀn
;

1387 c⁄° *
fun˘i⁄
 = "fromaddr_as_expected()";

1388 
ex≥˘ed°r
[
MAXSOCKADDRSTRING
], 
‰om°r
[MAXSOCKADDRSTRING],

1389 
buf
[(
ex≥˘ed°r
Ë+ (
‰om°r
) + 256];

1390 
m©ches
;

1392 
	`¢¥ötf
(
buf
, (buf),

1394 
	`sockaddr2°rög
(
ex≥˘ed
, 
ex≥˘ed°r
, (expectedstr)),

1395 
	`sockaddr2°rög
(
‰om
, 
‰om°r
, (fromstr)));

1397 i‡(!
	`ADDRISBOUND
(
ex≥˘ed
)) {

1409 
sockaddr_°‹age
 
ã°
;

1411 
	`sockaddr˝y
(&
ã°
, 
ex≥˘ed
, (test));

1413 i‡(!
	`IPADDRISBOUND
(
ex≥˘ed
))

1414 
	`SET_SOCKADDRADDR
(&
ã°
, 
	`GET_SOCKADDRADDR
(
‰om
));

1416 i‡(!
	`PORTISBOUND
(
ex≥˘ed
))

1417 
	`SET_SOCKADDRPORT
((&
ã°
), 
	`GET_SOCKADDRPORT
(
‰om
));

1419 
m©ches
 = 
	`sockaddøªeq
(&
ã°
, 
‰om
, 0);

1421 i‡(
m©ches
) {

1427 
	`sockaddr˝y
(
ex≥˘ed
, &
ã°
, (test));

1432 
m©ches
 = 
	`sockaddøªeq
(
ex≥˘ed
, 
‰om
, 0);

1434 i‡(!
m©ches
 && 
emsgÀn
 > 0) {

1435 
	`°∫˝y
(
emsg
, 
buf
, 
emsgÀn
 - 1);

1436 
emsg
[
emsgÀn
 - 1] = 
NUL
;

1439 
	`¶og
(
LOG_DEBUG
, "%s: %s: %s",

1440 
fun˘i⁄
, 
buf
, 
m©ches
 ? "matches" : "no match");

1442  
m©ches
;

1443 
	}
}

1445 
udphódî_t
 *

1446 
	$gëud±¨gë
(
buf
, 
buÊí
, 
hódî
, 
hódîÀn
, 
emsg
, 
emsgÀn
)

1447 c⁄° *
buf
;

1448 c⁄° 
size_t
 
buÊí
;

1449 
udphódî_t
 *
hódî
;

1450 
size_t
 *
hódîÀn
;

1451 *
emsg
;

1452 c⁄° 
size_t
 
emsgÀn
;

1454 c⁄° *
fun˘i⁄
 = "getudptarget()";

1456 i‡(
	`°rög2udphódî
(
buf
, 
buÊí
, 
hódî
Ë=
NULL
) {

1457 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1460 ()
buÊí
);

1462 
hódî
->
ho°
.
©y≥
 = 
SOCKS_ADDR_NOTSET
;

1463  
NULL
;

1466 i‡(
hódî
->
‰ag
 != 0) {

1467 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "fragmented socks udpÖacketsáreÇot supported");

1468  
NULL
;

1471 *
hódîÀn
 = 
	`HEADERSIZE_UDP
(
hódî
);

1473 
hódî
->
ho°
.
©y≥
) {

1474 
SOCKS_ADDR_IPV6
:

1475 i‡(
	`IN6_IS_ADDR_V4MAPPED
(&
hódî
->
ho°
.
addr
.
ùv6
.
ù
)) {

1481 
socksho°_t
 
c⁄vîãdho°
;

1483 
c⁄vîãdho°
 = 
hódî
->
ho°
;

1484 
	`ùv4_m≠≥d_to_ªguœr
(&
hódî
->
ho°
.
addr
.
ùv6
.
ù
,

1485 &
c⁄vîãdho°
.
addr
.
ùv4
);

1487 
hódî
->
ho°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

1488 
hódî
->
ho°
.
addr
.
ùv4
 = 
c⁄vîãdho°
.addr.ipv4;

1493 
SOCKS_ADDR_IPV4
:

1494 i‡(!
	`exã∫Æ_has_ßÁmûy
(
	`©y≥2ßÁmûy
(
hódî
->
ho°
.
©y≥
))) {

1495 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1498 
	`©y≥2°rög
(
hódî
->
ho°
.
©y≥
),

1499 
	`©y≥2°rög
(
hódî
->
ho°
.
©y≥
));

1501  
NULL
;

1506 
SOCKS_ADDR_DOMAIN
:

1510 
	`SERRX
(
hódî
->
ho°
.
©y≥
);

1513  
hódî
;

1514 
	}
}

	@sockd/fmt_sockd.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

50 
	$sockd_ªadmŸhîsc⁄åﬁsockë
(
¥efix
, 
s
)

51 c⁄° *
¥efix
;

52 c⁄° 
s
;

54 
ssize_t
 
rc
;

55 
buf
[256];

57 
rc
 = 
	`ªad
(
s
, 
buf
, (buf))) {

59 
	`¶og
(
LOG_ALERT
,

62 
¥efix
,

63 
î∫o
,

64 
	`°ªº‹
(
î∫o
),

65 
	`sockd_mŸhîexi°s
() ? "" : ": ",

66 
	`sockd_mŸhîexi°s
() ? "" : "mother unexpectedlyÉxited");

70 
	`¶og
(
LOG_ALERT
,

72 
¥efix
,

73 
	`sockd_mŸhîexi°s
() ? "" : ": ",

74 
	`sockd_mŸhîexi°s
() ? "" : "mother unexpectedlyÉxited");

78 i‡(
rc
 =1 && *
buf
 =
SOCKD_EXITNORMALLY
)

79 
	`¶og
(
LOG_DEBUG
, "%s: motherÅelling usÅoÉxitÇormally when done",

80 
¥efix
);

82 
	`sw¨n
("%s: unexpectedlyÑead %ld byte%s over IPC control channel "

84 
¥efix
, ()
rc
,Ñc == 1 ? "" : "s");

86 
	}
}

89 
	$log_˛õ¡£nd
(
˛õ¡
, 
chûd
, 
i§e£nd
)

90 c⁄° 
sockaddr_°‹age
 *
˛õ¡
;

91 c⁄° 
sockd_chûd_t
 *
chûd
;

92 c⁄° 
i§e£nd
;

95 
	`¶og
(
LOG_DEBUG
, "%s client %sÅo %s (pid %ld with %lu slots free)",

96 
i§e£nd
 ? "tryingágainÅo send" : "sending",

97 
	`sockaddr2°rög
(
˛õ¡
, 
NULL
, 0),

98 
	`chûdty≥2°rög
(
chûd
->
ty≥
),

99 ()
chûd
->
pid
,

100 ()
chûd
->
‰ìc
);

101 
	}
}

104 
	$log_¥obablytimedout
(
˛õ¡
, 
chûd
)

105 c⁄° 
sockaddr_°‹age
 *
˛õ¡
;

106 c⁄° 
sockd_chûd_t
 *
chûd
;

109 
	`sw¨n
("client %sÖrobablyÅimed out waiting for usÅo send itÅoá %s",

110 
	`sockaddr2°rög
(
˛õ¡
, 
NULL
, 0), 
	`chûdty≥2°rög
(
chûd
->
ty≥
));

111 
	}
}

114 
	$log_£ndÁûed
(
˛õ¡
, 
s
, 
chûd
, 
isfú°time
)

115 c⁄° 
sockaddr_°‹age
 *
˛õ¡
;

116 c⁄° 
s
;

117 c⁄° 
sockd_chûd_t
 *
chûd
;

118 c⁄° 
isfú°time
;

120 c⁄° 
î∫o_s
 = 
î∫o
;

122 i‡(
	`ERRNOISTMP
(
î∫o
))

123 
	`¶og
(
isfú°time
? 
LOG_DEBUG
 : 
LOG_NOTICE
,

125 
	`sockaddr2°rög
(
˛õ¡
, 
NULL
, 0),

126 
	`chûdty≥2°rög
(
chûd
->
ty≥
),

127 ()
chûd
->
pid
,

128 ()
chûd
->
‰ìc
,

129 
isfú°time
 ? "" : "ágain",

130 
	`°ªº‹
(
î∫o
));

135 i‡(
	`sockëisc⁄√˘ed
(
s
, 
NULL
, 0) == NULL)

136 
	`log_¥obablytimedout
(
˛õ¡
, 
chûd
);

138 
	`sw¨n
("sending client %sÅo %s %ld with %lu free slots failed",

139 
	`sockaddr2°rög
(
˛õ¡
, 
NULL
, 0),

140 
	`chûdty≥2°rög
(
chûd
->
ty≥
),

141 ()
chûd
->
pid
,

142 ()
chûd
->
‰ìc
);

145 
î∫o
 = 
î∫o_s
;

146 
	}
}

149 
	$log_no˛õ¡ªcv
(
chûd
)

150 c⁄° 
sockd_chûd_t
 *
chûd
;

153 
	`¶og
(
LOG_DEBUG
,

156 
	`chûdty≥2°rög
(
chûd
->
ty≥
),

157 
	`chûdty≥2°rög
(
chûd
->
ty≥
),

158 ()
chûd
->
pid
);

159 
	}
}

162 
	$log_åunˇãdudp
(
fun˘i⁄
, 
‰om
, 
Àn
)

163 c⁄° *
fun˘i⁄
;

164 c⁄° 
sockaddr_°‹age
 *
‰om
;

165 c⁄° 
ssize_t
 
Àn
;

168 
	`sw¨n
("%s: UDPÖacket from %s wasÅruncated (received bytes: %ld). "

172 
fun˘i⁄
,

173 
	`sockaddr2°rög
(
‰om
, 
NULL
, 0),

174 ()
Àn
,

175 
sockscf
.
›ti⁄
.
c⁄figfûe
);

176 
	}
}

179 
	$log_ruÀöfo_shmid
(
ruÀ
, 
fun˘i⁄
, 
c⁄ãxt
)

180 c⁄° 
ruÀ_t
 *
ruÀ
;

181 c⁄° *
fun˘i⁄
;

182 c⁄° *
c⁄ãxt
;

185 
	`¶og
(
LOG_DEBUG
,

188 
fun˘i⁄
,

189 
c⁄ãxt
 =
NULL
 ? "" : context,

190 
c⁄ãxt
 =
NULL
 ? "" : ": ",

191 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

192 ()
ruÀ
->
numbî
,

193 ()
ruÀ
->
bw_shmid
,

194 
ruÀ
->
bw
,

195 ()
ruÀ
->
m°©s_shmid
,

196 
ruÀ
->
m°©s
,

197 ()
ruÀ
->
ss_shmid
,

198 
ruÀ
->
ss
);

199 
	}
}

202 
	$log_boundexã∫Æaddªss
(
fun˘i⁄
, 
addr
)

203 c⁄° *
fun˘i⁄
;

204 c⁄° 
sockaddr_°‹age
 *
addr
;

207 
	`¶og
(
LOG_DEBUG
, "%s: boundáddress onÉxternal side is %s",

208 
fun˘i⁄
, 
	`sockaddr2°rög
(
addr
, 
NULL
, 0));

209 
	}
}

212 
	$log_u√x≥˘ed_ud¥ecv_îr‹
(
fun˘i⁄
, 
fd
, 
îr‹
, 
side
)

213 c⁄° *
fun˘i⁄
;

214 c⁄° 
fd
;

215 c⁄° 
îr‹
;

216 c⁄° 
öãrÁ˚side_t
 
side
;

219 
	`sw¨nx
("%s: unknownÉrror %d on %s-side whenÑeading UDP from fd %d. "

221 
fun˘i⁄
,

222 
îr‹
,

223 
side
 =
INTERNALIF
 ? "client" : "target",

224 
fd
,

225 
	`°ªº‹
(
îr‹
));

226 
	}
}

229 
	$log_böd_Áûed
(
fun˘i⁄
, 
¥Ÿocﬁ
, 
addªss
)

230 c⁄° *
fun˘i⁄
;

231 c⁄° 
¥Ÿocﬁ
;

232 c⁄° 
sockaddr_°‹age
 *
addªss
;

234 c⁄° 
no‰ìp‹ts


235 (
	`¡ohs
(
	`GET_SOCKADDRPORT
(
addªss
)Ë=(
ö_p‹t_t
)0 && 
î∫o
 =
EADDRINUSE
);

237 
	`¶og
(
no‰ìp‹ts
 ? 
LOG_WARNING
 : 
LOG_DEBUG
,

239 
fun˘i⁄
,

240 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
),

241 
	`¡ohs
(
	`GET_SOCKADDRPORT
(
addªss
)),

242 
	`sockaddr2°rög2
(
addªss
, 
ADDRINFO_ATYPE
, 
NULL
, 0),

243 
no‰ìp‹ts
 ?

246 : 
	`°ªº‹
(
î∫o
));

248 
	}
}

251 
	$log_öãrÁ˚¥Ÿocﬁ_£t_too_œã
(
side
)

252 c⁄° 
öãrÁ˚side_t
 
side
;

255 
	`yyîr‹x
("protocolsándáddress-families onÅhe %s-side interface must be "

258 
	`öãrÁ˚side2°rög
(
side
));

259 
	}
}

262 
	$log_gësock›t_Áûed
(
fun˘i⁄
, 
›ti⁄
, 
fd
, 
öãrÁ˚side
)

263 c⁄° *
fun˘i⁄
;

264 c⁄° *
›ti⁄
;

265 c⁄° 
fd
;

266 c⁄° 
öãrÁ˚side_t
 
öãrÁ˚side
;

269 
	`sw¨n
("%s: couldÇot getÅhe current %s value for fd %d onÅhe %s side",

270 
fun˘i⁄
,

271 
›ti⁄
,

272 
fd
,

273 
	`öãrÁ˚side2°rög
(
öãrÁ˚side
));

274 
	}
}

277 
	$log_£tsock›t_Áûed
(
fun˘i⁄
, 
›ti⁄
, 
vÆue
, 
fd
, 
öãrÁ˚side
)

278 c⁄° *
fun˘i⁄
;

279 c⁄° *
›ti⁄
;

280 c⁄° 
vÆue
;

281 c⁄° 
fd
;

282 c⁄° 
öãrÁ˚side_t
 
öãrÁ˚side
;

285 
	`sw¨n
("%s: couldÇot setÅhe %s value for fd %d onÅhe %s sideÅo %d",

286 
fun˘i⁄
,

287 
›ti⁄
,

288 
fd
,

289 
	`öãrÁ˚side2°rög
(
öãrÁ˚side
),

290 
vÆue
);

291 
	}
}

	@sockd/getoutaddr.c

46 
	~"comm⁄.h
"

48 c⁄° 
	grcsid
[] =

52 
addrsc›e_m©ches
(c⁄° 
sockaddr_ö6
 *
addr
,

53 c⁄° 
ùv6_addrsc›e_t
 
addrsc›e
);

60 
i‚ame_m©ches
(c⁄° *
i‚ame
, c⁄° 
uöt32_t
 
ifödex
);

68 
ß_Ámûy_t


69 
gë_exã∫Æ_ßÁmûy
(c⁄° 
sockaddr_°‹age
 *
˛õ¡
,

70 c⁄° 
comm™d
, c⁄° 
socksho°_t
 *
ªqho°
);

81 
sockaddr_°‹age
 *

82 
gëdeÁu…exã∫Æ
(c⁄° 
ß_Ámûy_t
 
ßÁmûy
, 
ùv6_addrsc›e_t
 
addrsc›e
,

83 c⁄° 
uöt32_t
 
ifödex
, 
sockaddr_°‹age
 *
addr
);

102 
sockaddr_°‹age
 *

103 
	$gëouèddr
(
œddr
, 
˛õ¡_l
, 
˛õ¡_r
, 
cmd
, 
ªqho°
, 
emsg
, 
emsgÀn
)

104 
sockaddr_°‹age
 *
œddr
;

105 c⁄° 
sockaddr_°‹age
 *
˛õ¡_l
;

106 c⁄° 
sockaddr_°‹age
 *
˛õ¡_r
;

107 c⁄° 
cmd
;

108 c⁄° 
socksho°_t
 *
ªqho°
;

109 *
emsg
;

110 c⁄° 
size_t
 
emsgÀn
;

112 c⁄° *
fun˘i⁄
 = "getoutaddr()";

113 
sockaddr_°‹age
 
øddr
;

114 
addr°r
[
MAXSOCKADDRSTRING
], 
øddr°r
[
MAXSOCKSHOSTSTRING
];

116 
	`¶og
(
LOG_DEBUG
,

118 
fun˘i⁄
,

119 
	`sockaddr2°rög
(
˛õ¡_r
, 
addr°r
, (addrstr)),

120 
	`comm™d2°rög
(
cmd
),

121 
	`socksho°2°rög
(
ªqho°
, 
øddr°r
, (raddrstr)),

122 
	`rŸ©i⁄2°rög
(
sockscf
.
exã∫Æ
.
rŸ©i⁄
));

124 
	`bzîo
(&
øddr
, (raddr));

130 
cmd
) {

131 
SOCKS_BIND
:

132 i‡(
ªqho°
->
©y≥
 =
SOCKS_ADDR_IPV4


133 && 
ªqho°
->
addr
.
ùv4
.
s_addr
 =
	`ht⁄l
(
BINDEXTENSION_IPADDR
))

134 
	`SET_SOCKADDR
(&
øddr
, 
	`exã∫Æ_has_globÆ_ßÁmûy
(
AF_INET
) ?

135 
AF_INET
 : 
AF_INET6
);

136 i‡(
ªqho°
->
©y≥
 =
SOCKS_ADDR_IPV4


137 || 
ªqho°
->
©y≥
 =
SOCKS_ADDR_IPV6
)

138 
	`socksho°2sockaddr
(
ªqho°
, &
øddr
);

150 
gaõº
;

152 
	`SASSERTX
(
ªqho°
->
©y≥
 =
SOCKS_ADDR_DOMAIN
);

154 
	`socksho°2sockaddr2
(
ªqho°
, &
øddr
, &
gaõº
, 
emsg
, 
emsgÀn
);

155 i‡(
gaõº
 != 0) {

156 
	`log_ªsﬁveÁûed
(
ªqho°
->
addr
.
domaö
, 
EXTERNALIF
, 
gaõº
);

157  
NULL
;

163 
SOCKS_CONNECT
:

164 
SOCKS_UDPASSOCIATE
: {

165 
gaõº
;

167 
	`socksho°2sockaddr2
(
ªqho°
, &
øddr
, &
gaõº
, 
emsg
, 
emsgÀn
);

168 i‡(
gaõº
 != 0) {

169 
	`SASSERTX
(
ªqho°
->
©y≥
 =
SOCKS_ADDR_DOMAIN
);

171 
	`log_ªsﬁveÁûed
(
ªqho°
->
addr
.
domaö
, 
EXTERNALIF
, 
gaõº
);

172  
NULL
;

179 
	`SERRX
(
cmd
);

182 
sockscf
.
exã∫Æ
.
rŸ©i⁄
) {

183 
ROTATION_NONE
:

191 
	`gëdeÁu…exã∫Æ
(
øddr
.
ss_Ámûy
,

192 
øddr
.
ss_Ámûy
 =
AF_INET6
 ?

193 
	`ùv6_addrsc›e
(&
	`TOIN6
(&
øddr
)->
sö6_addr
)

194 : 
addrsc›e_globÆ
,

195 
	`TOIN6
(&
øddr
)->
sö6_sc›e_id
,

196 
œddr
);

199 
ROTATION_SAMESAME
:

200 i‡(
˛õ¡_l
->
ss_Ámûy
 =
øddr
.ss_family)

201 *
œddr
 = *
˛õ¡_l
;

203 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

208 
	`rŸ©i⁄2°rög
(
sockscf
.
exã∫Æ
.
rŸ©i⁄
),

209 
	`comm™d2°rög
(
cmd
),

210 
	`ßÁmûy2°rög
(
˛õ¡_l
->
ss_Ámûy
),

211 
	`sockaddr2°rög
(
˛õ¡_l
, 
NULL
, 0),

212 
	`ßÁmûy2°rög
(
øddr
.
ss_Ámûy
),

213 
	`sockaddr2°rög
(&
øddr
, 
øddr°r
, (raddrstr)));

215 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

216  
NULL
;

221 
ROTATION_ROUTE
: {

222 i‡(
	`IPADDRISBOUND
(&
øddr
)) {

227 
socksho°_t
 
ho°
;

228 
s
;

230 i‡((
s
 = 
	`sockë
(
øddr
.
ss_Ámûy
, 
SOCK_DGRAM
, 0)) == -1) {

231 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

233 
	`ßÁmûy2°rög
(
øddr
.
ss_Ámûy
), 
	`°ªº‹
(
î∫o
));

235 
	`sw¨n
("%s: %s", 
fun˘i⁄
, 
emsg
);

236  
NULL
;

239 i‡(!
	`PORTISBOUND
(&
øddr
))

241 
	`SET_SOCKADDRPORT
(&
øddr
, 1);

243 
	`sockaddr2socksho°
(&
øddr
, &
ho°
);

244 i‡(
	`socks_c⁄√˘ho°
(
s
,

245 
EXTERNALIF
,

246 &
ho°
,

247 
œddr
,

248 
NULL
,

250 
emsg
,

251 
emsgÀn
) == -1) {

252 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

253 
	`˛o£
(
s
);

255 i‡(
cmd
 =
SOCKS_UDPASSOCIATE
)

256  
NULL
;

265 
	`gëdeÁu…exã∫Æ
(
øddr
.
ss_Ámûy
,

266 
øddr
.
ss_Ámûy
 =
AF_INET6
 ?

267 
	`ùv6_addrsc›e
(&
	`TOIN6
(&
øddr
)->
sö6_addr
)

268 : 
addrsc›e_globÆ
,

269 
	`TOIN6
(&
øddr
)->
sö6_sc›e_id
,

270 
œddr
);

274 
	`˛o£
(
s
);

277 
	`gëdeÁu…exã∫Æ
(
	`gë_exã∫Æ_ßÁmûy
(
˛õ¡_r
, 
cmd
, 
ªqho°
),

278 
addrsc›e_globÆ
,

280 
œddr
);

286 
	`SERRX
(
sockscf
.
exã∫Æ
.
rŸ©i⁄
);

289 i‡(
	`addrödex_⁄_exã∫Æli°
(&
sockscf
.
exã∫Æ
, 
œddr
) != -1)

290 
	`¶og
(
LOG_DEBUG
,

292 
fun˘i⁄
,

293 
	`sockaddr2°rög2
(
œddr
, 0, 
addr°r
, (addrstr)),

294 
	`sockaddr2°rög
(
˛õ¡_r
, 
NULL
, 0),

295 
	`sockaddr2°rög
(&
øddr
, 
øddr°r
, (raddrstr)));

297 
rŸ©i⁄
[256];

299 i‡(
sockscf
.
exã∫Æ
.
rŸ©i⁄
 =
ROTATION_NONE
)

300 *
rŸ©i⁄
 = 
NUL
;

302 
	`¢¥ötf
(
rŸ©i⁄
, (rotation),

304 
	`rŸ©i⁄2°rög
(
sockscf
.
exã∫Æ
.
rŸ©i⁄
));

306 i‡(
	`IPADDRISBOUND
(
œddr
))

307 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

312 
rŸ©i⁄
,

313 
	`sockaddr2°rög2
(
œddr
, 0, 
addr°r
, (addrstr)),

314 
	`sockaddr2°rög
(
˛õ¡_r
, 
NULL
, 0),

315 
	`sockaddr2°rög
(&
øddr
, 
øddr°r
, (raddrstr)),

316 
sockscf
.
›ti⁄
.
c⁄figfûe
);

318 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

322 
rŸ©i⁄
,

323 
	`sockaddr2°rög
(
˛õ¡_r
, 
NULL
, 0),

324 
	`sockaddr2°rög
(&
øddr
, 
øddr°r
, (raddrstr)),

325 
sockscf
.
›ti⁄
.
c⁄figfûe
);

334 
	`¶og
(
	`exã∫Æ_has_ßÁmûy
(
œddr
->
ss_Ámûy
Ë? 
LOG_WARNING
 : 
LOG_DEBUG
,

335 "%s: %s", 
fun˘i⁄
, 
emsg
);

337  
NULL
;

344 
cmd
) {

345 #i‡
SOCKS_SERVER


346 
SOCKS_BIND
:

347 i‡(
ªqho°
->
©y≥
 =
SOCKS_ADDR_IPV4


348 && 
ªqho°
->
addr
.
ùv4
.
s_addr
 =
	`ht⁄l
(
BINDEXTENSION_IPADDR
))

349 
	`SET_SOCKADDRPORT
(
œddr
, 
	`GET_SOCKADDRPORT
(
˛õ¡_r
));

350 i‡–(
øddr
.
ss_Ámûy
 =
AF_INET


351 && 
	`TOIN
(&
øddr
)->
sö_addr
.
s_addr
 =
	`ht⁄l
(
INADDR_ANY
))

352 || (
øddr
.
ss_Ámûy
 =
AF_INET6


353 && 
	`memcmp
(&
	`TOIN6
(&
øddr
)->
sö6_addr
,

354 &
ö6addr_™y
,

355 (
ö6addr_™y
)) == 0))

356 
	`SET_SOCKADDRPORT
(
œddr
, 
ªqho°
->
p‹t
);

358 
	`SET_SOCKADDRPORT
(
œddr
, 
	`ht⁄s
(0));

363 
SOCKS_CONNECT
:

364 
SOCKS_UDPASSOCIATE
:

365 
	`SET_SOCKADDRPORT
(
œddr
, 
	`GET_SOCKADDRPORT
(
˛õ¡_r
));

369 
	`SERRX
(
cmd
);

372 
	`SASSERTX
(
	`IPADDRISBOUND
(
œddr
));

374  
œddr
;

375 
	}
}

377 
sockaddr_°‹age
 *

378 
	$gëöaddr
(
œddr
, 
_˛õ¡
, 
emsg
, 
emsgÀn
)

379 
sockaddr_°‹age
 *
œddr
;

380 c⁄° 
sockaddr_°‹age
 *
_˛õ¡
;

381 *
emsg
;

382 c⁄° 
size_t
 
emsgÀn
;

384 c⁄° *
fun˘i⁄
 = "getinaddr()";

385 
sockaddr_°‹age
 
˛õ¡
;

386 
size_t
 
i
;

388 
	`¶og
(
LOG_DEBUG
, "%s: client %s",

389 
fun˘i⁄
, 
	`sockaddr2°rög
(
_˛õ¡
, 
NULL
, 0));

391 
	`SASSERTX
(
_˛õ¡
->
ss_Ámûy
 =
AF_INET
 || _˛õ¡->ss_Ámûy =
AF_INET6
);

393 
	`sockaddr˝y
(&
˛õ¡
, 
_˛õ¡
, (client));

399 
i
 = 0; i < 
sockscf
.
öã∫Æ
.
addrc
; ++i) {

400 i‡(
sockscf
.
öã∫Æ
.
addrv
[
i
].
addr
.
ss_Ámûy
 =
˛õ¡
.ss_family) {

401 
	`sockaddr˝y
(
œddr
, &
sockscf
.
öã∫Æ
.
addrv
[
i
].
addr
, (*laddr));

403 
	`¶og
(
LOG_DEBUG
, "%s:áddress %s selected",

404 
fun˘i⁄
, 
	`sockaddr2°rög
(
œddr
, 
NULL
, 0));

406  
œddr
;

410 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "no %s found on our internaláddressÜist",

411 
	`ßÁmûy2°rög
(
˛õ¡
.
ss_Ámûy
));

413 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

415  
NULL
;

416 
	}
}

418 
sockaddr_°‹age
 *

419 
	$gëdeÁu…exã∫Æ
(
ßÁmûy
, 
addrsc›e
, 
ifödex
, 
addr
)

420 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

421 c⁄° 
ùv6_addrsc›e_t
 
addrsc›e
;

422 c⁄° 
uöt32_t
 
ifödex
;

423 
sockaddr_°‹age
 *
addr
;

425 c⁄° *
fun˘i⁄
 = "getdefaultexternal()";

426 c⁄° *
ßÁmûy°rög
 = (
ßÁmûy
 =
AF_UNSPEC
 ?

427 "<™yáddªss>" : 
	`ßÁmûy2°rög
(
ßÁmûy
));

428 c⁄° *
addrsc›e°rög
 = 
	`addrsc›e2°rög
(
addrsc›e
);

429 
size_t
 
i
, 
addrfound
;

431 
	`¶og
(
LOG_DEBUG
, "%s:Üooking forán %s with scopeid %d/%s, ifindex %d",

432 
fun˘i⁄
, 
ßÁmûy°rög
, 
addrsc›e
, 
addrsc›e°rög
, 
ifödex
);

434 
i
 = 0, 
addrfound
 = 0; i < 
sockscf
.
exã∫Æ
.
addrc
 && !addrfound; ++i) {

435 
sockscf
.
exã∫Æ
.
addrv
[
i
].
©y≥
) {

436 
SOCKS_ADDR_IFNAME
: {

437 
sockaddr_°‹age
 
mask
;

439 
size_t
 
ii
 = 0;

440 
	`i‚ame2sockaddr
(
sockscf
.
exã∫Æ
.
addrv
[
i
].
addr
.
i‚ame
,

441 
ii
++,

442 
addr
,

443 &
mask
Ë!
NULL
) {

444 i‡(
ßÁmûy
 =
AF_UNSPEC
 || 
addr
->
ss_Ámûy
 == safamily) {

445 i‡(
ßÁmûy
 =
AF_INET6
) {

446 i‡(!
	`addrsc›e_m©ches
(
	`TOIN6
(
addr
), 
addrsc›e
))

449 i‡(
addrsc›e
 =
addrsc›e_lökloˇl


450 && !
	`i‚ame_m©ches
(
sockscf
.
exã∫Æ
.
addrv
[
i
].
addr
.
i‚ame
,

451 
ifödex
))

455 
addrfound
 = 1;

463 
SOCKS_ADDR_IPV4
:

464 
SOCKS_ADDR_IPV6
:

465 i‡(
ßÁmûy
 !
AF_UNSPEC


466 && 
ßÁmûy
 !
	`©y≥2ßÁmûy
(
sockscf
.
exã∫Æ
.
addrv
[
i
].
©y≥
)) {

467 
	`¶og
(
LOG_DEBUG
,

469 
fun˘i⁄
,

470 
	`ruÀaddr2°rög
(&
sockscf
.
exã∫Æ
.
addrv
[
i
],

471 
ADDRINFO_ATYPE
,

472 
NULL
,

474 
	`ßÁmûy2°rög
(
ßÁmûy
));

478 
	`socksho°2sockaddr
(
	`ruÀaddr2socksho°
(&
sockscf
.
exã∫Æ
.
addrv
[
i
],

479 
NULL
,

480 
SOCKS_TCP
),

481 
addr
);

483 i‡(
addr
->
ss_Ámûy
 =
AF_INET6
) {

484 c⁄° *
i‚ame
;

486 i‡(
addrsc›e
 =
addrsc›e_nodñoˇl
)

492 i‡(!
	`addrsc›e_m©ches
(
	`TOIN6
(
addr
), 
addrsc›e
))

495 i‡((
i‚ame
 = 
	`sockaddr2i‚ame
(
addr
, 
NULL
, 0)) == NULL) {

496 
	`sw¨nx
("%s: couldÇot findány interface witháddress %s",

497 
fun˘i⁄
, 
	`sockaddr2°rög
(
addr
, 
NULL
, 0));

502 i‡(
addrsc›e
 =
addrsc›e_lökloˇl


503 && !
	`i‚ame_m©ches
(
i‚ame
, 
ifödex
))

507 
addrfound
 = 1;

511 
	`SERRX
((*
sockscf
.
exã∫Æ
.
addrv
).
©y≥
);

515 i‡(
addrfound
)

516 
	`¶og
(
LOG_DEBUG
, "%s: matched %s %s",

517 
fun˘i⁄
,

518 
ßÁmûy°rög
,

519 
	`sockaddr2°rög2
(
addr
, 
ADDRINFO_SCOPEID
 | 
ADDRINFO_PORT
, 
NULL
, 0));

521 
	`¶og
(
LOG_DEBUG
,

523 
fun˘i⁄
, 
ßÁmûy°rög
);

525 
	`bzîo
(
addr
, (*addr));

526 
	`SET_SOCKADDR
(
addr
, 
ßÁmûy
 =
AF_UNSPEC
 ? 
AF_INET
 : safamily);

529  
addr
;

530 
	}
}

532 
ß_Ámûy_t


533 
	$gë_exã∫Æ_ßÁmûy
(
˛õ¡
, 
comm™d
, 
ªqho°
)

534 c⁄° 
sockaddr_°‹age
 *
˛õ¡
;

535 c⁄° 
comm™d
;

536 c⁄° 
socksho°_t
 *
ªqho°
;

538 c⁄° *
fun˘i⁄
 = "get_external_safamily()";

539 
ß_Ámûy_t
 
ßÁmûy
;

541 
comm™d
) {

542 
SOCKS_BIND
:

543 
SOCKS_UDPASSOCIATE
:

544 
ªqho°
->
©y≥
) {

545 
SOCKS_ADDR_IPV4
:

546 
SOCKS_ADDR_IPV6
:

547 
ßÁmûy
 = 
	`©y≥2ßÁmûy
(
ªqho°
->
©y≥
);

550 
SOCKS_ADDR_DOMAIN
: {

551 
sockaddr_°‹age
 
p
;

553 
	`socksho°2sockaddr
(
ªqho°
, &
p
);

554 i‡(
	`IPADDRISBOUND
(&
p
))

555 
ßÁmûy
 = 
p
.
ss_Ámûy
;

557 
ßÁmûy
 = 
˛õ¡
->
ss_Ámûy
;

563 
	`SERRX
(
ªqho°
->
©y≥
);

567 
SOCKS_CONNECT
: {

568 
sockaddr_°‹age
 
p
;

570 
	`socksho°2sockaddr
(
ªqho°
, &
p
);

571 i‡(
	`IPADDRISBOUND
(&
p
))

572 
ßÁmûy
 = 
p
.
ss_Ámûy
;

574 
ßÁmûy
 = 
˛õ¡
->
ss_Ámûy
;

580 
	`SERRX
(
comm™d
);

583 i‡(
	`exã∫Æ_has_ßÁmûy
(
ßÁmûy
))

584  
ßÁmûy
;

589 
ßÁmûy
) {

590 
AF_INET
:

591 i‡(
	`exã∫Æ_has_ßÁmûy
(
AF_INET6
))

592  
AF_INET6
;

596 
AF_INET6
:

597 i‡(
	`exã∫Æ_has_ßÁmûy
(
AF_INET
))

598  
AF_INET
;

603 
	`SERRX
(
ßÁmûy
);

606 
	`sw¨nx
("%s: strange ... couldÇot findányáddressÅo bind onÉxternal side "

609 
fun˘i⁄
,

610 
	`comm™d2°rög
(
comm™d
),

611 
	`sockaddr2°rög
(
˛õ¡
, 
NULL
, 0),

612 
	`socksho°2°rög
(
ªqho°
, 
NULL
, 0),

613 
	`exã∫Æ_has_ßÁmûy
(
AF_INET
) ? "Yes" : "No",

614 
	`exã∫Æ_has_ßÁmûy
(
AF_INET6
) ?

615 
	`exã∫Æ_has_globÆ_ßÁmûy
(
AF_INET6
) ?

619  
AF_UNSPEC
;

620 
	}
}

623 
	$addrsc›e_m©ches
(
addr
, 
sc›e
)

624 c⁄° 
sockaddr_ö6
 *
addr
;

625 c⁄° 
ùv6_addrsc›e_t
 
sc›e
;

627 c⁄° *
fun˘i⁄
 = "addrscope_matches()";

628 c⁄° 
ùv6_addrsc›e_t
 
addrsc›e
 = 
	`ùv6_addrsc›e
(&
addr
->
sö6_addr
);

630 i‡(
addrsc›e
 =
sc›e
)

633 i‡(
sc›e
 =
addrsc›e_nodñoˇl


634 && 
addrsc›e
 =
addrsc›e_globÆ
)

643 i‡(
sockscf
.
›ti⁄
.
debug
)

644 
	`¶og
(
LOG_DEBUG
,

648 
fun˘i⁄
,

649 
	`sockaddr2°rög
(
	`TOCSS
(
addr
), 
NULL
, 0),

650 
addr
->
sö6_sc›e_id
,

651 
	`ùv6_addrsc›e
(&
addr
->
sö6_addr
),

652 
	`addrsc›e2°rög
(
	`ùv6_addrsc›e
(&
addr
->
sö6_addr
)),

653 ()
sc›e
,

654 
	`addrsc›e2°rög
(
sc›e
));

657 
	}
}

660 
	$i‚ame_m©ches
(
i‚ame
, 
ifödex
)

661 c⁄° *
i‚ame
;

662 c⁄° 
uöt32_t
 
ifödex
;

664 c⁄° *
fun˘i⁄
 = "ifname_matches()";

665 
uöt32_t
 
i‚ameödex
;

666 
m©ches
;

668 i‡((
i‚ameödex
 = 
	`if_«mëoödex
(
i‚ame
)) == 0) {

669 
	`sw¨n
("%s: if_«mëoödex(%sËÁûed", 
fun˘i⁄
, 
i‚ame
);

673 
m©ches
 = (
i‚ameödex
 =
ifödex
);

675 
	`¶og
(
LOG_DEBUG
, "%s: ifname %s/ifindex %u %s ifindex %u",

676 
fun˘i⁄
,

677 
i‚ame
,

678 
i‚ameödex
,

679 
m©ches
 ? "matches" : "doesÇot match",

680 
ifödex
);

682  
m©ches
;

683 
	}
}

	@sockd/ldap_util.c

49 
	~"comm⁄.h
"

51 c⁄° 
	grcsid
[] =

54 #i‡
HAVE_LDAP


56 *
	$asciôoutf8
(
öput
)

57 *
öput
;

59 c⁄° *
fun˘i⁄
 = "asciitoutf8()";

60 
size_t
 
n
, 
a
;

61 *
p
, *
utf8
;

62 *
©
;

63 
c
, 
s
;

65 
	`SASSERTX
(
öput
 !
NULL
);

67 
n
 = 0, 
c
 = 0;Ç < 
	`°æí
(
öput
); ++n)

68 i‡(()
öput
[
n
] > 127)

69 
c
++;

71 
©
 = 
	`°ºchr
(
öput
, '@');

72 i‡(
©
)

73 
a
 = 
©
 - 
öput
;

75 
a
 = 
	`°æí
(
öput
) - 1;

77 i‡(
c
 != 0) {

78 i‡((
p
 = 
	`mÆloc
(
	`°æí
(
öput
Ë+ 1 + 
c
)Ë=
NULL
)

79 
	`£ºx
("%s: %s", 
fun˘i⁄
, 
NOMEM
);

81 
utf8
 = 
p
;

82 
n
 = 0;Ç < 
	`°æí
(
öput
); ++n) {

83 i‡(
n
 =
a
) {

87 
s
 = ()
öput
[
n
];

92 i‡(
s
 > 127 && s < 192) {

93 *
p
 = 194;

94 
p
++;

95 *
p
 = 
s
;

96 } i‡(
s
 > 191 && s < 256) {

97 *
p
 = 195;

98 
p
++;

99 *
p
 = 
s
 - 64;

101 *
p
 = 
s
;

102 
p
++;

105 *
p
 = 
NUL
;

107 
	`¶og
(
LOG_DEBUG
, "%s: Grou∞%†a†UTF-8: %s", 
fun˘i⁄
, 
öput
, 
utf8
);

109  (*)
utf8
;

112  
öput
;

113 
	}
}

116 *
	$hextoutf8
(
öput
, 
Êag
)

117 c⁄° *
öput
;

118 
Êag
;

134 c⁄° *
fun˘i⁄
 = "hextoutf8()";

135 
size_t
 
i
, 
n
, 
a
;

136 *
utf8
;

137 *
p
, *
©
;

138 
ivÆ
, 
ich¨
, 
iUTF2
, 
iUTF3
, 
iUTF4
;

140 
	`SASSERTX
(
öput
 !
NULL
);

142 
©
 = 
	`°ºchr
(
öput
, '@');

143 i‡(
©
)

144 
a
 = 
©
 - 
öput
;

146 
a
 = 
	`°æí
(
öput
) ;

148 i‡((
utf8
 = 
	`mÆloc
(
	`°æí
(
öput
Ë+ 1)Ë=
NULL
)

149 
	`£ºx
("%s: %s", 
fun˘i⁄
, 
NOMEM
);

151 
i
 = 0;

152 
iUTF2
 = 0;

153 
iUTF3
 = 0;

154 
iUTF4
 = 0;

156 
n
 = 0;

157 
n
 < 
	`°æí
(
öput
)) {

158 i‡(!
Êag
 && 
n
 =
a
) {

162 i‡(
Êag
 < 2 && 
öput
[
n
] == '@') {

164 
utf8
[
i
] = '@';

165 
i
++;

166 
n
++;

169 
ivÆ
 = 
öput
[
n
];

170 i‡(
ivÆ
 > 64 && ival < 71)

171 
ich¨
 = (
ivÆ
 - 55) * 16;

172 i‡(
ivÆ
 > 96 && ival < 103)

173 
ich¨
 = (
ivÆ
 - 87)*16;

174 i‡(
ivÆ
 > 47 && ival < 58)

175 
ich¨
 = (
ivÆ
 - 48)*16;

177 
	`¶og
(
LOG_DEBUG
, "%s: invÆid Hex vÆuê0x%x", 
fun˘i⁄
, 
ivÆ
);

179 
	`SASSERTX
((
ivÆ
 > 64 && ival < 71) ||

180 (
ivÆ
 > 96 && ival < 103) ||

181 (
ivÆ
 > 47 && ival < 58));

184 i‡(
n
 =
a
 - 1) {

185 
	`¶og
(
LOG_DEBUG
, "%s: invÆid Hex UTF-8 såög \"%s\"", 
fun˘i⁄
, 
öput
);

186 
	`SASSERTX
(
n
 < 
a
 - 1);

189 
n
++;

190 
ivÆ
 = 
öput
[
n
];

191 i‡(
ivÆ
 > 64 && ivÆ < 71Ë
ich¨
 = ichar + ival - 55;

192 i‡(
ivÆ
 > 96 && ivÆ < 103Ë
ich¨
 = ichar + ival - 87;

193 i‡(
ivÆ
 > 47 && ivÆ < 58Ë
ich¨
 = ichar + ival - 48;

195 
	`¶og
(
LOG_DEBUG
, "%s: invÆid Hex vÆuê0x%x", 
fun˘i⁄
, 
ivÆ
);

196 
	`SASSERTX
((
ivÆ
 > 64 && ival < 71) ||

197 (
ivÆ
 > 96 && ival < 103) ||

198 (
ivÆ
 > 47 && ival < 58));

201 i‡(
iUTF2
) {

202 i‡(
iUTF2
 =0xC2 && 
ich¨
 > 0x7F && ichar < 0xC0) {

203 
iUTF2
 = 0;

204 
utf8
[
i
-1] = 
ich¨
;

206 i‡(
iUTF2
 =0xC3 && 
ich¨
 > 0x7F && ichar < 0xC0) {

207 
iUTF2
 = 0;

208 
utf8
[
i
-1] = 
ich¨
 + 64;

210 i‡(
iUTF2
 > 0xC3 && iUTF2 < 0xE0 && 
ich¨
 > 0x7F

211 && 
ich¨
 < 0xC0) {

212 
iUTF2
 = 0;

213 
utf8
[
i
] = 
ich¨
;

214 
i
++;

217 
iUTF2
 = 0;

218 
utf8
[
i
] = 
ich¨
;

219 
utf8
[
i
 + 1] = 
NUL
;

221 
	`¶og
(
LOG_DEBUG
, "%s: invalid UTF-8 sequence for Unicode \"%s\"",

222 
fun˘i⁄
, 
utf8
);

224 
	`SASSERTX
((
iUTF2
 =0xC2 && 
ich¨
 > 0x7F && ichar < 0xC0)

225 || (
iUTF2
 =0xC3 && 
ich¨
 > 0x7F && ichar < 0xC0)

226 || (
iUTF2
 > 0xC3 && iUTF2 < 0xE0 && 
ich¨
 > 0x7F

227 && 
ich¨
 < 0xC0));

230 i‡(
iUTF3
) {

231 i‡(
iUTF3
 =0xE0 && 
ich¨
 > 0x9F && ichar < 0xC0) {

232 
iUTF3
 = 1;

233 
utf8
[
i
] = 
ich¨
;

234 
i
++;

236 i‡(
iUTF3
 > 0xE0 && iUTF3 < 0xED && 
ich¨
 > 0x7F

237 && 
ich¨
 < 0xC0) {

238 
iUTF3
 = 2;

239 
utf8
[
i
] = 
ich¨
;

240 
i
++;

242 i‡(
iUTF3
 =0xED && 
ich¨
 > 0x7F && ichar < 0xA0) {

243 
iUTF3
 = 3;

244 
utf8
[
i
] = 
ich¨
;

245 
i
++;

247 i‡(
iUTF3
 > 0xED && iUTF3 < 0xF0 && 
ich¨
 > 0x7F && ichar < 0xC0){

248 
iUTF3
 = 4;

249 
utf8
[
i
] = 
ich¨
;

250 
i
++;

252 i‡(
iUTF3
 > 0 && iUTF3 < 5 && 
ich¨
 > 0x7F && ichar < 0xC0) {

253 
iUTF3
 = 0;

254 
utf8
[
i
] = 
ich¨
;

255 
i
++;

258 
iUTF3
 = 0;

259 
utf8
[
i
] = 
ich¨
;

260 
utf8
[
i
 + 1] = 
NUL
;

262 
	`¶og
(
LOG_DEBUG
, "%s: invalid UTF-8 sequence for unicode \"%s\"",

263 
fun˘i⁄
, 
utf8
);

265 
	`SASSERTX
((
iUTF3
 =0xE0 && 
ich¨
 > 0x9F && ichar < 0xC0)

266 || (
iUTF3
 > 0xE0 && iUTF3 < 0xED && 
ich¨
 > 0x7F

267 && 
ich¨
 < 0xC0)

268 || (
iUTF3
 =0xED && 
ich¨
 > 0x7F && ichar < 0xA0)

269 || (
iUTF3
 > 0xED && iUTF3 < 0xF0 && 
ich¨
 > 0x7F

270 && 
ich¨
 < 0xC0)

271 || (
iUTF3
 > 0 && iUTF3 < 5 && 
ich¨
 > 0x7F && ichar < 0xC0));

274 i‡(
iUTF4
) {

275 i‡(
iUTF4
 =0xF0 && 
ich¨
 > 0x8F && ichar < 0xC0) {

276 
iUTF4
 = 1;

277 
utf8
[
i
] = 
ich¨
;

278 
i
++;

280 i‡(
iUTF4
 > 0xF0 && 
iUTF3
 < 0xF4 && 
ich¨
 > 0x7F && ichar < 0xC0){

281 
iUTF4
 = 2;

282 
utf8
[
i
] = 
ich¨
;

283 
i
++;

285 i‡(
iUTF4
 =0xF4 && 
ich¨
 > 0x7F && ichar < 0x90) {

286 
iUTF4
 = 3;

287 
utf8
[
i
] = 
ich¨
;

288 
i
++;

290 i‡(
iUTF4
 > 0 && iUTF4 < 5 && 
ich¨
 > 0x7F && ichar < 0xC0) {

291 i‡(
iUTF4
 == 4)

292 
iUTF4
 = 0;

294 
iUTF4
 = 4;

296 
utf8
[
i
] = 
ich¨
;

297 
i
++;

300 
iUTF4
 = 0;

301 
utf8
[
i
] = 
ich¨
;

302 
utf8
[
i
 + 1] = 
NUL
;

304 
	`¶og
(
LOG_DEBUG
, "%s: invalid UTF-8 sequence for Unicode \"%s\"",

305 
fun˘i⁄
, 
utf8
);

307 
	`SASSERTX
((
iUTF4
 =0xF0 && 
ich¨
 > 0x8F && ichar < 0xC0)

308 || (
iUTF4
 > 0xF0 && 
iUTF3
 < 0xF4 && 
ich¨
 > 0x7F

309 && 
ich¨
 < 0xC0)

310 || (
iUTF4
 =0xF4 && 
ich¨
 > 0x7F && ichar < 0x90)

311 || (
iUTF4
 > 0 && iUTF4 < 5 && 
ich¨
 > 0x7F && ichar < 0xC0));

314 i‡(
ich¨
 < 0x80) {

316 
utf8
[
i
] = 
ich¨
;

317 
i
++;

319 i‡(
ich¨
 > 0xC1 && ichar < 0xE0) {

321 
iUTF2
 = 
ich¨
;

322 
utf8
[
i
] = 
ich¨
;

323 
i
++;

325 i‡(
ich¨
 > 0xDF && ichar < 0xF0) {

327 
iUTF3
 = 
ich¨
;

328 
utf8
[
i
] = 
ich¨
;

329 
i
++;

331 i‡(
ich¨
 > 0xEF && ichar < 0xF5) {

333 
iUTF4
 = 
ich¨
;

334 
utf8
[
i
] = 
ich¨
;

335 
i
++;

337 
utf8
[
i
] = 
ich¨
;

338 
utf8
[
i
+1] = 
NUL
;

340 
	`¶og
(
LOG_DEBUG
, "%s: invalid UTF-8 sequence for Unicode \"%s\"",

341 
fun˘i⁄
, 
utf8
);

343 
	`SASSERTX
(
iUTF2
 || 
iUTF3
 || 
iUTF4
 || (
ich¨
 < 0x80)

344 || (
ich¨
 > 0xC1 && ichar < 0xE0)

345 || (
ich¨
 > 0xDF && ichar < 0xF0)

346 || (
ich¨
 > 0xEF && ichar < 0xF5));

349 
n
++;

352 
utf8
[
i
] = 
NUL
;

353 i‡(
iUTF2
 || 
iUTF3
 || 
iUTF4
) {

354 
	`¶og
(
LOG_DEBUG
, "%s: invalid UTF-8 sequence for Unicode \"%s\"",

355 
fun˘i⁄
, 
utf8
);

357 
	`SASSERTX
(!
iUTF2
 && !
iUTF3
 && !
iUTF4
);

360 
p
 = (*)
utf8
;

361 i‡(!
Êag
 && 
©
)

362 
	`°rˇt
(
p
, 
©
);

364  
p
;

365 
	}
}

	@sockd/math.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 
	~<m©h.h
>

52 
	$medtv
(
timevÆ
 *
tv¨r
, 
size_t
 
tvsize
)

54 
timevÆ
 
med
;

56 i‡(
tvsize
 == 0)

58 i‡(
tvsize
 == 1)

59 
med
 = 
tv¨r
[
tvsize
 - 1];

60 i‡(
tvsize
 % 2 == 1)

61 
med
 = 
tv¨r
[(
tvsize
 - 1) / 2];

63 
	`timîadd
(&
tv¨r
[(
tvsize
 - 1Ë/ 2], &tv¨r[—vsizê- 1Ë/ 2 + 1], &
med
);

64  
	`tv2us
(&
med
) / 2;

67  
	`tv2us
(&
med
);

68 
	}
}

71 
	$avgtv
(
timevÆ
 *
tv¨r
, 
size_t
 
tvsize
)

73 
timevÆ
 
sum
, 
nsum
;

74 
size_t
 
i
;

76 i‡(
tvsize
 == 0)

79 
	`timî˛ór
(&
sum
);

80 
i
 = 0; i < 
tvsize
; ++i) {

82 
	`timîadd
(&
sum
, &
tv¨r
[
i
], &
nsum
);

83 
sum
 = 
nsum
;

86  
	`tv2us
(&
sum
Ë/ 
tvsize
;

87 
	}
}

90 
	$°ddevtv
(
timevÆ
 *
tv¨r
, 
size_t
 
tvsize
, 
avg
)

92 
diffsum
;

93 
size_t
 
i
;

95 i‡(
tvsize
 <= 1)

99 
i
 = 0, 
diffsum
 = 0; i < 
tvsize
; ++i) {

100 c⁄° 
diff
 = 
	`œbs
(
	`tv2us
(&
tv¨r
[
i
]Ë- 
avg
);

102 
diffsum
 +
diff
 * diff;

105  ()
	`Ãound
(
	`sqπ
((()
diffsum
Ë/ 
tvsize
));

106 
	}
}

	@sockd/method_gssapi.c

49 
	~"comm⁄.h
"

51 #i‡
HAVE_GSSAPI


53 c⁄° 
	grcsid
[] =

56 
√gŸüã_ªsu…_t


57 
ªcv_gsßpi_auth_vî
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

59 
√gŸüã_ªsu…_t


60 
ªcv_gsßpi_auth_ty≥
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

62 
√gŸüã_ªsu…_t


63 
ªcv_gsßpi_auth_Àn
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

65 
√gŸüã_ªsu…_t


66 
ªcv_gsßpi_auth_tokí
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

68 
√gŸüã_ªsu…_t


69 
ªcv_gsßpi_íc_vî
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

71 
√gŸüã_ªsu…_t


72 
ªcv_gsßpi_íc_ty≥
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

74 
√gŸüã_ªsu…_t


75 
ªcv_gsßpi_íc_Àn
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

77 
√gŸüã_ªsu…_t


78 
ªcv_gsßpi_íc_tokí
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

80 
√gŸüã_ªsu…_t


81 
ªcv_gsßpi_∑ckë
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

83 
√gŸüã_ªsu…_t


84 
ªcv_gsßpi_∑ckë_vî
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

86 
√gŸüã_ªsu…_t


87 
ªcv_gsßpi_∑ckë_ty≥
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

89 
√gŸüã_ªsu…_t


90 
ªcv_gsßpi_∑ckë_Àn
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

92 
√gŸüã_ªsu…_t


93 
ªcv_gsßpi_∑ckë_tokí
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

96 
√gŸüã_ªsu…_t


97 
	$mëhod_gsßpi
(
s
, 
ªque°
, 
°©e
)

98 
s
;

99 
ªque°_t
 *
ªque°
;

100 
√gŸüã_°©e_t
 *
°©e
;

103 c⁄° *
fun˘i⁄
 = "method_gssapi()";

105 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

107 
ªque°
->
auth
->
md©a
.
gsßpi
.
°©e
.
id
 = 
GSS_C_NO_CONTEXT
;

109 
°©e
->
rcuºít
 = 
ªcv_gsßpi_auth_vî
;

110  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

111 
	}
}

124 
√gŸüã_ªsu…_t


125 
	$ªcv_gsßpi_auth_vî
(
s
, 
ªque°
, 
°©e
)

126 
s
;

127 
ªque°_t
 *
ªque°
;

128 
√gŸüã_°©e_t
 *
°©e
;

130 c⁄° *
fun˘i⁄
 = "recv_gssapi_auth_ver()";

131 
gsßpi_auth_vîsi⁄
;

133 
	`INIT
((
gsßpi_auth_vîsi⁄
));

134 
	`CHECK
(&
gsßpi_auth_vîsi⁄
, 
ªque°
->
auth
, 
NULL
);

136 
gsßpi_auth_vîsi⁄
) {

137 
SOCKS_GSSAPI_VERSION
:

141 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

143 
fun˘i⁄
,

144 
	`¥oxy¥Ÿocﬁ2°rög
(
ªque°
->
vîsi⁄
),

145 
gsßpi_auth_vîsi⁄
);

147  
NEGOTIATE_ERROR
;

150 
°©e
->
rcuºít
 = 
ªcv_gsßpi_auth_ty≥
;

151  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

152 
	}
}

154 
√gŸüã_ªsu…_t


155 
	$ªcv_gsßpi_auth_ty≥
(
s
, 
ªque°
, 
°©e
)

156 
s
;

157 
ªque°_t
 *
ªque°
;

158 
√gŸüã_°©e_t
 *
°©e
;

160 c⁄° *
fun˘i⁄
 = "recv_gssapi_auth_type()";

161 
gsßpi_auth_ty≥
;

163 
	`INIT
((
gsßpi_auth_ty≥
));

164 
	`CHECK
(&
gsßpi_auth_ty≥
, 
ªque°
->
auth
, 
NULL
);

166 
gsßpi_auth_ty≥
) {

167 
SOCKS_GSSAPI_AUTHENTICATION
:

170 
SOCKS_GSSAPI_ENCRYPTION
:

171 
SOCKS_GSSAPI_PACKET
:

172 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

175 
fun˘i⁄
, 
gsßpi_auth_ty≥
, 
SOCKS_GSSAPI_AUTHENTICATION
);

177  
NEGOTIATE_ERROR
;

180 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

182 
fun˘i⁄
, 
gsßpi_auth_ty≥
);

184  
NEGOTIATE_ERROR
;

187 
°©e
->
rcuºít
 = 
ªcv_gsßpi_auth_Àn
;

188  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

189 
	}
}

191 
√gŸüã_ªsu…_t


192 
	$ªcv_gsßpi_auth_Àn
(
s
, 
ªque°
, 
°©e
)

193 
s
;

194 
ªque°_t
 *
ªque°
;

195 
√gŸüã_°©e_t
 *
°©e
;

197 
	`INIT
((
°©e
->
gsßpôokí_Àn
));

198 
	`CHECK
(&
°©e
->
gsßpôokí_Àn
, 
ªque°
->
auth
, 
NULL
);

200 
°©e
->
gsßpôokí_Àn


201 
	`¡ohs
(()
°©e
->
gsßpôokí_Àn
);

203 
°©e
->
rcuºít
 = 
ªcv_gsßpi_auth_tokí
;

204  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

205 
	}
}

207 
√gŸüã_ªsu…_t


208 
	$ªcv_gsßpi_auth_tokí
(
s
, 
ªque°
, 
°©e
)

209 
s
;

210 
ªque°_t
 *
ªque°
;

211 
√gŸüã_°©e_t
 *
°©e
;

213 c⁄° *
fun˘i⁄
 = "recv_gssapi_auth_token()";

214 
£ndto_öfo_t
 
£ndtoÊags
;

215 
gss_«me_t
 
˛õ¡_«me
 = 
GSS_C_NO_NAME
;

216 
gss_«me_t
 
£rvî_«me
 = 
GSS_C_NO_NAME
;

217 
gss_¸ed_id_t
 
£rvî_¸eds
 = 
GSS_C_NO_CREDENTIAL
;

218 
gss_buf„r_desc
 
ouçut_tokí
 = 
GSS_C_EMPTY_BUFFER
;

219 
gss_buf„r_desc
 
öput_tokí
;

220 
OM_uöt32
 
ªt_Êags
, 
maj‹_°©us
, 
mö‹_°©us
;

221 
tokí_Àngth
;

222 
ssize_t
 
rc
;

223 
size_t
 
buÊí
;

224 
buf
[
GSSAPI_HLEN
 + 
MAXGSSAPITOKENLEN
];

225 
ív
[(
ªque°
->
auth
->
md©a
.
gsßpi
.
keyèb
)], 
emsg
[1024];

227 
	`INIT
(
°©e
->
gsßpôokí_Àn
);

229 
öput_tokí
.
Àngth
 = 
°©e
->
gsßpôokí_Àn
;

230 
öput_tokí
.
vÆue
 = 
buf
;

231 
	`SASSERTX
(
öput_tokí
.
Àngth
 <(
buf
));

233 
	`CHECK
(
öput_tokí
.
vÆue
, 
ªque°
->
auth
, 
NULL
);

235 
	`STRCPY_ASSERTLEN
(
ív
, 
ªque°
->
auth
->
md©a
.
gsßpi
.
keyèb
);

236 
	`£ãnv
("KRB5_KTNAME", 
ív
, 1);

238 #i‡
HAVE_HEIMDAL_KERBEROS


239 
	`gsskrb5_ªgi°î_ac˚±‹_idítôy
(
ªque°
->
auth
->
md©a
.
gsßpi
.
keyèb
);

242 
	`¶og
(
LOG_DEBUG
,"%s: using gssapi serviceÇame %s",

243 
fun˘i⁄
, 
ªque°
->
auth
->
md©a
.
gsßpi
.
£rvi˚«me
);

245 i‡(
	`°rˇ£cmp
(
ªque°
->
auth
->
md©a
.
gsßpi
.
£rvi˚«me
, "GSS_C_NO_NAME")

247 
gss_buf„r_desc
 
£rvi˚
;

249 
£rvi˚
.
vÆue
 = 
ªque°
->
auth
->
md©a
.
gsßpi
.
£rvi˚«me
;

250 
£rvi˚
.
Àngth
 = 
	`°æí
(£rvi˚.
vÆue
);

252 
maj‹_°©us


253 
	`gss_imp‹t_«me
(&
mö‹_°©us
,

254 &
£rvi˚
,

255 
	`°rchr
(
ªque°
->
auth
->
md©a
.
gsßpi
.
£rvi˚«me
, '/')

256 !
NULL
 ?

257 (
gss_OID
)
GSS_C_NULL_OID


258 : (
gss_OID
)
gss_¡_£rvi˚_«me
,

259 &
£rvî_«me
);

261 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

262 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

263 "%s: gss_imp‹t_«me(Ë%s", 
fun˘i⁄
, 
emsg
);

265 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

266  
NEGOTIATE_ERROR
;

270 
	`sockd_¥iv
(
SOCKD_PRIV_GSSAPI
, 
PRIV_ON
);

271 
maj‹_°©us
 = 
	`gss_acquúe_¸ed
(&
mö‹_°©us
,

272 
£rvî_«me
,

273 
GSS_C_INDEFINITE
,

274 
GSS_C_NO_OID_SET
,

275 
GSS_C_ACCEPT
,

276 &
£rvî_¸eds
,

277 
NULL
,

278 
NULL
);

279 
	`sockd_¥iv
(
SOCKD_PRIV_GSSAPI
, 
PRIV_OFF
);

281 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

282 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg), "%s: gss_acquire_cred(): %s",

283 
fun˘i⁄
, 
emsg
);

285 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

286  
NEGOTIATE_ERROR
;

289 
	`sockd_¥iv
(
SOCKD_PRIV_GSSAPI
, 
PRIV_ON
);

290 
maj‹_°©us


291 
	`gss_ac˚±_£c_c⁄ãxt
(&
mö‹_°©us
,

292 &
ªque°
->
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

293 
£rvî_¸eds
,

294 &
öput_tokí
,

295 
GSS_C_NO_CHANNEL_BINDINGS
,

296 &
˛õ¡_«me
,

297 
NULL
,

298 &
ouçut_tokí
,

299 &
ªt_Êags
,

300 
NULL
,

301 
NULL
);

302 
	`sockd_¥iv
(
SOCKD_PRIV_GSSAPI
, 
PRIV_OFF
);

304 
	`¶og
(
LOG_DEBUG
, "%s:Üength of output_token is %lu",

305 
fun˘i⁄
, ()
ouçut_tokí
.
Àngth
);

307 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

308 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

309 "%s: gss_ac˚±_£c_c⁄ãxt(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

311 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

312  
NEGOTIATE_ERROR
;

331 
	`SASSERTX
(
GSSAPI_HLEN
 + 
ouçut_tokí
.
Àngth
 <(
buf
));

333 
buÊí
 = 0;

334 
buf
[
buÊí
++] = 
SOCKS_GSSAPI_VERSION
;

335 
buf
[
buÊí
++] = 
SOCKS_GSSAPI_AUTHENTICATION
;

337 
tokí_Àngth
 = 
	`ht⁄s
(
ouçut_tokí
.
Àngth
);

338 
	`mem˝y
(&
buf
[
buÊí
], &
tokí_Àngth
, (token_length));

339 
buÊí
 +(
tokí_Àngth
);

341 
	`mem˝y
(&
buf
[
buÊí
], 
ouçut_tokí
.
vÆue
, ouçut_tokí.
Àngth
);

342 
buÊí
 +
ouçut_tokí
.
Àngth
;

344 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

346 
	`bzîo
(&
£ndtoÊags
, (sendtoflags));

347 
£ndtoÊags
.
side
 = 
INTERNALIF
;

349 i‡((
rc
 = 
	`socks_£ndt⁄
(
s
,

350 
buf
,

351 
buÊí
,

354 
NULL
,

356 
NULL
,

357 
ªque°
->
auth
)Ë!(
ssize_t
)
buÊí
) {

358 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

360 ()
rc
,

361 ()
buÊí
,

362 
buÊí
 == 1 ? "" : "s",

363 
	`°ªº‹
(
î∫o
));

365 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

366  
NEGOTIATE_ERROR
;

369 i‡(
maj‹_°©us
 =
GSS_S_COMPLETE
) {

371 
maj‹_°©us
 = 
	`gss_di•œy_«me
(&
mö‹_°©us
, 
˛õ¡_«me
, &
ouçut_tokí
,

372 
NULL
);

374 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

375 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

376 "%s: gss_di•œy_«me(): %s", 
fun˘i⁄
, 
emsg
);

378 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

379  
NEGOTIATE_ERROR
;

382 
	`mem˝y
(
ªque°
->
auth
->
md©a
.
gsßpi
.
«me
, 
ouçut_tokí
.
vÆue
,

383 
ouçut_tokí
.
Àngth
);

384 
ªque°
->
auth
->
md©a
.
gsßpi
.
«me
[
ouçut_tokí
.
Àngth
] = 
NUL
;

386 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

387 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

389 
°©e
->
rcuºít
 = 
ªcv_gsßpi_íc_vî
;

390  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

392 i‡(
maj‹_°©us
 =
GSS_S_CONTINUE_NEEDED
) {

393 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

396 
°©e
->
rcuºít
 = 
ªcv_gsßpi_auth_vî
;

399  
NEGOTIATE_CONTINUE
;

402 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

403 "%s: unknow¿gs†maj‹_°©u†%d", 
fun˘i⁄
, 
maj‹_°©us
);

405 
	`CLEAN_GSS_AUTH
(
˛õ¡_«me
, 
£rvî_«me
, 
£rvî_¸eds
);

406  
NEGOTIATE_ERROR
;

410 
	}
}

412 
√gŸüã_ªsu…_t


413 
	$ªcv_gsßpi_íc_vî
(
s
, 
ªque°
, 
°©e
)

414 
s
;

415 
ªque°_t
 *
ªque°
;

416 
√gŸüã_°©e_t
 *
°©e
;

418 c⁄° *
fun˘i⁄
 = "recv_gssapi_enc_ver()";

419 
gsßpi_íc_vîsi⁄
;

421 
	`INIT
((
gsßpi_íc_vîsi⁄
));

422 
	`CHECK
(&
gsßpi_íc_vîsi⁄
, 
ªque°
->
auth
, 
NULL
);

424 
gsßpi_íc_vîsi⁄
) {

425 
SOCKS_GSSAPI_VERSION
:

429 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

431 
fun˘i⁄
, 
gsßpi_íc_vîsi⁄
);

433  
NEGOTIATE_ERROR
;

436 
°©e
->
rcuºít
 = 
ªcv_gsßpi_íc_ty≥
;

437  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

438 
	}
}

450 
√gŸüã_ªsu…_t


451 
	$ªcv_gsßpi_íc_ty≥
(
s
, 
ªque°
, 
°©e
)

452 
s
;

453 
ªque°_t
 *
ªque°
;

454 
√gŸüã_°©e_t
 *
°©e
;

456 c⁄° *
fun˘i⁄
 = "recv_gssapi_enc_type()";

457 
gsßpi_íc_ty≥
;

459 
	`INIT
((
gsßpi_íc_ty≥
));

460 
	`CHECK
(&
gsßpi_íc_ty≥
, 
ªque°
->
auth
, 
NULL
);

462 
gsßpi_íc_ty≥
) {

463 
SOCKS_GSSAPI_INTEGRITY
:

464 
SOCKS_GSSAPI_CONFIDENTIALITY
:

467 
SOCKS_GSSAPI_PERMESSAGE
:

468 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

470 
fun˘i⁄
);

472  
NEGOTIATE_ERROR
;

475 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

477 
fun˘i⁄
, 
gsßpi_íc_ty≥
);

479  
NEGOTIATE_ERROR
;

482 
°©e
->
rcuºít
 = 
ªcv_gsßpi_íc_Àn
;

483  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

484 
	}
}

486 
√gŸüã_ªsu…_t


487 
	$ªcv_gsßpi_íc_Àn
(
s
, 
ªque°
, 
°©e
)

488 
s
;

489 
ªque°_t
 *
ªque°
;

490 
√gŸüã_°©e_t
 *
°©e
;

493 
	`INIT
((
°©e
->
gsßpôokí_Àn
));

494 
	`CHECK
(&
°©e
->
gsßpôokí_Àn
, 
ªque°
->
auth
, 
NULL
);

496 
°©e
->
gsßpôokí_Àn


497 
	`¡ohs
(()
°©e
->
gsßpôokí_Àn
);

499 
°©e
->
rcuºít
 = 
ªcv_gsßpi_íc_tokí
;

500  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

501 
	}
}

503 
√gŸüã_ªsu…_t


504 
	$ªcv_gsßpi_íc_tokí
(
s
, 
ªque°
, 
°©e
)

505 
s
;

506 
ªque°_t
 *
ªque°
;

507 
√gŸüã_°©e_t
 *
°©e
;

509 c⁄° *
fun˘i⁄
 = "recv_gssapi_enc_token()";

510 
OM_uöt32
 
mö‹_°©us
, 
maj‹_°©us
;

511 
gss_buf„r_desc
 
öput_tokí
, 
ouçut_tokí
 = 
GSS_C_EMPTY_BUFFER
;

512 
unsig√d_sh‹t
;

513 
ssize_t
 
rc
;

514 
size_t
 
buÊí
;

515 
buf
[
GSSAPI_HLEN
 + 
MAXGSSAPITOKENLEN
], 
gss_íc
, 
gss_£rvî_íc
;

516 
c⁄f_°©e
, 
do_rfc1961
;

517 
emsg
[1024];

519 
	`INIT
(
°©e
->
gsßpôokí_Àn
);

521 
öput_tokí
.
Àngth
 = 
°©e
->
gsßpôokí_Àn
;

522 
öput_tokí
.
vÆue
 = 
buf
;

524 
	`CHECK
(
öput_tokí
.
vÆue
, 
ªque°
->
auth
, 
NULL
);

526 i‡(
°©e
->
gsßpôokí_Àn
 == 1

527 && 
ªque°
->
auth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
√c
)

528 
do_rfc1961
 = 0;

533 
do_rfc1961
 = 1;

535 
	`¶og
(
LOG_DEBUG
, "%s:Ñuleássumes client uses %sÉxchange",

536 
fun˘i⁄
, 
do_rfc1961
? "rfc1961Éncrypted" : "NEC-style unencrypted");

538 i‡(
do_rfc1961
) {

539 
maj‹_°©us
 = 
	`gss_unwøp
(&
mö‹_°©us
,

540 
ªque°
->
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

541 &
öput_tokí
,

542 &
ouçut_tokí
,

544 
GSS_C_QOP_DEFAULT
);

546 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

547 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg), "%s: gss_unwrap(): %s",

548 
fun˘i⁄
, 
emsg
);

550 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

551  
NEGOTIATE_ERROR
;

554 i‡(
ouçut_tokí
.
Àngth
 != 1) {

555 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

560 
fun˘i⁄
, ()
ouçut_tokí
.
Àngth
);

562 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

563  
NEGOTIATE_ERROR
;

566 
	`SASSERTX
(
ouçut_tokí
.
Àngth
 =(
gss_íc
));

567 
	`mem˝y
(&
gss_íc
, 
ouçut_tokí
.
vÆue
, ouçut_tokí.
Àngth
);

568 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

571 
	`SASSERTX
(
öput_tokí
.
Àngth
 =(
gss_íc
));

572 
	`mem˝y
(&
gss_íc
, 
öput_tokí
.
vÆue
, i≈ut_tokí.
Àngth
);

575 i‡((
gss_íc
 =
SOCKS_GSSAPI_CLEAR


576 && !
ªque°
->
auth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
˛ór
)

577 || (
gss_íc
 =
SOCKS_GSSAPI_INTEGRITY


578 && !
ªque°
->
auth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
öãgrôy
)

579 || (
gss_íc
 =
SOCKS_GSSAPI_CONFIDENTIALITY


580 && !
ªque°
->
auth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
c⁄fidítülôy
)

581 || (
gss_íc
 =
SOCKS_GSSAPI_PERMESSAGE
) ) {

586 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

590 
	`gsßpùrŸe˘i⁄2°rög
(
gss_íc
),

591 
gss_íc
,

592 
ªque°
->
auth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
˛ór
,

593 
ªque°
->
auth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
öãgrôy
,

594 
ªque°
->
auth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
c⁄fidítülôy
,

595 
ªque°
->
auth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
≥rmesßge
);

597  
NEGOTIATE_ERROR
;

600 
gss_£rvî_íc
 = 
gss_íc
;

602 
	`¶og
(
LOG_DEBUG
, "%s: using %sÖrotection (%d)",

603 
fun˘i⁄
, 
	`gsßpùrŸe˘i⁄2°rög
(
gss_£rvî_íc
), gss_server_enc);

605 i‡(
do_rfc1961
) {

606 
öput_tokí
.
Àngth
 = 1;

607 
öput_tokí
.
vÆue
 = &
gss_£rvî_íc
;

609 
maj‹_°©us
 = 
	`gss_wøp
(&
mö‹_°©us
,

610 
ªque°
->
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

611 
GSS_REQ_INT
,

612 
GSS_C_QOP_DEFAULT
,

613 &
öput_tokí
,

614 &
c⁄f_°©e
,

615 &
ouçut_tokí
);

617 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

618 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg), "%s: gss_wrap(): %s",

619 
fun˘i⁄
, 
emsg
);

621 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

622  
NEGOTIATE_ERROR
;

626 
ouçut_tokí
.
Àngth
 = 1;

627 
ouçut_tokí
.
vÆue
 = &
gss_£rvî_íc
;

630 
ªque°
->
auth
->
md©a
.
gsßpi
.
°©e
.
¥Ÿe˘i⁄
 = 
gss_£rvî_íc
;

643 
	`SASSERTX
(
GSSAPI_HLEN
 + 
ouçut_tokí
.
Àngth
 <(
buf
));

645 
buÊí
 = 0;

646 
buf
[
buÊí
++] = 
SOCKS_GSSAPI_VERSION
;

647 
buf
[
buÊí
++] = 
SOCKS_GSSAPI_ENCRYPTION
;

649 
unsig√d_sh‹t
 = 
	`ht⁄s
(
ouçut_tokí
.
Àngth
);

650 
	`mem˝y
(&
buf
[
buÊí
], &
unsig√d_sh‹t
, (unsigned_short));

651 
buÊí
 +(
unsig√d_sh‹t
);

653 
	`mem˝y
(&
buf
[
buÊí
], 
ouçut_tokí
.
vÆue
, ouçut_tokí.
Àngth
);

654 
buÊí
 +(
ouçut_tokí
.
Àngth
);

656 i‡((
rc
 = 
	`socks_£ndt⁄
(
s
, 
buf
, 
buÊí
, 0, 0, 
NULL
, 0, NULL, 
ªque°
->
auth
))

657 !(
ssize_t
)
buÊí
) {

658 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

660 ()
rc
,

661 ()
buÊí
,

662 
	`°ªº‹
(
î∫o
));

664 i‡(
do_rfc1961
)

665 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

667  
NEGOTIATE_ERROR
;

670 i‡(
do_rfc1961
)

671 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

673 i‡(
gss_£rvî_íc
)

674 
°©e
->
rcuºít
 = 
ªcv_gsßpi_∑ckë
;

680 
°©e
->
rcuºít
 = 
ªcv_sock•ackë
;

682  
NEGOTIATE_CONTINUE
;

683 
	}
}

695 
√gŸüã_ªsu…_t


696 
	$ªcv_gsßpi_∑ckë
(
s
, 
ªque°
, 
°©e
)

697 
s
;

698 
ªque°_t
 *
ªque°
;

699 
√gŸüã_°©e_t
 *
°©e
;

703 
°©e
->
rcuºít
 = 
ªcv_gsßpi_∑ckë_vî
;

704  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

705 
	}
}

707 
√gŸüã_ªsu…_t


708 
	$ªcv_gsßpi_∑ckë_vî
(
s
, 
ªque°
, 
°©e
)

709 
s
;

710 
ªque°_t
 *
ªque°
;

711 
√gŸüã_°©e_t
 *
°©e
;

713 c⁄° *
fun˘i⁄
 = "recv_gssapi_packet_ver()";

714 
gsßpi_∑ckë_vîsi⁄
;

716 
	`INIT
((
gsßpi_∑ckë_vîsi⁄
));

717 
	`CHECK
(&
gsßpi_∑ckë_vîsi⁄
, 
ªque°
->
auth
, 
NULL
);

719 
gsßpi_∑ckë_vîsi⁄
) {

720 
SOCKS_GSSAPI_VERSION
:

724 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

726 
fun˘i⁄
, 
gsßpi_∑ckë_vîsi⁄
);

728  
NEGOTIATE_ERROR
;

731 
°©e
->
rcuºít
 = 
ªcv_gsßpi_∑ckë_ty≥
;

732  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

733 
	}
}

735 
√gŸüã_ªsu…_t


736 
	$ªcv_gsßpi_∑ckë_ty≥
(
s
, 
ªque°
, 
°©e
)

737 
s
;

738 
ªque°_t
 *
ªque°
;

739 
√gŸüã_°©e_t
 *
°©e
;

741 c⁄° *
fun˘i⁄
 = "recv_gssapi_packet_type()";

742 
gsßpi_íc_ty≥
;

744 
	`INIT
((
gsßpi_íc_ty≥
));

745 
	`CHECK
(&
gsßpi_íc_ty≥
, 
ªque°
->
auth
, 
NULL
);

747 
gsßpi_íc_ty≥
) {

748 
SOCKS_GSSAPI_PACKET
:

751 
SOCKS_GSSAPI_ENCRYPTION
:

752 
SOCKS_GSSAPI_AUTHENTICATION
:

753 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

755 
fun˘i⁄
, 
gsßpi_íc_ty≥
);

757  
NEGOTIATE_ERROR
;

760 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

762 
fun˘i⁄
, 
gsßpi_íc_ty≥
);

764  
NEGOTIATE_ERROR
;

767 
°©e
->
rcuºít
 = 
ªcv_gsßpi_∑ckë_Àn
;

768  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

769 
	}
}

771 
√gŸüã_ªsu…_t


772 
	$ªcv_gsßpi_∑ckë_Àn
(
s
, 
ªque°
, 
°©e
)

773 
s
;

774 
ªque°_t
 *
ªque°
;

775 
√gŸüã_°©e_t
 *
°©e
;

778 
	`INIT
((
°©e
->
gsßpôokí_Àn
));

779 
	`CHECK
(&
°©e
->
gsßpôokí_Àn
, 
ªque°
->
auth
, 
NULL
);

781 
°©e
->
gsßpôokí_Àn


782 
	`¡ohs
(()
°©e
->
gsßpôokí_Àn
);

784 
°©e
->
rcuºít
 = 
ªcv_gsßpi_∑ckë_tokí
;

785  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

786 
	}
}

788 
√gŸüã_ªsu…_t


789 
	$ªcv_gsßpi_∑ckë_tokí
(
s
, 
ªque°
, 
°©e
)

790 
s
;

791 
ªque°_t
 *
ªque°
;

792 
√gŸüã_°©e_t
 *
°©e
;

794 c⁄° *
fun˘i⁄
 = "recv_gssapi_packet_token()";

795 
OM_uöt32
 
mö‹_°©us
, 
maj‹_°©us
 = 
GSS_S_COMPLETE
;

796 
gss_buf„r_desc
 
öput_tokí
 = 
GSS_C_EMPTY_BUFFER
;

797 
gss_buf„r_desc
 
ouçut_tokí
 = 
GSS_C_EMPTY_BUFFER
;

798 *
d©a
;

799 
buf
[
GSSAPI_HLEN
 + 
MAXGSSAPITOKENLEN
];

800 
emsg
[1024];

801 
c⁄f_°©e
, 
off£t
;

803 
	`INIT
(
°©e
->
gsßpôokí_Àn
);

805 
öput_tokí
.
Àngth
 = 
°©e
->
gsßpôokí_Àn
;

806 
öput_tokí
.
vÆue
 = 
buf
;

808 
	`CHECK
(
öput_tokí
.
vÆue
, 
ªque°
->
auth
, 
NULL
);

810 
c⁄f_°©e
 = (
ªque°
->
auth
->
md©a
.
gsßpi
.
°©e
.
¥Ÿe˘i⁄


811 =
GSSAPI_CONFIDENTIALITY
Ë? 
GSS_REQ_CONF
 : 
GSS_REQ_INT
;

813 
maj‹_°©us


814 
	`gss_unwøp
(&
mö‹_°©us
,

815 
ªque°
->
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

816 &
öput_tokí
, &
ouçut_tokí
, &
c⁄f_°©e
, 
GSS_C_QOP_DEFAULT
);

818 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg))) {

819 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

820 "%s: gss_unwøp(): %s", 
fun˘i⁄
, 
emsg
);

822  
NEGOTIATE_ERROR
;

825 
off£t
 = 0;

826 
d©a
 = 
ouçut_tokí
.
vÆue
;

828 i‡(
off£t
 + (
ªque°
->
vîsi⁄
Ë> 
ouçut_tokí
.
Àngth
) {

829 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

831 
fun˘i⁄
, ()
ouçut_tokí
.
Àngth
);

833 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

834  
NEGOTIATE_ERROR
;

837 
	`mem˝y
(&
ªque°
->
vîsi⁄
, &
d©a
[
off£t
], (request->version));

838 i‡(
ªque°
->
vîsi⁄
 !
PROXY_SOCKS_V5
) {

839 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

840 "%s: invÆid sock†vîsi⁄ %d i¿ªque°", 
fun˘i⁄
, 
ªque°
->
vîsi⁄
);

842 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

843  
NEGOTIATE_ERROR
;

845 
off£t
 +(
ªque°
->
vîsi⁄
);

847 i‡(
off£t
 + (
ªque°
->
comm™d
Ë> 
ouçut_tokí
.
Àngth
) {

848 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

850 
fun˘i⁄
, ()
ouçut_tokí
.
Àngth
);

852 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

853  
NEGOTIATE_ERROR
;

855 
	`mem˝y
(&
ªque°
->
comm™d
, &
d©a
[
off£t
], (request->command));

856 
off£t
 +(
ªque°
->
comm™d
);

858 
ªque°
->
comm™d
) {

859 
SOCKS_BIND
:

860 
SOCKS_CONNECT
:

861 
ªque°
->
¥Ÿocﬁ
 = 
SOCKS_TCP
;

864 
SOCKS_UDPASSOCIATE
:

865 
ªque°
->
¥Ÿocﬁ
 = 
SOCKS_UDP
;

869 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

871 
fun˘i⁄
, 
ªque°
->
comm™d
);

873 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

874  
NEGOTIATE_ERROR
;

877 i‡(
off£t
 + (
ªque°
->
Êag
Ë> 
ouçut_tokí
.
Àngth
) {

878 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

879  
NEGOTIATE_ERROR
;

881 
	`mem˝y
(&
ªque°
->
Êag
, &
d©a
[
off£t
], (request->flag));

882 
off£t
 +(
ªque°
->
Êag
);

884 i‡(
	`mem2socksho°
(&
ªque°
->
ho°
, &
d©a
[
off£t
],

885 
ouçut_tokí
.
Àngth
 - 
off£t
, 
ªque°
->
vîsi⁄
Ë=
NULL
) {

886 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

887  
NEGOTIATE_ERROR
;

890 
	`CLEAN_GSS_TOKEN
(
ouçut_tokí
);

893 i‡(
ªque°
->
auth
->
md©a
.
gsßpi
.
°©e
.
¥Ÿe˘i⁄
)

894 
ªque°
->
auth
->
md©a
.
gsßpi
.
°©e
.
wøp
 = 1;

896  
NEGOTIATE_FINISHED
;

897 
	}
}

	@sockd/method_uname.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

50 
√gŸüã_ªsu…_t


51 
ªcv_u«mevî
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

53 
√gŸüã_ªsu…_t


54 
ªcv_uÀn
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

56 
√gŸüã_ªsu…_t


57 
ªcv_u«me
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

59 
√gŸüã_ªsu…_t


60 
ªcv_∂í
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

62 
√gŸüã_ªsu…_t


63 
ªcv_∑sswd
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

66 
∑ssw‹ddbisunique
();

74 
√gŸüã_ªsu…_t


75 
	$mëhod_u«me
(
s
, 
ªque°
, 
°©e
)

76 
s
;

77 
ªque°_t
 *
ªque°
;

78 
√gŸüã_°©e_t
 *
°©e
;

82 
°©e
->
rcuºít
 = 
ªcv_u«mevî
;

83  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

84 
	}
}

87 
	$∑ssw‹ddbisunique
()

89 c⁄° *
fun˘i⁄
 = "passworddbisunique()";

90 
rc
;

92 i‡(
	`mëhodis£t
(
AUTHMETHOD_UNAME
, 
sockscf
.
smëhodv
, sockscf.
smëhodc
)) {

93 #i‡
HAVE_PAM


94 i‡(
	`mëhodis£t
(
AUTHMETHOD_PAM_USERNAME
,

95 
sockscf
.
smëhodv
,

96 
sockscf
.
smëhodc
))

97 
rc
 = 0;

101 #i‡
HAVE_BSDAUTH


102 i‡(
	`mëhodis£t
(
AUTHMETHOD_BSDAUTH
, 
sockscf
.
smëhodv
, sockscf.
smëhodc
))

103 
rc
 = 0;

106 
rc
 = 
AUTHMETHOD_UNAME
;

109 #i‡
HAVE_PAM


110 i‡(
	`mëhodis£t
(
AUTHMETHOD_PAM_USERNAME
,

111 
sockscf
.
smëhodv
,

112 
sockscf
.
smëhodc
)) {

113 i‡(*
sockscf
.
°©e
.
∑m£rvi˚«me
 =
NUL
)

114 
rc
 = 0;

115 i‡(
	`mëhodis£t
(
AUTHMETHOD_UNAME
,

116 
sockscf
.
smëhodv
,

117 
sockscf
.
smëhodc
))

118 
rc
 = 0;

119 #i‡
HAVE_BSDAUTH


120 i‡(
	`mëhodis£t
(
AUTHMETHOD_BSDAUTH
,

121 
sockscf
.
smëhodv
,

122 
sockscf
.
smëhodc
))

123 
rc
 = 0;

126 
rc
 = 
AUTHMETHOD_PAM_USERNAME
;

130 #i‡
HAVE_BSDAUTH


131 i‡(
	`mëhodis£t
(
AUTHMETHOD_BSDAUTH
,

132 
sockscf
.
smëhodv
,

133 
sockscf
.
smëhodc
)) {

134 i‡(
sockscf
.
°©e
.
bsdauth°yÀ«me
 =
NULL
)

135 
rc
 = 0;

136 i‡(
	`mëhodis£t
(
AUTHMETHOD_UNAME
,

137 
sockscf
.
smëhodv
,

138 
sockscf
.
smëhodc
))

139 
rc
 = 0;

140 #i‡
HAVE_PAM


141 i‡(
	`mëhodis£t
(
AUTHMETHOD_PAM_USERNAME
,

142 
sockscf
.
smëhodv
,

143 
sockscf
.
smëhodc
)) {

144 
rc
 = 0;

147 
rc
 = 
AUTHMETHOD_BSDAUTH
;

151 
	`¶og
(
LOG_DEBUG
, "%s:Çÿ∑ssw‹d-ba£d mëhod†c⁄figuªd", 
fun˘i⁄
);

152 
rc
 = 0;

155 
	`¶og
(
LOG_DEBUG
, "%s:Ñëu∫ög %d", 
fun˘i⁄
, 
rc
);

156  
rc
;

159 
√gŸüã_ªsu…_t


160 
	`ªcv_u«mevî
(
s
, 
ªque°
, 
°©e
)

161 
s
;

162 
ªque°_t
 *
ªque°
;

163 
√gŸüã_°©e_t
 *
°©e
;

165 c⁄° *
fun˘i⁄
 = "recv_unamever()";

167 
	`INIT
((
ªque°
->
auth
->
md©a
.
u«me
.
vîsi⁄
));

168 
	`CHECK
(&
ªque°
->
auth
->
md©a
.
u«me
.
vîsi⁄
,Ñeque°->auth, 
NULL
);

170 
ªque°
->
auth
->
md©a
.
u«me
.
vîsi⁄
) {

171 
SOCKS_UNAMEVERSION
:

175 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

177 
fun˘i⁄
,

178 
	`¥oxy¥Ÿocﬁ2°rög
(
ªque°
->
vîsi⁄
),

179 
ªque°
->
auth
->
md©a
.
u«me
.
vîsi⁄
);

181  
NEGOTIATE_ERROR
;

184 
°©e
->
rcuºít
 = 
ªcv_uÀn
;

185  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

188 
√gŸüã_ªsu…_t


189 
	`ªcv_uÀn
(
s
, 
ªque°
, 
°©e
)

190 
s
;

191 
ªque°_t
 *
ªque°
;

192 
√gŸüã_°©e_t
 *
°©e
;

195 
	`INIT
((*
ªque°
->
auth
->
md©a
.
u«me
.
«me
));

196 
	`CHECK
(
ªque°
->
auth
->
md©a
.
u«me
.
«me
,Ñeque°->auth, 
NULL
);

199 
	`OCTETIFY
(*
ªque°
->
auth
->
md©a
.
u«me
.
«me
);

201 
°©e
->
rcuºít
 = 
ªcv_u«me
;

202  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

205 
√gŸüã_ªsu…_t


206 
	`ªcv_u«me
(
s
, 
ªque°
, 
°©e
)

207 
s
;

208 
ªque°_t
 *
ªque°
;

209 
√gŸüã_°©e_t
 *
°©e
;

212 c⁄° 
size_t
 
uÀn
 = (size_t)*
ªque°
->
auth
->
md©a
.
u«me
.
«me
;

214 
	`INIT
(
uÀn
);

215 
	`CHECK
(
ªque°
->
auth
->
md©a
.
u«me
.
«me
 + 1,Ñeque°->auth, 
NULL
);

218 
	`memmove
(
ªque°
->
auth
->
md©a
.
u«me
.
«me
,

219 
ªque°
->
auth
->
md©a
.
u«me
.
«me
 + 1,

220 
uÀn
);

221 
ªque°
->
auth
->
md©a
.
u«me
.
«me
[
uÀn
] = 
NUL
;

223 
°©e
->
rcuºít
 = 
ªcv_∂í
;

224  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

227 
√gŸüã_ªsu…_t


228 
	`ªcv_∂í
(
s
, 
ªque°
, 
°©e
)

229 
s
;

230 
ªque°_t
 *
ªque°
;

231 
√gŸüã_°©e_t
 *
°©e
;

234 
	`INIT
((*
ªque°
->
auth
->
md©a
.
u«me
.
∑ssw‹d
));

235 
	`CHECK
(
ªque°
->
auth
->
md©a
.
u«me
.
∑ssw‹d
,Ñeque°->auth, 
NULL
);

238 
	`OCTETIFY
(*
ªque°
->
auth
->
md©a
.
u«me
.
∑ssw‹d
);

240 
°©e
->
rcuºít
 = 
ªcv_∑sswd
;

241  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

244 
√gŸüã_ªsu…_t


245 
	`ªcv_∑sswd
(
s
, 
ªque°
, 
°©e
)

246 
s
;

247 
ªque°_t
 *
ªque°
;

248 
√gŸüã_°©e_t
 *
°©e
;

251 c⁄° 
size_t
 
∂í
 = (size_t)*
ªque°
->
auth
->
md©a
.
u«me
.
∑ssw‹d
;

252 
£ndto_öfo_t
 
£ndtoÊags
;

253 
ª•⁄£
[1 + 1 ];

254 
isunique
;

256 
	`INIT
(
∂í
);

257 
	`CHECK
(
ªque°
->
auth
->
md©a
.
u«me
.
∑ssw‹d
 + 1,Ñeque°->auth, 
NULL
);

260 
	`memmove
(
ªque°
->
auth
->
md©a
.
u«me
.
∑ssw‹d
,

261 
ªque°
->
auth
->
md©a
.
u«me
.
∑ssw‹d
 + 1,

262 
∂í
);

263 
ªque°
->
auth
->
md©a
.
u«me
.
∑ssw‹d
[
∂í
] = 
NUL
;

285 
ª•⁄£
[
UNAME_VERSION
] = 
ªque°
->
auth
->
md©a
.
u«me
.
vîsi⁄
;

286 (
isunique
 = 
	`∑ssw‹ddbisunique
())) {

292 
ª•⁄£
[
UNAME_STATUS
] = ()
UNAME_STATUS_ISOK
;

295 #i‡
HAVE_PAM


296 
AUTHMETHOD_PAM_ANY
:

297 
AUTHMETHOD_PAM_ADDRESS
:

298 
AUTHMETHOD_PAM_USERNAME
: {

302 c⁄° 
authmëhod_u«me_t
 
u«me
 = 
ªque°
->
auth
->
md©a
.uname;

304 
ªque°
->
auth
->
mëhod
 = 
isunique
;

306 
	`STRCPY_ASSERTLEN
(
ªque°
->
auth
->
md©a
.
∑m
.
£rvi˚«me
,

307 
sockscf
.
°©e
.
∑m£rvi˚«me
);

309 
	`STRCPY_ASSERTSIZE
(
ªque°
->
auth
->
md©a
.
∑m
.
«me
, 
u«me
.name);

311 
	`STRCPY_ASSERTSIZE
(
ªque°
->
auth
->
md©a
.
∑m
.
∑ssw‹d
, 
u«me
.password);

316 #i‡
HAVE_BSDAUTH


317 
AUTHMETHOD_BSDAUTH
: {

321 c⁄° 
authmëhod_u«me_t
 
u«me
 = 
ªque°
->
auth
->
md©a
.uname;

323 
ªque°
->
auth
->
mëhod
 = 
AUTHMETHOD_BSDAUTH
;

324 i‡(
sockscf
.
°©e
.
bsdauth°yÀ«me
 !
NULL
)

325 
	`STRCPY_ASSERTLEN
(
ªque°
->
auth
->
md©a
.
bsd
.
°yÀ
,

326 (c⁄° *)
sockscf
.
°©e
.
bsdauth°yÀ«me
);

328 
ªque°
->
auth
->
md©a
.
bsd
.
°yÀ
[0] = 
NUL
;

330 
	`STRCPY_ASSERTSIZE
(
ªque°
->
auth
->
md©a
.
bsd
.
«me
, 
u«me
.name);

332 
	`STRCPY_ASSERTSIZE
(
ªque°
->
auth
->
md©a
.
bsd
.
∑ssw‹d
,

333 
u«me
.
∑ssw‹d
);

338 
AUTHMETHOD_UNAME
:

342 
	`SERRX
(
	`∑ssw‹ddbisunique
());

345 i‡(
isunique
) {

346 
sockaddr_°‹age
 
§c
, 
d°
;

348 
	`socksho°2sockaddr
(&
°©e
->
§c
, &src);

349 
	`socksho°2sockaddr
(&
°©e
->
d°
, &dst);

351 i‡(
	`ac˚sscheck
(
s
,

352 
ªque°
->
auth
,

353 &
§c
,

354 &
d°
,

355 
°©e
->
emsg
,

356 (
°©e
->
emsg
)))

357 
ª•⁄£
[
UNAME_STATUS
] = ()
UNAME_STATUS_ISOK
;

359 
ª•⁄£
[
UNAME_STATUS
] = ()
UNAME_STATUS_ISNOK
;

362 
	`bzîo
(&
£ndtoÊags
, (sendtoflags));

363 
£ndtoÊags
.
side
 = 
INTERNALIF
;

365 i‡(
	`socks_£ndt⁄
(
s
,

366 
ª•⁄£
,

367 (
ª•⁄£
),

370 
NULL
,

372 &
£ndtoÊags
,

373 
ªque°
->
auth
Ë!(
ª•⁄£
))

374  
NEGOTIATE_ERROR
;

376 i‡(
ª•⁄£
[
UNAME_STATUS
] =()
UNAME_STATUS_ISOK
) {

377 
°©e
->
rcuºít
 = 
ªcv_sock•ackë
;

380  
NEGOTIATE_CONTINUE
;

384  
NEGOTIATE_ERROR
;

	@sockd/monitor.c

44 
	~"cuæ/cuæ.h
"

45 
	~"js⁄-c/js⁄.h
"

46 
	~"comm⁄.h
"

47 
	~"m⁄ô‹.h
"

48 
	~"c⁄fig_∑r£.h
"

49 
	~"√éök/√éök.h
"

52 c⁄° 
	grcsid
[] =

56 
	mRTNL_LINK_RX_PACKETS
,

57 
	mRTNL_LINK_TX_PACKETS
,

58 
	mRTNL_LINK_RX_BYTES
,

59 
	mRTNL_LINK_TX_BYTES
,

60 
	mRTNL_LINK_RX_ERRORS
,

61 
	mRTNL_LINK_TX_ERRORS
,

62 
	mRTNL_LINK_RX_DROPPED
,

63 
	mRTNL_LINK_TX_DROPPED
,

64 
	mRTNL_LINK_RX_COMPRESSED
,

65 
	mRTNL_LINK_TX_COMPRESSED
,

66 
	mRTNL_LINK_RX_FIFO_ERR
,

67 
	mRTNL_LINK_TX_FIFO_ERR
,

68 
	mRTNL_LINK_RX_LEN_ERR
,

69 
	mRTNL_LINK_RX_OVER_ERR
,

70 
	mRTNL_LINK_RX_CRC_ERR
,

71 
	mRTNL_LINK_RX_FRAME_ERR
,

72 
	mRTNL_LINK_RX_MISSED_ERR
,

73 
	mRTNL_LINK_TX_ABORT_ERR
,

74 
	mRTNL_LINK_TX_CARRIER_ERR
,

75 
	mRTNL_LINK_TX_HBEAT_ERR
,

76 
	mRTNL_LINK_TX_WIN_ERR
,

77 
	mRTNL_LINK_COLLISIONS
,

78 
	mRTNL_LINK_MULTICAST
,

79 
	mRTNL_LINK_IP6_INPKTS
,

80 
	mRTNL_LINK_IP6_INHDRERRORS
,

81 
	mRTNL_LINK_IP6_INTOOBIGERRORS
,

82 
	mRTNL_LINK_IP6_INNOROUTES
,

83 
	mRTNL_LINK_IP6_INADDRERRORS
,

84 
	mRTNL_LINK_IP6_INUNKNOWNPROTOS
,

85 
	mRTNL_LINK_IP6_INTRUNCATEDPKTS
,

86 
	mRTNL_LINK_IP6_INDISCARDS
,

87 
	mRTNL_LINK_IP6_INDELIVERS
,

88 
	mRTNL_LINK_IP6_OUTFORWDATAGRAMS
,

89 
	mRTNL_LINK_IP6_OUTPKTS
,

90 
	mRTNL_LINK_IP6_OUTDISCARDS
,

91 
	mRTNL_LINK_IP6_OUTNOROUTES
,

92 
	mRTNL_LINK_IP6_REASMTIMEOUT
,

93 
	mRTNL_LINK_IP6_REASMREQDS
,

94 
	mRTNL_LINK_IP6_REASMOKS
,

95 
	mRTNL_LINK_IP6_REASMFAILS
,

96 
	mRTNL_LINK_IP6_FRAGOKS
,

97 
	mRTNL_LINK_IP6_FRAGFAILS
,

98 
	mRTNL_LINK_IP6_FRAGCREATES
,

99 
	mRTNL_LINK_IP6_INMCASTPKTS
,

100 
	mRTNL_LINK_IP6_OUTMCASTPKTS
,

101 
	mRTNL_LINK_IP6_INBCASTPKTS
,

102 
	mRTNL_LINK_IP6_OUTBCASTPKTS
,

103 
	mRTNL_LINK_IP6_INOCTETS
,

104 
	mRTNL_LINK_IP6_OUTOCTETS
,

105 
	mRTNL_LINK_IP6_INMCASTOCTETS
,

106 
	mRTNL_LINK_IP6_OUTMCASTOCTETS
,

107 
	mRTNL_LINK_IP6_INBCASTOCTETS
,

108 
	mRTNL_LINK_IP6_OUTBCASTOCTETS
,

109 
	mRTNL_LINK_ICMP6_INMSGS
,

110 
	mRTNL_LINK_ICMP6_INERRORS
,

111 
	mRTNL_LINK_ICMP6_OUTMSGS
,

112 
	mRTNL_LINK_ICMP6_OUTERRORS
,

113 
	m__RTNL_LINK_STATS_MAX
,

114 } 
	tπ∆_lök_°©_id_t
;

116 
	#RTNL_LINK_STATS_MAX
 (
__RTNL_LINK_STATS_MAX
 - 1)

	)

118 
	s°©s_öfo_t
 {

119 
	mi‚ame
[
IFNAMSIZ
];

120 
ö_addr
 
	maddr
;

121 
uöt64_t
 
	mtx
;

122 
uöt64_t
 
	mrx
;

123 
uöt64_t
 
	mœ°_tx
;

124 
uöt64_t
 
	mœ°_rx
;

125 } 
	t°©s_öfo
;

128 
showÆ¨ms
(c⁄° 
m⁄ô‹_if_t
 *
iÁ˚
);

129 
sigöfo
(
sig
, 
sigöfo_t
 *
sù
, *
s˝
);

132 
Æ¨mcheck_disc⁄√˘
(c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
, 
Æ¨m_disc⁄√˘_t
 *
Æ¨m
,

133 c⁄° 
size_t
 
Æ¨mside
, c⁄° 
timevÆ
 *
äow
,

134 *
Æ¨måiggîed
);

146 
	#OP_CONNECT
 (1)

	)

147 
	#OP_DISCONNECT
 (2)

	)

148 
	#OP_REMOVE_SESSION
 (4)

	)

150 
	#IP_PORT
 "hâp://10.118.30.192:443"

	)

152 *
›2°rög
(c⁄° 
size_t
 
›
);

156 
disc⁄√˘_Æ¨m_body
(c⁄° 
we˛o£dfú°
, c⁄° 
size_t
 
›
,

157 
ruÀ_t
 *
Æ¨m
, c⁄° 
size_t
 
sides
,

158 c⁄° 
˛õ¡öfo_t
 *
cöfo
,

159 c⁄° *
ªas⁄
, c⁄° 
lock
, c⁄° 
sockd_io_t
 *
io
);

177 
Æ¨mcheck_d©a
(c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
, 
Æ¨m_d©a_side_t
 *
Æ¨m
,

178 c⁄° 
size_t
 
Æ¨mside
, c⁄° size_à
£ssi⁄c
,

179 c⁄° 
timevÆ
 *
äow
);

187 
Æ¨m_d©a_toggÀ
(c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
, c⁄° 
size_t
 
Æ¨mside
,

188 
Æ¨m_d©a_side_t
 *
Æ¨m
, c⁄° 
timevÆ
 *
äow
);

194 
checkm⁄ô‹s
();

199 
timevÆ
 *

200 
timëûlcheck
(c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
, c⁄° 
timevÆ
 *
äow
,

201 
timevÆ
 *
tfú°check
, 
size_t
 *
timedout
);

219 
timevÆ
 *

220 
gëtimeout
(
timevÆ
 *
timeout
);

226 
¥o˘ôÀupd©e
();

232 
doupd©e
(
CURL
 *
h™dÀ
, 
ty≥
, 
m⁄ô‹_t
 *
m⁄ô‹
);

235 
size_t
 
	mÆ¨mß˘ive
;

236 
size_t
 
	mm⁄ô‹c
;

237 } 
	g°©e
;

239 
	e°_upd©e_ty≥
 {

240 
	mST_USERINFO
,

241 
	mST_CARDINFO
,

244 
m⁄ô‹_t
 *

245 
	$addm⁄ô‹
(
√wm⁄ô‹
)

246 c⁄° 
m⁄ô‹_t
 *
√wm⁄ô‹
;

248 c⁄° *
fun˘i⁄
 = "addmonitor()";

249 
m⁄ô‹_°©s_t
 *
m°©s
;

250 
m⁄ô‹_t
 *
m⁄ô‹
;

252 
	`SASSERTX
(
√wm⁄ô‹
->
m°©s
 !
NULL
);

254 i‡(
√wm⁄ô‹
->
Æ¨msc⁄figuªd
 == 0)

255 
	`yyw¨nx
("monitor hasÇoálarms configured. IsÅhis intended?");

257 i‡(
√wm⁄ô‹
->
Æ¨m_d©a_aggªg©e
 & 
ALARM_INTERNAL
) {

258 
	`SASSERTX
(
√wm⁄ô‹
->
Æ¨m_d©a_aggªg©e
 & 
ALARM_EXTERNAL
);

260 i‡(
√wm⁄ô‹
->
Æ¨m_d©a_aggªg©e
 & 
ALARM_RECV
)

261 
	`SASSERTX
(
√wm⁄ô‹
->
Æ¨m_d©a_aggªg©e
 & 
ALARM_SEND
);

263 i‡(
√wm⁄ô‹
->
Æ¨m_d©a_aggªg©e
 & 
ALARM_RECV
) {

264 
	`SASSERTX
(
√wm⁄ô‹
->
Æ¨m_d©a_aggªg©e
 & 
ALARM_SEND
);

265 
	`SASSERTX
(!(
√wm⁄ô‹
->
Æ¨m_d©a_aggªg©e
 & 
ALARM_INTERNAL
));

266 
	`SASSERTX
(!(
√wm⁄ô‹
->
Æ¨m_d©a_aggªg©e
 & 
ALARM_EXTERNAL
));

269 
m°©s
 = &
√wm⁄ô‹
->m°©s->
obje˘
.
m⁄ô‹
;

271 i‡(
√wm⁄ô‹
->
Æ¨msc⁄figuªd
 & 
ALARM_DATA
)

272 
	`SASSERTX
(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


273 || 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd


274 || 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


275 || 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
);

277 i‡(
√wm⁄ô‹
->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)

278 
	`SASSERTX
(
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd


279 || 
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
);

282 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
) {

286 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
) {

290 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
) {

292 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
.
disc⁄√˘c


293 > 
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
.
£ssi⁄c
)

294 
	`yyîr‹x
("internal sessionÜimit value (%lu) cannot beÜower "

297 
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
.
disc⁄√˘c
,

299 
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
.
£ssi⁄c
);

302 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
) {

304 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
.
disc⁄√˘c


305 > 
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
.
£ssi⁄c
)

306 
	`yyîr‹x
("external sessionÜimit value (%lu) cannot beÜower "

309 
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
.
disc⁄√˘c
,

311 
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
limô
.
£ssi⁄c
);

314 i‡((
m⁄ô‹
 = 
	`mÆloc
((*m⁄ô‹))Ë=
NULL
)

315 
	`yyîr‹
("couldÇotállocate %lu bytes for monitor",

316 ()(*
m⁄ô‹
));

318 *
m⁄ô‹
 = *
√wm⁄ô‹
;

319 
m⁄ô‹
->
ty≥
 = 
obje˘_m⁄ô‹
;

320 
m⁄ô‹
->
m°©s_isöhîôabÀ
 = 1;

322 
	`£tcomm™d¥Ÿocﬁ
(
m⁄ô‹
->
ty≥
,

323 &
m⁄ô‹
->
°©e
.
comm™d
,

324 &
m⁄ô‹
->
°©e
.
¥Ÿocﬁ
);

326 i‡(
sockscf
.
m⁄ô‹
 =
NULL
) {

327 
m⁄ô‹
->
numbî
 = 1;

328 
sockscf
.
m⁄ô‹
 = monitor;

331 
m⁄ô‹_t
 *
œ°
;

333 
œ°
 = 
sockscf
.
m⁄ô‹
;

334 
œ°
->
√xt
 !
NULL
)

335 
œ°
 =Üa°->
√xt
;

337 
m⁄ô‹
->
numbî
 = 
œ°
->number + 1;

338 
œ°
->
√xt
 = 
m⁄ô‹
;

341 
	`INIT_MSTATE
(&
m⁄ô‹
->
m°©s
->
m°©e
, m⁄ô‹->
ty≥
, m⁄ô‹->
numbî
);

342 
m⁄ô‹
->
√xt
 = 
NULL
;

344  
m⁄ô‹
;

345 
	}
}

348 
	$showm⁄ô‹
(
_m⁄ô‹
)

349 c⁄° 
m⁄ô‹_t
 *
_m⁄ô‹
;

351 c⁄° *
fun˘i⁄
 = "showmonitor()";

352 
m⁄ô‹_t
 
m⁄ô‹
 = *
_m⁄ô‹
;

353 
ruÀ_t
 
ruÀ
;

355 
	`¶og
(
LOG_DEBUG
, "monitor #%lu,Üine #%lu, shmid %lu",

356 ()
m⁄ô‹
.
numbî
,

357 ()
m⁄ô‹
.
löíumbî
,

358 ()
m⁄ô‹
.
m°©s_shmid
);

360 
	`¶og
(
LOG_DEBUG
, "src: %s",

361 
	`ruÀaddr2°rög
(&
m⁄ô‹
.
§c
,

362 
ADDRINFO_PORT
 | 
ADDRINFO_ATYPE
,

363 
NULL
,

366 
	`¶og
(
LOG_DEBUG
, "dst: %s",

367 
	`ruÀaddr2°rög
(&
m⁄ô‹
.
d°
,

368 
ADDRINFO_PORT
 | 
ADDRINFO_ATYPE
,

369 
NULL
,

372 #i‡
HAVE_SOCKS_HOSTID


373 i‡(
m⁄ô‹
.
ho°id
.
©y≥
 !
SOCKS_ADDR_NOTSET
)

374 
	`¶og
(
LOG_DEBUG
, "hostindex: %d, hostid: %s",

375 
m⁄ô‹
.
ho°ödex
, 
	`ruÀaddr2°rög
(&m⁄ô‹.
ho°id
, 0, 
NULL
, 0));

378 
	`bzîo
(&
ruÀ
, (rule));

379 
	`COPY_MONITORFIELDS
(&
m⁄ô‹
, &
ruÀ
);

380 ()
	`sockd_shm©
(&
ruÀ
, 
SHMEM_MONITOR
);

381 
	`COPY_MONITORFIELDS
(&
ruÀ
, &
m⁄ô‹
);

383 i‡(
m⁄ô‹
.
m°©s_shmid
 != 0) {

384 c⁄° 
m⁄ô‹_°©s_t
 *
m°©s
;

386 
	`SASSERTX
(
m⁄ô‹
.
m°©s
 !
NULL
);

388 
m°©s
 = &
m⁄ô‹
.m°©s->
obje˘
.monitor;

390 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


391 || 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd


392 || 
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
) {

393 
	`¶og
(
LOG_DEBUG
, "alarms on internal interface:");

394 
	`showÆ¨ms
(&
m°©s
->
öã∫Æ
);

397 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


398 || 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd


399 || 
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
) {

400 
	`¶og
(
LOG_DEBUG
, "alarms onÉxternal interface:");

401 
	`showÆ¨ms
(&
m⁄ô‹
.
m°©s
->
obje˘
.m⁄ô‹.
exã∫Æ
);

404 
	`¶og
(
LOG_DEBUG
,

406 ()
m⁄ô‹
.
Æ¨m_d©a_aggªg©e
,

407 ()
m⁄ô‹
.
Æ¨m_disc⁄√˘_aggªg©e
);

410 
	`sockd_shmdt
(&
ruÀ
, 
SHMEM_MONITOR
);

411 
	`COPY_MONITORFIELDS
(&
ruÀ
, &
m⁄ô‹
);

418 
	`showli°
(
m⁄ô‹
.
u£r
, "user: ");

419 
	`showli°
(
m⁄ô‹
.
group
, "group: ");

421 #i‡
HAVE_PAM


422 i‡(
	`mëhodis£t
(
AUTHMETHOD_PAM
,

423 
m⁄ô‹
.
°©e
.
mëhodv
,

424 
m⁄ô‹
.
°©e
.
mëhodc
))

425 
	`¶og
(
LOG_DEBUG
, "∑m.£rvi˚«me: %s", 
m⁄ô‹
.
°©e
.
∑m£rvi˚«me
);

428 #i‡
HAVE_BSDAUTH


429 i‡(
	`mëhodis£t
(
AUTHMETHOD_BSDAUTH
,

430 
m⁄ô‹
.
°©e
.
mëhodv
,

431 
m⁄ô‹
.
°©e
.
mëhodc
))

432 
	`¶og
(
LOG_DEBUG
, "bsdauth.°yÀ«me: %s", 
m⁄ô‹
.
°©e
.
bsdauth°yÀ«me
);

435 #i‡
HAVE_LDAP


436 
	`showli°
(
m⁄ô‹
.
ld≠group
, "ldap.group: ");

437 i‡(
m⁄ô‹
.
ld≠group
) {

438 i‡(*
m⁄ô‹
.
°©e
.
ld≠
.
domaö
 !
NUL
)

439 
	`¶og
(
LOG_DEBUG
, "ld≠.domaö: %s",
m⁄ô‹
.
°©e
.
ld≠
.
domaö
);

441 
	`¶og
(
LOG_DEBUG
, "ldap.auto.off: %s",

442 
m⁄ô‹
.
°©e
.
ld≠
.
auto_off
 ? "yes" : "no");

443 #i‡
HAVE_OPENLDAP


444 
	`¶og
(
LOG_DEBUG
, "ld≠.debug: %d", 
m⁄ô‹
.
°©e
.
ld≠
.
debug
);

446 
	`¶og
(
LOG_DEBUG
, "ldap.keeprealm: %s",

447 
m⁄ô‹
.
°©e
.
ld≠
.
kì¥ólm
 ? "yes" : "no");

449 i‡(*
m⁄ô‹
.
°©e
.
ld≠
.
keyèb
 !
NUL
)

450 
	`¶og
(
LOG_DEBUG
, "ld≠.keyèb: %s", 
m⁄ô‹
.
°©e
.
ld≠
.
keyèb
);

452 
	`showli°
(
m⁄ô‹
.
°©e
.
ld≠
.
ld≠uæ
, "ldap.url: ");

454 
	`showli°
(
m⁄ô‹
.
°©e
.
ld≠
.
ld≠ba£dn
, "ldap.basedn: ");

456 i‡(*
m⁄ô‹
.
°©e
.
ld≠
.
fûãr
 !
NUL
)

457 
	`¶og
(
LOG_DEBUG
, "ld≠.fûãr: %s", 
m⁄ô‹
.
°©e
.
ld≠
.
fûãr
);

459 i‡(*
m⁄ô‹
.
°©e
.
ld≠
.
fûãr_AD
 !
NUL
)

460 
	`¶og
(
LOG_DEBUG
, "ld≠.fûãr.ad: %s", 
m⁄ô‹
.
°©e
.
ld≠
.
fûãr_AD
);

462 i‡(*
m⁄ô‹
.
°©e
.
ld≠
.
©åibuã
 !
NUL
)

463 
	`¶og
(
LOG_DEBUG
, "ld≠.©åibuã: %s", 
m⁄ô‹
.
°©e
.
ld≠
.
©åibuã
);

465 i‡(*
m⁄ô‹
.
°©e
.
ld≠
.
©åibuã_AD
 !
NUL
)

466 
	`¶og
(
LOG_DEBUG
, "ldap.attribute.ad: %s",

467 
m⁄ô‹
.
°©e
.
ld≠
.
©åibuã_AD
);

469 
	`¶og
(
LOG_DEBUG
, "ld≠.mdïth: %d", 
m⁄ô‹
.
°©e
.
ld≠
.
mdïth
);

470 
	`¶og
(
LOG_DEBUG
, "ld≠.p‹t: %d", 
m⁄ô‹
.
°©e
.
ld≠
.
p‹t
);

471 
	`¶og
(
LOG_DEBUG
, "ld≠.s¶: %s", 
m⁄ô‹
.
°©e
.
ld≠
.
s¶
 ? "yes" : "no");

472 
	`¶og
(
LOG_DEBUG
, "ldap.certcheck: %s",

473 
m⁄ô‹
.
°©e
.
ld≠
.
˚πcheck
 ? "yes" : "no");

475 i‡(*
m⁄ô‹
.
°©e
.
ld≠
.
˚πfûe
 !
NUL
)

476 
	`¶og
(
LOG_DEBUG
, "ld≠.˚πfûe: %s", 
m⁄ô‹
.
°©e
.
ld≠
.
˚πfûe
);

478 i‡(*
m⁄ô‹
.
°©e
.
ld≠
.
˚π∑th
 !
NUL
)

479 
	`¶og
(
LOG_DEBUG
, "ld≠.˚π∑th: %s", 
m⁄ô‹
.
°©e
.
ld≠
.
˚π∑th
);

484 
	`show°©e
(&
m⁄ô‹
.
°©e
);

485 
	}
}

489 
	$run_m⁄ô‹
()

491 c⁄° *
fun˘i⁄
 = "run_monitor()";

492 
siga˘i⁄
 
siga˘
;

493 
fd_£t
 *
r£t
;

495 
	`bzîo
(&
siga˘
, (sigact));

496 
siga˘
.
ß_Êags
 = 
SA_RESTART
 | 
SA_SIGINFO
;

497 
siga˘
.
ß_siga˘i⁄
 = 
sigöfo
;

499 #i‡
HAVE_SIGNAL_SIGINFO


500 i‡(
	`siga˘i⁄
(
SIGINFO
, &
siga˘
, 
NULL
) != 0)

501 
	`£º
("%s: siga˘i⁄(SIGINFO)", 
fun˘i⁄
);

505 i‡(
	`siga˘i⁄
(
SIGUSR1
, &
siga˘
, 
NULL
) != 0)

506 
	`£º
("%s: siga˘i⁄(SIGINFO)", 
fun˘i⁄
);

508 
r£t
 = 
	`Æloˇã_maxsize_fd£t
();

510 
	`sockd_¥öt_chûd_ªady_mesßge
((
size_t
)
	`‰ìdes¸ùt‹s
(
NULL
, NULL));

513 
timevÆ
 
timeout
;

514 
fdbôs
;

516 
î∫o
 = 0;

518 
	`¥o˘ôÀupd©e
();

520 
	`FD_ZERO
(
r£t
);

521 
fdbôs
 = -1;

524 
	`SASSERTX
(
sockscf
.
°©e
.
mŸhî
.
ack
 != -1);

525 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
r£t
);

526 
fdbôs
 = 
	`MAX
(fdbôs, 
sockscf
.
°©e
.
mŸhî
.
ack
);

528 ++
fdbôs
;

529 
timevÆ
 
âout
 = {10, 0};

530 
	`£À˘n
(
fdbôs
,

531 
r£t
,

532 
NULL
,

533 
NULL
,

534 
NULL
,

535 
NULL
,

536 &
âout
)){

539 i‡(
î∫o
 =
EINTR
)

542 
	`SERR
(-1);

549 i‡(
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
r£t
)) {

553 
	`sockd_ªadmŸhîsc⁄åﬁsockë
(
fun˘i⁄
,

554 
sockscf
.
°©e
.
mŸhî
.
ack
);

561 
	`‰ì
(
r£t
);

562 
	`sockdexô
(
EXIT_FAILURE
);

566 
	`checkm⁄ô‹s
();

570 
	}
}

573 
	$m⁄ô‹_¥ec⁄figlﬂd
()

575 c⁄° *
fun˘i⁄
 = "monitor_preconfigload()";

577 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

583 
	`m⁄ô‹_dëach‰omli°
(
sockscf
.
m⁄ô‹
);

584 
	}
}

587 
	$m⁄ô‹_po°c⁄figlﬂd
()

589 c⁄° *
fun˘i⁄
 = "monitor_postconfigload()";

590 
timevÆ
 
äow
;

591 
m⁄ô‹_t
 *
m⁄ô‹
;

598 
	`bzîo
(&
°©e
, (state));

599 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

601 
m⁄ô‹
 = 
sockscf
.m⁄ô‹; m⁄ô‹ !
NULL
; m⁄ô‹ = m⁄ô‹->
√xt
) {

602 
m⁄ô‹_°©s_t
 *
m°©s
;

603 
ruÀ_t
 
ruÀ
;

604 
rc
;

606 
	`SASSERTX
(
m⁄ô‹
->
m°©s_shmid
 != 0);

607 
	`SASSERTX
(
m⁄ô‹
->
m°©s
 =
NULL
);

609 
	`bzîo
(&
ruÀ
, (rule));

610 
	`COPY_MONITORFIELDS
(
m⁄ô‹
, &
ruÀ
);

611 
rc
 = 
	`sockd_shm©
(&
ruÀ
, 
SHMEM_MONITOR
);

612 
	`COPY_MONITORFIELDS
(&
ruÀ
, 
m⁄ô‹
);

614 i‡(
rc
 != 0) {

615 
	`¶og
(
LOG_DEBUG
, "%s: couldÇotáttachÅo shmem segment of monitor #%lu",

616 
fun˘i⁄
, ()
m⁄ô‹
->
numbî
);

621 
	`SASSERTX
(
m⁄ô‹
->
m°©s
 !
NULL
);

628 
m°©s
 = &
m⁄ô‹
->m°©s->
obje˘
.monitor;

630 
	`socks_lock
(
sockscf
.
shmemfd
, (
off_t
)
m⁄ô‹
->
m°©s_shmid
, 1, 1, 1);

632 #i‡
DEBUG


633 
m⁄ô‹_°©s_t
 
_m°©s
 = *
m°©s
;

636 
	`MUNPROTECT_SHMEMHEADER
(
m⁄ô‹
->
m°©s
);

638 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
is⁄


639 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
is⁄


640 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
is⁄


641 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
is⁄
 = 0;

643 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
byãs


644 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
byãs


645 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
byãs


646 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
byãs
 = 0;

648 
	`timî˛ór
(&
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°io
);

649 
	`timî˛ór
(&
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°io
);

650 
	`timî˛ór
(&
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°io
);

651 
	`timî˛ór
(&
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°io
);

653 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°ª£t


654 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°ª£t


655 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°ª£t


656 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°ª£t


657 
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
œ°ª£t


658 
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
œ°ª£t


659 
äow
;

661 
	`MPROTECT_SHMEMHEADER
(
m⁄ô‹
->
m°©s
);

663 
	`socks_u∆ock
(
sockscf
.
shmemfd
, (
off_t
)
m⁄ô‹
->
m°©s_shmid
, 1);

665 ++
°©e
.
m⁄ô‹c
;

667 
	}
}

670 
	$m⁄ô‹_dëach‰omli°
(
hód
)

671 
m⁄ô‹_t
 *
hód
;

673 
m⁄ô‹_t
 *
m
;

675 
m
 = 
hód
; m !
NULL
; m = m->
√xt
) {

676 
ruÀ_t
 
ruÀ
;

678 i‡(
m
->
m°©s_shmid
 == 0)

681 
	`bzîo
(&
ruÀ
, (rule));

682 
	`COPY_MONITORFIELDS
(
m
, &
ruÀ
);

683 
	`sockd_shmdt
(&
ruÀ
, 
SHMEM_MONITOR
);

684 
	`COPY_MONITORFIELDS
(&
ruÀ
, 
m
);

686 
	}
}

689 
	$Æ¨m_öhîô
(
‰om
, 
cöfo_‰om
, 
to
, 
cöfo_to
, 
sidesc⁄√˘ed
)

690 
ruÀ_t
 *
‰om
;

691 c⁄° 
˛õ¡öfo_t
 *
cöfo_‰om
;

692 
ruÀ_t
 *
to
;

693 c⁄° 
˛õ¡öfo_t
 *
cöfo_to
;

694 c⁄° 
size_t
 
sidesc⁄√˘ed
;

696 c⁄° *
fun˘i⁄
 = "alarm_inherit";

698 
	`¶og
(
LOG_DEBUG
, "%s: sidesconnected: %lu",

699 
fun˘i⁄
, ()
sidesc⁄√˘ed
);

701 
	`log_ruÀöfo_shmid
(
‰om
, 
fun˘i⁄
, "from-rule");

702 
	`log_ruÀöfo_shmid
(
to
, 
fun˘i⁄
, "to-rule");

704 i‡(
sidesc⁄√˘ed
 == 0)

707 i‡(
‰om
->
m°©s_shmid
 == 0) {

708 i‡(
to
->
m°©s_shmid
 !0 && (to->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

712 
	`Æ¨m_add_c⁄√˘
(
to
, 
sidesc⁄√˘ed
, 
cöfo_to
, 
sockscf
.
shmemfd
, 0);

717 i‡(
to
->
m°©s_shmid
 =
‰om
->mstats_shmid) {

718 
	`¶og
(
LOG_DEBUG
, "%s:ÇewÑule uses same monitorás old one: shmid %lu",

719 
fun˘i⁄
, 
to
->
m°©s_shmid
);

721 i‡(
to
->
m°©s_shmid
 == 0) {

722 
	`COPY_MONITORFIELDS
(
‰om
, 
to
);

725 
	`SASSERTX
(
to
->
m°©s_shmid
 != 0);

726 
	`SASSERTX
(
‰om
->
m°©s_shmid
 != 0);

728 i‡(
‰om
->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
) {

732 
	`Æ¨m_ªmove_£ssi⁄
(
‰om
,

733 
sidesc⁄√˘ed
,

734 
cöfo_‰om
,

735 
sockscf
.
shmemfd
);

738 
	`SASSERTX
(
to
->
m°©s_shmid
 != 0);

739 i‡(
to
->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)

740 
	`Æ¨m_add_c⁄√˘
(
to
, 
sidesc⁄√˘ed
, 
cöfo_to
, 
sockscf
.
shmemfd
, 0);

743 
	}
}

746 c⁄° 
m⁄ô‹_t
 *

747 
	$m⁄ô‹m©ch
(
§c
, 
d°
, 
auth
, 
°©e
)

748 c⁄° 
socksho°_t
 *
§c
;

749 c⁄° 
socksho°_t
 *
d°
;

750 c⁄° 
authmëhod_t
 *
auth
;

751 c⁄° 
c⁄√˘i⁄°©e_t
 *
°©e
;

753 c⁄° *
fun˘i⁄
 = "monitormatch()";

754 
m⁄ô‹_t
 *
m⁄ô‹
;

755 
§c°r
[
MAXSOCKSHOSTSTRING
], 
d°°r
[(srcstr)];

757 
	`¶og
(
LOG_DEBUG
, "%s: %s -> %s",

758 
fun˘i⁄
,

759 
§c
 =
NULL
 ? "N/A" : 
	`socksho°2°rög
(§c, 
§c°r
, (srcstr)),

760 
d°
 =
NULL
 ? "N/A" : 
	`socksho°2°rög
(d°, 
d°°r
, (dststr)));

762 
m⁄ô‹
 = 
sockscf
.m⁄ô‹; m⁄ô‹ !
NULL
; m⁄ô‹ = m⁄ô‹->
√xt
) {

763 i‡(!
	`¥Ÿocﬁ_m©ches
(
°©e
->
¥Ÿocﬁ
, &
m⁄ô‹
->state.protocol)) {

764 
	`¶og
(
LOG_DEBUG
, "%s: monitor #%lu monitorsÖrotocols %s, butÇot %s",

765 
fun˘i⁄
,

766 ()
m⁄ô‹
->
numbî
,

767 
	`¥Ÿocﬁs2°rög
(&
m⁄ô‹
->
°©e
.
¥Ÿocﬁ
, 
NULL
, 0),

768 
	`¥Ÿocﬁ2°rög
(
°©e
->
¥Ÿocﬁ
));

773 i‡(!
	`comm™d_m©ches
(
°©e
->
comm™d
, &
m⁄ô‹
->state.command)) {

774 
	`¶og
(
LOG_DEBUG
, "%s: monitor #%lu monitor commands %s, butÇot %s",

775 
fun˘i⁄
,

776 ()
m⁄ô‹
->
numbî
,

777 
	`comm™ds2°rög
(&
m⁄ô‹
->
°©e
.
comm™d
, 
NULL
, 0),

778 
	`comm™d2°rög
(
°©e
->
comm™d
));

783 #i‡
HAVE_SOCKS_HOSTID


784 i‡(
m⁄ô‹
->
ho°id
.
©y≥
 !
SOCKS_ADDR_NOTSET
) {

785 
	`¶og
(
LOG_DEBUG
,

788 
fun˘i⁄
,

789 ()
m⁄ô‹
->
numbî
);

791 i‡(!
	`ho°idm©ches
(
°©e
->
ho°idc
,

792 
°©e
->
ho°idv
,

793 
m⁄ô‹
->
ho°ödex
,

794 &
m⁄ô‹
->
ho°id
,

795 
obje˘_m⁄ô‹
,

796 
m⁄ô‹
->
numbî
))

801 i‡(
§c
 !
NULL
)

802 i‡(!
	`addrm©ch
(&
m⁄ô‹
->
§c
, src, 
NULL
, 
°©e
->
¥Ÿocﬁ
, 0))

805 i‡(
d°
 !
NULL
)

806 i‡(!
	`addrm©ch
(&
m⁄ô‹
->
d°
, d°, 
NULL
, 
°©e
->
¥Ÿocﬁ
, 0))

809  
m⁄ô‹
;

812  
NULL
;

813 
	}
}

816 
	$m⁄ô‹_u£
(
m°©s
, 
cöfo
, 
lock
)

817 
shmem_obje˘_t
 *
m°©s
;

818 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

819 c⁄° 
lock
;

821 c⁄° *
fun˘i⁄
 = "monitor_use()";

822 #i‡
DEBUG


823 
shmem_obje˘_t
 
_shmem
 = *
m°©s
;

826 
	`SASSERTX
(
m°©s
 !
NULL
);

828 
	`¶og
(
LOG_DEBUG
,

831 
fun˘i⁄
,

832 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0),

833 
lock
,

834 
m°©s
,

835 ()
m°©s
->
m°©e
.
˛õ¡s
);

837 
	`shmem_u£
(
m°©s
, 
cöfo
, 
lock
, 0);

838 
	}
}

841 
	$m⁄ô‹_move
(
ﬁdm⁄ô‹
, 
√wm⁄ô‹
, 
°ay©èched
, 
sidesc⁄√˘ed
, 
cöfo
, 
lock
)

842 
m⁄ô‹_t
 *
ﬁdm⁄ô‹
;

843 
m⁄ô‹_t
 *
√wm⁄ô‹
;

844 c⁄° 
°ay©èched
;

845 c⁄° 
size_t
 
sidesc⁄√˘ed
;

846 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

847 c⁄° 
lock
;

849 c⁄° *
fun˘i⁄
 = "monitor_move()";

850 
ruÀ_t
 
Æ¨m
;

852 
	`¶og
(
LOG_DEBUG
,

855 
fun˘i⁄
,

856 ()
ﬁdm⁄ô‹
->
m°©s_shmid
,

857 
ﬁdm⁄ô‹
->
m°©s
,

858 ()
√wm⁄ô‹
->
m°©s_shmid
,

859 
√wm⁄ô‹
->
m°©s
,

860 ()
ﬁdm⁄ô‹
->
Æ¨msc⁄figuªd
,

861 ()
√wm⁄ô‹
->
Æ¨msc⁄figuªd
,

862 ()
sidesc⁄√˘ed
);

868 
	`bzîo
(&
Æ¨m
, (alarm));

869 
	`COPY_MONITORFIELDS
(
ﬁdm⁄ô‹
, &
Æ¨m
);

871 i‡(
Æ¨m
.
m°©s_shmid
 !0 &&áœrm.
m°©s
 =
NULL
)

872 i‡(
	`sockd_shm©
(&
Æ¨m
, 
SHMEM_MONITOR
) != 0)

873 
	`COPY_MONITORFIELDS
(&
Æ¨m
, 
ﬁdm⁄ô‹
);

875 i‡(
Æ¨m
.
m°©s_shmid
 != 0) {

876 
	`SASSERTX
(
Æ¨m
.
m°©s
 !
NULL
);

878 
	`socks_lock
(
lock
, (
off_t
)
Æ¨m
.
m°©s_shmid
, 1, 1, 1);

880 i‡(
Æ¨m
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)

881 
	`Æ¨m_ªmove_£ssi⁄
(&
Æ¨m
, 
sidesc⁄√˘ed
, 
cöfo
, -1);

883 
	`m⁄ô‹_unu£
(
Æ¨m
.
m°©s
, 
cöfo
, -1);

885 
	`socks_u∆ock
(
lock
, (
off_t
)
Æ¨m
.
m°©s_shmid
, 1);

887 
	`SASSERTX
(
Æ¨m
.
m°©s
 !
NULL
);

894 
	`sockd_shmdt
(&
Æ¨m
, 
SHMEM_MONITOR
);

897 
	`CLEAR_MONITORFIELDS
(
ﬁdm⁄ô‹
);

903 
	`bzîo
(&
Æ¨m
, (alarm));

904 
	`COPY_MONITORFIELDS
(
√wm⁄ô‹
, &
Æ¨m
);

906 i‡(
Æ¨m
.
m°©s_shmid
 !0 &&áœrm.
m°©s
 =
NULL
)

907 i‡(
	`sockd_shm©
(&
Æ¨m
, 
SHMEM_MONITOR
) != 0)

908 
	`COPY_MONITORFIELDS
(&
Æ¨m
, 
√wm⁄ô‹
);

910 i‡(
Æ¨m
.
m°©s_shmid
 != 0) {

911 
	`SASSERTX
(
Æ¨m
.
m°©s
 !
NULL
);

913 
	`socks_lock
(
lock
, (
off_t
)
Æ¨m
.
m°©s_shmid
, 1, 1, 1);

915 
	`m⁄ô‹_u£
(
Æ¨m
.
m°©s
, 
cöfo
, -1);

917 i‡(
Æ¨m
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)

918 
	`Æ¨m_add_c⁄√˘
(&
Æ¨m
, 
sidesc⁄√˘ed
, 
cöfo
, -1, 0);

920 
	`socks_u∆ock
(
lock
, (
off_t
)
Æ¨m
.
m°©s_shmid
, 1);

922 
	`SASSERTX
(
Æ¨m
.
m°©s
 !
NULL
);

924 i‡(
°ay©èched
)

925 
	`SASSERTX
(
Æ¨m
.
m°©s
 =
√wm⁄ô‹
->mstats);

927 
	`sockd_shmdt
(&
Æ¨m
, 
SHMEM_MONITOR
);

930 
	`CLEAR_MONITORFIELDS
(
√wm⁄ô‹
);

931 
	}
}

935 
	$m⁄ô‹_unu£
(
m°©s
, 
cöfo
, 
lock
)

936 
shmem_obje˘_t
 *
m°©s
;

937 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

938 c⁄° 
lock
;

940 c⁄° *
fun˘i⁄
 = "monitor_unuse()";

941 #i‡
DEBUG


942 
shmem_obje˘_t
 
_shmem
 = *
m°©s
;

945 
	`SASSERTX
(
m°©s
 !
NULL
);

947 
	`¶og
(
LOG_DEBUG
,

950 
fun˘i⁄
,

951 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0),

952 
lock
,

953 
m°©s
,

954 ()
m°©s
->
m°©e
.
shmid
,

955 ()
m°©s
->
m°©e
.
˛õ¡s
);

957 
	`shmem_unu£
(
m°©s
, 
cöfo
, 
lock
);

958 
	}
}

961 
	$Æ¨m_ªmove_£ssi⁄
(
Æ¨m
, 
sides
, 
cöfo
, 
lock
)

962 
ruÀ_t
 *
Æ¨m
;

963 c⁄° 
size_t
 
sides
;

964 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

965 c⁄° 
lock
;

968 
	`disc⁄√˘_Æ¨m_body
(0,

969 
OP_REMOVE_SESSION
,

970 
Æ¨m
,

971 
sides
,

972 
cöfo
,

973 
NULL
,

975 
lock
, 0);

976 
	}
}

979 
	$Æ¨m_add_c⁄√˘
(
Æ¨m
, 
sides
, 
cöfo
, 
lock
, 
io
)

980 
ruÀ_t
 *
Æ¨m
;

981 c⁄° 
size_t
 
sides
;

982 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

983 c⁄° 
lock
;

984 c⁄° 
sockd_io_t
 *
io
;

987 
	`disc⁄√˘_Æ¨m_body
(0,

988 
OP_CONNECT
,

989 
Æ¨m
,

990 
sides
,

991 
cöfo
,

992 
NULL
,

993 
lock
, 
io
);

994 
	}
}

997 
	$Æ¨m_add_disc⁄√˘
(
we˛o£dfú°
, 
Æ¨m
, 
sides
, 
cöfo
, 
ªas⁄
, 
lock
)

998 c⁄° 
we˛o£dfú°
;

999 
ruÀ_t
 *
Æ¨m
;

1000 c⁄° 
size_t
 
sides
;

1001 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

1002 c⁄° *
ªas⁄
;

1003 c⁄° 
lock
;

1006 
	`SASSERTX
(
ªas⁄
 !
NULL
);

1007 
	`disc⁄√˘_Æ¨m_body
(
we˛o£dfú°
,

1008 
OP_DISCONNECT
,

1009 
Æ¨m
,

1010 
sides
,

1011 
cöfo
,

1012 
ªas⁄
,

1013 
lock
, 0);

1014 
	}
}

1017 
	$disc⁄√˘_Æ¨m_body
(
we˛o£dfú°
, 
›
, 
Æ¨m
, 
sides
, 
cöfo
, 
ªas⁄
, 
lock
, 
io
)

1018 c⁄° 
we˛o£dfú°
;

1019 c⁄° 
size_t
 
›
;

1020 
ruÀ_t
 *
Æ¨m
;

1021 c⁄° 
size_t
 
sides
;

1022 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

1023 c⁄° *
ªas⁄
;

1024 c⁄° 
lock
;

1025 c⁄° 
sockd_io_t
 *
io
;

1027 c⁄° *
fun˘i⁄
 = "disconnect_alarm_body()";

1028 c⁄° 
size_t
 
sidev
[] = { 
sides
 & 
ALARM_INTERNAL
 ? ALARM_INTERNAL : 0,

1029 
sides
 & 
ALARM_EXTERNAL
 ? ALARM_EXTERNAL : 0 };

1031 c⁄° 
size_t
 
›v
[] = { (
›
 & 
OP_CONNECT
) ? OP_CONNECT : 0,

1032 (
›
 & 
OP_DISCONNECT
) ? OP_DISCONNECT : 0,

1033 (
›
 & 
OP_REMOVE_SESSION
) ? OP_REMOVE_SESSION : 0 };

1035 
Æ¨m_disc⁄√˘_t
 *
disc⁄√˘
;

1036 
size_t
 
sidec
, 
›c
, 
lockèkí
;

1037 
did©èch
;

1040 
	`¶og
(
LOG_ALARM
, "%s: op %lu, sides %lu, shmid %lu, shmem %p, cinfo %s",

1041 
fun˘i⁄
,

1042 ()
›
,

1043 ()
sides
,

1044 ()
Æ¨m
->
m°©s_shmid
,

1045 
Æ¨m
->
m°©s
,

1046 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0));

1048 
	`SASSERTX
(
Æ¨m
->
m°©s_shmid
 != 0);

1050 i‡(
Æ¨m
->
m°©s
 =
NULL
) {

1051 i‡(
	`sockd_shm©
(
Æ¨m
, 
SHMEM_MONITOR
) != 0)

1054 
did©èch
 = 1;

1057 
did©èch
 = 0;

1059 
	`SASSERTX
(
Æ¨m
->
m°©s
 !
NULL
);

1061 #i‡
DEBUG


1062 
shmem_obje˘_t
 
_shmem
 = *
Æ¨m
->
m°©s
;

1067 
u£r_öfo_t
 *
uif
 = &
Æ¨m
->
m°©s
->
obje˘
.
m⁄ô‹
.
u£r_öfo
;

1068 
uuid
=0;

1069 
rc
 = -1;

1070 
Ø
=();

1071 
	#MPTCP_AUTH_UUID
 29

	)

1072 i‡(
io
) {

1073 
rc
 = 
	`gësock›t
(
io
->
§c
.
s
, 
IPPROTO_TCP
, 
MPTCP_AUTH_UUID
, &
uuid
, &
Ø
);

1074 
	`¶og
(
LOG_ALARM
, "%†Æ¨m_c⁄√˘:Ñc=%d %s, uid=%x\n", 
__func__
, 
rc
, 
	`°ªº‹
(
î∫o
), 
uuid
);

1076 
i
;

1077 i‡(
uif
) {

1078 
i
 = 0; i < 
uif
->
u£r_˙t
; i++) {

1079 i‡(
uuid
 !0 && 
uif
->
Æ¨m
[
i
].
uid
 == uuid) {

1080 
	`¶og
(
LOG_ALARM
, "alarm_connect########## uif=%p, uid=%x,álarm->uid=%x , i=%d, user_cnt=%d ",

1081 
uif
, 
uuid
, uif->
Æ¨m
[
i
].
uid
, i, uif->
u£r_˙t
);

1087 
lockèkí
 = 0;

1089 
›c
 = 0; op¯< 
	`ELEMENTS
(
›v
); ++opc) {

1090 i‡(
›v
[
›c
] == 0)

1093 
sidec
 = 0; side¯< 
	`ELEMENTS
(
sidev
); ++sidec) {

1094 i‡(
sidev
[
sidec
] == 0)

1097 i‡(
sidev
[
sidec
] =
ALARM_INTERNAL
)

1098 
disc⁄√˘


1099 &
Æ¨m
->
m°©s
->
obje˘
.
m⁄ô‹
.
öã∫Æ
.Æ¨m.
disc⁄√˘
;

1101 
	`SASSERTX
(
sidev
[
sidec
] =
ALARM_EXTERNAL
);

1103 
disc⁄√˘


1104 &
Æ¨m
->
m°©s
->
obje˘
.
m⁄ô‹
.
exã∫Æ
.Æ¨m.
disc⁄√˘
;

1108 
	`¶og
(
LOG_ALARM
,

1112 
fun˘i⁄
,

1113 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0),

1114 
	`›2°rög
(
›v
[
›c
]),

1115 
disc⁄√˘
->
isc⁄figuªd
 ? "Disconnect" : "No disconnect",

1116 
Æ¨m
->
m°©s_shmid
,

1117 
	`Æ¨mside2°rög
(
sidev
[
sidec
]),

1118 
ªas⁄
 =
NULL
 ? "N/A" :Ñeason,

1119 (
›v
[
›c
] & 
OP_DISCONNECT
) ?

1120 (
we˛o£dfú°
 ? "Yes" : "No") : "N/A",

1121 ()
disc⁄√˘
->
£ssi⁄c
,

1122 ()
disc⁄√˘
->
≥î_disc⁄√˘c
);

1124 i‡(!
disc⁄√˘
->
isc⁄figuªd
)

1127 i‡(!
lockèkí
) {

1128 
	`socks_lock
(
lock
, (
off_t
)
Æ¨m
->
m°©s_shmid
, 1, 1, 1);

1129 
lockèkí
 = 1;

1132 
	`MUNPROTECT_SHMEMHEADER
(
Æ¨m
->
m°©s
);

1134 
	`¶og
(
LOG_ALARM
, "####nothing########### \n");

1135 
›v
[
›c
]) {

1136 
OP_CONNECT
:

1137 
	`SASSERTX
(
ªas⁄
 =
NULL
);

1139 
disc⁄√˘
->
£ssi⁄c
 += 1;

1140 i‡(
uif
) {

1141 
j
;

1142 
uif
->
Æ¨m
[
i
].
£ss_˙t
 +=1;

1143 
j
 = 0; j < 10; j++) {

1144 i‡(!
uif
->
Æ¨m
[
i
].
dù
[
j
]) {

1157 
uif
->
Æ¨m
[
i
].
dù
[
j
%10] = 
	`TOIN
(&
io
->
d°
.
øddr
)->
sö_addr
.
s_addr
;

1158 
ö_addr
 
ã°
;

1159 
ã°
.
s_addr
 = 
uif
->
Æ¨m
[
i
].
dù
[
j
];

1160 
	`¶og
(
LOG_ALARM
, "####ádd dù j=%d ip=%s\n", 
j
, 
	`öë_¡ﬂ
(
ã°
));

1164 
OP_DISCONNECT
:

1165 
	`SASSERTX
(
ªas⁄
 !
NULL
);

1166 
	`SASSERTX
(
disc⁄√˘
->
£ssi⁄c
 > 0);

1168 
disc⁄√˘
->
£ssi⁄c
 -= 1;

1169 
uif
 ? uif->
Æ¨m
[
i
].
£ss_˙t
 -=1 : 0;

1171 i‡(
we˛o£dfú°
)

1172 
disc⁄√˘
->
£lf_disc⁄√˘c
 += 1;

1174 
disc⁄√˘
->
≥î_disc⁄√˘c
 += 1;

1178 
OP_REMOVE_SESSION
:

1179 
	`SASSERTX
(
ªas⁄
 =
NULL
);

1180 
	`SASSERTX
(
disc⁄√˘
->
£ssi⁄c
 > 0);

1182 
disc⁄√˘
->
£ssi⁄c
 -= 1;

1183 
uif
 ? uif->
Æ¨m
[
i
].
£ss_˙t
 -=1 : 0;

1187 
	`SERRX
(
›v
[
›c
]);

1191 
	`MPROTECT_SHMEMHEADER
(
Æ¨m
->
m°©s
);

1195 i‡(
lockèkí
)

1196 
	`socks_u∆ock
(
lock
, (
off_t
)
Æ¨m
->
m°©s_shmid
, 1);

1198 i‡(
did©èch
)

1199 
	`sockd_shmdt
(
Æ¨m
, 
SHMEM_MONITOR
);

1200 
	}
}

1202 
	sMem‹ySåu˘
 {

1203 *
	mmem‹y
;

1204 
size_t
 
	msize
;

1207 
size_t


1208 
	$WrôeMem‹yCÆlback
(*
c⁄ã¡s
, 
size_t
 
size
, size_à
nmemb
, *
u£Ω
)

1210 
size_t
 
ªÆsize
 = 
size
 * 
nmemb
;

1212 
Mem‹ySåu˘
 *
mem
 = (Mem‹ySåu˘ *)
u£Ω
;

1214 
mem
->
mem‹y
 = 
	`ªÆloc
(mem->mem‹y, mem->
size
 + 
ªÆsize
 + 1);

1215 if(
mem
->
mem‹y
 =
NULL
) {

1216 
	`¥ötf
("notÉnough memory (reallocÑeturned NULL)\n");

1220 
	`mem˝y
(&(
mem
->
mem‹y
[mem->
size
]), 
c⁄ã¡s
, 
ªÆsize
);

1221 
mem
->
size
 +
ªÆsize
;

1222 
mem
->
mem‹y
[mem->
size
] = 0;

1224  
ªÆsize
;

1225 
	}
}

1227 
Mem‹ySåu˘
 
	gchunk
;

1228 
	gg_ù_vî
 = 0;

1229 
	$d‹ï‹ãr
(
CURL
 *
h™dÀ
, 
ty≥
) {

1230 
ªt
 = -1;

1231 c⁄° *
po°_°r
;

1233 
js⁄_obje˘
 *
ù_upd©e
 = 
	`js⁄_obje˘_√w_obje˘
();

1234 
	`js⁄_obje˘_obje˘_add
(
ù_upd©e
, "vî", 
	`js⁄_obje˘_√w_öt
(
g_ù_vî
));

1236 
po°_°r
 = 
	`js⁄_obje˘_to_js⁄_°rög
(
ù_upd©e
);

1238 
	`cuæ_ósy_£t›t
(
h™dÀ
, 
CURLOPT_POSTFIELDS
, 
po°_°r
);

1239 
	`cuæ_ósy_£t›t
(
h™dÀ
, 
CURLOPT_WRITEFUNCTION
, &
WrôeMem‹yCÆlback
);

1240 
	`cuæ_ósy_£t›t
(
h™dÀ
, 
CURLOPT_WRITEDATA
, (*)&
chunk
);

1241 
	`cuæ_ósy_£t›t
(
h™dÀ
, 
CURLOPT_VERBOSE
, 0L);

1243 
ªt
 = 
	`cuæ_ósy_≥rf‹m
(
h™dÀ
);

1244 if(
ªt
 !
CURLE_OK
) {

1245 
	`¶og
(
LOG_ALARM
, "cuæ_ósy_≥rf‹m(ËÁûed: %s\n", 
	`cuæ_ósy_°ªº‹
(
ªt
));

1247 
	`¶og
(
LOG_ALARM
, "########%lu byã†ªåõved\n", ()
chunk
.
size
);

1248 
FILE
 * 
fûe
;

1250 
fûe
 = 
	`f›í
("/tmp/iplist", "w");

1251 i‡(
fûe
 =
NULL
) {

1252 
	`¶og
(
LOG_ALARM
, "FailedÅo open /tmp/iplist");

1256 i‡(
	`fwrôe
(
chunk
.
mem‹y
, 1, chunk.
size
, 
fûe
) != chunk.size) {

1257 
	`¶og
(
LOG_ALARM
, "FailedÅo wirte /tmp/iplist");

1258 
	`f˛o£
(
fûe
);

1261 
	`f˛o£
(
fûe
);

1263 
js⁄_obje˘
 *
js⁄_ªsu…
 = 
	`js⁄_tokíî_∑r£
(
chunk
.
mem‹y
);

1264 
js⁄_obje˘
 *
°©us
, *
vî
, *
msg
;

1265 i‡(
js⁄_ªsu…
 =
NULL
) {

1266 
	`¶og
(
LOG_ALARM
, "FailedÅo get jsonÑesult\n");

1270 i‡(!
	`js⁄_obje˘_obje˘_gë_ex
(
js⁄_ªsu…
, "°©us", &
°©us
)

1271 || 
	`js⁄_obje˘_gë_ty≥
(
°©us
Ë!
js⁄_ty≥_öt
) {

1272 
	`¶og
(
LOG_ALARM
, "FailedÅo get status\n");

1276 
	`js⁄_obje˘_obje˘_gë_ex
(
js⁄_ªsu…
, "msg", &
msg
);

1277 
	`js⁄_obje˘_obje˘_gë_ex
(
js⁄_ªsu…
, "vî", &
vî
);

1279 
	`¶og
(
LOG_ALARM
, "status: (%d),ip_version=%d, msg = %s \n",

1280 
	`js⁄_obje˘_gë_öt
(
°©us
),

1281 
	`js⁄_obje˘_gë_öt
(
vî
),

1282 
	`js⁄_obje˘_gë_°rög
(
msg
));

1284 i‡(
	`js⁄_obje˘_gë_öt
(
°©us
) != 200)

1287 
g_ù_vî
 = 
	`js⁄_obje˘_gë_öt
(
vî
);

1289 i‡(
chunk
.
mem‹y
) {

1290 
	`‰ì
(
chunk
.
mem‹y
);

1291 
chunk
.
mem‹y
 = 
NULL
;

1297  
ªt
;

1298 
	}
}

1301 
	$checkm⁄ô‹s
()

1303 c⁄° *
fun˘i⁄
 = "checkmonitors()";

1304 c⁄° 
timevÆ
 
tzîo
 = { 0, 0 };

1305 
timevÆ
 
äow
;

1306 
m⁄ô‹_t
 *
m⁄ô‹
;

1308 
	`¶og
(
LOG_DEBUG
, "%s: [", 
fun˘i⁄
);

1310 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

1312 
m⁄ô‹
 = 
sockscf
.m⁄ô‹; m⁄ô‹ !
NULL
; m⁄ô‹ = m⁄ô‹->
√xt
) {

1313 
m⁄ô‹_°©s_t
 *
m°©s
;

1314 
timevÆ
 
timeout
;

1315 
size_t
 
£ssi⁄c
, 
ha°imedout
;

1316 
øng
;

1318 i‡(
m⁄ô‹
->
m°©s_shmid
 == 0)

1321 
	`SASSERTX
(
m⁄ô‹
->
m°©s
 !
NULL
);

1323 ()
	`timëûlcheck
(
m⁄ô‹
, &
äow
, &
timeout
, &
ha°imedout
);

1325 i‡(
ha°imedout
 == 0)

1328 
	`SASSERTX
(!
	`timîcmp
(&
timeout
, &
tzîo
, >));

1329 
	`SASSERTX
(
m⁄ô‹
->
Æ¨msc⁄figuªd
 != 0);

1331 
	`¶og
(
LOG_DEBUG
,

1334 
fun˘i⁄
,

1335 ()
m⁄ô‹
->
numbî
,

1336 ()
m⁄ô‹
->
m°©s_shmid
,

1337 ()
m⁄ô‹
->
Æ¨msc⁄figuªd
,

1338 ()
ha°imedout
);

1340 
m°©s
 = &
m⁄ô‹
->m°©s->
obje˘
.monitor;

1341 #i‡
DEBUG


1342 
m⁄ô‹_°©s_t
 
_m°©s
 = *
m°©s
;

1345 
£ssi⁄c
 = 
m⁄ô‹
->
m°©s
->
m°©e
.
˛õ¡s
,

1354 
	`socks_lock
(
sockscf
.
shmemfd
, (
off_t
)
m⁄ô‹
->
m°©s_shmid
, 1, 1, 1);

1356 i‡(
ha°imedout


1357 & ( 
ALARM_INTERNAL_RECV


1358 | 
ALARM_INTERNAL_SEND


1359 | 
ALARM_EXTERNAL_RECV


1360 | 
ALARM_EXTERNAL_SEND
)) {

1361 i‡(
m⁄ô‹
->
Æ¨m_d©a_aggªg©e
 != 0) {

1366 
Æ¨m_d©a_side_t
 
agg
;

1367 
timevÆ
 
lio
;

1368 
size_t
 
byãs
, 
Æ¨msides
;

1370 
Æ¨msides
 = 0;

1371 
byãs
 = 0;

1372 
	`timî˛ór
(&
lio
);

1374 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
) {

1375 
agg
 = 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
;

1376 
byãs
 +
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.bytes;

1377 
Æ¨msides
 |
ALARM_INTERNAL_RECV
;

1379 i‡(
	`timîcmp
(&
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°io
, &
lio
, >))

1380 
lio
 = 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°io
;

1383 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
) {

1384 
agg
 = 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
;

1385 
byãs
 +
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.bytes;

1386 
Æ¨msides
 |
ALARM_INTERNAL_SEND
;

1388 i‡(
	`timîcmp
(&
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°io
, &
lio
, >))

1389 
lio
 = 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°io
;

1392 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
) {

1393 
agg
 = 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
;

1394 
byãs
 +
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.bytes;

1395 
Æ¨msides
 |
ALARM_EXTERNAL_RECV
;

1397 i‡(
	`timîcmp
(&
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°io
, &
lio
, >))

1398 
lio
 = 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°io
;

1401 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
) {

1402 
agg
 = 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
;

1403 
byãs
 +
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.bytes;

1404 
Æ¨msides
 |
ALARM_EXTERNAL_SEND
;

1406 i‡(
	`timîcmp
(&
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°io
, &
lio
, >))

1407 
lio
 = 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°io
;

1410 
agg
.
byãs
 = bytes;

1411 
agg
.
œ°io
 = 
lio
;

1413 
m⁄ô‹
->
Æ¨m_d©a_aggªg©e
) {

1414 
ALARM_INTERNAL
 | 
ALARM_EXTERNAL
 | 
ALARM_RECV
 |
ALARM_SEND
:

1415 
Æ¨msides
 = (
size_t
)-1;

1418 
ALARM_INTERNAL
 | 
ALARM_EXTERNAL
:

1419 i‡(
Æ¨msides
 & (
ALARM_INTERNAL_RECV
 | 
ALARM_EXTERNAL_RECV
))

1420 
Æ¨msides
 = 
ALARM_RECV
;

1422 
	`SASSERTX
(
Æ¨msides


1423 & (
ALARM_INTERNAL_SEND
 | 
ALARM_INTERNAL_RECV
));

1424 
Æ¨msides
 = 
ALARM_SEND
;

1428 
ALARM_RECV
 | 
ALARM_SEND
:

1429 i‡(
Æ¨msides
 & (
ALARM_INTERNAL_RECV
 | 
ALARM_INTERNAL_SEND
))

1430 
Æ¨msides
 = 
ALARM_INTERNAL
;

1432 
	`SASSERTX
(
Æ¨msides


1433 & (
ALARM_EXTERNAL_RECV
 | 
ALARM_EXTERNAL_SEND
));

1434 
Æ¨msides
 = 
ALARM_EXTERNAL
;

1439 
	`SERRX
(
m⁄ô‹
->
Æ¨m_d©a_aggªg©e
);

1442 
	`Æ¨mcheck_d©a
(
m⁄ô‹
, &
agg
, 
Æ¨msides
, 
£ssi⁄c
, &
äow
);

1448 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
)

1449 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
 = 
agg
;

1451 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
)

1452 
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
 = 
agg
;

1454 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
)

1455 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
 = 
agg
;

1457 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
)

1458 
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
 = 
agg
;

1461 i‡(
ha°imedout
 & 
ALARM_EXTERNAL_RECV
) {

1462 
Æ¨m_d©a_side_t
 *
Æ¨m
 = &
m°©s
->
exã∫Æ
.Æ¨m.
d©a
.
ªcv
;

1464 
	`Æ¨mcheck_d©a
(
m⁄ô‹
,

1465 
Æ¨m
,

1466 
ALARM_EXTERNAL_RECV
,

1467 
£ssi⁄c
,

1468 &
äow
);

1471 i‡(
ha°imedout
 & 
ALARM_EXTERNAL_SEND
) {

1472 
Æ¨m_d©a_side_t
 *
Æ¨m
 = &
m°©s
->
exã∫Æ
.Æ¨m.
d©a
.
£nd
;

1474 
	`Æ¨mcheck_d©a
(
m⁄ô‹
,

1475 
Æ¨m
,

1476 
ALARM_EXTERNAL_SEND
,

1477 
£ssi⁄c
,

1478 &
äow
);

1481 i‡(
ha°imedout
 & 
ALARM_INTERNAL_RECV
) {

1482 
Æ¨m_d©a_side_t
 *
Æ¨m
 = &
m°©s
->
öã∫Æ
.Æ¨m.
d©a
.
ªcv
;

1484 
	`Æ¨mcheck_d©a
(
m⁄ô‹
,

1485 
Æ¨m
,

1486 
ALARM_INTERNAL_RECV
,

1487 
£ssi⁄c
,

1488 &
äow
);

1491 i‡(
ha°imedout
 & 
ALARM_INTERNAL_SEND
) {

1492 
Æ¨m_d©a_side_t
 *
Æ¨m
 = &
m°©s
->
öã∫Æ
.Æ¨m.
d©a
.
£nd
;

1494 
	`Æ¨mcheck_d©a
(
m⁄ô‹
,

1495 
Æ¨m
,

1496 
ALARM_INTERNAL_SEND
,

1497 
£ssi⁄c
,

1498 &
äow
);

1502 
CURLcode
 
ªtu∫_code
;

1503 
ªtu∫_code
 = 
	`cuæ_globÆ_öô
(
CURL_GLOBAL_ALL
);

1504 i‡(
CURLE_OK
 !
ªtu∫_code
) {

1505 
	`¶og
(
LOG_DEBUG
, "initÜibcurl failed.\n");

1509 
CURL
 *
ósy_h™dÀ
 = 
	`cuæ_ósy_öô
();

1510 i‡(
NULL
 =
ósy_h™dÀ
) {

1511 
	`¶og
(
LOG_DEBUG
, "getáÉasy handle failed.\n");

1512 
	`cuæ_globÆ_˛ónup
();

1517 *
uæ
 = 
IP_PORT
"/v1/state/userinfo";

1518 
	`cuæ_ósy_£t›t
(
ósy_h™dÀ
, 
CURLOPT_URL
, 
uæ
);

1519 
	`doupd©e
(
ósy_h™dÀ
, 
ST_USERINFO
, 
m⁄ô‹
);

1521 
uæ
 = 
IP_PORT
"/v1/state/cardinfo";

1522 
	`cuæ_ósy_£t›t
(
ósy_h™dÀ
, 
CURLOPT_URL
, 
uæ
);

1523 
	`doupd©e
(
ósy_h™dÀ
, 
ST_CARDINFO
, 
m⁄ô‹
);

1525 
uæ
 = 
IP_PORT
"/v1/iplist";

1526 
	`cuæ_ósy_£t›t
(
ósy_h™dÀ
, 
CURLOPT_URL
, 
uæ
);

1527 
	`d‹ï‹ãr
(
ósy_h™dÀ
, 0);

1529 
	`cuæ_ósy_˛ónup
(
ósy_h™dÀ
);

1530 
	`cuæ_globÆ_˛ónup
();

1533 
	#RESET_DISCONNECT
(
_Æ¨m
, 
_äow
) \

1535 (
_Æ¨m
)->
œ°ª£t
 = (
_äow
); \

1536 (
_Æ¨m
)->
≥î_disc⁄√˘c
 = 0; \

1537 (
_Æ¨m
)->
£lf_disc⁄√˘c
 = 0; \

1538 }  0)

	)

1540 
	`MUNPROTECT_SHMEMHEADER
(
m⁄ô‹
->
m°©s
);

1542 i‡(
ha°imedout
 & (
ALARM_INTERNAL
 | 
ALARM_EXTERNAL
)) {

1543 i‡(
m⁄ô‹
->
Æ¨m_disc⁄√˘_aggªg©e
 != 0) {

1544 
Æ¨m_disc⁄√˘_t
 
agg
;

1546 
	`SASSERTX
(
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
);

1547 
	`SASSERTX
(
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
);

1549 
agg
 = 
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
;

1551 
agg
.
≥î_disc⁄√˘c


1552 +
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
≥î_disc⁄√˘c
;

1554 
agg
.
£lf_disc⁄√˘c


1555 +
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
£lf_disc⁄√˘c
;

1557 
	`Æ¨mcheck_disc⁄√˘
(
m⁄ô‹
,

1558 &
agg
,

1559 (
size_t
)-1,

1560 &
äow
,

1561 &
øng
);

1563 
	`RESET_DISCONNECT
(&
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
, 
äow
);

1564 
	`RESET_DISCONNECT
(&
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
, 
äow
);

1567 i‡(
ha°imedout
 & 
ALARM_EXTERNAL
) {

1568 
Æ¨m_disc⁄√˘_t
 *
Æ¨m
 = &
m°©s
->
exã∫Æ
.Æ¨m.
disc⁄√˘
;

1570 
	`Æ¨mcheck_disc⁄√˘
(
m⁄ô‹
,

1571 
Æ¨m
,

1572 
ALARM_EXTERNAL
,

1573 &
äow
,

1574 &
øng
);

1576 
	`RESET_DISCONNECT
(
Æ¨m
, 
äow
);

1579 i‡(
ha°imedout
 & 
ALARM_INTERNAL
) {

1580 
Æ¨m_disc⁄√˘_t
 *
Æ¨m
 = &
m°©s
->
öã∫Æ
.Æ¨m.
disc⁄√˘
;

1582 
	`Æ¨mcheck_disc⁄√˘
(
m⁄ô‹
,

1583 
Æ¨m
,

1584 
ALARM_INTERNAL
,

1585 &
äow
,

1586 &
øng
);

1588 
	`RESET_DISCONNECT
(
Æ¨m
, 
äow
);

1594 
	`MPROTECT_SHMEMHEADER
(
m⁄ô‹
->
m°©s
);

1596 
	`socks_u∆ock
(
sockscf
.
shmemfd
, (
off_t
)
m⁄ô‹
->
m°©s_shmid
, 1);

1599 
	`¶og
(
LOG_DEBUG
, "%s: ]", 
fun˘i⁄
);

1600 
	}
}

1603 
	$Æ¨mcheck_disc⁄√˘
(
m⁄ô‹
, 
Æ¨m
, 
Æ¨mside
, 
äow
, 
Æ¨måiggîed
)

1604 c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
;

1605 
Æ¨m_disc⁄√˘_t
 *
Æ¨m
;

1606 c⁄° 
size_t
 
Æ¨mside
;

1607 c⁄° 
timevÆ
 *
äow
;

1608 *
Æ¨måiggîed
;

1610 c⁄° *
fun˘i⁄
 = "alarmcheck_disconnect()";

1611 
timevÆ
 
tdiff
;

1612 
size_t
 
£ssi⁄s_this_≥riod
;

1613 
§c
[
MAXRULEADDRSTRING
], 
d°
[(src)];

1615 *
Æ¨måiggîed
 = 0;

1617 
	`timîsub
(
äow
, &(
Æ¨m
)->
œ°ª£t
, &
tdiff
);

1620 
	`SASSERTX
(
tdiff
.
tv_£c
 >
Æ¨m
->
limô
.
£c⁄ds
);

1622 
	`¶og
(
LOG_DEBUG
,

1626 
fun˘i⁄
,

1627 
Æ¨mside
 =(
size_t
)-1 ? "<Æl>" : 
	`Æ¨mside2°rög
(alarmside),

1628 ()
m⁄ô‹
->
numbî
,

1629 ()
tdiff
.
tv_£c
,

1630 ()
tdiff
.
tv_u£c
,

1631 ()
Æ¨m
->
limô
.
£c⁄ds
,

1632 ()
Æ¨m
->
£ssi⁄c
,

1633 ()
Æ¨m
->
≥î_disc⁄√˘c
,

1634 ()
Æ¨m
->
£lf_disc⁄√˘c
);

1636 i‡(
Æ¨m
->
≥î_disc⁄√˘c
 <áœrm->
limô
.
disc⁄√˘c
)

1644 
£ssi⁄s_this_≥riod


1645 
Æ¨m
->
£ssi⁄c
 +áœrm->
≥î_disc⁄√˘c
 +áœrm->
£lf_disc⁄√˘c
;

1647 i‡(
£ssi⁄s_this_≥riod
 == 0)

1650 
	`¶og
(
LOG_DEBUG
, "%s: comparing %lu/%lu (%lu) vs %lu/%lu (%lu)",

1651 
fun˘i⁄
,

1652 ()
Æ¨m
->
≥î_disc⁄√˘c
,

1653 ()
£ssi⁄s_this_≥riod
,

1654 ()(
Æ¨m
->
≥î_disc⁄√˘c
 / 
£ssi⁄s_this_≥riod
),

1655 ()
Æ¨m
->
limô
.
disc⁄√˘c
,

1656 ()
Æ¨m
->
limô
.
£ssi⁄c
,

1657 ()(
Æ¨m
->
limô
.
disc⁄√˘c
 /áœrm->limô.
£ssi⁄c
));

1659 i‡((
Æ¨m
->
≥î_disc⁄√˘c
 / 
£ssi⁄s_this_≥riod
)

1660 >(
Æ¨m
->
limô
.
disc⁄√˘c
 /áœrm->limô.
£ssi⁄c
)) {

1661 
	`¶og
(
LOG_ALARM
,

1664 ()
m⁄ô‹
->
numbî
,

1665 
	`ruÀaddr2°rög
(&
m⁄ô‹
->
§c
, 
ADDRINFO_PORT
, src, (src)),

1666 
	`ruÀaddr2°rög
(&
m⁄ô‹
->
d°
, 
ADDRINFO_PORT
, dst, (dst)),

1667 
Æ¨mside
 =(
size_t
)-1 ? "" : " ",

1668 
Æ¨mside
 =(
size_t
)-1 ? "" : 
	`Æ¨mside2°rög
(alarmside),

1669 ()
Æ¨m
->
≥î_disc⁄√˘c
,

1670 ()
£ssi⁄s_this_≥riod
,

1671 ()
tdiff
.
tv_£c
,

1672 ()
Æ¨m
->
£ssi⁄c
);

1674 *
Æ¨måiggîed
 = 1;

1676 
	}
}

1679 
	$Æ¨mcheck_d©a
(
m⁄ô‹
, 
Æ¨m
, 
Æ¨mside
, 
£ssi⁄c
, 
äow
)

1680 c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
;

1681 
Æ¨m_d©a_side_t
 *
Æ¨m
;

1682 c⁄° 
size_t
 
Æ¨mside
;

1683 c⁄° 
size_t
 
£ssi⁄c
;

1684 c⁄° 
timevÆ
 *
äow
;

1686 c⁄° *
fun˘i⁄
 = "alarmcheck_data()";

1688 
	`¶og
(
LOG_DEBUG
,

1691 
fun˘i⁄
,

1692 ()
m⁄ô‹
->
numbî
,

1693 
Æ¨mside
 =(
size_t
)-1 ? "<Æl>" : 
	`Æ¨mside2°rög
(alarmside),

1694 
Æ¨m
->
is⁄
 ? "on" : "off",

1695 ()
Æ¨m
->
byãs
,

1696 ()
Æ¨m
->
œ°io
.
tv_£c
,

1697 ()
Æ¨m
->
œ°io
.
tv_u£c
);

1699 
	`MUNPROTECT_SHMEMHEADER
(
m⁄ô‹
->
m°©s
);

1701 i‡(
Æ¨m
->
byãs
 <Æ¨m->
limô
.bytes) {

1706 i‡(!
Æ¨m
->
is⁄
)

1707 
	`Æ¨m_d©a_toggÀ
(
m⁄ô‹
, 
Æ¨mside
, 
Æ¨m
, 
äow
);

1710 
Æ¨m
->
œ°ª£t
 = *
äow
;

1717 i‡(
Æ¨m
->
is⁄
) {

1718 
	`Æ¨m_d©a_toggÀ
(
m⁄ô‹
, 
Æ¨mside
, 
Æ¨m
, 
äow
);

1719 
Æ¨m
->
œ°ª£t
 = *
äow
;

1725 
Æ¨m
->
œ°ª£t
 =áœrm->
œ°io
;

1729 
Æ¨m
->
byãs
 = 0;

1731 
	`MPROTECT_SHMEMHEADER
(
m⁄ô‹
->
m°©s
);

1732 
	}
}

1735 
	$Æ¨m_d©a_toggÀ
(
m⁄ô‹
, 
Æ¨mside
, 
Æ¨m
, 
äow
)

1736 c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
;

1737 c⁄° 
size_t
 
Æ¨mside
;

1738 
Æ¨m_d©a_side_t
 *
Æ¨m
;

1739 c⁄° 
timevÆ
 *
äow
;

1741 c⁄° *
fun˘i⁄
 = "alarm_data_toggle()";

1742 
timevÆ
 
tdiff
;

1743 
§c
[
MAXRULEADDRSTRING
], 
d°
[(§c)], 
Æ¨mduøti⁄
[256];

1745 
	`SASSERTX
(
m⁄ô‹
->
m°©s
 !
NULL
);

1746 
	`SASSERTX
(
Æ¨m
->
isc⁄figuªd
);

1748 i‡(
Æ¨m
->
is⁄
) {

1749 
Æ¨m
->
is⁄
 = 0;

1751 
	`SASSERTX
(
	`timîis£t
(&
Æ¨m
->
Æ¨mch™ge
));

1753 
	`timîsub
(
äow
, &
Æ¨m
->
Æ¨mch™ge
, &
tdiff
);

1754 
	`¢¥ötf
(
Æ¨mduøti⁄
, (alarmduration),

1755 "Aœrm duøti⁄: %lds", ()
tdiff
.
tv_£c
);

1758 
Æ¨m
->
is⁄
 = 1;

1759 *
Æ¨mduøti⁄
 = 
NUL
;

1762 
Æ¨m
->
Æ¨mch™ge
 = *
äow
;

1764 
	`timîsub
(
äow
, &
Æ¨m
->
œ°ª£t
, &
tdiff
);

1766 
	`¶og
(
LOG_ALARM
,

1769 ()
m⁄ô‹
->
numbî
,

1770 
Æ¨m
->
is⁄
 ? '[' : ']',

1771 
	`ruÀaddr2°rög
(&
m⁄ô‹
->
§c
, 
ADDRINFO_PORT
, src, (src)),

1772 
	`ruÀaddr2°rög
(&
m⁄ô‹
->
d°
, 
ADDRINFO_PORT
, dst, (dst)),

1773 
Æ¨mside
 =(
size_t
)-1 ? "" : " ",

1774 
Æ¨mside
 =(
size_t
)-1 ? "" : 
	`Æ¨mside2°rög
(alarmside),

1775 ()
Æ¨m
->
byãs
,

1776 ()
Æ¨m
->
limô
.
byãs
,

1777 ()
tdiff
.
tv_£c
,

1778 ()
m⁄ô‹
->
m°©s
->
m°©e
.
˛õ¡s
,

1779 *
Æ¨mduøti⁄
 =
NUL
 ? "" : ". ",

1780 
Æ¨mduøti⁄
);

1781 
	}
}

1783 
timevÆ
 *

1784 
	$gëtimeout
(
timeout
)

1785 
timevÆ
 *
timeout
;

1787 c⁄° *
fun˘i⁄
 = "gettimeout()";

1788 c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
;

1789 c⁄° 
timevÆ
 
tzîo
 = { 0, 0 };

1790 
timevÆ
 
äow
;

1792 
timeout_is£t
 = 0;

1793 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

1795 
m⁄ô‹
 = 
sockscf
.m⁄ô‹; m⁄ô‹ !
NULL
; m⁄ô‹ = m⁄ô‹->
√xt
) {

1796 
timevÆ
 
m⁄ô‹timeout
;

1798 i‡(
m⁄ô‹
->
m°©s_shmid
 == 0)

1801 
	`SASSERTX
(
m⁄ô‹
->
m°©s
 !
NULL
);

1803 i‡(
	`timëûlcheck
(
m⁄ô‹
, &
äow
, &
m⁄ô‹timeout
, 
NULL
) == NULL)

1806 i‡(!
timeout_is£t
 || 
	`timîcmp
(&
m⁄ô‹timeout
, 
timeout
, <)) {

1807 *
timeout
 = 
m⁄ô‹timeout
;

1808 
timeout_is£t
 = 1;

1812 i‡(
timeout_is£t
) {

1813 i‡(
	`timîcmp
(
timeout
, &
tzîo
, <))

1814 
	`timî˛ór
(
timeout
);

1816  
timeout
;

1819  
NULL
;

1820 
	}
}

1822 
timevÆ
 *

1823 
	$timëûlcheck
(
m⁄ô‹
, 
äow
, 
tfú°check
, 
ha°imedout
)

1824 c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
;

1825 c⁄° 
timevÆ
 *
äow
;

1826 
timevÆ
 *
tfú°check
;

1827 
size_t
 *
ha°imedout
;

1829 c⁄° *
fun˘i⁄
 = "timetillcheck()";

1830 c⁄° 
timevÆ
 
tzîo
 = { 0, 0 };

1831 
timevÆ
 
äextcheck
;

1832 
m⁄ô‹_°©s_t
 *
m°©s
;

1833 
size_t
 
ha°imedout_mem
;

1834 
tfú°check_is£t
;

1836 i‡(
ha°imedout
 =
NULL
)

1837 
ha°imedout
 = &
ha°imedout_mem
;

1839 
	`SASSERTX
(
m⁄ô‹
->
m°©s
 !
NULL
);

1840 
m°©s
 = &
m⁄ô‹
->m°©s->
obje˘
.monitor;

1842 #i‡
DEBUG


1843 
m⁄ô‹_°©s_t
 
_m°©s
 = *
m°©s
;

1846 
	#PRINT_DATALIMIT
(
m⁄ô‹numbî
, 
öãrÁ˚
, 
io›
, 
timeout
) \

1848 
	`¶og
(
LOG_DEBUG
, \

1851 
fun˘i⁄
, \

1852 ()(
m⁄ô‹numbî
), \

1853 (
öãrÁ˚
), \

1854 (
io›
), \

1855 ()(
timeout
)->
tv_£c
, \

1856 ()(
timeout
)->
tv_u£c
, \

1857 ()(
timeout
)->
tv_£c
 < 0 ? "(" : "", \

1858 ()(
timeout
)->
tv_£c
 < 0 ? "now" : "", \

1859 ()(
timeout
)->
tv_£c
 < 0 ? ")" : ""); \

1860 }  0)

	)

1862 
	#PRINT_DISCONNECTLIMIT
(
m⁄ô‹numbî
, 
öãrÁ˚
, 
timeout
) \

1864 
	`¶og
(
LOG_DEBUG
, \

1867 
fun˘i⁄
, \

1868 ()(
m⁄ô‹numbî
), \

1869 (
öãrÁ˚
), \

1870 ()(
timeout
)->
tv_£c
, \

1871 ()(
timeout
)->
tv_u£c
, \

1872 ()(
timeout
)->
tv_£c
 < 0 ? "(" : "", \

1873 ()(
timeout
)->
tv_£c
 < 0 ? "now" : "", \

1874 ()(
timeout
)->
tv_£c
 < 0 ? ")" : ""); \

1875 }  0)

	)

1878 
	#TIMERCALC
(
obje˘
, 
äextcheck
, 
tfú°check
, 
äow
) \

1880 c⁄° 
timevÆ
 
limô
 = { (
obje˘
)->limô.
£c⁄ds
, 0 }; \

1881 
timevÆ
 
tshouldbechecked
; \

1883 
	`SASSERTX
((
obje˘
)->
limô
.
£c⁄ds
 > 0); \

1884 
	`SASSERTX
(
	`timîis£t
(&
limô
)); \

1886 
	`timîadd
(&((
obje˘
)->
œ°ª£t
), &
limô
, &
tshouldbechecked
); \

1887 
	`timîsub
(&
tshouldbechecked
, (
äow
), (
äextcheck
)); \

1889 
	`¶og
(
LOG_DEBUG
, \

1891 
fun˘i⁄
, \

1892 ()
tshouldbechecked
.
tv_£c
, \

1893 ()
tshouldbechecked
.
tv_u£c
, \

1894 ()(
äow
)->
tv_£c
, \

1895 ()(
äow
)->
tv_u£c
); \

1897 i‡(!
tfú°check_is£t
 || 
	`timîcmp
((
äextcheck
), (
tfú°check
), <)) { \

1898 *(
tfú°check
Ë*(
äextcheck
); \

1899 
tfú°check_is£t
 = 1; \

1901 }  0)

	)

1903 
	`timî˛ór
(
tfú°check
);

1904 
tfú°check_is£t
 = 0;

1905 *
ha°imedout
 = 0;

1907 i‡(
m⁄ô‹
->
Æ¨msc⁄figuªd
 & 
ALARM_DATA
) {

1908 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
) {

1909 
	`TIMERCALC
(&
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
,

1910 &
äextcheck
,

1911 
tfú°check
,

1912 
äow
);

1914 i‡(
	`timîcmp
(&
tzîo
, &
äextcheck
, >))

1915 *
ha°imedout
 |
ALARM_INTERNAL_RECV
;

1917 
	`PRINT_DATALIMIT
(
m⁄ô‹
->
numbî
, "öã∫Æ", "ª˚ivög", &
äextcheck
);

1920 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
) {

1921 
	`TIMERCALC
(&
m°©s
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
,

1922 &
äextcheck
,

1923 
tfú°check
,

1924 
äow
);

1926 i‡(
	`timîcmp
(&
tzîo
, &
äextcheck
, >))

1927 *
ha°imedout
 |
ALARM_INTERNAL_SEND
;

1929 
	`PRINT_DATALIMIT
(
m⁄ô‹
->
numbî
, "öã∫Æ", "£ndög", &
äextcheck
);

1932 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
) {

1933 
	`TIMERCALC
(&
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
,

1934 &
äextcheck
,

1935 
tfú°check
,

1936 
äow
);

1938 i‡(
	`timîcmp
(&
tzîo
, &
äextcheck
, >))

1939 *
ha°imedout
 |
ALARM_EXTERNAL_RECV
;

1941 
	`PRINT_DATALIMIT
(
m⁄ô‹
->
numbî
, "exã∫Æ", "ª˚ivög", &
äextcheck
);

1944 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
) {

1945 
	`TIMERCALC
(&
m°©s
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
,

1946 &
äextcheck
,

1947 
tfú°check
,

1948 
äow
);

1950 i‡(
	`timîcmp
(&
tzîo
, &
äextcheck
, >))

1951 *
ha°imedout
 |
ALARM_EXTERNAL_SEND
;

1953 
	`PRINT_DATALIMIT
(
m⁄ô‹
->
numbî
, "exã∫Æ", "£ndög", &
äextcheck
);

1957 i‡(
m⁄ô‹
->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
) {

1958 i‡(
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
) {

1959 
	`TIMERCALC
(&
m°©s
->
öã∫Æ
.
Æ¨m
.
disc⁄√˘
,

1960 &
äextcheck
,

1961 
tfú°check
,

1962 
äow
);

1964 i‡(
	`timîcmp
(&
tzîo
, &
äextcheck
, >))

1965 *
ha°imedout
 |
ALARM_INTERNAL
;

1967 
	`PRINT_DISCONNECTLIMIT
(
m⁄ô‹
->
numbî
, "öã∫Æ", &
äextcheck
);

1970 i‡(
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
) {

1971 
	`TIMERCALC
(&
m°©s
->
exã∫Æ
.
Æ¨m
.
disc⁄√˘
,

1972 &
äextcheck
,

1973 
tfú°check
,

1974 
äow
);

1976 i‡(
	`timîcmp
(&
tzîo
, &
äextcheck
, >))

1977 *
ha°imedout
 |
ALARM_EXTERNAL
;

1979 
	`PRINT_DISCONNECTLIMIT
(
m⁄ô‹
->
numbî
, "exã∫Æ", &
äextcheck
);

1983 i‡(
tfú°check_is£t
)

1984 
	`¶og
(
LOG_DEBUG
, "%s: first check for monitor #%lu is in %ld.%06lds",

1985 
fun˘i⁄
,

1986 ()
m⁄ô‹
->
numbî
,

1987 ()
tfú°check
->
tv_£c
,

1988 ()
tfú°check
->
tv_u£c
);

1990 
	`¶og
(
LOG_DEBUG
, "%s:Ço check scheduled for monitor #%lu",

1991 
fun˘i⁄
, ()
m⁄ô‹
->
numbî
);

1993 
tfú°check
 = 
NULL
;

1996  
tfú°check
;

1997 
	}
}

2000 
	$sigöfo
(
sig
, 
si
, 
sc
)

2001 
sig
;

2002 
sigöfo_t
 *
si
;

2003 *
sc
;

2005 c⁄° *
fun˘i⁄
 = "siginfo()";

2006 c⁄° 
î∫o_s
 = 
î∫o
;

2007 
time_t
 
äow
;

2008 
days
, 
hours
, 
möuãs
, 
£c⁄ds
;

2010 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

2012 
£c⁄ds
 = ()
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(&
äow
),

2013 
sockscf
.
°©
.
boŸ
);

2015 
	`£c⁄ds2days
(&
£c⁄ds
, &
days
, &
hours
, &
möuãs
);

2017 
	`¶og
(
LOG_INFO
, "%s up %lu day%s, %lu:%.2lu:%.2lu",

2018 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
),

2019 
days
, days == 1 ? "" : "s",

2020 
hours
,

2021 
möuãs
,

2022 
£c⁄ds
);

2024 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

2025 
	}
}

2028 
	$¥o˘ôÀupd©e
()

2032 
	`£çro˘ôÀ
("%s", 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
));

2034 
	`£çro˘ôÀ
("%s: %luálarm%sáctive",

2035 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
),

2036 ()
°©e
.
Æ¨mß˘ive
,

2037 
°©e
.
Æ¨mß˘ive
 == 1 ? "" : "s");

2040 
	}
}

2043 
	$›2°rög
(
›
)

2044 c⁄° 
size_t
 
›
;

2047 
›
) {

2048 
OP_CONNECT
:

2051 
OP_DISCONNECT
:

2054 
OP_REMOVE_SESSION
:

2058 
	`SERRX
(
›
);

2059 
	}
}

2062 
	$showÆ¨ms
(
iÁ˚
)

2063 c⁄° 
m⁄ô‹_if_t
 *
iÁ˚
;

2066 
	#DOPRINT_DATA
(
©å
, 
›
) \

2068 
	`¶og
(
LOG_DEBUG
, \

2070 (
›
), \

2071 ()
iÁ˚
->
Æ¨m
.
d©a
.
©å
.
limô
.
byãs
, \

2072 
iÁ˚
->
Æ¨m
.
d©a
.
©å
.
limô
.
byãs
 == 1 ? "" : "s", \

2073 ()
iÁ˚
->
Æ¨m
.
d©a
.
©å
.
limô
.
£c⁄ds
, \

2074 
iÁ˚
->
Æ¨m
.
d©a
.
©å
.
limô
.
£c⁄ds
 == 1 ? "" : "s"); \

2075 }  0)

	)

2078 i‡(
iÁ˚
->
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
)

2079 
	`DOPRINT_DATA
(
ªcv
, "receiving");

2081 i‡(
iÁ˚
->
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
)

2082 
	`DOPRINT_DATA
(
£nd
, "sending");

2084 i‡(
iÁ˚
->
Æ¨m
.
disc⁄√˘
.
isc⁄figuªd
)

2085 
	`¶og
(
LOG_DEBUG
,

2087 ()
iÁ˚
->
Æ¨m
.
disc⁄√˘
.
limô
.
disc⁄√˘c
,

2088 ()
iÁ˚
->
Æ¨m
.
disc⁄√˘
.
limô
.
£ssi⁄c
,

2089 ()
iÁ˚
->
Æ¨m
.
disc⁄√˘
.
limô
.
£c⁄ds
,

2090 
iÁ˚
->
Æ¨m
.
disc⁄√˘
.
limô
.
£c⁄ds
 == 1 ? "" : "s");

2091 
	}
}

2093 
size_t
 
	$¥o˚ss_d©a
(*
buf„r
, 
size_t
 
size
, size_à
nmemb
, *
u£r_p
) {

2094 
js⁄_obje˘
 *
js⁄_ªsu…
;

2095 
js⁄_obje˘
 *
d©a
, *
°©us
;

2096 
js⁄_obje˘
 *
uid
, *
key
;

2097 
js⁄_obje˘
 *
msg
, *
machöe_id
;

2099 
	`¶og
(
LOG_ALARM
, "%s\n", (*Ë
buf„r
);

2101 
js⁄_ªsu…
 = 
	`js⁄_tokíî_∑r£
(
buf„r
);

2102 i‡(
js⁄_ªsu…
 =
NULL
) {

2103 
	`¶og
(
LOG_ALARM
, "FailedÅo get jsonÑesult\n");

2107 i‡(!
	`js⁄_obje˘_obje˘_gë_ex
(
js⁄_ªsu…
, "°©us", &
°©us
)

2108 || 
	`js⁄_obje˘_gë_ty≥
(
°©us
Ë!
js⁄_ty≥_öt
) {

2110 
	`¶og
(
LOG_ALARM
, "FailedÅo get status\n");

2111 
exô
;

2114 
	`js⁄_obje˘_obje˘_gë_ex
(
js⁄_ªsu…
, "msg", &
msg
);

2115 
	`¶og
(
LOG_ALARM
, "°©us: (%d), msg = %†\n", 
	`js⁄_obje˘_gë_öt
(
°©us
), 
	`js⁄_obje˘_gë_°rög
(
msg
));

2116 i‡(
	`js⁄_obje˘_gë_öt
(
°©us
) != 200) {

2117 
	`¶og
(
LOG_ALARM
, "°©u†îr‹: %d\n", 
	`js⁄_obje˘_gë_öt
(
°©us
));

2120 
exô
:

2121 
	`js⁄_obje˘_put
(
js⁄_ªsu…
);

2124 
	}
}

2126 
	$gë_ˇrdöfo
(* 
i‚ame
, 
uöt64_t
 *
tx
, uöt64_à*
rx
)

2128 
π∆_lök
 *
lök
;

2129 
∆_sock
 *
sk
;

2130 
∆_ˇche
 *
lök_ˇche
;

2131 
îr
 = 0;

2132 
buf
[64];

2134 
sk
 = 
	`∆_sockë_Æloc
();

2135 i‡(!
sk
) {

2136 
	`¶og
(
LOG_DEBUG
, "@@@@@@FailedÅoállocÇetlink socket");

2140 i‡((
îr
 = 
	`∆_c⁄√˘
(
sk
, 
NETLINK_ROUTE
)) < 0) {

2141 
	`∆_≥º‹
(
îr
, "UnableÅo connect socket");

2142  
îr
;

2145 i‡((
îr
 = 
	`π∆_lök_Æloc_ˇche
(
sk
, 
AF_UNSPEC
, &
lök_ˇche
)) < 0) {

2146 
	`∆_≥º‹
(
îr
, "UnableÅoállocate cache");

2147  
îr
;

2150 
lök
 = (
π∆_lök
 *)
	`π∆_lök_gë_by_«me
(
lök_ˇche
, 
i‚ame
);

2152 i‡(!
lök
)

2153 
exô
;

2155 *
rx
 = 
	`π∆_lök_gë_°©
(
lök
, 
RTNL_LINK_RX_BYTES
);

2156 *
tx
 = 
	`π∆_lök_gë_°©
(
lök
, 
RTNL_LINK_TX_BYTES
);

2159 
	`π∆_lök_put
(
lök
);

2161 
exô
:

2162 
	`∆_ˇche_‰ì
(
lök_ˇche
);

2163 
	`∆_sockë_‰ì
(
sk
);

2166 
	}
}

2168 
	$gëùaddr
(*
i‚ame
, 
ö_addr
 *
addr
)

2170 
i‰eq
 
i‰
;

2171 
fd
 = 0;

2172 
fd
 = 
	`sockë
(
AF_INET
, 
SOCK_DGRAM
, 0);

2173 
i‰
.
i‰_addr
.
ß_Ámûy
 = 
AF_INET
;

2174 
	`°∫˝y
(
i‰
.
i‰_«me
, 
i‚ame
,
IFNAMSIZ
-1);

2175 
	`io˘l
(
fd
, 
SIOCGIFADDR
, &
i‰
);

2176 
	`˛o£
(
fd
);

2177 *
addr
 = ((
sockaddr_ö
 *)&
i‰
.
i‰_addr
)->
sö_addr
;

2179 
	}
}

2181 
°©s_öfo
 
	gg_°©
[5];

2182 
	$doupd©e
(
CURL
 *
h™dÀ
, 
ty≥
, 
m⁄ô‹_t
 *
m⁄ô‹
)

2184 
buf
[1024];

2185 c⁄° *
po°_°r
;

2186 
i
;

2187 
size_t
 
c⁄n_˙t
 = 
m⁄ô‹
->
m°©s
->
m°©e
.
˛õ¡s
;

2188 
u£r_öfo_t
 *
uif
 = &
m⁄ô‹
->
m°©s
->
obje˘
.m⁄ô‹.
u£r_öfo
;

2189 
i‰eq
 
i‰
;

2191 
i
 = 0; i < 
sockscf
.
exã∫Æ
.
addrc
; i++) {

2192 
	`¢¥ötf
(
g_°©
[
i
].
i‚ame
, 20, "%s", 
sockscf
.
exã∫Æ
.
addrv
[i].
addr
.ifname);

2193 
	`gë_ˇrdöfo
(
g_°©
[
i
].
i‚ame
, &g_°©[i].
œ°_tx
, &g_°©[i].
œ°_rx
);

2194 
	`gëùaddr
(
g_°©
[
i
].
i‚ame
, &g_°©[i].
addr
);

2197 
ty≥
) {

2198 
ST_USERINFO
: {

2199 
j
;

2200 
js⁄_obje˘
 *
c⁄n_upd©e
 = 
	`js⁄_obje˘_√w_obje˘
();

2201 
js⁄_obje˘
 *
u£r_li°
 = 
	`js⁄_obje˘_√w_¨øy
();

2202 
js⁄_obje˘
 *
dù
 = 
	`js⁄_obje˘_√w_¨øy
();

2203 
	`¶og
(
LOG_ALARM
, "Æ¨m ##########:uif->u£r_˙t=%d\n", 
uif
->
u£r_˙t
);

2205 
i
 = 0; i < 
uif
->
u£r_˙t
; i++) {

2206 
js⁄_obje˘
 *
u£r_öfo
 = 
	`js⁄_obje˘_√w_obje˘
();

2207 
	`js⁄_obje˘_obje˘_add
(
u£r_öfo
, "uid", 
	`js⁄_obje˘_√w_öt
(
uif
->
Æ¨m
[
i
].
uid
));

2208 
	`js⁄_obje˘_obje˘_add
(
u£r_öfo
, "c⁄√˘_cou¡", 
	`js⁄_obje˘_√w_öt
(
uif
->
Æ¨m
[
i
].
£ss_˙t
));

2209 
	`js⁄_obje˘_obje˘_add
(
u£r_öfo
, "u∂ﬂds", 
	`js⁄_obje˘_√w_öt64
(
uif
->
Æ¨m
[
i
].
u∂ﬂds
));

2210 
	`js⁄_obje˘_obje˘_add
(
u£r_öfo
, "dow∆ﬂds", 
	`js⁄_obje˘_√w_öt64
(
uif
->
Æ¨m
[
i
].
dow∆ﬂds
));

2211 
j
 = 0; j < 10 && 
uif
->
Æ¨m
[
i
].
dù
[j]; j++) {

2212 
	`js⁄_obje˘_¨øy_add
(
dù
, 
	`js⁄_obje˘_√w_öt
(
uif
->
Æ¨m
[
i
].dù[
j
]));

2214 
ö_addr
 
ã°
;

2215 
ã°
.
s_addr
 = 
uif
->
Æ¨m
[
i
].
dù
[
j
];

2216 
	`¶og
(
LOG_ALARM
, "#### js⁄ dù j=%d ip=%s\n", 
j
, 
	`öë_¡ﬂ
(
ã°
));

2218 
	`js⁄_obje˘_obje˘_add
(
u£r_öfo
, "de°_ù", 
dù
);

2219 
	`js⁄_obje˘_¨øy_add
(
u£r_li°
, 
u£r_öfo
);

2222 
	`js⁄_obje˘_obje˘_add
(
c⁄n_upd©e
, "u£r_li°", 
u£r_li°
);

2224 
po°_°r
 = 
	`js⁄_obje˘_to_js⁄_°rög
(
c⁄n_upd©e
);

2226 
	`¶og
(
LOG_ALARM
, "po°_buf: %s\n", 
po°_°r
);

2230 
ST_CARDINFO
: {

2231 
i
 = 0;

2232 
öt64_t
 
dif_tx
 = 0;

2233 
öt64_t
 
dif_rx
 = 0;

2234 
js⁄_obje˘
 *
√tˇrd_upd©e
 = 
	`js⁄_obje˘_√w_obje˘
();

2235 
js⁄_obje˘
 *
ˇrd_li°
 = 
	`js⁄_obje˘_√w_¨øy
();

2236 
i
 = 0; i < 
sockscf
.
exã∫Æ
.
addrc
; i++) {

2237 
dif_tx
 = 
g_°©
[
i
].
œ°_tx
 - g_°©[i].
tx
;

2238 
dif_rx
 = 
g_°©
[
i
].
œ°_rx
 - g_°©[i].
rx
;

2242 
js⁄_obje˘
 *
ˇrd
 = 
	`js⁄_obje˘_√w_obje˘
();

2243 
	`js⁄_obje˘_obje˘_add
(
ˇrd
, "ù", 
	`js⁄_obje˘_√w_°rög
(
	`öë_¡ﬂ
(
g_°©
[
i
].
addr
)));

2244 i‡(
g_°©
[
i
].
tx
 =0 && g_°©[i].
rx
 == 0) {

2245 
	`js⁄_obje˘_obje˘_add
(
ˇrd
, "u∂ﬂds", 
	`js⁄_obje˘_√w_öt64
(0));

2246 
	`js⁄_obje˘_obje˘_add
(
ˇrd
, "dow∆ﬂds", 
	`js⁄_obje˘_√w_öt64
(0));

2248 
	`js⁄_obje˘_obje˘_add
(
ˇrd
, "u∂ﬂds", 
	`js⁄_obje˘_√w_öt64
(
g_°©
[
i
].
œ°_tx
 - g_°©[i].
tx
));

2249 
	`js⁄_obje˘_obje˘_add
(
ˇrd
, "dow∆ﬂds", 
	`js⁄_obje˘_√w_öt64
(
g_°©
[
i
].
œ°_rx
 - g_°©[i].
rx
));

2252 
	`js⁄_obje˘_¨øy_add
(
ˇrd_li°
, 
ˇrd
);

2253 
g_°©
[
i
].
tx
 = g_°©[i].
œ°_tx
;

2254 
g_°©
[
i
].
rx
 = g_°©[i].
œ°_rx
;

2257 
	`js⁄_obje˘_obje˘_add
(
√tˇrd_upd©e
, "c⁄√˘ed_cou¡", 
	`js⁄_obje˘_√w_öt
(
c⁄n_˙t
));

2258 
	`js⁄_obje˘_obje˘_add
(
√tˇrd_upd©e
, "ˇrd_li°", 
ˇrd_li°
);

2260 
po°_°r
 = 
	`js⁄_obje˘_to_js⁄_°rög
(
√tˇrd_upd©e
);

2261 
	`¶og
(
LOG_ALARM
, "po°buf: %s\n", 
po°_°r
);

2266 
	`¶og
(
LOG_ALARM
, "unknow¿ty≥ = %d\n", 
ty≥
);

2269 
	`cuæ_ósy_£t›t
(
h™dÀ
, 
CURLOPT_POSTFIELDS
, 
po°_°r
);

2270 
	`cuæ_ósy_£t›t
(
h™dÀ
, 
CURLOPT_WRITEFUNCTION
, &
¥o˚ss_d©a
);

2271 
	`cuæ_ósy_£t›t
(
h™dÀ
, 
CURLOPT_VERBOSE
, 0L);

2272 
	`cuæ_ósy_≥rf‹m
(
h™dÀ
);

2275 
	}
}

	@sockd/monitor_util.c

44 
	~"comm⁄.h
"

45 
	~"m⁄ô‹.h
"

47 c⁄° 
	grcsid
[] =

52 
	#LOG_DEBUG
 
LOG_NOTICE


	)

55 
	$ªcv_m⁄ô‹
(
s
, 
m⁄ô‹
)

56 c⁄° 
s
;

57 
m⁄ô‹_ã°_t
 *
m⁄ô‹
;

59 c⁄° *
fun˘i⁄
 = "recv_monitor()";

60 
iovec
 
iovecv
[1];

61 
msghdr
 
msg
;

62 
ssize_t
 
ª˚ived
;

63 
iovecc
, 
fdex≥˘
, 
fdª˚ived
;

64 
	`CMSG_AALLOC
(
cmsg
, (Ë* 
FDPASS_MAX
);

66 
	`bzîo
(
iovecv
, (iovecv));

67 
iovecc
 = 0;

69 
iovecv
[
iovecc
].
iov_ba£
 = 
m⁄ô‹
;

70 
iovecv
[
iovecc
].
iov_Àn
 = (*
m⁄ô‹
);

71 ++
iovecc
;

73 
	`bzîo
(&
msg
, (msg));

74 
msg
.
msg_iov
 = 
iovecv
;

75 
msg
.
msg_iovÀn
 = 
iovecc
;

76 
msg
.
msg_«me
 = 
NULL
;

77 
msg
.
msg_«mñí
 = 0;

80 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

82 i‡((
ª˚ived
 = 
	`ªcvmsgn
(
s
, &
msg
, 0)Ë< (
ssize_t
)(*
m⁄ô‹
)) {

83 i‡(
ª˚ived
 =-1 && 
î∫o
 =
EAGAIN
)

86 
	`¶og
(
LOG_DEBUG
,

89 
fun˘i⁄
,

90 
s
,

91 ()
ª˚ived
,

92 ()((*
m⁄ô‹
)),

93 
	`°ªº‹
(
î∫o
));

98 i‡(
	`socks_msgha£º‹s
(
fun˘i⁄
, &
msg
))

101 
fdex≥˘
 = 2;

102 i‡(!
	`CMSG_RCPTLEN_ISOK
(
msg
, (Ë* 
fdex≥˘
)) {

103 
	`sw¨nx
("%s:Ñeceived control message hasÅhe invalidÜen of %d",

104 
fun˘i⁄
, ()
	`CMSG_TOTLEN
(
msg
));

110 
	`SASSERTX
(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET
);

111 
	`SASSERTX
(
cmsg
->
cmsg_ty≥
 =
SCM_RIGHTS
);

117 
fdª˚ived
 = 0;

119 
	`CMSG_GETOBJECT
(
m⁄ô‹
->
öã∫Æ
.
s
,

120 
cmsg
,

121 (
m⁄ô‹
->
öã∫Æ
.
s
Ë* 
fdª˚ived
++);

123 
	`CMSG_GETOBJECT
(
m⁄ô‹
->
exã∫Æ
.
s
,

124 
cmsg
,

125 (
m⁄ô‹
->
exã∫Æ
.
s
Ë* 
fdª˚ived
++);

127 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
m⁄ô‹
->
ts_ª˚ived
);

129 
	`sockd_check_ù˛©ícy
("monitorÑeceived",

130 &
m⁄ô‹
->
ts_£¡
,

131 &
m⁄ô‹
->
ts_ª˚ived
,

132 &
m⁄ô‹
->
ts_ª˚ived
);

135 i‡(
sockscf
.
›ti⁄
.
debug
 || 1) {

136 
§c
[
MAXSOCKADDRSTRING
 * 3], 
d°
[(src)];

138 
	`¶og
(
LOG_DEBUG
,

141 
fun˘i⁄
,

142 
fdª˚ived
,

143 
m⁄ô‹
->
öã∫Æ
.
s
,

144 
	`sockë2°rög
(
m⁄ô‹
->
öã∫Æ
.
s
, 
§c
, (src)),

145 
m⁄ô‹
->
exã∫Æ
.
s
,

146 
	`sockë2°rög
(
m⁄ô‹
->
exã∫Æ
.
s
, 
d°
, (dst)));

150 
	}
}

153 
	$£nd_m⁄ô‹
(
s
, 
m⁄ô‹
)

154 c⁄° 
s
;

155 c⁄° 
m⁄ô‹_ã°_t
 *
m⁄ô‹
;

157 c⁄° *
fun˘i⁄
 = "send_monitor()";

158 
iovec
 
iov
[1];

159 
msghdr
 
msg
;

160 
timevÆ
 
äow
;

161 
ssize_t
 
rc
, 
Àngth
;

162 
ioc
, 
fdto£nd
;

163 
	`CMSG_AALLOC
(
cmsg
, (Ë* 
FDPASS_MAX
);

165 
	`bzîo
(
iov
, (iov));

166 
Àngth
 = 0;

167 
ioc
 = 0;

169 
iov
[
ioc
].
iov_ba£
 = 
m⁄ô‹
;

170 
iov
[
ioc
].
iov_Àn
 = (*
m⁄ô‹
);

171 
Àngth
 +
iov
[
ioc
].
iov_Àn
;

172 ++
ioc
;

174 
fdto£nd
 = 0;

176 
	`CMSG_ADDOBJECT
(
m⁄ô‹
->
öã∫Æ
.
s
,

177 
cmsg
,

178 (
m⁄ô‹
->
öã∫Æ
.
s
Ë* 
fdto£nd
++);

180 
	`CMSG_ADDOBJECT
(
m⁄ô‹
->
exã∫Æ
.
s
,

181 
cmsg
,

182 (
m⁄ô‹
->
exã∫Æ
.
s
Ë* 
fdto£nd
++);

184 
	`bzîo
(&
msg
, (msg));

185 
msg
.
msg_iov
 = 
iov
;

186 
msg
.
msg_iovÀn
 = 
ioc
;

187 
msg
.
msg_«me
 = 
NULL
;

189 
	`CMSG_SETHDR_SEND
(
msg
, 
cmsg
, (Ë* 
fdto£nd
);

191 i‡(
sockscf
.
›ti⁄
.
debug
 || 1) {

192 
ibuf
[
MAXSOCKADDRSTRING
 * 3], 
ebuf
[(ibuf)];

194 
	`¶og
(
LOG_DEBUG
,

197 
fun˘i⁄
,

198 
fdto£nd
,

199 
s
,

200 
m⁄ô‹
->
öã∫Æ
.
s
,

201 
	`sockë2°rög
(
m⁄ô‹
->
öã∫Æ
.
s
, 
ibuf
, (ibuf)),

202 
m⁄ô‹
->
exã∫Æ
.
s
,

203 
	`sockë2°rög
(
m⁄ô‹
->
exã∫Æ
.
s
, 
ebuf
, (ebuf)));

206 i‡((
rc
 = 
	`£ndmsgn
(
s
, &
msg
, 0, 0)Ë!
Àngth
) {

207 
	`¶og
(
LOG_DEBUG
,

209 
fun˘i⁄
, ()
rc
, ()
Àngth
, 
	`°ªº‹
(
î∫o
));

214 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

215 
sockscf
.
°©e
.
m⁄ô‹_£¡
 = 
äow
.
tv_£c
;

218 
	}
}

220 c⁄° 
m⁄ô‹_t
 *

221 
	$shmid2m⁄ô‹
(
shmid
)

222 c⁄° 
shmid
;

224 c⁄° *
fun˘i⁄
 = "shmid2monitor()";

225 
m⁄ô‹_t
 *
m
;

227 
m
 = 
sockscf
.
m⁄ô‹
; m !
NULL
; m = m->
√xt
)

228 i‡(
m
->
m°©s_shmid
 =
shmid
) {

229 
	`¶og
(
LOG_DEBUG
, "%s: monitor #%lu has shmid %lu",

230 
fun˘i⁄
, ()
m
->
numbî
, ()
shmid
);

232  
m
;

234  
NULL
;

235 
	}
}

	@sockd/mother_util.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

57 
sigãrm
(
sig
, 
sigöfo_t
 *
si
, *
sc
);

58 
sigöfo
(
sig
, 
sigöfo_t
 *
si
, *
sc
);

59 
sigchld
(
sig
, 
sigöfo_t
 *
si
, *
sc
);

60 
sigÆrm
(
sig
, 
sigöfo_t
 *
si
, *
sc
);

61 
sighup
(
sig
, 
sigöfo_t
 *
si
, *
sc
);

63 
u√x≥˘eddóth
();

71 
	$mŸhî_¥ec⁄figlﬂd
()

74 
	}
}

77 
	$mŸhî_po°c⁄figlﬂd
()

79 c⁄° *
fun˘i⁄
 = "mother_postconfigload()";

81 i‡(
	`pidismaömŸhî
(
sockscf
.
°©e
.
pid
))

82 
	`shmem_idupd©e
(&
sockscf
);

83 
	}
}

86 
	$mŸhî_ív£tup
(
¨gc
, 
¨gv
)

87 
¨gc
;

88 *
¨gv
[];

90 c⁄° *
fun˘i⁄
 = "mother_envsetup()";

91 c⁄° 
exôsig«lv
[] = {

92 
SIGINT
, 
SIGQUIT
, 
SIGBUS
, 
SIGSEGV
, 
SIGTERM
, 
SIGILL
, 
SIGFPE


93 #ifde‡
SIGSYS


94 , 
SIGSYS


97 c⁄° 
size_t
 
pùëomŸhîfds
 = 2;

98 c⁄° 
size_t
 
exôsig«lc
 = 
	`ELEMENTS
(
exôsig«lv
);

99 c⁄° 
ign‹esig«lv
[] = {

100 
SIGPIPE


102 c⁄° 
size_t
 
ign‹esig«lc
 = 
	`ELEMENTS
(
ign‹esig«lv
);

103 
siga˘i⁄
 
siga˘
;

104 
æimô
Ñlimit;

105 #ifde‡
RLIMIT_NPROC


106 
æimô
 
max¥oc
;

108 
æim_t
 
max›ífd
, 
möfd_√g
, 
möfd_ªq
, 
möfd_io
, 
möfd
;

109 
size_t
 
i
, 
fdª£rved
;

111 
fdª£rved
 = 0;

112 
fdª£rved
 < 
	`ELEMENTS
(
sockscf
.
°©e
.
ª£rvedfdv
);

113 ++
fdª£rved
)

114 i‡((
sockscf
.
°©e
.
ª£rvedfdv
[
fdª£rved
] = 
	`makedummyfd
(0, 0)) == -1)

115 
	`£º
("%s: couldÇotÑeserve fd #%lu forÜater use",

116 
fun˘i⁄
, ()
fdª£rved
 + 1);

124 
fdª£rved
 +
sockscf
.
log
.
ty≥
 & 
LOGTYPE_SYSLOG
 ? 0 : 1;

130 
fdª£rved
 += 1

134 
i
 = 0, 
max›ífd
 = 
	`gëmaxofûes
(
so·limô
); (
æim_t
)i < maxopenfd; ++i){

135 
size_t
 
j
;

137 i‡(
	`des¸ùt‹i§e£rved
(()
i
)) {

138 ++
fdª£rved
;

143 
j
 = 0; j < 
sockscf
.
öã∫Æ
.
addrc
; ++j) {

144 i‡(()
i
 =
sockscf
.
öã∫Æ
.
addrv
[
j
].
s
)

148 i‡(
j
 < 
sockscf
.
öã∫Æ
.
addrc
)

151 
	`˛o£
(()
i
);

154 
î∫o
 = 0;

155 
	`√w¥ocöô
();

163 
möfd_√g
 = (
SOCKD_NEGOTIATEMAX
 * 1Ë+ 
pùëomŸhîfds
 + 
fdª£rved
;

165 
möfd_ªq
 = (
SOCKD_REQUESTMAX
 * 
FDPASS_MAX
Ë+ 
pùëomŸhîfds
 + 
fdª£rved
;

167 
möfd_io
 = (
SOCKD_IOMAX
 * 
FDPASS_MAX
Ë+ 
pùëomŸhîfds
 + 
fdª£rved
;

170 
möfd_io
 +
SOCKD_IOMAX
 * (1 + 1);

172 #i‡
BAREFOOTD


173 
möfd_io
 +
	`MIN
(10, 
MIN_UDPCLIENTS
);

176 
	`¶og
(
LOG_DEBUG
,

178 
fun˘i⁄
,

179 ()
möfd_√g
,

180 ()
möfd_ªq
,

181 ()
möfd_io
);

188 
sockscf
.
°©e
.
max›ífûes
 = 
	`gëmaxofûes
(
h¨dlimô
);

190 
	`¶og
(
LOG_DEBUG
,

192 ()
sockscf
.
°©e
.
max›ífûes
,

193 ()
	`gëmaxofûes
(
so·limô
));

195 i‡(
sockscf
.
°©e
.
max›ífûes
 =
RLIM_INFINITY
) {

196 
sockscf
.
°©e
.
max›ífûes
 = 
	`gëmaxofûes
(
so·limô
);

197 
	`SASSERTX
(
sockscf
.
°©e
.
max›ífûes
 !
RLIM_INFINITY
);

200 
möfd
 = 
	`MAX
(
möfd_√g
, MAX(
möfd_ªq
, 
möfd_io
));

202 i‡(
sockscf
.
°©e
.
max›ífûes
 < 
möfd
) {

203 
	`¶og
(
LOG_INFO
,

206 ()
sockscf
.
°©e
.
max›ífûes
,

207 ()
möfd
);

209 
sockscf
.
°©e
.
max›ífûes
 = 
möfd
;

212 
æimô
.
æim_cur
 =Ñlimô.
æim_max
 = 
sockscf
.
°©e
.
max›ífûes
;

214 i‡(
	`£ålimô
(
RLIMIT_OFILE
, &
æimô
) == 0)

215 
	`¶og
(
LOG_DEBUG
, "maxÇumber of file descriptors isÇow %lu",

216 ()
sockscf
.
°©e
.
max›ífûes
);

218 c⁄° *
¥obÀm
;

220 
sockscf
.
°©e
.
max›ífûes
 = 
	`gëmaxofûes
(
h¨dlimô
);

222 i‡(
sockscf
.
°©e
.
max›ífûes
 < 
möfd_√g
)

223 
¥obÀm
 = "SOCKD_NEGOTIATEMAX";

224 i‡(
sockscf
.
°©e
.
max›ífûes
 < 
möfd_ªq
)

225 
¥obÀm
 = "SOCKD_REQUESTMAX";

226 i‡(
sockscf
.
°©e
.
max›ífûes
 < 
möfd_io
)

227 
¥obÀm
 = "SOCKD_IOMAX";

229 
	`SERRX
(
sockscf
.
°©e
.
max›ífûes
);

231 
	`£ºx
("%s: failedÅo increaseÅhe maxÇumber of open file descriptors "

236 
fun˘i⁄
,

237 ()
æimô
.
æim_max
,

238 
	`°ªº‹
(
î∫o
),

239 
¥obÀm
,

240 
PRODUCT
);

243 #ifde‡
RLIMIT_NPROC


244 i‡(
	`gëæimô
(
RLIMIT_NPROC
, &
max¥oc
) != 0)

245 
	`sw¨n
("getrlimit(RLIMIT_NPROC) failed");

247 
max¥oc
.
æim_cur
 = max¥oc.
æim_max
;

249 i‡(
	`£ålimô
(
RLIMIT_NPROC
, &
max¥oc
) != 0)

250 
	`sw¨n
("setrlimit(RLIMIT_NPROC, { %lu, %lu }) failed",

251 ()
æimô
.
æim_cur
,

252 ()
æimô
.
æim_max
);

261 
	`bzîo
(&
siga˘
, (sigact));

262 
siga˘
.
ß_Êags
 = 
SA_RESTART
 | 
SA_NOCLDSTOP
 | 
SA_SIGINFO
;

264 
siga˘
.
ß_siga˘i⁄
 = 
sigöfo
;

265 #i‡
HAVE_SIGNAL_SIGINFO


266 i‡(
	`siga˘i⁄
(
SIGINFO
, &
siga˘
, 
NULL
) != 0)

267 
	`£º
("sigaction(SIGINFO)");

274 i‡(
	`siga˘i⁄
(
SIGUSR1
, &
siga˘
, 
NULL
) != 0)

275 
	`£º
("sigaction(SIGUSR1)");

277 
siga˘
.
ß_siga˘i⁄
 = 
sighup
;

278 i‡(
	`siga˘i⁄
(
SIGHUP
, &
siga˘
, 
NULL
) != 0)

279 
	`£º
("sigaction(SIGHUP)");

281 
siga˘
.
ß_siga˘i⁄
 = 
sigchld
;

282 i‡(
	`siga˘i⁄
(
SIGCHLD
, &
siga˘
, 
NULL
) != 0)

283 
	`£º
("sigaction(SIGCHLD)");

285 
siga˘
.
ß_siga˘i⁄
 = 
sigãrm
;

286 
i
 = 0; (
size_t
)ò< 
exôsig«lc
; ++i)

287 i‡(
	`siga˘i⁄
(
exôsig«lv
[
i
], &
siga˘
, 
NULL
) != 0)

288 
	`£º
("siga˘i⁄(%d)", 
exôsig«lv
[
i
]);

290 
siga˘
.
ß_h™dÀr
 = 
SIG_IGN
;

291 
i
 = 0; (
size_t
)ò< 
ign‹esig«lc
; ++i)

292 i‡(
	`siga˘i⁄
(
ign‹esig«lv
[
i
], &
siga˘
, 
NULL
) != 0)

293 
	`£º
("siga˘i⁄(%d)", 
ign‹esig«lv
[
i
]);

295 
siga˘
.
ß_Êags
 = 
SA_SIGINFO
;

296 
siga˘
.
ß_siga˘i⁄
 = 
sigÆrm
;

297 i‡(
	`siga˘i⁄
(
SIGALRM
, &
siga˘
, 
NULL
) != 0)

298 
	`£º
("sigaction(SIGALRM)");

300 i‡(
sockscf
.
›ti⁄
.
d´m⁄
) {

301 i‡(
	`d´m⁄
(1, 0) != 0)

302 
	`£º
("daemon()");

310 
	`˛o£
(
STDIN_FILENO
);

311 
	`√w¥ocöô
();

313 *
sockscf
.
°©e
.
mŸhîpidv
 = 
	`gëpid
();

316 i‡(
HAVE_ENABLED_PIDFILE
) {

317 c⁄° 
mode_t
 
›ímode
 = 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IROTH
;

318 c⁄° 
›íÊags
 = 
O_WRONLY
 | 
O_CREAT
;

319 
FILE
 *
Â
;

320 
fd
;

322 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

323 i‡((
fd
 = 
	`›í
(
sockscf
.
›ti⁄
.
pidfûe
, 
›íÊags
, 
›ímode
)) == -1) {

324 
	`sw¨n
("couldÇŸ o≥¿pidfûê%†f‹ wrôög", 
sockscf
.
›ti⁄
.
pidfûe
);

325 
î∫o
 = 0;

327 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

329 i‡(
fd
 != -1) {

330 
Â
 = 
	`fd›í
(
fd
, "w");

332 i‡(
Â
 !
NULL
) {

333 i‡(
	`Ârötf
(
Â
, "%lu\n", ()
sockscf
.
°©e
.
pid
Ë=
EOF
)

334 
	`sw¨n
("failed writingÖidÅoÖidfile %s",

335 
sockscf
.
›ti⁄
.
pidfûe
);

337 
sockscf
.
›ti⁄
.
pidfûewrôãn
 = 1;

339 
	`f˛o£
(
Â
);

342 
	`˛o£
(
fd
);

347 
	`íabÀ_chûd¸óã
();

349 
	`‰ìdes¸ùt‹s
(
NULL
, &
sockscf
.
°©e
.
highe°fdöu£
);

350 
	}
}

353 
	$mŸhî_gëlimôöfo
()

355 c⁄° *
fun˘i⁄
 = "mother_getlimitinfo()";

356 
buf
[2048];

357 c⁄° 
fds_≥r_¥oc
 = 2;

358 c⁄° *
limôî
, *
¥efix
 = "max clients calculation willÇot be done";

359 
æimô
 
maxfd
, 
max¥oc
;

360 
max¥oc°r
[64], 
maxfd°r
[64];

361 
√gc_¥oc
, 
√gc_fd
, 
ªqc_¥oc
, 
ªqc_fd
, 
ioc_¥oc
, 
ioc_fd
,

362 
√gc_limô
, 
ªqc_limô
, 
ioc_limô
,

363 
¥oc_‰ì
, 
¥oc_u£d
, 
¥ocs
, 
fds_‰ì
;

365 i‡(
	`gëæimô
(
RLIMIT_NOFILE
, &
maxfd
) != 0) {

366 
	`sw¨n
("%s: gëæimô(RLIMIT_NOFILEËÁûed", 
fun˘i⁄
);

370 #ifde‡
RLIMIT_NPROC


371 i‡(
	`gëæimô
(
RLIMIT_NPROC
, &
max¥oc
) != 0) {

372 
	`sw¨n
("%s: %s: gëæimô(RLIMIT_NPROCËÁûed", 
fun˘i⁄
, 
¥efix
);

376 i‡((
max¥oc
.
æim_cur
 = (
æim_t
)
	`sysc⁄f
(
_SC_CHILD_MAX
)) == (rlim_t)-1) {

377 
	`sw¨n
("%s: %s: sysc⁄f(_SC_CHILD_MAXËÁûed", 
fun˘i⁄
, 
¥efix
);

381 
max¥oc
.
æim_max
 = max¥oc.
æim_cur
;

384 i‡(
maxfd
.
æim_cur
 =
RLIM_INFINITY


385 && 
max¥oc
.
æim_cur
 =
RLIM_INFINITY
)

388 
¥oc_u£d
 = 
sockscf
.
›ti⁄
.
£rvîc


389 + 
	`chûdcheck
(-
PROC_NEGOTIATE
Ë/ 
SOCKD_NEGOTIATEMAX


390 + 
	`chûdcheck
(-
PROC_REQUEST
Ë/ 
SOCKD_REQUESTMAX


391 + 
	`chûdcheck
(-
PROC_IO
Ë/ 
SOCKD_IOMAX
;

392 
¥oc_‰ì
 = 
max¥oc
.
æim_cur
 - 
¥oc_u£d
;

394 i‡(
max¥oc
.
æim_cur
 =
RLIM_INFINITY
)

395 
	`¢¥ötf
(
max¥oc°r
, (maxprocstr), "noÜimit");

397 
	`¢¥ötf
(
max¥oc°r
, (maxprocstr),

399 ()
max¥oc
.
æim_cur
, 
¥oc_‰ì
);

401 
fds_‰ì
 = 
	`‰ìdes¸ùt‹s
(
NULL
, NULLË- 
FDPASS_MAX
;

402 i‡(
maxfd
.
æim_cur
 =
RLIM_INFINITY
)

403 
	`¢¥ötf
(
maxfd°r
, (maxfdstr), "noÜimit");

405 
	`¢¥ötf
(
maxfd°r
, (maxfdstr),

406 "%lu (%lu fªe)", ()
maxfd
.
æim_cur
, 
fds_‰ì
);

421 
√gc_¥oc
 = 
¥oc_‰ì
 * 
SOCKD_NEGOTIATEMAX
;

422 
ªqc_¥oc
 = 
¥oc_‰ì
 * 
SOCKD_REQUESTMAX
;

423 
ioc_¥oc
 = 
¥oc_‰ì
 * 
SOCKD_IOMAX
;

434 
¥ocs
 = 
fds_‰ì
 / 
fds_≥r_¥oc
;

435 
√gc_fd
 = 
	`MIN
(((
fds_‰ì
 - 
fds_≥r_¥oc
Ë/ 1), 
SOCKD_NEGOTIATEMAX
)

436 * 
¥ocs
;

437 
ªqc_fd
 = 
	`MIN
(((
fds_‰ì
 - 
fds_≥r_¥oc
Ë/ 
FDPASS_MAX
), 
SOCKD_REQUESTMAX
)

438 * 
¥ocs
;

439 
ioc_fd
 = 
	`MIN
(((
fds_‰ì
 - 
fds_≥r_¥oc
Ë/ 
FDPASS_MAX
), 
SOCKD_IOMAX
)

440 * 
¥ocs
;

446 i‡(
√gc_¥oc
 < 
√gc_fd


447 || 
ªqc_¥oc
 < 
ªqc_fd


448 || 
ioc_¥oc
 < 
ioc_fd
) {

449 
limôî
 = "process";

451 
√gc_limô
 = 
√gc_¥oc
;

452 
ªqc_limô
 = 
ªqc_¥oc
;

453 
ioc_limô
 = 
ioc_¥oc
;

456 
limôî
 = "open file";

458 
√gc_limô
 = 
√gc_fd
;

459 
ªqc_limô
 = 
ªqc_fd
;

460 
ioc_limô
 = 
ioc_fd
;

463 
	`¢¥ötf
(
buf
, (buf), "maxÜimits:Örocesses: %s, files: %s, "

466 
max¥oc°r
,

467 
maxfd°r
,

468 
	`chûdty≥2°rög
(
PROC_NEGOTIATE
),

469 
√gc_limô
,

470 
	`chûdty≥2°rög
(
PROC_REQUEST
),

471 
ªqc_limô
,

472 
	`chûdty≥2°rög
(
PROC_IO
),

473 
ioc_limô
,

474 
limôî
);

476  
buf
;

477 
	}
}

480 
	$log_rußge
(
chûdty≥
, 
pid
, 
rußge
)

481 c⁄° 
chûdty≥
;

482 c⁄° 
pid_t
 
pid
;

483 c⁄° 
rußge
 *rusage;

485 
¥efix
[256];

487 i‡(
pid
 == 0)

488 
	`¢¥ötf
(
¥efix
, (prefix),

490 
	`chûdty≥2°rög
(
chûdty≥
));

492 
	`¢¥ötf
(
¥efix
, (prefix),

494 
	`chûdty≥2°rög
(
chûdty≥
),

495 ()
pid
);

498 
	`¶og
(
LOG_DEBUG
,

512 
¥efix
,

513 ()
rußge
->
ru_utime
.
tv_£c
, (Ïußge->ru_utime.
tv_u£c
,

514 ()
rußge
->
ru_°ime
.
tv_£c
, (Ïußge->ru_°ime.
tv_u£c
,

515 
rußge
->
ru_möÊt
,

516 
rußge
->
ru_majÊt
,

517 
rußge
->
ru_nsw≠
,

518 
rußge
->
ru_öblock
,

519 
rußge
->
ru_oublock
,

520 
rußge
->
ru_msg¢d
,

521 
rußge
->
ru_msgrcv
,

522 
rußge
->
ru_nsig«ls
,

523 
rußge
->
ru_nvcsw
,

524 
rußge
->
ru_nivcsw
);

525 
	}
}

530 
	$u√x≥˘eddóth
()

532 c⁄° *
fun˘i⁄
 = "unexpecteddeath()";

533 c⁄° 
size_t
 
maxdóths
 = 10;

536 ++
sockscf
.
°©e
.
u√x≥˘ed_dóths
;

537 
	`time_m⁄Ÿ⁄ic
(&
sockscf
.
°©e
.
œ°dóth_time
);

539 i‡(
sockscf
.
°©e
.
u√x≥˘ed_dóths
 == 1)

540 
sockscf
.
°©e
.
fú°dóth_time
 = sockscf.°©e.
œ°dóth_time
;

542 i‡(
sockscf
.
°©e
.
u√x≥˘ed_dóths
 < 
maxdóths
)

545 i‡(
sockscf
.
°©e
.
u√x≥˘ed_dóths
 =
maxdóths
) {

546 
	`¶og
(
LOG_ERR
,

550 
fun˘i⁄
,

551 ()
sockscf
.
°©e
.
u√x≥˘ed_dóths
,

552 ()
	`socks_dif·ime
(
sockscf
.
°©e
.
œ°dóth_time
,

553 
sockscf
.
°©e
.
fú°dóth_time
),

554 ()
MAX_ADDCHILD_SECONDS
);

556 
	`dißbÀ_chûd¸óã
(0, "largeámount ofÖrocesses suddenly died");

557 
	`Æ¨m
(
MAX_ADDCHILD_SECONDS
);

559 
	}
}

563 
	$sigÆrm
(
sig
, 
si
, 
sc
)

564 
sig
;

565 
sigöfo_t
 *
si
;

566 *
sc
;

568 c⁄° *
fun˘i⁄
 = "sigalrm()";

569 c⁄° 
î∫o_s
 = 
î∫o
;

571 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

573 
	`íabÀ_chûd¸óã
();

575 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

576 
	}
}

580 
	$sigãrm
(
sig
, 
si
, 
sc
)

581 
sig
;

582 
sigöfo_t
 *
si
;

583 *
sc
;

585 c⁄° *
fun˘i⁄
 = "sigterm()";

586 c⁄° 
î∫o_s
 = 
î∫o
;

588 i‡(
sig
 > 0) {

589 i‡(
	`SIGNALISOK
(
sig
))

590 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

597 c⁄° *
msgv
[] = { 
fun˘i⁄
,

599 
	`…ﬂ
(
sig
, 
NULL
, 0),

600 
NULL


602 
sig£t_t
 
˛órmask
;

604 
sockscf
.
°©e
.
ösig«l
 = 
sig
;

606 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

608 #i‡
HAVE_LIVEDEBUG


609 i‡(!
sockscf
.
›ti⁄
.
debug
)

610 
	`socks_Êushrb
();

618 i‡(
	`sig«l
(
sig
, 
SIG_DFL
Ë=
SIG_ERR
) {

619 c⁄° *
msgv
[]

620 { 
fun˘i⁄
,

622 
	`…ﬂ
(
sig
, 
NULL
, 0),

623 
NULL


626 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

629 
	`bzîo
(&
˛órmask
, (clearmask));

630 ()
	`sig¥ocmask
(
SIG_SETMASK
, &
˛órmask
, 
NULL
);

631 
	`øi£
(
sig
);

637 
sig
 = -sig;

639 
	`¶og
(
LOG_INFO
, "%s:Éxôög o¿sig«»%d", 
fun˘i⁄
, 
sig
);

641 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

643 
	`sockdexô
(
EXIT_SUCCESS
);

644 
	}
}

648 
	$sigöfo
(
sig
, 
si
, 
sc
)

649 
sig
;

650 
sigöfo_t
 *
si
;

651 *
sc
;

653 c⁄° *
fun˘i⁄
 = "siginfo()";

654 c⁄° 
î∫o_s
 = 
î∫o
;

655 
days
, 
hours
, 
möuãs
, 
£c⁄ds
,

656 
‰ì_√gc
, 
‰ì_ªqc
, 
‰ì_ioc
,

657 
max_√gc
, 
max_ªqc
, 
max_ioc
;

658 
size_t
 
˛õ¡s
;

660 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

662 
˛õ¡s
 = 0;

663 
˛õ¡s
 +(
max_√gc
 = 
	`chûdcheck
(-
PROC_NEGOTIATE
));

664 
˛õ¡s
 +(
max_ªqc
 = 
	`chûdcheck
(-
PROC_REQUEST
));

665 
˛õ¡s
 +(
max_ioc
 = 
	`chûdcheck
(-
PROC_IO
));

667 
˛õ¡s
 -(
‰ì_√gc
 = 
	`chûdcheck
(
PROC_NEGOTIATE
));

668 
˛õ¡s
 -(
‰ì_ªqc
 = 
	`chûdcheck
(
PROC_REQUEST
));

669 
˛õ¡s
 -(
‰ì_ioc
 = 
	`chûdcheck
(
PROC_IO
));

671 
£c⁄ds
 = ()
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(
NULL
),

672 
sockscf
.
°©
.
boŸ
);

673 
	`£c⁄ds2days
(&
£c⁄ds
, &
days
, &
hours
, &
möuãs
);

675 
	`¶og
(
LOG_INFO
, "%s v%s up %lu day%s, %lu:%.2lu,á: %lu, h: %lu c: %lu",

676 
PRODUCT
,

677 
VERSION
,

678 
days
,

679 
days
 == 1 ? "" : "s",

680 
hours
,

681 
möuãs
,

682 ()
sockscf
.
°©
.
ac˚±ed
,

683 ()
sockscf
.
°©
.
√gŸüã
.
£ndt
,

684 ()
˛õ¡s
);

686 
	`¶og
(
LOG_INFO
, "negotiators (%lu):á: %lu, h: %lu, c: %lu, f: %lu",

687 
max_√gc
 / 
SOCKD_NEGOTIATEMAX
,

688 ()
sockscf
.
°©
.
√gŸüã
.
£ndt
,

689 ()
sockscf
.
°©
.
√gŸüã
.
ª˚ived
,

690 
max_√gc
 - 
‰ì_√gc
,

691 
‰ì_√gc
);

693 
	`¶og
(
LOG_INFO
, "requesters (%lu):á: %lu, h: %lu, c: %lu, f: %lu",

694 
max_ªqc
 / 
SOCKD_REQUESTMAX
,

695 ()
sockscf
.
°©
.
ªque°
.
£ndt
,

696 ()
sockscf
.
°©
.
ªque°
.
ª˚ived
,

697 
max_ªqc
 - 
‰ì_ªqc
,

698 
‰ì_ªqc
);

700 
	`¶og
(
LOG_INFO
, "iorelayers (%lu):á: %lu, h: %lu, c: %lu, f: %lu",

701 
max_ioc
 / 
SOCKD_IOMAX
,

702 ()
sockscf
.
°©
.
io
.
£ndt
,

703 ()
sockscf
.
°©
.
io
.
ª˚ived
,

704 
max_ioc
 - 
‰ì_ioc
,

705 
‰ì_ioc
);

707 
	`¶og
(
LOG_INFO
, "%s", 
	`mŸhî_gëlimôöfo
());

730 #ifde‡
SIGINFO


731 i‡(
sig
 =
SIGINFO
)

732 
sig
 = 
SIGUSR1
;

735 i‡(
	`pidismaömŸhî
(
sockscf
.
°©e
.
pid
))

736 
	`sig£rvîbrﬂdˇ°
(
sig
);

738 
	`sigchûdbrﬂdˇ°
(
sig
);

740 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

741 
	}
}

745 
	$sighup
(
sig
, 
si
, 
sc
)

746 
sig
;

747 
sigöfo_t
 *
si
;

748 *
sc
;

750 c⁄° *
fun˘i⁄
 = "sighup()";

751 c⁄° 
î∫o_s
 = 
î∫o
;

752 
c⁄fig
 *
√wshmemc⁄fig
;

753 
öã∫Æaddªss_t
 
ﬁdöã∫Æ
;

754 
size_t
 
i
, 
poöãrsize
;

755 
rc
;

757 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

759 
	`¶og
(
LOG_INFO
, "SIGHUP [:Ñeloading config");

798 
ﬁdöã∫Æ
.
addrc
 = 
sockscf
.
öã∫Æ
.addrc;

799 i‡((
ﬁdöã∫Æ
.
addrv
 = 
	`mÆloc
((*oldinternal.addrv)

800 * 
ﬁdöã∫Æ
.
addrc
)Ë=
NULL
) {

801 
	`sw¨n
("%s: failedÅoállocate memory for saving state before "

803 
fun˘i⁄
);

808 
i
 = 0; i < 
ﬁdöã∫Æ
.
addrc
; ++i)

809 
ﬁdöã∫Æ
.
addrv
[
i
] = 
sockscf
.
öã∫Æ
.addrv[i];

811 
	`ª£tc⁄fig
(&
sockscf
, 0);

812 
	`gíîicöô
();

813 
	`checkc⁄fig
();

815 
	`showc⁄fig
(&
sockscf
);

817 #i‡
DIAGNOSTIC


818 i‡(
sockscf
.
m⁄ô‹
 !
NULL
)

819 
	`SASSERTX
(
sockscf
.
m⁄ô‹
->
m°©s
 =
NULL
);

821 i‡(
sockscf
.
¸uÀ
 !
NULL
)

822 
	`SASSERTX
(!
	`SHMID_ISATTACHED
(
sockscf
.
¸uÀ
));

824 i‡(
sockscf
.
§uÀ
 !
NULL
)

825 
	`SASSERTX
(!
	`SHMID_ISATTACHED
(
sockscf
.
§uÀ
));

828 
i
 = 0; i < 
ﬁdöã∫Æ
.
addrc
; ++i) {

829 
ssize_t
 
p
;

831 
p
 = 
	`addrödex_⁄_li°íli°
(
sockscf
.
öã∫Æ
.
addrc
,

832 
sockscf
.
öã∫Æ
.
addrv
,

833 &
ﬁdöã∫Æ
.
addrv
[
i
].
addr
,

834 
ﬁdöã∫Æ
.
addrv
[
i
].
¥Ÿocﬁ
);

836 i‡(
p
 >= 0) {

840 
sockscf
.
öã∫Æ
.
addrv
[
p
].
s
 = 
ﬁdöã∫Æ
.addrv[
i
].s;

848 i‡(
ﬁdöã∫Æ
.
addrv
[
i
].
¥Ÿocﬁ
 =
SOCKS_TCP
) {

849 
	`˛o£
(
ﬁdöã∫Æ
.
addrv
[
i
].
s
);

853 #i‡
BAREFOOTD


855 
	`¶og
(
LOG_DEBUG
, "%s: child shouldÑemove udp session for %s",

856 
fun˘i⁄
,

857 
	`sockaddr2°rög
(&
ﬁdöã∫Æ
.
addrv
[
i
].
addr
, 
NULL
, 0));

861 #i‡
BAREFOOTD


862 i‡(!
	`ALL_UDP_BOUNCED
()) {

869 
ruÀ_t
 *
ruÀ
;

874 
sockscf
.
°©e
.
Æludpboun˚d
 = 1;

876 
ruÀ
 = 
sockscf
.
¸uÀ
;ÑuÀ !
NULL
;ÑuÀ =ÑuÀ->
√xt
) {

877 
socksho°_t
 
ho°toböd
;

878 
sockaddr_°‹age
 
addπoböd
;

880 i‡(!
ruÀ
->
°©e
.
¥Ÿocﬁ
.
udp
)

883 
ruÀ
->
d°
.
©y≥
) {

884 
SOCKS_ADDR_IPV4
:

885 
SOCKS_ADDR_IPV6
:

886 
	`ruÀaddr2socksho°
(&
ruÀ
->
d°
, &
ho°toböd
, 
SOCKS_UDP
);

887 
	`socksho°2sockaddr
(&
ho°toböd
, &
addπoböd
);

889 i‡(
	`addrödex_⁄_li°íli°
(
ﬁdöã∫Æ
.
addrc
,

890 
ﬁdöã∫Æ
.
addrv
,

891 &
addπoböd
,

892 
SOCKS_UDP
) != -1) {

893 
	`¶og
(
LOG_DEBUG
,

896 
fun˘i⁄
,

897 
	`sockaddr2°rög
(&
addπoböd
, 
NULL
, 0),

898 ()
ruÀ
->
numbî
);

900 
ruÀ
->
boun˚d
 = 1;

904 
SOCKS_ADDR_DOMAIN
: {

905 
size_t
 
i
;

907 
i
 = 0;

908 
	`ho°«me2sockaddr
(
ruÀ
->
d°
.
addr
.
domaö
,

909 
i
++,

910 &
addπoböd
Ë!
NULL
) {

911 i‡(
	`addrödex_⁄_li°íli°
(
ﬁdöã∫Æ
.
addrc
,

912 
ﬁdöã∫Æ
.
addrv
,

913 &
addπoböd
,

914 
SOCKS_UDP
) != -1) {

915 
	`¶og
(
LOG_DEBUG
,

918 
fun˘i⁄
,

919 
	`sockaddr2°rög
(&
addπoböd
, 
NULL
, 0),

920 ()
ruÀ
->
numbî
);

922 
ruÀ
->
boun˚d
 = 1;

930 
SOCKS_ADDR_IFNAME
: {

931 
sockaddr_°‹age
 
mask
;

932 
size_t
 
i
;

934 
i
 = 0;

935 
	`i‚ame2sockaddr
(
ruÀ
->
d°
.
addr
.
i‚ame
,

936 
i
++,

937 &
addπoböd
,

938 &
mask
Ë!
NULL
) {

939 i‡(
	`addrödex_⁄_li°íli°
(
ﬁdöã∫Æ
.
addrc
,

940 
ﬁdöã∫Æ
.
addrv
,

941 &
addπoböd
,

942 
SOCKS_UDP
) != -1) {

943 
	`¶og
(
LOG_DEBUG
,

946 
fun˘i⁄
,

947 
	`sockaddr2°rög
(&
addπoböd
, 
NULL
, 0),

948 ()
ruÀ
->
numbî
);

950 
ruÀ
->
boun˚d
 = 1;

958 
	`SERRX
(
ruÀ
->
d°
.
©y≥
);

961 i‡(!
ruÀ
->
boun˚d
)

962 
sockscf
.
°©e
.
Æludpboun˚d
 = 0;

967 
	`‰ì
(
ﬁdöã∫Æ
.
addrv
);

970 i‡(
	`bödöã∫Æ
(
SOCKS_TCP
) != 0)

971 
	`£º
("%s: faûedÅÿböd i¡î«»addªs£s", 
fun˘i⁄
);

992 
	`socks_lock
(
sockscf
.
shmemc⁄figfd
, 0, 0, 1, 1);

994 
poöãrsize
 = 
	`poöãr_size
(&
sockscf
);

996 
	`¶og
(
LOG_DEBUG
,

998 
fun˘i⁄
,

999 ()(
sockscf
),

1000 ()
poöãrsize
,

1001 ()((
sockscf
Ë+ 
poöãrsize
));

1003 i‡((
√wshmemc⁄fig
 = 
	`sockd_mm≠
(
NULL
,

1004 (
sockscf
Ë+ 
poöãrsize
,

1005 
PROT_READ
 | 
PROT_WRITE
,

1006 
MAP_SHARED
,

1007 
sockscf
.
shmemc⁄figfd
,

1008 1)Ë=
MAP_FAILED
) {

1009 
	`sw¨n
("%s: couldÇot create shared memory segment of size %lu",

1010 
fun˘i⁄
, ()((
sockscf
Ë+ 
poöãrsize
));

1012 
	`socks_u∆ock
(
sockscf
.
shmemc⁄figfd
, 0, 0);

1019 *
√wshmemc⁄fig
 = 
sockscf
;

1024 i‡(
	`poöãr_c›y
(&
sockscf
,

1026 
√wshmemc⁄fig
,

1027 (*)((
uöçå_t
)
√wshmemc⁄fig
 + (
sockscf
)),

1028 
poöãrsize
) != 0) {

1030 
	`sw¨n
("%s: couldÇŸ c›yÖoöãr†tÿsh¨ed mem‹y", 
fun˘i⁄
);

1032 
	`munm≠
(
√wshmemc⁄fig
, (
sockscf
Ë+ 
poöãrsize
);

1034 
	`socks_u∆ock
(
sockscf
.
shmemc⁄figfd
, 0, 0);

1043 i‡(
sockscf
.
shmemöfo
->
c⁄fig
 !
NULL
) {

1044 
rc
 = 
	`munm≠
(
sockscf
.
shmemöfo
->
c⁄fig
, sockscf.shmemöfo->
c⁄figsize
);

1045 
	`SASSERTX
(
rc
 == 0);

1048 
sockscf
.
shmemöfo
->
c⁄fig
 = 
√wshmemc⁄fig
;

1049 
sockscf
.
shmemöfo
->
c⁄figsize
 = (sockscfË+ 
poöãrsize
;

1051 
	`socks_u∆ock
(
sockscf
.
shmemc⁄figfd
, 0, 0);

1053 
	`¶og
(
LOG_DEBUG
,

1055 
fun˘i⁄
, ()
sockscf
.
shmemöfo
->
c⁄figsize
);

1057 i‡((
i
 = 
	`com∑ªc⁄figs
(&
sockscf
, sockscf.
shmemöfo
->
c⁄fig
)) == 0) {

1058 
	`sw¨nx
("%s: c⁄fig i¿shmemÇŸ idítiˇ»tÿru¬ög c⁄fig", 
fun˘i⁄
);

1062 
	`¶og
(
LOG_DEBUG
,

1064 
fun˘i⁄
, ()
i
);

1072 
	`ho°ˇcheövÆid©e
();

1074 
	`time_m⁄Ÿ⁄ic
(&
sockscf
.
°©
.
c⁄figlﬂd
);

1076 
	`¶og
(
LOG_INFO
,

1079 
	`sig£rvîbrﬂdˇ°
(
sig
);

1080 
	`sigchûdbrﬂdˇ°
(
sig
);

1082 
	`ª£çrivûeges
();

1084 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

1085 
	}
}

1091 
	$sigchld
(
sig
, 
si
, 
sc
)

1092 
sig
;

1093 
sigöfo_t
 *
si
;

1094 *
sc
;

1096 c⁄° *
fun˘i⁄
 = "sigchld()";

1097 c⁄° 
î∫o_s
 = 
î∫o
;

1098 
time_t
 
äow
;

1099 
pid_t
 
pid
;

1100 
°©us
;

1102 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

1104 i‡(
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(&
äow
), 
sockscf
.
°©e
.
fú°dóth_time
)

1105 >(
time_t
)
MAX_ADDCHILD_SECONDS
) {

1106 
sockscf
.
°©e
.
u√x≥˘ed_dóths
 = 0;

1107 
sockscf
.
°©e
.
fú°dóth_time
 = 0;

1108 
sockscf
.
°©e
.
œ°dóth_time
 = 0;

1110 
	`íabÀ_chûd¸óã
();

1114 
rußge
 
thi§ußge
;

1115 
sockd_chûd_t
 *
chûd
;

1116 
isu√x≥˘ed
, 
¥o˘y≥
;

1125 i‡((
pid
 = 
	`waô3
(&
°©us
, 
WNOHANG
, &
thi§ußge
)) == -1

1126 && 
	`ERRNOISTMP
(
î∫o
))

1129 i‡(
pid
 <= 0)

1132 
	`¶og
(
LOG_DEBUG
, "%s:Öro˚s†%ldÉxôed", 
fun˘i⁄
, ()
pid
);

1134 i‡(
	`pidismŸhî
(
pid
)) {

1135 
sockscf
.
°©e
.
mŸhîpidv
[
	`pidismŸhî
(
pid
) - 1] = 0;

1136 
isu√x≥˘ed
 = 1;

1137 
¥o˘y≥
 = 
PROC_MOTHER
;

1144 
rußge
 *rußge, 
sum
;

1146 i‡((
chûd
 = 
	`gëchûd
(
pid
)Ë=
NULL
) {

1157 
	`sw¨nx
("%s: unknown childÖid %luÉxited",

1158 
fun˘i⁄
, ()
pid
);

1163 i‡(
chûd
->
exôögn‹mÆly
)

1164 
isu√x≥˘ed
 = 0;

1166 
isu√x≥˘ed
 = 1;

1168 
¥o˘y≥
 = 
chûd
->
ty≥
;

1169 
chûd
->
ty≥
) {

1170 
PROC_MONITOR
:

1171 
rußge
 = &
sockscf
.
°©e
.
rußge_m⁄ô‹
;

1174 
PROC_NEGOTIATE
:

1175 
rußge
 = &
sockscf
.
°©e
.
rußge_√gŸüã
;

1178 
PROC_REQUEST
:

1179 
rußge
 = &
sockscf
.
°©e
.
rußge_ªque°
;

1182 
PROC_IO
:

1183 
rußge
 = &
sockscf
.
°©e
.
rußge_io
;

1187 
	`SERRX
(
chûd
->
ty≥
);

1190 
sum
 = *
rußge
;

1192 
	`timîadd
(&
rußge
->
ru_utime
, &
thi§ußge
.ru_utime, &
sum
.ru_utime);

1193 
	`timîadd
(&
rußge
->
ru_°ime
, &
thi§ußge
.ru_°ime, &
sum
.ru_stime);

1194 
sum
.
ru_möÊt
 +
thi§ußge
.ru_minflt;

1195 
sum
.
ru_majÊt
 +
thi§ußge
.ru_majflt;

1196 
sum
.
ru_nsw≠
 +
thi§ußge
.ru_nswap;

1197 
sum
.
ru_öblock
 +
thi§ußge
.ru_inblock;

1198 
sum
.
ru_oublock
 +
thi§ußge
.ru_oublock;

1199 
sum
.
ru_msg¢d
 +
thi§ußge
.ru_msgsnd;

1200 
sum
.
ru_msgrcv
 +
thi§ußge
.ru_msgrcv;

1201 
sum
.
ru_nsig«ls
 +
thi§ußge
.ru_nsignals;

1202 
sum
.
ru_nvcsw
 +
thi§ußge
.ru_nvcsw;

1203 
sum
.
ru_nivcsw
 +
thi§ußge
.ru_nivcsw;

1205 *
rußge
 = 
sum
;

1207 
	`¶og
(
LOG_DEBUG
, "%s: %s-child %luÉxitingáfter %ldsánd %lu client%s",

1208 
fun˘i⁄
,

1209 
	`chûdty≥2°rög
(
¥o˘y≥
),

1210 ()
pid
,

1211 ()
	`socks_dif·ime
(
äow
, 
chûd
->
¸óãd
),

1212 ()
chûd
->
£¡c
,

1213 ()
chûd
->
£¡c
 == 1 ? "" : "s");

1215 
	`log_rußge
(
chûd
->
ty≥
, 
pid
, &
thi§ußge
);

1217 
	`ªmovechûd
(
pid
);

1220 i‡(
isu√x≥˘ed
) {

1221 
	`sw¨nx
("%s: %s %luÉxited unexpectedly %s %s",

1222 
fun˘i⁄
,

1223 
	`chûdty≥2°rög
(
¥o˘y≥
),

1224 ()
pid
,

1225 
	`WIFSIGNALED
(
°©us
) ? "on signal" : "",

1226 
	`WIFSIGNALED
(
°©us
Ë? 
	`sig«l2°rög
(
	`WTERMSIG
(status)) : "");

1228 
	`u√x≥˘eddóth
();

1232 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

1233 
	}
}

	@sockd/privileges.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 
¥ivûege_t
 
	gœ°¥ivñege
 = 
SOCKD_PRIV_NOTSET
;

52 
	$sockd_öô¥ivs
()

54 c⁄° *
fun˘i⁄
 = "sockd_initprivs()";

56 #i‡
HAVE_SOLARIS_PRIVS


57 *
¥iv°r
;

58 
¥iv_£t_t
 *
¥iv£t
;

59 c⁄° *
exåa_¥ivs
[] = {

60 
PRIV_FILE_DAC_READ
,

61 
PRIV_FILE_DAC_SEARCH
,

62 
PRIV_FILE_DAC_WRITE
,

63 
PRIV_NET_PRIVADDR
,

67 
PRIV_PROC_LOCK_MEMORY
,

68 #i‡
HAVE_UDP_SUPPORT


69 
PRIV_NET_ICMPACCESS
,

75 
size_t
 
i
;

77 i‡((
sockscf
.
¥ivûeges
.
¥ivûeged
 = 
	`¥iv_Æloc£t
()Ë=
NULL


78 || (
sockscf
.
¥ivûeges
.
u≈rivûeged
 = 
	`¥iv_Æloc£t
()Ë=
NULL
) {

79 
	`sw¨n
("%s:Öriv_Æloc£t()", 
fun˘i⁄
);

83 i‡((
¥iv£t
 = 
	`¥iv_°r_to_£t
 ("basic", ",", 
NULL
)) == NULL) {

84 
	`sw¨n
("%s:Öriv_°r_to_£àÁûed", 
fun˘i⁄
);

103 i‡(
	`¥iv_dñ£t
(
¥iv£t
, 
PRIV_PROC_EXEC
) != 0) {

104 
	`sw¨n
("%s: c™nŸÑemovê%†¥ivûege", 
fun˘i⁄
, 
PRIV_PROC_EXEC
);

109 
	`¥iv_c›y£t
(
¥iv£t
, 
sockscf
.
¥ivûeges
.
u≈rivûeged
);

115 
i
 = 0; i < 
	`ELEMENTS
(
exåa_¥ivs
); ++i)

116 i‡(
	`¥iv_add£t
(
¥iv£t
, 
exåa_¥ivs
[
i
]) != 0) {

117 
	`sw¨n
("%s: c™nŸádd %†¥ivûege", 
fun˘i⁄
, 
exåa_¥ivs
[
i
]);

121 
	`¶og
(
LOG_DEBUG
, "%s:áddedÖrivilege %sÅoÅheÖrivileged set",

122 
fun˘i⁄
, 
exåa_¥ivs
[
i
]);

128 
	`¥iv_c›y£t
(
¥iv£t
, 
sockscf
.
¥ivûeges
.
¥ivûeged
);

129 
	`¥iv_‰ì£t
(
¥iv£t
);

131 i‡((
¥iv°r
 = 
	`¥iv_£t_to_°r
(
sockscf
.
¥ivûeges
.
¥ivûeged
,

133 
PRIV_STR_LIT
)Ë=
NULL
)

134 
	`sw¨n
("%s:Öriv_set_to_str(sockscf.privileges.privileged) failed",

135 
fun˘i⁄
);

137 i‡(
	`£ç¥iv
(
PRIV_SET
, 
PRIV_PERMITTED
, 
sockscf
.
¥ivûeges
.
¥ivûeged
) == -1){

138 
	`sw¨n
("%s: cannot setÅhe PRIV_PERMITTEDÖrivilege set (%s)",

139 
fun˘i⁄
, 
¥iv°r
 =
NULL
 ? "" :Örivstr);

141 
	`‰ì
(
¥iv°r
);

145 
	`¶og
(
LOG_DEBUG
, "%s: usingÅhe followingÖrivileges for PRIV_PERMITTED: %s",

146 
fun˘i⁄
, 
¥iv°r
 =
NULL
 ? "<error>" :Örivstr);

148 
	`‰ì
(
¥iv°r
);

154 i‡((
¥iv°r
 = 
	`¥iv_£t_to_°r
(
sockscf
.
¥ivûeges
.
u≈rivûeged
,

156 
PRIV_STR_LIT
)Ë=
NULL
)

157 
	`sw¨n
("%s:Öriv_set_to_str(sockscf.privileges.unprivileged) failed",

158 
fun˘i⁄
);

160 i‡(
	`£ç¥iv
(
PRIV_SET
, 
PRIV_EFFECTIVE
, 
sockscf
.
¥ivûeges
.
u≈rivûeged
)

162 
	`sw¨n
("%s: cannot setÅhe PRIV_EFFECTIVEÖrivilege set (%s)",

163 
fun˘i⁄
, 
¥iv°r
 =
NULL
 ? "" :Örivstr);

165 
	`‰ì
(
¥iv°r
);

173 i‡(
	`£ç¥iv
(
PRIV_SET
, 
PRIV_INHERITABLE
, 
sockscf
.
¥ivûeges
.
u≈rivûeged
)

175 
	`sw¨n
("%s: cannot set PRIV_INHERITABLEÖrivilege set (%s)",

176 
fun˘i⁄
, 
¥iv°r
 =
NULL
 ? "" :Örivstr);

178 
	`‰ì
(
¥iv°r
);

182 
	`¶og
(
LOG_DEBUG
, "%s: usingÅhe followingÖrivileges for PRIV_EFFECTIVE "

184 
fun˘i⁄
, 
¥iv°r
 =
NULL
 ? "<error>" :Örivstr);

186 
	`‰ì
(
¥iv°r
);

188 
	`£åeuid
(
	`gëuid
(), getuid());

189 
	`£åegid
(
	`gëgid
(), getgid());

191 
	`¶og
(
LOG_DEBUG
, "%s:Örivûege†ªlöquished suc˚ssfuŒy", 
fun˘i⁄
);

194 
sockscf
.
°©e
.
havïrivs
 = 1;

198 i‡(
	`gëeuid
() == 0)

200 
sockscf
.
°©e
.
havïrivs
 = 1;

202 i‡(
	`£ãgid
(
sockscf
.
uid
.
u≈rivûeged_gid
) != 0) {

203 
	`sw¨n
("%s: setegid(2)Åo unprivileged gid %lu failed",

204 
fun˘i⁄
, ()
sockscf
.
uid
.
u≈rivûeged_gid
);

206 
sockscf
.
°©e
.
havïrivs
 = 0;

209 
sockscf
.
°©e
.
egid
 = sockscf.
uid
.
u≈rivûeged_gid
;

211 i‡(
	`£ãuid
(
sockscf
.
uid
.
u≈rivûeged_uid
) != 0) {

212 
	`sw¨n
("%s: seteuid(2)Åo unprivileged uid %lu failed",

213 
fun˘i⁄
, ()
sockscf
.
uid
.
u≈rivûeged_uid
);

215 
sockscf
.
°©e
.
havïrivs
 = 0;

218 
sockscf
.
°©e
.
euid
 = sockscf.
uid
.
u≈rivûeged_uid
;

220 
	`¶og
(
LOG_DEBUG
, "%s: will useÉuid/egid %lu/%luÇormally",

221 
fun˘i⁄
,

222 ()
sockscf
.
uid
.
u≈rivûeged_uid
,

223 ()
sockscf
.
uid
.
u≈rivûeged_gid
);

228 
	}
}

231 
	$sockd_¥iv
(
¥ivûege
, 
›
)

232 c⁄° 
¥ivûege_t
 
¥ivûege
;

233 c⁄° 
¥iv_›_t
 
›
;

235 c⁄° *
fun˘i⁄
 = "sockd_priv()";

236 #i‡
HAVE_PRIVILEGES


237 
¥iv_£t_t
 *
œ°¥iv£t
;

240 
uid_t
 
œ°euid
;

241 
gid_t
 
œ°egid
;

242 
p
;

246 i‡(!
sockscf
.
°©e
.
havïrivs
)

249 
	`¶og
(
LOG_DEBUG
, "%s: switchingÖrivilege %d %s",

250 
fun˘i⁄
, ()
¥ivûege
, 
	`¥iv›2°rög
(
›
));

252 
	#FULLSETS
 \

253 
SOCKD_PRIV_LIBWRAP
: \

254 
SOCKD_PRIV_PRIVILEGED
: \

255 
SOCKD_PRIV_UNPRIVILEGED
: \

256 
SOCKD_PRIV_PAM
: \

257 
SOCKD_PRIV_BSDAUTH


	)

259 #i‡
HAVE_PRIVILEGES


260 i‡(
œ°¥iv£t
 =
NULL
)

261 i‡((
œ°¥iv£t
 = 
	`¥iv_Æloc£t
()Ë=
NULL
) {

262 
	`£º
("%s:Öriv_Æloc£t()", 
fun˘i⁄
);

271 i‡(
›
 =
PRIV_ON
) {

272 
	`SASSERTX
(
œ°¥ivñege
 =
SOCKD_PRIV_NOTSET
);

273 
œ°¥ivñege
 = 
¥ivûege
;

275 #i‡
HAVE_PRIVILEGES


276 
¥ivûege
) {

277 
FULLSETS
:

282 i‡(
	`gëµriv
(
PRIV_EFFECTIVE
, 
œ°¥iv£t
) != 0) {

283 
	`sw¨n
("%s: very strange ... getppriv(PRIV_EFFECTIVE) failed. "

285 
fun˘i⁄
);

286 
	`SWARN
(
î∫o
);

296 
	`SASSERTX
(
›
 =
PRIV_OFF
);

297 
	`SASSERTX
(
œ°¥ivñege
 =
¥ivûege
);

298 
œ°¥ivñege
 = 
SOCKD_PRIV_NOTSET
;

301 
¥ivûege
) {

302 
FULLSETS
: {

303 #i‡
HAVE_PRIVILEGES


304 
¥iv_£t_t
 *
¥ivto£t
;

307 
uid_t
 
√weuid
;

308 
gid_t
 
√wegid
;

310 i‡(
›
 =
PRIV_ON
) {

311 
œ°euid
 = 
sockscf
.
°©e
.
euid
;

312 
œ°egid
 = 
sockscf
.
°©e
.
egid
;

317 i‡(
›
 =
PRIV_ON
) {

318 
¥ivûege
) {

319 
SOCKD_PRIV_PRIVILEGED
:

320 
SOCKD_PRIV_PAM
:

321 
SOCKD_PRIV_BSDAUTH
:

322 #i‡
HAVE_PRIVILEGES


324 
¥ivto£t
 = 
sockscf
.
¥ivûeges
.
¥ivûeged
;

328 
√weuid
 = 
sockscf
.
uid
.
¥ivûeged_uid
;

329 
√wegid
 = 
sockscf
.
uid
.
¥ivûeged_gid
;

334 
SOCKD_PRIV_UNPRIVILEGED
:

335 #i‡
HAVE_PRIVILEGES


337 
¥ivto£t
 = 
sockscf
.
¥ivûeges
.
u≈rivûeged
;

341 
√weuid
 = 
sockscf
.
uid
.
u≈rivûeged_uid
;

342 
√wegid
 = 
sockscf
.
uid
.
u≈rivûeged_gid
;

347 
SOCKD_PRIV_LIBWRAP
:

348 #i‡
HAVE_PRIVILEGES


350 
¥ivto£t
 = 
sockscf
.
¥ivûeges
.
u≈rivûeged
;

354 
√weuid
 = 
sockscf
.
uid
.
libwøp_uid
;

355 
√wegid
 = 
sockscf
.
uid
.
libwøp_gid
;

361 
	`SERRX
(
¥ivûege
);

365 #i‡
HAVE_PRIVILEGES


367 
¥ivto£t
 = 
œ°¥iv£t
;

371 
√weuid
 = 
œ°euid
;

372 
√wegid
 = 
œ°egid
;

376 #i‡
HAVE_PRIVILEGES


377 i‡(
	`£ç¥iv
(
PRIV_SET
, 
PRIV_EFFECTIVE
, 
¥ivto£t
) != 0)

378 
	`£º
("%s: switchingÖrivilegeÜevel %d %s failed",

379 
fun˘i⁄
, ()
¥ivûege
, 
	`¥iv›2°rög
(
›
));

382 i‡(
	`sockd_£ãugid
(
√weuid
, 
√wegid
) != 0)

383 
	`£º
("%s: switchingÅoÉuid/egid %u/%u failed",

384 
fun˘i⁄
,

385 
›
 =
PRIV_ON
 ? ()
√weuid
 : ()
œ°euid
,

386 
›
 =
PRIV_ON
 ? ()
√wegid
 : ()
œ°egid
);

392 
SOCKD_PRIV_FILE_READ
:

393 
SOCKD_PRIV_GSSAPI
:

394 #i‡
HAVE_PRIVILEGES


395 i‡(
	`¥iv_£t
(
›
, 
PRIV_EFFECTIVE
, 
PRIV_FILE_DAC_SEARCH
, 
NULL
) != 0)

396 
	`£º
("%s: switching PRIV_FILE_DAC_SEARCH %s failed",

397 
fun˘i⁄
, 
	`¥iv›2°rög
(
›
));

399 i‡(
	`¥iv_£t
(
›
, 
PRIV_EFFECTIVE
, 
PRIV_FILE_DAC_READ
, 
NULL
) != 0)

400 
	`£º
("%s: switching PRIV_FILE_DAC_READ %s failed",

401 
fun˘i⁄
, 
	`¥iv›2°rög
(
›
));

404 i‡(
›
 =
PRIV_ON
)

405 
p
 = 
	`sockd_£ãugid
(
sockscf
.
uid
.
¥ivûeged_uid
,

406 
sockscf
.
uid
.
¥ivûeged_gid
);

408 
p
 = 
	`sockd_£ãugid
(
œ°euid
, 
œ°egid
);

410 i‡(
p
 != 0)

411 
	`£º
("%s: switchingÅoÉuid/egid %u/%u failed",

412 
fun˘i⁄
,

413 
›
 =
PRIV_ON
 ?

414 ()
sockscf
.
uid
.
¥ivûeged_uid
 : ()
œ°euid
,

415 
›
 =
PRIV_ON
 ?

416 ()
sockscf
.
uid
.
¥ivûeged_gid
 : ()
œ°egid
);

421 
SOCKD_PRIV_FILE_WRITE
:

422 #i‡
HAVE_PRIVILEGES


423 i‡(
	`¥iv_£t
(
›
, 
PRIV_EFFECTIVE
, 
PRIV_FILE_DAC_SEARCH
, 
NULL
) != 0)

424 
	`£º
("%s: switching PRIV_FILE_DAC_SEARCH %s failed",

425 
fun˘i⁄
, 
	`¥iv›2°rög
(
›
));

427 i‡(
	`¥iv_£t
(
›
, 
PRIV_EFFECTIVE
, 
PRIV_FILE_DAC_READ
, 
NULL
) != 0)

428 
	`£º
("%s: switching PRIV_FILE_DAC_READ %s failed",

429 
fun˘i⁄
, 
	`¥iv›2°rög
(
›
));

431 i‡(
	`¥iv_£t
(
›
, 
PRIV_EFFECTIVE
, 
PRIV_FILE_DAC_WRITE
, 
NULL
) != 0)

432 
	`£º
("%s: switching PRIV_FILE_DAC_WRITE %s failed",

433 
fun˘i⁄
, 
	`¥iv›2°rög
(
›
));

436 i‡(
›
 =
PRIV_ON
)

437 
p
 = 
	`sockd_£ãugid
(
sockscf
.
uid
.
¥ivûeged_uid
,

438 
sockscf
.
uid
.
¥ivûeged_gid
);

440 
p
 = 
	`sockd_£ãugid
(
œ°euid
, 
œ°egid
);

442 i‡(
p
 != 0)

443 
	`£º
("%s: switchingÅoÉuid/egid %u/%u failed",

444 
fun˘i⁄
,

445 
›
 =
PRIV_ON
 ?

446 ()
sockscf
.
uid
.
¥ivûeged_uid
 : ()
œ°euid
,

447 
›
 =
PRIV_ON
 ?

448 ()
sockscf
.
uid
.
¥ivûeged_gid
 : ()
œ°egid
);

453 
SOCKD_PRIV_NET_ADDR
:

454 #i‡
HAVE_PRIVILEGES


455 i‡(
	`¥iv_£t
(
›
, 
PRIV_EFFECTIVE
, 
PRIV_NET_PRIVADDR
, 
NULL
) != 0)

456 
	`£º
("%s: switching PRIV_NET_PRIVADDR %s failed",

457 
fun˘i⁄
, 
	`¥iv›2°rög
(
›
));

460 i‡(
›
 =
PRIV_ON
)

461 
p
 = 
	`sockd_£ãugid
(
sockscf
.
uid
.
¥ivûeged_uid
,

462 
sockscf
.
uid
.
¥ivûeged_uid
);

464 
p
 = 
	`sockd_£ãugid
(
œ°euid
, 
œ°egid
);

466 i‡(
p
 != 0)

467 
	`£º
("%s: switchingÅoÉuid/egid %u/%u failed",

468 
fun˘i⁄
,

469 
›
 =
PRIV_ON
 ?

470 ()
sockscf
.
uid
.
¥ivûeged_uid
 : ()
œ°euid
,

471 
›
 =
PRIV_ON
 ?

472 ()
sockscf
.
uid
.
¥ivûeged_gid
 : ()
œ°egid
);

477 
SOCKD_PRIV_NET_ICMPACCESS
:

478 #i‡
HAVE_PRIVILEGES


479 i‡(
	`¥iv_£t
(
›
, 
PRIV_EFFECTIVE
, 
PRIV_NET_ICMPACCESS
, 
NULL
) != 0)

480 
	`£º
("%s: switching PRIV_NET_ICMPACCESS %s failed",

481 
fun˘i⁄
, 
	`¥iv›2°rög
(
›
));

484 i‡(
›
 =
PRIV_ON
)

485 
p
 = 
	`sockd_£ãugid
(
sockscf
.
uid
.
¥ivûeged_uid
,

486 
sockscf
.
uid
.
¥ivûeged_uid
);

488 
p
 = 
	`sockd_£ãugid
(
œ°euid
, 
œ°egid
);

490 i‡(
p
 != 0)

491 
	`£º
("%s: switchingÅoÉuid/egid %u/%u failed",

492 
fun˘i⁄
,

493 
›
 =
PRIV_ON
 ?

494 ()
sockscf
.
uid
.
¥ivûeged_uid
 : ()
œ°euid
,

495 
›
 =
PRIV_ON
 ?

496 ()
sockscf
.
uid
.
¥ivûeged_gid
 : ()
œ°egid
);

501 
SOCKD_PRIV_NET_ROUTESOCKET
:

502 #i‡
HAVE_PRIVILEGES


506 i‡(
›
 =
PRIV_ON
)

507 
p
 = 
	`sockd_£ãugid
(
sockscf
.
uid
.
¥ivûeged_uid
,

508 
sockscf
.
uid
.
¥ivûeged_gid
);

510 
p
 = 
	`sockd_£ãugid
(
œ°euid
, 
œ°egid
);

512 i‡(
p
 != 0)

513 
	`£º
("%s: switchingÅoÉuid/egid %u/%u failed",

514 
fun˘i⁄
,

515 
›
 =
PRIV_ON
 ?

516 ()
sockscf
.
uid
.
¥ivûeged_uid
 : ()
œ°euid
,

517 
›
 =
PRIV_ON
 ?

518 ()
sockscf
.
uid
.
¥ivûeged_gid
 : ()
œ°egid
);

524 
	`SERRX
(
¥ivûege
);

526 
	}
}

529 
	$ª£çrivûeges
()

531 c⁄° *
fun˘i⁄
 = "resetprivileges()";

533 
	`¶og
(
LOG_DEBUG
, "%s:Éuid/egid %ld/%ld",

534 
fun˘i⁄
, ()
	`gëeuid
(), ()
	`gëegid
());

536 #i‡!
HAVE_PRIVILEGES


537 i‡(
sockscf
.
uid
.
¥ivûeged_uid
 =sockscf.uid.
u≈rivûeged_uid


538 && 
sockscf
.
uid
.
¥ivûeged_uid
 =sockscf.uid.
libwøp_uid


539 && 
sockscf
.
uid
.
¥ivûeged_uid
 !
	`gëeuid
()) {

540 
	`¶og
(
LOG_DEBUG
,

543 
fun˘i⁄
, ()
sockscf
.
uid
.
u≈rivûeged_uid
);

545 ()
	`£ãuid
(0);

547 i‡(
	`£tgid
(
sockscf
.
uid
.
u≈rivûeged_gid
) != 0) {

548 i‡(
	`gëegid
(Ë!
sockscf
.
uid
.
u≈rivûeged_gid


549 || 
	`gëgid
(Ë!
sockscf
.
uid
.
u≈rivûeged_gid
)

550 
	`£º
("setgid(2)Åo unprivileged gid %lu failed",

551 ()
sockscf
.
uid
.
u≈rivûeged_gid
);

554 i‡(
	`£tuid
(
sockscf
.
uid
.
u≈rivûeged_uid
) != 0) {

555 i‡(
	`gëeuid
(Ë!
sockscf
.
uid
.
u≈rivûeged_uid


556 || 
	`gëuid
(Ë!
sockscf
.
uid
.
u≈rivûeged_uid
)

557 
	`£º
("setuid(2)Åo unprivileged uid %lu failed",

558 ()
sockscf
.
uid
.
u≈rivûeged_uid
);

561 
sockscf
.
°©e
.
egid
 = sockscf.
uid
.
u≈rivûeged_gid
;

562 
sockscf
.
°©e
.
euid
 = sockscf.
uid
.
u≈rivûeged_uid
;

564 
sockscf
.
°©e
.
havïrivs
 = 0;

567 
	}
}

570 #i‡!
HAVE_PRIVILEGES


572 
	$sockd_£ãugid
(
uid
, 
gid
)

573 c⁄° 
uid_t
 
uid
;

574 c⁄° 
gid_t
 
gid
;

576 c⁄° *
fun˘i⁄
 = "sockd_setugid()";

578 i‡(
sockscf
.
°©e
.
öôed
 && !sockscf.°©e.
havïrivs
)

581 
	`¶og
(
LOG_DEBUG
, "%s: old uid/gid: %lu/%lu,Çew: %lu/%lu",

582 
fun˘i⁄
,

583 ()
sockscf
.
°©e
.
euid
,

584 ()
sockscf
.
°©e
.
egid
,

585 ()
uid
,

586 ()
gid
);

588 #i‡
DIAGNOSTIC


589 
	`SASSERTX
(
	`gëeuid
(Ë=
sockscf
.
°©e
.
euid
);

590 
	`SASSERTX
(
	`gëegid
(Ë=
sockscf
.
°©e
.
egid
);

593 i‡(
sockscf
.
°©e
.
euid
 =
uid


594 && 
sockscf
.
°©e
.
egid
 =
gid
)

597 i‡(
sockscf
.
°©e
.
euid
 != 0) {

599 i‡(
	`£ãuid
(
sockscf
.
öôül
.
euid
) != 0) {

600 
	`sw¨n
("%s: failedÑeveringÅo originalÉuid %lu",

601 
fun˘i⁄
, ()
sockscf
.
öôül
.
euid
);

608 i‡(
	`£ãgid
(
gid
) != 0) {

609 
	`sw¨n
("%s: setegid(2)Åo gid %lu fromÉuid/egid %lu/%lu failed",

610 
fun˘i⁄
,

611 ()
gid
,

612 ()
sockscf
.
°©e
.
euid
,

613 ()
sockscf
.
°©e
.
egid
);

618 
sockscf
.
°©e
.
egid
 = 
gid
;

621 i‡(
	`£ãuid
(
uid
) != 0) {

622 
	`sw¨n
("%s: seteuid(2)Åo uid %lu fromÉuid/egid %lu/%lu failed",

623 
fun˘i⁄
,

624 ()
uid
,

625 ()
sockscf
.
°©e
.
euid
,

626 ()
sockscf
.
°©e
.
egid
);

631 
sockscf
.
°©e
.
euid
 = 
uid
;

634 
	}
}

	@sockd/rule.c

44 
	~"comm⁄.h
"

45 
	~"m⁄ô‹.h
"

46 
	~"c⁄fig_∑r£.h
"

48 c⁄° 
	grcsid
[] =

51 #i‡
HAVE_LIBWRAP


52 
jmp_buf
 
t˝d_buf
;

53 
	gÆlow_£vîôy
, 
	gdíy_£vîôy
;

56 
libwøpöô
(
s
, 
sockaddr_°‹age
 *
loˇl
,

57 
sockaddr_°‹age
 *
≥î
, 
ªque°_öfo
 *
ªque°
);

65 
libwøp_ho°s_ac˚ss
(
ªque°_öfo
 *
ªque°
,

66 c⁄° 
sockaddr_°‹age
 *
≥î
);

73 
§cho°_isok
(c⁄° 
sockaddr_°‹age
 *
≥î
, *
msg
, 
size_t
 
msgsize
);

88 
ruÀaddr_m©ches_Æl_exã∫Æ
(c⁄° 
ruÀaddr_t
 *
ruÀaddr
, c⁄° 
¥Ÿocﬁ
);

96 
showlog
(c⁄° 
log_t
 *
log
);

101 
ruÀ_t
 *

102 
addruÀ
(c⁄° 
ruÀ_t
 *
√wruÀ
,ÑuÀ_à**
ruÀba£
, c⁄° 
obje˘ty≥_t
 
ruÀty≥
);

111 
checkruÀ
(c⁄° 
ruÀ_t
 *
ruÀ
);

117 
log_shmemöhîô
(c⁄° 
ruÀ_t
 *
‰om
, c⁄°ÑuÀ_à*
to
, c⁄° 
ty≥
,

118 c⁄° 
isovîride
);

127 
log_öhîôabÀ
(c⁄° *
¥efix
, c⁄° 
ruÀ_t
 *
ruÀ
,

128 c⁄° 
shmid
, c⁄° *
£âögs
,

129 c⁄° 
öhîôabÀ
);

136 
ruÀ_t
 *

137 
	$add˛õ¡ruÀ
(
√wruÀ
)

138 c⁄° 
ruÀ_t
 *
√wruÀ
;

140 c⁄° *
fun˘i⁄
 = "addclientrule()";

141 
ruÀ_t
 *
ruÀ
, 
ruÀtﬂdd
;

143 
ruÀtﬂdd
 = *
√wruÀ
;

145 #i‡
BAREFOOTD


161 
√wruÀ
->
d°
.
©y≥
) {

162 
SOCKS_ADDR_IPV4
:

163 
SOCKS_ADDR_IPV6
:

166 
SOCKS_ADDR_DOMAIN
:

167 
SOCKS_ADDR_IFNAME
: {

168 
sockaddr_°‹age
 
ß
, 
mask
;

169 
size_t
 
i
, 
ruÀnumbî
;

170 
emsg
[1024], 
i‚ame
[(
√wruÀ
->
d°
.
addr
.ifname)],

171 
ho°«me
[(
√wruÀ
->
d°
.
addr
.
domaö
)];

172 
rc
;

174 
√wruÀ
->
d°
.
©y≥
) {

175 
SOCKS_ADDR_DOMAIN
:

176 
	`STRCPY_ASSERTLEN
(
ho°«me
, 
√wruÀ
->
d°
.
addr
.
domaö
);

179 
SOCKS_ADDR_IFNAME
:

180 
	`STRCPY_ASSERTLEN
(
i‚ame
, 
√wruÀ
->
d°
.
addr
.ifname);

184 
	`SERRX
(
√wruÀ
->
d°
.
©y≥
);

187 
i
 = 0;

188 
ruÀnumbî
 = 0;

191 i‡(
√wruÀ
->
d°
.
©y≥
 =
SOCKS_ADDR_DOMAIN
) {

192 i‡(
	`ho°«me2sockaddr2
(
ho°«me
,

193 
i
,

194 &
ß
,

195 &
rc
,

196 
emsg
,

197 (
emsg
)Ë=
NULL
)

200 i‡(
√wruÀ
->
d°
.
©y≥
 =
SOCKS_ADDR_IFNAME
) {

201 i‡(
	`i‚ame2sockaddr
(
i‚ame
, 
i
, &
ß
, &
mask
Ë=
NULL
) {

202 
	`¢¥ötf
(
emsg
, (emsg),

204 
i‚ame
);

209 
	`SERRX
(
√wruÀ
->
d°
.
©y≥
);

211 
	`¶og
(
LOG_DEBUG
, "%s:Éxpandingáddress %s from %s %s",

212 
fun˘i⁄
,

213 
	`sockaddr2°rög2
(&
ß
, 0, 
NULL
, 0),

214 
	`©y≥2°rög
(
√wruÀ
->
d°
.
©y≥
),

215 
√wruÀ
->
d°
.
©y≥
 =
SOCKS_ADDR_DOMAIN
 ? 
ho°«me
 : 
i‚ame
);

217 
ruÀtﬂdd
 = *
√wruÀ
;

218 
ruÀtﬂdd
.
d°
.
©y≥
 = 
	`ßÁmûy2©y≥
(
ß
.
ss_Ámûy
)) {

219 
SOCKS_ADDR_IPV4
:

220 
ruÀtﬂdd
.
d°
.
addr
.
ùv4
.
ù
 = 
	`TOIN
(&
ß
)->
sö_addr
;

221 
ruÀtﬂdd
.
d°
.
addr
.
ùv4
.
mask
.
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

224 
SOCKS_ADDR_IPV6
:

225 
ruÀtﬂdd
.
d°
.
addr
.
ùv6
.
ù
 = 
	`TOIN6
(&
ß
)->
sö6_addr
;

226 
ruÀtﬂdd
.
d°
.
addr
.
ùv6
.
maskbôs
 = 
IPV6_NETMASKBITS
;

227 
ruÀtﬂdd
.
d°
.
addr
.
ùv6
.
sc›eid
 = 
	`TOIN6
(&
ß
)->
sö6_sc›e_id
;

231 
	`SERRX
(
ruÀtﬂdd
.
d°
.
©y≥
);

234 
ruÀ
 = 
	`add˛õ¡ruÀ
(&
ruÀtﬂdd
);

236 i‡(
ruÀnumbî
 == 0)

242 
ruÀnumbî
 = 
ruÀ
->
numbî
;

244 
ruÀ
->
numbî
 = 
ruÀnumbî
;

246 ++
i
;

249 i‡(
i
 == 0)

250 
	`yyîr‹x
("couldÇot determine IP-addressÅoÑeceive clients on: %s",

251 
emsg
);

253  
NULL
;

257 
	`yyîr‹x
("addresses ofÅype %sáreÇot supported inÅhe \"to\"-field "

259 
	`©y≥2°rög
(
ruÀtﬂdd
.
d°
.
©y≥
),

260 
PRODUCT
);

264 
ruÀ
 = 
	`addruÀ
(&
ruÀtﬂdd
, &
sockscf
.
¸uÀ
, 
obje˘_¸uÀ
);

266 
	`checkruÀ
(
ruÀ
);

268 #i‡
BAREFOOTD


269 i‡(
ruÀ
->
°©e
.
¥Ÿocﬁ
.
udp
) {

292 
sockaddr_°‹age
 
ß
;

298 
sockscf
.
°©e
.
Æludpboun˚d
 = 0;

300 i‡(
	`addrödex_⁄_li°íli°
(
sockscf
.
öã∫Æ
.
addrc
,

301 
sockscf
.
öã∫Æ
.
addrv
,

302 
	`ruÀaddr2sockaddr
(&
ruÀ
->
d°
, &
ß
, 
SOCKS_UDP
),

303 
SOCKS_UDP
) == -1) {

308 
	`addöã∫Æ
(&
ruÀ
->
d°
, 
SOCKS_UDP
);

311 
	`¶og
(
LOG_DEBUG
,

314 
fun˘i⁄
,

315 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0),

316 ()
ruÀ
->
numbî
);

318 
ruÀ
->
boun˚d
 = 1;

323  
ruÀ
;

324 
	}
}

326 #i‡
HAVE_SOCKS_HOSTID


327 
ruÀ_t
 *

328 
	$addho°idruÀ
(
√wruÀ
)

329 c⁄° 
ruÀ_t
 *
√wruÀ
;

332 
ruÀ_t
 *
ruÀ
 = 
	`addruÀ
(
√wruÀ
, &
sockscf
.
hruÀ
, 
obje˘_hruÀ
);

333 
	`checkruÀ
(
ruÀ
);

335  
ruÀ
;

336 
	}
}

340 
ruÀ_t
 *

341 
	$addsock§uÀ
(
√wruÀ
)

342 c⁄° 
ruÀ_t
 *
√wruÀ
;

345 
ruÀ_t
 *
ruÀ
 = 
	`addruÀ
(
√wruÀ
, &
sockscf
.
§uÀ
, 
obje˘_§uÀ
);

346 
	`checkruÀ
(
ruÀ
);

348  
ruÀ
;

349 
	}
}

351 
löked«me_t
 *

352 
	$addlöked«me
(
löked«me
, 
«me
)

353 
löked«me_t
 **
löked«me
;

354 c⁄° *
«me
;

356 
löked«me_t
 *
u£r
, *
œ°
;

358 
u£r
 = *
löked«me
, 
œ°
 = 
NULL
; u£∏!NULL; u£∏u£r->
√xt
)

359 
œ°
 = 
u£r
;

361 i‡((
u£r
 = 
	`mÆloc
((*u£r))Ë=
NULL
)

362  
NULL
;

364 i‡((
u£r
->
«me
 = 
	`°rdup
“ame)Ë=
NULL
) {

365 
	`‰ì
(
u£r
);

366  
NULL
;

369 
u£r
->
√xt
 = 
NULL
;

371 i‡(
œ°
 =
NULL
)

372 *
löked«me
 = 
u£r
;

374 
œ°
->
√xt
 = 
u£r
;

376  *
löked«me
;

377 
	}
}

380 
	$‰ìlöked«me
(
li°
)

381 
löked«me_t
 *
li°
;

384 
li°
 !
NULL
) {

385 
löked«me_t
 *
√xt
 = 
li°
->next;

387 
	`‰ì
(
li°
->
«me
);

388 
	`‰ì
(
li°
);

390 
li°
 = 
√xt
;

392 
	}
}

395 
	$showruÀ
(
_ruÀ
, 
ruÀty≥
)

396 c⁄° 
ruÀ_t
 *
_ruÀ
;

397 c⁄° 
obje˘ty≥_t
 
ruÀty≥
;

399 c⁄° *
fun˘i⁄
 = "showrule()";

400 
ruÀ_t
 
ruÀ
 = *
_ruÀ
;

401 
size_t
 
bufu£d
, 
i
;

402 
buf
[256];

404 
	`¶og
(
LOG_DEBUG
, "%s #%lu,Üine #%lu",

405 
	`obje˘ty≥2°rög
(
ruÀty≥
),

406 ()
ruÀ
.
numbî
,

407 ()
ruÀ
.
löíumbî
);

409 
	`¶og
(
LOG_DEBUG
, "vîdi˘: %s", 
	`vîdi˘2°rög
(
ruÀ
.
vîdi˘
));

411 
	`¶og
(
LOG_DEBUG
, "src: %s",

412 
	`ruÀaddr2°rög
(&
ruÀ
.
§c
, 
ADDRINFO_PORT
 | 
ADDRINFO_ATYPE
, 
NULL
, 0));

414 
	`¶og
(
LOG_DEBUG
, "dst: %s",

415 
	`ruÀaddr2°rög
(&
ruÀ
.
d°
, 
ADDRINFO_PORT
 | 
ADDRINFO_ATYPE
, 
NULL
, 0));

417 #i‡
HAVE_SOCKS_HOSTID


418 i‡(
ruÀ
.
ho°id
.
©y≥
 !
SOCKS_ADDR_NOTSET
)

419 
	`¶og
(
LOG_DEBUG
, "hostindex: %d, hostid: %s",

420 
ruÀ
.
ho°ödex
, 
	`ruÀaddr2°rög
(&ruÀ.
ho°id
, 0, 
NULL
, 0));

423 
i
 = 0; i < 
ruÀ
.
sockë›ti⁄c
; ++i)

424 
	`¶og
(
LOG_DEBUG
, "socketoption %s (%s side)",

425 
	`sock›t2°rög
(&
ruÀ
.
sockë›ti⁄v
[
i
], 
NULL
, 0),

426 
ruÀ
.
sockë›ti⁄v
[
i
].
isöã∫Æside
 ? "internal" : "external");

428 
ruÀty≥
) {

429 
obje˘_¸uÀ
:

430 #i‡
BAREFOOTD


431 
	`¶og
(
LOG_DEBUG
, "bounceÅo: %s",

432 
	`ruÀaddr2°rög
(&
ruÀ
.
exåa
.
boun˚to
,

433 
ADDRINFO_PORT
 | 
ADDRINFO_ATYPE
,

434 
NULL
,

439 #i‡
HAVE_SOCKS_HOSTID


440 
obje˘_hruÀ
:

441 
	`SASSERTX
(
ruÀ
.
ho°id›ti⁄_is£t
);

442 
	`¶og
(
LOG_DEBUG
, "ho°ödex: %d", 
ruÀ
.
ho°ödex
);

446 #i‡
HAVE_SOCKS_RULES


447 
obje˘_§uÀ
:

452 
	`SERRX
(
ruÀty≥
);

456 i‡(
	`memcmp
(&
ruÀ
.
timeout
, &
sockscf
.timeout, (rule.timeout)) != 0)

457 
	`showtimeout
(&
ruÀ
.
timeout
);

459 i‡(
ruÀ
.
ud¥™ge
.
›
 =
ønge
)

460 
	`¶og
(
LOG_DEBUG
, "udpÖortÑange: %u - %u",

461 
	`¡ohs
(
ruÀ
.
ud¥™ge
.
°¨t
),Çtohs‘uÀ.ud¥™ge.
íd
));

463 i‡(
ruÀ
.
rdr_‰om
.
©y≥
 !
SOCKS_ADDR_NOTSET
)

464 
	`¶og
(
LOG_DEBUG
, "redirect from: %s",

465 
	`ruÀaddr2°rög
(&
ruÀ
.
rdr_‰om
,

466 
ADDRINFO_PORT
 | 
ADDRINFO_ATYPE
,

467 
NULL
,

470 i‡(
ruÀ
.
rdr_to
.
©y≥
 !
SOCKS_ADDR_NOTSET
)

471 
	`¶og
(
LOG_DEBUG
, "redirectÅo: %s",

472 
	`ruÀaddr2°rög
(&
ruÀ
.
rdr_to
, 
ADDRINFO_PORT
 | 
ADDRINFO_ATYPE
, 
NULL
, 0));

474 i‡(
	`sockd_shm©
(&
ruÀ
, 
SHMEM_ALL
) != 0)

475 
	`sw¨n
("%s: couldÇotáttachÅo shmem segments for %s #%lu",

476 
fun˘i⁄
, 
	`obje˘ty≥2°rög
(
ruÀ
.
ty≥
), (ÏuÀ.
numbî
);

478 i‡(
ruÀ
.
bw_shmid
 != 0) {

479 
	`SASSERTX
(
ruÀ
.
bw
 !
NULL
);

481 *
buf
 = 
NUL
;

482 
bufu£d
 = 0;

484 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

485 "bw_shmid: %lu\n", ()
ruÀ
.
bw_shmid
);

487 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

489 
ruÀ
.
bw_isöhîôabÀ
 ? "yes" : "no");

491 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

493 ()
ruÀ
.
bw
->
obje˘
.bw.
maxbps
);

495 
	`SASSERTX
(
bufu£d
 > 0);

496 
	`¶og
(
LOG_DEBUG
, "%s", 
buf
);

499 i‡(
ruÀ
.
ss_shmid
 != 0) {

500 
	`SASSERT
(
ruÀ
.
ss
 !
NULL
);

502 *
buf
 = 
NUL
;

503 
bufu£d
 = 0;

505 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

506 "ss_shmid: %lu\n", ()
ruÀ
.
ss_shmid
);

508 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

510 
ruÀ
.
ss_isöhîôabÀ
 ? "yes" : "no");

512 i‡(
ruÀ
.
ss
->
obje˘
.ss.
max_is£t
)

513 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

515 ()
ruÀ
.
ss
->
obje˘
.ss.
max
);

517 i‡(
ruÀ
.
ss
->
obje˘
.ss.
thrŸée_is£t
)

518 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

520 ()
ruÀ
.
ss
->
obje˘
.ss.
thrŸée
.
limô
.
˛õ¡s
,

521 
ruÀ
.
ss
->
obje˘
.ss.
thrŸée
.
limô
.
˛õ¡s
 == 1 ? "" : "s",

522 ()
ruÀ
.
ss
->
obje˘
.ss.
thrŸée
.
limô
.
£c⁄ds
);

524 i‡(
ruÀ
.
ss
->
key°©e
.
key
 !
key_un£t
) {

525 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

527 
	`°©ekey2°rög
(
ruÀ
.
ss
->
key°©e
.
key
));

529 i‡(
ruÀ
.
ss
->
key°©e
.
key
 =
key_ho°id
) {

530 
	`SASSERTX
(
ruÀ
.
ho°id›ti⁄_is£t
);

531 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused,

533 
ruÀ
.
ss
->
key°©e
.
keyöfo
.
ho°ödex
);

536 i‡(
ruÀ
.
ss
->
obje˘
.ss.
max_is£t
)

537 
bufu£d
 +=

538 
	`¢¥ötf
(&
buf
[
bufu£d
], (buf) - bufused,

540 ()
ruÀ
.
ss
->
obje˘
.ss.
max
);

542 i‡(
ruÀ
.
ss
->
obje˘
.ss.
thrŸée_≥r°©e_is£t
)

543 
bufu£d
 +=

544 
	`¢¥ötf
(&
buf
[
bufu£d
], (buf) - bufused,

546 ()
ruÀ
.
ss
->
obje˘
.ss.
thrŸée
.
limô
.
˛õ¡s
,

547 ()
ruÀ
.
ss
->
obje˘
.ss.
thrŸée
.
limô
.
£c⁄ds
);

550 
	`SASSERTX
(
bufu£d
 > 0);

551 
	`¶og
(
LOG_DEBUG
, "%s", 
buf
);

553 
	`sockd_shmdt
(&
ruÀ
, 
SHMEM_ALL
);

555 
	`showli°
(
ruÀ
.
u£r
, "user: ");

556 
	`showli°
(
ruÀ
.
group
, "group: ");

558 #i‡
HAVE_PAM


559 
	`¶og
(
LOG_DEBUG
, "∑m.£rvi˚«me: %s", 
ruÀ
.
°©e
.
∑m£rvi˚«me
);

562 #i‡
HAVE_BSDAUTH


563 
	`¶og
(
LOG_DEBUG
, "bsdauth.°yÀ«me: %s", 
ruÀ
.
°©e
.
bsdauth°yÀ«me
);

566 #i‡
HAVE_LDAP


567 
	`showli°
(
ruÀ
.
ld≠group
, "ldap.group: ");

568 i‡(
ruÀ
.
ld≠group
) {

569 i‡(*
ruÀ
.
°©e
.
ld≠
.
domaö
 !
NUL
)

570 
	`¶og
(
LOG_DEBUG
, "ld≠.domaö: %s",
ruÀ
.
°©e
.
ld≠
.
domaö
);

572 
	`¶og
(
LOG_DEBUG
, "ldap.auto.off: %s",

573 
ruÀ
.
°©e
.
ld≠
.
auto_off
 ? "yes" : "no");

574 #i‡
HAVE_OPENLDAP


575 
	`¶og
(
LOG_DEBUG
, "ld≠.debug: %d", 
ruÀ
.
°©e
.
ld≠
.
debug
);

577 
	`¶og
(
LOG_DEBUG
, "ldap.keeprealm: %s",

578 
ruÀ
.
°©e
.
ld≠
.
kì¥ólm
 ? "yes" : "no");

580 i‡(*
ruÀ
.
°©e
.
ld≠
.
keyèb
 !
NUL
)

581 
	`¶og
(
LOG_DEBUG
, "ld≠.keyèb: %s", 
ruÀ
.
°©e
.
ld≠
.
keyèb
);

583 
	`showli°
(
ruÀ
.
°©e
.
ld≠
.
ld≠uæ
, "ldap.url: ");

585 
	`showli°
(
ruÀ
.
°©e
.
ld≠
.
ld≠ba£dn
, "ldap.basedn: ");

587 i‡(*
ruÀ
.
°©e
.
ld≠
.
fûãr
 !
NUL
)

588 
	`¶og
(
LOG_DEBUG
, "ld≠.fûãr: %s", 
ruÀ
.
°©e
.
ld≠
.
fûãr
);

590 i‡(*
ruÀ
.
°©e
.
ld≠
.
fûãr_AD
 !
NUL
)

591 
	`¶og
(
LOG_DEBUG
, "ld≠.fûãr.ad: %s", 
ruÀ
.
°©e
.
ld≠
.
fûãr_AD
);

593 i‡(*
ruÀ
.
°©e
.
ld≠
.
©åibuã
 !
NUL
)

594 
	`¶og
(
LOG_DEBUG
, "ld≠.©åibuã: %s", 
ruÀ
.
°©e
.
ld≠
.
©åibuã
);

596 i‡(*
ruÀ
.
°©e
.
ld≠
.
©åibuã_AD
 !
NUL
)

597 
	`¶og
(
LOG_DEBUG
, "ldap.attribute.ad: %s",

598 
ruÀ
.
°©e
.
ld≠
.
©åibuã_AD
);

600 
	`¶og
(
LOG_DEBUG
, "ld≠.mdïth: %d", 
ruÀ
.
°©e
.
ld≠
.
mdïth
);

601 
	`¶og
(
LOG_DEBUG
, "ld≠.p‹t: %d", 
ruÀ
.
°©e
.
ld≠
.
p‹t
);

602 
	`¶og
(
LOG_DEBUG
, "ld≠.s¶: %s", 
ruÀ
.
°©e
.
ld≠
.
s¶
 ? "yes" : "no");

603 
	`¶og
(
LOG_DEBUG
, "ldap.certcheck: %s",

604 
ruÀ
.
°©e
.
ld≠
.
˚πcheck
 ? "yes" : "no");

606 i‡(*
ruÀ
.
°©e
.
ld≠
.
˚πfûe
 !
NUL
)

607 
	`¶og
(
LOG_DEBUG
, "ld≠.˚πfûe: %s", 
ruÀ
.
°©e
.
ld≠
.
˚πfûe
);

609 i‡(*
ruÀ
.
°©e
.
ld≠
.
˚π∑th
 !
NUL
)

610 
	`¶og
(
LOG_DEBUG
, "ld≠.˚π∑th: %s", 
ruÀ
.
°©e
.
ld≠
.
˚π∑th
);

614 
	`show°©e
(&
ruÀ
.
°©e
);

615 
	`showlog
(&
ruÀ
.
log
);

617 #i‡
HAVE_LIBWRAP


618 i‡(*
ruÀ
.
libwøp
 !
NUL
)

619 
	`¶og
(
LOG_DEBUG
, "libwøp: %s", 
ruÀ
.
libwøp
);

621 
	}
}

624 
	$ruÀ•îmô
(
s
, 
≥î
, 
loˇl
, 
˛õ¡auth
, 
§ˇuth
, 
m©ch
, 
°©e
,

625 
§c
, 
d°
, 
d°m©ched
, 
msg
, 
msgsize
)

626 
s
;

627 c⁄° 
sockaddr_°‹age
 *
≥î
;

628 c⁄° 
sockaddr_°‹age
 *
loˇl
;

629 c⁄° 
authmëhod_t
 *
˛õ¡auth
;

630 
authmëhod_t
 *
§ˇuth
;

631 
ruÀ_t
 *
m©ch
;

632 
c⁄√˘i⁄°©e_t
 *
°©e
;

633 c⁄° 
socksho°_t
 *
§c
;

634 c⁄° 
socksho°_t
 *
d°
;

635 
socksho°_t
 *
d°m©ched
;

636 *
msg
;

637 
size_t
 
msgsize
;

639 c⁄° *
fun˘i⁄
 = "rulespermit()";

640 
öô
;

641 
ruÀ_t
 
de‰uÀ
;

642 
ruÀ_t
 *
ruÀ
;

643 
obje˘ty≥_t
 
ruÀty≥
;

644 
authmëhod_t
 
ﬁdauth
;

645 
socksho°_t
 
d°m©ched_mem
;

646 #i‡
HAVE_LIBWRAP


647 
ªque°_öfo
 
libwø¥eque°
;

648 
sockaddr_°‹age
 
_loˇl
, 
_≥î
;

649 
libwøpöôed
 = 0;

651 
i§ïlycomm™d
;

652 
§c°r
[
MAXSOCKSHOSTSTRING
], 
d°°r
[MAXSOCKSHOSTSTRING],

653 
l°r
[
MAXSOCKADDRSTRING
], 
p°r
[MAXSOCKADDRSTRING];

655 i‡(
d°m©ched
 =
NULL
)

656 
d°m©ched
 = &
d°m©ched_mem
;

658 i‡(
s
 != -1) {

659 
	`SASSERTX
(
loˇl
 !
NULL
);

660 
	`SASSERTX
(
≥î
 !
NULL
);

662 #i‡
HAVE_LIBWRAP


663 
	`sockaddr˝y
(&
_loˇl
, 
loˇl
, 
	`ßÀn
÷oˇl->
ss_Ámûy
));

664 
	`sockaddr˝y
(&
_≥î
, 
≥î
, 
	`ßÀn
’ìr->
ss_Ámûy
));

668 
	`SASSERTX
(
§ˇuth
 !
NULL
);

670 
	`¶og
(
LOG_DEBUG
,

673 
fun˘i⁄
,

674 
§c
 =
NULL
 ? "N/A" : 
	`socksho°2°rög
(§c, 
§c°r
, (srcstr)),

675 
d°
 =
NULL
 ? "N/A" : 
	`socksho°2°rög
(d°, 
d°°r
, (dststr)),

676 
˛õ¡auth
 =
NULL
 ? "N/A" : 
	`mëhod2°rög
(˛õ¡auth->
mëhod
),

677 
	`mëhod2°rög
(
§ˇuth
->
mëhod
),

678 
	`comm™d2°rög
(
°©e
->
comm™d
),

679 
s
,

680 
≥î
 =
NULL
 ? "N/A" : 
	`sockaddr2°rög
’ìr, 
p°r
, (pstr)),

681 
loˇl
 =
NULL
 ? "N/A" : 
	`sockaddr2°rög
÷oˇl, 
l°r
, (lstr)));

683 i‡(
msgsize
 > 0)

684 *
msg
 = 
NUL
;

687 i‡(!
öô
) {

688 
	`bzîo
(&
de‰uÀ
, (defrule));

690 
de‰uÀ
.
vîdi˘
 = 
VERDICT_BLOCK
;

691 
de‰uÀ
.
§c
.
©y≥
 = 
SOCKS_ADDR_IPVANY
;

693 
de‰uÀ
.
d°
 = de‰uÀ.
§c
;

695 #i‡
BAREFOOTD


696 
de‰uÀ
.
exåa
.
boun˚to
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

699 i‡(
sockscf
.
›ti⁄
.
debug
) {

700 
de‰uÀ
.
log
.
c⁄√˘
 = 1;

701 
de‰uÀ
.
log
.
disc⁄√˘
 = 1;

702 
de‰uÀ
.
log
.
îr‹
 = 1;

703 
de‰uÀ
.
log
.
io›î©i⁄
 = 1;

706 
	`mem£t
(&
de‰uÀ
.
°©e
.
comm™d
, 
UCHAR_MAX
, (defrule.state.command));

708 
	`mem£t
(&
de‰uÀ
.
°©e
.
¥Ÿocﬁ
,

709 
UCHAR_MAX
,

710 (
de‰uÀ
.
°©e
.
¥Ÿocﬁ
));

712 
	`mem£t
(&
de‰uÀ
.
°©e
.
¥oxy¥Ÿocﬁ
,

713 
UCHAR_MAX
,

714 (
de‰uÀ
.
°©e
.
¥oxy¥Ÿocﬁ
));

716 
öô
 = 1;

722 
°©e
->
comm™d
) {

723 
SOCKS_ACCEPT
:

724 
SOCKS_BOUNCETO
:

725 
ruÀty≥
 = 
obje˘_¸uÀ
;

726 
ruÀ
 = 
sockscf
.
¸uÀ
;

729 #i‡
HAVE_SOCKS_HOSTID


730 
SOCKS_HOSTID
:

731 
ruÀty≥
 = 
obje˘_hruÀ
;

732 
ruÀ
 = 
sockscf
.
hruÀ
;

737 
ruÀty≥
 = 
obje˘_§uÀ
;

738 
ruÀ
 = 
sockscf
.
§uÀ
;

743 #i‡
HAVE_LIBWRAP


744 i‡(
s
 !-1 && 
sockscf
.
›ti⁄
.
ho°s_ac˚ss
) {

745 
	`libwøpöô
(
s
, &
_loˇl
, &
_≥î
, &
libwø¥eque°
);

746 
libwøpöôed
 = 1;

748 i‡(
	`libwøp_ho°s_ac˚ss
(&
libwø¥eque°
, 
≥î
) == 0) {

749 
	`¢¥ötf
(
msg
, 
msgsize
, "blocked byÜibwrap/tcp_wrappers");

751 *
m©ch
 = 
de‰uÀ
;

752 
m©ch
->
ty≥
 = 
ruÀty≥
;

759 i‡(
°©e
->
exãnsi⁄
.
böd
 && !
sockscf
.extension.bind) {

760 
	`¢¥ötf
(
msg
, 
msgsize
, "clientÑequested disabled DanteÉxtension: bind");

762 *
m©ch
 = 
de‰uÀ
;

763 
m©ch
->
ty≥
 = 
ruÀty≥
;

768 #i‡
HAVE_SOCKS_HOSTID


769 i‡(
ruÀty≥
 =
obje˘_¸uÀ
) {

774 i‡(
s
 == -1)

775 
	`HOSTIDZERO
(
°©e
);

777 
	`SASSERTX
(
≥î
 !
NULL
);

779 
°©e
->
ho°idc
 = 
	`gësockëho°id
(
s
,

780 
	`ELEMENTS
(
°©e
->
ho°idv
),

781 
°©e
->
ho°idv
);

783 
	`¶og
(
LOG_DEBUG
, "%s:Ñetrieved %u hostids on connection from %s",

784 
fun˘i⁄
,

785 ()
°©e
->
ho°idc
,

786 
	`sockaddr2°rög
(
≥î
, 
NULL
, 0));

790 i‡(
ruÀty≥
 =
obje˘_hruÀ
 && 
°©e
->
ho°idc
 == 0 ) {

791 
	`SASSERTX
(
sockscf
.
hruÀ
 !
NULL
);

793 
	`¶og
(
LOG_DEBUG
,

796 
fun˘i⁄
, 
	`obje˘ty≥2°rög
(
ruÀty≥
), objecttype2string(ruletype));

798 *
m©ch
 = 
de‰uÀ
;

799 
m©ch
->
ty≥
 = 
ruÀty≥
;

800 
m©ch
->
vîdi˘
 = 
VERDICT_PASS
;

806 i‡(
°©e
->
comm™d
 =
SOCKS_BINDREPLY


807 || 
°©e
->
comm™d
 =
SOCKS_UDPREPLY
)

808 
i§ïlycomm™d
 = 1;

810 
i§ïlycomm™d
 = 0;

815 
ﬁdauth
 = *
§ˇuth
;

816 
ruÀ
 !
NULL
;

817 
ruÀ
 =ÑuÀ->
√xt
, *
§ˇuth
 = 
ﬁdauth
) {

818 
size_t
 
mëhodc
;

819 *
mëhodv
;

820 
size_t
 
i
;

822 
	`¶og
(
LOG_DEBUG
,

824 
fun˘i⁄
,

825 
	`obje˘ty≥2°rög
(
ruÀty≥
),

826 ()
ruÀ
->
numbî
,

827 
	`vîdi˘2°rög
(
ruÀ
->
vîdi˘
));

829 i‡(!
	`¥Ÿocﬁ_m©ches
(
°©e
->
¥Ÿocﬁ
, &
ruÀ
->state.protocol))

832 i‡(!
	`comm™d_m©ches
(
°©e
->
comm™d
, &
ruÀ
->state.command))

836 i‡(
ruÀty≥
 =
obje˘_§uÀ
) {

837 i‡(!
	`¥oxy¥Ÿocﬁ_m©ches
(
°©e
->
¥oxy¥Ÿocﬁ
,

838 &
ruÀ
->
°©e
.
¥oxy¥Ÿocﬁ
))

842 #i‡
HAVE_SOCKS_HOSTID


843 i‡(
ruÀ
->
ho°id
.
©y≥
 !
SOCKS_ADDR_NOTSET
) {

844 
	`¶og
(
LOG_DEBUG
, "%s:Ñule %luÑequires hostidÅo beÖresent onÅhe "

846 
fun˘i⁄
,

847 ()
ruÀ
->
numbî
);

849 i‡(!
	`ho°idm©ches
(
°©e
->
ho°idc
,

850 
°©e
->
ho°idv
,

851 
ruÀ
->
ho°ödex
,

852 &
ruÀ
->
ho°id
,

853 
ruÀty≥
,

854 
ruÀ
->
numbî
))

873 i‡(
§c
 !
NULL
) {

874 #i‡
HAVE_SOCKS_HOSTID


875 i‡(
ruÀty≥
 =
obje˘_hruÀ
) {

876 
	`¶og
(
LOG_DEBUG
, "%s: checkingágainst hostidsÑatherÅhan "

878 
fun˘i⁄
, 
	`socksho°2°rög
(
§c
, 
NULL
, 0));

880 i‡(!
	`ho°idm©ches
(
°©e
->
ho°idc
,

881 
°©e
->
ho°idv
,

882 
ruÀ
->
ho°ödex
,

883 &
ruÀ
->
§c
,

884 
ruÀty≥
,

885 
ruÀ
->
numbî
))

890 i‡(!
	`addrm©ch
(&
ruÀ
->
§c
, src, 
NULL
, 
°©e
->
¥Ÿocﬁ
, 0))

894 i‡(
ruÀ
->
vîdi˘
 =
VERDICT_BLOCK
)

897 i‡(
d°
 !
NULL
) {

898 i‡(!
	`addrm©ch
(&
ruÀ
->
d°
, d°, 
d°m©ched
, 
°©e
->
¥Ÿocﬁ
, 0))

902 i‡(
ruÀ
->
vîdi˘
 =
VERDICT_BLOCK
) {

911 c⁄° 
d°m©cheßŒ


912 
	`ruÀaddr_m©ches_Æl_exã∫Æ
(&
ruÀ
->
d°
, 
°©e
->
¥Ÿocﬁ
);

914 
	`¶og
(
LOG_DEBUG
,

918 
fun˘i⁄
,

919 
	`ruÀaddr2°rög
(&
ruÀ
->
d°
,

920 
ADDRINFO_PORT
 | 
ADDRINFO_ATYPE
,

921 
NULL
,

923 
d°m©cheßŒ
 ? "isÇot" : "is",

924 
d°m©cheßŒ
 ? "can" : "canÇot");

926 i‡(
d°m©cheßŒ
) {

927 
	`SASSERTX
(
§c
 !
NULL
);

950 
ruÀty≥
) {

951 
obje˘_¸uÀ
:

952 #i‡
HAVE_SOCKS_HOSTID


953 
obje˘_hruÀ
:

955 
mëhodv
 = 
ruÀ
->
°©e
.
cmëhodv
;

956 
mëhodc
 = 
ruÀ
->
°©e
.
cmëhodc
;

959 
obje˘_§uÀ
:

960 i‡(
i§ïlycomm™d
) {

961 
	`SASSERTX
(
˛õ¡auth
 =
NULL
);

963 
	`¶og
(
LOG_DEBUG
,

965 
fun˘i⁄
);

968 
	`SASSERTX
(
˛õ¡auth
 !
NULL
);

969 
	`SASSERTX
(
˛õ¡auth
->
mëhod
 !
AUTHMETHOD_NOTSET
);

971 i‡(!
	`mëhodis£t
(
˛õ¡auth
->
mëhod
,

972 
ruÀ
->
°©e
.
cmëhodv
,

973 
ruÀ
->
°©e
.
cmëhodc
)) {

974 
	`¶og
(
LOG_DEBUG
,

977 
fun˘i⁄
, 
	`mëhod2°rög
(
˛õ¡auth
->
mëhod
));

983 
mëhodv
 = 
ruÀ
->
°©e
.
smëhodv
;

984 
mëhodc
 = 
ruÀ
->
°©e
.
smëhodc
;

988 
	`SERRX
(
obje˘_§uÀ
);

996 i‡(
i§ïlycomm™d
 && !
sockscf
.
§cho°
.
checkª∂yauth
) {

1000 
§ˇuth
->
mëhod
 = 
AUTHMETHOD_NONE
;

1002 i‡(!
	`mëhodis£t
(
§ˇuth
->
mëhod
, 
mëhodv
, 
mëhodc
)) {

1031 
size_t
 
mëhodischeckabÀ
 = 0;

1038 
i
 = 0; i < 
mëhodc
; ++i) {

1039 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1040 
	`¶og
(
LOG_DEBUG
, "%s:Ço match yet for method %s, command %s",

1041 
fun˘i⁄
,

1042 
	`mëhod2°rög
(
mëhodv
[
i
]),

1043 
	`comm™d2°rög
(
°©e
->
comm™d
));

1045 
mëhodv
[
i
]) {

1046 
AUTHMETHOD_NONE
:

1053 i‡(
§ˇuth
->
mëhod
 =
AUTHMETHOD_NOTSET
)

1054 
mëhodischeckabÀ
 = 1;

1058 #i‡
HAVE_LIBWRAP


1059 
AUTHMETHOD_RFC931
: {

1066 c⁄° *
evÆedu£r
;

1068 i‡(
˛õ¡auth
 !
NULL


1069 && 
˛õ¡auth
->
mëhod
 =
AUTHMETHOD_RFC931
) {

1070 
	`¶og
(
LOG_DEBUG
,

1075 
fun˘i⁄
,

1076 
	`mëhod2°rög
(
mëhodv
[
i
]),

1077 
˛õ¡auth
->
md©a
.
rfc931
.
«me
);

1079 
§ˇuth
->
md©a
.
rfc931
 = 
˛õ¡auth
->mdata.rfc931;

1087 
î∫o_s
 = 
î∫o
;

1089 #i‡!
HAVE_CONTROL_CONNECTION


1090 i‡(
°©e
->
¥Ÿocﬁ
 =
SOCKS_UDP
)

1094 i‡(!
libwøpöôed
) {

1095 
	`libwøpöô
(
s
,

1096 &
_loˇl
,

1097 &
_≥î
,

1098 &
libwø¥eque°
);

1100 
libwøpöôed
 = 1;

1103 i‡(
î∫o
 !0 &&Éºnÿ!
î∫o_s
) {

1104 
	`¶og
(
LOG_DEBUG
,

1106 
fun˘i⁄
, 
î∫o
, 
	`°ªº‹
(errno));

1108 
î∫o
 = 
î∫o_s
 = 0;

1111 
	`SASSERTX
(
≥î
 !
NULL
);

1113 
	`¶og
(
LOG_DEBUG
, "%s:ÅryingÅo getÑfc931Çame for %s",

1114 
fun˘i⁄
, 
	`sockaddr2°rög
(
≥î
, 
NULL
, 0));

1116 i‡((
evÆedu£r
 = 
	`evÆ_u£r
(&
libwø¥eque°
)Ë=
NULL
) {

1117 
	`¶og
(
LOG_DEBUG
, "%s:Éval_user() failed: %s",

1118 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

1120 i‡(
î∫o
 !0 &&Éºnÿ!
î∫o_s
)

1121 
î∫o
 = 0;

1126 
	`°∫˝y
((*)
§ˇuth
->
md©a
.
rfc931
.
«me
,

1127 
evÆedu£r
,

1128 (
§ˇuth
->
md©a
.
rfc931
.
«me
) - 1);

1130 i‡(
î∫o
 !0 &&Éºnÿ!
î∫o_s
) {

1131 
	`¶og
(
LOG_DEBUG
,

1133 
fun˘i⁄
, 
î∫o
, 
	`°ªº‹
(errno));

1135 
î∫o
 = 0;

1139 i‡(
	`°rcmp
((*)
§ˇuth
->
md©a
.
rfc931
.
«me
,

1140 
STRING_UNKNOWN
) == 0) {

1141 *
§ˇuth
->
md©a
.
rfc931
.
«me
 = 
NUL
;

1142 
	`¶og
(
LOG_DEBUG
, "%s:Çÿrfc931Çame", 
fun˘i⁄
);

1144 i‡(
§ˇuth
->
md©a
.
rfc931
.
«me
[

1145 (
§ˇuth
->
md©a
.
rfc931
.
«me
Ë- 1] !
NUL
) {

1147 
§ˇuth
->
md©a
.
rfc931
.
«me
[

1148 (
§ˇuth
->
md©a
.
rfc931
.
«me
Ë- 1] = 
NUL
;

1150 
	`¶og
(
LOG_NOTICE
,

1153 
fun˘i⁄
,

1154 
§ˇuth
->
md©a
.
rfc931
.
«me
,

1155 
	`sockaddr2°rög
(
≥î
, 
NULL
, 0),

1157 ((
§ˇuth
->
md©a
.
rfc931
.
«me
) - 1));

1159 *
§ˇuth
->
md©a
.
rfc931
.
«me
 = 
NUL
;

1162 
	`¶og
(
LOG_DEBUG
, "%s:ÑeceivedÑfc931Çame \"%s\"",

1163 
fun˘i⁄
, 
§ˇuth
->
md©a
.
rfc931
.
«me
);

1166 i‡(*
§ˇuth
->
md©a
.
rfc931
.
«me
 !
NUL
)

1167 
mëhodischeckabÀ
 = 1;

1172 #i‡
HAVE_PAM


1173 
AUTHMETHOD_PAM_ANY
:

1174 
AUTHMETHOD_PAM_ADDRESS
:

1175 
AUTHMETHOD_PAM_USERNAME
: {

1181 
§ˇuth
->
mëhod
) {

1182 
AUTHMETHOD_UNAME
: {

1187 c⁄° 
authmëhod_u«me_t
 
u«me
 = 
§ˇuth
->
md©a
.uname;

1189 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
∑m
.
«me
, 
u«me
.name);

1191 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
∑m
.
∑ssw‹d
,

1192 
u«me
.
∑ssw‹d
);

1194 
mëhodischeckabÀ
 = 1;

1198 #i‡
HAVE_BSDAUTH


1199 
AUTHMETHOD_BSDAUTH
: {

1200 c⁄° 
authmëhod_bsd_t
 
bsd
 = 
§ˇuth
->
md©a
.bsd;

1202 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
∑m
.
«me
, 
bsd
.name);

1204 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
∑m
.
∑ssw‹d
,

1205 
bsd
.
∑ssw‹d
);

1207 
mëhodischeckabÀ
 = 1;

1212 #i‡
HAVE_LIBWRAP


1213 
AUTHMETHOD_RFC931
: {

1219 c⁄° 
authmëhod_rfc931_t
 
rfc931


1220 
§ˇuth
->
md©a
.
rfc931
;

1223 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
∑m
.
«me
,

1224 
rfc931
.
«me
);

1226 *
§ˇuth
->
md©a
.
∑m
.
∑ssw‹d
 = 
NUL
;

1228 
mëhodischeckabÀ
 = 1;

1233 
AUTHMETHOD_NOTSET
:

1234 
AUTHMETHOD_NONE
:

1235 i‡(
mëhodv
[
i
] =
AUTHMETHOD_PAM_ANY


1236 || 
mëhodv
[
i
] =
AUTHMETHOD_PAM_ADDRESS
) {

1237 *
§ˇuth
->
md©a
.
∑m
.
«me
 = 
NUL
;

1238 *
§ˇuth
->
md©a
.
∑m
.
∑ssw‹d
 = 
NUL
;

1240 
mëhodischeckabÀ
 = 1;

1246 i‡(
mëhodischeckabÀ
)

1247 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
∑m
.
£rvi˚«me
,

1248 
ruÀ
->
°©e
.
∑m£rvi˚«me
);

1254 #i‡
HAVE_BSDAUTH


1255 
AUTHMETHOD_BSDAUTH
: {

1261 
§ˇuth
->
mëhod
) {

1262 
AUTHMETHOD_UNAME
: {

1263 c⁄° 
authmëhod_u«me_t
 
u«me


1264 
§ˇuth
->
md©a
.
u«me
;

1266 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
bsd
.
«me
, 
u«me
.name);

1268 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
bsd
.
∑ssw‹d
,

1269 
u«me
.
∑ssw‹d
);

1271 
mëhodischeckabÀ
 = 1;

1275 #i‡
HAVE_PAM


1276 
AUTHMETHOD_PAM_USERNAME
: {

1277 c⁄° 
authmëhod_∑m_t
 
∑m


1278 
§ˇuth
->
md©a
.
u«me
;

1280 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
bsd
.
«me
,

1281 
∑m
.
«me
);

1283 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
bsd
.
∑ssw‹d
,

1284 
∑m
.
∑ssw‹d
);

1286 
mëhodischeckabÀ
 = 1;

1291 #i‡
HAVE_LIBWRAP


1292 
AUTHMETHOD_RFC931
: {

1293 c⁄° 
authmëhod_rfc931_t
 
rfc931


1294 
§ˇuth
->
md©a
.
rfc931
;

1296 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
bsd
.
«me
,

1297 
rfc931
.
«me
);

1299 *
§ˇuth
->
md©a
.
bsd
.
∑ssw‹d
 = 
NUL
;

1301 
mëhodischeckabÀ
 = 1;

1307 i‡(
mëhodischeckabÀ
)

1308 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
bsd
.
°yÀ
,

1309 
ruÀ
->
°©e
.
bsdauth°yÀ«me
);

1315 #i‡
SOCKS_SERVER


1316 #i‡
HAVE_GSSAPI


1317 
AUTHMETHOD_GSSAPI
: {

1324 i‡(
°©e
->
comm™d
 !
SOCKS_ACCEPT
)

1327 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
gsßpi
.
£rvi˚«me
,

1328 
ruÀ
->
°©e
.
gsßpi£rvi˚«me
);

1330 
	`STRCPY_ASSERTSIZE
(
§ˇuth
->
md©a
.
gsßpi
.
keyèb
,

1331 
ruÀ
->
°©e
.
gsßpikeyèb
);

1333 
§ˇuth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
√c


1334 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
√c
;

1336 
§ˇuth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
˛ór


1337 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
˛ór
;

1339 
§ˇuth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
öãgrôy


1340 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
;

1342 
§ˇuth
->
md©a
.
gsßpi
.
í¸y±i⁄
.
c⁄fidítülôy


1343 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
;

1345 
mëhodischeckabÀ
 = 1;

1352 i‡(
mëhodischeckabÀ
) {

1353 
	`¶og
(
LOG_DEBUG
, "%s: changingáuthmethod from %dÅo %d",

1354 
fun˘i⁄
, 
§ˇuth
->
mëhod
, 
mëhodv
[
i
]);

1356 
§ˇuth
->
mëhod
 = 
mëhodv
[
i
];

1361 i‡(
i
 =
mëhodc
) {

1362 #i‡
COVENANT


1369 i‡(
mëhodc
 > 0) {

1370 
m©ch
->
vîdi˘
 = 
VERDICT_BLOCK
;

1371 
m©ch
->
whyblock
.
missög¥oxyauth
 = 1;

1372 
	`SHMEM_CLEAR
(
m©ch
, 
SHMEM_ALL
, 1);

1374 
	`SASSERTX
(!
	`SHMID_ISATTACHED
(
m©ch
));

1388 
	`SASSERTX
(
i§ïlycomm™d


1389 || 
°©e
->
comm™d
 =
SOCKS_HOSTID


1390 || 
	`mëhodis£t
(
§ˇuth
->
mëhod
, 
mëhodv
, 
mëhodc
));

1392 i‡(
§ˇuth
->
mëhod
 !
AUTHMETHOD_NONE
 && 
ruÀ
->
u£r
 !
NULL
) {

1396 i‡(!
	`u£rm©ch
(
§ˇuth
, 
ruÀ
->
u£r
)) {

1397 
	`¶og
(
LOG_DEBUG
,

1399 
fun˘i⁄
,

1400 
	`auth«me
(
§ˇuth
Ë=
NULL
 ? "<null>" :áuthname(srcauth),

1401 ()
ruÀ
->
numbî
,

1402 
	`comm™d2°rög
(
°©e
->
comm™d
));

1408 i‡(
§ˇuth
->
mëhod
 !
AUTHMETHOD_NONE
 && 
ruÀ
->
group
 !
NULL
) {

1412 i‡(!
	`groupm©ch
(
§ˇuth
, 
ruÀ
->
group
)) {

1413 
	`¶og
(
LOG_DEBUG
,

1415 
fun˘i⁄
,

1416 
	`auth«me
(
§ˇuth
Ë=
NULL
 ? "<null>" :áuthname(srcauth),

1417 ()
ruÀ
->
numbî
,

1418 
	`comm™d2°rög
(
°©e
->
comm™d
));

1424 #i‡
HAVE_LDAP


1426 i‡(
§ˇuth
->
mëhod
 !
AUTHMETHOD_NONE
 && 
ruÀ
->
ld≠group
 !
NULL
) {

1427 i‡(!
	`ld≠groupm©ch
(
§ˇuth
, (c⁄° 
ruÀ_t
 *)
ruÀ
)) {

1428 
	`¶og
(
LOG_DEBUG
,

1430 
fun˘i⁄
,

1431 
	`auth«me
(
§ˇuth
Ë=
NULL
 ? "<null>" :áuthname(srcauth),

1432 ()
ruÀ
->
numbî
,

1433 
	`comm™d2°rög
(
°©e
->
comm™d
));

1446 i‡(!
	`ac˚sscheck
(
s
, 
§ˇuth
, 
≥î
, 
loˇl
, 
msg
, 
msgsize
)) {

1447 *
m©ch
 = *
ruÀ
;

1449 
m©ch
->
vîdi˘
 = 
VERDICT_BLOCK
;

1450 
	`SHMEM_CLEAR
(
m©ch
, 
SHMEM_ALL
, 1);

1458 i‡(
ruÀ
 =
NULL
) {

1459 
buf
[1024];

1461 i‡(
msg
 =
NULL
 || 
msgsize
 == 0) {

1462 
msg
 = 
buf
;

1463 
msgsize
 = (
buf
);

1466 
	`¢¥ötf
(
msg
, 
msgsize
, "noÑules matched; using default blockÑule");

1468 *
m©ch
 = 
de‰uÀ
;

1469 
m©ch
->
ty≥
 = 
ruÀty≥
;

1472 *
m©ch
 = *
ruÀ
;

1474 
	`¶og
(
LOG_DEBUG
, "%s:Ñule matched: %lu (%s), verdict %s",

1475 
fun˘i⁄
,

1476 ()
m©ch
->
numbî
,

1477 
	`obje˘ty≥2°rög
(
m©ch
->
ty≥
),

1478 
	`vîdi˘2°rög
(
m©ch
->
vîdi˘
));

1484 i‡(
m©ch
->
vîdi˘
 =
VERDICT_PASS
 && 
≥î
 !
NULL
)

1485 i‡(!
	`§cho°_isok
(
≥î
, 
msg
, 
msgsize
)) {

1486 
m©ch
->
vîdi˘
 = 
VERDICT_BLOCK
;

1487 
	`SHMEM_CLEAR
(
m©ch
, 
SHMEM_ALL
, 1);

1492 #i‡
HAVE_LIBWRAP


1493 i‡(
s
 !-1 && *
m©ch
->
libwøp
 !
NUL
) {

1494 
libwøpcmd
[
LIBWRAPBUF
];

1495 
î∫o_¥e
, 
î∫o_po°
;

1497 i‡(!
libwøpöôed
)

1498 
	`libwøpöô
(
s
, &
_loˇl
, &
_≥î
, &
libwø¥eque°
);

1501 
	`STRCPY_ASSERTSIZE
(
libwøpcmd
, 
m©ch
->
libwøp
);

1504 i‡(
	`£tjmp
(
t˝d_buf
) != 0) {

1505 
	`sockd_¥iv
(
SOCKD_PRIV_LIBWRAP
, 
PRIV_OFF
);

1507 
	`sw¨nx
("%s: faûedÜibwø∞löe: \"%s\"", 
fun˘i⁄
, 
libwøpcmd
);

1509 
m©ch
->
vîdi˘
 = 
VERDICT_BLOCK
;

1510 
	`SHMEM_CLEAR
(
m©ch
, 
SHMEM_ALL
, 1);

1515 
	`¶og
(
LOG_DEBUG
, "%s:ÉxecutingÜibwrap command: \"%s\"",

1516 
fun˘i⁄
, 
libwøpcmd
);

1518 
	`sockd_¥iv
(
SOCKD_PRIV_LIBWRAP
, 
PRIV_ON
);

1519 
î∫o_¥e
 = 
î∫o
;

1520 
î∫o
 = 0;

1521 
	`¥o˚ss_›ti⁄s
(
libwøpcmd
, &
libwø¥eque°
);

1522 
î∫o_po°
 = 
î∫o
;

1523 
	`sockd_¥iv
(
SOCKD_PRIV_LIBWRAP
, 
PRIV_OFF
);

1525 i‡(
î∫o_po°
 != 0)

1526 
	`¶og
(
LOG_INFO
,

1528 
fun˘i⁄
, 
	`°ªº‹
(
î∫o_po°
));

1529 
î∫o
 = 
î∫o_¥e
;

1531 i‡(
m©ch
->
vîdi˘
 =
VERDICT_BLOCK


1532 && 
	`°r°r
(
m©ch
->
libwøp
, "b™√r†"Ë!
NULL
) {

1548 
buf
[1024];

1549 
ssize_t
 
p
;

1551 (
p
 = 
	`ªad
(
s
, 
buf
, (buf))) > 0)

1552 
	`¶og
(
LOG_DEBUG
, "%s:Ñeadingánd discarding %ld bytes from blocked "

1554 
fun˘i⁄
, ()
p
);

1559 i‡(
m©ch
->
vîdi˘
 =
VERDICT_BLOCK
)

1560 
	`SHMEM_CLEAR
(
m©ch
, 
SHMEM_ALL
, 1);

1562 i‡(
sockscf
.
m⁄ô‹
 !
NULL
) {

1563 i‡(
§c
 !
NULL
) {

1564 c⁄° 
m⁄ô‹_t
 *
m⁄ô‹
;

1566 
	`SASSERTX
(
m©ch
->
m°©s
 =
NULL
);

1567 
	`SASSERTX
(
m©ch
->
m°©s_shmid
 == 0);

1569 i‡((
m⁄ô‹
 = 
	`m⁄ô‹m©ch
(
§c
,

1570 
d°
,

1571 
§ˇuth
,

1572 
°©e
)Ë!
NULL
) {

1573 
	`¶og
(
LOG_DEBUG
, "%s: matched monitor #%lu, mstats_shmid = %lu",

1574 
fun˘i⁄
,

1575 ()
m⁄ô‹
->
numbî
,

1576 ()
m⁄ô‹
->
m°©s_shmid
);

1578 
	`SASSERTX
(
m⁄ô‹
->
m°©s
 =
NULL
);

1580 
	`COPY_MONITORFIELDS
(
m⁄ô‹
, 
m©ch
);

1586 
	`SASSERTX
(!
	`SHMID_ISATTACHED
(
m©ch
));

1588  
m©ch
->
vîdi˘
 =
VERDICT_PASS
;

1589 
	}
}

1592 
	$comm™d_m©ches
(
comm™d
, 
comm™ds
)

1593 c⁄° 
comm™d
;

1594 c⁄° 
comm™d_t
 *
comm™ds
;

1596 
comm™d
) {

1598 
SOCKS_ACCEPT
:

1599 
SOCKS_BOUNCETO
:

1603 
SOCKS_HOSTID
:

1607 
SOCKS_BIND
:

1608 i‡(
comm™ds
->
böd
)

1613 
SOCKS_CONNECT
:

1614 i‡(
comm™ds
->
c⁄√˘
)

1619 
SOCKS_UDPASSOCIATE
:

1620 i‡(
comm™ds
->
ud∑ssocüã
)

1629 
SOCKS_BINDREPLY
:

1630 i‡(
comm™ds
->
bödª∂y
)

1635 
SOCKS_UDPREPLY
:

1636 i‡(
comm™ds
->
ud¥ïly
)

1642 
	`SERRX
(
comm™d
);

1644 
	}
}

1647 
	$¥Ÿocﬁ_m©ches
(
¥Ÿocﬁ
, 
¥Ÿocﬁs
)

1648 c⁄° 
¥Ÿocﬁ
;

1649 c⁄° 
¥Ÿocﬁ_t
 *
¥Ÿocﬁs
;

1651 
¥Ÿocﬁ
) {

1652 
SOCKS_TCP
:

1653 i‡(
¥Ÿocﬁs
->
t˝
)

1658 
SOCKS_UDP
:

1659 i‡(
¥Ÿocﬁs
->
udp
)

1665 
	`SERRX
(
¥Ÿocﬁ
);

1667 
	}
}

1670 
	$¥oxy¥Ÿocﬁ_m©ches
(
¥Ÿocﬁ
, 
¥Ÿocﬁs
)

1671 c⁄° 
¥Ÿocﬁ
;

1672 c⁄° 
¥oxy¥Ÿocﬁ_t
 *
¥Ÿocﬁs
;

1675 
¥Ÿocﬁ
) {

1676 
PROXY_SOCKS_V4
:

1677 i‡(
¥Ÿocﬁs
->
socks_v4
)

1682 
PROXY_SOCKS_V5
:

1683 i‡(
¥Ÿocﬁs
->
socks_v5
)

1688 
PROXY_HTTP_10
:

1689 
PROXY_HTTP_11
:

1690 i‡(
¥Ÿocﬁs
->
hâp
)

1696 
	`SERRX
(
¥Ÿocﬁ
);

1698 
	}
}

1701 
	$showli°
(
li°
, 
¥efix
)

1702 c⁄° 
löked«me_t
 *
li°
;

1703 c⁄° *
¥efix
;

1705 
buf
[10240];

1707 
	`li°2°rög
(
li°
, 
buf
, (buf));

1708 i‡(
	`°æí
(
buf
) > 0)

1709 
	`¶og
(
LOG_DEBUG
, "%s%s", 
¥efix
, 
buf
);

1710 
	}
}

1713 
	$ruÀªquúes
(
ruÀ
, 
wh©
)

1714 c⁄° 
ruÀ_t
 *
ruÀ
;

1715 c⁄° 
mëhodöfo_t
 
wh©
;

1717 c⁄° *
fun˘i⁄
 = "rulerequires()";

1718 
rc
;

1720 
wh©
) {

1721 
u£∫ame
:

1722 i‡(
ruÀ
->
u£r
 !
NULL


1723 || 
ruÀ
->
group
 !
NULL


1724 #i‡
HAVE_LDAP


1725 || 
ruÀ
->
ld≠group
 !
NULL


1726 || 
ruÀ
->
ld≠£âögs‰omu£r


1729 
rc
 = 1;

1731 
rc
 =0;

1736 
	`SERRX
(
wh©
);

1739 
	`¶og
(
LOG_DEBUG
, "%s: %s: %luÑequires %d: %s",

1740 
fun˘i⁄
,

1741 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

1742 ()
ruÀ
->
numbî
,

1743 ()
wh©
,

1744 
rc
 == 1 ? "yes" : "no");

1746  
rc
;

1747 
	}
}

1750 
	$ruÀ_öhîô‹u£
(
‰om
, 
cöfo_‰om
, 
to
, 
cöfo_to
, 
sidesc⁄√˘ed
, 
emsg
, 
emsgÀn
)

1751 
ruÀ_t
 *
‰om
;

1752 c⁄° 
˛õ¡öfo_t
 *
cöfo_‰om
;

1753 
ruÀ_t
 *
to
;

1754 c⁄° 
˛õ¡öfo_t
 *
cöfo_to
;

1755 c⁄° 
size_t
 
sidesc⁄√˘ed
;

1756 *
emsg
;

1757 c⁄° 
size_t
 
emsgÀn
;

1759 c⁄° *
fun˘i⁄
 = "rule_inheritoruse()";

1760 
‰om°r
[512], 
to°r
[(fromstr)];

1761 
rc
, 
u£_to
, 
unu£_‰om
,

1762 
to_©èched
 = 
SHMEM_NONE
, 
‰om_©èched
 = SHMEM_NONE;

1764 
	#SET_USEUNUSE
(
ÁûedÆªady
, 
_‰om
, 
_cöfo_‰om
, 
_unu£_‰om
, \

1765 
_to
, 
_cöfo_to
, 
_u£_to
, \

1766 
öhîôabÀfõld
, 
idfõld
, 
ty≥
) \

1768 (
_unu£_‰om
Ë(
_u£_to
) = 0; \

1770 i‡((
ÁûedÆªady
)) { \

1771 i‡((
_‰om
)->
idfõld
 != 0) \

1772 (
_unu£_‰om
) = 1; \

1774 
	`¶og
(
LOG_DEBUG
, "%s: unuse_from? %s use_to? %s", \

1775 
fun˘i⁄
, (
_unu£_‰om
Ë? "yes" : "no", (
_u£_to
) ? "yes" : "no"); \

1780 i‡((
_‰om
)->
idfõld
 == 0) { \

1781 i‡((
_to
)->
idfõld
 != 0) \

1782 (
_u£_to
) = 1; \

1785 i‡((
_‰om
)->
öhîôabÀfõld
) { \

1786 i‡(
	`memcmp
((
_cöfo_‰om
), (
_cöfo_to
), (*(_cinfo_to))) == 0 \

1787 && ((
_to
)->
idfõld
 =0 || (_to)->idfõld =(
_‰om
)->idfield)) { \

1788 
	`log_shmemöhîô
((
_‰om
), (
_to
), (
ty≥
), (_to)->
idfõld
 != 0); \

1789 
	`SHMEM_MOVE
((
_‰om
), (
_to
), (
ty≥
)); \

1792 (
_unu£_‰om
) = 1; \

1793 
	`log_shmemöhîô
((
_‰om
), (
_to
), (
ty≥
), 1); \

1794 (
_u£_to
) = 1; \

1798 (
_unu£_‰om
) = 1; \

1800 i‡((
_to
)->
idfõld
 != 0) \

1801 (
_u£_to
) = 1; \

1805 
	`¶og
(
LOG_DEBUG
, "%s: unuse_from? %s use_to? %s", \

1806 
fun˘i⁄
, (
_unu£_‰om
Ë? "yes" : "no", (
_u£_to
) ? "yes" : "no"); \

1807 }  0)

	)

1809 
	#ATTACH_IF_NEEDED
(
_ruÀ
, 
_©å
, 
_ty≥
, 
_ruÀ_©èched
, 
_rc
) \

1811 i‡((
_ruÀ
)->
_©å
 =
NULL
) { \

1812 i‡(
	`sockd_shm©
((
_ruÀ
), (
_ty≥
)) == 0) \

1813 *(
_ruÀ_©èched
Ë|(
_ty≥
); \

1815 *(
_rc
) = -1; \

1817 }  0)

	)

1820 
	`¢¥ötf
(
‰om°r
, (fromstr),

1822 
	`˛õ¡öfo2°rög
(
cöfo_‰om
, 
NULL
, 0));

1824 
	`¢¥ötf
(
to°r
, (tostr),

1826 
	`˛õ¡öfo2°rög
(
cöfo_to
, 
NULL
, 0));

1828 
	`log_ruÀöfo_shmid
(
‰om
, 
fun˘i⁄
, 
‰om°r
);

1829 
	`log_ruÀöfo_shmid
(
to
, 
fun˘i⁄
, 
to°r
);

1831 
rc
 = 0;

1838 
	`log_öhîôabÀ
(
fun˘i⁄
,

1839 
‰om
,

1840 
‰om
->
ss_shmid
,

1842 
‰om
->
ss_shmid
 =0 ? 0 : from->
ss_isöhîôabÀ
);

1844 
	`SET_USEUNUSE
(
rc
 == -1,

1845 
‰om
,

1846 
cöfo_‰om
,

1847 
unu£_‰om
,

1848 
to
,

1849 
cöfo_to
,

1850 
u£_to
,

1851 
ss_isöhîôabÀ
,

1852 
ss_shmid
,

1853 
SHMEM_SS
);

1855 i‡(
unu£_‰om
) {

1856 
	`ATTACH_IF_NEEDED
(
‰om
, 
ss
, 
SHMEM_SS
, &
‰om_©èched
, &
rc
);

1858 i‡(
‰om
->
ss
 !
NULL
)

1859 
	`£ssi⁄_unu£
(
‰om
->
ss
, 
cöfo_‰om
, 
sockscf
.
shmemfd
);

1862 i‡(
u£_to
) {

1863 
	`ATTACH_IF_NEEDED
(
to
, 
ss
, 
SHMEM_SS
, &
to_©èched
, &
rc
);

1865 i‡(
to
->
ss
 !
NULL
) {

1866 i‡(!
	`£ssi⁄_u£
(
to
->
ss
, 
cöfo_to
, 
sockscf
.
shmemfd
, 
emsg
, 
emsgÀn
)) {

1867 
	`SHMEM_CLEAR
(
to
, 
SHMEM_SS
, 1);

1868 
rc
 = -1;

1877 
	`log_öhîôabÀ
(
fun˘i⁄
,

1878 
‰om
,

1879 
‰om
->
bw_shmid
,

1881 
‰om
->
bw_shmid
 =0 ? 0 : from->
bw_isöhîôabÀ
);

1883 
	`SET_USEUNUSE
(
rc
 == -1,

1884 
‰om
,

1885 
cöfo_‰om
,

1886 
unu£_‰om
,

1887 
to
,

1888 
cöfo_to
,

1889 
u£_to
,

1890 
bw_isöhîôabÀ
,

1891 
bw_shmid
,

1892 
SHMEM_BW
);

1894 i‡(
unu£_‰om
) {

1895 
	`ATTACH_IF_NEEDED
(
‰om
, 
bw
, 
SHMEM_BW
, &
‰om_©èched
, &
rc
);

1897 i‡(
‰om
->
bw
 !
NULL
)

1898 
	`bw_unu£
(
‰om
->
bw
, 
cöfo_‰om
, 
sockscf
.
shmemfd
);

1901 i‡(
u£_to
) {

1902 
	`ATTACH_IF_NEEDED
(
to
, 
bw
, 
SHMEM_BW
, &
to_©èched
, &
rc
);

1904 i‡(
to
->
bw
 !
NULL
)

1905 
	`bw_u£
(
to
->
bw
, 
cöfo_to
, 
sockscf
.
shmemfd
);

1909 i‡(
rc
 == 0)

1913 
	`Æ¨m_öhîô
(
‰om
, 
cöfo_‰om
, 
to
, 
cöfo_to
, 
sidesc⁄√˘ed
);

1920 
	`log_öhîôabÀ
(
fun˘i⁄
,

1921 
‰om
,

1922 
‰om
->
m°©s_shmid
,

1924 
‰om
->
m°©s_shmid
 =0 ? 0 : from->
m°©s_isöhîôabÀ
);

1926 
	`SET_USEUNUSE
(
rc
 == -1,

1927 
‰om
,

1928 
cöfo_‰om
,

1929 
unu£_‰om
,

1930 
to
,

1931 
cöfo_to
,

1932 
u£_to
,

1933 
m°©s_isöhîôabÀ
,

1934 
m°©s_shmid
,

1935 
SHMEM_MONITOR
);

1937 i‡(
unu£_‰om
) {

1938 
	`ATTACH_IF_NEEDED
(
‰om
, 
m°©s
, 
SHMEM_MONITOR
, &
‰om_©èched
, &
rc
);

1940 i‡(
‰om
->
m°©s
 !
NULL
)

1941 
	`m⁄ô‹_unu£
(
‰om
->
m°©s
, 
cöfo_‰om
, 
sockscf
.
shmemfd
);

1944 i‡(
u£_to
) {

1945 
	`ATTACH_IF_NEEDED
(
to
, 
m°©s
, 
SHMEM_MONITOR
, &
to_©èched
, &
rc
);

1947 i‡(
to
->
m°©s
 !
NULL
)

1948 
	`m⁄ô‹_u£
(
to
->
m°©s
, 
cöfo_to
, 
sockscf
.
shmemfd
);

1955 i‡(
rc
 != -1) {

1956 i‡(
‰om
->
rdr_‰om
.
©y≥
 !
SOCKS_ADDR_NOTSET


1957 || 
‰om
->
rdr_to
.
©y≥
 !
SOCKS_ADDR_NOTSET
) {

1958 i‡(
to
->
rdr_‰om
.
©y≥
 =
SOCKS_ADDR_NOTSET


1959 && 
to
->
rdr_to
.
©y≥
 =
SOCKS_ADDR_NOTSET
) {

1960 
	`¶og
(
LOG_DEBUG
,

1962 
fun˘i⁄
,

1963 
	`obje˘ty≥2°rög
(
to
->
ty≥
),

1964 ()
to
->
numbî
,

1965 
	`obje˘ty≥2°rög
(
‰om
->
ty≥
),

1966 ()
‰om
->
numbî
);

1968 
to
->
rdr_‰om
 = 
‰om
->rdr_from;

1969 
to
->
rdr_to
 = 
‰om
->rdr_to;

1972 
	`¶og
(
LOG_DEBUG
,

1974 
fun˘i⁄
,

1975 
	`obje˘ty≥2°rög
(
to
->
ty≥
),

1976 ()
to
->
numbî
,

1977 
	`obje˘ty≥2°rög
(
‰om
->
ty≥
),

1978 ()
‰om
->
numbî
);

1980 
	`bzîo
(&
‰om
->
rdr_‰om
, (from->rdr_from));

1981 
	`bzîo
(&
‰om
->
rdr_to
, (from->rdr_to));

1987 i‡(
‰om_©èched
 !
SHMEM_NONE
)

1988 
	`sockd_shmdt
(
‰om
, 
‰om_©èched
);

1990 i‡(
to_©èched
 !
SHMEM_NONE
)

1991 
	`sockd_shmdt
(
to
, 
to_©èched
);

1997 
	`SHMEM_CLEAR
(
‰om
, 
SHMEM_ALL
, 1);

1999 i‡(
rc
 == -1) {

2003 
	`SASSERTX
(
to
->
bw
 =
NULL
);

2004 
	`SASSERTX
(
to
->
m°©s
 =
NULL
);

2005 
	`SASSERTX
(
to
->
ss
 =
NULL
);

2007 
	`SHMEM_CLEAR
(
to
, 
SHMEM_ALL
, 1);

2009 
to
->
vîdi˘
 = 
VERDICT_BLOCK
;

2012 
	`log_ruÀöfo_shmid
(
‰om
, 
fun˘i⁄
, "from-ruleáfter");

2013 
	`log_ruÀöfo_shmid
(
to
, 
fun˘i⁄
, "to-ruleáfter");

2015  
rc
;

2016 
	}
}

2020 
	$§cho°_isok
(
≥î
, 
msg
, 
msgsize
)

2021 c⁄° 
sockaddr_°‹age
 *
≥î
;

2022 *
msg
;

2023 
size_t
 
msgsize
;

2025 c⁄° *
fun˘i⁄
 = "srchost_isok()";

2026 
ho°«me
[
MAXHOSTNAMELEN
], 
vish«me
[(hostname) * 4];

2027 
rc
;

2029 i‡(!
sockscf
.
§cho°
.
nodnsmism©ch


2030 && !
sockscf
.
§cho°
.
nodnsunknown
)

2033 
rc
 = 
	`cgë«meöfo
(
	`TOCSA
(
≥î
),

2034 
	`ßÀn
(
≥î
->
ss_Ámûy
),

2035 
ho°«me
,

2036 (
ho°«me
),

2037 
NULL
,

2039 
NI_NAMEREQD
);

2041 i‡(
rc
 != 0) {

2042 
	`log_ªvî£m≠Áûed
(
≥î
, 
INTERNALIF
, 
rc
);

2044 
	`¢¥ötf
(
msg
, 
msgsize
, "no dnsÉntry found for srchost %s",

2045 
	`sockaddr2°rög
(
≥î
, 
NULL
, 0));

2047 i‡(
sockscf
.
§cho°
.
nodnsunknown
)

2054 
	`SASSERTX
(
sockscf
.
§cho°
.
nodnsmism©ch
);

2058 
	`¶og
(
LOG_DEBUG
, "%s: %s hasá dnsÉntry: %s",

2059 
fun˘i⁄
,

2060 
	`sockaddr2°rög
(
≥î
, 
NULL
, 0),

2061 
	`°r2vis
(
ho°«me
, 
	`°æí
(ho°«me), 
vish«me
, (vishname)));

2063 i‡(
sockscf
.
§cho°
.
nodnsmism©ch
) {

2068 
ruÀaddr_t
 
ruÀaddr
;

2069 
socksho°_t
 
ªsﬁvedho°
;

2071 
	`sockaddr2ruÀaddr
(
≥î
, &
ruÀaddr
);

2072 
ruÀaddr
.
›î©‹
 = 
n⁄e
;

2074 i‡(
	`°æí
(
ho°«me
Ë>(
ªsﬁvedho°
.
addr
.
domaö
)) {

2075 
	`sw¨nx
("%s: ipaddress %sÑesolvedÅoá hostname (%s) which isÅoo "

2077 
fun˘i⁄
,

2078 
	`sockaddr2°rög2
(
≥î
, 0, 
NULL
, 0),

2079 
vish«me
,

2080 ()(
ªsﬁvedho°
.
addr
.
domaö
) - 1);

2085 
ªsﬁvedho°
.
©y≥
 = 
SOCKS_ADDR_DOMAIN
;

2086 
	`°r˝y
(
ªsﬁvedho°
.
addr
.
domaö
, 
ho°«me
);

2087 
ªsﬁvedho°
.
p‹t
 = 
	`ht⁄s
(0);

2089 i‡(!
	`addrm©ch
(&
ruÀaddr
, &
ªsﬁvedho°
, 
NULL
, 
SOCKS_TCP
, 0)) {

2090 
	`¢¥ötf
(
msg
, 
msgsize
,

2093 
	`sockaddr2°rög2
(
≥î
, 0, 
NULL
, 0), 
vish«me
);

2100 
	}
}

2102 #i‡
HAVE_LIBWRAP


2104 
	$libwøpöô
(
s
, 
loˇl
, 
≥î
, 
ªque°
)

2105 
s
;

2106 
sockaddr_°‹age
 *
loˇl
;

2107 
sockaddr_°‹age
 *
≥î
;

2108 
ªque°_öfo
 *
ªque°
;

2110 c⁄° *
fun˘i⁄
 = "libwrapinit()";

2111 c⁄° 
î∫o_s
 = 
î∫o
;

2112 
ho°«me
[
MAXHOSTNAMELEN
],

2113 
loˇl°r
[
MAXSOCKADDRSTRING
], 
≥î°r
[MAXSOCKADDRSTRING];

2114 
rc
;

2116 
	`¶og
(
LOG_DEBUG
,

2118 
fun˘i⁄
,

2119 
s
,

2120 
	`sockaddr2°rög
(
loˇl
, 
loˇl°r
, (localstr)),

2121 
	`sockaddr2°rög
(
≥î
, 
≥î°r
, (peerstr)));

2123 
rc
 = 
	`cgë«meöfo
(
	`TOSA
(
loˇl
),

2124 
	`ßÀn
(
loˇl
->
ss_Ámûy
),

2125 
ho°«me
,

2126 (
ho°«me
),

2127 
NULL
,

2129 
NI_NAMEREQD
);

2131 
	`ªque°_öô
(
ªque°
,

2132 
RQ_FILE
, 
s
,

2133 
RQ_DAEMON
, 
__¥og«me
,

2134 
RQ_CLIENT_SIN
, 
≥î
,

2135 
RQ_SERVER_SIN
, 
loˇl
,

2136 
RQ_SERVER_NAME
, 
rc
 =0 ? 
ho°«me
 : "",

2139 
rc
 = 
	`cgë«meöfo
(
	`TOSA
(
≥î
),

2140 
	`ßÀn
(
≥î
->
ss_Ámûy
),

2141 
ho°«me
,

2142 (
ho°«me
),

2143 
NULL
,

2145 
NI_NAMEREQD
);

2147 
	`ªque°_£t
(
ªque°
,

2148 
RQ_CLIENT_NAME
, 
rc
 =0 ? 
ho°«me
 : "",

2152 
	`sock_mëhods
(
ªque°
);

2154 
î∫o
 = 
î∫o_s
;

2155 
	}
}

2158 
	$libwøp_ho°s_ac˚ss
(
ªque°
, 
≥î
)

2159 
ªque°_öfo
 *
ªque°
;

2160 c⁄° 
sockaddr_°‹age
 *
≥î
;

2162 c⁄° *
fun˘i⁄
 = "libwrap_hosts_access()";

2163 
Ælow
;

2165 
	`sockd_¥iv
(
SOCKD_PRIV_LIBWRAP
, 
PRIV_ON
);

2166 
Ælow
 = 
	`ho°s_ac˚ss
(
ªque°
) != 0;

2167 
	`sockd_¥iv
(
SOCKD_PRIV_LIBWRAP
, 
PRIV_OFF
);

2169 
	`¶og
(
LOG_DEBUG
, "%s:Üibwrap/tcp_wrappers hosts_access() %sáddress %s",

2170 
fun˘i⁄
,

2171 
Ælow
 ? "allows" : "denies",

2172 
	`sockaddr2°rög
(
≥î
, 
NULL
, 0));

2174 i‡(
Ælow
)

2178 
	}
}

2181 
ruÀ_t
 *

2182 
	$addruÀ
(
√wruÀ
, 
ruÀba£
, 
ruÀty≥
)

2183 c⁄° 
ruÀ_t
 *
√wruÀ
;

2184 
ruÀ_t
 **
ruÀba£
;

2185 c⁄° 
obje˘ty≥_t
 
ruÀty≥
;

2187 c⁄° *
fun˘i⁄
 = "addrule()";

2188 
£rvî°©e_t
 
z°©e
;

2189 
ruÀ_t
 *
ruÀ
;

2190 
size_t
 
i
;

2192 
	`bzîo
(&
z°©e
, (zstate));

2194 i‡((
ruÀ
 = 
	`mÆloc
((*ruÀ))Ë=
NULL
)

2195 
	`£º
("%s: couldÇotállocate %lu bytes foráÑule",

2196 
fun˘i⁄
, ()(*
ruÀ
));

2198 *
ruÀ
 = *
√wruÀ
;

2200 
ruÀ
->
ty≥
 = 
ruÀty≥
;

2206 i‡(
sockscf
.
›ti⁄
.
debug
) {

2207 
ruÀ
->
log
.
c⁄√˘
 = 1;

2208 
ruÀ
->
log
.
disc⁄√˘
 = 1;

2209 
ruÀ
->
log
.
îr‹
 = 1;

2210 
ruÀ
->
log
.
io›î©i⁄
 = 1;

2215 
ruÀty≥
) {

2216 
obje˘_§uÀ
:

2217 i‡(
ruÀ
->
timeout
.
t˝io
 != 0)

2218 i‡(
ruÀ
->
timeout
.
t˝_fö_waô
 != 0

2219 && 
ruÀ
->
timeout
.
t˝_fö_waô
 >ÑuÀ->timeout.
t˝io
) {

2220 
	`yyw¨nx
("%s: it doesÇot make senseÅoÜetÅheÅcp-fin-wait "

2223 
fun˘i⁄
,

2224 ()
ruÀ
->
timeout
.
t˝_fö_waô
,

2225 ()
ruÀ
->
timeout
.
t˝io
);

2227 
ruÀ
->
timeout
.
t˝_fö_waô
 =ÑuÀ->timeout.
t˝io
;

2235 
	`£tcomm™d¥Ÿocﬁ
(
ruÀ
->
ty≥
, &ruÀ->
°©e
.
comm™d
, &ruÀ->°©e.
¥Ÿocﬁ
);

2245 i‡(
sockscf
.
cmëhodc
 == 0)

2246 
sockscf
.
cmëhodv
[sockscf.
cmëhodc
++] = 
AUTHMETHOD_NONE
;

2254 i‡(
	`i§ïlycomm™d⁄ly
(&
ruÀ
->
°©e
.
comm™d
)) {

2255 
	`SASSERTX
(
ruÀ
->
ty≥
 =
obje˘_§uÀ
);

2257 
i
 = 0; i < 
ruÀ
->
°©e
.
cmëhodc
; ++i) {

2258 i‡(–
ruÀ
->
°©e
.
comm™d
.
ud¥ïly


2259 && !
	`mëhodw‹kswôh
(
ruÀ
->
°©e
.
smëhodv
[
i
], 
ud¥ïlõs
))

2260 || ( 
ruÀ
->
°©e
.
comm™d
.
bödª∂y


2261 && !
	`mëhodw‹kswôh
(
ruÀ
->
°©e
.
smëhodv
[
i
], 
t˝ª∂õs
)))

2262 
	`yyîr‹x
("%s #%lu specifies method %s, butÅhis "

2264 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

2265 ()
ruÀ
->
numbî
,

2266 
	`mëhod2°rög
(
ruÀ
->
°©e
.
smëhodv
[
i
]),

2267 
ruÀ
->
°©e
.
comm™d
.
ud¥ïly
 ? "udp" : "");

2274 i‡(
ruÀ
->
°©e
.
cmëhodc
 == 0) {

2275 
i
 = 0; i < 
sockscf
.
cmëhodc
; ++i)

2276 
ruÀ
->
°©e
.
cmëhodv
[ruÀ->°©e.
cmëhodc
++] = 
sockscf
.cmëhodv[
i
];

2279 
i
 = 0; i < 
ruÀ
->
°©e
.
cmëhodc
; ++i) {

2280 i‡(!
	`mëhodis£t
(
ruÀ
->
°©e
.
cmëhodv
[
i
],

2281 
sockscf
.
cmëhodv
,

2282 
sockscf
.
cmëhodc
))

2283 
	`yyîr‹x
("clientmethod \"%s\" is set inÅheÑule, butÇot inÅhe "

2288 
	`mëhod2°rög
(
ruÀ
->
°©e
.
cmëhodv
[
i
]),

2289 
	`mëhods2°rög
(
sockscf
.
cmëhodc
,

2290 
sockscf
.
cmëhodv
,

2291 
NULL
,

2294 i‡(
ruÀ
->
°©e
.
cmëhodv
[
i
] =
AUTHMETHOD_NONE


2295 && 
i
 + 1 < 
ruÀ
->
°©e
.
cmëhodc
)

2296 
	`yyw¨nx
("authentication method \"%s\" is configured inÅhis "

2302 
	`mëhod2°rög
(
ruÀ
->
°©e
.
cmëhodv
[
i
]),

2303 
	`mëhod2°rög
(
ruÀ
->
°©e
.
cmëhodv
[
i
 + 1]));

2316 i‡(
ruÀ
->
°©e
.
smëhodc
 == 0) {

2317 
i
 = 0; i < 
sockscf
.
smëhodc
; ++i) {

2318 
ruÀ
->
ty≥
) {

2319 
obje˘_¸uÀ
:

2321 #i‡
HAVE_SOCKS_HOSTID


2322 
obje˘_hruÀ
:

2325 
ruÀ
->
°©e
.
smëhodv
[ruÀ->°©e.
smëhodc
++]

2326 
sockscf
.
smëhodv
[
i
];

2329 #i‡
HAVE_SOCKS_RULES


2330 
obje˘_§uÀ
:

2331 i‡(
	`i§ïlycomm™d⁄ly
(&
ruÀ
->
°©e
.
comm™d
)) {

2332 i‡(
ruÀ
->
°©e
.
comm™d
.
ud¥ïly


2333 && !
	`mëhodw‹kswôh
(
sockscf
.
smëhodv
[
i
], 
ud¥ïlõs
))

2336 i‡(
ruÀ
->
°©e
.
comm™d
.
bödª∂y


2337 && !
	`mëhodw‹kswôh
(
sockscf
.
smëhodv
[
i
], 
t˝ª∂õs
))

2341 i‡(
	`ruÀªquúes
(
ruÀ
, 
u£∫ame
))

2342 i‡(!
	`mëhodˇ≈rovide
(
sockscf
.
smëhodv
[
i
], 
u£∫ame
))

2345 
ruÀ
->
°©e
.
smëhodv
[ruÀ->°©e.
smëhodc
++]

2346 
sockscf
.
smëhodv
[
i
];

2352 
	`SERRX
(
ruÀ
->
ty≥
);

2362 
i
 = 0; i < 
ruÀ
->
°©e
.
smëhodc
; ++i) {

2363 i‡(!
	`mëhodis£t
(
ruÀ
->
°©e
.
smëhodv
[
i
],

2364 
sockscf
.
smëhodv
,

2365 
sockscf
.
smëhodc
))

2366 
	`yyîr‹x
("method \"%s\" is set inÅheÑule, butÇot inÅhe global "

2371 
	`mëhod2°rög
(
ruÀ
->
°©e
.
smëhodv
[
i
]),

2372 
	`mëhods2°rög
(
sockscf
.
smëhodc
,

2373 
sockscf
.
smëhodv
,

2374 
NULL
,

2377 i‡(
ruÀ
->
ty≥
 !
obje˘_§uÀ
) {

2384 i‡(
ruÀ
->
°©e
.
smëhodv
[
i
] =
AUTHMETHOD_NONE


2385 && 
i
 + 1 < 
ruÀ
->
°©e
.
smëhodc
)

2386 
	`yyw¨nx
("authentication method \"%s\" is configured inÅhis "

2392 
	`mëhod2°rög
(
ruÀ
->
°©e
.
smëhodv
[
i
]),

2393 
	`mëhod2°rög
(
ruÀ
->
°©e
.
smëhodv
[
i
 + 1]));

2399 i‡(
	`memcmp
(&
z°©e
.
¥oxy¥Ÿocﬁ
, &
ruÀ
->
°©e
.proxyprotocol,

2400 (
z°©e
.
¥oxy¥Ÿocﬁ
)) == 0) {

2401 #i‡
SOCKS_SERVER


2402 
ruÀ
->
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v4
 = 1;

2403 
ruÀ
->
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
 = 1;

2405 #ñi‡
BAREFOOTD


2406 
ruÀ
->
°©e
.
¥oxy¥Ÿocﬁ
.
socks_v5
 = 1;

2408 #ñi‡
COVENANT


2409 
ruÀ
->
°©e
.
¥oxy¥Ÿocﬁ
.
hâp
 = 1;

2413 #i‡
BAREFOOTD


2414 
	`SASSERTX
(
ruÀ
->
ty≥
 !
obje˘_§uÀ
);

2416 i‡(
ruÀ
->
vîdi˘
 =
VERDICT_PASS


2417 && ( (
ruÀ
->
exåa
.
boun˚to
.
p‹t
.
t˝
 =
	`ht⁄s
(0))

2418 || (
ruÀ
->
exåa
.
boun˚to
.
p‹t
.
udp
 =
	`ht⁄s
(0)))) {

2426 i‡(
ruÀ
->
°©e
.
¥Ÿocﬁ
.
t˝


2427 && 
ruÀ
->
exåa
.
boun˚to
.
p‹t
.
t˝
 =
	`ht⁄s
(0)) {

2428 
ruÀ
->
exåa
.
boun˚to
.
p‹t
.
t˝
 =ÑuÀ->
d°
.port.tcp;

2430 
	`¶og
(
LOG_DEBUG
,

2433 
fun˘i⁄
,

2434 
	`¥Ÿocﬁ2°rög
(
SOCKS_TCP
),

2435 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

2436 ()
ruÀ
->
numbî
,

2437 
	`¡ohs
(
ruÀ
->
d°
.
p‹t
.
t˝
));

2440 i‡(
ruÀ
->
°©e
.
¥Ÿocﬁ
.
udp


2441 && 
ruÀ
->
exåa
.
boun˚to
.
p‹t
.
udp
 =
	`ht⁄s
(0)) {

2442 
ruÀ
->
exåa
.
boun˚to
.
p‹t
.
udp
 =ÑuÀ->
d°
.port.udp;

2444 
	`¶og
(
LOG_DEBUG
,

2447 
fun˘i⁄
,

2448 
	`¥Ÿocﬁ2°rög
(
SOCKS_UDP
),

2449 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

2450 ()
ruÀ
->
numbî
,

2451 
	`¡ohs
(
ruÀ
->
d°
.
p‹t
.
udp
));

2467 #i‡
HAVE_PAM


2468 i‡(*
ruÀ
->
°©e
.
∑m£rvi˚«me
 =
NUL
)

2469 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
∑m£rvi˚«me
, 
DEFAULT_PAMSERVICENAME
);

2472 #i‡
HAVE_BSDAUTH


2473 i‡(*
ruÀ
->
°©e
.
bsdauth°yÀ«me
 =
NUL
)

2474 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
bsdauth°yÀ«me
, 
DEFAULT_BSDAUTHSTYLENAME
);

2477 #i‡
HAVE_GSSAPI


2478 i‡(*
ruÀ
->
°©e
.
gsßpi£rvi˚«me
 =
NUL
)

2479 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
gsßpi£rvi˚«me
,

2480 
DEFAULT_GSSAPISERVICENAME
);

2482 i‡(*
ruÀ
->
°©e
.
gsßpikeyèb
 =
NUL
)

2483 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
gsßpikeyèb
, 
DEFAULT_GSSAPIKEYTAB
);

2489 i‡(
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
˛ór
 == 0

2490 && 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
 == 0

2491 && 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
 == 0

2492 && 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
≥rmesßge
 == 0) {

2493 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
 = 1;

2494 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
= 1;

2495 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
≥rmesßge
 = 0;

2499 #i‡
HAVE_LDAP


2500 i‡(*
ruÀ
->
°©e
.
ld≠
.
keyèb
 =
NUL
)

2501 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
keyèb
, 
DEFAULT_GSSAPIKEYTAB
);

2503 
ruÀ
->
ld≠£âögs‰omu£r
 = 1;

2505 i‡(*
ruÀ
->
°©e
.
ld≠
.
fûãr
 =
NUL
)

2506 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
fûãr
, 
DEFAULT_LDAP_FILTER
);

2508 
ruÀ
->
ld≠£âögs‰omu£r
 = 1;

2510 i‡(*
ruÀ
->
°©e
.
ld≠
.
fûãr_AD
 =
NUL
)

2511 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
fûãr_AD
, 
DEFAULT_LDAP_FILTER_AD
);

2513 
ruÀ
->
ld≠£âögs‰omu£r
 = 1;

2515 i‡(*
ruÀ
->
°©e
.
ld≠
.
©åibuã
 =
NUL
)

2516 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
©åibuã
, 
DEFAULT_LDAP_ATTRIBUTE
);

2518 
ruÀ
->
ld≠£âögs‰omu£r
 = 1;

2520 i‡(*
ruÀ
->
°©e
.
ld≠
.
©åibuã_AD
 =
NUL
)

2521 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
©åibuã_AD
,

2522 
DEFAULT_LDAP_ATTRIBUTE_AD
);

2524 
ruÀ
->
ld≠£âögs‰omu£r
 = 1;

2526 i‡(*
ruÀ
->
°©e
.
ld≠
.
˚πfûe
 =
NUL
)

2527 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
˚πfûe
, 
DEFAULT_LDAP_CACERTFILE
);

2529 
ruÀ
->
ld≠£âögs‰omu£r
 = 1;

2531 i‡(*
ruÀ
->
°©e
.
ld≠
.
˚π∑th
 =
NUL
)

2532 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
˚π∑th
, 
DEFAULT_LDAP_CERTDBPATH
);

2534 
ruÀ
->
ld≠£âögs‰omu£r
 = 1;

2536 i‡(
ruÀ
->
°©e
.
ld≠
.
p‹t
 == 0)

2537 
ruÀ
->
°©e
.
ld≠
.
p‹t
 = 
SOCKD_EXPLICIT_LDAP_PORT
;

2539 
ruÀ
->
ld≠£âögs‰omu£r
 = 1;

2541 i‡(
ruÀ
->
°©e
.
ld≠
.
p‹ts¶
 == 0)

2542 
ruÀ
->
°©e
.
ld≠
.
p‹ts¶
 = 
SOCKD_EXPLICIT_LDAPS_PORT
;

2544 
ruÀ
->
ld≠£âögs‰omu£r
 = 1;

2547 i‡(*
ruÀba£
 =
NULL
) {

2548 *
ruÀba£
 = 
ruÀ
;

2549 (*
ruÀba£
)->
numbî
 = 1;

2552 
ruÀ_t
 *
œ°ruÀ
;

2554 
œ°ruÀ
 = *
ruÀba£
;

2555 
œ°ruÀ
->
√xt
 !
NULL
)

2556 
œ°ruÀ
 =Üa°ruÀ->
√xt
;

2558 
ruÀ
->
numbî
 = 
œ°ruÀ
->number + 1;

2559 
œ°ruÀ
->
√xt
 = 
ruÀ
;

2562 
	`INIT_MSTATES
(
ruÀ
,ÑuÀ->
ty≥
,ÑuÀ->
numbî
);

2563 
ruÀ
->
√xt
 = 
NULL
;

2565  
ruÀ
;

2566 
	}
}

2569 
	$checkruÀ
(
ruÀ
)

2570 c⁄° 
ruÀ_t
 *
ruÀ
;

2572 c⁄° *
fun˘i⁄
 = "checkrule()";

2573 
ruÀaddr_t
 
ruÀaddr
;

2574 c⁄° *
mëhodv
[] = {

2575 
ruÀ
->
°©e
.
cmëhodv
,

2576 
ruÀ
->
°©e
.
smëhodv


2578 c⁄° 
size_t
 
mëhodc
[] = {

2579 
ruÀ
->
°©e
.
cmëhodc
,

2580 
ruÀ
->
°©e
.
smëhodc


2582 c⁄° 
mëhodty≥
[][32] = {

2586 c⁄° 
obje˘ty≥_t
 
ruÀty≥
[] = {

2587 
obje˘_¸uÀ
,

2588 
obje˘_§uÀ


2591 
size_t
 
i
, 
mëhodi
;

2593 i‡(
ruÀ
->
§c
.
©y≥
 =
SOCKS_ADDR_IFNAME
) {

2594 
sockaddr_°‹age
 
addr
, 
mask
;

2596 i‡(
	`i‚ame2sockaddr
(
ruÀ
->
§c
.
addr
.
i‚ame
, 0, &addr, &
mask
Ë=
NULL
)

2597 
	`yyîr‹
("nÿùáddªs†found o¿öãrÁ˚ %s", 
ruÀ
->
§c
.
addr
.
i‚ame
);

2600 i‡(
ruÀ
->
d°
.
©y≥
 =
SOCKS_ADDR_IFNAME
) {

2601 
sockaddr_°‹age
 
addr
, 
mask
;

2603 i‡(
	`i‚ame2sockaddr
(
ruÀ
->
d°
.
addr
.
i‚ame
, 0, &addr, &
mask
)

2604 =
NULL
)

2605 
	`yyîr‹
("nÿùáddªs†found o¿öãrÁ˚ %s", 
ruÀ
->
d°
.
addr
.
i‚ame
);

2609 i‡(
ruÀ
->
ss
 !
NULL
) {

2610 
	`SASSERTX
(
ruÀ
->
ss
->
ty≥
 =
SHMEM_SS
);

2612 i‡(
ruÀ
->
ss
->
key°©e
.
key
 =
key_un£t
) {

2613 i‡(
ruÀ
->
ss
->
obje˘
.ss.
max_≥r°©e_is£t
)

2614 
	`yyîr‹x
("state.session.max is set, but session.state.key isÇot");

2616 i‡(
ruÀ
->
ss
->
obje˘
.ss.
thrŸée_≥r°©e_is£t
)

2617 
	`yyîr‹x
("session.state.throttle is set, but session.state.key "

2621 i‡(!
ruÀ
->
ss
->
obje˘
.ss.
max_≥r°©e_is£t


2622 && !
ruÀ
->
ss
->
obje˘
.ss.
thrŸée_≥r°©e_is£t
)

2623 
	`yyîr‹x
("session state key is set (%d), butÇo value has been "

2625 ()
ruÀ
->
ss
->
key°©e
.
key
);

2627 
ruÀ
->
ss
->
key°©e
.
key
) {

2628 
key_ho°id
:

2629 
	`SASSERTX
(
ruÀ
->
ho°id›ti⁄_is£t
);

2632 i‡(
ruÀ
->
°©e
.
¥Ÿocﬁ
.
udp
)

2633 
	`yyîr‹x
("hostidsáreÇotávailable on sessions using UDP");

2636 i‡(
ruÀ
->
ss
->
key°©e
.
keyöfo
.
ho°ödex
 < 1)

2637 
	`yyîr‹x
("illegal hostindex value %d%s",

2638 ()
ruÀ
->
ss
->
key°©e
.
keyöfo
.
ho°ödex
,

2639 
ruÀ
->
ss
->
key°©e
.
keyöfo
.
ho°ödex
 == 0 ?

2643 
key_‰om
:

2644 i‡(
ruÀ
->
ss
->
key°©e
.
keyöfo
.
ho°ödex
 != 0)

2645 
	`yyîr‹x
("it doesÇot make senseÅo setá hostindex value "

2648 
	`°©ekey2°rög
(
ruÀ
->
ss
->
key°©e
.
key
));

2652 
	`SERRX
(
ruÀ
->
ss
->
key°©e
.
key
);

2655 i‡(
ruÀ
->
ss
->
obje˘
.ss.
max_is£t


2656 && (
ruÀ
->
ss
->
obje˘
.ss.
max_≥r°©e


2657 > 
ruÀ
->
ss
->
obje˘
.ss.
max
))

2658 
	`yyîr‹x
("it doesÇot make senseÅo haveáÜarger value for "

2661 ()
ruÀ
->
ss
->
obje˘
.ss.
max_≥r°©e
,

2662 ()
ruÀ
->
ss
->
obje˘
.ss.
max
);

2664 i‡(
ruÀ
->
ss
->
obje˘
.ss.
thrŸée_≥r°©e_is£t


2665 && 
ruÀ
->
ss
->
obje˘
.ss.
thrŸée_is£t
) {

2666 i‡((
ruÀ
->
ss
->
obje˘
.ss.
thrŸée_≥r°©e
.
limô
.
£c⁄ds


2667 <
ruÀ
->
ss
->
obje˘
.ss.
thrŸée
.
limô
.
£c⁄ds
)

2668 && (
ruÀ
->
ss
->
obje˘
.ss.
thrŸée_≥r°©e
.
limô
.
˛õ¡s


2669 > 
ruÀ
->
ss
->
obje˘
.ss.
thrŸée
.
limô
.
˛õ¡s
))

2670 
	`yyîr‹x
("it doesÇot make senseÅo haveá more strictÜimit for "

2674 ()
ruÀ
->
ss
->
obje˘
.ss.
thrŸée
.
limô
.
˛õ¡s
,

2675 ()
ruÀ
->
ss
->
obje˘
.ss.
thrŸée
.
limô
.
£c⁄ds
,

2676 
	`°©ekey2°rög
(
ruÀ
->
ss
->
key°©e
.
key
),

2677 ()
ruÀ
->
ss
->
obje˘
.ss.
thrŸée_≥r°©e
.
limô
.
˛õ¡s
,

2678 ()
ruÀ
->
ss
->
obje˘
.ss.
thrŸée_≥r°©e
.
limô
.
£c⁄ds
);

2683 i‡(
ruÀ
->
bw
 !
NULL
) {

2684 
	`SASSERTX
(
ruÀ
->
bw
->
ty≥
 =
SHMEM_BW
);

2686 i‡(!
ruÀ
->
bw
->
obje˘
.bw.
maxbps_is£t
)

2687 
	`yyîr‹x
("no value for maxbps has been given");

2698 i‡(
ruÀ
->
°©e
.
¥Ÿocﬁ
.
udp
) {

2699 i‡(
ruÀ
->
ho°id›ti⁄_is£t
)

2700 
	`yyîr‹x
("hostidsáreÇotávailable on sessions using UDP");

2705 i‡(
ruÀ
->
§c
.
©y≥
 =
SOCKS_ADDR_IPVANY
) {

2706 
	`SASSERTX
(
ruÀ
->
§c
.
addr
.
ùv™y
.
ù
.
s_addr
 =
	`ht⁄l
(0));

2707 
	`SASSERTX
(
ruÀ
->
§c
.
addr
.
ùv™y
.
mask
.
s_addr
 =
	`ht⁄l
(0));

2710 i‡(
ruÀ
->
d°
.
©y≥
 =
SOCKS_ADDR_IPVANY
) {

2711 
	`SASSERTX
(
ruÀ
->
d°
.
addr
.
ùv™y
.
ù
.
s_addr
 =
	`ht⁄l
(0));

2712 
	`SASSERTX
(
ruÀ
->
d°
.
addr
.
ùv™y
.
mask
.
s_addr
 =
	`ht⁄l
(0));

2715 #i‡
BAREFOOTD


2716 
	`SASSERTX
(
ruÀ
->
ty≥
 !
obje˘_§uÀ
);

2718 i‡(
ruÀ
->
ty≥
 =
obje˘_¸uÀ
) {

2719 i‡(
ruÀ
->
d°
.
©y≥
 =
SOCKS_ADDR_IPV4
)

2720 
	`SASSERTX
(
ruÀ
->
d°
.
addr
.
ùv4
.
mask
.
s_addr
 =
	`ht⁄l
(
IPV4_FULLNETMASK
));

2721 i‡(
ruÀ
->
d°
.
©y≥
 =
SOCKS_ADDR_IPV6
)

2722 
	`SASSERTX
(
ruÀ
->
d°
.
addr
.
ùv6
.
maskbôs
 =
IPV6_NETMASKBITS
);

2726 
mëhodi
 = 0; mëhodò< 
	`ELEMENTS
(
mëhodv
); ++methodi) {

2727 
i
 = 0; i < 
mëhodc
[
mëhodi
]; ++i) {

2728 i‡(!
	`mëhodisvÆid
(
mëhodv
[
mëhodi
][
i
], 
ruÀty≥
[methodi]))

2729 
	`yyîr‹x
("%smethod %s isÇot valid for %ss",

2730 
mëhodty≥
[
i
],

2731 
	`mëhod2°rög
(
mëhodv
[
mëhodi
][
i
]),

2732 
	`obje˘ty≥2°rög
(
ruÀty≥
[
mëhodi
]));

2736 
ruÀ
->
ty≥
) {

2737 
obje˘_¸uÀ
:

2738 #i‡
HAVE_SOCKS_HOSTID


2739 
obje˘_hruÀ
:

2746 
	`SASSERTX
(
ruÀ
->
°©e
.
cmëhodc
 > 0);

2749 #i‡
HAVE_SOCKS_RULES


2750 
obje˘_§uÀ
:

2751 i‡(
ruÀ
->
°©e
.
smëhodc
 == 0) {

2752 i‡(
	`i§ïlycomm™d⁄ly
(&
ruÀ
->
°©e
.
comm™d
)

2753 && !
sockscf
.
§cho°
.
checkª∂yauth
) {

2761 
	`yyw¨nx
("%s: %s #%lu setsÇo socksáuthentication methods,Çot "

2765 
fun˘i⁄
,

2766 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

2767 ()
ruÀ
->
numbî
);

2775 
	`SERRX
(
ruÀ
->
ty≥
);

2778 i‡(
	`ruÀªquúes
(
ruÀ
, 
u£∫ame
)) {

2779 
Ælmëhodßªok
;

2780 
badmëhod
[256];

2782 i‡(
ruÀ
->
°©e
.
comm™d
.
ud¥ïly
) {

2783 i‡(
	`i§ïlycomm™d⁄ly
(&
ruÀ
->
°©e
.
comm™d
))

2784 
	`yyîr‹x
("UDPÑeplies cannotÖrovideány username, butÅhe "

2788 i‡(
sockscf
.
§cho°
.
checkª∂yauth
)

2789 
	`yyîr‹x
("\"checkreplyauth\" isÉnabled, butÅheÅarget "

2799 
Ælmëhodßªok
 = 1;

2801 
ruÀ
->
ty≥
) {

2802 
obje˘_¸uÀ
:

2803 #i‡
HAVE_SOCKS_HOSTID


2804 
obje˘_hruÀ
:

2810 
i
 = 0; i < 
ruÀ
->
°©e
.
cmëhodc
; ++i) {

2811 i‡(!
	`mëhodˇ≈rovide
(
ruÀ
->
°©e
.
cmëhodv
[
i
], 
u£∫ame
)) {

2812 
	`¢¥ötf
(
badmëhod
, (badmethod),

2814 
	`mëhod2°rög
(
ruÀ
->
°©e
.
cmëhodv
[
i
]));

2816 
Ælmëhodßªok
 = 0;

2823 
obje˘_§uÀ
:

2833 i‡((
sockscf
.
§cho°
.
checkª∂yauth


2834 && 
	`ha§ïlycomm™ds
(&
ruÀ
->
°©e
.
comm™d
))

2835 || 
	`i§ïlycomm™d⁄ly
(&
ruÀ
->
°©e
.
comm™d
)) {

2836 
i
 = 0; i < 
ruÀ
->
°©e
.
cmëhodc
; ++i) {

2837 i‡(!
	`mëhodˇ≈rovide
(
ruÀ
->
°©e
.
cmëhodv
[
i
], 
u£∫ame
)) {

2838 
	`¢¥ötf
(
badmëhod
, (badmethod),

2840 
	`mëhod2°rög
(
ruÀ
->
°©e
.
cmëhodv
[
i
]));

2842 
Ælmëhodßªok
 = 0;

2848 i‡(!
Ælmëhodßªok
)

2851 i‡(
	`i§ïlycomm™d⁄ly
(&
ruÀ
->
°©e
.
comm™d
))

2854 
i
 = 0; i < 
ruÀ
->
°©e
.
smëhodc
; ++i) {

2855 i‡(!
	`mëhodˇ≈rovide
(
ruÀ
->
°©e
.
smëhodv
[
i
], 
u£∫ame
)) {

2856 
	`¢¥ötf
(
badmëhod
, (badmethod),

2858 
	`mëhod2°rög
(
ruÀ
->
°©e
.
smëhodv
[
i
]));

2860 
Ælmëhodßªok
 = 0;

2868 
	`SERRX
(
obje˘_§uÀ
);

2871 i‡(!
Ælmëhodßªok
)

2872 
	`yyîr‹x
("the settings inÅhis %sÑequiresÅhe clientÅo "

2876 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
), 
badmëhod
);

2880 i‡(
ruÀ
->
rdr_‰om
.
©y≥
 !
SOCKS_ADDR_NOTSET
) {

2881 
ruÀ
->
rdr_‰om
.
©y≥
) {

2882 
SOCKS_ADDR_IPV4
:

2883 
SOCKS_ADDR_IPV6
:

2884 
SOCKS_ADDR_IFNAME
:

2885 
SOCKS_ADDR_DOMAIN
:

2889 
	`yyîr‹x
("redirect fromáddress canÇot beá %s",

2890 
	`©y≥2°rög
(
ruÀ
->
rdr_‰om
.
©y≥
));

2893 
ruÀaddr
 = 
ruÀ
->
rdr_‰om
;

2894 
ruÀaddr
.
p‹t
.
t˝
 = 
	`ht⁄s
(0);

2896 i‡(!
	`addrisbödabÀ
(&
ruÀaddr
)) {

2897 
addr
[
MAXRULEADDRSTRING
];

2899 
	`yyîr‹x
("address %s inÑule #%lu isÇot bindable",

2900 
	`ruÀaddr2°rög
(&
ruÀaddr
, 0, 
addr
, (addr)),

2901 ()
ruÀ
->
numbî
);

2905 i‡(
ruÀ
->
rdr_to
.
©y≥
 !
SOCKS_ADDR_NOTSET
) {

2906 
ruÀ
->
rdr_to
.
©y≥
) {

2907 
SOCKS_ADDR_IPV4
:

2908 
SOCKS_ADDR_IPV6
:

2909 
SOCKS_ADDR_DOMAIN
:

2913 
	`yyîr‹x
("redirectÅoá %s-typeáddress isÇot supported "

2915 
	`©y≥2°rög
(
ruÀ
->
rdr_to
.
©y≥
));

2920 i‡(
ruÀ
->
sockë›ti⁄v
 !
NULL


2921 #i‡!
HAVE_SOCKS_RULES


2922 && 
ruÀ
->
ty≥
 !
obje˘_§uÀ


2931 
i
 = 0; i < 
ruÀ
->
sockë›ti⁄c
; ++i) {

2932 i‡(
ruÀ
->
ty≥
 !
obje˘_§uÀ
) {

2933 #i‡
HAVE_SOCKS_RULES


2934 i‡(!
ruÀ
->
sockë›ti⁄v
[
i
].
isöã∫Æside
)

2935 
	`yyîr‹x
("canÇot set socket options forÅheÉxternal side in "

2939 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
));

2945 i‡(
ruÀ
->
sockë›ti⁄v
[
i
].
öfo
 =
NULL
)

2949 
	}
}

2952 
	$showlog
(
log
)

2953 c⁄° 
log_t
 *
log
;

2955 
buf
[1024];

2957 
	`¶og
(
LOG_DEBUG
, "log: %s", 
	`logs2°rög
(
log
, 
buf
, (buf)));

2958 
	}
}

2961 
	$log_shmemöhîô
(
‰om
, 
to
, 
ty≥
, 
isovîride
)

2962 c⁄° 
ruÀ_t
 *
‰om
;

2963 c⁄° 
ruÀ_t
 *
to
;

2964 c⁄° 
ty≥
;

2965 c⁄° 
isovîride
;

2967 c⁄° *
fun˘i⁄
 = "log_shmeminherit()";

2968 c⁄° *
£âögs
;

2969 
shmid_‰om
, 
shmid_to
;

2971 i‡(
ty≥
 =
SHMEM_BW
) {

2972 
£âögs
 = "bandwidth";

2973 
shmid_‰om
 = 
‰om
->
bw_shmid
;

2974 
shmid_to
 = 
to
->
bw_shmid
;

2976 i‡(
ty≥
 =
SHMEM_MONITOR
) {

2977 
£âögs
 = "monitor";

2978 
shmid_‰om
 = 
‰om
->
m°©s_shmid
;

2979 
shmid_to
 = 
to
->
m°©s_shmid
;

2981 i‡(
ty≥
 =
SHMEM_SS
) {

2982 
£âögs
 = "session";

2983 
shmid_‰om
 = 
‰om
->
ss_shmid
;

2984 
shmid_to
 = 
to
->
ss_shmid
;

2987 
	`SERRX
(
ty≥
);

2989 i‡(
isovîride
)

2990 
	`¶og
(
LOG_DEBUG
, "%s: %s #%lu with shmid %ld overrides %s "

2992 
fun˘i⁄
,

2993 
	`obje˘ty≥2°rög
(
to
->
ty≥
),

2994 ()
to
->
numbî
,

2995 
shmid_to
,

2996 
£âögs
,

2997 
	`obje˘ty≥2°rög
(
‰om
->
ty≥
),

2998 ()
‰om
->
numbî
,

2999 
shmid_‰om
);

3001 
	`¶og
(
LOG_DEBUG
,

3003 
fun˘i⁄
,

3004 
	`obje˘ty≥2°rög
(
to
->
ty≥
),

3005 ()
to
->
numbî
,

3006 
£âögs
,

3007 
	`obje˘ty≥2°rög
(
‰om
->
ty≥
),

3008 ()
‰om
->
numbî
,

3009 
shmid_‰om
);

3010 
	}
}

3013 
	$log_öhîôabÀ
(
¥efix
, 
ruÀ
, 
shmid
, 
£âögs
, 
öhîôabÀ
)

3014 c⁄° *
¥efix
;

3015 c⁄° 
ruÀ_t
 *
ruÀ
;

3016 c⁄° 
shmid
;

3017 c⁄° *
£âögs
;

3018 c⁄° 
öhîôabÀ
;

3021 i‡(
shmid
 == 0)

3022 
	`¶og
(
LOG_DEBUG
,

3024 
¥efix
,

3025 
£âögs
,

3026 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

3027 ()
ruÀ
->
numbî
);

3029 
	`¶og
(
LOG_DEBUG
,

3031 
¥efix
,

3032 
£âögs
,

3033 
shmid
,

3034 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

3035 ()
ruÀ
->
numbî
,

3036 
öhîôabÀ
 ? "" : "not ");

3037 
	}
}

3040 
	$£tcomm™d¥Ÿocﬁ
(
ty≥
, 
comm™ds
, 
¥Ÿocﬁs
)

3041 c⁄° 
obje˘ty≥_t
 
ty≥
;

3042 
comm™d_t
 *
comm™ds
;

3043 
¥Ÿocﬁ_t
 *
¥Ÿocﬁs
;

3045 
£rvî°©e_t
 
z°©e
;

3057 
	`bzîo
(&
z°©e
, (zstate));

3059 i‡(
	`memcmp
(&
z°©e
.
¥Ÿocﬁ
, 
¥Ÿocﬁs
, (zstate.protocol)) != 0

3060 && 
	`memcmp
(&
z°©e
.
comm™d
, 
comm™ds
, (zstate.command)) == 0) {

3065 i‡(
ty≥
 =
obje˘_§uÀ
 ||Åy≥ =
obje˘_m⁄ô‹
) {

3066 i‡(
¥Ÿocﬁs
->
t˝
) {

3070 
	`mem£t
(
comm™ds
, 
UCHAR_MAX
, (*commands));

3071 
comm™ds
->
ud∑ssocüã
 = 0;

3072 
comm™ds
->
ud¥ïly
 = 0;

3075 i‡(
¥Ÿocﬁs
->
udp
) {

3076 
comm™ds
->
ud∑ssocüã
 = 1;

3077 
comm™ds
->
ud¥ïly
 = 1;

3081 i‡(
	`memcmp
(&
z°©e
.
comm™d
, 
comm™ds
, (zstate.command)) != 0

3082 && 
	`memcmp
(&
z°©e
.
¥Ÿocﬁ
, 
¥Ÿocﬁs
, (zstate.protocol)) == 0) {

3087 i‡(
ty≥
 =
obje˘_§uÀ
 ||Åy≥ =
obje˘_m⁄ô‹
) {

3088 i‡(
comm™ds
->
böd


3089 || 
comm™ds
->
bödª∂y


3090 || 
comm™ds
->
c⁄√˘
)

3091 
¥Ÿocﬁs
->
t˝
 = 1;

3093 i‡(
comm™ds
->
ud∑ssocüã


3094 || 
comm™ds
->
ud¥ïly


3095 || 
comm™ds
->
c⁄√˘
)

3096 
¥Ÿocﬁs
->
udp
 = 1;

3099 #i‡
HAVE_NEGOTIATE_PHASE


3100 
¥Ÿocﬁs
->
t˝
 = 1;

3102 
	`mem£t
(
¥Ÿocﬁs
, 
UCHAR_MAX
, (*protocols));

3106 i‡(
	`memcmp
(&
z°©e
.
comm™d
, 
comm™ds
, (zstate.command)) == 0

3107 && 
	`memcmp
(&
z°©e
.
¥Ÿocﬁ
, 
¥Ÿocﬁs
, (zstate.protocol)) == 0) {

3112 i‡(
ty≥
 =
obje˘_§uÀ
 ||Åy≥ =
obje˘_m⁄ô‹
) {

3113 
	`mem£t
(
¥Ÿocﬁs
, 
UCHAR_MAX
, (*protocols));

3114 
	`mem£t
(
comm™ds
, 
UCHAR_MAX
, (*commands));

3117 #i‡
HAVE_NEGOTIATE_PHASE


3118 
¥Ÿocﬁs
->
t˝
 = 1;

3120 
	`mem£t
(
¥Ÿocﬁs
, 
UCHAR_MAX
, (*protocols));

3129 
	`SASSERTX
(
	`memcmp
(&
z°©e
.
comm™d
, 
comm™ds
, (*commands)) != 0);

3130 
	`SASSERTX
(
	`memcmp
(&
z°©e
.
¥Ÿocﬁ
, 
¥Ÿocﬁs
, (*protocols)) != 0);

3132 i‡((
comm™ds
->
ud∑ssocüã
 || comm™ds->
ud¥ïly
)

3133 && !
¥Ÿocﬁs
->
udp
)

3134 
	`yyw¨nx
("%s specifies UDP-based commands, but doesÇotÉnableÅhe "

3136 
	`obje˘ty≥2°rög
(
ty≥
));

3138 i‡((
comm™ds
->
böd
 || comm™ds->
bödª∂y
 || comm™ds->
c⁄√˘
)

3139 && !
¥Ÿocﬁs
->
t˝
)

3140 
	`yyw¨nx
("%s specifies TCP-based commands, but doesÇotÉnableÅhe "

3142 
	`obje˘ty≥2°rög
(
ty≥
));

3144 
	}
}

3146 
	#RULEADDR_MATCHES_ALL_PORTS
(
a
, 
p
) ( \

3147 ((
a
)->
›î©‹
 =
n⁄e
) \

3148 || ((
a
)->
›î©‹
 =
ønge
 \

3149 && 
	`¡ohs
(
	`RULEPORT_START
((
a
), (
p
))) <= 1 \

3150 && 
	`¡ohs
((
a
)->
p‹ãnd
Ë>
IP_MAXPORT
) \

3151 || ((
a
)->
›î©‹
 =
ge
 && 
	`¡ohs
(
	`RULEPORT_START
◊, 
p
)) <= 1) \

3152 || ((
a
)->
›î©‹
 =
gt
 && 
	`¡ohs
(
	`RULEPORT_START
◊, 
p
)) == 0) \

3153 || ((
a
)->
›î©‹
 =
À
 && 
	`¡ohs
(
	`RULEPORT_START
◊, 
p
)Ë=
IP_MAXPORT
) \

3154 )

	)

3156 
	#RULEADDR_MATCHES_ALL_ADDRESSES
(
a
) ( \

3157 (
a
)->
©y≥
 =
SOCKS_ADDR_IPVANY
 \

3158 && (
a
)->
addr
.
ùv™y
.
mask
.
s_addr
 =
	`ht⁄l
(0))

	)

3160 
	#RULEADDR_MATCHES_ALL
(
a
, 
p
) \

3161 (
	`RULEADDR_MATCHES_ALL_PORTS
((
a
), 
p
Ë&& 
	`RULEADDR_MATCHES_ALL_ADDRESSES
(◊)))

	)

3164 
	$ruÀaddr_m©ches_Æl_exã∫Æ
(
ruÀaddr
, 
¥Ÿocﬁ
)

3165 c⁄° 
ruÀaddr_t
 *
ruÀaddr
;

3166 c⁄° 
¥Ÿocﬁ
;

3169 i‡(!
	`RULEADDR_MATCHES_ALL_PORTS
(
ruÀaddr
, 
¥Ÿocﬁ
))

3172 i‡(
ruÀaddr
->
©y≥
 !
SOCKS_ADDR_IPVANY


3173 && 
ruÀaddr
->
©y≥
 !
SOCKS_ADDR_IPV4


3174 && 
ruÀaddr
->
©y≥
 !
SOCKS_ADDR_IPV6
)

3177 i‡(
	`RULEADDR_MATCHES_ALL_ADDRESSES
(
ruÀaddr
))

3180 
	`SASSERTX
(
ruÀaddr
->
©y≥
 =
SOCKS_ADDR_IPV4


3181 || 
ruÀaddr
->
©y≥
 =
SOCKS_ADDR_IPV6
);

3183 i‡(!
	`exã∫Æ_has_⁄ly_ßÁmûy
(
	`©y≥2ßÁmûy
(
ruÀaddr
->
©y≥
)))

3186 
ruÀaddr
->
©y≥
) {

3187 
SOCKS_ADDR_IPV4
:

3188  ( 
ruÀaddr
->
©y≥
 =
SOCKS_ADDR_IPV4


3189 && 
ruÀaddr
->
addr
.
ùv4
.
mask
.
s_addr
 =
	`ht⁄l
(0));

3191 
SOCKS_ADDR_IPV6
:

3192  ( 
ruÀaddr
->
©y≥
 =
SOCKS_ADDR_IPV6


3193 && 
ruÀaddr
->
addr
.
ùv6
.
maskbôs
 == 0);

3196 
	`SERRX
(
ruÀaddr
->
©y≥
);

3201 
	}
}

3203 #i‡
HAVE_SOCKS_HOSTID


3205 
	$ho°idm©ches
(
ho°idc
, 
ho°idv
, 
ho°ödex
, 
addr
, 
ruÀty≥
, 
numbî
)

3206 c⁄° 
size_t
 
ho°idc
;

3207 c⁄° 
ö_addr
 *
ho°idv
;

3208 c⁄° 
ho°ödex
;

3209 c⁄° 
ruÀaddr_t
 *
addr
;

3210 c⁄° 
obje˘ty≥_t
 
ruÀty≥
;

3211 c⁄° 
size_t
 
numbî
;

3213 c⁄° *
fun˘i⁄
 = "hostidmatches()";

3214 
socksho°_t
 
ho°id
;

3216 
ho°id
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

3217 
ho°id
.
p‹t
 = 
	`ht⁄s
(0);

3219 i‡(
ho°ödex
 == 0) {

3220 
size_t
 
i
;

3222 
	`¶og
(
LOG_DEBUG
, "%s: %s #%lu specifies checkingágainstáll %u hostids",

3223 
fun˘i⁄
,

3224 
	`obje˘ty≥2°rög
(
ruÀty≥
),

3225 ()
numbî
,

3226 ()
ho°idc
);

3228 
i
 = 0; i < 
ho°idc
; ++i) {

3229 
ho°id
.
addr
.
ùv4
 = 
ho°idv
[
i
];

3230 i‡(
	`addrm©ch
(
addr
, &
ho°id
, 
NULL
, 
SOCKS_TCP
, 0))

3237 i‡(
ho°ödex
 > 
ho°idc
) {

3238 
	`¶og
(
LOG_DEBUG
,

3242 
fun˘i⁄
,

3243 
	`obje˘ty≥2°rög
(
ruÀty≥
),

3244 ()
numbî
,

3245 
ho°ödex
,

3246 ()
ho°idc
);

3251 
	`SASSERTX
(
ho°ödex
 <
ho°idc
);

3253 
ho°id
.
addr
.
ùv4
 = 
ho°idv
[
ho°ödex
 - 1];

3254 
	`¶og
(
LOG_DEBUG
, "%s: checkingágainst hostidáddress %s",

3255 
fun˘i⁄
, 
	`socksho°2°rög
(&
ho°id
, 
NULL
, 0));

3257  
	`addrm©ch
(
addr
, &
ho°id
, 
NULL
, 
SOCKS_TCP
, 0);

3259 
	}
}

	@sockd/serverconfig.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
ßÁmûy_i£«bÀd
(c⁄° 
ß_Ámûy_t
 
Ámûy
, c⁄° *
addr°r
,

52 c⁄° 
öãrÁ˚side_t
 
side
);

61 
addexã∫Æaddr
(c⁄° 
ruÀaddr_t
 *
ø
);

69 
addöã∫Æaddr
(c⁄° *
i‚ame
,

70 c⁄° 
sockaddr_°‹age
 *
ß
,

71 c⁄° 
¥Ÿocﬁ
);

81 
add_m‹e_ﬁd_shmem
(
c⁄fig
 *c⁄fig, c⁄° 
size_t
 
memc
,

82 c⁄° 
ﬁdshmemöfo_t
 
memv
[]);

87 
c⁄fig
 
	gsockscf
;

90 
	$addöã∫Æ
(
addr
, 
¥Ÿocﬁ
)

91 c⁄° 
ruÀaddr_t
 *
addr
;

92 c⁄° 
¥Ÿocﬁ
;

94 c⁄° *
fun˘i⁄
 = "addinternal()";

95 
sockaddr_°‹age
 
ß
;

96 
i‚ame
[
MAXIFNAMELEN
];

97 
ch™gesuµ‹ãd
;

99 i‡(
sockscf
.
›ti⁄
.
£rvîc
 == 1

100 || 
sockscf
.
°©e
.
öôed
 == 0

101 || 
¥Ÿocﬁ
 =
SOCKS_UDP
)

102 
ch™gesuµ‹ãd
 = 1;

104 
ch™gesuµ‹ãd
 = 0;

106 
	`¶og
(
LOG_DEBUG
, "%s: (%s, %s). Change supported: %d",

107 
fun˘i⁄
,

108 
	`ruÀaddr2°rög
(
addr
,

109 
ADDRINFO_PORT
 | 
ADDRINFO_ATYPE
,

110 
NULL
,

112 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
),

113 
ch™gesuµ‹ãd
);

115 
addr
->
©y≥
) {

116 
SOCKS_ADDR_IPV4
:

117 
SOCKS_ADDR_IPV6
:

118 i‡(
addr
->
©y≥
 =
SOCKS_ADDR_IPV4
)

119 
	`SASSERTX
(
addr
->addr.
ùv4
.
mask
.
s_addr
 =
	`ht⁄l
(
IPV4_FULLNETMASK
));

120 i‡(
addr
->
©y≥
 =
SOCKS_ADDR_IPV6
)

121 
	`SASSERTX
(
addr
->addr.
ùv6
.
maskbôs
 =
IPV6_NETMASKBITS
);

123 
	`ruÀaddr2sockaddr
(
addr
, &
ß
, 
¥Ÿocﬁ
);

125 i‡(!
	`PORTISBOUND
(&
ß
))

126 
	`yyîr‹x
("%s:áddress %s doesÇot specifyáÖortnumberÅo bind",

127 
fun˘i⁄
, 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0));

129 i‡(
	`addrödex_⁄_li°íli°
(
sockscf
.
öã∫Æ
.
addrc
,

130 
sockscf
.
öã∫Æ
.
addrv
,

131 &
ß
,

132 
¥Ÿocﬁ
) == -1) {

133 i‡(!
ch™gesuµ‹ãd
) {

134 
	`yyw¨nx
("cannot change internaláddresses onceÑunning. "

136 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0));

146 
	`add_öã∫Æ_ßÁmûy
(
ß
.
ss_Ámûy
);

150 i‡(
ß
.
ss_Ámûy
 =
AF_INET


151 && 
	`TOIN
(&
ß
)->
sö_addr
.
s_addr
 =
	`ht⁄l
(
INADDR_ANY
))

152 
	`STRCPY_ASSERTSIZE
(
i‚ame
, "<any IPv4-interface>");

153 i‡(
ß
.
ss_Ámûy
 =
AF_INET6


154 && 
	`memcmp
(&
	`TOIN6
(&
ß
)->
sö6_addr
,

155 &
ö6addr_™y
,

156 (
ö6addr_™y
)) == 0)

157 
	`STRCPY_ASSERTSIZE
(
i‚ame
, "<any IPv6-interface>");

158 i‡(
	`sockaddr2i‚ame
(&
ß
, 
i‚ame
, (i‚ame)Ë=
NULL
) {

164 
	`°∫˝y
(
i‚ame
, "<unknown>", (ifname) - 1);

165 
i‚ame
[(i‚ameË- 1] = 
NUL
;

167 
	`yyw¨n
("%s: couldÇot findáddress %s onányÇetwork interface",

168 
fun˘i⁄
, 
	`sockaddr2°rög2
(&
ß
, 0, 
NULL
, 0));

171 
	`addöã∫Æaddr
(
i‚ame
, &
ß
, 
¥Ÿocﬁ
);

174 
SOCKS_ADDR_DOMAIN
: {

175 
size_t
 
i
;

176 
emsg
[1024];

177 
gaõº
;

179 
i
 = 0;

180 
	`ho°«me2sockaddr2
(
addr
->addr.
domaö
,

181 
i
,

182 &
ß
,

183 &
gaõº
,

184 
emsg
,

185 (
emsg
)Ë!
NULL
;

186 ++
i
) {

187 
	`SET_SOCKADDRPORT
(&
ß
,

188 
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

189 
addr
->
p‹t
.
t˝
 :áddr->p‹t.
udp
);

191 i‡(
	`addrödex_⁄_li°íli°
(
sockscf
.
öã∫Æ
.
addrc
,

192 
sockscf
.
öã∫Æ
.
addrv
,

193 &
ß
,

194 
¥Ÿocﬁ
) == -1) {

195 i‡(!
ch™gesuµ‹ãd
) {

196 
	`sw¨nx
("cannot change internaláddresses onceÑunning "

198 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0));

208 
	`add_öã∫Æ_ßÁmûy
(
ß
.
ss_Ámûy
);

212 i‡(
	`sockaddr2i‚ame
(&
ß
, 
i‚ame
, (i‚ame)Ë=
NULL
) {

220 
	`yyw¨n
("%s: couldÇot findáddress %s (resolved from %s) on "

222 
fun˘i⁄
,

223 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0),

224 
addr
->addr.
domaö
);

226 
	`STRCPY_ASSERTSIZE
(
i‚ame
, "<unknown>");

229 
	`addöã∫Æaddr
(
i‚ame
, &
ß
, 
¥Ÿocﬁ
);

232 i‡(
i
 == 0)

233 
	`yyîr‹x
("%s", 
emsg
);

238 
SOCKS_ADDR_IFNAME
: {

239 
iÁddrs
 *
iÁp
, *
iÁ˚
;

240 
isvÆidif
;

242 
iÁp
 = 
NULL
;

244 i‡(
	`gëiÁddrs
(&
iÁp
) != 0)

245 
	`£º
("getifaddrs()");

247 
	`SASSERTX
(
iÁp
 !
NULL
);

249 
isvÆidif
 = 0, 
iÁ˚
 = 
iÁp
;

250 
iÁ˚
 !
NULL
;

251 
iÁ˚
 = iÁ˚->
iÁ_√xt
) {

252 i‡(
iÁ˚
->
iÁ_addr
 =
NULL
)

255 i‡(!
	`ßÁmûy_issuµ‹ãd
(
iÁ˚
->
iÁ_addr
->
ß_Ámûy
))

258 i‡(
	`°rcmp
(
iÁ˚
->
iÁ_«me
, 
addr
->addr.
i‚ame
) != 0)

261 
isvÆidif
 = 1;

263 
	`sockaddr˝y
(&
ß
, 
	`TOSS
(
iÁ˚
->
iÁ_addr
), (sa));

265 
	`SET_SOCKADDRPORT
(&
ß
, 
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

266 
addr
->
p‹t
.
t˝
 :áddr->p‹t.
udp
);

268 i‡(
	`addrödex_⁄_li°íli°
(
sockscf
.
öã∫Æ
.
addrc
,

269 
sockscf
.
öã∫Æ
.
addrv
,

270 &
ß
,

271 
¥Ÿocﬁ
) == -1) {

272 i‡(!
ch™gesuµ‹ãd
) {

273 
	`sw¨nx
("cannot change internaláddresses onceÑunning, "

276 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0),

277 
addr
->addr.
i‚ame
);

287 
	`add_öã∫Æ_ßÁmûy
(
ß
.
ss_Ámûy
);

291 
	`addöã∫Æaddr
(
addr
->addr.
i‚ame
, &
ß
, 
¥Ÿocﬁ
);

294 
	`‰ìiÁddrs
(
iÁp
);

296 i‡(!
isvÆidif
)

297 
	`sw¨nx
("ˇ¬Ÿ föd i¡îÁ˚/addªs†f‹ %s", 
addr
->addr.
i‚ame
);

303 
	`SERRX
(
addr
->
©y≥
);

305 
	}
}

308 
	$addexã∫Æ
(
addr
)

309 c⁄° 
ruÀaddr_t
 *
addr
;

311 c⁄° *
fun˘i⁄
 = "addexternal()";

312 
ruÀaddr_t
 
ø
;

313 
added_ùv4
 = 0, 
added_ùv6
 = 0, 
added_ùv6_gs
 = 0;

315 
	`SASSERTX
(
	`¡ohs
(
addr
->
p‹t
.
t˝
) == 0);

316 
	`SASSERTX
(
	`¡ohs
(
addr
->
p‹t
.
udp
) == 0);

318 
addr
->
©y≥
) {

319 
SOCKS_ADDR_DOMAIN
: {

327 
sockaddr_°‹age
 
ß
;

328 
size_t
 
i
;

329 
emsg
[1024];

330 
gaõº
;

332 
i
 = 0;

333 
	`ho°«me2sockaddr2
(
addr
->addr.
domaö
,

334 
i
,

335 &
ß
,

336 &
gaõº
,

337 
emsg
,

338 (
emsg
)Ë!
NULL
;

339 ++
i
) {

340 
	`SET_SOCKADDRPORT
(&
ß
, 
addr
->
p‹t
.
t˝
);

342 
	`sockaddr2ruÀaddr
(&
ß
, &
ø
);

344 i‡(
	`addexã∫Æaddr
(&
ø
) == 0) {

345 
ß
.
ss_Ámûy
) {

346 
AF_INET
:

347 
added_ùv4
 = 1;

350 
AF_INET6
:

351 
added_ùv6
 = 1;

353 i‡(!
	`IN6_IS_ADDR_LINKLOCAL
(&
	`TOIN6
(&
ß
)->
sö6_addr
))

354 
added_ùv6_gs
 = 1;

359 
	`SERRX
(
ß
.
ss_Ámûy
);

364 i‡(
i
 == 0)

365 
	`yyîr‹x
("%s", 
emsg
);

370 
SOCKS_ADDR_IPV4
:

371 i‡(
addr
->addr.
ùv4
.
ù
.
s_addr
 =
	`ht⁄l
(
INADDR_ANY
))

372 
	`yyîr‹x
("externaláddress (%s)Åo connect out from cannot "

374 
	`ruÀaddr2°rög
(
addr
, 0, 
NULL
, 0));

376 
ø
 = *
addr
;

377 
ø
.
addr
.
ùv4
.
mask
.
s_addr
 = 
	`ht⁄l
(
IPV4_FULLNETMASK
);

379 i‡(
	`addexã∫Æaddr
(&
ø
) == 0)

380 
added_ùv4
 = 1;

384 
SOCKS_ADDR_IPV6
:

385 i‡(
	`memcmp
(&
addr
->addr.
ùv6
.
ù
, &
ö6addr_™y
, (in6addr_any))

387 
	`yyîr‹x
("externaláddress (%s) cannot beá wildcardáddress",

388 
	`ruÀaddr2°rög
(
addr
, 0, 
NULL
, 0));

390 
ø
 = *
addr
;

391 
ø
.
addr
.
ùv6
.
maskbôs
 = 
IPV6_NETMASKBITS
;

393 i‡(
	`addexã∫Æaddr
(&
ø
) == 0) {

394 
added_ùv6
 = 1;

396 i‡(!
	`IN6_IS_ADDR_LINKLOCAL
(&
ø
.
addr
.
ùv6
.
ù
))

397 
added_ùv6_gs
 = 1;

402 
SOCKS_ADDR_IFNAME
: {

407 
sockaddr_°‹age
 
ß
, 
t
;

408 
size_t
 
i
;

417 
i
 = 0;

418 
	`i‚ame2sockaddr
(
addr
->addr.
i‚ame
, 
i
, &
ß
, &
t
Ë!
NULL
;

419 ++
i
) {

420 c⁄° 
íabÀd


421 
	`ßÁmûy_i£«bÀd
(
ß
.
ss_Ámûy
,

422 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0),

423 
EXTERNALIF
);

425 
	`¶og
(
LOG_DEBUG
, "%s: ifname %sÑesolvedÅoáddress %s. %s",

426 
fun˘i⁄
,

427 
addr
->addr.
i‚ame
,

428 
	`sockaddr2°rög2
(&
ß
, 
ADDRINFO_ATYPE
, 
NULL
, 0),

429 
íabÀd
 ? "enabled" : "notÉnabled dueÅoáddress family");

431 i‡(!
íabÀd
)

434 
ß
.
ss_Ámûy
) {

435 
AF_INET
:

436 
added_ùv4
 = 1;

439 
AF_INET6
:

440 
added_ùv6
 = 1;

442 i‡(!
	`IN6_IS_ADDR_LINKLOCAL
(&
	`TOIN6
(&
ß
)->
sö6_addr
))

443 
added_ùv6_gs
 = 1;

448 
	`SERRX
(
ß
.
ss_Ámûy
);

455 ()
	`addexã∫Æaddr
(
addr
);

461 
	`SERRX
(
addr
->
©y≥
);

464 i‡(
added_ùv4
)

465 
	`add_exã∫Æ_ßÁmûy
(
AF_INET
, 1);

467 i‡(
added_ùv6
)

468 
	`add_exã∫Æ_ßÁmûy
(
AF_INET6
, 
added_ùv6_gs
);

469 
	}
}

472 
	$ª£tc⁄fig
(
c⁄fig
, 
exôög
)

473 
c⁄fig
 *config;

474 c⁄° 
exôög
;

476 c⁄° *
fun˘i⁄
 = "resetconfig()";

477 c⁄° 
ismaömŸhî
 = 
	`pidismaömŸhî
(
c⁄fig
->
°©e
.
pid
);

478 
ruÀ_t
 *
ruÀv
[] = { 
c⁄fig
->
¸uÀ
, c⁄fig->
hruÀ
, c⁄fig->
§uÀ
 };

479 
m⁄ô‹_t
 *
m⁄ô‹
;

480 
size_t
 
ﬁdc
, 
i
;

482 
	`¶og
(
LOG_DEBUG
, "%s:Éxiting? %s, ismainmother? %s",

483 
fun˘i⁄
,

484 
exôög
 ? "yes" : "no",

485 
ismaömŸhî
? "yes" : "no");

487 i‡(!
exôög
) {

488 #i‡!
HAVE_NO_RESOLVESTUFF


489 
_ªs
.
›ti⁄s
 = 
c⁄fig
->
öôül
.
ªs_›ti⁄s
;

493 
sockscf
.
°©e
.
ty≥
) {

494 
PROC_MOTHER
:

495 
	`mŸhî_¥ec⁄figlﬂd
();

498 
PROC_MONITOR
:

499 
	`m⁄ô‹_¥ec⁄figlﬂd
();

502 
PROC_NEGOTIATE
:

503 
	`√gŸüã_¥ec⁄figlﬂd
();

506 
PROC_REQUEST
:

507 
	`ªque°_¥ec⁄figlﬂd
();

510 
PROC_IO
:

511 
	`io_¥ec⁄figlﬂd
();

523 i‡(
c⁄fig
->
›ti⁄
.
£rvîc
 =1 || !
ismaömŸhî
) {

533 
	`‰ì
(
c⁄fig
->
öã∫Æ
.
addrv
);

534 
c⁄fig
->
öã∫Æ
.
addrv
 = 
NULL
;

535 
c⁄fig
->
öã∫Æ
.
addrc
 = 0;

537 
	`bzîo
(&
c⁄fig
->
öã∫Æ
.
¥Ÿocﬁ
, (config->internal.protocol));

540 
	`bzîo
(&
c⁄fig
->
öã∫Æ
.
log
, (config->internal.log));

547 
	`‰ì
(
c⁄fig
->
exã∫Æ
.
addrv
);

548 
c⁄fig
->
exã∫Æ
.
addrv
 = 
NULL
;

549 
c⁄fig
->
exã∫Æ
.
addrc
 = 0;

551 
c⁄fig
->
exã∫Æ
.
rŸ©i⁄
 = 
ROTATION_NOTSET
;

552 
	`bzîo
(&
c⁄fig
->
exã∫Æ
.
log
, (config->external.log));

553 
	`bzîo
(&
c⁄fig
->
exã∫Æ
.
¥Ÿocﬁ
, (config->external.protocol));

556 
	`bzîo
(&
c⁄fig
->
˝u
, (config->cpu));

558 
i
 = 0; i < 
	`ELEMENTS
(
ruÀv
); ++i) {

559 
ruÀ_t
 *
ruÀ
, 
¥evruÀ
, *
√xt
;

560 
havïªvruÀ
;

562 
havïªvruÀ
 = 0;

563 
ruÀ
 = 
ruÀv
[
i
];

565 
ruÀ
 !
NULL
) {

569 
ruÀ_is_aut€x∑nded
;

571 #i‡!
HAVE_SOCKS_RULES


572 i‡(
ruÀ
->
ty≥
 =
obje˘_§uÀ
) {

578 
√xt
 = 
ruÀ
->next;

579 
	`‰ì
(
ruÀ
);

580 
ruÀ
 = 
√xt
;

586 i‡(
havïªvruÀ


587 && 
¥evruÀ
.
ty≥
 =
ruÀ
->type

588 && 
¥evruÀ
.
numbî
 =
ruÀ
->number) {

589 
	`¶og
(
LOG_DEBUG
,

592 
fun˘i⁄
,

593 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

594 ()
ruÀ
->
numbî
);

596 
ruÀ_is_aut€x∑nded
 = 1;

597 
	`SASSERTX
(
BAREFOOTD
);

600 
ruÀ_is_aut€x∑nded
 = 0;

602 i‡(!
ruÀ_is_aut€x∑nded
)

607 
	`‰ìlöked«me
(
ruÀ
->
u£r
);

608 
ruÀ
->
u£r
 = 
NULL
;

610 i‡(!
ruÀ_is_aut€x∑nded
)

611 
	`‰ìlöked«me
(
ruÀ
->
group
);

612 
ruÀ
->
group
 = 
NULL
;

614 i‡(!
ruÀ_is_aut€x∑nded
)

615 
	`‰ì
(
ruÀ
->
sockë›ti⁄v
);

616 
ruÀ
->
sockë›ti⁄v
 = 
NULL
;

617 
ruÀ
->
sockë›ti⁄c
 = 0;

619 i‡(
ismaömŸhî
) {

632 
size_t
 
m‹eﬁdshmemc
 = 0;

633 
ﬁdshmemöfo_t
 
m‹eﬁdshmemv
[ 1

638 i‡(
ruÀ_is_aut€x∑nded
) {

639 
	`SASSERTX
(
BAREFOOTD
);

640 
	`SHMEM_CLEAR
(
ruÀ
, 
SHMEM_ALL
, 1);

643 i‡(
ruÀ
->
bw_shmid
 != 0) {

644 
m‹eﬁdshmemv
[
m‹eﬁdshmemc
].
id
 = 
ruÀ
->
bw_shmid
;

645 
m‹eﬁdshmemv
[
m‹eﬁdshmemc
].
key
 = 
key_un£t
;

646 
m‹eﬁdshmemv
[
m‹eﬁdshmemc
].
ty≥
 = 
SHMEM_BW
;

648 ++
m‹eﬁdshmemc
;

651 i‡(
ruÀ
->
ss_shmid
 != 0) {

656 i‡(
	`sockd_shm©
(
ruÀ
, 
SHMEM_SS
) == 0) {

657 
m‹eﬁdshmemv
[
m‹eﬁdshmemc
].
id
 = 
ruÀ
->
ss_shmid
;

658 
m‹eﬁdshmemv
[
m‹eﬁdshmemc
].
key
 = 
ruÀ
->
ss
->
key°©e
.key;

659 
m‹eﬁdshmemv
[
m‹eﬁdshmemc
].
ty≥
 = 
SHMEM_SS
;

661 ++
m‹eﬁdshmemc
;

663 
	`sockd_shmdt
(
ruÀ
, 
SHMEM_SS
);

667 i‡(
m‹eﬁdshmemc
 > 0)

668 
	`add_m‹e_ﬁd_shmem
(
c⁄fig
, 
m‹eﬁdshmemc
, 
m‹eﬁdshmemv
);

672 
¥evruÀ
 = *
ruÀ
;

673 
havïªvruÀ
 = 1;

675 
√xt
 = 
ruÀ
->next;

676 
	`‰ì
(
ruÀ
);

677 
ruÀ
 = 
√xt
;

681 
c⁄fig
->
¸uÀ
 = c⁄fig->
hruÀ
 = c⁄fig->
§uÀ
 = 
NULL
;

684 
	`bzîo
(&
c⁄fig
->
rouã›ti⁄s
, (config->routeoptions));

687 
	`‰ìrouãli°
(
c⁄fig
->
rouã
);

688 
c⁄fig
->
rouã
 = 
NULL
;

691 
m⁄ô‹
 = 
sockscf
.monitor;

692 
m⁄ô‹
 !
NULL
) {

693 
m⁄ô‹_t
 *
√xt
 = 
m⁄ô‹
->next;

695 i‡(
ismaömŸhî
 && 
m⁄ô‹
->
m°©s_shmid
 != 0) {

696 
ﬁdshmemöfo_t
 
m‹eﬁdshmemv
[ 1 ];

698 
m‹eﬁdshmemv
[0].
id
 = 
m⁄ô‹
->
m°©s_shmid
;

699 
m‹eﬁdshmemv
[0].
key
 = 
key_un£t
;

700 
m‹eﬁdshmemv
[0].
ty≥
 = 
SHMEM_MONITOR
;

702 
	`add_m‹e_ﬁd_shmem
(
c⁄fig
, 
	`ELEMENTS
(
m‹eﬁdshmemv
), moreoldshmemv);

705 
	`‰ì
(
m⁄ô‹
);

706 
m⁄ô‹
 = 
√xt
;

708 
c⁄fig
->
m⁄ô‹
 = 
NULL
;

711 
	`bzîo
(&
c⁄fig
->
m⁄ô‹•ec
, (config->monitorspec));

713 
	`‰ì
(
c⁄fig
->
sockë›ti⁄v
);

714 
c⁄fig
->
sockë›ti⁄v
 = 
NULL
;

715 
c⁄fig
->
sockë›ti⁄c
 = 0;

718 
	`bzîo
(&
c⁄fig
->
com∑t
, (config->compat));

721 
	`bzîo
(&
c⁄fig
->
exãnsi⁄
, (config->extension));

734 
	`bzîo
(&
c⁄fig
->
ªsﬁvïrŸocﬁ
, (config->resolveprotocol));

742 
	`bzîo
(&
c⁄fig
->
§cho°
, (config->srchost));

750 
c⁄fig
->
°©e
.
highe°fdöu£
 = 0;

753 
	`bzîo
(&
c⁄fig
->
timeout
, (config->timeout));

755 #i‡
HAVE_SOLARIS_PRIVS


766 
	`bzîo
(
c⁄fig
->
cmëhodv
, (config->cmethodv));

767 
c⁄fig
->
cmëhodc
 = 0;

769 
	`bzîo
(
c⁄fig
->
smëhodv
, (config->smethodv));

770 
c⁄fig
->
smëhodc
 = 0;

774 #i‡
HAVE_LIBWRAP


775 i‡(
c⁄fig
->
ho°s_Ælow_‹igöÆ
 !
NULL


776 && 
ho°s_Ælow_èbÀ
 !
c⁄fig
->
ho°s_Ælow_‹igöÆ
) {

777 
	`‰ì
(
ho°s_Ælow_èbÀ
);

778 
ho°s_Ælow_èbÀ
 = 
c⁄fig
->
ho°s_Ælow_‹igöÆ
;

781 i‡(
c⁄fig
->
ho°s_díy_‹igöÆ
 !
NULL


782 && 
ho°s_díy_èbÀ
 !
c⁄fig
->
ho°s_díy_‹igöÆ
) {

783 
	`‰ì
(
ho°s_díy_èbÀ
);

784 
ho°s_díy_èbÀ
 = 
c⁄fig
->
ho°s_díy_‹igöÆ
;

788 i‡(
exôög
 && 
ismaömŸhî
 && 
c⁄fig
->
ﬁdshmemc
 > 0) {

810 
	`SASSERTX
(
ismaömŸhî
);

811 
	`SASSERTX
(
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
);

820 
	`socks_lock
(
c⁄fig
->
shmemfd
, 0, 0, 1, 1);

822 
	`¶og
(
LOG_DEBUG
, "%s: %ld old shmemÉntr%s saved. DeletingÇow",

823 
fun˘i⁄
, ()
c⁄fig
->
ﬁdshmemc
,

824 
c⁄fig
->
ﬁdshmemc
 == 1 ? "y" : "ies");

826 
ﬁdc
 = 0; old¯< 
c⁄fig
->
ﬁdshmemc
; ++oldc) {

827 
‚ame
[
PATH_MAX
];

829 
	`¢¥ötf
(
‚ame
, (fname), "%s",

830 
	`sockd_gëshmem«me
(
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
id
, 
key_un£t
));

832 
	`¶og
(
LOG_DEBUG
,

834 
fun˘i⁄
,

835 ()
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
id
,

836 
‚ame
,

837 ()
ﬁdc
);

839 i‡(
	`u∆ök
(
‚ame
) != 0)

840 
	`sw¨n
("%s: failedÅo unlink shmem segment %ld in file %s",

841 
fun˘i⁄
, 
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
id
, 
‚ame
);

843 i‡(
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
key
 !
key_un£t
) {

844 
	`¢¥ötf
(
‚ame
, (fname), "%s",

845 
	`sockd_gëshmem«me
(
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
id
,

846 
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
key
));

848 
	`¶og
(
LOG_DEBUG
,

850 
fun˘i⁄
,

851 ()
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
id
,

852 ()
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
key
,

853 
‚ame
);

855 i‡(
	`u∆ök
(
‚ame
) != 0)

856 
	`sw¨n
("%s: failedÅo unlink shmem segment %ld.%d in file %s",

857 
fun˘i⁄
,

858 
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
id
,

859 ()
c⁄fig
->
ﬁdshmemv
[
ﬁdc
].
key
,

860 
‚ame
);

864 
	}
}

867 
	$‰ìrouãli°
(
rouãhód
)

868 
rouã_t
 *
rouãhód
;

871 
rouãhód
 !
NULL
) {

872 
rouã_t
 *
√xt
 = 
rouãhód
->next;

874 
	`‰ì
(
rouãhód
->
sockë›ti⁄v
);

875 
	`‰ì
(
rouãhód
);

876 
rouãhód
 = 
√xt
;

878 
	}
}

881 
	$addrisbödabÀ
(
addr
)

882 c⁄° 
ruÀaddr_t
 *
addr
;

884 c⁄° *
fun˘i⁄
 = "addrisbindable()";

885 
sockaddr_°‹age
 
ßddr
;

886 
rc
, 
s
;

888 
addr
->
©y≥
) {

889 
SOCKS_ADDR_IPV4
:

890 
SOCKS_ADDR_IPV6
:

891 
	`socksho°2sockaddr
(
	`ruÀaddr2socksho°
(
addr
, 
NULL
, 
SOCKS_TCP
), &
ßddr
);

894 
SOCKS_ADDR_IFNAME
: {

895 
sockaddr_°‹age
 
mask
;

897 i‡(
	`i‚ame2sockaddr
(
addr
->addr.
i‚ame
, 0, &
ßddr
, &
mask
Ë=
NULL
) {

898 
	`sw¨n
("%s: cannot find interfaceÇamed %s with ip configured",

899 
fun˘i⁄
, 
addr
->addr.
i‚ame
);

907 
SOCKS_ADDR_DOMAIN
: {

908 
socksho°_t
 
ho°
;

910 
	`socksho°2sockaddr
(
	`ruÀaddr2socksho°
(
addr
, &
ho°
, 
SOCKS_TCP
), &
ßddr
);

911 i‡(!
	`IPADDRISBOUND
(&
ßddr
)) {

912 
	`sw¨nx
("%s canÇotÑesolve host %s: %s",

913 
fun˘i⁄
,

914 
	`socksho°2°rög
(&
ho°
, 
NULL
, 0),

915 
	`h°ªº‹
(
h_î∫o
));

924 
	`SERRX
(
addr
->
©y≥
);

927 i‡((
s
 = 
	`sockë
(
ßddr
.
ss_Ámûy
, 
SOCK_STREAM
, 0)) == -1) {

928 
	`sw¨n
("%s: sockë(SOCK_STREAM)", 
fun˘i⁄
);

932 
rc
 = 
	`socks_böd
(
s
, &
ßddr
, 0);

933 
	`˛o£
(
s
);

935 i‡(
rc
 != 0)

936 
	`sw¨n
("%s: cannot bindáddress: %s (fromáddress specification %s)",

937 
fun˘i⁄
,

938 
	`sockaddr2°rög
(&
ßddr
, 
NULL
, 0),

939 
	`ruÀaddr2°rög
(
addr
, 0, 
NULL
, 0));

941  
rc
 == 0;

942 
	}
}

945 
	$i§ïlycomm™d⁄ly
(
comm™d
)

946 c⁄° 
comm™d_t
 *
comm™d
;

949 i‡((
comm™d
->
bödª∂y
 || comm™d->
ud¥ïly
)

950 && !(
comm™d
->
c⁄√˘
 || comm™d->
böd
 || comm™d->
ud∑ssocüã
))

954 
	}
}

957 
	$ha§ïlycomm™ds
(
comm™d
)

958 c⁄° 
comm™d_t
 *
comm™d
;

961 i‡(
comm™d
->
bödª∂y
 || comm™d->
ud¥ïly
)

965 
	}
}

968 
ssize_t


969 
	$addrödex_⁄_li°íli°
(
li°c
, 
li°v
, 
_addr
, 
¥Ÿocﬁ
)

970 c⁄° 
size_t
 
li°c
;

971 c⁄° 
li°íaddªss_t
 *
li°v
;

972 c⁄° 
sockaddr_°‹age
 *
_addr
;

973 c⁄° 
¥Ÿocﬁ
;

975 
size_t
 
i
;

977 
i
 = 0; i < 
li°c
; ++i) {

978 
sockaddr_°‹age
 
addr
 = *(c⁄° sockaddr_°‹agê*)
_addr
;

980 i‡(
li°v
[
i
].
¥Ÿocﬁ
 !=Örotocol)

983 i‡(
	`GET_SOCKADDRPORT
(&
addr
Ë=
	`ht⁄s
(0))

984 
	`SET_SOCKADDRPORT
(&
addr
, 
	`GET_SOCKADDRPORT
(&
li°v
[
i
].addr));

986 i‡(
	`sockaddøªeq
(&
addr
, &
li°v
[
i
].addr, 0))

987  (
ssize_t
)
i
;

990  (
ssize_t
)-1;

991 
	}
}

993 
ssize_t


994 
	$addrödex_⁄_exã∫Æli°
(
exã∫Æ
, 
_addr
)

995 c⁄° 
exã∫Æaddªss_t
 *
exã∫Æ
;

996 c⁄° 
sockaddr_°‹age
 *
_addr
;

998 c⁄° *
fun˘i⁄
 = "addrindex_on_externallist()";

999 
sockaddr_°‹age
 
ß
, 
addr
;

1000 
size_t
 
i
;

1005 
	`sockaddr˝y
(&
addr
, 
_addr
, (addr));

1006 
	`SET_SOCKADDRPORT
(&
addr
, 
	`ht⁄s
(0));

1008 
	`¶og
(
LOG_DEBUG
,

1010 
fun˘i⁄
, 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

1012 
i
 = 0; i < 
exã∫Æ
->
addrc
; ++i) {

1013 
	`¶og
(
LOG_DEBUG
, "%s:Éxternaláddress #%lu: %s",

1014 
fun˘i⁄
,

1015 ()
i
,

1016 
	`ruÀaddr2°rög
(&
exã∫Æ
->
addrv
[
i
], 
ADDRINFO_ATYPE
, 
NULL
, 0));

1018 
exã∫Æ
->
addrv
[
i
].
©y≥
) {

1019 
SOCKS_ADDR_IPV4
:

1020 
SOCKS_ADDR_IPV6
: {

1021 
socksho°_t
 
ho°
;

1023 
	`socksho°2sockaddr
(
	`ruÀaddr2socksho°
(&
exã∫Æ
->
addrv
[
i
],

1024 &
ho°
,

1025 
SOCKS_TCP
),

1026 &
ß
);

1027 #i‡
DIAGNOSTIC


1028 
	`SASSERTX
(
	`ßÁmûy_i£«bÀd
(
ß
.
ss_Ámûy
,

1029 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0),

1030 
EXTERNALIF
));

1033 i‡(
	`sockaddøªeq
(&
addr
, &
ß
, 0))

1034  (
ssize_t
)
i
;

1038 
SOCKS_ADDR_DOMAIN
: {

1039 
emsg
[1024];

1040 
gaõº
;

1041 
size_t
 
ii
;

1043 
ii
 = 0;

1044 
	`ho°«me2sockaddr2
(
exã∫Æ
->
addrv
[
i
].
addr
.
domaö
,

1045 
ii
++,

1046 &
ß
,

1047 &
gaõº
,

1048 
emsg
,

1049 (
emsg
)Ë!
NULL
) {

1050 
	`¶og
(
LOG_DEBUG
, "%s: checkingÑesolvedáddress %s ...",

1051 
fun˘i⁄
, 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0));

1053 i‡(!
	`ßÁmûy_i£«bÀd
(
ß
.
ss_Ámûy
,

1054 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0),

1055 
EXTERNALIF
))

1058 i‡(
	`sockaddøªeq
(&
addr
, &
ß
, 0))

1059  (
ssize_t
)
i
;

1062 i‡(
ii
 == 0)

1063 
	`sw¨nx
("%s:Öroblem witháddress onÉxternal interface: %s",

1064 
fun˘i⁄
, 
emsg
);

1069 
SOCKS_ADDR_IFNAME
: {

1070 
sockaddr_°‹age
 
mask
;

1071 
size_t
 
ii
;

1073 
ii
 = 0;

1074 
	`i‚ame2sockaddr
(
exã∫Æ
->
addrv
[
i
].
addr
.
i‚ame
,

1075 
ii
++,

1076 &
ß
,

1077 &
mask
Ë!
NULL
) {

1078 i‡(!
	`ßÁmûy_i£«bÀd
(
ß
.
ss_Ámûy
,

1079 
	`sockaddr2°rög
(&
ß
, 
NULL
, 0),

1080 
EXTERNALIF
))

1083 i‡(
	`sockaddøªeq
(&
addr
, &
ß
, 0))

1084  (
ssize_t
)
i
;

1091 
	`SERRX
(
exã∫Æ
->
addrv
[
i
].
©y≥
);

1095  (
ssize_t
)-1;

1096 
	}
}

1099 
	$checkc⁄fig
()

1101 c⁄° *
fun˘i⁄
 = "checkconfig()";

1103 #i‡
HAVE_PAM


1104 *
∑m£rvi˚«me
 = 
NULL
;

1107 #i‡
HAVE_BSDAUTH


1108 *
bsdauth°yÀ«me
 = 
NULL
;

1111 #i‡
HAVE_GSSAPI


1112 *
gsßpi£rvi˚«me
 = 
NULL
, *
gsßpikeyèb
 = NULL;

1117 
ruÀ_t
 *
ruÀba£v
[] = { 
sockscf
.
¸uÀ
,

1118 
sockscf
.
hruÀ
,

1119 
sockscf
.
§uÀ


1122 #i‡
HAVE_PAM
 || 
HAVE_BSDAUTH
 || 
HAVE_GSSAPI


1123 *
mëhodba£v
[] = { 
sockscf
.
cmëhodv
,

1124 
sockscf
.
cmëhodv
,

1125 
sockscf
.
smëhodv


1128 
size_t
 *
mëhodba£c
[] = { &
sockscf
.
cmëhodc
,

1129 &
sockscf
.
cmëhodc
,

1130 &
sockscf
.
smëhodc


1134 
size_t
 
i
, 
ba£c
;

1135 
usöglibwøp
 = 0;

1137 
i
 = 0; i < 
sockscf
.
cmëhodc
; ++i) {

1138 
	`SASSERTX
(
sockscf
.
cmëhodv
[
i
] >
AUTHMETHOD_NONE
);

1139 
	`SASSERTX
(
sockscf
.
cmëhodv
[
i
] <
AUTHMETHOD_MAX
);

1141 
	`SASSERTX
(
	`mëhodisvÆid
(
sockscf
.
cmëhodv
[
i
], 
obje˘_¸uÀ
));

1143 i‡(
sockscf
.
cmëhodv
[
i
] =
AUTHMETHOD_RFC931
)

1144 
usöglibwøp
 = 1;

1147 #i‡
HAVE_SOCKS_RULES


1148 i‡(
sockscf
.
smëhodc
 == 0)

1149 
	`sw¨nx
("%s:Ço socksáuthentication methodsÉnabled. This meansáll "

1152 
fun˘i⁄
);

1154 
i
 = 0; i < 
sockscf
.
smëhodc
; ++i) {

1155 
	`SASSERTX
(
sockscf
.
smëhodv
[
i
] >
AUTHMETHOD_NONE
);

1156 
	`SASSERTX
(
sockscf
.
smëhodv
[
i
] <
AUTHMETHOD_MAX
);

1158 i‡(
sockscf
.
smëhodv
[
i
] =
AUTHMETHOD_RFC931
)

1159 
usöglibwøp
 = 1;

1161 i‡(
sockscf
.
smëhodv
[
i
] =
AUTHMETHOD_NONE


1162 && 
i
 + 1 < 
sockscf
.
smëhodc
)

1163 
	`yyw¨nx
("authentication method \"%s\" is configured inÅhe "

1169 
	`mëhod2°rög
(
sockscf
.
smëhodv
[
i
]),

1170 
	`mëhod2°rög
(
sockscf
.
smëhodv
[
i
 + 1]));

1180 
ba£c
 = 0;

1181 
ba£c
 < 
	`ELEMENTS
(
ruÀba£v
)) {

1182 
ruÀ_t
 *
ruÀ
 = 
ruÀba£v
[
ba£c
++];

1184 i‡(
ruÀ
 =
NULL
)

1187 ; 
ruÀ
 !
NULL
;ÑuÀ =ÑuÀ->
√xt
) {

1188 
size_t
 
mëhodc
;

1189 *
mëhodv
;

1192 #i‡
HAVE_LIBWRAP


1193 i‡(*
ruÀ
->
libwøp
 !
NUL
)

1194 
usöglibwøp
 = 1;

1201 
ruÀ
->
ty≥
) {

1202 
obje˘_¸uÀ
:

1203 #i‡
HAVE_SOCKS_HOSTID


1204 
obje˘_hruÀ
:

1206 
mëhodc
 = 
ruÀ
->
°©e
.
cmëhodc
;

1207 
mëhodv
 = 
ruÀ
->
°©e
.
cmëhodv
;

1210 
obje˘_§uÀ
:

1211 
mëhodc
 = 
ruÀ
->
°©e
.
smëhodc
;

1212 
mëhodv
 = 
ruÀ
->
°©e
.
smëhodv
;

1216 
	`SERRX
(
ruÀ
->
ty≥
);

1219 
i
 = 0; i < 
mëhodc
; ++i) {

1220 
mëhodv
[
i
]) {

1221 #i‡
HAVE_PAM


1222 
AUTHMETHOD_PAM_ANY
:

1223 
AUTHMETHOD_PAM_ADDRESS
:

1224 
AUTHMETHOD_PAM_USERNAME
:

1225 i‡(*
sockscf
.
°©e
.
∑m£rvi˚«me
 =
NUL
)

1228 i‡(
∑m£rvi˚«me
 =
NULL
)

1229 
∑m£rvi˚«me
 = 
ruÀ
->
°©e
.pamservicename;

1230 i‡(
	`°rcmp
(
∑m£rvi˚«me
, 
ruÀ
->
°©e
.pamservicename)

1232 
	`¶og
(
LOG_DEBUG
, "%s:Öam.servicename varies, %sÇe %s",

1233 
fun˘i⁄
,

1234 
∑m£rvi˚«me
,

1235 
ruÀ
->
°©e
.
∑m£rvi˚«me
);

1237 *
sockscf
.
°©e
.
∑m£rvi˚«me
 = 
NUL
;

1243 #i‡
HAVE_BSDAUTH


1244 
AUTHMETHOD_BSDAUTH
:

1245 i‡(*
sockscf
.
°©e
.
bsdauth°yÀ«me
 =
NUL
)

1248 i‡(
bsdauth°yÀ«me
 =
NULL
)

1249 
bsdauth°yÀ«me
 = 
ruÀ
->
°©e
.bsdauthstylename;

1250 i‡(
	`°rcmp
(
bsdauth°yÀ«me
,

1251 
ruÀ
->
°©e
.
bsdauth°yÀ«me
) != 0) {

1252 
	`¶og
(
LOG_DEBUG
,

1254 
fun˘i⁄
,

1255 
bsdauth°yÀ«me
,

1256 
ruÀ
->
°©e
.
bsdauth°yÀ«me
);

1258 *
sockscf
.
°©e
.
bsdauth°yÀ«me
 = 
NUL
;

1264 #i‡
HAVE_GSSAPI


1265 
AUTHMETHOD_GSSAPI
:

1266 i‡(*
sockscf
.
°©e
.
gsßpi£rvi˚«me
 !
NUL
) {

1267 i‡(
gsßpi£rvi˚«me
 =
NULL
)

1268 
gsßpi£rvi˚«me
 = 
ruÀ
->
°©e
.gssapiservicename;

1269 i‡(
	`°rcmp
(
gsßpi£rvi˚«me
,

1270 
ruÀ
->
°©e
.
gsßpi£rvi˚«me
) != 0) {

1271 
	`¶og
(
LOG_DEBUG
,

1273 
fun˘i⁄
,

1274 
gsßpi£rvi˚«me
,

1275 
ruÀ
->
°©e
.
gsßpi£rvi˚«me
);

1277 *
sockscf
.
°©e
.
gsßpi£rvi˚«me
 = 
NUL
;

1282 i‡(*
sockscf
.
°©e
.
gsßpikeyèb
 !
NUL
) {

1283 i‡(
gsßpikeyèb
 =
NULL
)

1284 
gsßpikeyèb
 = 
ruÀ
->
°©e
.gssapikeytab;

1285 i‡(
	`°rcmp
(
gsßpikeyèb
, 
ruÀ
->
°©e
.gssapikeytab)

1287 
	`¶og
(
LOG_DEBUG
, "%s: gssapi.keytab varies, %sÇe %s",

1288 
fun˘i⁄
,

1289 
gsßpikeyèb
,

1290 
ruÀ
->
°©e
.
gsßpikeyèb
);

1292 *
sockscf
.
°©e
.
gsßpikeyèb
 = 
NUL
;

1305 #i‡
BAREFOOTD


1306 i‡(
ruÀ
->
ty≥
 =
obje˘_¸uÀ
) {

1307 i‡(
ruÀ
->
°©e
.
¥Ÿocﬁ
.
t˝
)

1312 
	`addöã∫Æ
(&
ruÀ
->
d°
, 
SOCKS_TCP
);

1314 i‡(
ruÀ
->
°©e
.
¥Ÿocﬁ
.
udp
)

1315 
sockscf
.
°©e
.
Æludpboun˚d
 = 0;

1325 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

1326 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

1328 
	`sockd_¥iv
(
SOCKD_PRIV_UNPRIVILEGED
, 
PRIV_ON
);

1329 
	`sockd_¥iv
(
SOCKD_PRIV_UNPRIVILEGED
, 
PRIV_OFF
);

1331 
	`sockd_¥iv
(
SOCKD_PRIV_LIBWRAP
, 
PRIV_ON
);

1332 
	`sockd_¥iv
(
SOCKD_PRIV_LIBWRAP
, 
PRIV_OFF
);

1334 #i‡!
HAVE_PRIVILEGES


1335 
	`SASSERTX
(
sockscf
.
°©e
.
euid
 =
	`gëeuid
());

1336 
	`SASSERTX
(
sockscf
.
°©e
.
egid
 =
	`gëegid
());

1338 i‡(
sockscf
.
uid
.
u≈rivûeged_uid
 == 0)

1339 
	`sw¨nx
("%s: settingÅhe unprivileged uidÅo %d isÇotÑecommended "

1341 
fun˘i⁄
, 
sockscf
.
uid
.
u≈rivûeged_uid
);

1343 #i‡
HAVE_LIBWRAP


1344 i‡(
usöglibwøp
 && 
sockscf
.
uid
.
libwøp_uid
 == 0)

1345 
	`sw¨nx
("%s: settingÅheÜibwrap uidÅo %d isálmostÇeverÇeeded,ánd "

1347 
fun˘i⁄
, 
sockscf
.
uid
.
libwøp_uid
);

1351 #i‡
HAVE_PAM


1352 i‡(*
sockscf
.
°©e
.
∑m£rvi˚«me
 !
NUL


1353 && 
∑m£rvi˚«me
 !
NULL
) {

1365 i‡(
	`°rcmp
(
∑m£rvi˚«me
, 
sockscf
.
°©e
.pamservicename) != 0)

1366 
	`STRCPY_CHECKLEN
(
sockscf
.
°©e
.
∑m£rvi˚«me
,

1367 
∑m£rvi˚«me
,

1368 (
sockscf
.
°©e
.
∑m£rvi˚«me
) - 1,

1369 
yyîr‹x
);

1373 #i‡
HAVE_BSDAUTH


1374 i‡(*
sockscf
.
°©e
.
bsdauth°yÀ«me
 !
NUL


1375 && 
bsdauth°yÀ«me
 !
NULL
) {

1376 i‡(
	`°rcmp
(
bsdauth°yÀ«me
, 
sockscf
.
°©e
.bsdauthstylename) != 0)

1377 
	`STRCPY_CHECKLEN
(
sockscf
.
°©e
.
bsdauth°yÀ«me
,

1378 
bsdauth°yÀ«me
,

1379 (
sockscf
.
°©e
.
bsdauth°yÀ«me
) - 1,

1380 
yyîr‹x
);

1384 #i‡
HAVE_GSSAPI


1385 i‡(*
sockscf
.
°©e
.
gsßpi£rvi˚«me
 !
NUL


1386 && 
gsßpi£rvi˚«me
 !
NULL
) {

1387 i‡(
	`°rcmp
(
gsßpi£rvi˚«me
, 
sockscf
.
°©e
.gssapiservicename) != 0)

1388 
	`STRCPY_CHECKLEN
(
sockscf
.
°©e
.
gsßpi£rvi˚«me
,

1389 
gsßpi£rvi˚«me
,

1390 (
sockscf
.
°©e
.
gsßpi£rvi˚«me
) - 1,

1391 
yyîr‹x
);

1394 i‡(*
sockscf
.
°©e
.
gsßpikeyèb
 !
NUL


1395 && 
gsßpikeyèb
 !
NULL
) {

1396 i‡(
	`°rcmp
(
gsßpikeyèb
, 
sockscf
.
°©e
.gssapikeytab) != 0)

1397 
	`STRCPY_CHECKLEN
(
sockscf
.
°©e
.
gsßpikeyèb
,

1398 
gsßpikeyèb
,

1399 (
sockscf
.
°©e
.
gsßpikeyèb
) - 1,

1400 
yyîr‹x
);

1408 
ba£c
 = 0;

1409 
ba£c
 < 
	`ELEMENTS
(
ruÀba£v
)) {

1410 #i‡
HAVE_PAM
 || 
HAVE_BSDAUTH
 || 
HAVE_GSSAPI


1411 c⁄° *
mëhodv
 = 
mëhodba£v
[
ba£c
];

1412 c⁄° 
size_t
 
mëhodc
 = *
mëhodba£c
[
ba£c
];

1415 
ruÀ_t
 *
ruÀ
 = 
ruÀba£v
[
ba£c
];

1416 ++
ba£c
;

1418 i‡(
ruÀ
 =
NULL
)

1421 ; 
ruÀ
 !
NULL
;ÑuÀ =ÑuÀ->
√xt
) {

1422 #i‡
HAVE_PAM


1423 i‡(
	`mëhodis£t
(
AUTHMETHOD_PAM_ANY
, 
mëhodv
, 
mëhodc
)

1424 || 
	`mëhodis£t
(
AUTHMETHOD_PAM_ADDRESS
, 
mëhodv
, 
mëhodc
)

1425 || 
	`mëhodis£t
(
AUTHMETHOD_PAM_USERNAME
, 
mëhodv
, 
mëhodc
))

1426 i‡(*
ruÀ
->
°©e
.
∑m£rvi˚«me
 =
NUL
)

1427 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
∑m£rvi˚«me
,

1428 
sockscf
.
°©e
.
∑m£rvi˚«me
);

1431 #i‡
HAVE_BSDAUTH


1432 i‡(
	`mëhodis£t
(
AUTHMETHOD_BSDAUTH
, 
mëhodv
, 
mëhodc
))

1433 i‡(*
ruÀ
->
°©e
.
bsdauth°yÀ«me
 =
NUL
) {

1434 i‡(*
sockscf
.
°©e
.
bsdauth°yÀ«me
 !
NUL
)

1435 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
bsdauth°yÀ«me
,

1436 
sockscf
.
°©e
.
bsdauth°yÀ«me
);

1440 #i‡
HAVE_GSSAPI


1441 i‡(
	`mëhodis£t
(
AUTHMETHOD_GSSAPI
, 
mëhodv
, 
mëhodc
)) {

1442 i‡(*
ruÀ
->
°©e
.
gsßpi£rvi˚«me
 =
NUL
)

1443 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
gsßpi£rvi˚«me
,

1444 
sockscf
.
°©e
.
gsßpi£rvi˚«me
);

1446 i‡(*
ruÀ
->
°©e
.
gsßpikeyèb
 =
NUL
)

1447 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
gsßpikeyèb
,

1448 
sockscf
.
°©e
.
gsßpikeyèb
);

1454 i‡(
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
˛ór
 == 0

1455 && 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
 == 0

1456 && 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
 == 0

1457 && 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
≥rmesßge
 == 0) {

1458 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
˛ór
 = 1;

1459 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
öãgrôy
 = 1;

1460 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
c⁄fidítülôy
 = 1;

1461 
ruÀ
->
°©e
.
gsßpõn¸y±i⁄
.
≥rmesßge
 = 0;

1466 #i‡
HAVE_LDAP


1467 i‡(*
ruÀ
->
°©e
.
ld≠
.
keyèb
 =
NUL
)

1468 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
keyèb
, 
DEFAULT_GSSAPIKEYTAB
);

1470 i‡(*
ruÀ
->
°©e
.
ld≠
.
fûãr
 =
NUL
)

1471 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
fûãr
, 
DEFAULT_LDAP_FILTER
);

1473 i‡(*
ruÀ
->
°©e
.
ld≠
.
fûãr_AD
 =
NUL
)

1474 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
fûãr_AD
,

1475 
DEFAULT_LDAP_FILTER_AD
);

1477 i‡(*
ruÀ
->
°©e
.
ld≠
.
©åibuã
 =
NUL
)

1478 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
©åibuã
,

1479 
DEFAULT_LDAP_ATTRIBUTE
);

1481 i‡(*
ruÀ
->
°©e
.
ld≠
.
©åibuã_AD
 =
NUL
)

1482 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
©åibuã_AD
,

1483 
DEFAULT_LDAP_ATTRIBUTE_AD
);

1485 i‡(*
ruÀ
->
°©e
.
ld≠
.
˚πfûe
 =
NUL
)

1486 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
˚πfûe
,

1487 
DEFAULT_LDAP_CACERTFILE
);

1489 i‡(*
ruÀ
->
°©e
.
ld≠
.
˚π∑th
 =
NUL
)

1490 
	`STRCPY_ASSERTSIZE
(
ruÀ
->
°©e
.
ld≠
.
˚π∑th
,

1491 
DEFAULT_LDAP_CERTDBPATH
);

1493 i‡(
ruÀ
->
°©e
.
ld≠
.
p‹t
 == 0)

1494 
ruÀ
->
°©e
.
ld≠
.
p‹t
 = 
SOCKD_EXPLICIT_LDAP_PORT
;

1496 i‡(
ruÀ
->
°©e
.
ld≠
.
p‹ts¶
 == 0)

1497 
ruÀ
->
°©e
.
ld≠
.
p‹ts¶
 = 
SOCKD_EXPLICIT_LDAPS_PORT
;

1502 #i‡
BAREFOOTD


1503 i‡(
sockscf
.
öã∫Æ
.
addrc
 =0 && 
	`ALL_UDP_BOUNCED
())

1504 
	`£ºx
("%s:Çÿ˛õ¡-ruÀ†tÿac˚± clõ¡†⁄ s≥cifõd", 
fun˘i⁄
);

1507 i‡(
sockscf
.
öã∫Æ
.
addrc
 == 0)

1508 
	`£ºx
("%s:Ço internaláddress given for serverÅoÜisten for clients on",

1509 
fun˘i⁄
);

1513 i‡(
sockscf
.
exã∫Æ
.
addrc
 == 0)

1514 
	`£ºx
("%s:ÇoÉxternaláddress specified for serverÅo use when "

1516 
fun˘i⁄
);

1518 i‡(
sockscf
.
exã∫Æ
.
rŸ©i⁄
 =
ROTATION_NONE
) {

1519 
size_t
 
ùv4c
 = 0, 
ùv6c
 = 0;

1521 
i
 = 0; i < 
sockscf
.
exã∫Æ
.
addrc
; ++i) {

1522 
sockscf
.
exã∫Æ
.
addrv
[
i
].
©y≥
) {

1523 
SOCKS_ADDR_IPV4
:

1524 ++
ùv4c
;

1527 
SOCKS_ADDR_IPV6
:

1528 ++
ùv6c
;

1531 
SOCKS_ADDR_IFNAME
:

1532 
SOCKS_ADDR_DOMAIN
:

1536 
	`SERRX
(
sockscf
.
exã∫Æ
.
addrv
[
i
].
©y≥
);

1540 i‡(
ùv4c
 > 1 || 
ùv6c
 > 1)

1541 
	`sw¨nx
("%s: moreÅhan oneÉxternaláddress has been specified, but "

1544 
fun˘i⁄
, 
	`rŸ©i⁄2°rög
(
sockscf
.
exã∫Æ
.
rŸ©i⁄
));

1547 i‡(
sockscf
.
exã∫Æ
.
rŸ©i⁄
 =
ROTATION_SAMESAME


1548 && 
sockscf
.
exã∫Æ
.
addrc
 == 1)

1549 
	`sw¨nx
("%s:Ñotation forÉxternaláddresses is setÅo same-same, but "

1552 
fun˘i⁄
);

1554 i‡(
sockscf
.
rouã›ti⁄s
.
maxÁû
 =0 && sockscf.rouã›ti⁄s.
badexpúe
 != 0)

1555 
	`sw¨nx
("%s: it doesÇot make senseÅo set \"route.badexpire\" "

1557 
fun˘i⁄
);

1559 #i‡
COVENANT


1560 i‡(*
sockscf
.
ªÆm«me
 =
NUL
)

1561 
	`STRCPY_ASSERTSIZE
(
sockscf
.
ªÆm«me
, 
DEFAULT_REALMNAME
);

1564 #i‡
HAVE_SCHED_SETAFFINITY


1566 c⁄° 
˝u£âög_t
 *
˝uv
[] = { &
sockscf
.
˝u
.
mŸhî
,

1567 &
sockscf
.
˝u
.
m⁄ô‹
,

1568 &
sockscf
.
˝u
.
√gŸüã
,

1569 &
sockscf
.
˝u
.
ªque°
,

1570 &
sockscf
.
˝u
.
io
 };

1572 c⁄° 
¥o˘y≥v
[] = { 
PROC_MOTHER
,

1573 
PROC_MONITOR
,

1574 
PROC_NEGOTIATE
,

1575 
PROC_REQUEST
,

1576 
PROC_IO
 };

1577 
size_t
 
i
;

1579 
i
 = 0; i < 
	`ELEMENTS
(
˝uv
); ++i)

1580 i‡(
˝uv
[
i
]->
afföôy_is£t
 && !
	`sockd_˝u£t_isok
(&˝uv[i]->
mask
))

1581 
	`£ºx
("%s: invalid cpu mask configured for %sÖrocess: %s",

1582 
fun˘i⁄
,

1583 
	`chûdty≥2°rög
(
¥o˘y≥v
[
i
]),

1584 
	`˝u£t2°rög
(&
˝uv
[
i
]->
mask
, 
NULL
, 0));

1588 
i
 = 0; i < 
sockscf
.
exã∫Æ
.
addrc
; ++i)

1589 i‡(!
	`addrisbödabÀ
(&
sockscf
.
exã∫Æ
.
addrv
[
i
]))

1590 
	`£ºx
("%s: cannot bindÉxternaláddress #%ld: %s",

1591 
fun˘i⁄
,

1592 ()
i
,

1593 
	`ruÀaddr2°rög
(&
sockscf
.
exã∫Æ
.
addrv
[
i
], 0, 
NULL
, 0));

1594 
	}
}

1597 
	$add_exã∫Æ_ßÁmûy
(
ßÁmûy
, 
globÆsc›e
)

1598 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

1599 c⁄° 
globÆsc›e
;

1601 
ßÁmûy
) {

1602 
AF_INET
:

1603 
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
.
hasùv4
 = 1;

1606 
AF_INET6
:

1607 
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
.
hasùv6
 = 1;

1609 i‡(
globÆsc›e
)

1610 
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
.
hasùv6_globÆsc›e
 = 1;

1615 
	`SERRX
(
ßÁmûy
);

1617 
	}
}

1621 
	$exã∫Æ_has_ßÁmûy
(
ßÁmûy
)

1622 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

1624 c⁄° *
fun˘i⁄
 = "external_has_safamily()";

1626 
	`SASSERTX
(
sockscf
.
shmemöfo
 !
NULL
);

1629 
	`¶og
(
LOG_DEBUG
, "%s: hasipv4: %d, hasipv6: %d, hasipv6_globalscope: %d",

1630 
fun˘i⁄
,

1631 
sockscf
.
shmemöfo
->
°©e
.
exã∫Æ_hasùv4
,

1632 
sockscf
.
shmemöfo
->
°©e
.
exã∫Æ_hasùv6
,

1633 
sockscf
.
shmemöfo
->
°©e
.
exã∫Æ_hasùv6_globÆsc›e
);

1636 
ßÁmûy
) {

1637 
AF_INET
:

1638  
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
.
hasùv4
;

1640 
AF_INET6
:

1641  
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
.
hasùv6
;

1644 
	`SERRX
(
ßÁmûy
);

1646 
	}
}

1649 
	$add_öã∫Æ_ßÁmûy
(
ßÁmûy
)

1650 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

1652 
ßÁmûy
) {

1653 
AF_INET
:

1654 
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
.
hasùv4
 = 1;

1657 
AF_INET6
:

1658 
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
.
hasùv6
 = 1;

1662 
	`SERRX
(
ßÁmûy
);

1664 
	}
}

1668 
	$öã∫Æ_has_ßÁmûy
(
ßÁmûy
)

1669 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

1671 c⁄° *
fun˘i⁄
 = "internal_has_safamily()";

1673 
	`SASSERTX
(
sockscf
.
shmemöfo
 !
NULL
);

1676 
	`¶og
(
LOG_DEBUG
, "%s: hasipv4: %d, hasipv6: %d",

1677 
fun˘i⁄
,

1678 
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
.
hasùv4
,

1679 
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
.
hasùv6
);

1682 
ßÁmûy
) {

1683 
AF_INET
:

1684  
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
.
hasùv4
;

1686 
AF_INET6
:

1687  
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
.
hasùv6
;

1690 
	`SERRX
(
ßÁmûy
);

1692 
	}
}

1695 
	$exã∫Æ_has_⁄ly_ßÁmûy
(
ßÁmûy
)

1696 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

1699 
ßÁmûy
) {

1700 
AF_INET
:

1701  (
	`exã∫Æ_has_ßÁmûy
(
AF_INET
)

1702 && !
	`exã∫Æ_has_ßÁmûy
(
AF_INET6
));

1704 
AF_INET6
:

1705  (
	`exã∫Æ_has_ßÁmûy
(
AF_INET6
)

1706 && !
	`exã∫Æ_has_ßÁmûy
(
AF_INET
));

1709 
	`SERRX
(
ßÁmûy
);

1711 
	}
}

1715 
	$exã∫Æ_has_globÆ_ßÁmûy
(
ßÁmûy
)

1716 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

1719 
	`SASSERTX
(
sockscf
.
shmemöfo
 !
NULL
);

1721 
ßÁmûy
) {

1722 
AF_INET
:

1723  
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
.
hasùv4
;

1725 
AF_INET6
:

1726  
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
.
hasùv6_globÆsc›e
;

1729 
	`SERRX
(
ßÁmûy
);

1731 
	}
}

1737 
	$add_m‹e_ﬁd_shmem
(
c⁄fig
, 
memc
, 
memv
)

1738 
c⁄fig
 *config;

1739 c⁄° 
size_t
 
memc
;

1740 c⁄° 
ﬁdshmemöfo_t
 
memv
[];

1742 c⁄° *
fun˘i⁄
 = "add_more_old_shmem()";

1743 *
ﬁd
;

1744 
size_t
 
i
;

1746 i‡((
ﬁd
 = 
	`ªÆloc
(
c⁄fig
->
ﬁdshmemv
,

1747 (*
c⁄fig
->
ﬁdshmemv
Ë* (c⁄fig->
ﬁdshmemc
 + 
memc
)))

1748 =
NULL
) {

1749 
	`sw¨n
("%s: couldÇotállocate %lu bytes of memoryÅo "

1751 
fun˘i⁄
,

1752 ()((*
c⁄fig
->
ﬁdshmemv
)

1753 * (
c⁄fig
->
ﬁdshmemc
 + 
memc
)));

1756 
c⁄fig
->
ﬁdshmemv
 = 
ﬁd
;

1758 
i
 = 0; i < 
memc
; ++i) {

1759 c⁄° *
ty≥
;

1761 
memv
[
i
].
ty≥
) {

1762 
SHMEM_BW
:

1763 
ty≥
 = "bw";

1766 
SHMEM_MONITOR
:

1767 
ty≥
 = "monitor";

1770 
SHMEM_SS
:

1771 
ty≥
 = "session";

1775 
	`SERRX
(
memv
[
i
].
ty≥
);

1778 
	`¶og
(
LOG_DEBUG
,

1781 
fun˘i⁄
,

1782 ()
memv
[
i
].
ty≥
,

1783 
ty≥
,

1784 ()
memv
[
i
].
id
,

1785 ()
memv
[
i
].
key
,

1786 ()
i
);

1788 
c⁄fig
->
ﬁdshmemv
[c⁄fig->
ﬁdshmemc
++] = 
memv
[
i
];

1790 
	}
}

1793 
	$ßÁmûy_i£«bÀd
(
ßÁmûy
, 
addr°r
, 
side
)

1794 c⁄° 
ß_Ámûy_t
 
ßÁmûy
;

1795 c⁄° *
addr°r
;

1796 c⁄° 
öãrÁ˚side_t
 
side
;

1798 c⁄° *
fun˘i⁄
 = "safamily_isenabled()";

1799 
öãrÁ˚¥Ÿocﬁ_t
 *
öãrÁ˚
;

1800 
i£«bÀd
;

1802 
side
) {

1803 
INTERNALIF
:

1804 
öãrÁ˚
 = &
sockscf
.
öã∫Æ
.
¥Ÿocﬁ
;

1807 
EXTERNALIF
:

1808 
öãrÁ˚
 = &
sockscf
.
exã∫Æ
.
¥Ÿocﬁ
;

1812 
	`SERRX
(
side
);

1815 
i£«bÀd
 = 0;

1816 
ßÁmûy
) {

1817 
AF_INET
:

1818 i‡(
öãrÁ˚
->
ùv4
)

1819 
i£«bÀd
 = 1;

1822 
AF_INET6
:

1823 i‡(
öãrÁ˚
->
ùv6
)

1824 
i£«bÀd
 = 1;

1828 
	`SERRX
(
ßÁmûy
);

1831 i‡(!
i£«bÀd
)

1832 
	`¶og
(
LOG_DEBUG
,

1835 
fun˘i⁄
,

1836 
	`ßÁmûy2°rög
(
ßÁmûy
),

1837 
	`öãrÁ˚side2°rög
(
side
),

1838 
addr°r
);

1840  
i£«bÀd
;

1841 
	}
}

1844 
	$addexã∫Æaddr
(
ø
)

1845 c⁄° 
ruÀaddr_t
 *
ø
;

1847 *
ﬁd
;

1849 
ø
->
©y≥
) {

1850 
SOCKS_ADDR_IPV4
:

1851 
SOCKS_ADDR_IPV6
:

1852 i‡(!
	`ßÁmûy_i£«bÀd
(
	`©y≥2ßÁmûy
(
ø
->
©y≥
),

1853 
	`ruÀaddr2°rög
(
ø
, 
ADDRINFO_ATYPE
, 
NULL
, 0),

1854 
EXTERNALIF
))

1865 
ﬁd
 = 
	`ªÆloc
(
sockscf
.
exã∫Æ
.
addrv
,

1866 (*
sockscf
.
exã∫Æ
.
addrv
Ë* (sockscf.exã∫Æ.
addrc
 + 1));

1868 i‡(
ﬁd
 =
NULL
)

1869 
	`yyîr‹
(
NOMEM
);

1871 
sockscf
.
exã∫Æ
.
addrv
 = 
ﬁd
;

1873 
sockscf
.
exã∫Æ
.
addrv
[sockscf.exã∫Æ.
addrc
++] = *
ø
;

1875 
	}
}

1879 
	$addöã∫Æaddr
(
i‚ame
, 
ß
, 
¥Ÿocﬁ
)

1880 c⁄° *
i‚ame
;

1881 c⁄° 
sockaddr_°‹age
 *
ß
;

1882 c⁄° 
¥Ÿocﬁ
;

1884 c⁄° *
fun˘i⁄
 = "addinternaladdr()";

1885 *
ﬁd
;

1887 i‡(!
	`ßÁmûy_i£«bÀd
(
ß
->
ss_Ámûy
,

1888 
	`sockaddr2°rög2
(
ß
, 
ADDRINFO_ATYPE
, 
NULL
, 0),

1889 
INTERNALIF
) != 0)

1892 
	`¶og
(
LOG_DEBUG
, "%s:áddingáddress %s onÇic %sÅoÅhe internalÜist",

1893 
fun˘i⁄
, 
	`sockaddr2°rög
(
ß
, 
NULL
, 0), 
i‚ame
);

1895 
ﬁd
 = 
	`ªÆloc
(
sockscf
.
öã∫Æ
.
addrv
,

1896 (*
sockscf
.
öã∫Æ
.
addrv
Ë* (sockscf.öã∫Æ.
addrc
 + 1));

1898 i‡(
ﬁd
 =
NULL
)

1899 
	`yyîr‹
(
NOMEM
);

1901 
sockscf
.
öã∫Æ
.
addrv
 = 
ﬁd
;

1904 
	`bzîo
(&
sockscf
.
öã∫Æ
.
addrv
[sockscf.öã∫Æ.
addrc
],

1905 (
sockscf
.
öã∫Æ
.
addrv
[sockscf.öã∫Æ.
addrc
]));

1907 
	`sockaddr˝y
(&
sockscf
.
öã∫Æ
.
addrv
[sockscf.öã∫Æ.
addrc
].
addr
,

1908 
ß
,

1909 (
sockscf
.
öã∫Æ
.
addrv
[sockscf.öã∫Æ.
addrc
].
addr
));

1911 
sockscf
.
öã∫Æ
.
addrv
[sockscf.öã∫Æ.
addrc
].
¥Ÿocﬁ
 =Örotocol;

1912 
sockscf
.
öã∫Æ
.
addrv
[sockscf.öã∫Æ.
addrc
].
s
 = -1;

1914 ++
sockscf
.
öã∫Æ
.
addrc
;

1916 
	`add_öã∫Æ_ßÁmûy
(
ß
->
ss_Ámûy
);

1919 
	}
}

	@sockd/session.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
£ssi⁄_ißvaûabÀ
(
shmem_obje˘_t
 *
ss
, c⁄° 
˛õ¡öfo_t
 *
cöfo
,

52 c⁄° 
lock
, c⁄° 
m≠is›í
,

53 *
emsg
, 
size_t
 
emsgÀn
);

67 
thrŸéïîmôs
(c⁄° 
£ssi⁄thrŸée_t
 *
thrŸée
,

68 c⁄° 
timevÆ
 *
°¨âime
,

69 c⁄° 
size_t
 
˛õ¡_sö˚_°¨âime
,

70 c⁄° 
timevÆ
 *
timíow
);

80 
£ssi⁄limô°rög
(c⁄° 
size_t
 
öu£
, c⁄° size_à
max
,

81 *
buf
, c⁄° 
size_t
 
buÊí
);

87 
thrŸéñimô°rög
(c⁄° 
timevÆ
 *
°¨âime
,

88 c⁄° 
timevÆ
 *
timíow
,

89 c⁄° 
size_t
 
√w˛õ¡s
, c⁄° size_à
cuºít˛õ¡s
,

90 *
buf
, c⁄° 
size_t
 
buÊí
);

99 
	$£ssi⁄_u£
(
shmem
, 
cöfo
, 
lock
, 
emsg
, 
emsgÀn
)

100 
shmem_obje˘_t
 *
shmem
;

101 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

102 c⁄° 
lock
;

103 *
emsg
;

104 c⁄° 
size_t
 
emsgÀn
;

106 c⁄° *
fun˘i⁄
 = "session_use()";

107 #i‡
DEBUG


108 
shmem_obje˘_t
 
_shmem
 = *
shmem
;

110 
£ssi⁄_t
 *
ss
 = &
shmem
->
obje˘
.ss;

111 
timevÆ
 
timíow
 = { 0, 0 };

112 
ssize_t
 
ödex
 = -1;

113 
size_t
 
m≠≥dsize
;

115 
	`SASSERTX
(
shmem
 !
NULL
);

117 
	`¶og
(
LOG_DEBUG
, "%s: shmid %lu, cinfo = %s,Üock = %d",

118 
fun˘i⁄
, 
shmem
->
m°©e
.
shmid
, 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0), 
lock
);

120 #i‡
HAVE_SOCKS_HOSTID


121 i‡(
shmem
->
key°©e
.
key
 =
key_ho°id
)

122 i‡(
shmem
->
key°©e
.
keyöfo
.
ho°ödex
 > 
cöfo
->
ho°idc
) {

123 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

127 ()
shmem
->
key°©e
.
keyöfo
.
ho°ödex
,

128 ()
cöfo
->
ho°idc
,

129 ()
cöfo
->
ho°idc
 == 1 ? "" : "es",

130 
PRODUCT
);

132 
	`¶og
(
LOG_WARNING
, "%s:ÖroblemÑelatedÅo %s #%lu detected: %s",

133 
fun˘i⁄
,

134 
	`obje˘ty≥2°rög
(
shmem
->
m°©e
.
∑ª¡ty≥
),

135 ()
shmem
->
m°©e
.
numbî
,

136 
emsg
);

142 
	`socks_lock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1, 1, 1);

144 i‡(
shmem
->
key°©e
.
key
 =
key_un£t
)

145 
m≠≥dsize
 = 0;

147 
rc
;

149 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

150 
rc
 = 
	`key°©e_›ím≠
(
shmem
->
m°©e
.
shmid
, &shmem->
key°©e
, &
m≠≥dsize
);

151 
	`MPROTECT_SHMEMHEADER
(
shmem
);

153 i‡(
rc
 == -1) {

154 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

156 
	`¶og
(
LOG_DEBUG
,

158 
fun˘i⁄
,

159 
shmem
->
m°©e
.
shmid
,

160 ()
shmem
->
key°©e
.
key
,

161 
	`°ªº‹
(
î∫o
));

166 
	`¶og
(
LOG_DEBUG
,

168 
fun˘i⁄
,

169 ()
m≠≥dsize
,

170 
shmem
->
key°©e
.
keyv
,

171 ()
shmem
->
m°©e
.
shmid
);

174 i‡(
m≠≥dsize
 != 0)

175 
	`SASSERTX
(
shmem
->
key°©e
.
keyv
 !
NULL
);

177 i‡(!
	`£ssi⁄_ißvaûabÀ
(
shmem
, 
cöfo
, -1, 1, 
emsg
, 
emsgÀn
)) {

178 
	`SASSERTX
(
m≠≥dsize
 =
shmem
->
key°©e
.
keyc


179 * (*
shmem
->
key°©e
.
keyv
));

181 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

183 
	`key°©e_˛o£m≠
(
shmem
->
m°©e
.
shmid
, &shmem->
key°©e
, 
m≠≥dsize
, -1);

185 
	`MPROTECT_SHMEMHEADER
(
shmem
);

191 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

193 
	`¶og
(
LOG_DEBUG
, "%s:Ço free session slotsávailable: %s",

194 
fun˘i⁄
, 
emsgÀn
 =0 ? "" : 
emsg
);

199 i‡(
	`shmem_u£
(
shmem
, 
cöfo
, -1, 1) == -1) {

200 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

202 
	`key°©e_˛o£m≠
(
shmem
->
m°©e
.
shmid
,

203 &
shmem
->
key°©e
,

204 
m≠≥dsize
,

207 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

209 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

214 
m≠≥dsize
 = 
shmem
->
key°©e
.
keyc
 * (*shmem->key°©e.
keyv
);

216 i‡(
ss
->
thrŸée_is£t
) {

217 
timevÆ
 
tdiff
;

219 i‡(!
	`timîis£t
(&
timíow
))

220 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
timíow
);

222 
	`timîsub
(&
timíow
, &
ss
->
thrŸée
.
°¨âime
, &
tdiff
);

223 i‡(
tdiff
.
tv_£c
 >
ss
->
thrŸée
.
limô
.
£c⁄ds
)

224 
	`RESET_THROTTLE
(&
ss
->
thrŸée
, 
timíow
);

226 ++
ss
->
thrŸée
.
√w˛õ¡s
;

229 i‡(
ss
->
thrŸée_≥r°©e_is£t
 || ss->
max_≥r°©e_is£t
) {

235 
	`SASSERTX
(
m≠≥dsize
 != 0);

237 
ödex
 = 
	`key°©e_ödex
(
shmem
, 
cöfo
, 0);

238 
	`SASSERTX
(
ödex
 >= 0);

239 
	`SASSERTX
((
size_t
)
ödex
 < 
shmem
->
key°©e
.
keyc
);

242 i‡(
ss
->
thrŸée_≥r°©e_is£t
) {

243 i‡(!
	`timîis£t
(&
timíow
))

244 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
timíow
);

246 i‡(
	`key°©e_ha£xpúed
(
shmem
, (
size_t
)
ödex
, &
timíow
))

247 
	`RESET_THROTTLE
(&
shmem
->
key°©e
.
keyv
[
ödex
].
öfo
.
ss
, 
timíow
);

249 ++
shmem
->
key°©e
.
keyv
[
ödex
].
öfo
.
ss
.
√w˛õ¡s
;

252 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

254 
	`key°©e_˛o£m≠
(
shmem
->
m°©e
.
shmid
, &shmem->
key°©e
, 
m≠≥dsize
, 
ödex
);

256 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

258 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

260 
	}
}

263 
	$£ssi⁄_unu£
(
ss
, 
cöfo
, 
lock
)

264 
shmem_obje˘_t
 *
ss
;

265 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

266 c⁄° 
lock
;

268 c⁄° *
fun˘i⁄
 = "session_unuse()";

269 #i‡
DEBUG


270 
shmem_obje˘_t
 
_shmem
 = *
ss
;

273 
	`SASSERTX
(
ss
 !
NULL
);

275 
	`¶og
(
LOG_DEBUG
, "%s: shmid = %ld, key = %d, cinfo = %s,Üock = %d",

276 
fun˘i⁄
,

277 
ss
->
m°©e
.
shmid
,

278 ()
ss
->
key°©e
.
key
,

279 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0),

280 
lock
);

282 
	`socks_lock
(
lock
, (
off_t
)
ss
->
m°©e
.
shmid
, 1, 1, 1);

284 
	`shmem_unu£
(
ss
, 
cöfo
, -1);

286 i‡(
sockscf
.
›ti⁄
.
debug
)

287 
	`¶og
(
LOG_DEBUG
, "%s: sessionsÜeftáfter unuse on shmid %lu, key %d: %s",

288 
fun˘i⁄
,

289 ()
ss
->
m°©e
.
shmid
,

290 ()
ss
->
key°©e
.
key
,

291 
	`£ssi⁄_ißvaûabÀ
(
ss
, 
cöfo
, -1, 0, 
NULL
, 0) ?

294 
	`socks_u∆ock
(
lock
, (
off_t
)
ss
->
m°©e
.
shmid
, 1);

295 
	}
}

298 
	$£ssi⁄_ißvaûabÀ
(
shmem
, 
cöfo
, 
lock
, 
m≠is›í
, 
emsg
, 
emsgÀn
)

299 
shmem_obje˘_t
 *
shmem
;

300 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

301 c⁄° 
lock
;

302 c⁄° 
m≠is›í
;

303 *
emsg
;

304 
size_t
 
emsgÀn
;

306 c⁄° *
fun˘i⁄
 = "session_isavailable()";

307 #i‡
DEBUG


308 
shmem_obje˘_t
 
_shmem
 = *
shmem
;

310 c⁄° 
£ssi⁄_t
 *
ss
 = &
shmem
->
obje˘
.ss;

311 c⁄° 
do˛o£m≠
 = (
m≠is›í
 ? 0 : 1);

312 
timevÆ
 
timíow
 = { 0, 0 };

313 
size_t
 
m≠≥dsize
, 
öu£
;

314 
ssize_t
 
i
;

315 
buf
[256], 
backu≥msg
[256];

317 i‡(
emsg
 =
NULL
 || 
emsgÀn
 == 0) {

318 
emsg
 = 
backu≥msg
;

319 
emsgÀn
 = (
backu≥msg
);

322 
	`SASSERTX
(
ss
->
max_is£t


323 || 
ss
->
thrŸée_is£t


324 || 
shmem
->
key°©e
.
key
 !
key_un£t
);

326 
	`socks_lock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1, 1, 1);

332 i‡(
ss
->
thrŸée_is£t
) {

333 i‡(!
	`timîis£t
(&
timíow
))

334 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
timíow
);

336 i‡(!
	`thrŸéïîmôs
(&
ss
->
thrŸée
.
limô
,

337 &
ss
->
thrŸée
.
°¨âime
,

338 
ss
->
thrŸée
.
√w˛õ¡s
,

339 &
timíow
)) {

340 
	`thrŸéñimô°rög
(&
ss
->
thrŸée
.
°¨âime
,

341 &
timíow
,

342 
ss
->
thrŸée
.
√w˛õ¡s
,

343 
shmem
->
m°©e
.
˛õ¡s
,

344 
emsg
,

345 
emsgÀn
);

347 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

349 
	`¶og
(
LOG_DEBUG
, "%s:ÅhrottlelimitÑeached for shmid %lu: %s",

350 
fun˘i⁄
, ()
shmem
->
m°©e
.
shmid
, 
emsg
);

356 i‡(
ss
->
max_is£t
) {

357 c⁄° 
size_t
 
À·
 = ()(
ss
->
max
 - 
shmem
->
m°©e
.
˛õ¡s
);

359 
	`SASSERTX
(
shmem
->
m°©e
.
˛õ¡s
 <
ss
->
max
);

361 
	`¶og
(
LOG_DEBUG
, "%s: sessions in use for shmid %lu: %lu, max: %lu",

362 
fun˘i⁄
,

363 ()
shmem
->
m°©e
.
shmid
,

364 ()
shmem
->
m°©e
.
˛õ¡s
,

365 ()
ss
->
max
);

367 i‡(
À·
 <= 0) {

368 
	`£ssi⁄limô°rög
(
shmem
->
m°©e
.
˛õ¡s
, 
ss
->
max
, 
emsg
, 
emsgÀn
);

370 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

371 
	`¶og
(
LOG_DEBUG
, "%s: sessionlimitÑeached for shmid %lu: %s",

372 
fun˘i⁄
, ()
shmem
->
m°©e
.
shmid
, 
emsg
);

382 i‡(
shmem
->
key°©e
.
key
 =
key_un£t


383 || 
shmem
->
key°©e
.
keyc
 == 0 ) {

384 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

388 i‡(
m≠is›í
)

389 
	`SASSERTX
(
shmem
->
key°©e
.
keyv
 !
NULL
);

391 
rc
;

393 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

395 
rc
 = 
	`key°©e_›ím≠
(
shmem
->
m°©e
.
shmid
, &shmem->
key°©e
, &
m≠≥dsize
);

397 
	`MPROTECT_SHMEMHEADER
(
shmem
);

399 i‡(
rc
 == -1) {

400 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

402 
	`¶og
(
LOG_DEBUG
,

404 
fun˘i⁄
,

405 
shmem
->
m°©e
.
shmid
,

406 ()
shmem
->
key°©e
.
key
,

407 
	`°ªº‹
(
î∫o
));

413 
	`SASSERTX
(
shmem
->
key°©e
.
keyv
 !
NULL
);

415 i‡((
i
 = 
	`key°©e_ödex
(
shmem
, 
cöfo
, 0)) != -1) {

416 
	`SASSERTX
(
i
 >= 0);

417 
	`SASSERTX
((
size_t
)
i
 < 
shmem
->
key°©e
.
keyc
);

419 
shmem
->
key°©e
.
key
) {

420 
key_‰om
:

421 
öu£
 = 
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
‰om
.
addrc
;

424 #i‡
HAVE_SOCKS_HOSTID


425 
key_ho°id
:

426 
öu£
 = 
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
ho°id
.
addrc
;

431 
	`SERRX
(
shmem
->
key°©e
.
key
);

434 i‡(
ss
->
max_≥r°©e_is£t
) {

435 
	`¶og
(
LOG_DEBUG
,

437 
fun˘i⁄
,

438 
	`°©ekey2°rög
(
shmem
->
key°©e
.
key
),

439 ()
shmem
->
m°©e
.
shmid
,

440 ()
öu£
,

441 ()
ss
->
max_≥r°©e
);

443 
	`SASSERTX
(
öu£
 <
ss
->
max_≥r°©e
);

445 i‡(
ss
->
max_≥r°©e
 - 
öu£
 <= 0) {

446 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "per-key %s",

447 
	`£ssi⁄limô°rög
((
size_t
)
öu£
,

448 
ss
->
max_≥r°©e
,

449 
buf
,

450 (
buf
)));

451 
	`¶og
(
LOG_DEBUG
,

453 
fun˘i⁄
, ()
shmem
->
m°©e
.
shmid
, 
emsg
);

455 i‡(
do˛o£m≠
) {

456 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

458 
	`key°©e_˛o£m≠
(
shmem
->
m°©e
.
shmid
,

459 &
shmem
->
key°©e
,

460 
m≠≥dsize
,

463 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

466 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

471 i‡(
ss
->
thrŸée_≥r°©e_is£t
) {

472 
	`SASSERTX
(
ss
->
thrŸée_≥r°©e
.
limô
.
˛õ¡s
 != 0);

473 
	`SASSERTX
(
ss
->
thrŸée_≥r°©e
.
limô
.
£c⁄ds
 != 0);

475 i‡(!
	`timîis£t
(&
timíow
))

476 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
timíow
);

478 i‡(!
	`thrŸéïîmôs
(&
ss
->
thrŸée_≥r°©e
.
limô
,

479 &
shmem
->
key°©e
.
keyv
[
i
].
öfo
.
ss
.
°¨âime
,

480 
shmem
->
key°©e
.
keyv
[
i
].
öfo
.
ss
.
√w˛õ¡s
,

481 &
timíow
)) {

482 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "per-key %s",

483 
	`thrŸéñimô°rög
(

484 &
shmem
->
key°©e
.
keyv
[
i
].
öfo
.
ss
.
°¨âime
,

485 &
timíow
,

486 
shmem
->
key°©e
.
keyv
[
i
].
öfo
.
ss
.
√w˛õ¡s
,

487 
öu£
,

488 
buf
,

489 (
buf
)));

491 
	`¶og
(
LOG_DEBUG
,

493 
fun˘i⁄
, ()
shmem
->
m°©e
.
shmid
, 
emsg
);

495 i‡(
do˛o£m≠
) {

496 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

498 
	`key°©e_˛o£m≠
(
shmem
->
m°©e
.
shmid
,

499 &
shmem
->
key°©e
,

500 
m≠≥dsize
,

503 
	`MPROTECT_SHMEMHEADER
(
shmem
);

506 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

512 i‡(
do˛o£m≠
) {

513 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

515 
	`key°©e_˛o£m≠
(
shmem
->
m°©e
.
shmid
, &shmem->
key°©e
, 
m≠≥dsize
, -1);

517 
	`MPROTECT_SHMEMHEADER
(
shmem
);

520 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

522 
	}
}

525 
	$thrŸéïîmôs
(
thrŸée
, 
°¨âime
, 
√w˛õ¡s
, 
timíow
)

526 c⁄° 
£ssi⁄thrŸée_t
 *
thrŸée
;

527 c⁄° 
timevÆ
 *
°¨âime
;

528 c⁄° 
size_t
 
√w˛õ¡s
;

529 c⁄° 
timevÆ
 *
timíow
;

531 c⁄° *
fun˘i⁄
 = "throttlepermits()";

532 
timevÆ
 
tdiff
;

534 
	`¶og
(
LOG_DEBUG
,

537 
fun˘i⁄
,

538 ()
thrŸée
->
˛õ¡s
,

539 ()
thrŸée
->
£c⁄ds
,

540 ()
°¨âime
->
tv_£c
,

541 ()
°¨âime
->
tv_u£c
,

542 ()
√w˛õ¡s
,

543 ()
timíow
->
tv_£c
,

544 ()
timíow
->
tv_u£c
);

546 i‡(
√w˛õ¡s
 < 
thrŸée
->
˛õ¡s
)

549 
	`timîsub
(
timíow
, 
°¨âime
, &
tdiff
);

551 i‡(
tdiff
.
tv_£c
 >
thrŸée
->
£c⁄ds
)

555 
	}
}

558 
	$£ssi⁄limô°rög
(
öu£
, 
max
, 
buf
, 
buÊí
)

559 c⁄° 
size_t
 
öu£
;

560 c⁄° 
size_t
 
max
;

561 *
buf
;

562 
size_t
 
buÊí
;

565 
	`SASSERTX
(
öu£
 <
max
);

567 
	`¢¥ötf
(
buf
, 
buÊí
, "sessionÜimitÑeached (%ld/%ld slot%s in use)",

568 ()
öu£
, ()
max
, max == 1 ? "" : "s");

570  
buf
;

571 
	}
}

574 
	$thrŸéñimô°rög
(
°¨âime
, 
timíow
, 
√w˛õ¡s
, 
cuºít˛õ¡s
, 
buf
, 
buÊí
)

575 c⁄° 
timevÆ
 *
°¨âime
;

576 c⁄° 
timevÆ
 *
timíow
;

577 c⁄° 
size_t
 
√w˛õ¡s
;

578 c⁄° 
size_t
 
cuºít˛õ¡s
;

579 *
buf
;

580 c⁄° 
size_t
 
buÊí
;

582 
timevÆ
 
tdiff
;

584 
	`timîsub
(
timíow
, 
°¨âime
, &
tdiff
);

585 
	`¢¥ötf
(
buf
, 
buÊí
,

588 ()
√w˛õ¡s
,

589 ()
√w˛õ¡s
 == 1 ? "" : "s",

590 ()
	`timevÆ2£c⁄ds
(&
tdiff
),

591 ()
cuºít˛õ¡s
);

593  
buf
;

594 
	}
}

	@sockd/shmem.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

51 
	#FIRST_SHMEMID
 (0)

	)

53 íum { 
	mkeyty≥_ùv4
 = 1, 
	mkeyty≥_ùv6
 } 
	tkey°©e_d©a_ty≥
;

56 
key°©e_d©a_ty≥
 
	mty≥
;

59 
ö_addr
 
	mùv4
;

60 
ö6_addr
 
	mùv6
;

61 } 
	md©a
;

62 } 
	tkey°©e_d©a_t
;

65 
mem2shmem
(
c⁄fig
 *c⁄fig, c⁄° 
fú°id
);

77 
key°©e_ªmoveödex
(
key°©e_t
 *
key°©e
, c⁄° 
size_t
 
ödex
);

82 
key°©e_d©a_t
 *

83 
key°©e_d©a
(c⁄° 
key°©e_t
 *
key°©e
, c⁄° 
size_t
 
ödex
,

84 
key°©e_d©a_t
 *
key
);

91 
keyd©a2°rög
(c⁄° 
key°©e_d©a_t
 *
keyd©a
, *
buf
, 
size_t
 
buÊí
);

100 
size_t


101 
key°©e_˛õ¡cou¡
(c⁄° 
key°©e_t
 *
key°©e
, c⁄° 
size_t
 
ödex
);

106 
ssize_t


107 
key°©e_timî
(c⁄° 
shmem_obje˘_t
 *
shmem
);

116 
should_do_expúesˇn
(c⁄° 
shmem_obje˘_t
 *
shmem
);

123 
	$shmem_£tup
()

125 c⁄° *
fun˘i⁄
 = "shmem_setup()";

126 *
p
;

133 
	`SASSERTX
(
sockscf
.
shmemfd
 == -1);

134 
	`SASSERTX
(
	`pidismŸhî
(
sockscf
.
°©e
.
pid
) == 1);

136 
	`STRCPY_ASSERTSIZE
(
sockscf
.
shmem_‚ameba£
, 
SOCKD_SHMEMFILE
);

142 i‡((
sockscf
.
shmemfd
 = 
	`socks_mklock
(sockscf.
shmem_‚ameba£
,

143 
sockscf
.
shmem_‚ameba£
,

144 (
sockscf
.
shmem_‚ameba£
))) == -1)

145 
	`£º
("%s: socks_mklock() failedÅo create shmemfile using base %s",

146 
fun˘i⁄
, 
sockscf
.
shmem_‚ameba£
);

148 i‡((
p
 = 
	`sockd_gëshmem«me
(()
FIRST_SHMEMID
, 
key_‰om
)Ë=
NULL
)

149 
	`£ºx
("%s: failedÅo generate shmem filename based on fnamebase "

151 
fun˘i⁄
, 
sockscf
.
shmem_‚ameba£
, 
FIRST_SHMEMID
);

153 i‡(
	`°æí
(
p
Ë>(
sockscf
.
shmem_‚ameba£
))

154 
	`£ºx
("%s: shmem filename is %ld bytesÅooÜong forÅhis system. Please "

156 
fun˘i⁄
,

157 ()(
	`°æí
(
p
Ë+ 1Ë- (
sockscf
.
shmem_‚ameba£
));

159 i‡((
sockscf
.
shmemöfo
 = 
	`sockd_mm≠
(
NULL
,

160 (*
sockscf
.
shmemöfo
),

161 
PROT_READ
 | 
PROT_WRITE
,

162 
MAP_SHARED
,

163 
sockscf
.
shmemfd
,

164 1)Ë=
MAP_FAILED
)

165 
	`£º
("%s: faûedÅÿmm≠ shmemöfo", 
fun˘i⁄
);

168 i‡(
	`u∆ök
(
sockscf
.
shmem_‚ameba£
) != 0)

169 
	`£º
("%s: failedÅo unlink shmemfile %s",

170 
fun˘i⁄
, 
sockscf
.
shmem_‚ameba£
);

172 
	`SASSERTX
(
sockscf
.
shmemc⁄figfd
 == -1);

173 i‡((
sockscf
.
shmemc⁄figfd


174 
	`socks_mklock
(
SOCKD_SHMEMFILE
, 
NULL
, 0)) == -1)

175 
	`£º
("%s: socks_mklock() failedÅo create shmemfile using base %s",

176 
fun˘i⁄
, 
SOCKD_SHMEMFILE
);

181 
	`ho°ˇche£tup
();

183 #i‡
HAVE_LDAP


187 
	`ld≠ˇche£tup
();

190 
	}
}

193 
	$shmem_idupd©e
(
c⁄fig
)

194 
c⁄fig
 *config;

196 
size_t
 
œ°shmid
 = 
FIRST_SHMEMID
 + 1;

198 
œ°shmid
 = 
	`mem2shmem
(
c⁄fig
,Üastshmid);

199 ++
œ°shmid
;

200 
	}
}

203 
	$sockd_shmdt
(
ruÀ
, 
obje˘s
)

204 
ruÀ_t
 *
ruÀ
;

205 c⁄° 
obje˘s
;

207 c⁄° *
fun˘i⁄
 = "sockd_shmdt()";

209 i‡((
obje˘s
 & 
SHMEM_BW
Ë&& 
ruÀ
->
bw_shmid
)

210 
	`HANDLE_SHMDT
(
ruÀ
, 
bw
, 
bw_shmid
);

212 i‡((
obje˘s
 & 
SHMEM_MONITOR
Ë&& 
ruÀ
->
m°©s_shmid
)

213 
	`HANDLE_SHMDT
(
ruÀ
, 
m°©s
, 
m°©s_shmid
);

215 i‡((
obje˘s
 & 
SHMEM_SS
Ë&& 
ruÀ
->
ss_shmid
)

216 
	`HANDLE_SHMDT
(
ruÀ
, 
ss
, 
ss_shmid
);

217 
	}
}

220 
	$sockd_shm©
(
ruÀ
, 
obje˘s
)

221 
ruÀ_t
 *
ruÀ
;

222 
obje˘s
;

224 c⁄° *
fun˘i⁄
 = "sockd_shmat()";

225 
havìº‹
 = 0;

227 i‡((
obje˘s
 & 
SHMEM_BW
Ë&& 
ruÀ
->
bw_shmid
 != 0) {

228 
	`HANDLE_SHMAT
(
ruÀ
, 
bw
, 
bw_shmid
);

230 i‡(
ruÀ
->
bw_shmid
) {

231 #i‡
DEBUG


232 
shmem_obje˘_t
 
_shmem
 = *
ruÀ
->
bw
;

235 
	`SASSERTX
(
ruÀ
->
bw
->
ty≥
 =
SHMEM_BW
);

238 
	`SASSERTX
(
ruÀ
->
bw
 =
NULL
);

240 
havìº‹
 = 1;

241 
obje˘s
 &~
SHMEM_BW
;

244 #i‡
DEBUG


246 
	`¶og
(
LOG_DEBUG
, "%s:Ço bw_shmid weÇeedÅo (re)attachÅo forÑule #%lu",

247 
fun˘i⁄
, ()
ruÀ
->
numbî
);

250 i‡((
obje˘s
 & 
SHMEM_MONITOR
Ë&& 
ruÀ
->
m°©s_shmid
 != 0) {

255 
	`HANDLE_SHMAT
(
ruÀ
, 
m°©s
, 
m°©s_shmid
);

257 i‡(
ruÀ
->
m°©s_shmid
) {

258 #i‡
DEBUG


259 
shmem_obje˘_t
 
_shmem
 = *
ruÀ
->
m°©s
;

262 
	`SASSERTX
(
ruÀ
->
m°©s
->
ty≥
 =
SHMEM_MONITOR
);

265 
	`SASSERTX
(
ruÀ
->
m°©s
 =
NULL
);

267 
havìº‹
 = 1;

268 
obje˘s
 &~
SHMEM_MONITOR
;

271 #i‡
DEBUG


273 
	`¶og
(
LOG_DEBUG
,

275 
fun˘i⁄
, ()
ruÀ
->
numbî
);

278 i‡((
obje˘s
 & 
SHMEM_SS
Ë&& 
ruÀ
->
ss_shmid
 != 0) {

279 
	`HANDLE_SHMAT
(
ruÀ
, 
ss
, 
ss_shmid
);

281 i‡(
ruÀ
->
ss_shmid
) {

282 #i‡
DEBUG


283 
shmem_obje˘_t
 
_shmem
 = *
ruÀ
->
ss
;

286 
	`SASSERTX
(
ruÀ
->
ss
->
ty≥
 =
SHMEM_SS
);

289 
	`SASSERTX
(
ruÀ
->
ss
 =
NULL
);

291 
havìº‹
 = 1;

292 
obje˘s
 &~
SHMEM_SS
;

295 #i‡
DEBUG


297 
	`¶og
(
LOG_DEBUG
, "%s:Ço ss_shmid weÇeedÅo (re)attachÅo forÑule #%lu",

298 
fun˘i⁄
, ()
ruÀ
->
numbî
);

301 i‡(
havìº‹
)

305 
	}
}

308 
	$shmem_u£ruÀ
(
ruÀ
, 
cöfo
, 
emsg
, 
emsgÀn
)

309 
ruÀ_t
 *
ruÀ
;

310 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

311 *
emsg
;

312 c⁄° 
size_t
 
emsgÀn
;

314 c⁄° *
fun˘i⁄
 = "shmem_userule()";

315 
size_t
 
©èched_to
;

317 
	`¶og
(
LOG_DEBUG
, "%s: cinfo: %s",

318 
fun˘i⁄
, 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0));

320 
	`log_ruÀöfo_shmid
(
ruÀ
, 
fun˘i⁄
, 
NULL
);

326 
©èched_to
 = 0;

328 i‡(
ruÀ
->
ss_shmid
 !0 &&ÑuÀ->
ss
 =
NULL
)

329 i‡(
	`sockd_shm©
(
ruÀ
, 
SHMEM_SS
) == 0)

330 
©èched_to
 |
SHMEM_SS
;

332 i‡(
ruÀ
->
ss_shmid
 != 0) {

333 i‡(!
	`£ssi⁄_u£
(
ruÀ
->
ss
,

334 
cöfo
,

335 
sockscf
.
shmemfd
,

336 
emsg
,

337 
emsgÀn
)) {

338 
	`SASSERTX
(
ruÀ
->
ss_shmid
 =‘uÀ)->
ss
->
m°©e
.
shmid
);

340 
	`sockd_shmdt
(
ruÀ
, 
©èched_to
);

345 i‡(
ruÀ
->
bw_shmid
 !0 &&ÑuÀ->
bw
 =
NULL
)

346 i‡(
	`sockd_shm©
(
ruÀ
, 
SHMEM_BW
) == 0)

347 
©èched_to
 |
SHMEM_BW
;

349 i‡(
ruÀ
->
bw_shmid
 != 0)

350 
	`bw_u£
(
ruÀ
->
bw
, 
cöfo
, 
sockscf
.
shmemfd
);

352 i‡(
ruÀ
->
m°©s_shmid
 !0 &&ÑuÀ->
m°©s
 =
NULL
)

353 i‡(
	`sockd_shm©
(
ruÀ
, 
SHMEM_MONITOR
) == 0)

354 
©èched_to
 |
SHMEM_MONITOR
;

356 i‡(
ruÀ
->
m°©s_shmid
 != 0)

357 
	`m⁄ô‹_u£
(
ruÀ
->
m°©s
, 
cöfo
, 
sockscf
.
shmemfd
);

359 
	`sockd_shmdt
(
ruÀ
, 
©èched_to
);

362 
	}
}

366 
	$sockd_gëshmem«me
(
id
, 
key
)

367 c⁄° 
id
;

368 c⁄° 
°©ekey_t
 
key
;

371 
«me
[
PATH_MAX
];

373 
	`SASSERTX
(*
sockscf
.
shmem_‚ameba£
 !
NUL
);

375 i‡(
key
 =
key_un£t
)

376 
	`¢¥ötf
(
«me
, “ame), "%s.%lu", 
sockscf
.
shmem_‚ameba£
, 
id
);

378 
	`¢¥ötf
(
«me
, (name), "%s.%lu.%d",

379 
sockscf
.
shmem_‚ameba£
, 
id
, ()
key
);

381  
«me
;

382 
	}
}

385 
	$sockd_mm≠
(
m≠pög
, 
size
, 
¥Ÿ
, 
Êags
, 
fd
, 
do¸óã
)

386 *
m≠pög
;

387 
size_t
 
size
;

388 c⁄° 
¥Ÿ
;

389 c⁄° 
Êags
;

390 c⁄° 
fd
;

391 c⁄° 
do¸óã
;

393 c⁄° *
fun˘i⁄
 = "sockd_mmap()";

394 c⁄° *
ﬁdm≠pög
 = 
m≠pög
;

396 i‡(
size
 == 0)

397  
MAP_FAILED
;

399 i‡(
do¸óã
) {

400 i‡(
	`·runˇã
(
fd
, (
off_t
)
size
) == -1) {

401 
	`sw¨n
("%s: ftruncate()Åo offset %lu failed",

402 
fun˘i⁄
, ()
size
);

404  
MAP_FAILED
;

408 
	`¶og
(
LOG_DEBUG
, "%s: mmap(2)'ing %lu bytes from fd %d, mapping = %p",

409 
fun˘i⁄
, ()
size
, 
fd
, 
m≠pög
);

411 i‡((
m≠pög
 = 
	`mm≠
(mapping,

412 
size
,

413 
¥Ÿ
,

414 
Êags
,

415 
fd
,

416 (
off_t
)0)Ë=
MAP_FAILED
)

417 
	`sw¨n
("%s: %smmap(2) of %lu bytes from fd %d failed",

418 
fun˘i⁄
, 
ﬁdm≠pög
 =
NULL
 ? "" : "ª-", ()
size
, 
fd
);

420  
m≠pög
;

421 
	}
}

424 
	$shmem_u£
(
shmem
, 
cöfo
, 
lock
, 
m≠is›í
)

425 
shmem_obje˘_t
 *
shmem
;

426 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

427 c⁄° 
lock
;

428 c⁄° 
m≠is›í
;

430 c⁄° *
fun˘i⁄
 = "shmem_use()";

431 c⁄° 
do˛o£m≠
 = (
m≠is›í
 ? 0 : 1);

432 #i‡
DEBUG


433 
shmem_obje˘_t
 
_shmem
 = *
shmem
;

435 
ssize_t
 
°©ecou¡
 = -1;

437 
	`SASSERTX
(
shmem
 !
NULL
);

438 
	`SASSERTX
(
shmem
->
m°©e
.
numbî
 > 0);

440 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

441 
	`¶og
(
LOG_DEBUG
,

445 
fun˘i⁄
,

446 
lock
,

447 ()
shmem
->
m°©e
.
˛õ¡s
,

448 ()
shmem
->
m°©e
.
numbî
,

449 
shmem
,

450 
shmem
->
key°©e
.
keyv
,

451 
m≠is›í
,

452 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0),

453 
shmem
->
m°©e
.
shmid
,

454 ()
shmem
->
key°©e
.
key
);

456 
shmem
->
ty≥
) {

457 
SHMEM_BW
:

458 
SHMEM_MONITOR
:

459 
SHMEM_SS
:

463 
	`SERRX
(
shmem
->
ty≥
);

466 
	`socks_lock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1, 1, 1);

468 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

470 ++
shmem
->
m°©e
.
˛õ¡s
;

472 
	`MPROTECT_SHMEMHEADER
(
shmem
);

473 i‡(
shmem
->
key°©e
.
key
 !
key_un£t
) {

474 
size_t
 
sizem≠≥d
;

475 
ssize_t
 
i
;

476 
rc
;

478 i‡(!
m≠is›í
) {

479 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

481 
rc
 = 
	`key°©e_›ím≠
(
shmem
->
m°©e
.
shmid
,

482 &
shmem
->
key°©e
,

483 &
sizem≠≥d
);

485 
	`MPROTECT_SHMEMHEADER
(
shmem
);

487 i‡(
rc
 != 0) {

488 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

490 
	`¶og
(
LOG_DEBUG
, "%s: keystate_openmap() of shmid %lu failed: %s",

491 
fun˘i⁄
, ()
shmem
->
m°©e
.
shmid
, 
	`°ªº‹
(
î∫o
));

499 i‡((
i
 = 
	`key°©e_ödex
(
shmem
, 
cöfo
, 
	`should_do_expúesˇn
(shmem))) >= 0)

500 
	`¶og
(
LOG_DEBUG
, "%s:ÉntryÉxistsát index #%lu",

501 
fun˘i⁄
, ()
i
);

507 c⁄° *
‚ame
 = 
	`sockd_gëshmem«me
(
shmem
->
m°©e
.
shmid
,

508 
shmem
->
key°©e
.
key
);

509 
fd
;

511 
	`¶og
(
LOG_DEBUG
,

513 
fun˘i⁄
,

514 ()
shmem
->
key°©e
.
keyc
 + 1,

515 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0));

517 i‡((
fd
 = 
	`›í
(
‚ame
, 
O_RDWR
)) == -1) {

518 
	`sw¨n
("%s: couldÇŸ o≥¿shmemfûê%s", 
fun˘i⁄
, 
‚ame
);

520 i‡(
do˛o£m≠
) {

521 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

523 
	`key°©e_˛o£m≠
(
shmem
->
m°©e
.
shmid
,

524 &
shmem
->
key°©e
,

525 
sizem≠≥d
,

528 
	`MPROTECT_SHMEMHEADER
(
shmem
);

530 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

534 
sizem≠≥d


535 (
shmem
->
key°©e
.
keyc
 + 1Ë* (*shmem->key°©e.
keyv
);

537 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

539 
shmem
->
key°©e
.
keyv
 = 
	`sockd_mm≠
(shmem->keystate.keyv,

540 
sizem≠≥d
,

541 
PROT_READ
 | 
PROT_WRITE
,

542 
MAP_SHARED
,

543 
fd
,

546 
	`MPROTECT_SHMEMHEADER
(
shmem
);

548 
	`˛o£
(
fd
);

550 i‡(
shmem
->
key°©e
.
keyv
 =
MAP_FAILED
) {

551 
	`sw¨n
("%s: failedÅo mmap(2) shmeminfo of size %lu from "

553 
fun˘i⁄
, ()
sizem≠≥d
, 
‚ame
, 
fd
);

555 
shmem
->
key°©e
.
keyv
 = 
NULL
;

556 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

562 
i
 = 
shmem
->
key°©e
.
keyc
;

564 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

566 ++
shmem
->
key°©e
.
keyc
;

568 
	`MPROTECT_SHMEMHEADER
(
shmem
);

571 
	`SASSERTX
((
size_t
)
i
 < 
shmem
->
key°©e
.
keyc
);

573 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

574 
shmem
->
key°©e
.
key
) {

575 
key_‰om
: {

576 *
d°
;

578 
cöfo
->
‰om
.
ss_Ámûy
) {

579 
AF_INET
:

580 
d°
 = &
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
‰om
.
addr
.
ùv4
;

583 
AF_INET6
:

584 
d°
 = &
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
‰om
.
addr
.
ùv6
;

588 
	`SERRX
(
cöfo
->
‰om
.
ss_Ámûy
);

591 
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
‰om
.
ßÁmûy
 = 
cöfo
->‰om.
ss_Ámûy
;

592 
	`mem˝y
(
d°
,

593 
	`GET_SOCKADDRADDR
(&
cöfo
->
‰om
),

594 
	`öaddæí
(
cöfo
->
‰om
.
ss_Ámûy
));

595 ++
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
‰om
.
addrc
;

597 
°©ecou¡
 = (
ssize_t
)
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
‰om
.
addrc
;

599 
	`¶og
(
LOG_DEBUG
, "%s: updatedÉntry foráddress %sát index #%lu",

600 
fun˘i⁄
,

601 
	`sockaddr2°rög2
(&
cöfo
->
‰om
, 0, 
NULL
, 0),

602 ()
i
);

607 #i‡
HAVE_SOCKS_HOSTID


608 
key_ho°id
:

609 
	`SASSERTX
(
shmem
->
key°©e
.
keyöfo
.
ho°ödex
 <
cöfo
->
ho°idc
);

611 
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
ho°id
.
ùv4


612 
cöfo
->
ho°idv
[
shmem
->
key°©e
.
keyöfo
.
ho°ödex
 - 1];

614 ++
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
ho°id
.
addrc
;

616 
°©ecou¡
 = (
ssize_t
)
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
ho°id
.
addrc
;

622 
	`SERRX
(
shmem
->
key°©e
.
key
);

625 i‡(
do˛o£m≠
) {

626 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

628 
	`key°©e_˛o£m≠
(
shmem
->
m°©e
.
shmid
,

629 &
shmem
->
key°©e
,

630 
sizem≠≥d
,

631 
i
);

633 
	`MPROTECT_SHMEMHEADER
(
shmem
);

636 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

638 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

639 
	`¶og
(
LOG_DEBUG
,

642 
fun˘i⁄
,

643 
lock
,

644 ()
shmem
->
m°©e
.
˛õ¡s
,

645 ()
°©ecou¡
,

646 
shmem
,

647 
shmem
->
m°©e
.
shmid
,

648 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0));

650 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

652 
	}
}

655 
	$shmem_unu£
(
shmem
, 
cöfo
, 
lock
)

656 
shmem_obje˘_t
 *
shmem
;

657 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

658 
lock
;

660 c⁄° *
fun˘i⁄
 = "shmem_unuse()";

661 #i‡
DEBUG


662 
shmem_obje˘_t
 
_shmem
 = *
shmem
;

664 
ssize_t
 
°©ecou¡
 = -1;

666 
	`SASSERTX
(
shmem
 !
NULL
);

667 
	`SASSERTX
(
shmem
->
m°©e
.
numbî
 > 0);

669 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

670 
	`¶og
(
LOG_DEBUG
, "%s:Öre-use:Üock = %d, # of clients = %lu,Ñule = %lu, "

672 
fun˘i⁄
,

673 
lock
,

674 ()
shmem
->
m°©e
.
˛õ¡s
,

675 ()
shmem
->
m°©e
.
numbî
,

676 
shmem
,

677 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0),

678 
shmem
->
m°©e
.
shmid
,

679 ()
shmem
->
key°©e
.
key
);

681 
shmem
->
ty≥
) {

682 
SHMEM_BW
:

683 
SHMEM_MONITOR
:

684 
SHMEM_SS
:

688 
	`SERRX
(
shmem
->
ty≥
);

691 
	`socks_lock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1, 1, 1);

693 i‡(
shmem
->
key°©e
.
key
 !
key_un£t
) {

694 #i‡
DEBUG


695 
key°©e_t
 
_key°©e
;

697 
ssize_t
 
i
;

698 
size_t
 
sizem≠≥d
;

699 
rc
;

701 
	`SASSERTX
(
shmem
->
key°©e
.
keyv
 =
NULL
);

702 
	`SASSERTX
(
shmem
->
key°©e
.
keyc
 > 0);

704 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

706 
rc
 = 
	`key°©e_›ím≠
(
shmem
->
m°©e
.
shmid
, &shmem->
key°©e
, &
sizem≠≥d
);

708 
	`MPROTECT_SHMEMHEADER
(
shmem
);

710 i‡(
rc
 != 0) {

711 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

713 
	`¶og
(
LOG_DEBUG
, "%s: keystate_openmap() of shmid %lu failed: %s",

714 
fun˘i⁄
, ()
shmem
->
m°©e
.
shmid
, 
	`°ªº‹
(
î∫o
));

719 #i‡
DEBUG


720 
_key°©e
 = 
shmem
->
key°©e
;

723 
	`SASSERTX
(
sizem≠≥d
 > 0);

724 
	`SASSERTX
(
shmem
->
key°©e
.
keyv
 !
NULL
);

725 
	`SASSERTX
(
shmem
->
key°©e
.
keyc
 > 0);

727 
i
 = 
	`key°©e_ödex
(
shmem
, 
cöfo
, 
	`should_do_expúesˇn
(shmem));

728 
	`SASSERTX
(
i
 >= 0);

729 
	`SASSERTX
((
size_t
)
i
 < 
shmem
->
key°©e
.
keyc
);

731 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

733 
shmem
->
key°©e
.
key
) {

734 
key_‰om
:

735 
	`SASSERTX
(
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
‰om
.
addrc
 > 0);

736 --
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
‰om
.
addrc
;

737 
°©ecou¡
 = (
ssize_t
)
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
‰om
.
addrc
;

740 #i‡
HAVE_SOCKS_HOSTID


741 
key_ho°id
:

742 
	`SASSERTX
(
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
ho°id
.
addrc
 > 0);

743 --
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
ho°id
.
addrc
;

744 
°©ecou¡
 = (
ssize_t
)
shmem
->
key°©e
.
keyv
[
i
].
d©a
.
ho°id
.
addrc
;

749 
	`SERRX
(
shmem
->
key°©e
.
key
);

752 
	`key°©e_˛o£m≠
(
shmem
->
m°©e
.
shmid
, &shmem->
key°©e
, 
sizem≠≥d
, 
i
);

754 
	`MPROTECT_SHMEMHEADER
(
shmem
);

757 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

759 
	`SASSERTX
(
shmem
->
m°©e
.
˛õ¡s
 > 0);

760 --
shmem
->
m°©e
.
˛õ¡s
;

762 
	`MPROTECT_SHMEMHEADER
(
shmem
);

764 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

765 
	`¶og
(
LOG_DEBUG
,

768 
fun˘i⁄
,

769 
lock
,

770 ()
shmem
->
m°©e
.
˛õ¡s
,

771 ()
°©ecou¡
,

772 
shmem
,

773 
shmem
->
m°©e
.
shmid
,

774 
	`˛õ¡öfo2°rög
(
cöfo
, 
NULL
, 0));

776 
	`socks_u∆ock
(
lock
, (
off_t
)
shmem
->
m°©e
.
shmid
, 1);

778 
	}
}

782 
	$key°©e_ha£xpúed
(
shmem
, 
keyödex
, 
timíow
)

783 c⁄° 
shmem_obje˘_t
 *
shmem
;

784 c⁄° 
size_t
 
keyödex
;

785 c⁄° 
timevÆ
 *
timíow
;

787 c⁄° *
fun˘i⁄
 = "keystate_hasexpired()";

788 
timevÆ
 
tdiff
;

789 
buf
[64];

790 
expúed
 = 0;

792 
	`SASSERTX
(
keyödex
 < 
shmem
->
key°©e
.
keyc
);

794 
shmem
->
ty≥
) {

795 
SHMEM_SS
: {

797 i‡(!
shmem
->
obje˘
.
ss
.
thrŸée_≥r°©e_is£t
)

800 
	`timîsub
(
timíow
,

801 &
shmem
->
key°©e
.
keyv
[
keyödex
].
öfo
.
ss
.
°¨âime
,

802 &
tdiff
);

804 i‡(
tdiff
.
tv_£c
 >
shmem
->
obje˘
.
ss
.
thrŸée_≥r°©e
.
limô
.
£c⁄ds
)

805 
expúed
 = 1;

814 i‡(
expúed
) {

815 i‡(!
	`timîis£t
(&
shmem
->
key°©e
.
keyv
[
keyödex
].
öfo
.
ss
.
°¨âime
))

816 
	`¢¥ötf
(
buf
, (buf), "yes (init)");

818 
	`¢¥ötf
(
buf
, (buf), "yes, %ld.%06ldságo",

819 ()
tdiff
.
tv_£c
, (Èdiff.
tv_u£c
);

822 i‡(
sockscf
.
›ti⁄
.
debug
) {

823 c⁄° *
key°rög
;

824 
key°©e_d©a_t
 
key
;

826 
	`key°©e_d©a
(&
shmem
->
key°©e
, 
keyödex
, &
key
);

827 
key°rög
 = 
	`keyd©a2°rög
(&
key
, 
NULL
, 0);

829 
	`¶og
(
LOG_DEBUG
,

832 
fun˘i⁄
,

833 
key°rög
,

834 ()
keyödex
,

835 ()
shmem
->
key°©e
.
keyv
[
keyödex
].
öfo
.
ss
.
°¨âime
.
tv_£c
,

836 ()
shmem
->
key°©e
.
keyv
[
keyödex
].
öfo
.
ss
.
°¨âime
.
tv_u£c
,

837 ()
	`key°©e_˛õ¡cou¡
(&
shmem
->
key°©e
, 
keyödex
),

838 
expúed
 ? 
buf
 : "no");

841  
expúed
;

842 
	}
}

845 
	$mem2shmem
(
c⁄fig
, 
fú°id
)

846 
c⁄fig
 *config;

847 c⁄° 
fú°id
;

849 c⁄° *
fun˘i⁄
 = "mem2shmem()";

850 
m⁄ô‹_t
 *
m⁄ô‹
;

851 
ruÀ_t
 *
ruÀ
;

852 
ruÀ_t
 *
ruÀv
[] = { 
c⁄fig
->
¸uÀ
,

854 #i‡
HAVE_SOCKS_HOSTID


855 
c⁄fig
->
hruÀ
,

858 #i‡
HAVE_SOCKS_RULES


859 
c⁄fig
->
§uÀ


862 
√xtid
;

863 
size_t
 
i
;

872 
	`SASSERTX
(
	`pidismŸhî
(
sockscf
.
°©e
.
pid
) == 1);

879 
	#HANDLE_SHMCR
(
obje˘
, 
memfõld
, 
idfõld
, 
id
) \

881 c⁄° 
°©ekey_t
 
key
 = (
obje˘
)->
memfõld
->
key°©e
.key; \

882 c⁄° *
‚ame
 = 
	`sockd_gëshmem«me
(
id
, 
key_un£t
); \

883 c⁄° 
Êags
 = 
O_RDWR
 | 
O_CREAT
 | 
O_EXCL
; \

884 c⁄° 
mode_t
 
mode
 = 
S_IRUSR
 | 
S_IWUSR
; \

885 
shmem_obje˘_t
 *
mem
; \

886 
fd
; \

888 
	`SASSERTX
(
id
 != 0); \

889 
	`SASSERTX
(
‚ame
 !
NULL
 && *‚amê!
NUL
); \

891 
	`SASSERTX
((
obje˘
)->
memfõld
->
m°©e
.
numbî
 > 0); \

892 
	`SASSERTX
((
obje˘
)->
memfõld
->
m°©e
.
∑ª¡ty≥
 !
obje˘_n⁄e
); \

893 
	`SASSERTX
((
obje˘
)->
ty≥
 !
obje˘_n⁄e
); \

894 
	`SASSERTX
((
obje˘
)->
memfõld
->
ty≥
 !
SHMEM_NONE
); \

896 i‡((
fd
 = 
	`›í
(
‚ame
, 
Êags
, 
mode
)) == -1) \

897 
	`£º
("%s: faûedÅÿ¸óã shmemfûê\"%s\"", 
fun˘i⁄
, 
‚ame
); \

899 
	`¶og
(
LOG_DEBUG
, \

902 
fun˘i⁄
, \

903 
‚ame
, \

904 (
id
), \

905 
	`obje˘ty≥2°rög
(
obje˘
->
ty≥
), \

906 ()(
obje˘
)->
numbî
); \

908 i‡((
mem
 = 
	`sockd_mm≠
(
NULL
, \

909 (*(
obje˘
)->
memfõld
), \

910 
PROT_READ
 | 
PROT_WRITE
, \

911 
MAP_SHARED
, \

912 
fd
, \

913 1)Ë=
MAP_FAILED
) \

914 
	`£º
("%s: sockd_mmap of size %lu failed", \

915 
fun˘i⁄
, ()(*(
obje˘
)->
memfõld
)); \

921 *
mem
 = *(
obje˘
)->
memfõld
; \

922 
	`‰ì
((
obje˘
)->
memfõld
); \

923 (
obje˘
)->
memfõld
 = 
mem
; \

925 
	`˛o£
(
fd
); \

927 i‡(
key
 !
key_un£t
) { \

928 c⁄° *
‚ame
 = 
	`sockd_gëshmem«me
(
id
, 
key
); \

930 
	`SASSERTX
(
‚ame
 !
NULL
 && *‚amê!
NUL
); \

932 i‡((
fd
 = 
	`›í
(
‚ame
, 
Êags
, 
mode
)) == -1) \

933 
	`£º
("%s: faûedÅÿ¸óã fûê%s", 
fun˘i⁄
, 
‚ame
); \

939 
	`˛o£
(
fd
); \

941 
	`¶og
(
LOG_DEBUG
, \

944 
fun˘i⁄
, \

945 
‚ame
, \

946 ()(
id
), \

947 ()(
key
), \

948 
	`obje˘ty≥2°rög
((
obje˘
)->
ty≥
), \

949 ()(
obje˘
)->
numbî
); \

952 
	`SASSERTX
((
obje˘
)->
memfõld
->
m°©e
.
shmid
 == 0); \

953 (
obje˘
)->
memfõld
->
m°©e
.
shmid
 = (
id
); \

955 
	`SASSERTX
((
obje˘
)->
idfõld
 == 0); \

956 (
obje˘
)->
idfõld
 = (
id
); \

958 
	`¶og
(
LOG_DEBUG
, "%s:állocated " #idfield " %ld for object #%lu", \

959 
fun˘i⁄
, (
obje˘
)->
idfõld
, ()(obje˘)->
numbî
); \

961 
	`SASSERTX
(
	`munm≠
((
obje˘
)->
memfõld
, (*(object)->memfield)) == 0); \

962 (
obje˘
)->
memfõld
 = 
NULL
; \

963 }  0)

	)

966 
√xtid
 = 
fú°id
;

971 
i
 = 0; i < 
	`ELEMENTS
(
ruÀv
); ++i) {

972 
ruÀ
 = 
ruÀv
[
i
];

974 
ruÀ
 !
NULL
) {

975 i‡(
ruÀ
->
bw
 !
NULL
) {

976 
	`SASSERTX
(
ruÀ
->
bw
->
ty≥
 =
SHMEM_BW
);

977 
	`HANDLE_SHMCR
(
ruÀ
, 
bw
, 
bw_shmid
, 
√xtid
);

978 ++
√xtid
;

981 i‡(
ruÀ
->
ss
 !
NULL
) {

982 
	`SASSERTX
(
ruÀ
->
ss
->
ty≥
 =
SHMEM_SS
);

983 
	`HANDLE_SHMCR
(
ruÀ
, 
ss
, 
ss_shmid
, 
√xtid
);

984 ++
√xtid
;

987 
ruÀ
 =ÑuÀ->
√xt
;

994 
m⁄ô‹
 = 
c⁄fig
->m⁄ô‹; m⁄ô‹ !
NULL
; m⁄ô‹ = m⁄ô‹->
√xt
) {

995 i‡(
m⁄ô‹
->
m°©s
 !
NULL
) {

996 
	`SASSERTX
(
m⁄ô‹
->
m°©s
->
ty≥
 =
SHMEM_MONITOR
);

997 
	`HANDLE_SHMCR
(
m⁄ô‹
, 
m°©s
, 
m°©s_shmid
, 
√xtid
);

998 ++
√xtid
;

1002 
	`¶og
(
LOG_DEBUG
,

1005 
fun˘i⁄
,

1006 ()(
√xtid
 - 
fú°id
),

1007 
√xtid
 - 
fú°id
 == 1 ? "" : "s",

1008 
fú°id
,

1009 
√xtid
);

1011  
√xtid
;

1012 
	}
}

1015 
	$key°©e_ªmoveödex
(
key°©e
, 
ödex
)

1016 
key°©e_t
 *
key°©e
;

1017 c⁄° 
size_t
 
ödex
;

1019 c⁄° *
fun˘i⁄
 = "keystate_removeindex()";

1020 
ß_Ámûy_t
 
ßÁmûy
;

1021 *
addr
;

1023 
key°©e
->
key
) {

1024 
key_‰om
:

1025 
key°©e
->
keyv
[
ödex
].
d©a
.
‰om
.
ßÁmûy
) {

1026 
AF_INET
:

1027 
ßÁmûy
 = 
AF_INET
;

1028 
addr
 = &
key°©e
->
keyv
[
ödex
].
d©a
.
‰om
.addr.
ùv4
;

1031 
AF_INET6
:

1032 
ßÁmûy
 = 
AF_INET6
;

1033 
addr
 = &
key°©e
->
keyv
[
ödex
].
d©a
.
‰om
.addr.
ùv6
;

1037 
	`SERRX
(
key°©e
->
keyv
[
ödex
].
d©a
.
‰om
.
ßÁmûy
);

1043 #i‡
HAVE_SOCKS_HOSTID


1044 
key_ho°id
:

1045 
ßÁmûy
 = 
AF_INET6
;

1046 
addr
 = &
key°©e
->
keyv
[
ödex
].
d©a
.
ho°id
.
ùv4
;

1051 
	`SERRX
(
key°©e
->
key
);

1054 i‡(
sockscf
.
›ti⁄
.
debug
) {

1055 
¡›
[
MAXSOCKADDRSTRING
];

1057 i‡(
	`öë_¡›
(
ßÁmûy
, 
addr
, 
¡›
, “t›)Ë=
NULL
) {

1058 
	`sw¨n
("%s: inet_ntop(3) failed on safamily %s,áddr %s",

1059 
fun˘i⁄
,

1060 
	`ßÁmûy2°rög
(
ßÁmûy
),

1061 
	`addr2hex°rög
(
addr
, 
ßÁmûy
, 
NULL
, 0));

1064 
	`¶og
(
LOG_DEBUG
,

1067 
fun˘i⁄
,

1068 
¡›
,

1069 
	`°©ekey2°rög
(
key°©e
->
key
),

1070 ()
ödex
,

1071 ()
key°©e
->
keyc
 - 1);

1079 
	`bzîo
(&
key°©e
->
keyv
[
ödex
], (*keystate->keyv));

1081 i‡(
key°©e
->
keyc
 > 1)

1082 
	`memmove
(&
key°©e
->
keyv
[
ödex
],

1083 &
key°©e
->
keyv
[
ödex
 + 1],

1084 (*
key°©e
->
keyv
Ë* (key°©e->
keyc
 - (
ödex
 + 1)));

1086 --
key°©e
->
keyc
;

1088 i‡(
sockscf
.
›ti⁄
.
debug
) {

1089 
size_t
 
i
;

1091 
i
 = 0; i < 
key°©e
->
keyc
; ++i) {

1092 c⁄° *
key°rög
;

1093 
key°©e_d©a_t
 
key
;

1095 
	`key°©e_d©a
(
key°©e
, 
i
, &
key
);

1096 
key°rög
 = 
	`keyd©a2°rög
(&
key
, 
NULL
, 0);

1098 
	`¶og
(
LOG_DEBUG
, "%s:Éntry #%lu: %s",

1099 
fun˘i⁄
, ()
i
, 
key°rög
);

1102 
	}
}

1104 
ssize_t


1105 
	$key°©e_ödex
(
shmem
, 
cöfo
, 
d€xpúesˇn
)

1106 
shmem_obje˘_t
 *
shmem
;

1107 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

1108 c⁄° 
d€xpúesˇn
;

1110 c⁄° *
fun˘i⁄
 = "keystate_index()";

1111 
ssize_t
 
œ°m©ched
 = -1;

1112 c⁄° *
d©©om©ch
;

1113 
key°©e_d©a_t
 
keyd©a
;

1114 
key°©e_d©a_ty≥
 
d©©y≥
;

1115 
timevÆ
 
timíow
;

1116 
ssize_t
 
m©chedi
;

1117 
size_t
 
i
, 
d©Æí
;

1118 
exåaöfo
[128] = { 
NUL
 };

1120 i‡(
d€xpúesˇn
)

1121 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
timíow
);

1123 
	`SASSERTX
(
shmem
->
key°©e
.
key
 !
key_un£t
);

1125 
shmem
->
key°©e
.
key
) {

1126 
key_‰om
:

1127 
cöfo
->
‰om
.
ss_Ámûy
) {

1128 
AF_INET
:

1129 
d©©y≥
 = 
keyty≥_ùv4
;

1132 
AF_INET6
:

1133 
d©©y≥
 = 
keyty≥_ùv6
;

1137 
	`SERRX
(
cöfo
->
‰om
.
ss_Ámûy
);

1140 
d©©om©ch
 = 
	`GET_SOCKADDRADDR
(&
cöfo
->
‰om
);

1141 
d©Æí
 = 
	`öaddæí
(
cöfo
->
‰om
.
ss_Ámûy
);

1144 #i‡
HAVE_SOCKS_HOSTID


1145 
key_ho°id
:

1146 
	`SASSERTX
(
shmem
->
key°©e
.
keyöfo
.
ho°ödex
 <
cöfo
->
ho°idc
);

1148 
d©©om©ch
 = &
cöfo
->
ho°idv
[
shmem
->
key°©e
.
keyöfo
.
ho°ödex
 - 1];

1149 
d©©y≥
 = 
keyty≥_ùv4
;

1150 
d©Æí
 = (
keyd©a
.
d©a
.
ùv4
);

1152 
	`¢¥ötf
(
exåaöfo
, (extrainfo), "(hostindex = %u)",

1153 ()
shmem
->
key°©e
.
keyöfo
.
ho°ödex
);

1159 
	`SERRX
(
shmem
->
key°©e
.
key
);

1162 i‡(
œ°m©ched
 !-1 &&Üa°m©ched < (
ssize_t
)
shmem
->
key°©e
.
keyc
) {

1163 
	`key°©e_d©a
(&
shmem
->
key°©e
, 
œ°m©ched
, &
keyd©a
);

1165 
keyd©a
.
ty≥
) {

1166 
keyty≥_ùv4
:

1167 i‡(
	`memcmp
(&
keyd©a
.
d©a
.
ùv4
, 
d©©om©ch
, 
d©Æí
) == 0)

1168 
m©chedi
 = 
œ°m©ched
;

1170 
m©chedi
 = -1;

1173 
keyty≥_ùv6
:

1174 i‡(
	`memcmp
(&
keyd©a
.
d©a
.
ùv6
, 
d©©om©ch
, 
d©Æí
) == 0)

1175 
m©chedi
 = 
œ°m©ched
;

1177 
m©chedi
 = -1;

1181 
	`SERRX
(
keyd©a
.
ty≥
);

1185 
m©chedi
 = -1;

1187 i‡(
sockscf
.
›ti⁄
.
debug
) {

1188 
¡›
[
MAXSOCKADDRSTRING
];

1190 
d©©y≥
) {

1191 
keyty≥_ùv4
:

1192 i‡(
	`öë_¡›
(
AF_INET
, 
d©©om©ch
, 
¡›
, “t›)Ë=
NULL
) {

1193 
	`sw¨n
("%s: inet_ntop(3) failed on %s %x",

1194 
fun˘i⁄
,

1195 
	`©y≥2°rög
(
AF_INET
),

1196 ((c⁄° 
ö_addr
 *)
d©©om©ch
)->
s_addr
);

1198 
	`¢¥ötf
(
¡›
, (ntop), "<unknown>");

1202 
keyty≥_ùv6
:

1203 i‡(
	`öë_¡›
(
AF_INET6
, 
d©©om©ch
, 
¡›
, “t›)Ë=
NULL
) {

1204 
	`sw¨n
("%s: i√t_¡›(3ËÁûed o¿%†" 
IP6_FMTSTR
,

1205 
fun˘i⁄
,

1206 
	`©y≥2°rög
(
AF_INET6
),

1207 
	`IP6_ELEMENTS
((c⁄° 
ö6_addr
 *)
d©©om©ch
));

1209 
	`¢¥ötf
(
¡›
, (ntop), "<unknown>");

1214 
	`SERRX
(
d©©y≥
);

1217 
	`¶og
(
LOG_DEBUG
,

1220 
fun˘i⁄
,

1221 
	`°©ekey2°rög
(
shmem
->
key°©e
.
key
),

1222 
¡›
,

1223 *
exåaöfo
 =
NUL
 ? "" : " ",

1224 *
exåaöfo
 =
NUL
 ? "" :Éxtrainfo,

1225 ()
shmem
->
key°©e
.
keyc
,

1226 
d€xpúesˇn
,

1227 ()
m©chedi
,

1228 
m©chedi
 == -1 ?

1229 "" : 
d€xpúesˇn
 ?

1233 i‡(
m©chedi
 != -1)

1234  
m©chedi
;

1236 
i
 = 0;

1237 
i
 < 
shmem
->
key°©e
.
keyc
) {

1238 
key°©e_d©a_t
 
keyd©a
;

1239 
m©ches
;

1241 i‡(
d€xpúesˇn
 && 
	`key°©e_ha£xpúed
(
shmem
, 
i
, &
timíow
)) {

1242 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

1244 i‡(
	`key°©e_˛õ¡cou¡
(&
shmem
->
key°©e
, 
i
) == 0) {

1245 
	`key°©e_ªmoveödex
(&
shmem
->
key°©e
, 
i
);

1249 
	`RESET_THROTTLE
(&
shmem
->
obje˘
.
ss
.
thrŸée
, 
timíow
);

1251 
	`MPROTECT_SHMEMHEADER
(
shmem
);

1254 
	`key°©e_d©a
(&
shmem
->
key°©e
, 
i
, &
keyd©a
);

1256 i‡(
keyd©a
.
ty≥
 =
d©©y≥
) {

1257 
keyd©a
.
ty≥
) {

1258 
keyty≥_ùv4
:

1259 
m©ches


1260 (
	`memcmp
(&
keyd©a
.
d©a
.
ùv4
, 
d©©om©ch
, 
d©Æí
) == 0);

1263 
keyty≥_ùv6
:

1264 
m©ches


1265 (
	`memcmp
(&
keyd©a
.
d©a
.
ùv6
, 
d©©om©ch
, 
d©Æí
) == 0);

1269 
	`SERRX
(
keyd©a
.
ty≥
);

1272 i‡(
sockscf
.
›ti⁄
.
debug
)

1273 
	`¶og
(
LOG_DEBUG
,

1275 
fun˘i⁄
,

1276 
	`keyd©a2°rög
(&
keyd©a
, 
NULL
, 0),

1277 ()
i
,

1278 ()
d©Æí
,

1279 
m©ches
 ? "matches" : "no match");

1282 
m©ches
 = 0;

1284 i‡(
m©ches
) {

1285 
	`SASSERTX
(
m©chedi
 == -1);

1286 
m©chedi
 = 
œ°m©ched
 = (
ssize_t
)
i
;

1288 i‡(!
d€xpúesˇn
)

1292 ++
i
;

1295 i‡(
d€xpúesˇn
) {

1296 
	`MUNPROTECT_SHMEMHEADER
(
shmem
);

1298 
shmem
->
key°©e
.
œ°expúesˇn
 = 
timíow
.
tv_£c
;

1300 
	`MPROTECT_SHMEMHEADER
(
shmem
);

1302  
m©chedi
;

1303 
	}
}

1306 
	$key°©e_›ím≠
(
id
, 
key°©e
, 
sizem≠≥d
)

1307 c⁄° 
id
;

1308 
key°©e_t
 *
key°©e
;

1309 
size_t
 *
sizem≠≥d
;

1311 c⁄° *
fun˘i⁄
 = "keystate_openmap()";

1312 c⁄° *
‚ame
 = 
	`sockd_gëshmem«me
(
id
, 
key°©e
->
key
);

1313 
size_t
 
_sizem≠≥d
;

1315 
	`SASSERTX
(
‚ame
 !
NULL
 && *‚amê!
NUL
);

1316 
	`SASSERTX
(
key°©e
->
key
 !
key_un£t
);

1318 
	`¶og
(
LOG_DEBUG
, "%s: shmid %ld, key %d",

1319 
fun˘i⁄
, 
id
, ()
key°©e
->
key
);

1321 i‡(
sizem≠≥d
 =
NULL
)

1322 
sizem≠≥d
 = &
_sizem≠≥d
;

1324 *
sizem≠≥d
 = 
key°©e
->
keyc
 * (*key°©e->
keyv
);

1326 i‡(*
sizem≠≥d
 == 0) {

1327 
	`SASSERTX
(
key°©e
->
keyc
 == 0);

1328 
	`SASSERTX
(
key°©e
->
keyv
 =
NULL
);

1331 c⁄° 
fd
 = 
	`›í
(
‚ame
, 
O_RDWR
);

1333 i‡(
fd
 == -1) {

1334 
	`¶og
(
	`sockd_mŸhîexi°s
(Ë? 
LOG_WARNING
: 
LOG_DEBUG
,

1337 
fun˘i⁄
,

1338 
‚ame
,

1339 
id
,

1340 ()
key°©e
->
key
,

1341 
	`gëµid
() == 1 ?

1343 : 
	`°ªº‹
(
î∫o
));

1348 i‡((
key°©e
->
keyv
 = 
	`sockd_mm≠
(
NULL
,

1349 *
sizem≠≥d
,

1350 
PROT_READ
 | 
PROT_WRITE
,

1351 
MAP_SHARED
,

1352 
fd
,

1353 0)Ë=
MAP_FAILED
) {

1354 
	`sw¨n
("%s: couldÇot mmap shmemfile %s of size %lu generated from "

1356 
fun˘i⁄
,

1357 
‚ame
,

1358 ()*
sizem≠≥d
,

1359 
id
,

1360 ()
key°©e
->
key
);

1362 
key°©e
->
keyv
 = 
NULL
;

1363 
	`˛o£
(
fd
);

1368 
	`˛o£
(
fd
);

1371 
	`¶og
(
LOG_DEBUG
, "%s: mapped %lu bytes for shmid %ld, key %d,átáddress %p",

1372 
fun˘i⁄
,

1373 ()*
sizem≠≥d
,

1374 
id
,

1375 ()
key°©e
->
key
,

1376 
key°©e
->
keyv
);

1379 
	}
}

1382 
	$key°©e_˛o£m≠
(
id
, 
key°©e
, 
m≠≥dsize
, 
ch™gedödex
)

1383 c⁄° 
id
;

1384 
key°©e_t
 *
key°©e
;

1385 c⁄° 
size_t
 
m≠≥dsize
;

1386 c⁄° 
ssize_t
 
ch™gedödex
;

1388 c⁄° *
fun˘i⁄
 = "keystate_closemap()";

1389 c⁄° *
‚ame
 = 
	`sockd_gëshmem«me
(
id
, 
key°©e
->
key
);

1390 
size_t
 
√wsize
;

1392 
√wsize
 = 
key°©e
->
keyc
 * (*key°©e->
keyv
);

1394 
	`¶og
(
LOG_DEBUG
,

1397 
fun˘i⁄
,

1398 ()
id
,

1399 ()
m≠≥dsize
,

1400 ()
√wsize
,

1401 ()
ch™gedödex
);

1403 i‡(
sockscf
.
›ti⁄
.
debug
) {

1404 
key°©e_d©a_t
 
keyd©a
;

1405 
size_t
 
i
;

1407 
i
 = 0; i < 
key°©e
->
keyc
; ++i)

1408 
	`¶og
(
LOG_DEBUG
, "%s:Éntry #%lu: %s",

1409 
fun˘i⁄
,

1410 ()
i
,

1411 
	`keyd©a2°rög
(
	`key°©e_d©a
(
key°©e
, 
i
, &
keyd©a
), 
NULL
, 0));

1414 i‡(
m≠≥dsize
 == 0)

1415 
	`SASSERTX
(
key°©e
->
keyv
 =
NULL
);

1417 #i‡!
HAVE_UNIFIED_BUFFERCACHE


1435 *
addr
;

1436 
size_t
 
Àn
;

1437 
√edmsync
;

1439 
	`SASSERTX
(
key°©e
->
keyv
 !
NULL
);

1441 i‡(
m≠≥dsize
 < 
√wsize
) {

1442 
√edmsync
 = 1;

1448 
addr
 = 
key°©e
->
keyv
;

1449 
Àn
 = 
√wsize
;

1451 i‡(
ch™gedödex
 != -1) {

1452 
√edmsync
 = 1;

1454 
addr
 = (*)
	`ROUNDDOWN
((
uöçå_t
)&
key°©e
->
keyv
[
ch™gedödex
],

1455 
sockscf
.
°©e
.
∑gesize
);

1457 
	`SASSERTX
((
uöçå_t
)
key°©e
->
keyv
 <(uöçå_t)
addr
);

1459 
Àn
 = ((
uöçå_t
)&
key°©e
->
keyv
[
ch™gedödex
] - (uöçå_t)
addr
)

1460 + (
key°©e
->
keyv
[
ch™gedödex
]);

1463 
	`SASSERTX
(
m≠≥dsize
 =
√wsize
);

1464 
√edmsync
 = 0;

1467 i‡(
√edmsync
) {

1468 c⁄° 
rc
 = 
	`msync
(
addr
, 
Àn
, 
MS_SYNC
);

1470 
	`¶og
(
rc
 =0 ? 
LOG_DEBUG
 : 
LOG_WARNING
,

1473 
fun˘i⁄
,

1474 
addr
,

1475 
Àn
,

1476 ()
m≠≥dsize
,

1477 ()
√wsize
,

1478 ()
ch™gedödex
,

1479 
key°©e
->
keyv
,

1480 
rc
 == 0 ? "is ok" : "failed",

1481 
	`°ªº‹
(
î∫o
));

1485 
	`SASSERTX
(
key°©e
->
keyv
 !
NULL
);

1487 i‡(
	`munm≠
(
key°©e
->
keyv
, 
m≠≥dsize
) != 0)

1488 
	`sw¨n
("%s: munmap(2) of keystate.keyv (%p) of size %lu failed",

1489 
fun˘i⁄
, 
key°©e
->
keyv
, ()
m≠≥dsize
);

1491 
key°©e
->
keyv
 = 
NULL
;

1494 i‡(
√wsize
 !
m≠≥dsize
) {

1495 i‡(
	`åunˇã
(
‚ame
, (
off_t
)
√wsize
) == 0)

1496 
	`¶og
(
LOG_DEBUG
, "%s:Åruncated shmemfile %sÅo size %lu",

1497 
fun˘i⁄
, 
‚ame
, ()
√wsize
);

1499 
	`sw¨n
("%s: couldÇotÅruncate shmemfile %sÅo size %lu",

1500 
fun˘i⁄
, 
‚ame
, ()
√wsize
);

1502 
	}
}

1504 #i‡
DIAGNOSTIC
 && !
SOCKS_CLIENT


1506 
	$shmemcheck
()

1508 c⁄° 
î∫o_s
 = 
î∫o
;

1509 
ruÀ_t
 *
ruÀv
[] = { 
sockscf
.
¸uÀ
,

1511 #i‡
HAVE_SOCKS_HOSTID


1512 
sockscf
.
hruÀ
,

1515 #i‡
HAVE_SOCKS_RULES


1516 
sockscf
.
§uÀ


1519 
size_t
 
i
;

1524 
i
 = 0; i < 
	`ELEMENTS
(
ruÀv
); ++i) {

1525 
ruÀ_t
 *
_ruÀ
 = 
ruÀv
[
i
];

1527 
_ruÀ
 !
NULL
) {

1528 
ruÀ_t
 
ruÀ
 = *
_ruÀ
;

1533 
	`sockd_shm©
(&
ruÀ
, 
SHMEM_ALL
);

1534 
	`sockd_shmdt
(&
ruÀ
, 
SHMEM_ALL
);

1536 
_ruÀ
 = _ruÀ->
√xt
;

1540 i‡(
	`pidismŸhî
(
sockscf
.
°©e
.
pid
) == 1) {

1544 
i
 = 0; i < 
sockscf
.
ﬁdshmemc
; ++i) {

1545 
ruÀ_t
 
ruÀ
;

1547 
	`bzîo
(&
ruÀ
, (rule));

1549 
sockscf
.
ﬁdshmemv
[
i
].
ty≥
) {

1550 
SHMEM_BW
:

1551 
ruÀ
.
bw_shmid
 = 
sockscf
.
ﬁdshmemv
[
i
].
id
;

1554 
SHMEM_MONITOR
:

1555 
ruÀ
.
m°©s_shmid
 = 
sockscf
.
ﬁdshmemv
[
i
].
id
;

1558 
SHMEM_SS
:

1559 
ruÀ
.
ss_shmid
 = 
sockscf
.
ﬁdshmemv
[
i
].
id
;

1563 
	`SERRX
(
sockscf
.
ﬁdshmemv
[
i
].
ty≥
);

1566 ()
	`sockd_shm©
(&
ruÀ
, 
sockscf
.
ﬁdshmemv
[
i
].
ty≥
);

1567 ()
	`sockd_shmdt
(&
ruÀ
, 
sockscf
.
ﬁdshmemv
[
i
].
ty≥
);

1571 
î∫o
 = 
î∫o_s
;

1572 
	}
}

1576 
	$should_do_expúesˇn
(
shmem
)

1577 c⁄° 
shmem_obje˘_t
 *
shmem
;

1579 
ssize_t
 
timî
;

1581 i‡((
timî
 = 
	`key°©e_timî
(
shmem
)) != -1

1582 && 
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(
NULL
),

1583 
shmem
->
key°©e
.
œ°expúesˇn
Ë>
timî
)

1587 
	}
}

1589 
ssize_t


1590 
	$key°©e_timî
(
shmem
)

1591 c⁄° 
shmem_obje˘_t
 *
shmem
;

1594 
shmem
->
ty≥
) {

1595 
SHMEM_SS
:

1596 i‡(
shmem
->
obje˘
.
ss
.
thrŸée_≥r°©e_is£t
)

1597  (
size_t
)
shmem
->
obje˘
.
ss
.
thrŸée_≥r°©e
.
limô
.
£c⁄ds
;

1604 
	}
}

1606 
key°©e_d©a_t
 *

1607 
	$key°©e_d©a
(
key°©e
, 
ödex
, 
keyd©a
)

1608 c⁄° 
key°©e_t
 *
key°©e
;

1609 c⁄° 
size_t
 
ödex
;

1610 
key°©e_d©a_t
 *
keyd©a
;

1613 
	`SASSERTX
(
ödex
 < 
key°©e
->
keyc
);

1614 
key°©e
->
key
) {

1615 
key_‰om
:

1616 
key°©e
->
keyv
[
ödex
].
d©a
.
‰om
.
ßÁmûy
) {

1617 
AF_INET
:

1618 
keyd©a
->
ty≥
 = 
keyty≥_ùv4
;

1619 
keyd©a
->
d©a
.
ùv4
 = 
key°©e
->
keyv
[
ödex
].d©a.
‰om
.
addr
.ipv4;

1622 
AF_INET6
:

1623 
keyd©a
->
ty≥
 = 
keyty≥_ùv6
;

1624 
keyd©a
->
d©a
.
ùv6
 = 
key°©e
->
keyv
[
ödex
].d©a.
‰om
.
addr
.ipv6;

1628 
	`SERRX
(
key°©e
->
keyv
[
ödex
].
d©a
.
‰om
.
ßÁmûy
);

1634 #i‡
HAVE_SOCKS_HOSTID


1635 
key_ho°id
:

1636 
keyd©a
->
ty≥
 = 
keyty≥_ùv4
;

1637 
keyd©a
->
d©a
.
ùv4
 = 
key°©e
->
keyv
[
ödex
].d©a.
ho°id
.ipv4;

1642 
	`SERRX
(
key°©e
->
key
);

1645  
keyd©a
;

1646 
	}
}

1649 
	$keyd©a2°rög
(
keyd©a
, 
buf
, 
buÊí
)

1650 c⁄° 
key°©e_d©a_t
 *
keyd©a
;

1651 *
buf
;

1652 
size_t
 
buÊí
;

1655 c⁄° *
fun˘i⁄
 = "keydata2string()";

1656 c⁄° *
addr
;

1657 
ß_Ámûy_t
 
ßÁmûy
;

1659 i‡(
buf
 =
NULL
) {

1660 
_buf
[
MAXSOCKADDRSTRING
];

1662 
buf
 = 
_buf
;

1663 
buÊí
 = (
_buf
);

1666 
keyd©a
->
ty≥
) {

1667 
keyty≥_ùv4
:

1668 
ßÁmûy
 = 
AF_INET
;

1669 
addr
 = &
keyd©a
->
d©a
.
ùv4
;

1672 
keyty≥_ùv6
:

1673 
ßÁmûy
 = 
AF_INET6
;

1674 
addr
 = &
keyd©a
->
d©a
.
ùv6
;

1678 
	`SERRX
(
keyd©a
->
ty≥
);

1681 i‡(
	`öë_¡›
(
ßÁmûy
, 
addr
, 
buf
, 
buÊí
Ë=
NULL
) {

1682 
	`addr2hex°rög
(
addr
, 
ßÁmûy
, 
buf
, 
buÊí
);

1683 
	`sw¨n
("%s: inet_ntop(3) failed on safamily %s,áddr %s",

1684 
fun˘i⁄
, 
	`ßÁmûy2°rög
(
ßÁmûy
), 
buf
);

1687  
buf
;

1688 
	}
}

1690 
size_t


1691 
	$key°©e_˛õ¡cou¡
(
key°©e
, 
ödex
)

1692 c⁄° 
key°©e_t
 *
key°©e
;

1693 c⁄° 
size_t
 
ödex
;

1696 
	`SASSERTX
(
ödex
 < 
key°©e
->
keyc
);

1698 
key°©e
->
key
) {

1699 
key_‰om
:

1700  
key°©e
->
keyv
[
ödex
].
d©a
.
‰om
.
addrc
;

1702 #i‡
HAVE_SOCKS_HOSTID


1703 
key_ho°id
:

1704  
key°©e
->
keyv
[
ödex
].
d©a
.
ho°id
.
addrc
;

1708 
	`SERRX
(
key°©e
->
key
);

1712 
	}
}

	@sockd/shmemconfig.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 
size_t


50 
lökedsize
(c⁄° 
löked«me_t
 *
hód
);

56 
poﬁöô
(*
poﬁ
, c⁄° 
size_t
 
size
);

66 
gëmem
(c⁄° 
size_t
 
size
);

72 
size_t


73 
memÀ·
();

78 
size_t


79 
memÀ·_no_Æignmít_luck
();

84 íum { 
	mCOPY
 = 1, 
	mSIZE
 } 
	tc⁄fig›_t
;

85 
ssize_t


86 
poöãr_c›y‹size
(c⁄° 
c⁄fig›_t
 
›
, 
c⁄fig
 *
§c
,

87 c⁄° 
±rdiff_t
 
§coff£t
, 
c⁄fig
 *
d°
,

88 *
mem
, c⁄° 
size_t
 
memsize
);

107 *
	g_√xt°¨t
;

108 
uöçå_t
 
	g_Æignmít
, 
	g_mask
;

110 
size_t
 
	g_À·
, 
	g_À·_no_Æignmít_luck
, 
	g_exåa_due_Æignmít
;

112 
	#ADDLEN
(
_Àn
, 
tŸÆ
) \

114 c⁄° 
size_t
 
Àn
 = (
_Àn
); \

116 i‡((
Àn
) != 0) { \

117 
	`¶og
(
LOG_DEBUG
, "%s:ádding %lu bytesátÜine %d", \

118 
fun˘i⁄
, ()((
Àn
Ë+ 
_Æignmít
), 
__LINE__
); \

120 *(
tŸÆ
Ë+((
Àn
Ë+ 
_Æignmít
); \

122 }  0)

	)

125 
	#DOOFFSET
(
obje˘
, 
off£t
) \

127 i‡(
obje˘
 !
NULL
) \

128 (
obje˘
Ë(*)((
uöçå_t
)(obje˘Ë+ (
off£t
)); \

129 }  0)

	)

131 
	#DOCOPY
(
§c
, 
§coff£t
, 
d°
, 
©å
, 
©åsize
, 
memfunc
) \

133 c⁄° 
size_t
 
toc›y
 = (
©åsize
); \

135 i‡(
toc›y
 == 0) { \

136 
	`SASSERTX
((
§c
)->
©å
 =
NULL
); \

137 
	`SASSERTX
((
d°
)->
©å
 =
NULL
); \

140 
	`SASSERTX
((
§c
)->
©å
 !
NULL
); \

142 i‡(((
d°
)->
©å
 = 
	`memfunc
(
toc›y
)Ë=
NULL
) { \

143 
	`sw¨n
("%s: failedÅoállocate %lu byte%s of memoryátÜine %d. " \

145 
fun˘i⁄
, \

146 ()
toc›y
, \

147 
toc›y
 == 1 ? "" : "s", \

148 
__LINE__
, \

149 ()
	`memÀ·_no_Æignmít_luck
()); \

153 
	`DOOFFSET
(((
§c
)->
©å
), 
§coff£t
); \

154 
	`mem˝y
((
d°
)->
©å
, (
§c
)->©å, 
toc›y
); \

156 }  0)

	)

158 
	#DOLINKCOPY
(
l§c
, 
§coff£t
, 
ld°
, 
œâr
, 
memfunc
) \

160 
löked«me_t
 *
§˛ök
, *
d°lök
; \

162 
	`SASSERTX
(
l§c
 !
NULL
); \

164 i‡((
§˛ök
 = (
l§c
)->
œâr
Ë=
NULL
) \

167 
	`DOOFFSET
(
§˛ök
, 
§coff£t
); \

168 (
l§c
)->
œâr
 = 
§˛ök
; \

170 i‡(((
ld°
)->
œâr
 = 
	`memfunc
((*÷d°)->œâr))Ë=
NULL
) { \

171 
	`sw¨nx
("%s: failedÅoállocate %lu byte%s of memoryátÜine %d", \

172 
fun˘i⁄
, \

173 ()(*(
ld°
)->
œâr
), \

174 ()(*(
ld°
)->
œâr
) == 1 ? "" : "s", \

175 
__LINE__
); \

178 
d°lök
 = (
ld°
)->
œâr
; \

181 *
«me
; \

183 
	`SASSERTX
(
§˛ök
->
«me
 !
NULL
); \

184 
«me
 = 
§˛ök
->name; \

186 
	`DOOFFSET
(
«me
, 
§coff£t
); \

187 
	`DOCOPY
(
§˛ök
, 
§coff£t
, 
d°lök
, 
«me
, 
	`°æí
“ameË+ 1, 
memfunc
); \

189 
	`DOOFFSET
(
§˛ök
->
√xt
, 
§coff£t
); \

190 i‡(
§˛ök
->
√xt
 =
NULL
) \

191 
d°lök
->
√xt
 = 
NULL
; \

193 i‡((
d°lök
->
√xt
 = 
	`memfunc
((*d°lök->√xt))Ë=
NULL
) { \

194 
	`sw¨nx
("%s: failedÅoállocate %lu byte%s of memoryátÜine %d", \

195 
fun˘i⁄
, \

196 ()(*
d°lök
->
√xt
), \

197 ()(*
d°lök
->
√xt
) == 1 ? "" : "s", \

198 
__LINE__
); \

203 
d°lök
 = d°lök->
√xt
; \

204 
§˛ök
 = sr˛ök->
√xt
; \

205 } 
§˛ök
 !
NULL
); \

206 }  0)

	)

208 
	#DOLOGCOPY
(
§c
, 
§coff£t
, 
d°
, 
©å
, 
memfunc
) \

210 i‡((
§c
)->
©å
.
fûíoc
 > 0) { \

211 
size_t
 
i
; \

213 
	`DOCOPY
(
§c
, \

214 
§coff£t
, \

215 
d°
, \

216 
©å
.
‚amev
, \

217 (*
§c
->
©å
.
‚amev
Ë* src->©å.
fûíoc
, \

218 
memfunc
); \

220 
i
 = 0; i < 
§c
->
©å
.
fûíoc
; ++i) \

221 
	`DOCOPY
(
§c
, \

222 
§coff£t
, \

223 
d°
, \

224 
©å
.
‚amev
[
i
], \

225 
	`°æí
((*)((
uöçå_t
)
§c
->
©å
.
‚amev
[
i
] + 
§coff£t
)) + 1, \

226 
memfunc
); \

228 
	`DOCOPY
(
§c
, \

229 
§coff£t
, \

230 
d°
, \

231 
©å
.
fûíov
, \

232 (*
§c
->
©å
.
fûíov
Ë* src->©å.
fûíoc
, \

233 
memfunc
); \

235 
	`DOCOPY
(
§c
, \

236 
§coff£t
, \

237 
d°
, \

238 
©å
.
¸óãdv
, \

239 (*
§c
->
©å
.
¸óãdv
Ë* src->©å.
fûíoc
, \

240 
memfunc
); \

242 }  0)

	)

245 
size_t


246 
	$poöãr_size
(
c⁄fig
)

247 
c⁄fig
 *config;

250  
	`poöãr_c›y‹size
(
SIZE
, 
c⁄fig
, 0, 
NULL
, NULL, 0);

251 
	}
}

254 
	$poöãr_c›y
(
§c
, 
§coff£t
, 
d°
, 
mem
, 
memsize
)

255 
c⁄fig
 *
§c
;

256 c⁄° 
±rdiff_t
 
§coff£t
;

257 
c⁄fig
 *
d°
;

258 *
mem
;

259 c⁄° 
size_t
 
memsize
;

261 c⁄° *
fun˘i⁄
 = "pointer_copy()";

263 
	`SASSERTX
(
d°
 !
NULL
);

265  
	`poöãr_c›y‹size
(
COPY
,

266 
§c
,

267 
§coff£t
,

268 
d°
,

269 
mem
,

270 
memsize
);

271 
	}
}

273 
ssize_t


274 
	$poöãr_c›y‹size
(
›
, 
§c
, 
§coff£t
, 
d°
, 
mem
, 
memsize
)

275 c⁄° 
c⁄fig›_t
 
›
;

276 
c⁄fig
 *
§c
;

277 c⁄° 
±rdiff_t
 
§coff£t
;

278 
c⁄fig
 *
d°
;

279 *
mem
;

280 c⁄° 
size_t
 
memsize
;

282 c⁄° *
fun˘i⁄
 = "pointer_copyorsize()";

283 *(*
memfunc
)(
size_t
 
size
Ë(
memsize
 =0 ? 
mÆloc
 : 
gëmem
);

284 
ruÀ_t
 *
§¸uÀv
[] = { 
§c
->
¸uÀ
, src->
hruÀ
, src->
§uÀ
 };

285 
ssize_t
 
size
;

286 
size_t
 
i
;

287 
doc›y
 = 0, 
do‰ì
 = 0, 
dosize
 = 0;

289 
›
) {

290 
COPY
:

291 
doc›y
 = 1;

294 
SIZE
:

295 
dosize
 = 1;

299 
	`SERRX
(
›
);

302 
	`¶og
(
LOG_DEBUG
,

305 
fun˘i⁄
,

306 
doc›y
,

307 
do‰ì
,

308 
dosize
,

309 
mem
,

310 ()
memsize
,

311 ()
§coff£t
);

318 
	`poﬁöô
(
mem
, 
memsize
);

326 
size
 = 0;

328 i‡(
§c
->
öã∫Æ
.
addrc
 > 0) {

329 
›
) {

330 
COPY
:

331 
	`DOCOPY
(
§c
,

332 
§coff£t
,

333 
d°
,

334 
öã∫Æ
.
addrv
,

335 (*
§c
->
öã∫Æ
.
addrv
Ë* src->öã∫Æ.
addrc
,

336 
memfunc
);

339 
SIZE
:

340 
	`ADDLEN
((*
§c
->
öã∫Æ
.
addrv
Ë* src->öã∫Æ.
addrc
, &
size
);

345 i‡(
§c
->
exã∫Æ
.
addrc
 > 0) {

346 
›
) {

347 
COPY
:

348 
	`DOCOPY
(
§c
,

349 
§coff£t
,

350 
d°
,

351 
exã∫Æ
.
addrv
,

352 (*
§c
->
exã∫Æ
.
addrv
Ë* src->exã∫Æ.
addrc
,

353 
memfunc
);

356 
SIZE
:

357 
	`ADDLEN
((*
§c
->
exã∫Æ
.
addrv
Ë* src->exã∫Æ.
addrc
, &
size
);

363 
i
 = 0; i < 
	`ELEMENTS
(
§¸uÀv
); ++i) {

364 
ruÀ_t
 *
d°ruÀ
;

365 
ruÀ_t
 *
§¸uÀ
 = 
§¸uÀv
[
i
];

367 i‡(
§¸uÀ
 =
NULL
)

370 
›
) {

371 
COPY
:

377 
	`DOOFFSET
(
§¸uÀ
, 
§coff£t
);

379 
§¸uÀ
->
ty≥
) {

380 
obje˘_¸uÀ
:

381 
	`DOCOPY
(
§c
,

382 
§coff£t
,

383 
d°
,

384 
¸uÀ
,

385 (*
§c
->
¸uÀ
),

386 
memfunc
);

387 
d°ruÀ
 = 
d°
->
¸uÀ
;

390 #i‡
HAVE_SOCKS_HOSTID


391 
obje˘_hruÀ
:

392 
	`DOCOPY
(
§c
,

393 
§coff£t
,

394 
d°
,

395 
hruÀ
,

396 (*
§c
->
hruÀ
),

397 
memfunc
);

398 
d°ruÀ
 = 
d°
->
hruÀ
;

402 
obje˘_§uÀ
:

403 
	`DOCOPY
(
§c
,

404 
§coff£t
,

405 
d°
,

406 
§uÀ
,

407 (*
§c
->
§uÀ
),

408 
memfunc
);

409 
d°ruÀ
 = 
d°
->
§uÀ
;

413 
	`SERRX
(
§¸uÀ
->
ty≥
);

418 
SIZE
:

419 
	`ADDLEN
((*
§¸uÀ
), &
size
);

424 i‡(
§¸uÀ
->
sockë›ti⁄c
 > 0) {

425 
›
) {

426 
COPY
:

427 
	`DOCOPY
(
§¸uÀ
,

428 
§coff£t
,

429 
d°ruÀ
,

430 
sockë›ti⁄v
,

431 (*
§¸uÀ
->
sockë›ti⁄v
Ë* sr¸uÀ->
sockë›ti⁄c
,

432 
memfunc
);

435 
SIZE
:

436 
	`ADDLEN
((*
§¸uÀ
->
sockë›ti⁄v
)

437 * 
§¸uÀ
->
sockë›ti⁄c
,

438 &
size
);

443 #i‡
HAVE_LDAP


444 
›
) {

445 
COPY
:

446 
	`DOLINKCOPY
(
§¸uÀ
,

447 
§coff£t
,

448 
d°ruÀ
,

449 
°©e
.
ld≠
.
ld≠uæ
,

450 
memfunc
);

452 
	`DOLINKCOPY
(
§¸uÀ
,

453 
§coff£t
,

454 
d°ruÀ
,

455 
°©e
.
ld≠
.
ld≠ba£dn
,

456 
memfunc
);

459 
SIZE
:

460 
	`ADDLEN
(
	`lökedsize
(
§¸uÀ
->
°©e
.
ld≠
.
ld≠uæ
), &
size
);

461 
	`ADDLEN
(
	`lökedsize
(
§¸uÀ
->
°©e
.
ld≠
.
ld≠ba£dn
), &
size
);

467 
›
) {

468 
COPY
:

469 
	`DOLINKCOPY
(
§¸uÀ
, 
§coff£t
, 
d°ruÀ
, 
u£r
, 
memfunc
);

470 
	`DOLINKCOPY
(
§¸uÀ
, 
§coff£t
, 
d°ruÀ
, 
group
, 
memfunc
);

473 
SIZE
:

474 
	`ADDLEN
(
	`lökedsize
(
§¸uÀ
->
u£r
), &
size
);

475 
	`ADDLEN
(
	`lökedsize
(
§¸uÀ
->
group
), &
size
);

479 #i‡
HAVE_LDAP


480 
›
) {

481 
COPY
:

482 
	`DOLINKCOPY
(
§¸uÀ
, 
§coff£t
, 
d°ruÀ
, 
ld≠group
, 
memfunc
);

483 
	`DOLINKCOPY
(
§¸uÀ
, 
§coff£t
, 
d°ruÀ
, 
ld≠£rvî
, 
memfunc
);

486 
SIZE
:

487 
	`ADDLEN
(
	`lökedsize
(
§¸uÀ
->
ld≠group
), &
size
);

488 
	`ADDLEN
(
	`lökedsize
(
§¸uÀ
->
ld≠£rvî
), &
size
);

493 
›
) {

494 
COPY
:

495 i‡(
§¸uÀ
->
√xt
 =
NULL
)

496 
d°ruÀ
->
√xt
 = 
NULL
;

498 
	`DOCOPY
(
§¸uÀ
,

499 
§coff£t
,

500 
d°ruÀ
,

501 
√xt
,

502 (*
§¸uÀ
->
√xt
),

503 
memfunc
);

505 
§¸uÀ
 = sr¸uÀ->
√xt
;

506 
d°ruÀ
 = d°ruÀ->
√xt
;

509 
SIZE
:

510 i‡(
§¸uÀ
->
√xt
 !
NULL
)

511 
	`ADDLEN
((*
§¸uÀ
), &
size
);

513 
§¸uÀ
 = sr¸uÀ->
√xt
;

517 } 
§¸uÀ
 !
NULL
);

520 i‡(
§c
->
rouã
 !
NULL
) {

521 
rouã_t
 *
d°rouã
;

522 
rouã_t
 *
§¸ouã
;

524 
›
) {

525 
COPY
:

526 
	`DOCOPY
(
§c
, 
§coff£t
, 
d°
, 
rouã
, (*§c->rouã), 
memfunc
);

527 
d°rouã
 = 
d°
->
rouã
;

530 
SIZE
:

531 
	`ADDLEN
((*
§¸ouã
), &
size
);

535 
§¸ouã
 = 
§c
->
rouã
;

538 
›
) {

539 
COPY
:

540 
	`DOCOPY
(
§¸ouã
,

541 
§coff£t
,

542 
d°rouã
,

543 
sockë›ti⁄v
,

544 (*
§¸ouã
->
sockë›ti⁄v
Ë* sr¸ouã->
sockë›ti⁄c
,

545 
memfunc
);

547 i‡(
§¸ouã
->
√xt
 =
NULL
)

548 
d°rouã
->
√xt
 = 
NULL
;

550 
	`DOCOPY
(
§¸ouã
,

551 
§coff£t
,

552 
d°rouã
,

553 
√xt
,

554 (*
§¸ouã
->
√xt
),

555 
memfunc
);

557 
d°rouã
 = d°rouã->
√xt
;

558 
§¸ouã
 = sr¸ouã->
√xt
;

561 
SIZE
:

562 
	`ADDLEN
((*
§¸ouã
->
sockë›ti⁄v
)

563 * 
§¸ouã
->
sockë›ti⁄c
,

564 &
size
);

566 i‡(
§¸ouã
->
√xt
 !
NULL
)

567 
	`ADDLEN
((*
§¸ouã
), &
size
);

569 
§¸ouã
 = sr¸ouã->
√xt
;

572 } 
§¸ouã
 !
NULL
);

575 i‡(
§c
->
m⁄ô‹
 !
NULL
) {

576 
m⁄ô‹_t
 *
d°m⁄ô‹
;

577 
m⁄ô‹_t
 *
§cm⁄ô‹
;

579 
›
) {

580 
COPY
:

581 
	`DOCOPY
(
§c
,

582 
§coff£t
,

583 
d°
,

584 
m⁄ô‹
,

585 (*
§c
->
m⁄ô‹
),

586 
memfunc
);

588 
d°m⁄ô‹
 = 
d°
->
m⁄ô‹
;

591 
SIZE
:

592 
	`ADDLEN
((*
§cm⁄ô‹
), &
size
);

596 
§cm⁄ô‹
 = 
§c
->
m⁄ô‹
;

598 
›
) {

599 
COPY
:

600 i‡(
§cm⁄ô‹
->
√xt
 =
NULL
)

601 
d°m⁄ô‹
->
√xt
 = 
NULL
;

603 
	`DOCOPY
(
§cm⁄ô‹
,

604 
§coff£t
,

605 
d°m⁄ô‹
,

606 
√xt
,

607 (*
d°m⁄ô‹
->
√xt
),

608 
memfunc
);

610 
d°m⁄ô‹
 = d°m⁄ô‹->
√xt
;

611 
§cm⁄ô‹
 = srcm⁄ô‹->
√xt
;

614 
SIZE
:

615 i‡(
§cm⁄ô‹
->
√xt
 !
NULL
)

616 
	`ADDLEN
((*
§cm⁄ô‹
), &
size
);

618 
§cm⁄ô‹
 = srcm⁄ô‹->
√xt
;

621 } 
§cm⁄ô‹
 !
NULL
);

624 i‡(
§c
->
sockë›ti⁄c
 > 0) {

625 
›
) {

626 
COPY
:

627 
	`DOCOPY
(
§c
,

628 
§coff£t
,

629 
d°
,

630 
sockë›ti⁄v
,

631 (*
§c
->
sockë›ti⁄v
Ë* src->
sockë›ti⁄c
,

632 
memfunc
);

635 
SIZE
:

636 
	`ADDLEN
((*
§c
->
sockë›ti⁄v
Ë* src->
sockë›ti⁄c
,

637 &
size
);

642 i‡(
doc›y
) {

643 
d°
->
ﬁdshmemv
 = 
sockscf
.oldshmemv;

644 
d°
->
°©
 = 
sockscf
.stat;

645 
d°
->
°©e
 = 
sockscf
.state;

646 
d°
->
chûd
 = 
sockscf
.child;

649 
›
) {

650 
COPY
:

651 
	`DOLOGCOPY
(
§c
, 
§coff£t
, 
d°
, 
îæog
, 
memfunc
);

652 
	`DOLOGCOPY
(
§c
, 
§coff£t
, 
d°
, 
log
, 
memfunc
);

655 
SIZE
: {

656 
logty≥_t
 *
logv
[] = { &
§c
->
îæog
, &§c->
log
 };

658 
i
 = 0; i < 
	`ELEMENTS
(
logv
); ++i) {

659 i‡(
logv
[
i
]->
fûíoc
 > 0) {

660 
size_t
 
ii
;

662 
	`ADDLEN
(((*
logv
[
i
]->
‚amev
)Ë*Üogv[i]->
fûíoc
, &
size
);

663 
	`ADDLEN
((*(
logv
[
i
]->
¸óãdv
)Ë*Üogv[i]->
fûíoc
, &
size
);

664 
	`ADDLEN
((*(
logv
[
i
]->
fûíov
)Ë*Üogv[i]->
fûíoc
, &
size
);

666 
ii
 = 0; iò< 
logv
[
i
]->
fûíoc
; ++ii)

667 
	`ADDLEN
(
	`°æí
(
logv
[
i
]->
‚amev
[
ii
]Ë+ 1, &
size
);

674 
	`¶og
(
LOG_DEBUG
, "%s:Éxtra bytes used dueÅoálignment issues: %lu",

675 
fun˘i⁄
, ()
_exåa_due_Æignmít
);

677 i‡(
›
 =
COPY
) {

678 i‡(
	`memÀ·_no_Æignmít_luck
() == 0)

679 
	`¶og
(
LOG_DEBUG
,

680 "%s:áŒáŒoˇãd byã†u£d,á†ex≥˘ed", 
fun˘i⁄
);

682 
	`sw¨nx
("%s: %lu byte%s of memoryÜeft inÖooláfter copyingÅo dst",

683 
fun˘i⁄
,

684 ()
	`memÀ·_no_Æignmít_luck
(),

685 
	`memÀ·_no_Æignmít_luck
() == 1 ? "" : "s");

688 i‡(
dosize
)

689  
size
;

692 
	}
}

694 
size_t


695 
	$com∑ªc⁄figs
(
a
, 
b
)

696 c⁄° 
c⁄fig
 *
a
;

697 c⁄° 
c⁄fig
 *
b
;

699 
	#CHECKRESULT
(
rc
, 
©å
, 
size
) \

701 i‡((
rc
) != 0) { \

702 
	`sw¨nx
("%s: %lu byte%s compare onÜine %d saysáttribute \"%s\" isÇot " \

704 
fun˘i⁄
, \

705 ()(
size
), \

706 
size
 == 1 ? "" : "s", \

707 
__LINE__
, \

713 
com∑ªd
 +
size
; \

714 }  0)

	)

716 
	#PTRCHECK
(
a
, 
b
, 
©å
) \

718 i‡((
a
->
©å
 =
NULL
 && 
b
->attr != NULL) \

719 || (
a
->
©å
 !
NULL
 && 
b
->attr == NULL)) { \

720 
	`sw¨nx
("%s: \"%s\"-attribute in objectsáreÇotÅhe same. " \

722 
fun˘i⁄
, \

726 
a
->
©å
 =
NULL
 ? "a" : "isÇotá", \

728 
b
->
©å
 =
NULL
 ? "is" : "isÇot"); \

732 }  0)

	)

734 
	#EQCHECK_PTR
(
a
, 
b
, 
©å
, 
size
) \

736 
rc
; \

738 
	`PTRCHECK
((
a
), (
b
), 
©å
); \

739 i‡((
a
)->
©å
 !
NULL
) { \

740 
rc
 = 
	`memcmp
((
a
)->
©å
, (
b
)->©å, (
size
)); \

741 
	`CHECKRESULT
(
rc
, 
©å
, 
size
); \

743 }  0)

	)

745 
	#EQCHECK
(
a
, 
b
, 
©å
) \

747 
size_t
 
size
; \

748 
rc
; \

750 
size
 = (
a
->
©å
); \

751 
rc
 = 
	`memcmp
(&
a
->
©å
, &
b
->©å, 
size
); \

753 
	`CHECKRESULT
(
rc
, 
©å
, 
size
); \

755 }  0)

	)

757 
	#LINKCHECK
(
l§c
, 
ld°
, 
œâr
) \

759 
	`PTRCHECK
(
l§c
, 
ld°
, 
œâr
); \

760 i‡(
l§c
->
œâr
 !
NULL
) { \

761 
löked«me_t
 *
§˛ök
 = 
l§c
->
œâr
; \

762 
löked«me_t
 *
d°lök
 = 
ld°
->
œâr
; \

765 
	`EQCHECK_PTR
(
§˛ök
, \

766 
d°lök
, \

767 
«me
, \

768 
	`°æí
(
§˛ök
->
«me
) + 1); \

769 
	`PTRCHECK
(
§˛ök
, 
d°lök
, 
√xt
); \

771 
§˛ök
 = sr˛ök->
√xt
; \

772 
d°lök
 = d°lök->
√xt
; \

773 } 
§˛ök
 !
NULL
); \

775 }  0)

	)

777 c⁄° *
fun˘i⁄
 = "compareconfigs()";

778 c⁄° 
ruÀ_t
 *
¨uÀv
[] = { 
a
->
¸uÀ
,á->
hruÀ
,á->
§uÀ
 },

779 *
bruÀv
[] = { 
b
->
¸uÀ
, b->
hruÀ
, b->
§uÀ
 };

780 c⁄° 
logty≥_t
 *
Æogv
[] = { &
a
->
îæog
, &a->
log
 },

781 *
blogv
[] = { &
b
->
îæog
, &b->
log
 };

782 
size_t
 
i
, 
com∑ªd
 = 0;

791 
	`EQCHECK
(
a
, 
b
, 
öôül
);

793 
	`EQCHECK_PTR
(
a
,

794 
b
,

795 
öã∫Æ
.
addrv
,

796 (*
a
->
öã∫Æ
.
addrv
Ë*á->öã∫Æ.
addrc
);

798 
	`EQCHECK_PTR
(
a
,

799 
b
,

800 
exã∫Æ
.
addrv
,

801 (*
a
->
exã∫Æ
.
addrv
Ë*á->exã∫Æ.
addrc
);

802 
	`EQCHECK
(
a
, 
b
, 
˝u
);

804 
	`PTRCHECK
(
a
, 
b
, 
¸uÀ
);

805 
	`PTRCHECK
(
a
, 
b
, 
hruÀ
);

806 
	`PTRCHECK
(
a
, 
b
, 
§uÀ
);

807 
i
 = 0; i < 
	`ELEMENTS
(
¨uÀv
); ++i) {

808 c⁄° 
ruÀ_t
 *
¨uÀ
 = 
¨uÀv
[
i
], *
bruÀ
 = 
bruÀv
[i];

809 
ruÀ_t
 
tm¥uÀa
, 
tm¥uÀb
;

811 i‡(
¨uÀv
[
i
] =
NULL
)

814 
	`SASSERTX
(
¨uÀ
 !
NULL
);

815 
	`SASSERTX
(
bruÀ
 !
NULL
);

818 
	`EQCHECK_PTR
(
¨uÀ
,

819 
bruÀ
,

820 
sockë›ti⁄v
,

821 (*
¨uÀ
->
sockë›ti⁄v
Ë*áruÀ->
sockë›ti⁄c
);

823 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
§c
);

824 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
d°
);

825 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
rdr_‰om
);

826 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
rdr_to
);

827 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
ho°id›ti⁄_is£t
);

828 #i‡
HAVE_SOCKS_HOSTID


829 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
ho°id
);

830 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
ho°ödex
);

833 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
log
);

834 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
numbî
);

835 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
löíumbî
);

841 
tm¥uÀa
 = *
¨uÀ
;

842 
tm¥uÀb
 = *
bruÀ
;

844 #i‡
HAVE_LDAP


845 
tm¥uÀa
.
°©e
.
ld≠
.
ld≠uæ
 = 
tm¥uÀb
.state.ldap.ldapurl;

846 
tm¥uÀa
.
°©e
.
ld≠
.
ld≠ba£dn
 = 
tm¥uÀb
.state.ldap.ldapbasedn;

849 
	`EQCHECK
((&
tm¥uÀa
), (&
tm¥uÀb
), 
°©e
);

851 #i‡
HAVE_LDAP


852 
	`LINKCHECK
(
¨uÀ
, 
bruÀ
, 
°©e
.
ld≠
.
ld≠uæ
);

853 
	`LINKCHECK
(
¨uÀ
, 
bruÀ
, 
°©e
.
ld≠
.
ld≠ba£dn
);

856 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
timeout
);

857 
	`LINKCHECK
(
¨uÀ
, 
bruÀ
, 
u£r
);

858 
	`LINKCHECK
(
¨uÀ
, 
bruÀ
, 
group
);

860 #i‡
HAVE_LDAP


861 
	`LINKCHECK
(
¨uÀ
, 
bruÀ
, 
ld≠group
);

862 
	`LINKCHECK
(
¨uÀ
, 
bruÀ
, 
ld≠£rvî
);

863 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
ld≠£âögs‰omu£r
);

866 #i‡
HAVE_LIBWRAP


867 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
libwøp
);

870 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
bw_shmid
);

871 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
m°©s_shmid
);

872 
	`EQCHECK
(
¨uÀ
, 
bruÀ
, 
ss_shmid
);

874 
	`PTRCHECK
(
¨uÀ
, 
bruÀ
, 
√xt
);

875 
¨uÀ
 =áruÀ->
√xt
;

876 
bruÀ
 = bruÀ->
√xt
;

877 } 
¨uÀ
 !
NULL
);

880 
	`EQCHECK
(
a
, 
b
, 
rouã›ti⁄s
);

881 
	`PTRCHECK
(
a
, 
b
, 
rouã
);

882 i‡(
a
->
rouã
 !
NULL
) {

883 
rouã_t
 *
¨ouã
 = 
a
->
rouã
,

884 *
brouã
 = 
b
->
rouã
;

887 
	`EQCHECK
(
¨ouã
, 
brouã
, 
numbî
);

888 
	`EQCHECK
(
¨ouã
, 
brouã
, 
°©e
);

890 
	`EQCHECK
(
¨ouã
, 
brouã
, 
sockë›ti⁄c
);

891 
	`EQCHECK_PTR
(
¨ouã
,

892 
brouã
,

893 
sockë›ti⁄v
,

894 (*
¨ouã
->
sockë›ti⁄v
Ë*árouã->
sockë›ti⁄c
);

896 
	`EQCHECK
(
¨ouã
, 
brouã
, 
§c
);

897 
	`EQCHECK
(
¨ouã
, 
brouã
, 
d°
);

898 
	`EQCHECK
(
¨ouã
, 
brouã
, 
gw
);

899 
	`EQCHECK
(
¨ouã
, 
brouã
, 
rdr_‰om
);

901 
	`PTRCHECK
(
¨ouã
, 
brouã
, 
√xt
);

902 
¨ouã
 =árouã->
√xt
;

903 
brouã
 = brouã->
√xt
;

904 } 
¨ouã
 !
NULL
);

907 i‡(
a
->
m⁄ô‹
 !
NULL
) {

908 
m⁄ô‹_t
 *
am⁄
 = 
a
->
m⁄ô‹
, *
bm⁄
 = 
b
->monitor;

911 
	`EQCHECK
(
am⁄
, 
bm⁄
, 
numbî
);

912 
	`EQCHECK
(
am⁄
, 
bm⁄
, 
m°©s_shmid
);

913 
	`EQCHECK
(
am⁄
, 
bm⁄
, 
§c
);

914 
	`EQCHECK
(
am⁄
, 
bm⁄
, 
d°
);

916 #i‡
HAVE_SOCKS_HOSTID


917 
	`EQCHECK
(
am⁄
, 
bm⁄
, 
ho°id
);

918 
	`EQCHECK
(
am⁄
, 
bm⁄
, 
ho°ödex
);

921 
	`PTRCHECK
(
am⁄
, 
bm⁄
, 
√xt
);

922 
am⁄
 =ám⁄->
√xt
;

923 
bm⁄
 = bm⁄->
√xt
;

924 } 
am⁄
 !
NULL
);

928 
	`EQCHECK
(
a
, 
b
, 
sockë›ti⁄c
);

929 
	`EQCHECK_PTR
(
a
,

930 
b
,

931 
sockë›ti⁄v
,

932 (*
a
->
sockë›ti⁄v
Ë*á->
sockë›ti⁄c
);

934 
	`EQCHECK
(
a
, 
b
, 
com∑t
);

935 
	`EQCHECK
(
a
, 
b
, 
exãnsi⁄
);

937 
i
 = 0; i < 
	`ELEMENTS
(
Æogv
); ++i) {

938 c⁄° 
logty≥_t
 *
Æog
 = 
Æogv
[
i
], *
blog
 = 
blogv
[i];

940 
	`EQCHECK
(
Æog
, 
blog
, 
ty≥
);

942 
	`PTRCHECK
(
Æog
, 
blog
, 
fûíov
);

943 
	`PTRCHECK
(
Æog
, 
blog
, 
¸óãdv
);

945 i‡(
Æog
->
‚amev
 !
NULL
) {

946 
size_t
 
ii
;

948 
ii
 = 0; iò< 
Æog
->
fûíoc
; ++ii)

949 
	`EQCHECK_PTR
(
Æog
,

950 
blog
,

951 
‚amev
[
ii
],

952 
	`°æí
(
Æog
->
‚amev
[
ii
]) + 1);

954 
	`SASSERTX
(
Æog
->
fûíov
 !
NULL
);

955 
	`EQCHECK_PTR
(
Æog
,

956 
blog
,

957 
fûíov
,

958 (*
Æog
->
fûíov
Ë*álog->
fûíoc
);

960 
	`SASSERTX
(
Æog
->
¸óãdv
 !
NULL
);

961 
	`EQCHECK_PTR
(
Æog
,

962 
blog
,

963 
¸óãdv
,

964 (*
Æog
->
¸óãdv
Ë*álog->
fûíoc
);

967 
	`PTRCHECK
(
Æog
, 
blog
, 
‚amev
);

969 
	`EQCHECK
(
Æog
, 
blog
, 
fûíoc
);

970 
	`EQCHECK
(
Æog
, 
blog
, 
Ácûôy
);

971 
	`EQCHECK
(
Æog
, 
blog
, 
Ácûôy«me
);

974 
	`EQCHECK
(
a
, 
b
, 
§cho°
);

976 #i‡!
HAVE_PRIVILEGES


977 
	`EQCHECK
(
a
, 
b
, 
uid
);

980 
	`EQCHECK
(
a
, 
b
, 
cmëhodv
);

981 
	`EQCHECK
(
a
, 
b
, 
cmëhodc
);

983 
	`EQCHECK
(
a
, 
b
, 
smëhodv
);

984 
	`EQCHECK
(
a
, 
b
, 
smëhodc
);

986 
	`EQCHECK
(
a
, 
b
, 
udpc⁄√˘d°
);

990  
com∑ªd
;

991 
	}
}

993 
size_t


994 
	$lökedsize
(
li°
)

995 c⁄° 
löked«me_t
 *
li°
;

997 c⁄° *
fun˘i⁄
 = "linkedsize()";

998 
size_t
 
size
 = 0;

1000 i‡(
li°
 =
NULL
)

1003 
size
 +(*
li°
);

1004 
	`ADDLEN
(
	`°æí
(
li°
->
«me
Ë+ 1 , &
size
);

1005 
li°
 =Üi°->
√xt
;

1007 
li°
 !
NULL
) {

1008 
	`ADDLEN
((*
li°
), &
size
);

1009 
	`ADDLEN
(
	`°æí
(
li°
->
«me
Ë+ 1 , &
size
);

1010 
li°
 =Üi°->
√xt
;

1013  
size
;

1014 
	}
}

1017 
	$poﬁöô
(
poﬁ
, 
size
)

1018 *
poﬁ
;

1019 c⁄° 
size_t
 
size
;

1021 c⁄° *
fun˘i⁄
 = "poolinit()";

1027 c⁄° *
_voidv
[2];

1028 
_mask
 = ~(((
uöçå_t
)&
_voidv
[1] - (uintptr_t)&_voidv[0]) - 1);

1029 
_Æignmít
 = ((
uöçå_t
)&
_voidv
[1] - (uintptr_t)&_voidv[0]),

1031 
_√xt°¨t
 = 
poﬁ
;

1032 
_À·
 = 
_À·_no_Æignmít_luck
 = 
size
;

1034 
	`¶og
(
LOG_DEBUG
,

1037 
fun˘i⁄
, ()
size
, 
poﬁ
, ()
_Æignmít
);

1038 
	}
}

1041 
	$gëmem
(
size
)

1042 c⁄° 
size_t
 
size
;

1044 c⁄° *
fun˘i⁄
 = "getmem()";

1045 *
°¨t
;

1046 
size_t
 
size_wôh_∑ddög
;

1057 
°¨t
 = (*)(((
uöçå_t
)(
_√xt°¨t
Ë+ 
_Æignmít
Ë& 
_mask
);

1058 
size_wôh_∑ddög
 = ((
uöçå_t
)
°¨t
 - (uöçå_t)
_√xt°¨t
Ë+ 
size
;

1060 
	`¶og
(
LOG_DEBUG
, "%s: size %lu (withÖadding: %lu)",

1061 
fun˘i⁄
, ()
size
, ()
size_wôh_∑ddög
);

1063 i‡(
_À·
 < 
size_wôh_∑ddög
)

1064  
NULL
;

1066 
_exåa_due_Æignmít
 +
size_wôh_∑ddög
 - 
size
;

1067 
_À·_no_Æignmít_luck
 -
size
 + 
_Æignmít
;

1069 
_À·
 -
size_wôh_∑ddög
;

1070 
_√xt°¨t
 = (*)((
uöçå_t
)_√xt°¨à+ 
size_wôh_∑ddög
);

1072 
	`SASSERTX
(((
uöçå_t
)
°¨t
 % 
_Æignmít
) == 0);

1073  
°¨t
;

1074 
	}
}

1077 
	$doc⁄figã°
()

1079 c⁄° *
fun˘i⁄
 = "doconfigtest()";

1080 
c⁄fig
 *
shmem
;

1081 
size_t
 
size
, 
poöãdto
, 
mempoöãdto
;

1082 
c⁄fig
 *
mem
;

1084 
	`¶og
(
LOG_DEBUG
,

1086 
fun˘i⁄
);

1088 
poöãdto
 = 
	`poöãr_size
(&
sockscf
);

1089 
	`¶og
(
LOG_DEBUG
, "%s: size of config: %lu,ÖointedÅo size: %lu",

1090 
fun˘i⁄
, ()(
sockscf
), ()
poöãdto
);

1092 
size
 = (
sockscf
Ë+ 
poöãdto
;

1093 i‡((
shmem
 = 
	`mÆloc
(
size
)Ë=
NULL
)

1094 
	`£ºx
("%s: couldÇŸ mÆloc(3Ë%lu byãs", 
fun˘i⁄
, ()
size
);

1100 *
shmem
 = 
sockscf
;

1105 i‡(
	`poöãr_c›y
(&
sockscf
,

1107 
shmem
,

1108 (*)
shmem
 + (
sockscf
),

1109 
size
 - (
sockscf
)) == 0)

1110 
	`¶og
(
LOG_DEBUG
, "%s:Öoöãr_c›y(Ësuc˚ssful", 
fun˘i⁄
);

1112 
	`£º
("%s:Öoöãr_c›y(ËÁûed", 
fun˘i⁄
);

1114 i‡((
size
 = 
	`com∑ªc⁄figs
(&
sockscf
, 
shmem
)) == 0)

1115 
	`sw¨nx
("%s: cª©ed c⁄figÇŸ idítiˇ»tÿ‹igöÆ c⁄fig", 
fun˘i⁄
);

1117 
	`¶og
(
LOG_DEBUG
,

1119 
fun˘i⁄
, ()
size
);

1125 
	`¶og
(
LOG_DEBUG
, "%s: doingÅest #2 with memoryÖreallocated forÖointers",

1126 
fun˘i⁄
);

1128 
mempoöãdto
 = 
	`poöãr_size
(
shmem
);

1130 i‡(
mempoöãdto
 !
poöãdto
) {

1131 
	`sw¨nx
("%s: memoryÖointedÅo by shmem is %lu, butÉxpected %lu",

1132 
fun˘i⁄
, ()
mempoöãdto
, ()
poöãdto
);

1134 
	`‰ì
(
shmem
);

1138 
size
 = (
sockscf
Ë+ 
mempoöãdto
;

1139 i‡((
mem
 = 
	`mÆloc
(
size
)Ë=
NULL
)

1140 
	`£ºx
("%s: couldÇŸ mÆloc(3Ë%lu byãs", 
fun˘i⁄
, ()
size
);

1146 *
mem
 = *
shmem
;

1151 i‡(
	`poöãr_c›y
(
shmem
,

1153 
mem
,

1154 (*)
mem
 + (
sockscf
),

1155 
size
 - (
sockscf
)) == 0)

1156 
	`¶og
(
LOG_DEBUG
, "%s:Öoöãr_c›y(Ësuc˚ssful", 
fun˘i⁄
);

1158 
	`£º
("%s:Öoöãr_c›y(ËÁûed", 
fun˘i⁄
);

1160 i‡((
size
 = 
	`com∑ªc⁄figs
(
shmem
, 
mem
)) == 0)

1161 
	`sw¨nx
("%s: cª©ed c⁄figÇŸ idítiˇ»tÿ‹igöÆ c⁄fig", 
fun˘i⁄
);

1163 
	`¶og
(
LOG_DEBUG
,

1165 
fun˘i⁄
, ()
size
);

1167 
	`‰ì
(
shmem
);

1168 
	`‰ì
(
mem
);

1174 
	`¶og
(
LOG_DEBUG
,

1176 
fun˘i⁄
);

1178 
size
 = (
sockscf
);

1179 i‡((
shmem
 = 
	`mÆloc
(
size
)Ë=
NULL
)

1180 
	`£ºx
("%s: couldÇŸ mÆloc(3Ë%lu byãs", 
fun˘i⁄
, ()
size
);

1186 *
shmem
 = 
sockscf
;

1191 i‡(
	`poöãr_c›y
(&
sockscf
,

1193 
shmem
,

1194 
NULL
,

1196 
	`¶og
(
LOG_DEBUG
, "%s:Öoöãr_c›y(Ësuc˚ssful", 
fun˘i⁄
);

1198 
	`£º
("%s:Öoöãr_c›y(ËÁûed", 
fun˘i⁄
);

1200 i‡((
size
 = 
	`com∑ªc⁄figs
(&
sockscf
, 
shmem
)) == 0)

1201 
	`sw¨nx
("%s: cª©ed c⁄figÇŸ idítiˇ»tÿ‹igöÆ c⁄fig", 
fun˘i⁄
);

1203 
	`¶og
(
LOG_DEBUG
,

1205 
fun˘i⁄
, ()
size
);

1208 
	`sockd_‰ìlogobje˘
(&
shmem
->
log
, 0 );

1209 
	`sockd_‰ìlogobje˘
(&
shmem
->
îæog
, 0 );

1212 
	}
}

1214 
size_t


1215 
	$memÀ·
()

1217  
_À·
;

1218 
	}
}

1220 
size_t


1221 
	$memÀ·_no_Æignmít_luck
()

1223  
_À·_no_Æignmít_luck
;

1224 
	}
}

	@sockd/sockd.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

52 
	#DOTEST
 1

	)

54 #i‡
DEBUG
 && 
DOTEST


56 
dŸe°
();

64 
£rvîöô
(
¨gc
, *
¨gv
[]);

72 
ußge
(
code
);

78 
showvîsi⁄
(c⁄° 
Àvñ
);

84 
showli˚n£
();

90 
h™dÀchûdcomm™d
(c⁄° 
comm™d
, 
sockd_chûd_t
 *
chûd
,

91 *
föished
);

98 c⁄° 
	gsocks_c⁄figty≥
 = 
CONFIGTYPE_SERVER
;

100 #i‡
DIAGNOSTIC
 && 
HAVE_MALLOC_OPTIONS


101 *
mÆloc_›ti⁄s
;

104 #i‡
HAVE_PROGNAME


105 *
__¥og«me
;

106 #ñi‡
SOCKS_SERVER


107 *
	g__¥og«me
 = "sockd";

108 #ñi‡
BAREFOOTD


109 *
	g__¥og«me
 = "barefootd";

110 #ñi‡
COVENANT


111 *
	g__¥og«me
 = "covenantd";

116 *
›èrg
;

118 #i‡!
HAVE_SETPROCTITLE


119 **
	g¨gv_˝y
;

120 
	g¨gc_˝y
;

123 
	#ELECTRICFENCE
 0

	)

125 #i‡
ELECTRICFENCE


126 
EF_PROTECT_FREE
;

127 
EF_ALLOW_MALLOC_0
;

128 
EF_ALIGNMENT
;

129 
EF_PROTECT_BELOW
;

132 
maö
(
¨gc
, *
¨gv
[]);

134 #i‡!
STANDALONE_UNIT_TEST


137 
	$maö
(
¨gc
, 
¨gv
)

138 
¨gc
;

139 *
¨gv
[];

141 c⁄° *
fun˘i⁄
 = "main()";

142 
fd_£t
 *
r£t
;

143 
ssize_t
 
p
;

144 
size_t
 
i
;

145 
sockd_˛õ¡_t
 
ßved_˛õ¡
;

146 
sockd_io_t
 
ßved_io
;

147 
sockd_ªque°_t
 
ßved_ªq
;

148 
have_ßved_˛õ¡
 = 0,

149 
have_ßved_ªq
 = 0,

150 
have_ßved_io
 = 0;

152 #i‡
DIAGNOSTIC
 && 
HAVE_MALLOC_OPTIONS


153 
mÆloc_›ti⁄s
 = "AFGJP";

156 #i‡
ELECTRICFENCE


157 
EF_PROTECT_FREE
 = 1;

158 
EF_ALLOW_MALLOC_0
 = 1;

159 
EF_ALIGNMENT
 = 0;

160 
EF_PROTECT_BELOW
 = 0;

163 
	`ru√nvcheck
();

165 #i‡!
HAVE_SETPROCTITLE


166 
¨gc_˝y
 = 
¨gc
;

167 i‡((
¨gv_˝y
 = 
	`mÆloc
((*¨gv_˝yË* (
¨gc
 + 1))Ë=
NULL
)

168 
	`£º
("%s: couldÇotállocate %lu bytes of memory",

169 
fun˘i⁄
, ()((*
¨gv_˝y
Ë* (
¨gc
 + 1)));

171 
i
 = 0; i < (
size_t
)
¨gc
; i++)

172 i‡((
¨gv_˝y
[
i
] = 
	`°rdup
(
¨gv
[i])Ë=
NULL
)

173 
	`£º
("%s: %s", 
fun˘i⁄
, 
NOMEM
);

174 
¨gv_˝y
[
i
] = 
NULL
;

176 
	`öô£çro˘ôÀ
(
¨gc
, 
¨gv
);

178 
	`£rvîöô
(
¨gc_˝y
, 
¨gv_˝y
);

182 
	`£rvîöô
(
¨gc
, 
¨gv
);

186 #i‡
DEBUG
 && 
DOTEST


187 
	`dŸe°
();

190 
	`showc⁄fig
(&
sockscf
);

192 i‡(
sockscf
.
›ti⁄
.
vîify⁄ly
) {

193 
	`ª£tc⁄fig
(&
sockscf
, 1);

197 
	`mŸhî_ív£tup
(
¨gc
, 
¨gv
);

205 i‡(
	`chûdcheck
(
PROC_MONITOR
) < 1) {

206 
	`£º
("couldÇot create monitorÖrocess: %s",

207 
sockscf
.
chûd
.
nﬂddchûd_ªas⁄
 !
NULL
 ?

208 
sockscf
.
chûd
.
nﬂddchûd_ªas⁄


209 : 
	`°ªº‹
(
sockscf
.
chûd
.
nﬂddchûd_î∫o
));

213 
	`time_m⁄Ÿ⁄ic
(&
sockscf
.
°©
.
boŸ
);

215 i‡(
sockscf
.
›ti⁄
.
£rvîc
 > 1) {

221 
sig£t_t
 
Æl
, 
ﬁdmask
;

223 ()
	`sigfûl£t
(&
Æl
);

224 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
Æl
, &
ﬁdmask
) != 0)

225 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK)", 
fun˘i⁄
);

229 
i
 = 1; (
size_t
)ò< 
sockscf
.
›ti⁄
.
£rvîc
; ++i) {

230 
siga˘i⁄
 
siga˘
;

231 
pid_t
 
pid
;

233 i‡((
pid
 = 
	`f‹k
()) == -1)

234 
	`sw¨n
("fork()");

235 i‡(
pid
 == 0) {

236 
	`√w¥ocöô
();

238 
	`bzîo
(&
siga˘
, (sigact));

239 
siga˘
.
ß_Êags
 = 
SA_RESTART
 | 
SA_NOCLDSTOP
 | 
SA_SIGINFO
;

241 
siga˘
.
ß_siga˘i⁄
 = 
sighup_chûd
;

242 i‡(
	`siga˘i⁄
(
SIGHUP
, &
siga˘
, 
NULL
) != 0) {

243 
	`sw¨n
("sigaction(SIGHUP)");

244 
	`_exô
(
EXIT_FAILURE
);

247 
sockscf
.
°©e
.
mŸhîpidv
[
i
] = sockscf.°©e.
pid
;

251 
	`¶og
(
LOG_DEBUG
, "forked of %s[%lu/%lu] withÖid %lu",

252 
	`chûdty≥2°rög
(
PROC_MOTHER
),

253 ()
i
 + 1,

254 ()
sockscf
.
›ti⁄
.
£rvîc
,

255 ()
pid
);

257 
sockscf
.
°©e
.
mŸhîpidv
[
i
] = 
pid
;

261 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

262 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

265 i‡(
	`pidismaömŸhî
(
sockscf
.
°©e
.
pid
)) {

266 i‡(
sockscf
.
›ti⁄
.
debug
)

267 
	`sock›ts_dump
();

270 i‡(
	`chûdcheck
(
PROC_NEGOTIATE
Ë< 
SOCKD_FREESLOTS_NEGOTIATE


271 || 
	`chûdcheck
(
PROC_REQUEST
Ë< 
SOCKD_FREESLOTS_REQUEST


272 || 
	`chûdcheck
(
PROC_IO
Ë< 
SOCKD_FREESLOTS_IO
)

273 
	`£º
("initial childcheck() failed: %s",

274 
sockscf
.
chûd
.
nﬂddchûd_ªas⁄
 !
NULL
 ?

275 
sockscf
.
chûd
.
nﬂddchûd_ªas⁄


276 : 
	`°ªº‹
(
sockscf
.
chûd
.
nﬂddchûd_î∫o
));

278 #i‡
HAVE_PROFILING
 && 
HAVE_MONCONTROL


279 
	`m⁄c⁄åﬁ
(1);

282 i‡(
sockscf
.
›ti⁄
.
debug
)

283 
	`¶og
(
LOG_DEBUG
, "%s", 
	`mŸhî_gëlimôöfo
());

285 #i‡
PRERELEASE


286 
	`¶og
(
LOG_INFO
, "\n"

288 #i‡
BAREFOOTD


290 #ñi‡
COVENANT


292 #ñi‡
SOCKS_SERVER


303 
PRODUCT
);

306 
r£t
 = 
	`Æloˇã_maxsize_fd£t
();

308 
	`¶og
(
LOG_INFO
, "%s/server[%d/%d] v%sÑunning\n",

309 
PRODUCT
,

310 ()
	`pidismŸhî
(
sockscf
.
°©e
.
pid
),

311 ()
sockscf
.
›ti⁄
.
£rvîc
,

312 
VERSION
);

319 #i‡
HAVE_NEGOTIATE_PHASE


320 
ª•⁄£_t
 
ª•⁄£
;

322 
size_t
 
‰ì_√gc
, 
‰ì_ªqc
, 
‰ì_ioc
;

323 
sockd_chûd_t
 *
chûd
;

324 
timevÆ
 *
timeout
 = 
NULL
, 
zîŸimeout
 = { 0, 0 };

325 
rbôs
;

327 
î∫o
 = 0;

328 
rbôs
 = 
	`fûl£t
(
r£t
, &
‰ì_√gc
, &
‰ì_ªqc
, &
‰ì_ioc
);

330 i‡(
‰ì_√gc
 < 
SOCKD_FREESLOTS_NEGOTIATE


331 || 
‰ì_ªqc
 < 
SOCKD_FREESLOTS_REQUEST


332 || 
‰ì_ioc
 < 
SOCKD_FREESLOTS_IO
) {

333 
time_t
 
œ°loggedtime
;

334 
time_t
 
äow
;

336 i‡(
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(&
äow
), 
œ°loggedtime
) > 10) {

337 
	`¶og
(
LOG_WARNING
,

340 
sockscf
.
chûd
.
nﬂddchûd_ªas⁄
 =
NULL
 ? "" : ": ",

341 
sockscf
.
chûd
.
nﬂddchûd_ªas⁄
 =
NULL
 ?

342 "" : 
sockscf
.
chûd
.
nﬂddchûd_ªas⁄
,

343 
	`°ªº‹
(
sockscf
.
chûd
.
nﬂddchûd_î∫o
));

345 
œ°loggedtime
 = 
äow
;

349 #i‡
BAREFOOTD


350 i‡(!
	`ALL_UDP_BOUNCED
()) {

351 
	`¶og
(
LOG_DEBUG
,

354 
timeout
 = &
zîŸimeout
;

358 i‡(
have_ßved_˛õ¡
 || 
have_ßved_ªq
 || 
have_ßved_io
) {

359 
	`¶og
(
LOG_DEBUG
,

362 
timeout
 = &
zîŸimeout
;

365 
	`¶og
(
LOG_DEBUG
, "calling select(). FreeÇegc: %lu,Ñeqc: %lu, ioc: %lu",

366 ()
‰ì_√gc
,

367 ()
‰ì_ªqc
,

368 ()
‰ì_ioc
);

370 
p
 = 
	`£À˘n
(++
rbôs
,

371 
r£t
,

372 
NULL
,

373 
NULL
,

374 
NULL
,

375 
NULL
,

376 
timeout
);

378 
	`¶og
(
LOG_DEBUG
, "%s: selectn()Ñeturned %d (%s)",

379 
fun˘i⁄
, ()
p
, 
	`°ªº‹
(
î∫o
));

381 i‡(
p
 == -1) {

382 
	`SASSERT
(
	`ERRNOISTMP
(
î∫o
));

390 (
chûd
 = 
	`gë£t
(
ACKPIPE
, 
r£t
)Ë!
NULL
) {

391 
comm™d
;

392 
chûdisbad
 = 0, 
chûdhasföished
 = 0;

394 
î∫o
 = 0;

395 
p
 = 
	`socks_ªcv‰omn
(
chûd
->
ack
,

396 &
comm™d
,

397 (
comm™d
),

400 
NULL
,

401 
NULL
,

402 
NULL
,

403 
NULL
);

404 
	`˛ór£t
(
ACKPIPE
, 
chûd
, 
r£t
);

406 i‡(
p
 !(
comm™d
)) {

407 
p
) {

409 
	`sw¨n
("socks_recvfrom(child->ack) from %s %ld failed",

410 
	`chûdty≥2°rög
(
chûd
->
ty≥
), ()chûd->
pid
);

414 
	`sw¨nx
("EOF from %s %ld",

415 
	`chûdty≥2°rög
(
chûd
->
ty≥
), ()chûd->
pid
);

419 
	`sw¨nx
("unexpected byte count from %s %ld. "

421 
	`chûdty≥2°rög
(
chûd
->
ty≥
), ()chûd->
pid
,

422 ()(
comm™d
), ()
p
);

425 
chûdisbad
 = 1;

428 
	`h™dÀchûdcomm™d
(
comm™d
, 
chûd
, &
chûdhasföished
);

430 i‡(
chûdhasföished
 || 
chûdisbad
) {

431 
	`˛o£chûd
(
chûd
->
pid
, 
chûdhasföished
 ? 1 : 0);

450 i‡(
have_ßved_˛õ¡
) {

451 i‡((
chûd
 = 
	`√xtchûd
(
PROC_NEGOTIATE
, 
SOCKS_TCP
)Ë=
NULL
) {

452 
	`log_˛õ¡dr›≥d
(&
ßved_˛õ¡
.
‰om
);

454 
	`˛o£
(
ßved_˛õ¡
.
s
);

458 
	`SASSERTX
(
chûd
 !
NULL
);

459 
	`SASSERTX
(
chûd
->
‰ìc
 > 0);

461 
	`log_˛õ¡£nd
(&
ßved_˛õ¡
.
‰om
, 
chûd
, 1);

462 
p
 = 
	`£nd_˛õ¡
(
chûd
->
s
, &
ßved_˛õ¡
, 
NULL
, 0);

464 i‡(
p
 == 0) {

465 --
chûd
->
‰ìc
;

466 ++
chûd
->
£¡c
;

467 ++
sockscf
.
°©
.
√gŸüã
.
£ndt
;

469 
	`˛o£
(
ßved_˛õ¡
.
s
);

470 
have_ßved_˛õ¡
 = 0;

473 
	`log_£ndÁûed
(&
ßved_˛õ¡
.
‰om
, saved_˛õ¡.
s
, 
chûd
, 0);

475 i‡(!
	`ERRNOISTMP
(
î∫o
)) {

476 
	`˛o£
(
ßved_˛õ¡
.
s
);

477 
have_ßved_˛õ¡
 = 0;

482 i‡(
have_ßved_ªq
 && 
‰ì_ªqc
 > 0) {

483 
chûd
 = 
	`√xtchûd
(
PROC_REQUEST
, 
SOCKS_TCP
);

485 
	`SASSERTX
(
chûd
 !
NULL
);

486 
	`SASSERTX
(
chûd
->
‰ìc
 > 0);

488 
	`log_˛õ¡£nd
(&
ßved_ªq
.
‰om
, 
chûd
, 1);

490 i‡(
	`£nd_ªq
(
chûd
->
s
, &
ßved_ªq
) == 0) {

491 --
‰ì_ªqc
;

492 --
chûd
->
‰ìc
;

493 ++
chûd
->
£¡c
;

494 ++
sockscf
.
°©
.
ªque°
.
£ndt
;

496 
	`˛o£
(
ßved_ªq
.
s
);

497 
have_ßved_ªq
 = 0;

500 
	`log_£ndÁûed
(&
ßved_ªq
.
‰om
, saved_ªq.
s
, 
chûd
, 0);

502 i‡(!
	`ERRNOISTMP
(
î∫o
)) {

503 
˛õ¡öfo_t
 
cöfo
;

505 i‡(
	`SHMID_ISSET
(
	`CRULE_OR_HRULE
(&
ßved_ªq
))) {

506 
cöfo
.
‰om
 = 
ßved_ªq
.from;

507 
	`HOSTIDCOPY
(&
ßved_ªq
.
°©e
, &
cöfo
);

510 i‡(
	`sockëisc⁄√˘ed
(
ßved_ªq
.
s
, 
NULL
, 0) == NULL) {

511 i‡(
	`CRULE_OR_HRULE
(&
ßved_ªq
)->
m°©s_shmid
 != 0

512 && (
	`CRULE_OR_HRULE
(&
ßved_ªq
)->
Æ¨msc⁄figuªd


513 & 
ALARM_DISCONNECT
))

514 
	`Æ¨m_add_disc⁄√˘
(0,

515 
	`CRULE_OR_HRULE
(&
ßved_ªq
),

516 
ALARM_INTERNAL
,

517 &
cöfo
,

518 
	`°ªº‹
(
î∫o
),

519 
sockscf
.
shmemfd
);

522 #i‡
HAVE_NEGOTIATE_PHASE


523 
	`¸óã_ª•⁄£
(
NULL
,

524 &
ßved_ªq
.
ˇuth
,

525 
ßved_ªq
.
ªq
.
vîsi⁄
,

526 ()
	`î∫o2ª∂y
(
î∫o
,

527 
ßved_ªq
.
ªq
.
vîsi⁄
),

528 &
ª•⁄£
);

530 i‡(
	`£nd_ª•⁄£
(
ßved_ªq
.
s
, &
ª•⁄£
) != 0) {

531 
	`¶og
(
LOG_DEBUG
,

533 
fun˘i⁄
,

534 
ßved_ªq
.
s
,

535 
	`sockaddr2°rög
(&
ßved_ªq
.
‰om
, 
NULL
, 0),

536 
	`°ªº‹
(
î∫o
));

541 i‡(
	`SHMID_ISSET
(
	`CRULE_OR_HRULE
(&
ßved_ªq
)))

542 
	`SHMEM_UNUSE
(
	`CRULE_OR_HRULE
(&
ßved_ªq
),

543 &
cöfo
,

544 
sockscf
.
shmemfd
,

545 
SHMEM_ALL
);

547 
	`˛o£
(
ßved_ªq
.
s
);

548 
have_ßved_ªq
 = 0;

553 i‡(
have_ßved_io
 && 
‰ì_ioc
 > 0) {

554 
chûd
 = 
	`√xtchûd
(
PROC_IO
, 
ßved_io
.
°©e
.
¥Ÿocﬁ
);

555 
	`SASSERTX
(
chûd
 !
NULL
);

556 
	`SASSERTX
(
chûd
->
‰ìc
 > 0);

558 #i‡
BAREFOOTD


559 i‡(
ßved_io
.
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
)

560 
	`SASSERTX
(
chûd
->
hasudp£ssi⁄
 == 0);

563 
	`log_˛õ¡£nd
(&
	`INTERNALIO
(&
ßved_io
)->
øddr
, 
chûd
, 1);

564 i‡(
	`£nd_io
(
chûd
->
s
, &
ßved_io
) == 0) {

565 #i‡
BAREFOOTD


566 i‡(
ßved_io
.
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
) {

567 
	`SASSERTX
(
chûd
->
hasudp£ssi⁄
 == 0);

568 ++
chûd
->
hasudp£ssi⁄
;

570 
	`¶og
(
LOG_DEBUG
,

572 
	`sockaddr2°rög
(&
ßved_io
.
§c
.
œddr
, 
NULL
, 0),

573 
	`chûdty≥2°rög
(
chûd
->
ty≥
),

574 ()
chûd
->
pid
);

578 --
‰ì_ioc
;

579 --
chûd
->
‰ìc
;

580 ++
chûd
->
£¡c
;

581 ++
sockscf
.
°©
.
io
.
£ndt
;

583 
	`˛o£_iodes¸ùt‹s
(&
ßved_io
);

584 
have_ßved_io
 = 0;

587 
	`log_£ndÁûed
(&
	`CONTROLIO
(&
ßved_io
)->
øddr
,

588 
	`CONTROLIO
(&
ßved_io
)->
s
,

589 
chûd
,

592 i‡(!
	`ERRNOISTMP
(
î∫o
)) {

593 
˛õ¡öfo_t
 
cöfo
;

595 i‡(
	`SHMID_ISSET
(&
ßved_io
.
§uÀ
)) {

596 
cöfo
.
‰om
 = 
	`CONTROLIO
(&
ßved_io
)->
øddr
;

597 
	`HOSTIDCOPY
(&
ßved_io
.
°©e
, &
cöfo
);

600 i‡(
	`sockëisc⁄√˘ed
(
	`CONTROLIO
(&
ßved_io
)->
s
, 
NULL
, 0) == NULL){

601 i‡(
ßved_io
.
§uÀ
.
m°©s_shmid
 != 0

602 && (
ßved_io
.
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

603 
	`Æ¨m_add_disc⁄√˘
(0,

604 &
ßved_io
.
§uÀ
,

605 
ALARM_INTERNAL
,

606 &
cöfo
,

607 
	`°ªº‹
(
î∫o
),

608 
sockscf
.
shmemfd
);

611 i‡(
ßved_io
.
°©e
.
comm™d
 !
SOCKS_UDPASSOCIATE


612 && 
ßved_io
.
d°
.
s
 != -1

613 && !
	`sockëisc⁄√˘ed
(
ßved_io
.
d°
.
s
, 
NULL
, 0)) {

614 i‡(
ßved_io
.
§uÀ
.
m°©s_shmid
 != 0

615 && (
ßved_io
.
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

616 
	`Æ¨m_add_disc⁄√˘
(0,

617 &
ßved_io
.
§uÀ
,

618 
ALARM_EXTERNAL
,

619 &
cöfo
,

620 
	`°ªº‹
(
î∫o
),

621 
sockscf
.
shmemfd
);

624 #i‡
HAVE_NEGOTIATE_PHASE


625 
	`¸óã_ª•⁄£
(
NULL
,

626 &
ßved_io
.
§c
.
auth
,

627 
ßved_io
.
°©e
.
¥oxy¥Ÿocﬁ
,

628 ()
	`î∫o2ª∂y
(
î∫o
,

629 
ßved_io
.
°©e
.
¥oxy¥Ÿocﬁ
),

630 &
ª•⁄£
);

632 i‡(
	`£nd_ª•⁄£
(
	`CONTROLIO
(&
ßved_io
)->
s
, &
ª•⁄£
) != 0) {

633 
	`¶og
(
LOG_DEBUG
,

635 
fun˘i⁄
,

636 
	`CONTROLIO
(&
ßved_io
)->
s
,

637 
	`socksho°2°rög
(&
	`CONTROLIO
(&
ßved_io
)->
ho°
,

638 
NULL
,

640 
	`°ªº‹
(
î∫o
));

645 i‡(
	`SHMID_ISSET
(&
ßved_io
.
§uÀ
))

646 
	`SHMEM_UNUSE
(&
ßved_io
.
§uÀ
,

647 &
cöfo
,

648 
sockscf
.
shmemfd
,

649 
SHMEM_ALL
);

651 
	`˛o£_iodes¸ùt‹s
(&
ßved_io
);

652 
have_ßved_io
 = 0;

665 
	#HAVE_FREE_SLOTS
(Ë((
‰ì_√gc
 > 0Ë|| (
‰ì_ªqc
 > 0Ë|| (
‰ì_ioc
 > 0))

	)

667 
	`HAVE_FREE_SLOTS
(Ë&& (
chûd
 = 
	`gë£t
(
DATAPIPE
, 
r£t
)Ë!
NULL
) {

674 c⁄° 
sockd_chûd_t
 
‰omchûd
 = *
chûd
;

675 
comm™d
;

676 
chûdhasföished
;

678 i‡(
	`sockd_h™dÀdsig«ls
())

682 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

683 
	`¶og
(
LOG_DEBUG
,

685 ()
‰ì_√gc
,

686 ()
‰ì_ªqc
,

687 ()
‰ì_ioc
,

688 
	`chûdty≥2°rög
(
‰omchûd
.
ty≥
),

689 ()
‰omchûd
.
pid
);

691 
	`˛ór£t
(
DATAPIPE
, &
‰omchûd
, 
r£t
);

692 
î∫o
 = 0;

694 
‰omchûd
.
ty≥
) {

701 
PROC_NEGOTIATE
: {

702 
sockd_ªque°_t
 
ªq
;

704 i‡(
‰ì_ªqc
 <= 0) {

705 
	`˛órchûdty≥
(
‰omchûd
.
ty≥
, 
DATAPIPE
, 
rbôs
, 
r£t
);

709 i‡(
have_ßved_ªq
) {

710 
	`log_no˛õ¡ªcv
(&
‰omchûd
);

714 i‡((
chûd
 = 
	`√xtchûd
(
PROC_REQUEST
, 
SOCKS_TCP
)Ë=
NULL
) {

715 
	`¶og
(
LOG_DEBUG
, "noÑequest slotávailable forÇew client");

716 
‰ì_ªqc
 = 0;

720 
	`SASSERTX
(
chûd
->
‰ìc
 > 0);

722 
	`¶og
(
LOG_DEBUG
, "tryingÅoÑeceiveÑequest from %s %ld",

723 
	`chûdty≥2°rög
(
‰omchûd
.
ty≥
), ()‰omchûd.
pid
);

725 i‡((
p
 = 
	`ªcv_ªq
(
‰omchûd
.
s
, &
ªq
)) != 0) {

726 
	`¶og
(
LOG_DEBUG
, "recv_req() on fd %d failed with %ld: %s",

727 
‰omchûd
.
s
, ()
p
, 
	`°ªº‹
(
î∫o
));

732 ++
sockscf
.
°©
.
√gŸüã
.
ª˚ived
;

733 
comm™d
 = 
ªq
.
ªqöfo
.command;

735 
	`log_˛õ¡£nd
(&
ªq
.
‰om
, 
chûd
, 0);

737 i‡(
	`£nd_ªq
(
chûd
->
s
, &
ªq
) == 0) {

738 --
‰ì_ªqc
;

739 --
chûd
->
‰ìc
;

740 ++
chûd
->
£¡c
;

741 ++
sockscf
.
°©
.
ªque°
.
£ndt
;

743 
	`˛o£
(
ªq
.
s
);

747 
	`log_£ndÁûed
(&
ªq
.
‰om
,Ñeq.
s
, 
chûd
, 1);

749 i‡(
	`ERRNOISTMP
(
î∫o
)) {

750 
ßved_ªq
 = 
ªq
;

751 
have_ßved_ªq
 = 1;

754 
˛õ¡öfo_t
 
cöfo
;

756 i‡(
	`SHMID_ISSET
(
	`CRULE_OR_HRULE
(&
ªq
))) {

757 
cöfo
.
‰om
 = 
ªq
.from;

758 
	`HOSTIDCOPY
(&
ªq
.
°©e
, &
cöfo
);

761 i‡(!
	`sockëisc⁄√˘ed
(
ªq
.
s
, 
NULL
, 0)) {

762 i‡(
	`CRULE_OR_HRULE
(&
ßved_ªq
)->
m°©s_shmid
 != 0

763 && (
	`CRULE_OR_HRULE
(&
ßved_ªq
)->
Æ¨msc⁄figuªd


764 & 
ALARM_DISCONNECT
))

765 
	`Æ¨m_add_disc⁄√˘
(0,

766 
	`CRULE_OR_HRULE
(&
ªq
),

767 
ALARM_INTERNAL
,

768 &
cöfo
,

769 
	`°ªº‹
(
î∫o
),

770 
sockscf
.
shmemfd
);

773 #i‡
HAVE_NEGOTIATE_PHASE


774 
	`¸óã_ª•⁄£
(
NULL
,

775 &
ªq
.
ˇuth
,

776 
ªq
.ªq.
vîsi⁄
,

777 
	`î∫o2ª∂y
(
î∫o
, 
ªq
.ªq.
vîsi⁄
),

778 &
ª•⁄£
);

780 i‡(
	`£nd_ª•⁄£
(
ªq
.
s
, &
ª•⁄£
) != 0) {

781 
	`¶og
(
LOG_DEBUG
,

783 
fun˘i⁄
,

784 
ªq
.
s
,

785 
	`sockaddr2°rög
(&
ªq
.
‰om
, 
NULL
, 0),

786 
	`°ªº‹
(
î∫o
));

791 
	`˛o£
(
ªq
.
s
);

793 i‡(
	`SHMID_ISSET
(
	`CRULE_OR_HRULE
(&
ªq
)))

794 
	`SHMEM_UNUSE
(
	`CRULE_OR_HRULE
(&
ªq
),

795 &
cöfo
,

796 
sockscf
.
shmemfd
,

797 
SHMEM_ALL
);

803 
PROC_REQUEST
: {

804 
sockd_io_t
 
io
;

805 
pid_t
 
pid_t˝
, 
pid_udp
;

807 i‡(
‰ì_ioc
 <= 0) {

808 
	`˛órchûdty≥
(
‰omchûd
.
ty≥
, 
DATAPIPE
, 
rbôs
, 
r£t
);

812 i‡(
have_ßved_io
) {

813 
	`log_no˛õ¡ªcv
(&
‰omchûd
);

817 i‡((
chûd
 = 
	`√xtchûd
(
PROC_IO
, 
SOCKS_TCP
)Ë=
NULL
) {

818 
	`¶og
(
LOG_DEBUG
, "noÅcp io slotávailable forÇew client");

819 
‰ì_ioc
 = 0;

823 
pid_t˝
 = 
chûd
->
pid
;

825 #i‡
BAREFOOTD


832 i‡((
chûd
 = 
	`√xtchûd
(
PROC_IO
, 
SOCKS_UDP
)Ë=
NULL
) {

833 
	`¶og
(
LOG_DEBUG
, "no udp io slotávailable forÇew client");

834 
‰ì_ioc
 = 0;

838 
	`SASSERTX
(
chûd
->
hasudp£ssi⁄
 == 0);

840 
pid_udp
 = 
chûd
->
pid
;

844 
pid_udp
 = 
pid_t˝
;

847 
	`¶og
(
LOG_DEBUG
, "tryingÅoÑeceiveÑequest from %s %ld",

848 
	`chûdty≥2°rög
(
‰omchûd
.
ty≥
), ()‰omchûd.
pid
);

850 i‡((
p
 = 
	`ªcv_io
(
‰omchûd
.
s
, &
io
)) != 0) {

851 
	`¶og
(
LOG_DEBUG
, "recv_io() on fd %d failed with %ld: %s",

852 
‰omchûd
.
s
, ()
p
, 
	`°ªº‹
(
î∫o
));

857 ++
sockscf
.
°©
.
ªque°
.
ª˚ived
;

858 
comm™d
 = 
io
.
ªqöfo
.command;

860 
io
.
°©e
.
¥Ÿocﬁ
) {

861 
SOCKS_TCP
:

862 
chûd
 = 
	`gëchûd
(
pid_t˝
);

865 
SOCKS_UDP
:

866 
chûd
 = 
	`gëchûd
(
pid_udp
);

870 
	`SWARNX
(
io
.
°©e
.
¥Ÿocﬁ
);

874 
	`SASSERTX
(
chûd
 !
NULL
);

875 
	`SASSERTX
(
chûd
->
‰ìc
 > 0);

877 
	`log_˛õ¡£nd
(&
	`CONTROLIO
(&
io
)->
øddr
, 
chûd
, 0);

878 i‡(
	`£nd_io
(
chûd
->
s
, &
io
) == 0) {

879 --
‰ì_ioc
;

880 --
chûd
->
‰ìc
;

881 ++
chûd
->
£¡c
;

882 ++
sockscf
.
°©
.
io
.
£ndt
;

884 
	`SASSERTX
(
chûd
->
‰ìc
 < 
	`max‰ì¶Ÿs
(chûd->
ty≥
));

885 
	`˛o£_iodes¸ùt‹s
(&
io
);

886 #i‡
BAREFOOTD


887 i‡(
io
.
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
) {

888 
	`SASSERTX
(
chûd
->
hasudp£ssi⁄
 == 0);

889 ++
chûd
->
hasudp£ssi⁄
;

891 
	`¶og
(
LOG_DEBUG
,

893 
	`sockaddr2°rög
(&
io
.
§c
.
œddr
, 
NULL
, 0),

894 
	`chûdty≥2°rög
(
chûd
->
ty≥
),

895 ()
chûd
->
pid
);

902 
	`log_£ndÁûed
(&
	`CONTROLIO
(&
io
)->
øddr
,

903 
	`CONTROLIO
(&
io
)->
s
,

904 
chûd
,

907 i‡(
	`ERRNOISTMP
(
î∫o
)) {

908 
ßved_io
 = 
io
;

909 
have_ßved_io
 = 1;

912 
˛õ¡öfo_t
 
cöfo
;

913 i‡(
	`SHMID_ISSET
(&
io
.
§uÀ
)) {

914 
cöfo
.
‰om
 = 
	`CONTROLIO
(&
io
)->
øddr
;

915 
	`HOSTIDCOPY
(&
io
.
°©e
, &
cöfo
);

918 i‡(
	`sockëisc⁄√˘ed
(
	`CONTROLIO
(&
io
)->
s
, 
NULL
, 0) == NULL) {

919 i‡(
io
.
§uÀ
.
m°©s_shmid
 != 0

920 && (
io
.
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

921 
	`Æ¨m_add_disc⁄√˘
(0,

922 &
io
.
§uÀ
,

923 
ALARM_INTERNAL
,

924 &
cöfo
,

925 
	`°ªº‹
(
î∫o
),

926 
sockscf
.
shmemfd
);

929 i‡(
io
.
°©e
.
comm™d
 !
SOCKS_UDPASSOCIATE


930 && 
io
.
d°
.
s
 != -1

931 && !
	`sockëisc⁄√˘ed
(
io
.
d°
.
s
, 
NULL
, 0) != 0) {

932 i‡(
io
.
§uÀ
.
m°©s_shmid
 != 0

933 && (
io
.
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

934 
	`Æ¨m_add_disc⁄√˘
(0,

935 &
io
.
§uÀ
,

936 
ALARM_EXTERNAL
,

937 &
cöfo
,

938 
	`°ªº‹
(
î∫o
),

939 
sockscf
.
shmemfd
);

942 #i‡
HAVE_NEGOTIATE_PHASE


943 
	`¸óã_ª•⁄£
(
NULL
,

944 &
io
.
§c
.
auth
,

945 
io
.
°©e
.
¥oxy¥Ÿocﬁ
,

946 ()
	`î∫o2ª∂y
(
î∫o
,

947 
io
.
°©e
.
¥oxy¥Ÿocﬁ
),

948 &
ª•⁄£
);

950 i‡(
	`£nd_ª•⁄£
(
	`CONTROLIO
(&
io
)->
s
, &
ª•⁄£
) != 0) {

951 
	`¶og
(
LOG_DEBUG
,

953 
fun˘i⁄
,

954 
	`CONTROLIO
(&
io
)->
s
,

955 
	`socksho°2°rög
(&
io
.
§c
.
ho°
, 
NULL
, 0),

956 
	`°ªº‹
(
î∫o
));

961 
	`˛o£_iodes¸ùt‹s
(&
io
);

963 i‡(
	`SHMID_ISSET
(&
io
.
§uÀ
))

964 
	`SHMEM_UNUSE
(&
io
.
§uÀ
, &
cöfo
, 
sockscf
.
shmemfd
, 
SHMEM_ALL
);

970 
PROC_IO
: {

971 #i‡
COVENANT


972 
sockd_˛õ¡_t
 
˛õ¡
;

974 i‡(
‰ì_√gc
 <= 0) {

975 
	`˛órchûdty≥
(
‰omchûd
.
ty≥
, 
DATAPIPE
, 
rbôs
, 
r£t
);

979 i‡(
have_ßved_˛õ¡
) {

980 
	`log_no˛õ¡ªcv
(&
‰omchûd
);

984 i‡((
chûd
 = 
	`√xtchûd
(
PROC_NEGOTIATE
, 
SOCKS_TCP
)Ë=
NULL
) {

985 
	`¶og
(
LOG_DEBUG
, "no %sávailableÅoáccept old client",

986 
	`chûdty≥2°rög
(
‰omchûd
.
ty≥
));

991 
	`SASSERTX
(
chûd
->
‰ìc
 > 0);

993 
	`¶og
(
LOG_DEBUG
, "tryingÅoÑeceiveÑequest from %s %ld",

994 
	`chûdty≥2°rög
(
‰omchûd
.
ty≥
),

995 ()
‰omchûd
.
pid
);

997 i‡((
p
 = 
	`ªcv_ª£¡˛õ¡
(
‰omchûd
.
s
, &
˛õ¡
)) != 0) {

998 
	`¶og
(
LOG_DEBUG
,

1000 
‰omchûd
.
s
, ()
p
, 
	`°ªº‹
(
î∫o
));

1005 ++
sockscf
.
°©
.
io
.
ª˚ived
;

1006 
comm™d
 = 
˛õ¡
.
ªqöfo
.command;

1008 
	`log_˛õ¡£nd
(&
˛õ¡
.
‰om
, 
chûd
, 0);

1009 
p
 = 
	`£nd_˛õ¡
(
chûd
->
s
, &
˛õ¡
, 
NULL
, 0);

1011 i‡(
p
 == 0) {

1012 --
chûd
->
‰ìc
;

1013 ++
chûd
->
£¡c
;

1014 ++
sockscf
.
°©
.
√gŸüã
.
£ndt
;

1016 
	`˛o£
(
˛õ¡
.
s
);

1020 
	`log_£ndÁûed
(&
˛õ¡
.
‰om
, clõ¡.
s
, 
chûd
, 1);

1022 i‡(
	`ERRNOISTMP
(
î∫o
)) {

1023 
ßved_˛õ¡
 = 
˛õ¡
;

1024 
have_ßved_˛õ¡
 = 1;

1033 i‡(
	`sockëisc⁄√˘ed
(
˛õ¡
.
s
, 
NULL
, 0) != NULL) {

1034 #i‡
HAVE_NEGOTIATE_PHASE


1036 
	`¸óã_ª•⁄£
(
NULL
,

1037 &
˛õ¡
.
auth
,

1038 
˛õ¡
.
ªque°
.
vîsi⁄
,

1039 
	`î∫o2ª∂y
(
î∫o
, 
˛õ¡
.
ªque°
.
vîsi⁄
),

1040 &
ª•⁄£
);

1042 i‡(
	`£nd_ª•⁄£
(
˛õ¡
.
s
, &
ª•⁄£
) != 0) {

1043 
	`¶og
(
LOG_DEBUG
,

1045 
fun˘i⁄
,

1046 
˛õ¡
.
s
,

1047 
	`socksho°2°rög
(&
˛õ¡
.
ªque°
.
ho°
, 
NULL
, 0),

1048 
	`°ªº‹
(
î∫o
));

1053 
	`˛o£
(
˛õ¡
.
s
);

1061 
	`SERRX
(
‰omchûd
.
ty≥
);

1064 
	`h™dÀchûdcomm™d
(
comm™d
,

1065 
	`gëchûd
(
‰omchûd
.
pid
),

1066 &
chûdhasföished
);

1068 i‡(
chûdhasföished
)

1069 
	`˛o£chûd
(
‰omchûd
.
pid
, 1);

1075 
i
 = 0; i < 
sockscf
.
öã∫Æ
.
addrc
 && !
have_ßved_˛õ¡
; ++i) {

1076 
a°r
[
MAXSOCKADDRSTRING
];

1077 
sockd_˛õ¡_t
 
˛õ¡
;

1079 i‡(
	`sockd_h™dÀdsig«ls
())

1082 #i‡
BAREFOOTD


1083 i‡(
sockscf
.
öã∫Æ
.
addrv
[
i
].
¥Ÿocﬁ
 !
SOCKS_TCP
)

1088 
	`bzîo
(&
˛õ¡
, (client));

1090 i‡(
	`FD_ISSET
(
sockscf
.
öã∫Æ
.
addrv
[
i
].
s
, 
r£t
)) {

1097 
sockÀn_t
 
Àn
;

1098 
nom‹e˛õ¡s
 = 0;

1100 
Àn
 = (
˛õ¡
.
‰om
);

1102 
˛õ¡
.
s
 = 
	`ac˚±n
(
sockscf
.
öã∫Æ
.
addrv
[
i
].s,

1103 &
˛õ¡
.
‰om
,

1104 &
Àn
);

1106 
˛õ¡
.
to
 = 
sockscf
.
öã∫Æ
.
addrv
[
i
].
addr
;

1108 i‡(
˛õ¡
.
s
 == -1) {

1109 
î∫o
) {

1110 #ifde‡
EPROTO


1111 
EPROTO
:

1113 
EWOULDBLOCK
:

1114 
ENOBUFS
:

1115 
ECONNABORTED
:

1117 
ECONNRESET
:

1118 #ifde‡
ETIMEDOUT


1119 
ETIMEDOUT
:

1121 
EHOSTUNREACH
:

1122 
ENETUNREACH
:

1123 
ENETDOWN
:

1124 
EPERM
:

1125 i‡(
	`ERRNOISTMP
(
î∫o
))

1126 
nom‹e˛õ¡s
 = 1;

1128 
	`¶og
(
LOG_DEBUG
, "accept(2) ofÇew client failed: %s",

1129 
	`°ªº‹
(
î∫o
));

1131 
ENFILE
:

1132 
EMFILE
:

1133 
	`sw¨n
("couldÇotácceptÇew client");

1136 
EBADF
:

1137 
EFAULT
:

1138 
EINVAL
:

1140 
	`SERRX
(
î∫o
);

1143 i‡(
	`ERRNOISTMP
(
î∫o
)) {

1144 
nom‹e˛õ¡s
 = 1;

1148 
	`SWARN
(
˛õ¡
.
s
);

1151 i‡(
nom‹e˛õ¡s
)

1157 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
˛õ¡
.
ac˚±ed
);

1158 ++
sockscf
.
°©
.
ac˚±ed
;

1160 
uuid
=0;

1161 
rc
 = -1;

1162 
Ø
=();

1163 
	#MPTCP_AUTH_UUID
 29

	)

1164 
rc
 = 
	`gësock›t
(
˛õ¡
.
s
, 
IPPROTO_TCP
, 
MPTCP_AUTH_UUID
, &
uuid
, &
Ø
);

1165 
	`¶og
(
LOG_ALARM
, "########acceptedÅcp client %s onáddress %s, fd=%d, uuid=%x,Ñc=%d\n",

1166 
	`sockaddr2°rög
(&
˛õ¡
.
‰om
, 
a°r
, (astr)),

1167 
	`sockaddr2°rög
(&
sockscf
.
öã∫Æ
.
addrv
[
i
].
addr
, 
NULL
, 0),

1168 
sockscf
.
öã∫Æ
.
addrv
[
i
].
s
,

1169 
uuid
, 
rc
);

1171 
m⁄ô‹_t
 *
m⁄ô‹
 = 
sockscf
.monitor;

1172 
m⁄ô‹_°©s_t
 *
m°©s
;

1174 
ruÀ_t
 
ruÀ
;

1175 
	`bzîo
(&
ruÀ
, (rule));

1176 
	`COPY_MONITORFIELDS
(
m⁄ô‹
, &
ruÀ
);

1177 
	`sockd_shm©
(&
ruÀ
, 
SHMEM_MONITOR
);

1178 
	`COPY_MONITORFIELDS
(&
ruÀ
, 
m⁄ô‹
);

1180 i‡(
m⁄ô‹
->
m°©s_shmid
 != 0) {

1181 
	`SASSERTX
(
m⁄ô‹
->
m°©s
 !
NULL
);

1182 
m°©s
 = &
m⁄ô‹
->m°©s->
obje˘
.monitor;

1183 
j
;

1185 
uöt32_t
 
u£r_˙t
 = 
m°©s
->
u£r_öfo
.user_cnt;

1186 
j
 = 0; j < 
u£r_˙t
; j++) {

1187 if(
m°©s
->
u£r_öfo
.
Æ¨m
[
j
].
uid
 =
uuid
)

1191 
m°©s
->
u£r_öfo
.
Æ¨m
[
j
].
uid
 = 
uuid
;

1192 
m°©s
->
u£r_öfo
.
Æ¨m
[
j
].
£ss_˙t
 += 1;

1193 i‡(
j
 =
u£r_˙t
) {

1194 
m°©s
->
u£r_öfo
.
u£r_˙t
 += 1;

1197 
	`¶og
(
LOG_ALARM
, "ac˚±:######## u£r_˙t=%d, uid=%x,%d\n", 
u£r_˙t
, 
uuid
, uuid);

1200 
	`sockd_shmdt
(&
ruÀ
, 
SHMEM_MONITOR
);

1201 
	`COPY_MONITORFIELDS
(&
ruÀ
, 
m⁄ô‹
);

1203 i‡((
chûd
 = 
	`√xtchûd
(
PROC_NEGOTIATE
, 
SOCKS_TCP
)Ë=
NULL
) {

1204 
	`log_˛õ¡dr›≥d
(&
˛õ¡
.
‰om
);

1206 
	`˛o£
(
˛õ¡
.
s
);

1209 
	`log_˛õ¡£nd
(&
˛õ¡
.
‰om
, 
chûd
, 0);

1211 
p
 = 
	`£nd_˛õ¡
(
chûd
->
s
, &
˛õ¡
, 
NULL
, 0);

1213 i‡(
p
 == 0) {

1214 --
‰ì_√gc
;

1215 --
chûd
->
‰ìc
;

1216 ++
chûd
->
£¡c
;

1217 ++
sockscf
.
°©
.
√gŸüã
.
£ndt
;

1219 
	`˛o£
(
˛õ¡
.
s
);

1222 
	`log_£ndÁûed
(&
˛õ¡
.
‰om
, clõ¡.
s
, 
chûd
, 1);

1224 i‡(
	`ERRNOISTMP
(
î∫o
)) {

1225 
ßved_˛õ¡
 = 
˛õ¡
;

1226 
have_ßved_˛õ¡
 = 1;

1229 
	`˛o£
(
˛õ¡
.
s
);

1239 
	}
}

1244 
	$ußge
(
code
)

1245 
code
;

1248 ()
	`Ârötf
(
code
 =0 ? 
°dout
 : 
°dîr
,

1261 
PRODUCT
,

1262 
VERSION
,

1263 
__¥og«me
,

1264 
SOCKD_CONFIGFILE
,

1265 
SOCKD_PIDFILE
);

1267 
	`exô
(
code
);

1268 
	}
}

1271 c⁄° 
li˚n£key_t
 
moduÀ_ªdúe˘_keyv
[];

1272 c⁄° 
size_t
 
moduÀ_ªdúe˘_keyc
;

1273 c⁄° 
moduÀ_ªdúe˘_vîsi⁄
[];

1275 c⁄° 
li˚n£key_t
 
moduÀ_b™dwidth_keyv
[];

1276 c⁄° 
size_t
 
moduÀ_b™dwidth_keyc
;

1277 c⁄° 
moduÀ_b™dwidth_vîsi⁄
[];

1279 #i‡
HAVE_LDAP


1280 c⁄° 
li˚n£key_t
 
moduÀ_ld≠_keyv
[];

1281 c⁄° 
size_t
 
moduÀ_ld≠_keyc
;

1282 c⁄° 
moduÀ_ld≠_vîsi⁄
[];

1286 
	$showvîsi⁄
(
Àvñ
)

1287 c⁄° 
Àvñ
;

1290 c⁄° *
«me
;

1292 c⁄° 
li˚n£key_t
 *
keyv
;

1293 c⁄° 
size_t
 
keyc
;

1294 } 
li˚n£öfov
[] = {

1296 
moduÀ_b™dwidth_keyv
,

1297 
moduÀ_b™dwidth_keyc


1300 #i‡
HAVE_LDAP


1302 
moduÀ_ld≠_keyv
,

1303 
moduÀ_ld≠_keyc


1308 
moduÀ_ªdúe˘_keyv
,

1309 
moduÀ_ªdúe˘_keyc


1312 c⁄° 
size_t
 
li˚n£öfoc
 = 
	`ELEMENTS
(
li˚n£öfov
);

1314 
size_t
 
i
;

1316 
	`¥ötf
("%s v%s. Copyright (c) 1997 - 2014 Inferno Nettverk A/S, Norway\n",

1317 
PRODUCT
, 
VERSION
);

1319 
i
 = 0; i < 
li˚n£öfoc
; ++i) {

1320 i‡(
li˚n£öfov
[
i
].
keyc
 > 0) {

1321 
size_t
 
keyc
;

1323 
	`¥ötf
("%luáddress%sÜicensed forÅhe %s %s module:\n",

1324 ()
li˚n£öfov
[
i
].
keyc
,

1325 ()
li˚n£öfov
[
i
].
keyc
 == 1 ? "" : "es",

1326 
PRODUCT
,

1327 
li˚n£öfov
[
i
].
«me
);

1329 
keyc
 = 0; key¯< 
li˚n£öfov
[
i
].keyc; ++keyc)

1330 
	`¥ötf
("address #%-5lu: %s\n",

1331 ()(
keyc
 + 1),

1332 
	`li˚n£key2°rög
(&
li˚n£öfov
[
i
].
keyv
[
keyc
]));

1336 i‡(
Àvñ
 > 1) {

1337 i‡(
	`°æí
(
DANTE_BUILD
) > 0)

1338 
	`¥ötf
("buûd: %s\n", 
DANTE_BUILD
);

1340 i‡(
	`°æí
(
DANTE_SOCKOPTS_SO
) > 0)

1341 
	`¥ötf
("sockë o±i⁄†(sockëÜevñ): %s\n", 
DANTE_SOCKOPTS_SO
);

1343 i‡(
	`°æí
(
DANTE_SOCKOPTS_IPV4
) > 0)

1344 
	`¥ötf
("sockë o±i⁄†(ùv4Üevñ): %s\n", 
DANTE_SOCKOPTS_IPV4
);

1346 i‡(
	`°æí
(
DANTE_SOCKOPTS_IPV6
) > 0)

1347 
	`¥ötf
("sockë o±i⁄†(ùv6Üevñ): %s\n", 
DANTE_SOCKOPTS_IPV6
);

1349 i‡(
	`°æí
(
DANTE_SOCKOPTS_TCP
) > 0)

1350 
	`¥ötf
("sockë o±i⁄†—˝Üevñ): %s\n", 
DANTE_SOCKOPTS_TCP
);

1352 i‡(
	`°æí
(
DANTE_SOCKOPTS_UDP
) > 0)

1353 
	`¥ötf
("sockë o±i⁄†(ud∞Àvñ): %s\n", 
DANTE_SOCKOPTS_UDP
);

1355 i‡(
	`°æí
(
DANTE_COMPATFILES
) > 0)

1356 
	`¥ötf
("com∑t: %s\n", 
DANTE_COMPATFILES
);

1358 
	}
}

1361 
	$showli˚n£
()

1364 
	`¥ötf
("%s: %†v%s\n%s\n", 
__¥og«me
, 
PRODUCT
, 
VERSION
,

1410 
	`exô
(
EXIT_SUCCESS
);

1411 
	}
}

1414 
	$£rvîöô
(
¨gc
, 
¨gv
)

1415 
¨gc
;

1416 *
¨gv
[];

1418 c⁄° *
fun˘i⁄
 = "serverinit()";

1419 
ch
;

1421 #i‡!
HAVE_PROGNAME


1422 i‡(
¨gv
[0] !
NULL
) {

1423 i‡((
__¥og«me
 = 
	`°ºchr
(
¨gv
[0], '/')Ë=
NULL
)

1424 
__¥og«me
 = 
¨gv
[0];

1426 ++
__¥og«me
;

1430 #i‡!
HAVE_PRIVILEGES


1431 
sockscf
.
°©e
.
euid
 = sockscf.
öôül
.euid = 
	`gëeuid
();

1432 
sockscf
.
°©e
.
egid
 = sockscf.
öôül
.egid = 
	`gëegid
();

1435 
sockscf
.
°©e
.
ty≥
 = 
PROC_MOTHER
;

1436 
sockscf
.
›ti⁄
.
£rvîc
 = 1;

1438 i‡((
sockscf
.
°©e
.
∑gesize
 = 
	`sysc⁄f
(
_SC_PAGESIZE
)) == -1)

1439 
	`£º
("%s: couldÇŸ gëÅhê∑gesizêvü sysc⁄f(SC_PAGESIZE)", 
fun˘i⁄
);

1441 
sockscf
.
ho°fd
 = -1;

1442 
sockscf
.
loglock
 = -1;

1443 
sockscf
.
shmemc⁄figfd
 = -1;

1444 
sockscf
.
shmemfd
 = -1;

1446 (
ch
 = 
	`gë›t
(
¨gc
, 
¨gv
, "DLN:Vd:f:hnp:v")) != -1) {

1447 
ch
) {

1449 
sockscf
.
›ti⁄
.
d´m⁄
 = 1;

1453 
	`showli˚n£
();

1457 *
íd±r
;

1459 i‡((
sockscf
.
›ti⁄
.
£rvîc
 = ()
	`°πﬁ
(
›èrg
, &
íd±r
, 10)) < 1

1460 || *
íd±r
 !
NUL
)

1461 
	`£º
("%s: illegal value for -%c option: %s. "

1463 
fun˘i⁄
, 
ch
, 
›èrg
);

1469 
sockscf
.
›ti⁄
.
vîify⁄ly
 = 1;

1473 *
íd±r
;

1475 i‡((
sockscf
.
›ti⁄
.
debug
 = ()
	`°πﬁ
(
›èrg
, &
íd±r
, 10)) < 0

1476 || *
íd±r
 !
NUL
)

1477 
	`£º
("%s: illegal value for -%c option: %s. "

1479 
fun˘i⁄
, 
ch
, 
›èrg
);

1481 
sockscf
.
›ti⁄
.
debug_is£t
 = 1;

1486 
sockscf
.
›ti⁄
.
c⁄figfûe
 = 
›èrg
;

1490 
	`ußge
(0);

1494 
sockscf
.
›ti⁄
.
kì∑live
 = 0;

1498 
sockscf
.
›ti⁄
.
pidfûe
 = 
›èrg
;

1502 ++
sockscf
.
›ti⁄
.
vîsi⁄⁄ly
;

1506 
	`ußge
(1);

1514 
sockscf
.
öôül
.
cmdlöe
 = sockscf.
›ti⁄
;

1516 
¨gc
 -
›töd
;

1517 
¨gv
 +
›töd
;

1519 i‡(
sockscf
.
›ti⁄
.
vîsi⁄⁄ly
) {

1520 
	`showvîsi⁄
(
sockscf
.
›ti⁄
.
vîsi⁄⁄ly
);

1521 
	`exô
(
EXIT_SUCCESS
);

1524 i‡((
sockscf
.
°©e
.
mŸhîpidv
 = 
	`mÆloc
((*sockscf.state.motherpidv)

1525 * 
sockscf
.
›ti⁄
.
£rvîc
)Ë=
NULL
)

1526 
	`£ºx
("%s", 
NOMEM
);

1528 
	`bzîo
(
sockscf
.
°©e
.
mŸhîpidv
, (*sockscf.state.motherpidv)

1529 * 
sockscf
.
›ti⁄
.
£rvîc
);

1532 *
sockscf
.
°©e
.
mŸhîpidv
 = sockscf.°©e.
pid
 = 
	`gëpid
();

1534 i‡(
¨gc
 > 0)

1535 
	`£ºx
("%s: unknow¿¨gumíà%s", 
fun˘i⁄
, *
¨gv
);

1537 i‡(
sockscf
.
›ti⁄
.
c⁄figfûe
 =
NULL
)

1538 
sockscf
.
›ti⁄
.
c⁄figfûe
 = 
SOCKD_CONFIGFILE
;

1540 i‡(
sockscf
.
›ti⁄
.
pidfûe
 =
NULL
)

1541 
sockscf
.
›ti⁄
.
pidfûe
 = 
SOCKD_PIDFILE
;

1543 #i‡
HAVE_LIBWRAP


1548 
sockscf
.
ho°s_Ælow_‹igöÆ
 = 
ho°s_Ælow_èbÀ
;

1549 
sockscf
.
ho°s_díy_‹igöÆ
 = 
ho°s_díy_èbÀ
;

1552 #i‡
HAVE_SCHED_SETSCHEDULER


1553 i‡((
sockscf
.
öôül
.
˝u
.
pﬁicy
 = 
	`sched_gëscheduÀr
(0)) == -1)

1554 
	`£º
("%s: sched_getscheduler(2): failedÅoÑetrieve current cpu"

1556 
fun˘i⁄
);

1558 i‡(
	`sched_gë∑øm
(0, &
sockscf
.
öôül
.
˝u
.
∑øm
) != 0)

1559 
	`£º
("%s: sched_getparam(2): failedÅoÑetrieve current cpu scheduling "

1561 
fun˘i⁄
);

1563 
sockscf
.
öôül
.
˝u
.
schedulög_is£t
 = 1;

1564 
sockscf
.
°©e
.
˝u
 = sockscf.
öôül
.cpu;

1567 #i‡
HAVE_SCHED_SETAFFINITY


1568 i‡(
	`˝u_gëafföôy
(0,

1569 (
sockscf
.
öôül
.
˝u
.
mask
),

1570 &
sockscf
.
öôül
.
˝u
.
mask
) == -1)

1571 
	`£º
("%s: couldÇŸ gë cuºíà˝u schedulögáfföôy", 
fun˘i⁄
);

1573 
sockscf
.
öôül
.
˝u
.
afföôy_is£t
 = 1;

1580 
	`shmem_£tup
();

1582 
	`gíîicöô
();

1583 
	`checkc⁄fig
();

1584 
	`√w¥ocöô
();

1586 i‡(!
sockscf
.
›ti⁄
.
vîify⁄ly
) {

1587 i‡(
	`bödöã∫Æ
(
SOCKS_TCP
) != 0)

1588 
	`£º
("%s: faûedÅÿböd i¡î«»addªs£s", 
fun˘i⁄
);

1590 
	`ª£çrivûeges
();

1593 
sockscf
.
°©e
.
öôed
 = 1;

1594 
	}
}

1597 
	$h™dÀchûdcomm™d
(
comm™d
, 
chûd
, 
föished
)

1598 c⁄° 
comm™d
;

1599 
sockd_chûd_t
 *
chûd
;

1600 *
föished
;

1602 c⁄° *
fun˘i⁄
 = "handlechildcommand()";

1604 
	`SASSERTX
(
chûd
 !
NULL
);

1606 
	`¶og
(
LOG_DEBUG
, "%s: command %d from %s %ld",

1607 
fun˘i⁄
, 
comm™d
, 
	`chûdty≥2°rög
(
chûd
->
ty≥
), ()chûd->
pid
);

1609 
comm™d
) {

1610 
SOCKD_NOP
:

1613 
SOCKD_FREESLOT_TCP
:

1614 
SOCKD_FREESLOT_UDP
:

1615 ++
chûd
->
‰ìc
;

1617 
	`¶og
(
LOG_DEBUG
,

1619 
fun˘i⁄
,

1620 
	`chûdty≥2°rög
(
chûd
->
ty≥
),

1621 ()
chûd
->
pid
,

1622 
comm™d
 =
SOCKD_FREESLOT_TCP
 ? "TCP" : "UDP",

1623 ()
chûd
->
‰ìc
,

1624 
chûd
->
‰ìc
 == 1 ? "" : "s");

1626 
	`SASSERTX
(
chûd
->
‰ìc
 <
	`max‰ì¶Ÿs
(chûd->
ty≥
));

1628 i‡(
chûd
->
ty≥
 =
PROC_IO
) {

1634 ++
sockscf
.
°©
.
io
.
ª˚ived
;

1635 #i‡
COVENANT


1639 #i‡
BAREFOOTD


1640 i‡(
comm™d
 =
SOCKD_FREESLOT_UDP
) {

1641 --
chûd
->
hasudp£ssi⁄
;

1642 
	`SASSERTX
(
chûd
->
hasudp£ssi⁄
 == 0);

1650 
	`SWARNX
(
comm™d
);

1653 i‡(
sockscf
.
chûd
.
maxªque°s
 != 0

1654 && 
chûd
->
‰ìc
 =
	`max‰ì¶Ÿs
(chûd->
ty≥
)

1655 && 
chûd
->
£¡c
 >
sockscf
.chûd.
maxªque°s
) {

1656 
	`¶og
(
LOG_DEBUG
,

1658 
fun˘i⁄
,

1659 
	`chûdty≥2°rög
(
chûd
->
ty≥
),

1660 ()
chûd
->
pid
,

1661 ()
chûd
->
£¡c
,

1662 ()
chûd
->
£¡c
 == 1 ? "" : "s");

1664 *
föished
 = 1;

1667 *
föished
 = 0;

1668 
	}
}

1670 #i‡
DEBUG
 && 
DOTEST


1672 
	$dŸe°
()

1674 c⁄° *
fun˘i⁄
 = "dotest()";

1676 
	`doc⁄figã°
();

1679 
sockd_chûd_t
 *
chûd
;

1680 
sockd_˛õ¡_t
 
˛õ¡
;

1681 
sockd_ªque°_t
 
ªque°
;

1682 
sockd_io_t
 
io
;

1684 
	`¶og
(
LOG_INFO
, "%s: sèπög síd_˛õ¡(Ëã° ...", 
fun˘i⁄
);

1686 i‡((
chûd
 = 
	`√xtchûd
(
PROC_NEGOTIATE
, 
SOCKS_TCP
)Ë=
NULL
)

1687 
	`£º
("%s:Çextchûd(PROC_NEGOTIATEËÁûed", 
fun˘i⁄
);

1689 i‡(
	`kûl
(
chûd
->
pid
, 
SIGSTOP
) != 0)

1690 
	`£º
("%s: kûl(SIGSTOPËo‡chûd %ld faûed", 
fun˘i⁄
, ()
chûd
->
pid
);

1692 
	`bzîo
(&
˛õ¡
, (client));

1693 i‡((
˛õ¡
.
s
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0)) == -1)

1694 
	`£º
("%s: faûedÅÿ¸óãá SOCK_STREAM sockë", 
fun˘i⁄
);

1696 
i
 = 0;

1697 
	`£nd_˛õ¡
(
chûd
->
s
, &
˛õ¡
, 
NULL
, 0) == 0)

1698 ++
i
;

1700 i‡(
	`kûl
(
chûd
->
pid
, 
SIGTERM
) != 0)

1701 
	`£º
("%s: kûl(SIGTERMËo‡chûd %ld faûed", 
fun˘i⁄
, ()
chûd
->
pid
);

1703 i‡(
i
 >
SOCKD_NEGOTIATEMAX
)

1704 
	`¶og
(
LOG_INFO
, "%s: send_client()Åest completed ok, sent %dÑequests",

1705 
fun˘i⁄
, 
i
);

1707 
	`sw¨n
("%s: síd_˛õ¡(Ëã° faûedá·î %dÑeque°s", 
fun˘i⁄
, 
i
);

1710 
	`¶og
(
LOG_INFO
, "%s: sèπög síd_ªq(Ëã° ...", 
fun˘i⁄
);

1712 i‡((
chûd
 = 
	`√xtchûd
(
PROC_REQUEST
, 
SOCKS_TCP
)Ë=
NULL
)

1713 
	`£º
("%s:Çextchûd(PROC_REQUESTËÁûed", 
fun˘i⁄
);

1715 i‡(
	`kûl
(
chûd
->
pid
, 
SIGSTOP
) != 0)

1716 
	`£º
("%s: kûl(SIGSTOPËo‡chûd %ld faûed", 
fun˘i⁄
, ()
chûd
->
pid
);

1718 
	`bzîo
(&
ªque°
, (request));

1719 i‡((
ªque°
.
s
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0)) == -1)

1720 
	`£º
("%s: faûedÅÿ¸óãá SOCK_STREAM sockë", 
fun˘i⁄
);

1722 
i
 = 0;

1723 
	`£nd_ªq
(
chûd
->
s
, &
ªque°
) == 0)

1724 ++
i
;

1726 i‡(
	`kûl
(
chûd
->
pid
, 
SIGTERM
) != 0)

1727 
	`£º
("%s: kûl(SIGTERMËo‡chûd %ld faûed", 
fun˘i⁄
, ()
chûd
->
pid
);

1729 i‡(
i
 >
SOCKD_REQUESTMAX
)

1730 
	`¶og
(
LOG_INFO
, "%s: send_req()Åest completed ok, sent %dÑequests",

1731 
fun˘i⁄
, 
i
);

1733 
	`sw¨n
("%s: síd_ªq(Ëã° faûedá·î %dÑeque°s", 
fun˘i⁄
, 
i
);

1735 
	`¶og
(
LOG_INFO
, "%s: sèπög síd_io(Ëã° ...", 
fun˘i⁄
);

1737 i‡((
chûd
 = 
	`√xtchûd
(
PROC_IO
, 
SOCKS_TCP
)Ë=
NULL
)

1738 
	`£º
("%s:Çextchûd(PROC_IOËÁûed", 
fun˘i⁄
);

1740 i‡(
	`kûl
(
chûd
->
pid
, 
SIGSTOP
) != 0)

1741 
	`£º
("%s: kûl(SIGSTOPËo‡chûd %ld faûed", 
fun˘i⁄
, ()
chûd
->
pid
);

1743 
	`bzîo
(&
io
, (io));

1744 
io
.
°©e
.
comm™d
 = 
SOCKS_UDPASSOCIATE
;

1745 i‡((
io
.
c⁄åﬁ
.
s
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0)) == -1

1746 || (
io
.
§c
.
s
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0)) == -1

1747 || (
io
.
d°
.
s
 = 
	`sockë
(
AF_INET
, 
SOCK_DGRAM
, 0)) == -1)

1748 
	`£º
("%s: faûedÅÿ¸óãá SOCK_STREAM sockë", 
fun˘i⁄
);

1750 
i
 = 0;

1751 
	`£nd_io
(
chûd
->
s
, &
io
) == 0)

1752 ++
i
;

1754 i‡(
	`kûl
(
chûd
->
pid
, 
SIGTERM
) != 0)

1755 
	`£º
("%s: kûl(SIGTERMËo‡chûd %ld faûed", 
fun˘i⁄
, ()
chûd
->
pid
);

1757 i‡(
i
 >
SOCKD_IOMAX
)

1758 
	`¶og
(
LOG_INFO
, "%s: send_io()Åest completed ok, sent %dÑequests",

1759 
fun˘i⁄
, 
i
);

1761 
	`sw¨n
("%s: síd_io(Ëã° faûedá·î %dÑeque°s", 
fun˘i⁄
, 
i
);

1764 
	`socks_iobu·e°
();

1768 
	}
}

	@sockd/sockd_child.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

50 
	#MOTHER
 (0Ë

	)

51 
	#CHILD
 (1Ë

	)

54 
£tchûdty≥
(
ty≥
, 
sockd_chûd_t
 ***
chûdv
, 
size_t
 **
chûdc
,

55 (**
fun˘i⁄
)());

61 
ssize_t


62 
	`födchûd
(
pid_t
 
pid
, 
size_t
 
chûdc
, c⁄° 
sockd_chûd_t
 *
chûdv
);

71 
sockd_chûd_t
 *

72 
	`addchûd
(c⁄° 
ty≥
);

81 
sockd_chûd_t
 *
m⁄ô‹v
;

82 
size_t
 
m⁄ô‹c
;

84 
sockd_chûd_t
 *
√gchûdv
;

85 
size_t
 
√gchûdc
;

87 
sockd_chûd_t
 *
ªqchûdv
;

88 
size_t
 
ªqchûdc
;

90 
sockd_chûd_t
 *
iochûdv
;

91 
size_t
 
iochûdc
;

94 
	$íabÀ_chûd¸óã
()

96 c⁄° *
fun˘i⁄
 = "enable_childcreate()";

98 i‡(
sockscf
.
chûd
.
nﬂddchûd
) {

99 
fú°time
 = 1;

101 i‡(
fú°time
)

102 
fú°time
 = 0;

104 
	`¶og
(
LOG_INFO
, "%s: creation ofÇew childÖrocessesÉnabledágain",

105 
fun˘i⁄
);

107 
sockscf
.
chûd
.
nﬂddchûd
 = 0;

110 
sockscf
.
chûd
.
nﬂddchûd_î∫o
 = 0;

111 
	}
}

114 
	$dißbÀ_chûd¸óã
(
îr
, 
ªas⁄
)

115 c⁄° 
îr
;

116 c⁄° *
ªas⁄
;

118 c⁄° *
fun˘i⁄
 = "disable_childcreate()";

120 i‡(!
sockscf
.
chûd
.
nﬂddchûd
) {

121 
	`¶og
(
LOG_INFO
,

123 
fun˘i⁄
,

124 
ªas⁄
 =
NULL
 ? "" : ": ",

125 
ªas⁄
 =
NULL
 ? "" :Ñeason,

126 
	`°ªº‹
(
î∫o
));

128 
sockscf
.
chûd
.
nﬂddchûd
 = 1;

131 
sockscf
.
chûd
.
nﬂddchûd_î∫o
 = 
îr
;

132 
sockscf
.
chûd
.
nﬂddchûd_ªas⁄
 = 
ªas⁄
;

133 
	}
}

135 
size_t


136 
	$chûdcheck
(
ty≥
)

137 
ty≥
;

139 c⁄° *
fun˘i⁄
 = "childcheck()";

140 
time_t
 
œ°addchûdÁûuª_time
;

141 c⁄° 
î∫o_s
 = 
î∫o
;

142 
sockd_chûd_t
 **
chûdv
, *
idÀchûd
;

143 
size_t
 
chûd
, *
chûdc
, 
mö‰ì¶Ÿs
, 
max¶Ÿ•î¥oc
, 
¥oxyc
,

144 
mö˛õ¡sh™dÀd
;

145 
time_t
 
möli„time
;

146 #i‡
BAREFOOTD


147 
pid_t
 
has‰ìudp¶Ÿ
 = (pid_t)-1;

150 
ty≥
) {

154 -
PROC_MONITOR
:

155 
PROC_MONITOR
:

156 
chûdc
 = &
m⁄ô‹c
;

157 
chûdv
 = &
m⁄ô‹v
;

158 
mö‰ì¶Ÿs
 = 1;

159 
mö˛õ¡sh™dÀd
 = 1;

160 
max¶Ÿ•î¥oc
 = 1;

164 -
PROC_NEGOTIATE
:

165 
PROC_NEGOTIATE
:

166 
chûdc
 = &
√gchûdc
;

167 
chûdv
 = &
√gchûdv
;

168 
mö‰ì¶Ÿs
 = 
SOCKD_FREESLOTS_NEGOTIATE
;

169 
mö˛õ¡sh™dÀd
 = 
SOCKD_MIN_CLIENTS_HANDLED_NEGOTIATE
;

170 
max¶Ÿ•î¥oc
 = 
SOCKD_NEGOTIATEMAX
;

173 -
PROC_REQUEST
:

174 
PROC_REQUEST
:

175 
chûdc
 = &
ªqchûdc
;

176 
chûdv
 = &
ªqchûdv
;

178 
mö‰ì¶Ÿs
 = 
SOCKD_FREESLOTS_REQUEST
;

179 
mö˛õ¡sh™dÀd
 = 
SOCKD_MIN_CLIENTS_HANDLED_REQUEST
;

180 
max¶Ÿ•î¥oc
 = 
SOCKD_REQUESTMAX
;

183 -
PROC_IO
:

184 
PROC_IO
:

185 
chûdc
 = &
iochûdc
;

186 
chûdv
 = &
iochûdv
;

187 
mö‰ì¶Ÿs
 = 
SOCKD_FREESLOTS_IO
;

188 
mö˛õ¡sh™dÀd
 = 
SOCKD_MIN_CLIENTS_HANDLED_IO
;

189 
max¶Ÿ•î¥oc
 = 
SOCKD_IOMAX
;

193 
	`SERRX
(
ty≥
);

197 
möli„time
 = 
SOCKD_MIN_LIFETIME_SECONDS
;

204 
idÀchûd
 = 
NULL
;

205 
chûd
 = 
¥oxyc
 = 0; chûd < *
chûdc
; ++child) {

206 
	`SASSERTX
((*
chûdv
)[
chûd
].
‰ìc
 <
max¶Ÿ•î¥oc
);

208 i‡((*
chûdv
)[
chûd
].
waôögf‹exô
)

211 i‡(
sockscf
.
chûd
.
maxªque°s
 != 0) {

212 i‡((*
chûdv
)[
chûd
].
£¡c
 =
sockscf
.chûd.
maxªque°s
) {

213 
	`¶og
(
LOG_DEBUG
,

217 
fun˘i⁄
,

218 ()(*
chûdv
)[
chûd
].
pid
,

219 ()(*
chûdv
)[
chûd
].
£¡c
,

220 ()(*
chûdv
)[
chûd
].
‰ìc
,

221 ()
	`max‰ì¶Ÿs
((*
chûdv
)[
chûd
].
ty≥
));

227 #i‡
BAREFOOTD


228 i‡(
ty≥
 =
PROC_IO
) {

229 i‡(!(*
chûdv
)[
chûd
].
hasudp£ssi⁄
)

230 
has‰ìudp¶Ÿ
 = (*
chûdv
)[
chûd
].
pid
;

232 
	`¶og
(
LOG_DEBUG
, "%s:Çot countingÖrocess %lu:Ço free udp slots",

233 
fun˘i⁄
, ()(*
chûdv
)[
chûd
].
pid
);

237 
¥oxyc
 +
ty≥
 < 0 ? 
max¶Ÿ•î¥oc
 :

238 #i‡
BAREFOOTD


247 ((
ty≥
 =
PROC_IO


248 && (*
chûdv
)[
chûd
].
hasudp£ssi⁄
) ?

249 0 : (*
chûdv
)[
chûd
].
‰ìc
);

252 (*
chûdv
)[
chûd
].
‰ìc
;

256 i‡((*
chûdv
)[
chûd
].
‰ìc
 =
max¶Ÿ•î¥oc
) {

257 #i‡
BAREFOOTD


258 i‡(
ty≥
 =
PROC_IO
) {

259 i‡(
has‰ìudp¶Ÿ
 !(
pid_t
)-1

260 && 
has‰ìudp¶Ÿ
 !(*
chûdv
)[
chûd
].
pid
)

269 
has‰ìudp¶Ÿ
 = (*
chûdv
)[
chûd
].
pid
;

286 i‡(
sockscf
.
chûd
.
nﬂddchûd


287 || (*
chûdv
)[
chûd
].
£¡c
 >
mö˛õ¡sh™dÀd


288 || 
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(
NULL
), (*
chûdv
)[
chûd
].
¸óãd
)

289 >(
time_t
)
möli„time
) {

290 i‡(
idÀchûd
 =
NULL
 || (*
chûdv
)[
chûd
].
£¡c
 > idlechild->sentc)

291 
idÀchûd
 = &(*
chûdv
)[
chûd
];

296 i‡(
sockscf
.
chûd
.
nﬂddchûd
) {

297 i‡(
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(
NULL
), 
œ°addchûdÁûuª_time
)

298 >(
time_t
)
MAX_ADDCHILD_SECONDS


299 && 
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(
NULL
), 
sockscf
.
°©e
.
fú°dóth_time
)

300 >(
time_t
)
MAX_ADDCHILD_SECONDS
)

301 
	`íabÀ_chûd¸óã
();

304 i‡(
ty≥
 >= 0) {

308 i‡(
idÀchûd
 !
NULL


309 && (
¥oxyc
 - 
max¶Ÿ•î¥oc
Ë>
mö‰ì¶Ÿs
) {

310 
	`¶og
(
LOG_DEBUG
,

313 
fun˘i⁄
,

314 ()(
¥oxyc
 - 
max¶Ÿ•î¥oc
),

315 
	`chûdty≥2°rög
(
idÀchûd
->
ty≥
),

316 ()(
idÀchûd
->
pid
),

317 ()(
idÀchûd
->
£¡c
),

318 
idÀchûd
->
£¡c
 == 1 ? "" : "s",

319 ()
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(
NULL
), 
idÀchûd
->
¸óãd
));

324 
	`SASSERTX
(
idÀchûd
->
‰ìc
 =
max¶Ÿ•î¥oc
);

325 
¥oxyc
 -
idÀchûd
->
‰ìc
;

326 
	`˛o£chûd
(
idÀchûd
->
pid
, 1);

332 i‡(!
sockscf
.
chûd
.
nﬂddchûd


333 && ((
¥oxyc
 < 
mö‰ì¶Ÿs
)

334 #i‡
BAREFOOTD


335 || (
ty≥
 =
PROC_IO
 && 
has‰ìudp¶Ÿ
 =(
pid_t
)-1)

338 
ª£rvedv
[ 
	`MAX
(
FDPASS_MAX
,

352 
size_t
 
i
, 
‰ìc
;

363 
i
 = 0, 
‰ìc
 = 0; i < 
	`ELEMENTS
(
ª£rvedv
); ++i)

364 i‡((
ª£rvedv
[
i
] = 
	`makedummyfd
(0, 0)) != -1)

365 ++
‰ìc
;

367 i‡(
‰ìc
 < 
	`ELEMENTS
(
ª£rvedv
)) {

368 
	`sw¨n
("%s:ÇotÉnough free sockets/file descriptorsÅoáddány "

370 
fun˘i⁄
,

371 ()
	`ELEMENTS
(
ª£rvedv
),

372 ()
‰ìc
);

374 
	`dißbÀ_chûd¸óã
(
î∫o
,

378 
	`time_m⁄Ÿ⁄ic
(&
œ°addchûdÁûuª_time
);

381 !
sockscf
.
chûd
.
nﬂddchûd


382 && ((
¥oxyc
 < 
mö‰ì¶Ÿs
)

383 #i‡
BAREFOOTD


384 || (
ty≥
 =
PROC_IO
 && 
has‰ìudp¶Ÿ
 =(
pid_t
)-1)

387 
sockd_chûd_t
 *
addedchûd
;

389 #i‡
BAREFOOTD


390 i‡(
ty≥
 =
PROC_IO
 && 
has‰ìudp¶Ÿ
 =(
pid_t
)-1)

391 
	`¶og
(
LOG_DEBUG
, "%s:Ço free udp slots:ÇeedÅoádd more %sren",

392 
fun˘i⁄
, 
	`chûdty≥2°rög
(
ty≥
));

395 
	`¶og
(
LOG_DEBUG
,

398 
fun˘i⁄
,

399 
	`chûdty≥2°rög
(
ty≥
),

400 ()
¥oxyc
,

401 ()
mö‰ì¶Ÿs
,

402 
	`chûdty≥2°rög
(
ty≥
));

404 i‡((
addedchûd
 = 
	`addchûd
(
ty≥
)Ë!
NULL
) {

405 
	`¶og
(
LOG_DEBUG
, "%s:ádded child,Öid %lu",

406 
fun˘i⁄
, ()
addedchûd
->
pid
);

408 
¥oxyc
 +
max¶Ÿ•î¥oc
;

410 #i‡
BAREFOOTD


411 i‡(
ty≥
 =
PROC_IO
)

412 
has‰ìudp¶Ÿ
 = 
addedchûd
->
pid
;

417 
	`log_addchûd_Áûed
();

419 
	`dißbÀ_chûd¸óã
(
î∫o
, 
NULL
);

422 
	`time_m⁄Ÿ⁄ic
(&
œ°addchûdÁûuª_time
);

426 
	`˛o£v
(
	`ELEMENTS
(
ª£rvedv
),Ñeservedv);

431 
î∫o
 = 
î∫o_s
;

433  
¥oxyc
;

434 
	}
}

437 
	$fûl£t
(
£t
, 
√gc
, 
ªqc
, 
ioc
)

438 
fd_£t
 *
£t
;

439 
size_t
 *
√gc
;

440 
size_t
 *
ªqc
;

441 
size_t
 *
ioc
;

444 
size_t
 
i
;

445 
dbôs
;

456 *
√gc
 = 
	`chûdcheck
(
PROC_NEGOTIATE
);

457 *
ªqc
 = 
	`chûdcheck
(
PROC_REQUEST
);

458 *
ioc
 = 
	`chûdcheck
(
PROC_IO
);

460 
	`FD_ZERO
(
£t
);

461 
dbôs
 = -1;

463 
i
 = 0; i < 
sockscf
.
öã∫Æ
.
addrc
; ++i) {

464 #i‡
BAREFOOTD


465 i‡(
sockscf
.
öã∫Æ
.
addrv
[
i
].
¥Ÿocﬁ
 !
SOCKS_TCP
)

480 
	`SASSERTX
(
sockscf
.
öã∫Æ
.
addrv
[
i
].
s
 >= 0);

481 
	`FD_SET
(
sockscf
.
öã∫Æ
.
addrv
[
i
].
s
, 
£t
);

482 
dbôs
 = 
	`MAX
(dbôs, 
sockscf
.
öã∫Æ
.
addrv
[
i
].
s
);

486 
i
 = 0; i < 
√gchûdc
; ++i) {

487 i‡(
√gchûdv
[
i
].
waôögf‹exô
)

490 i‡(*
ªqc
 > 0) {

491 
	`SASSERTX
(
√gchûdv
[
i
].
s
 >= 0);

492 
	`FD_SET
(
√gchûdv
[
i
].
s
, 
£t
);

493 
dbôs
 = 
	`MAX
(dbôs, 
√gchûdv
[
i
].
s
);

495 
	`SASSERTX
(
√gchûdv
[
i
].
ack
 >= 0);

496 
	`FD_SET
(
√gchûdv
[
i
].
ack
, 
£t
);

497 
dbôs
 = 
	`MAX
(dbôs, 
√gchûdv
[
i
].
ack
);

502 
i
 = 0; i < 
ªqchûdc
; ++i) {

503 i‡(
ªqchûdv
[
i
].
waôögf‹exô
)

506 i‡(*
ioc
 > 0) {

507 
	`SASSERTX
(
ªqchûdv
[
i
].
s
 >= 0);

508 
	`FD_SET
(
ªqchûdv
[
i
].
s
, 
£t
);

509 
dbôs
 = 
	`MAX
(dbôs, 
ªqchûdv
[
i
].
s
);

511 
	`SASSERTX
(
ªqchûdv
[
i
].
ack
 >= 0);

512 
	`FD_SET
(
ªqchûdv
[
i
].
ack
, 
£t
);

513 
dbôs
 = 
	`MAX
(dbôs, 
ªqchûdv
[
i
].
ack
);

522 
i
 = 0; i < 
iochûdc
; ++i) {

523 i‡(
iochûdv
[
i
].
waôögf‹exô
)

526 #i‡
COVENANT


527 i‡(*
√gc
 > 0) {

528 
	`SASSERTX
(
iochûdv
[
i
].
s
 >= 0);

529 
	`FD_SET
(
iochûdv
[
i
].
s
, 
£t
);

530 
dbôs
 = 
	`MAX
(dbôs, 
iochûdv
[
i
].
s
);

533 
	`SASSERTX
(
iochûdv
[
i
].
ack
 >= 0);

534 
	`FD_SET
(
iochûdv
[
i
].
ack
, 
£t
);

535 
dbôs
 = 
	`MAX
(dbôs, 
iochûdv
[
i
].
ack
);

536 #i‡
COVENANT


542  
dbôs
;

543 
	}
}

547 
	$˛órchûdty≥
(
chûdty≥
, 
pùëy≥
, 
nfds
, 
£t
)

548 c⁄° 
chûdty≥
;

549 
whichpùe_t
 
pùëy≥
;

550 c⁄° 
nfds
;

551 
fd_£t
 *
£t
;

553 c⁄° *
fun˘i⁄
 = "clearchildtype()";

554 
sockd_chûd_t
 **
chûdv
;

555 
size_t
 
i
, *
chûdc
;

558 
	`¶og
(
LOG_DEBUG
, "%s: clearingáll childs ofÅype %s from set",

559 
fun˘i⁄
, 
	`chûdty≥2°rög
(
chûdty≥
));

561 
	`£tchûdty≥
(
chûdty≥
, &
chûdv
, &
chûdc
, 
NULL
);

563 
i
 = 0; i < *
chûdc
; ++i)

564 
	`˛ór£t
(
pùëy≥
, &(*
chûdv
)[
i
], 
£t
);

565 
	}
}

568 
	$˛ór£t
(
ty≥
, 
chûd
, 
£t
)

569 
whichpùe_t
 
ty≥
;

570 c⁄° 
sockd_chûd_t
 *
chûd
;

571 
fd_£t
 *
£t
;

573 #i‡
DEBUG


574 c⁄° *
fun˘i⁄
 = "clearset()";

575 
buf
[10240];

577 
fdto˛ór
;

579 
ty≥
) {

580 
ACKPIPE
:

581 
fdto˛ór
 = 
chûd
->
ack
;

584 
DATAPIPE
:

585 
fdto˛ór
 = 
chûd
->
s
;

589 
	`SERRX
(
ty≥
);

592 i‡(
fdto˛ór
 <= 0) {

593 
	`SASSERTX
(
chûd
->
waôögf‹exô
);

597 #i‡
DEBUG


598 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_DEBUG
)

599 
	`¶og
(
LOG_DEBUG
, "%s: will clear fd %d fromÅhe fd-set containing: %s",

600 
fun˘i⁄
,

601 
fdto˛ór
,

602 
	`fd£t2°rög
(
sockscf
.
°©e
.
highe°fdöu£
, 
£t
, 1, 
buf
, (buf)));

605 
	`FD_CLR
(
fdto˛ór
, 
£t
);

606 
	}
}

608 
sockd_chûd_t
 *

609 
	$gë£t
(
ty≥
, 
£t
)

610 
whichpùe_t
 
ty≥
;

611 
fd_£t
 *
£t
;

614 
size_t
 
i
;

619 
i
 = 0; i < 
√gchûdc
; ++i) {

620 i‡(
√gchûdv
[
i
].
waôögf‹exô
)

623 
ty≥
) {

624 
DATAPIPE
:

625 #i‡
BAREFOOTD


626 i‡(!
	`ALL_UDP_BOUNCED
()) {

627 
fd_£t
 *
zîo
;

629 i‡(
zîo
 =
NULL
) {

630 
zîo
 = 
	`Æloˇã_maxsize_fd£t
();

631 
	`FD_ZERO
(
zîo
);

634 i‡(
	`FD_CMP
(
zîo
, 
£t
) == 0) {

635 
	`¶og
(
LOG_DEBUG
,

638 ()
√gchûdv
[
i
].
pid
);

640  &
√gchûdv
[
i
];

645 i‡(
	`FD_ISSET
(
√gchûdv
[
i
].
s
, 
£t
))

646  &
√gchûdv
[
i
];

649 
ACKPIPE
:

650 i‡(
	`FD_ISSET
(
√gchûdv
[
i
].
ack
, 
£t
))

651  &
√gchûdv
[
i
];

659 
i
 = 0; i < 
ªqchûdc
; ++i) {

660 i‡(
ªqchûdv
[
i
].
waôögf‹exô
)

663 
ty≥
) {

664 
DATAPIPE
:

665 i‡(
	`FD_ISSET
(
ªqchûdv
[
i
].
s
, 
£t
))

666  &
ªqchûdv
[
i
];

669 
ACKPIPE
:

670 i‡(
	`FD_ISSET
(
ªqchûdv
[
i
].
ack
, 
£t
))

671  &
ªqchûdv
[
i
];

679 
i
 = 0; i < 
iochûdc
; ++i) {

680 i‡(
iochûdv
[
i
].
waôögf‹exô
)

683 
ty≥
) {

684 
DATAPIPE
:

685 i‡(
	`FD_ISSET
(
iochûdv
[
i
].
s
, 
£t
))

686  &
iochûdv
[
i
];

689 
ACKPIPE
:

690 i‡(
	`FD_ISSET
(
iochûdv
[
i
].
ack
, 
£t
))

691  &
iochûdv
[
i
];

696  
NULL
;

697 
	}
}

700 
	$ªmovechûd
(
pid
)

701 c⁄° 
pid_t
 
pid
;

703 c⁄° *
fun˘i⁄
 = "removechild()";

704 
sockd_chûd_t
 **
chûdv
;

705 
ssize_t
 
chûd
;

706 
size_t
 *
chûdc
;

708 
	`¶og
(
LOG_DEBUG
, "%s:Öid = %lu", 
fun˘i⁄
, ()
pid
);

710 i‡(
pid
 == 0) {

711 
chûdty≥v
[] = {
PROC_MONITOR
, 
PROC_NEGOTIATE
, 
PROC_REQUEST
, 
PROC_IO
};

712 
size_t
 
i
;

714 
i
 = 0; i < 
	`ELEMENTS
(
chûdty≥v
); ++i) {

715 i‡(
chûdty≥v
[
i
] =
PROC_MONITOR


716 && 
	`pidismŸhî
(
sockscf
.
°©e
.
pid
) != 1)

720 
	`£tchûdty≥
(
chûdty≥v
[
i
], &
chûdv
, &
chûdc
, 
NULL
);

721 i‡(*
chûdc
 == 0)

724 
	`SASSERTX
((*
chûdv
)[0].
pid
 != 0);

725 
	`ªmovechûd
((*
chûdv
)[0].
pid
);

732 
	`£tchûdty≥
(
	`chûdty≥
(
pid
), &
chûdv
, &
chûdc
, 
NULL
);

733 
chûd
 = 
	`födchûd
(
pid
, *
chûdc
, *
chûdv
);

734 i‡(
chûd
 < 0) {

735 
	`SWARNX
(
chûd
);

740 (
size_t
)
chûd
 < *
chûdc
 - 1) {

741 (*
chûdv
)[
chûd
] = (*childv)[child + 1];

742 ++
chûd
;

744 --(*
chûdc
);

749 
	}
}

752 
	$˛o£chûd
(
pid
, 
i¢‹mÆexô
)

753 
pid_t
 
pid
;

754 c⁄° 
i¢‹mÆexô
;

756 c⁄° *
fun˘i⁄
 = "closechild()";

757 c⁄° 
cmd
 = 
SOCKD_EXITNORMALLY
;

758 
sockd_chûd_t
 **
chûdv
;

759 
ssize_t
 
chûd
;

760 
size_t
 *
chûdc
;

762 
	`¶og
(
LOG_DEBUG
, "%s:Öid = %lu, isnormalexit = %d",

763 
fun˘i⁄
, ()
pid
, 
i¢‹mÆexô
);

765 i‡(
pid
 == 0) {

766 
chûdty≥v
[] = {
PROC_MONITOR
, 
PROC_NEGOTIATE
, 
PROC_REQUEST
, 
PROC_IO
};

767 
size_t
 
chûdty≥c
;

769 
chûdty≥c
 = 0; chûdty≥¯< 
	`ELEMENTS
(
chûdty≥v
); ++childtypec) {

770 
size_t
 
i
;

772 i‡(
chûdty≥v
[
chûdty≥c
] =
PROC_MONITOR


773 && 
	`pidismŸhî
(
sockscf
.
°©e
.
pid
) != 1)

776 
	`£tchûdty≥
(
chûdty≥v
[
chûdty≥c
], &
chûdv
, &
chûdc
, 
NULL
);

778 i‡(*
chûdc
 == 0)

781 
i
 = 0; i < *
chûdc
; ++i) {

782 
	`SASSERTX
((*
chûdv
)[
i
].
pid
 != 0);

783 
	`˛o£chûd
((*
chûdv
)[
i
].
pid
, 
i¢‹mÆexô
);

790 
	`£tchûdty≥
(
	`chûdty≥
(
pid
), &
chûdv
, &
chûdc
, 
NULL
);

791 
chûd
 = 
	`födchûd
(
pid
, *
chûdc
, *
chûdv
);

792 i‡(
chûd
 < 0) {

793 
	`SWARNX
(
chûd
);

797 i‡(
i¢‹mÆexô
 && (*
chûdv
)[
chûd
].
ack
 != -1)

798 i‡(
	`wrôe
((*
chûdv
)[
chûd
].
ack
, &
cmd
, (cmd)) != (cmd))

799 
	`sw¨n
("%s: failedÅoÇotify %s %ld it shouldÉxitÇormally",

800 
fun˘i⁄
,

801 
	`chûdty≥2°rög
((*
chûdv
)[
chûd
].
ty≥
),

802 ()(*
chûdv
)[
chûd
].
pid
);

804 i‡(((*
chûdv
)[
chûd
].
s
) != -1) {

805 
	`˛o£
((*
chûdv
)[
chûd
].
s
);

806 (*
chûdv
)[
chûd
].
s
 = -1;

809 i‡(((*
chûdv
)[
chûd
].
ack
) != -1) {

810 
	`˛o£
((*
chûdv
)[
chûd
].
ack
);

811 (*
chûdv
)[
chûd
].
ack
 = -1;

814 (*
chûdv
)[
chûd
].
waôögf‹exô
 = 1;

815 (*
chûdv
)[
chûd
].
exôögn‹mÆly
 = 
i¢‹mÆexô
;

816 
	}
}

818 
sockd_chûd_t
 *

819 
	$√xtchûd
(
ty≥
, 
¥Ÿocﬁ
)

820 c⁄° 
ty≥
;

821 c⁄° 
¥Ÿocﬁ
;

823 c⁄° *
fun˘i⁄
 = "nextchild()";

824 
sockd_chûd_t
 **
chûdv
, *
mo°busy
;

825 
size_t
 
i
, *
chûdc
;

826 
åõdagaö
 = 0;

828 
åyagaö
:

830 
	`£tchûdty≥
(
ty≥
, &
chûdv
, &
chûdc
, 
NULL
);

836 
mo°busy
 = 
NULL
;

838 
i
 = 0; i < *
chûdc
; ++i) {

839 i‡((*
chûdv
)[
i
].
‰ìc
 > 0) {

840 #i‡
BAREFOOTD


841 i‡(
¥Ÿocﬁ
 =
SOCKS_UDP
 && (*
chûdv
)[
i
].
hasudp£ssi⁄
) {

842 
	`¶og
(
LOG_DEBUG
,

845 
fun˘i⁄
,

846 ()(*
chûdv
)[
i
].
pid
,

847 ()(*
chûdv
)[
i
].
‰ìc
,

848 ()(*
chûdv
)[
i
].
‰ìc
 == 1 ? "" : "s");

854 i‡((*
chûdv
)[
i
].
‰ìc
 <0 || (*chûdv)[i].
waôögf‹exô
)

864 i‡(
mo°busy
 =
NULL


865 || (*
chûdv
)[
i
].
‰ìc
 < 
mo°busy
->freec)

866 
mo°busy
 = &(*
chûdv
)[
i
];

868 i‡(
mo°busy
->
‰ìc
 == 1)

873 i‡(
mo°busy
 !
NULL
)

874  
mo°busy
;

876 
	`¶og
(
LOG_DEBUG
, "%s:Ço free %s slots forÖrotocol %s,Åriedagain = %d",

877 
fun˘i⁄
,

878 
	`chûdty≥2°rög
(
ty≥
),

879 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
),

880 
åõdagaö
);

882 i‡(!
åõdagaö
) {

883 
	`¶og
(
LOG_DEBUG
, "%s: cÆlög chûdcheck(Ë™dÅryögágaö", 
fun˘i⁄
);

885 i‡(
	`chûdcheck
(
ty≥
) > 0) {

886 
åõdagaö
 = 1;

887 
åyagaö
;

891  
NULL
;

892 
	}
}

895 
	$chûdty≥
(
pid
)

896 c⁄° 
pid_t
 
pid
;

899 i‡(
	`födchûd
(
pid
, 
m⁄ô‹c
, 
m⁄ô‹v
) >= 0)

900  
PROC_MONITOR
;

902 i‡(
	`födchûd
(
pid
, 
√gchûdc
, 
√gchûdv
) >= 0)

903  
PROC_NEGOTIATE
;

905 i‡(
	`födchûd
(
pid
, 
ªqchûdc
, 
ªqchûdv
) >= 0)

906  
PROC_REQUEST
;

908 i‡(
	`födchûd
(
pid
, 
iochûdc
, 
iochûdv
) >= 0)

909  
PROC_IO
;

911 i‡(
	`pidismŸhî
(
pid
))

912  
PROC_MOTHER
;

914  
PROC_NOTOURS
;

915 
	}
}

917 
sockd_chûd_t
 *

918 
	$gëchûd
(
pid
)

919 
pid_t
 
pid
;

921 
ssize_t
 
chûd
;

922 
size_t
 *
chûdc
;

923 
sockd_chûd_t
 **
chûdv
;

924 
ty≥
;

926 
ty≥
 = 
	`chûdty≥
(
pid
)) {

927 
PROC_MONITOR
:

928 
PROC_NEGOTIATE
:

929 
PROC_REQUEST
:

930 
PROC_IO
:

933 
PROC_MOTHER
:

934  
NULL
;

936 
PROC_NOTOURS
:

937  
NULL
;

940 
	`SERRX
(
ty≥
);

943 
	`£tchûdty≥
(
ty≥
, &
chûdv
, &
chûdc
, 
NULL
);

945 i‡((
chûd
 = 
	`födchûd
(
pid
, *
chûdc
, *
chûdv
)) >= 0)

946  &(*
chûdv
)[
chûd
];

948 
	`SERRX
(
pid
);

950 
	}
}

953 
	$£nd_io
(
s
, 
io
)

954 
s
;

955 
sockd_io_t
 *
io
;

957 c⁄° *
fun˘i⁄
 = "send_io()";

958 
iovec
 
iov
[2];

959 
msghdr
 
msg
;

960 
ioc
, 
fdto£nd
, 
Àngth
;

961 #i‡
HAVE_GSSAPI


962 
gss_buf„r_desc
 
gsßpi°©e
 = { 0, 
NULL
 };

963 
gss_˘x_id_t
 
‹igöÆ_gssidvÆue
, *
gssid
 = 
NULL
;

964 
gsßpi°©emem
[
MAXGSSAPITOKENLEN
];

966 
	`CMSG_AALLOC
(
cmsg
, (Ë* 
FDPASS_MAX
);

968 
	`SASSERTX
(
io
->
Æloˇãd
 == 0);

970 
	`log_ruÀöfo_shmid
(
	`CRULE_OR_HRULE
(
io
), 
fun˘i⁄
, 
NULL
);

972 i‡(
io
->
§uÀ
.
ty≥
 =
obje˘_n⁄e
) {

973 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
);

974 
	`SASSERTX
(!
HAVE_SOCKS_RULES
);

977 
	`log_ruÀöfo_shmid
(&
io
->
§uÀ
, 
fun˘i⁄
, 
NULL
);

979 
	`SASSERTX
(!(
	`SHMID_ISSET
(
	`CRULE_OR_HRULE
(
io
)Ë&& SHMID_ISSET(&io->
§uÀ
)));

981 #i‡
HAVE_SOCKS_RULES


982 
	`SASSERTX
(!
	`SHMID_ISSET
(
	`CRULE_OR_HRULE
(
io
)));

985 
	`SASSERTX
(!
	`SHMID_ISSET
(&
io
->
§uÀ
));

989 
	`SASSERTX
(!
	`SHMID_ISATTACHED
(
	`CRULE_OR_HRULE
(
io
)));

990 
	`SASSERTX
(!
	`SHMID_ISATTACHED
(&
io
->
§uÀ
));

992 
	`bzîo
(
iov
, (iov));

993 
Àngth
 = 0;

994 
ioc
 = 0;

996 
iov
[
ioc
].
iov_ba£
 = 
io
;

997 
iov
[
ioc
].
iov_Àn
 = (*
io
);

998 
Àngth
 +
iov
[
ioc
].
iov_Àn
;

999 ++
ioc
;

1001 
fdto£nd
 = 0;

1002 
	`CMSG_ADDOBJECT
(
io
->
§c
.
s
, 
cmsg
, (io->§c.sË* 
fdto£nd
++);

1004 
io
->
°©e
.
comm™d
) {

1005 
SOCKS_BIND
:

1006 
	`CMSG_ADDOBJECT
(
io
->
d°
.
s
, 
cmsg
, (io->d°.sË* 
fdto£nd
++);

1008 #i‡
HAVE_GSSAPI


1009 i‡(
io
->
§c
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
)

1010 
gssid
 = &
io
->
§c
.
auth
.
md©a
.
gsßpi
.
°©e
.
id
;

1013 i‡(
io
->
°©e
.
exãnsi⁄
.
böd
)

1014 
	`CMSG_ADDOBJECT
(
io
->
c⁄åﬁ
.
s
,

1015 
cmsg
,

1016 (
io
->
c⁄åﬁ
.
s
Ë* 
fdto£nd
++);

1019 
SOCKS_BINDREPLY
:

1020 
	`CMSG_ADDOBJECT
(
io
->
d°
.
s
, 
cmsg
, (io->d°.sË* 
fdto£nd
++);

1022 #i‡
HAVE_GSSAPI


1023 i‡(
io
->
d°
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
)

1024 
gssid
 = &
io
->
d°
.
auth
.
md©a
.
gsßpi
.
°©e
.
id
;

1027 i‡(
io
->
°©e
.
exãnsi⁄
.
böd
)

1028 
	`CMSG_ADDOBJECT
(
io
->
c⁄åﬁ
.
s
, 
cmsg
,

1029 (
io
->
c⁄åﬁ
.
s
Ë* 
fdto£nd
++);

1032 
SOCKS_UDPASSOCIATE
:

1033 
	`SASSERTX
(
io
->
d°
.
s
 == -1);

1035 #i‡
HAVE_GSSAPI


1036 i‡(
io
->
§c
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
)

1037 
gssid
 = &
io
->
§c
.
auth
.
md©a
.
gsßpi
.
°©e
.
id
;

1040 #i‡!
BAREFOOTD


1041 
	`CMSG_ADDOBJECT
(
io
->
c⁄åﬁ
.
s
, 
cmsg
,

1042 (
io
->
c⁄åﬁ
.
s
Ë* 
fdto£nd
++);

1046 
SOCKS_CONNECT
:

1047 
	`CMSG_ADDOBJECT
(
io
->
d°
.
s
, 
cmsg
, (io->d°.sË* 
fdto£nd
++);

1049 #i‡
HAVE_GSSAPI


1050 i‡(
io
->
§c
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
)

1051 
gssid
 = &
io
->
§c
.
auth
.
md©a
.
gsßpi
.
°©e
.
id
;

1056 
	`SERRX
(
io
->
°©e
.
comm™d
);

1059 #i‡
HAVE_GSSAPI


1060 i‡(
gssid
 =
NULL
) {

1061 
gsßpi°©e
.
vÆue
 = 
NULL
;

1062 
gsßpi°©e
.
Àngth
 = 0;

1065 
‹igöÆ_gssidvÆue
 = *
gssid
;

1067 
gsßpi°©e
.
vÆue
 = 
gsßpi°©emem
;

1068 
gsßpi°©e
.
Àngth
 = (
gsßpi°©emem
);

1070 i‡(
	`gsßpi_exp‹t_°©e
(
gssid
, &
gsßpi°©e
) != 0)

1073 
iov
[
ioc
].
iov_ba£
 = 
gsßpi°©e
.
vÆue
;

1074 
iov
[
ioc
].
iov_Àn
 = 
gsßpi°©e
.
Àngth
;

1075 
Àngth
 +
gsßpi°©e
.length;

1076 ++
ioc
;

1078 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1079 
	`¶og
(
LOG_DEBUG
, "%s: gssapistate hasÜength %lu",

1080 
fun˘i⁄
, ()
gsßpi°©e
.
Àngth
);

1084 
	`bzîo
(&
msg
, (msg));

1085 
msg
.
msg_iov
 = 
iov
;

1086 
msg
.
msg_iovÀn
 = 
ioc
;

1087 
msg
.
msg_«me
 = 
NULL
;

1089 
	`CMSG_SETHDR_SEND
(
msg
, 
cmsg
, (Ë* 
fdto£nd
);

1091 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
) {

1092 
˘æbuf
[
MAXSOCKADDRSTRING
 * 2 + 64],

1093 
§cbuf
[(
˘æbuf
)], 
d°buf
[(ctrlbuf)];

1095 
	`¶og
(
LOG_DEBUG
,

1101 
fun˘i⁄
,

1102 
fdto£nd
,

1103 
io
->
°©e
.
comm™d
,

1104 
s
,

1105 ()
io
->
§uÀ
.
bw_shmid
,

1106 ()
io
->
§uÀ
.
m°©s_shmid
,

1107 ()
io
->
§uÀ
.
ss_shmid
,

1108 
io
->
c⁄åﬁ
.
s
,

1109 
	`sockë2°rög
(
io
->
c⁄åﬁ
.
s
, 
˘æbuf
, (ctrlbuf)),

1110 
io
->
§c
.
s
,

1111 
	`sockë2°rög
(
io
->
§c
.
s
, 
§cbuf
, (srcbuf)),

1112 
io
->
d°
.
s
,

1113 
io
->
d°
.
s
 == -1 ?

1114 "N/A" : 
	`sockë2°rög
(
io
->
d°
.
s
, 
d°buf
, (dstbuf)));

1122 i‡(
	`£ndmsgn
(
s
, &
msg
, 0, 
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
 ? 0 : -1)

1123 !
Àngth
) {

1124 #i‡
HAVE_GSSAPI


1125 i‡(
gsßpi°©e
.
vÆue
 !
NULL
) {

1126 *
gssid
 = 
‹igöÆ_gssidvÆue
;

1128 i‡(
	`gsßpi_imp‹t_°©e
(
gssid
, &
gsßpi°©e
) != 0)

1129 
	`sw¨nx
("%s: couldÇŸÑe-imp‹àgsßpò°©e", 
fun˘i⁄
);

1133 
	`¶og
(
LOG_DEBUG
,

1135 
fun˘i⁄
,

1136 
	`sockaddr2°rög
(&
	`CONTROLIO
(
io
)->
øddr
, 
NULL
, 0),

1137 
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
 ? "child" : "mother",

1138 
	`°ªº‹
(
î∫o
));

1144 
	}
}

1147 
	$£nd_˛õ¡
(
s
, 
_˛õ¡
, 
buf
, 
buÊí
)

1148 
s
;

1149 c⁄° 
sockd_˛õ¡_t
 *
_˛õ¡
;

1150 c⁄° *
buf
;

1151 c⁄° 
size_t
 
buÊí
;

1153 c⁄° *
fun˘i⁄
 = "send_client()";

1154 
sockd_˛õ¡_t
 
˛õ¡
 = *
_˛õ¡
;

1155 
iovec
 iovec[1];

1156 
msghdr
 
msg
;

1157 
	`CMSG_AALLOC
(
cmsg
, ());

1158 
fdto£nd
;

1160 
	`¶og
(
LOG_DEBUG
, "%s: buÊí = %lu", 
fun˘i⁄
, ()
buÊí
);

1162 #i‡
COVENANT


1163 i‡(
buÊí
 > 0) {

1164 
	`mem˝y
(
˛õ¡
.
˛õ¡d©a
, 
buf
, 
buÊí
);

1165 
˛õ¡
.
˛õ¡d©Æí
 = 
buÊí
;

1169 
	`bzîo
(
iovec
, (iovec));

1170 
iovec
[0].
iov_ba£
 = &
˛õ¡
;

1171 
iovec
[0].
iov_Àn
 = (
˛õ¡
);

1173 
fdto£nd
 = 0;

1174 
	`CMSG_ADDOBJECT
(
˛õ¡
.
s
, 
cmsg
, (˛õ¡.sË* 
fdto£nd
++);

1176 
	`bzîo
(&
msg
, (msg));

1177 
msg
.
msg_iov
 = 
iovec
;

1178 
msg
.
msg_iovÀn
 = 
	`ELEMENTS
(
iovec
);

1179 
msg
.
msg_«me
 = 
NULL
;

1181 
	`CMSG_SETHDR_SEND
(
msg
, 
cmsg
, (Ë* 
fdto£nd
);

1183 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1184 
	`¶og
(
LOG_DEBUG
, "%s: sending fd %d (%s) on fd %d ...",

1185 
fun˘i⁄
, 
˛õ¡
.
s
, 
	`sockë2°rög
(˛õ¡.s, 
NULL
, 0), s);

1187 i‡(
	`£ndmsgn
(
s
, &
msg
, 0, 
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
 ? 0 : -1)

1188 !(
ssize_t
)(
˛õ¡
)) {

1189 
	`¶og
(
LOG_DEBUG
, "%s: sending clientÅo mother on fd %d failed: %s",

1190 
fun˘i⁄
, 
s
, 
	`°ªº‹
(
î∫o
));

1196 
	}
}

1199 
	$£nd_ªq
(
s
, 
ªq
)

1200 
s
;

1201 
sockd_ªque°_t
 *
ªq
;

1203 c⁄° *
fun˘i⁄
 = "send_req()";

1204 
iovec
 
iov
[2];

1205 
msghdr
 
msg
;

1206 
fdto£nd
, 
ioc
, 
Àngth
;

1207 #i‡
HAVE_GSSAPI


1208 
gss_buf„r_desc
 
gsßpi°©e
;

1209 
gsßpi°©emem
[
MAXGSSAPITOKENLEN
];

1211 
	`CMSG_AALLOC
(
cmsg
, ());

1213 
ioc
 = 0;

1214 
Àngth
 = 0;

1216 
	`bzîo
(
iov
, (iov));

1217 
iov
[
ioc
].
iov_ba£
 = 
ªq
;

1218 
iov
[
ioc
].
iov_Àn
 = (*
ªq
);

1219 
Àngth
 +
iov
[
ioc
].
iov_Àn
;

1220 ++
ioc
;

1222 #i‡
HAVE_GSSAPI


1223 i‡(
ªq
->
ßuth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

1224 
gsßpi°©e
.
vÆue
 = 
gsßpi°©emem
;

1225 
gsßpi°©e
.
Àngth
 = (
gsßpi°©emem
);

1227 i‡(
	`gsßpi_exp‹t_°©e
(&
ªq
->
ßuth
.
md©a
.
gsßpi
.
°©e
.
id
, &
gsßpi°©e
)

1231 
iov
[
ioc
].
iov_ba£
 = 
gsßpi°©e
.
vÆue
;

1232 
iov
[
ioc
].
iov_Àn
 = 
gsßpi°©e
.
Àngth
;

1233 
Àngth
 +
iov
[
ioc
].
iov_Àn
;

1234 ++
ioc
;

1236 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1237 
	`¶og
(
LOG_DEBUG
, "%s: gssapistateÜength is %lu",

1238 
fun˘i⁄
, ()
gsßpi°©e
.
Àngth
);

1241 
gsßpi°©e
.
vÆue
 = 
NULL
;

1242 
gsßpi°©e
.
Àngth
 = 0;

1246 
fdto£nd
 = 0;

1248 i‡(
ªq
->
s
 == -1) {

1249 #i‡
BAREFOOTD


1250 
	`SASSERT
(
ªq
->ªq.
comm™d
 =
SOCKS_UDPASSOCIATE
);

1252 
	`SERRX
(
ªq
->
s
);

1256 
	`CMSG_ADDOBJECT
(
ªq
->
s
, 
cmsg
, ‘eq->sË* 
fdto£nd
++);

1258 
	`bzîo
(&
msg
, (msg));

1259 
msg
.
msg_iov
 = 
iov
;

1260 
msg
.
msg_iovÀn
 = 
	`ELEMENTS
(
iov
);

1261 
msg
.
msg_«me
 = 
NULL
;

1263 
	`CMSG_SETHDR_SEND
(
msg
, 
cmsg
, (Ë* 
fdto£nd
);

1265 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
 && 
ªq
->
s
 != -1)

1266 
	`¶og
(
LOG_DEBUG
, "%s: sending fd %d (%s) on fd %d ...",

1267 
fun˘i⁄
, 
ªq
->
s
, 
	`sockë2°rög
‘eq->s, 
NULL
, 0), s);

1269 i‡(
	`£ndmsgn
(
s
, &
msg
, 0, 
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
 ? 0 : -1)

1270 !
Àngth
) {

1271 i‡(
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
)

1272 
	`sw¨n
("%s: sídög clõ¡Åÿchûd faûed", 
fun˘i⁄
);

1274 
	`¶og
(
	`sockd_mŸhîexi°s
(Ë? 
LOG_WARNING
 : 
LOG_DEBUG
,

1276 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

1278 #i‡
HAVE_GSSAPI


1279 i‡(
gsßpi°©e
.
vÆue
 !
NULL
) {

1281 i‡(
	`gsßpi_imp‹t_°©e
(&
ªq
->
ßuth
.
md©a
.
gsßpi
.
°©e
.
id
,

1282 &
gsßpi°©e
) != 0)

1283 
	`sw¨nx
("%s: couldÇŸÑe-imp‹àgsßpò°©e", 
fun˘i⁄
);

1291 
	}
}

1294 
	$sigchûdbrﬂdˇ°
(
sig
)

1295 
sig
;

1297 c⁄° *
fun˘i⁄
 = "sigchildbroadcast()";

1298 
chûdty≥sv
[] = { 
PROC_MONITOR
, 
PROC_NEGOTIATE
, 
PROC_REQUEST
, 
PROC_IO
 };

1299 
size_t
 *
chûdc
, 
chûdty≥c
;

1300 
sockd_chûd_t
 **
chûdv
;

1302 
chûdty≥c
 = 0; chûdty≥¯< 
	`ELEMENTS
(
chûdty≥sv
); ++childtypec) {

1303 
size_t
 
i
;

1305 i‡(
chûdty≥sv
[
chûdty≥c
] =
PROC_MONITOR


1306 && 
	`pidismŸhî
(
sockscf
.
°©e
.
pid
) != 1)

1309 
	`£tchûdty≥
(
chûdty≥sv
[
chûdty≥c
], &
chûdv
, &
chûdc
, 
NULL
);

1311 
i
 = 0; i < *
chûdc
; ++i) {

1312 
	`¶og
(
LOG_DEBUG
, "%s: sending signal %dÅo %s %ld",

1313 
fun˘i⁄
,

1314 
sig
,

1315 
	`chûdty≥2°rög
(
chûdty≥sv
[
chûdty≥c
]),

1316 ()(*
chûdv
)[
i
].
pid
);

1318 i‡(
	`kûl
((*
chûdv
)[
i
].
pid
, 
sig
) != 0) {

1319 i‡((*
chûdv
)[
i
].
waôögf‹exô
)

1320 
	`¶og
(
LOG_DEBUG
,

1323 
fun˘i⁄
, 
sig
, ()(*
chûdv
)[
i
].
pid
);

1325 
	`sw¨n
("%s: couldÇot send signal %dÅo childÖrocess %ld",

1326 
fun˘i⁄
, 
sig
, ()(*
chûdv
)[
i
].
pid
);

1330 
	}
}

1332 
size_t


1333 
	$max‰ì¶Ÿs
(
chûdty≥
)

1334 c⁄° 
chûdty≥
;

1337 
chûdty≥
) {

1338 
PROC_MONITOR
:

1341 
PROC_NEGOTIATE
:

1342  
SOCKD_NEGOTIATEMAX
;

1344 
PROC_REQUEST
:

1345  
SOCKD_REQUESTMAX
;

1347 
PROC_IO
:

1348  
SOCKD_IOMAX
;

1351 
	`SERRX
(
chûdty≥
);

1355 
	}
}

1358 
	$sockd_¥öt_chûd_ªady_mesßge
(
‰ìfds
)

1359 c⁄° 
size_t
 
‰ìfds
;

1361 c⁄° *
fun˘i⁄
 = "sockd_print_child_ready_message()";

1363 
	`¶og
(
LOG_DEBUG
,

1365 
fun˘i⁄
,

1366 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
),

1367 ()
‰ìfds
, freefds == 1 ? "" : "s",

1368 ()
	`max‰ì¶Ÿs
(
sockscf
.
°©e
.
ty≥
),

1369 
	`max‰ì¶Ÿs
(
sockscf
.
°©e
.
ty≥
) == 1 ? "" : "s");

1370 
	}
}

1373 
sockd_chûd_t
 *

1374 
	$addchûd
(
ty≥
)

1375 c⁄° 
ty≥
;

1377 c⁄° *
fun˘i⁄
 = "addchild()";

1378 (*
chûdfun˘i⁄
)();

1379 
sig£t_t
 
Æl
, 
ﬁdmask
;

1380 
sockd_mŸhî_t
 
mŸhî
;

1381 
sockd_chûd_t
 **
chûdv
;

1382 
pid_t
 
pid
;

1383 
sockÀn_t
 
›éí
;

1384 
size_t
 *
chûdc
;

1385 *
ªas⁄
;

1386 
mö
, 
rcvbuf
, 
¢dbuf
, 
rcvbuf_£t1
, 
rcvbuf_£t2
, 
¢dbuf_£t1
, 
¢dbuf_£t2
,

1387 
p
, 
›äame_¢dbuf
, 
›äame_rcvbuf
, 
ackpùev
[2], 
d©≠ùev
[2];

1389 
	`¶og
(
LOG_DEBUG
, "%s:Åy≥ i†%s", 
fun˘i⁄
, 
	`chûdty≥2°rög
(
ty≥
));

1391 i‡(
sockscf
.
°©e
.
highe°fdöu£
 == 0)

1392 
	`‰ìdes¸ùt‹s
(
NULL
, &
sockscf
.
°©e
.
highe°fdöu£
);

1397 i‡(
	`sockë∑ú
(
AF_LOCAL
, 
SOCK_DGRAM
, 0, 
d©≠ùev
) != 0) {

1398 
	`sw¨n
("%s: sockë∑ú(AF_LOCAL, SOCK_DGRAM)", 
fun˘i⁄
);

1399  
NULL
;

1403 i‡(
	`sockë∑ú
(
AF_LOCAL
, 
SOCK_STREAM
, 0, 
ackpùev
) != 0) {

1404 
	`sw¨n
("%s: sockë∑ú(AF_LOCAL, SOCK_STREAM)", 
fun˘i⁄
);

1406 
	`˛o£v
(
	`ELEMENTS
(
d©≠ùev
), datapipev);

1407  
NULL
;

1416 #i‡
HAVE_VALGRIND_VALGRIND_H


1417 i‡(
RUNNING_ON_VALGRIND
)

1418 
ªas⁄
 = "pipe between moteránd child (probable Valgrind bug)";

1420 
ªas⁄
 = "pipe between moteránd child";

1422 
ªas⁄
 = "pipe between moteránd child";

1425 i‡(
	`£ä⁄blockög
(
ackpùev
[0], 
ªas⁄
) == -1

1426 || 
	`£ä⁄blockög
(
ackpùev
[1], 
ªas⁄
) == -1

1427 || 
	`£ä⁄blockög
(
d©≠ùev
[0], 
ªas⁄
) == -1

1428 || 
	`£ä⁄blockög
(
d©≠ùev
[1], 
ªas⁄
) == -1) {

1429 #i‡
HAVE_VALGRIND_VALGRIND_H


1430 i‡(
RUNNING_ON_VALGRIND
) {

1437 i‡(
	`fdis›í
(
d©≠ùev
[0]))

1438 
	`˛o£
(
d©≠ùev
[0]);

1440 
	`sw¨n
("%s:ÖrobabÀ vÆgröd bugÅriggîed", 
fun˘i⁄
);

1442 i‡(
	`fdis›í
(
d©≠ùev
[1]))

1443 
	`˛o£
(
d©≠ùev
[1]);

1445 
	`¶og
(
LOG_NOTICE
, "%s:ÖrobabÀ vÆgröd bugÅriggîed", 
fun˘i⁄
);

1447 i‡(
	`fdis›í
(
ackpùev
[0]))

1448 
	`˛o£
(
ackpùev
[0]);

1450 
	`¶og
(
LOG_NOTICE
, "%s:ÖrobabÀ vÆgröd bugÅriggîed", 
fun˘i⁄
);

1452 i‡(
	`fdis›í
(
ackpùev
[1]))

1453 
	`˛o£
(
ackpùev
[1]);

1455 
	`¶og
(
LOG_NOTICE
, "%s:ÖrobabÀ vÆgröd bugÅriggîed", 
fun˘i⁄
);

1457  
NULL
;

1461 
	`˛o£v
(
	`ELEMENTS
(
d©≠ùev
), datapipev);

1462 
	`˛o£v
(
	`ELEMENTS
(
ackpùev
),áckpipev);

1464  
NULL
;

1473 
	`£tchûdty≥
(
ty≥
, &
chûdv
, &
chûdc
, &
chûdfun˘i⁄
)) {

1474 
PROC_MONITOR
:

1476 
¢dbuf
 = (
SOCKD_EXITNORMALLY
);

1477 
rcvbuf
 = (
SOCKD_EXITNORMALLY
);

1480 
PROC_NEGOTIATE
:

1485 
rcvbuf
 = (
	`MAX
((
sockd_˛õ¡_t
), (
sockd_ªque°_t
))

1486 + (
msghdr
)

1487 + 
	`CMSG_SPACE
(()Ë* 
FDPASS_MAX
);

1489 
rcvbuf
 +
SENDMSG_PADBYTES
;

1491 #i‡
HAVE_GSSAPI


1492 
rcvbuf
 +(
MAX_GSS_STATE
 + (
iovec
));

1495 
¢dbuf
 = 
rcvbuf
 * 
SOCKD_NEGOTIATEMAX
;

1498 
PROC_REQUEST
:

1503 
rcvbuf
 = (
	`MAX
((
sockd_ªque°_t
), (
sockd_io_t
))

1504 + (
msghdr
)

1505 + 
	`CMSG_SPACE
(()Ë* 
FDPASS_MAX
);

1507 
rcvbuf
 +
SENDMSG_PADBYTES
;

1509 #i‡
HAVE_GSSAPI


1510 
rcvbuf
 +(
MAX_GSS_STATE
 + (
iovec
));

1513 
¢dbuf
 = 
rcvbuf
 * 
SOCKD_REQUESTMAX
;

1516 
PROC_IO
:

1522 
rcvbuf
 = ((
sockd_io_t
)

1523 + (
msghdr
)

1524 + 
	`CMSG_SPACE
(()Ë* 
FDPASS_MAX
);

1526 
rcvbuf
 +
SENDMSG_PADBYTES
;

1528 #i‡
HAVE_GSSAPI


1529 
rcvbuf
 +(
MAX_GSS_STATE
 + (
iovec
));

1532 
¢dbuf
 = 
rcvbuf
 * 
SOCKD_IOMAX
;

1536 
	`SERRX
(
ty≥
);

1539 
mö
 = 
rcvbuf
;

1541 i‡(
HAVE_PIPEBUFFER_SEND_BASED
)

1543 i‡(
HAVE_PIPEBUFFER_RECV_BASED
) {

1549 c⁄° 
size_t
 
tmp
 = 
¢dbuf
;

1550 
¢dbuf
 = 
rcvbuf
;

1551 
rcvbuf
 = 
tmp
;

1553 i‡(
HAVE_PIPEBUFFER_UNKNOWN
) {

1554 
rcvbuf
 = 
	`MAX
(
¢dbuf
,Ñcvbuf);

1555 
¢dbuf
 = 
	`MAX
(¢dbuf, 
rcvbuf
);

1558 #ifde‡
SO_RCVBUFFORCE


1559 i‡(
sockscf
.
°©e
.
havïrivs
) {

1560 
›äame_rcvbuf
 = 
SO_RCVBUFFORCE
;

1561 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

1565 
›äame_rcvbuf
 = 
SO_RCVBUF
;

1567 
p
 = 
rcvbuf
;

1569 i‡(
	`£tsock›t
(
d©≠ùev
[
MOTHER
],

1570 
SOL_SOCKET
,

1571 
›äame_rcvbuf
,

1572 &
p
,

1573 (
p
)) != 0

1574 || 
	`£tsock›t
(
d©≠ùev
[
CHILD
],

1575 
SOL_SOCKET
,

1576 
›äame_rcvbuf
,

1577 &
p
,

1578 (
p
)) != 0) {

1579 
	`¶og
(
LOG_DEBUG
, "%s: couldÇot set SO_RCVBUFÅo %d: %s",

1580 
fun˘i⁄
, 
p
, 
	`°ªº‹
(
î∫o
));

1582 
p
 -
mö
;

1586 } 
p
 > 
mö
);

1588 #ifde‡
SO_RCVBUFFORCE


1589 i‡(
sockscf
.
°©e
.
havïrivs
)

1590 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

1593 
›éí
 = (
rcvbuf_£t1
);

1594 i‡(
	`gësock›t
(
d©≠ùev
[
MOTHER
],

1595 
SOL_SOCKET
,

1596 
SO_RCVBUF
,

1597 &
rcvbuf_£t1
,

1598 &
›éí
) != 0

1599 || 
	`gësock›t
(
d©≠ùev
[
CHILD
],

1600 
SOL_SOCKET
,

1601 
SO_RCVBUF
,

1602 &
rcvbuf_£t2
,

1603 &
›éí
) != 0) {

1604 
	`sw¨n
("%s: couldÇŸ gë sizêo‡SO_RCVBUF", 
fun˘i⁄
);

1606 
	`˛o£v
(
	`ELEMENTS
(
d©≠ùev
), datapipev);

1607 
	`˛o£v
(
	`ELEMENTS
(
ackpùev
),áckpipev);

1609  
NULL
;

1612 #ifde‡
SO_SNDBUFFORCE


1613 i‡(
sockscf
.
°©e
.
havïrivs
) {

1614 
›äame_¢dbuf
 = 
SO_SNDBUFFORCE
;

1615 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

1619 
›äame_¢dbuf
 = 
SO_SNDBUF
;

1621 
p
 = 
¢dbuf
;

1623 i‡(
	`£tsock›t
(
d©≠ùev
[
MOTHER
],

1624 
SOL_SOCKET
,

1625 
›äame_¢dbuf
,

1626 &
p
,

1627 (
p
)) != 0

1628 || 
	`£tsock›t
(
d©≠ùev
[
CHILD
],

1629 
SOL_SOCKET
,

1630 
›äame_¢dbuf
,

1631 &
p
,

1632 (
p
)) != 0) {

1634 
	`¶og
(
LOG_DEBUG
, "%s: couldÇot set SO_SNDBUFÅo %d: %s",

1635 
fun˘i⁄
, 
p
, 
	`°ªº‹
(
î∫o
));

1637 
p
 -
mö
;

1641 } 
p
 > 
mö
);

1643 #ifde‡
SO_SNDBUFFORCE


1644 i‡(
sockscf
.
°©e
.
havïrivs
)

1645 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

1648 
›éí
 = (
¢dbuf_£t1
);

1649 i‡(
	`gësock›t
(
d©≠ùev
[
MOTHER
],

1650 
SOL_SOCKET
,

1651 
SO_SNDBUF
,

1652 &
¢dbuf_£t1
,

1653 &
›éí
) != 0

1654 || 
	`gësock›t
(
d©≠ùev
[
CHILD
],

1655 
SOL_SOCKET
,

1656 
SO_SNDBUF
,

1657 &
¢dbuf_£t2
,

1658 &
›éí
) != 0) {

1659 
	`sw¨n
("%s: couldÇŸ gë sizêo‡SO_SNDBUF", 
fun˘i⁄
);

1661 
	`˛o£v
(
	`ELEMENTS
(
d©≠ùev
), datapipev);

1662 
	`˛o£v
(
	`ELEMENTS
(
ackpùev
),áckpipev);

1664  
NULL
;

1668 i‡(
rcvbuf_£t1
 < 
rcvbuf
 || 
rcvbuf_£t2
 <Ñcvbuf

1669 || 
¢dbuf_£t1
 < 
¢dbuf
 || 
¢dbuf_£t2
 < sndbuf) {

1670 c⁄° 
isÁèl
 = (
rcvbuf_£t1
 < 
mö
 || 
rcvbuf_£t2
 < min

1671 || 
¢dbuf_£t1
 < 
mö
 || 
¢dbuf_£t2
 < min);

1672 *
vÆue
;

1673 
loggedÆªady
;

1675 
ty≥
) {

1676 
PROC_NEGOTIATE
: {

1677 
loˇl_loggedÆªady
;

1679 
loggedÆªady
 = 
loˇl_loggedÆªady
;

1680 
loˇl_loggedÆªady
 = 1;

1682 
vÆue
 = "SOCKD_NEGOTIATEMAX";

1686 
PROC_REQUEST
: {

1687 
loˇl_loggedÆªady
;

1689 
loggedÆªady
 = 
loˇl_loggedÆªady
;

1690 
loˇl_loggedÆªady
 = 1;

1692 
vÆue
 = "SOCKD_REQUESTMAX";

1696 
PROC_IO
: {

1697 
loˇl_loggedÆªady
;

1699 
loggedÆªady
 = 
loˇl_loggedÆªady
;

1700 
loˇl_loggedÆªady
 = 1;

1702 
vÆue
 = "SOCKD_IOMAX";

1706 
PROC_MONITOR
: {

1710 
loˇl_loggedÆªady
;

1712 
loggedÆªady
 = 
loˇl_loggedÆªady
;

1713 
loˇl_loggedÆªady
 = 1;

1715 
vÆue
 = "N/A";

1720 
	`SERRX
(
ty≥
);

1727 #i‡
PRERELEASE


1728 
	`¶og
(
isÁèl
 ? 
LOG_WARNING
 : (
loggedÆªady
 ? 
LOG_DEBUG
 : 
LOG_NOTICE
),

1730 
	`¶og
(
isÁèl
 ? 
LOG_WARNING
 : (
loggedÆªady
 ? 
LOG_DEBUG
 : LOG_DEBUG),

1743 
fun˘i⁄
,

1744 
¢dbuf
, 
¢dbuf_£t1
, 
¢dbuf_£t2
,

1745 
rcvbuf
, 
rcvbuf_£t1
, 
rcvbuf_£t2
,

1746 
PRODUCT
,

1747 
vÆue
,

1748 
vÆue
,

1749 
PRODUCT
,

1750 
isÁèl
 ? "" : "We will continue withÅhe smaller buffersize,ás "

1754 i‡(
isÁèl
) {

1755 
	`˛o£v
(
	`ELEMENTS
(
d©≠ùev
), datapipev);

1756 
	`˛o£v
(
	`ELEMENTS
(
ackpùev
),áckpipev);

1758  
NULL
;

1768 
sockscf
.
°©e
.
highe°fdöu£
 = 
	`MAX
(sockscf.state.highestfdinuse,

1769 
	`MAX
(
d©≠ùev
[0], datapipev[1]));

1771 
sockscf
.
°©e
.
highe°fdöu£
 = 
	`MAX
(sockscf.state.highestfdinuse,

1772 
	`MAX
(
ackpùev
[0],áckpipev[1]));

1774 
	`¶og
(
LOG_DEBUG
, "%s: highest fd in useátÅhe moment: %d",

1775 
fun˘i⁄
, 
sockscf
.
°©e
.
highe°fdöu£
);

1782 ()
	`sigfûl£t
(&
Æl
);

1783 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
Æl
, &
ﬁdmask
) != 0)

1784 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK)", 
fun˘i⁄
);

1786 (
pid
 = 
	`f‹k
())) {

1788 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

1789 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

1791 
	`sw¨n
("%s: f‹k()", 
fun˘i⁄
);

1793 
	`˛o£v
(
	`ELEMENTS
(
d©≠ùev
), datapipev);

1794 
	`˛o£v
(
	`ELEMENTS
(
ackpùev
),áckpipev);

1796  
NULL
;

1799 
siga˘i⁄
 
siga˘
;

1800 
size_t
 
i
, 
maxfd
;

1802 #i‡
HAVE_PROFILING
 && 
HAVE_MONCONTROL


1803 
	`m⁄c⁄åﬁ
(1);

1806 
	`bzîo
(&
siga˘
, (sigact));

1815 
siga˘
.
ß_h™dÀr
 = 
SIG_IGN
;

1817 #i‡
HAVE_SIGNAL_SIGINFO


1818 i‡(
	`siga˘i⁄
(
SIGINFO
, &
siga˘
, 
NULL
) != 0)

1819 
	`sw¨n
("%s: siga˘i⁄(SIGINFO)", 
fun˘i⁄
);

1822 i‡(
	`siga˘i⁄
(
SIGUSR1
, &
siga˘
, 
NULL
) != 0)

1823 
	`sw¨n
("%s: siga˘i⁄(SIGUSR1)", 
fun˘i⁄
);

1825 i‡(
	`siga˘i⁄
(
SIGCHLD
, &
siga˘
, 
NULL
) != 0)

1826 
	`sw¨n
("%s: siga˘i⁄(SIGCHLD)", 
fun˘i⁄
);

1832 
siga˘
.
ß_Êags
 = 
SA_RESTART
 | 
SA_NOCLDSTOP
 | 
SA_SIGINFO
;

1834 
siga˘
.
ß_siga˘i⁄
 = 
sighup_chûd
;

1835 i‡(
	`siga˘i⁄
(
SIGHUP
, &
siga˘
, 
NULL
) != 0)

1836 
	`£º
("%s: couldÇŸ in°Æ»sig«lh™dÀ∏f‹ SIGHUP", 
fun˘i⁄
);

1838 
mŸhî
.
s
 = 
d©≠ùev
[
CHILD
];

1839 
mŸhî
.
ack
 = 
ackpùev
[
CHILD
];

1840 
sockscf
.
°©e
.
ty≥
 =Åype;

1842 
	`√w¥ocöô
();

1843 
	`po°c⁄figlﬂdöô
();

1846 
	`¶og
(
LOG_DEBUG
, "sleeping...");

1847 
	`¶ìp
(20);

1875 
ty≥
) {

1876 
PROC_MONITOR
:

1879 
PROC_NEGOTIATE
:

1880 #i‡
HAVE_LIBWRAP


1881 #i‡
SOCKD_NEGOTIATEMAX
 > 1

1882 
ªsidít
 = 1;

1886 #i‡
HAVE_PRIVILEGES


1887 i‡(
sockscf
.
°©e
.
havïrivs
) {

1889 
	`¥iv_dñ£t
(
sockscf
.
¥ivûeges
.
¥ivûeged
, 
PRIV_NET_PRIVADDR
);

1891 i‡(
	`£ç¥iv
(
PRIV_SET
,

1892 
PRIV_PERMITTED
,

1893 
sockscf
.
¥ivûeges
.
¥ivûeged
) != 0)

1894 
	`sw¨n
("%s: setppriv() failedÅoÑelinquish "

1896 
fun˘i⁄
);

1902 
PROC_REQUEST
:

1903 #i‡
HAVE_LIBWRAP


1904 #i‡
SOCKD_REQUESTMAX
 > 1

1905 
ªsidít
 = 1;

1910 
PROC_IO
:

1911 #i‡
HAVE_LIBWRAP


1912 #i‡
SOCKD_IOMAX
 > 1

1913 
ªsidít
 = 1;

1919 
	`SERRX
(
ty≥
);

1926 
maxfd
 = (
size_t
)
sockscf
.
°©e
.
highe°fdöu£
;

1927 
	`SASSERTX
(
maxfd
 != 0);

1929 
i
 = 0; i <
maxfd
; ++i) {

1934 i‡(
i
 =(
size_t
)
mŸhî
.
s
 || i =(size_t)mŸhî.
ack
)

1937 i‡(
	`des¸ùt‹i§e£rved
(()
i
))

1940 ()
	`˛o£
(()
i
);

1955 
	`√w¥ocöô
();

1963 
d©≠ùev
[0] = 
mŸhî
.
s
;

1964 
d©≠ùev
[1] = 
mŸhî
.
ack
;

1966 i‡((
mŸhî
.
s
 = 
	`dup
(mother.s)) == -1

1967 || (
mŸhî
.
ack
 = 
	`dup
(mother.ack)) == -1)

1968 
	`£º
("%s: faûedÅÿdup(2ËpùêtÿmŸhî", 
fun˘i⁄
);

1970 
	`˛o£
(
d©≠ùev
[0]);

1971 
	`˛o£
(
d©≠ùev
[1]);

1973 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

1974 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

1980 
	`¶og
(
LOG_DEBUG
, "%s: IámáÇew %s with data-pipe %dándáck-pipe %d",

1981 
fun˘i⁄
, 
	`chûdty≥2°rög
(
ty≥
), 
mŸhî
.
s
, mŸhî.
ack
);

1983 
sockscf
.
°©e
.
mŸhî
 = mother;

1984 
	`time_m⁄Ÿ⁄ic
(&
sockscf
.
°©
.
boŸ
);

1986 
î∫o
 = 0;

1987 
	`chûdfun˘i⁄
();

1993 
sockd_chûd_t
 *
p
;

1995 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

1996 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

1998 i‡((
p
 = 
	`ªÆloc
(*
chûdv
, (**chûdvË* (*
chûdc
 + 1))Ë=
NULL
) {

1999 
	`sw¨n
("%s: %s", 
fun˘i⁄
, 
NOMEM
);

2001 
	`˛o£v
(
	`ELEMENTS
(
d©≠ùev
), datapipev);

2002 
	`˛o£v
(
	`ELEMENTS
(
ackpùev
),áckpipev);

2004  
NULL
;

2006 *
chûdv
 = 
p
;

2008 
	`bzîo
(&((*
chûdv
)[*
chûdc
]), ((*childv)[*childc]));

2010 
	`time_m⁄Ÿ⁄ic
(&(*
chûdv
)[*
chûdc
].
¸óãd
);

2011 (*
chûdv
)[*
chûdc
].
ty≥
 =Åype;

2012 (*
chûdv
)[*
chûdc
].
pid
 =Öid;

2013 (*
chûdv
)[*
chûdc
].
s
 = 
d©≠ùev
[
MOTHER
];

2014 (*
chûdv
)[*
chûdc
].
ack
 = 
ackpùev
[
MOTHER
];

2016 
	`˛o£
(
d©≠ùev
[
CHILD
]);

2017 
	`˛o£
(
ackpùev
[
CHILD
]);

2019 
	`¶og
(
LOG_DEBUG
,

2023 
fun˘i⁄
,

2024 
	`chûdty≥2°rög
((*
chûdv
)[*
chûdc
].
ty≥
),

2025 ()(*
chûdv
)[*
chûdc
].
pid
,

2026 (*
chûdv
)[*
chûdc
].
s
,

2027 (*
chûdv
)[*
chûdc
].
ack
,

2028 
rcvbuf
, 
rcvbuf_£t1
, 
rcvbuf_£t2
,

2029 
¢dbuf
, 
¢dbuf_£t1
, 
¢dbuf_£t2
);

2031 (*
chûdv
)[*
chûdc
].
ty≥
) {

2032 
PROC_MONITOR
:

2037 (*
chûdv
)[*
chûdc
].
‰ìc
 = 1;

2040 
PROC_NEGOTIATE
:

2041 (*
chûdv
)[*
chûdc
].
‰ìc
 = 
SOCKD_NEGOTIATEMAX
;

2044 
PROC_REQUEST
:

2045 (*
chûdv
)[*
chûdc
].
‰ìc
 = 
SOCKD_REQUESTMAX
;

2048 
PROC_IO
:

2049 (*
chûdv
)[*
chûdc
].
‰ìc
 = 
SOCKD_IOMAX
;

2053 
	`SERRX
((*
chûdv
)[*
chûdc
].
ty≥
);

2058  &(*
chûdv
)[(*
chûdc
)++];

2059 
	}
}

2063 
	$£tchûdty≥
(
ty≥
, 
chûdv
, 
chûdc
, 
fun˘i⁄
)

2064 
ty≥
;

2065 
sockd_chûd_t
 ***
chûdv
;

2066 
size_t
 **
chûdc
;

2067 (**
fun˘i⁄
)();

2069 
size_t
 *
c
;

2070 
sockd_chûd_t
 **
v
;

2071 (*
f
)();

2073 
ty≥
) {

2074 
PROC_MONITOR
:

2075 
c
 = &
m⁄ô‹c
;

2076 
v
 = &
m⁄ô‹v
;

2077 
f
 = &
run_m⁄ô‹
;

2080 
PROC_NEGOTIATE
:

2081 
c
 = &
√gchûdc
;

2082 
v
 = &
√gchûdv
;

2083 
f
 = &
run_√gŸüã
;

2086 
PROC_IO
:

2087 
c
 = &
iochûdc
;

2088 
v
 = &
iochûdv
;

2089 
f
 = &
run_io
;

2092 
PROC_REQUEST
:

2093 
c
 = &
ªqchûdc
;

2094 
v
 = &
ªqchûdv
;

2095 
f
 = &
run_ªque°
;

2099 
	`SERRX
(
ty≥
);

2102 i‡(
chûdv
 !
NULL
)

2103 *
chûdv
 = 
v
;

2105 i‡(
chûdc
 !
NULL
)

2106 *
chûdc
 = 
c
;

2108 i‡(
fun˘i⁄
 !
NULL
)

2109 *
fun˘i⁄
 = 
f
;

2111 
	`SASSERTX
(
c
 !
NULL
);

2112 
	`SASSERTX
(
v
 !
NULL
);

2113 
	`SASSERTX
(
f
 !
NULL
);

2115  
ty≥
;

2116 
	}
}

2118 
ssize_t


2119 
	$födchûd
(
pid
, 
chûdc
, 
chûdv
)

2120 
pid_t
 
pid
;

2121 
size_t
 
chûdc
;

2122 c⁄° 
sockd_chûd_t
 *
chûdv
;

2124 
size_t
 
i
;

2126 i‡(
i
 < 
chûdc
 && 
chûdv
[i].
pid
 ==Öid)

2127  
i
;

2129 
i
 = 0; i < 
chûdc
; ++i)

2130 i‡(
chûdv
[
i
].
pid
 ==Öid)

2131  
i
;

2134 
	}
}

2139 
	$sighup_chûd
(
sig
, 
si
, 
sc
)

2140 
sig
;

2141 
sigöfo_t
 *
si
;

2142 *
sc
;

2144 c⁄° *
fun˘i⁄
 = "sighup_child()";

2145 c⁄° 
î∫o_s
 = 
î∫o
;

2146 
c⁄fig
 *
shmemc⁄fig
, config;

2147 
±rdiff_t
 
off£t
;

2148 #i‡
DIAGNOSTIC


2149 
size_t
 
i
;

2152 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

2160 i‡(
si
->
si_pid
 != 0

2161 && !
	`pidismŸhî
(
si
->
si_pid
)) {

2162 
	`sw¨nx
("%s:Ñeceived SIGHUP fromÖid %ld, but onlyÉxpecting it from "

2164 
fun˘i⁄
, ()
si
->
si_pid
, ()
	`gëµid
());

2169 i‡(
sockscf
.
shmemöfo
->
c⁄figsize
 == 0) {

2170 
	`sw¨nx
("%s: Strange. Receivedá SIGHUP signal, butÅhe size of "

2173 
fun˘i⁄
);

2177 
	`¶og
(
LOG_INFO
, "%s:Ñe˚ived SIGHUP:Ññﬂdög c⁄fig", 
fun˘i⁄
);

2179 
	`socks_lock
(
sockscf
.
shmemc⁄figfd
, 0, 0, 0, 1);

2182 
shmemc⁄fig
 = 
	`sockd_mm≠
(
NULL
,

2183 
sockscf
.
shmemöfo
->
c⁄figsize
,

2188 
PROT_READ
 | 
PROT_WRITE
,

2189 
MAP_PRIVATE
,

2190 
sockscf
.
shmemc⁄figfd
,

2194 
shmemc⁄fig
 = 
	`mm≠
((*)((
uöçå_t
)
sockscf
.
shmemöfo
->
c⁄fig


2195 + 
sockscf
.
°©e
.
∑gesize
),

2196 
sockscf
.
shmemöfo
->
c⁄figsize
,

2201 
PROT_READ
 | 
PROT_WRITE
,

2202 
MAP_PRIVATE
 | 
MAP_FIXED
,

2203 
sockscf
.
shmemc⁄figfd
,

2207 i‡(
shmemc⁄fig
 =
MAP_FAILED
) {

2208 
	`sw¨n
("%s: couldÇot mmap(2) %lu bytes of memory for configÑeload",

2209 
fun˘i⁄
, ()
sockscf
.
shmemöfo
->
c⁄figsize
);

2211 
	`socks_u∆ock
(
sockscf
.
shmemc⁄figfd
, 0, 0);

2215 
off£t
 = (
uöçå_t
)
shmemc⁄fig
 - (uöçå_t)
sockscf
.
shmemöfo
->
c⁄fig
;

2217 
	`¶og
(
LOG_DEBUG
,

2220 
fun˘i⁄
,

2221 ()
sockscf
.
shmemöfo
->
c⁄figsize
,

2222 
shmemc⁄fig
,

2223 
sockscf
.
shmemöfo
->
c⁄fig
,

2224 ()
off£t
);

2230 
c⁄fig
 = *
shmemc⁄fig
;

2232 i‡(
	`poöãr_c›y
(
shmemc⁄fig
, 
off£t
, &
c⁄fig
, 
NULL
, 0) != 0) {

2233 
	`sw¨nx
("%s: couldÇot updateÖointers in config-objectáfterÑeload",

2234 
fun˘i⁄
);

2236 i‡(
	`munm≠
(
shmemc⁄fig
, 
sockscf
.
shmemöfo
->
c⁄figsize
) != 0)

2237 
	`sw¨n
("%s: munmap(%p, %lu) failed",

2238 
fun˘i⁄
,

2239 
shmemc⁄fig
,

2240 ()
sockscf
.
shmemöfo
->
c⁄figsize
);

2242 
	`socks_u∆ock
(
sockscf
.
shmemc⁄figfd
, 0, 0);

2247 #i‡
DIAGNOSTIC


2248 
	`¶og
(
LOG_DEBUG
, "%s: upd©ed c⁄fig, doög com∑ªÅe° ...", 
fun˘i⁄
);

2249 
i
 = 
	`com∑ªc⁄figs
(
shmemc⁄fig
, &
c⁄fig
);

2252 i‡(
	`munm≠
(
shmemc⁄fig
, 
sockscf
.
shmemöfo
->
c⁄figsize
) != 0)

2253 
	`sw¨n
("%s: munmap(%p, %lu) failed",

2254 
fun˘i⁄
,

2255 
shmemc⁄fig
,

2256 ()
sockscf
.
shmemöfo
->
c⁄figsize
);

2258 #i‡
DIAGNOSTIC


2259 i‡(
i
 == 0) {

2260 
	`sw¨nx
("%s: cª©ed c⁄figÇŸ idítiˇ»tÿc⁄fig i¿shmem", 
fun˘i⁄
);

2264 
	`¶og
(
LOG_DEBUG
,

2266 
fun˘i⁄
, ()
i
);

2269 
	`socks_u∆ock
(
sockscf
.
shmemc⁄figfd
, 0, 0);

2271 
	`SASSERTX
(!
	`pidismaömŸhî
(
sockscf
.
°©e
.
pid
));

2273 
	`SASSERTX
(
c⁄fig
.
°©e
.
ty≥
 =
sockscf
.state.type);

2275 
	`ª£tc⁄fig
(&
sockscf
, 0);

2277 
	`SASSERTX
(
c⁄fig
.
°©e
.
ty≥
 =
sockscf
.state.type);

2283 
	`sockd_‰ìlogobje˘
(&
sockscf
.
îæog
, 1);

2284 
	`sockd_ª›ílogfûes
(&
c⁄fig
.
îæog
, 0);

2286 
	`sockd_‰ìlogobje˘
(&
sockscf
.
log
, 1);

2287 
	`sockd_ª›ílogfûes
(&
c⁄fig
.
log
, 0);

2289 
sockscf
 = 
c⁄fig
;

2291 #i‡
DIAGNOSTIC


2296 
	`SASSERTX
(
	`com∑ªc⁄figs
(&
sockscf
, &
c⁄fig
) != 0);

2299 
	`po°c⁄figlﬂdöô
();

2301 i‡(
	`pidismŸhî
(
sockscf
.
°©e
.
pid
))

2302 
	`sigchûdbrﬂdˇ°
(
sig
);

2304 
	`ª£çrivûeges
();

2306 
	`time_m⁄Ÿ⁄ic
(&
sockscf
.
°©
.
c⁄figlﬂd
);

2308 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

2309 
	}
}

	@sockd/sockd_icmp.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 
‰ìfds
;

52 
	$£nd_icm≥º‹
(
s
, 
ª˚ived⁄addr
, 
‹igöÆ∑ckë§c
, 
∑ckëèrgë
,

53 
ùÀn
, 
ud∂í
, 
ty≥
, 
code
)

54 
s
;

55 c⁄° 
sockaddr_°‹age
 *
ª˚ived⁄addr
;

56 c⁄° 
sockaddr_°‹age
 *
‹igöÆ∑ckë§c
;

57 c⁄° 
sockaddr_°‹age
 *
∑ckëèrgë
;

58 c⁄° 
ùÀn
;

59 c⁄° 
ud∂í
;

60 c⁄° 
ty≥
;

61 c⁄° 
code
;

63 c⁄° *
fun˘i⁄
 = "send_icmperror()";

64 
sockÀn_t
 
Àn
;

65 
ù
 *ip;

66 
icmp
 *icmp;

67 
udphdr
 *
udp
;

68 
ssize_t
 
rc
;

69 
p°r
[
MAXSOCKADDRSTRING
], 
l°r
[MAXSOCKADDRSTRING],

70 
t°r
[
MAXSOCKADDRSTRING
];

72 
d©a
[
MIN_ICMPUNREACHLEN
];

73 
icmp
 icmp;

74 
ù
 ip;

75 } 
∑ckë
;

77 
	`¶og
(
LOG_DEBUG
,

81 
fun˘i⁄
,

82 
ty≥
,

83 
code
,

84 
s
,

85 
‹igöÆ∑ckë§c
 =
NULL
 ?

86 "0.0.0.0" : 
	`sockaddr2°rög
(
‹igöÆ∑ckë§c
, 
p°r
, (pstr)),

87 
∑ckëèrgë
 =
NULL
 ?

88 "0.0.0.0" : 
	`sockaddr2°rög
(
∑ckëèrgë
, 
t°r
, (tstr)),

89 
ùÀn
,

90 
ud∂í
,

91 
ª˚ived⁄addr
 =
NULL
 ?

92 "0.0.0.0" : 
	`sockaddr2°rög
(
ª˚ived⁄addr
, 
l°r
, (lstr)));

94 i‡(
s
 == -1) {

95 
	`¶og
(
LOG_DEBUG
,

97 
fun˘i⁄
,

98 
‹igöÆ∑ckë§c
 =
NULL
 ?

99 "0.0.0.0" : 
	`sockaddr2°rög
(
‹igöÆ∑ckë§c
, 
p°r
, (pstr)));

104 i‡(
‹igöÆ∑ckë§c
 =
NULL


105 || 
ª˚ived⁄addr
 =
NULL


106 || 
∑ckëèrgë
 =
NULL
)

109 
Àn
 = 
	`ßÀn
(
‹igöÆ∑ckë§c
->
ss_Ámûy
);

111 i‡(
‹igöÆ∑ckë§c
->
ss_Ámûy
 !
AF_INET
) {

112 
	`¶og
(
LOG_DEBUG
,

114 
fun˘i⁄
,

115 
	`sockaddr2°rög
(
‹igöÆ∑ckë§c
, 
NULL
, 0),

116 
	`ßÁmûy2°rög
(
‹igöÆ∑ckë§c
->
ss_Ámûy
));

121 
icmp
 = (icm∞*)&
∑ckë
.icmp;

122 
icmp
->
icmp_ty≥
 = 
ty≥
;

123 
icmp
->
icmp_code
 = 
code
;

124 
icmp
->
icmp_cksum
 = 0;

127 
	`bzîo
((*)
icmp
 + 4, 4);

128 
ù
 = (ù *)
icmp
->
icmp_d©a
;

129 
ù
->
ù_hl
 = 
MIN_IPHLEN
 >> 2;

130 
ù
->
ù_v
 = 4;

131 
ù
->
ù_tos
 = 0;

132 
ù
->
ù_Àn
 = 
	`ht⁄s
(
ùÀn
 =-1 ? 
MIN_IPHLEN
 : iplen);

133 
ù
->
ù_id
 = 0;

134 
ù
->
ù_off
 = 0;

135 
ù
->
ù_âl
 = 1;

136 
ù
->
ù_p
 = 
IPPROTO_UDP
;

137 
ù
->
ù_sum
 = 0;

138 
ù
->
ù_§c
 = 
	`TOCIN
(
‹igöÆ∑ckë§c
)->
sö_addr
;

139 
ù
->
ù_d°
 = 
	`TOCIN
(
ª˚ived⁄addr
)->
sö_addr
;

140 
ù
->
ù_sum
 = 
	`ö_cksum
((
uöt16_t
 *)ip, (*ip));

142 
udp
 = (
udphdr
 *)((*)
icmp
 + 8 + (
ù
->
ù_hl
 << 2));

143 *
	`udphdr_uh_•‹t
(
udp
Ë
	`TOCIN
(
‹igöÆ∑ckë§c
)->
sö_p‹t
;

144 *
	`udphdr_uh_dp‹t
(
udp
Ë
	`TOCIN
(
ª˚ived⁄addr
)->
sö_p‹t
;

145 *
	`udphdr_uh_uÀn
(
udp
Ë
	`ht⁄s
(
ud∂í
 =-1 ? 
MIN_UDPLEN
 : udplen);

146 *
	`udphdr_uh_sum
(
udp
) = 0;

148 
icmp
->
icmp_cksum
 = 
	`ö_cksum
((
uöt16_t
 *)icmp, (
∑ckë
));

150 i‡((
rc
 = 
	`£ndto
(
s
,

151 &
∑ckë
.
d©a
,

152 (
∑ckë
.
d©a
),

154 
	`TOCSA
(
‹igöÆ∑ckë§c
),

155 
Àn
)Ë!(
∑ckë
))

156 
	`sw¨n
("%s: couldÇot sendÑawÖacket ofÜength %luÅo %s. Sent %ld",

157 
fun˘i⁄
,

158 ()(
∑ckë
),

159 
	`sockaddr2°rög
(
‹igöÆ∑ckë§c
, 
NULL
, 0),

160 ()
rc
);

162 
	`¶og
(
LOG_DEBUG
, "%s: sentÑawÖacket ofÜength %luÅo %s",

163 
fun˘i⁄
,

164 ()(
∑ckë
),

165 
	`sockaddr2°rög
(
‹igöÆ∑ckë§c
, 
NULL
, 0));

166 
	}
}

168 #i‡
BAREFOOTD


169 
øwsockë°©us_t


170 
	$øwsockë_ªcv
(
s
, 
ioc
, 
iov
)

171 c⁄° 
s
;

172 c⁄° 
size_t
 
ioc
;

173 
sockd_io_t
 
iov
[];

175 c⁄° *
fun˘i⁄
 = "rawsocket_recv()";

176 c⁄° 
size_t
 
maxôî©i⁄s
 = 10;

177 
øwsockë°©us_t
 
rc
;

179 
d©a
[
MAX_IPHLEN
 + 
MAX_ICMPUNREACHLEN
];

180 
ù
 ip;

181 
icmp
 icmp;

182 } 
∑ckë
;

183 
ud±¨gë_t
 *
˛õ¡
;

184 
icmp
 *icmp;

185 
ù
 *ip;

186 
udphdr
 *
udp
;

187 
sockaddr_°‹age
 
‰om
, 
§ˇddr
, 
d°addr
;

188 
sockÀn_t
 
addæí
;

189 
ssize_t
 
r
;

190 
size_t
 
ioi
, 
ôî©i⁄s
;

191 
‰om°r
[
MAXSOCKADDRSTRING
],

192 
§c°r
[
MAXSOCKADDRSTRING
], 
d°°r
[MAXSOCKADDRSTRING];

193 
£nd_icmp_to_˛õ¡
 = 0, 
£nd_icmp_to_èrgë
 = 0;

195 
rc
 = 
RAWSOCKET_NOP
;

196 
ôî©i⁄s
 = 0; iãøti⁄†< 
maxôî©i⁄s
; ++iterations) {

197 
addæí
 = (
‰om
);

198 i‡((
r
 = 
	`ªcv‰om
(
s
,

199 &
∑ckë
.
d©a
,

200 (
∑ckë
.
d©a
),

202 
	`TOSA
(&
‰om
),

203 &
addæí
)) == -1) {

204 i‡(!
	`ERRNOISTMP
(
î∫o
))

205 
	`sw¨n
("%s:Ñecv‰om(Ë⁄Ñaw sockë (fd %dËÁûed", 
fun˘i⁄
, 
s
);

210 i‡(
r
 < 
MIN_IPHLEN
 + 
MIN_ICMPUNREACHLEN
) {

211 
	`¶og
(
LOG_DEBUG
,

214 
fun˘i⁄
,

215 
	`sockaddr2°rög
(&
‰om
, 
NULL
, 0),

216 ()
r
,

217 ()(
MIN_IPHLEN
 + 
MIN_ICMPUNREACHLEN
));

222 
ù
 = &
∑ckë
.ip;

223 i‡(
r
 < (
ù
->
ù_hl
 << 2)) {

224 
	`sw¨n
("%s: strange ... kernel says ip headerÜength inÅheÖacket "

227 
fun˘i⁄
,

228 
	`sockaddr2°rög
(&
‰om
, 
NULL
, 0),

229 ()(
ù
->
ù_hl
 << 2),

230 ()
r
,

231 ()(
∑ckë
));

236 
icmp
 = (icm∞*)(
∑ckë
.
d©a
 + (
ù
->
ù_hl
 << 2));

237 i‡(
r
 - (
ù
->
ù_hl
 << 2Ë< 
MIN_ICMPUNREACHLEN
) {

238 
	`¶og
(
LOG_DEBUG
,

241 
fun˘i⁄
,

242 
	`sockaddr2°rög
(&
‰om
, 
NULL
, 0),

243 ()(
r
 - (
ù
->
ù_hl
 << 2)),

244 ()
MIN_ICMPUNREACHLEN
);

250 
ù
 = (ù *)(
icmp
->
icmp_d©a
);

252 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

253 
	`¶og
(
LOG_DEBUG
,

256 
fun˘i⁄
,

257 
	`öë_¡›
(
‰om
.
ss_Ámûy
,

258 
	`GET_SOCKADDRADDR
(&
‰om
),

259 
‰om°r
,

260 (
‰om°r
)),

261 
icmp
->
icmp_ty≥
,

262 
icmp
->
icmp_code
,

263 ()
ù
->
ù_p
,

264 ()
r
,

265 ()(
ù
->
ù_hl
 << 2),

266 ()(
r
 - (
ù
->
ù_hl
 << 2)));

268 i‡(
icmp
->
icmp_ty≥
 !
ICMP_UNREACH
)

271 i‡(
ù
->
ù_p
 !
IPPROTO_UDP
)

274 
	`bzîo
(&
§ˇddr
, (srcaddr));

275 
	`SET_SOCKADDR
(&
§ˇddr
, 
AF_INET
);

276 
d°addr
 = 
§ˇddr
;

278 
udp
 = (
udphdr
 *)((*)
ù
 + (ù->
ù_hl
 << 2));

279 
	`TOIN
(&
§ˇddr
)->
sö_addr
 = 
ù
->
ù_§c
;

280 
	`TOIN
(&
§ˇddr
)->
sö_p‹t
 = *
	`udphdr_uh_•‹t
(
udp
);

281 
	`TOIN
(&
d°addr
)->
sö_addr
 = 
ù
->
ù_d°
;

282 
	`TOIN
(&
d°addr
)->
sö_p‹t
 = *
	`udphdr_uh_dp‹t
(
udp
);

284 
	`¶og
(
LOG_DEBUG
, "%s: icmpÖacket is inÑelationÅoÖacket from %sÅo %s",

285 
fun˘i⁄
,

286 
	`sockaddr2°rög
(&
§ˇddr
, 
§c°r
, (srcstr)),

287 
	`sockaddr2°rög
(&
d°addr
, 
d°°r
, (dststr)));

303 
˛õ¡
 = 
NULL
;

304 
ioi
 = 0; ioò< 
ioc
; ++ioi) {

305 
size_t
 
d°i
;

307 i‡(
iov
[
ioi
].
°©e
.
¥Ÿocﬁ
 !
SOCKS_UDP
)

313 i‡((
˛õ¡
 = 
	`˛õ¡of˛õ¡addr
(&
d°addr
,

314 
iov
[
ioi
].
d°
.
d°c
,

315 
iov
[
ioi
].
d°
.
d°v
)Ë!
NULL
) {

316 c⁄° 
m©ches
 = 
	`sockaddøªeq
(&
§ˇddr
, &
iov
[
ioi
].
§c
.
œddr
, 0);

318 
	`¶og
(
LOG_DEBUG
,

321 
fun˘i⁄
,

322 
	`sockaddr2°rög
(&
d°addr
, 
d°°r
, (dststr)),

323 
	`sockaddr2°rög
(&
§ˇddr
, 
§c°r
, (srcstr)),

324 
m©ches
 ? "also matches" : "however doesÇot");

326 i‡(
m©ches
) {

327 
£nd_icmp_to_èrgë
 = 1;

331 
˛õ¡
 = 
NULL
;

334 
	`SASSERTX
(
˛õ¡
 =
NULL
);

339 
d°i
 = 0; d°ò< 
iov
[
ioi
].
d°
.
d°c
; ++dsti) {

340 
	`SASSERTX
(
iov
[
ioi
].
d°
.
d°v
[
d°i
].
s
 != -1);

342 i‡(!
	`sockaddøªeq
(&
iov
[
ioi
].
d°
.
d°v
[
d°i
].
øddr
, &
d°addr
, 0))

345 i‡(!
	`sockaddøªeq
(&
§ˇddr
, &
iov
[
ioi
].
d°
.
d°v
[
d°i
].
œddr
, 0))

348 
˛õ¡
 = &
iov
[
ioi
].
d°
.
d°v
[
d°i
];

352 i‡(
˛õ¡
 !
NULL
) {

353 
	`SASSERTX
(
d°i
 < 
iov
[
ioi
].
d°
.
d°c
);

354 
£nd_icmp_to_˛õ¡
 = 1;

359 i‡(
˛õ¡
 !
NULL
) {

360 
sockaddr_°‹age
 *
ª˚ived⁄addr
, *
icm±¨gëaddr
;

362 
	`SASSERTX
(
ioi
 < 
ioc
);

364 
	`SASSERTX
(
£nd_icmp_to_˛õ¡
 || 
£nd_icmp_to_èrgë
);

365 
	`SASSERTX
(!(
£nd_icmp_to_˛õ¡
 && 
£nd_icmp_to_èrgë
));

367 
	`io_syncudp
(&
iov
[
ioi
], 
˛õ¡
);

369 i‡(
£nd_icmp_to_èrgë
) {

373 
	`SASSERTX
(
	`sockaddøªeq
(&
§ˇddr
, &
iov
[
ioi
].
§c
.
œddr
, 0));

374 
	`SASSERTX
(
	`sockaddøªeq
(&
d°addr
, &
˛õ¡
->client, 0));

375 
ª˚ived⁄addr
 = &
iov
[
ioi
].
d°
.
œddr
;

376 
icm±¨gëaddr
 = &
iov
[
ioi
].
d°
.
øddr
;

382 
	`SASSERTX
(
£nd_icmp_to_˛õ¡
);

384 
	`SASSERTX
(
	`sockaddøªeq
(&
§ˇddr
, &
iov
[
ioi
].
d°
.
œddr
, 0));

385 
	`SASSERTX
(
	`sockaddøªeq
(&
d°addr
, &
iov
[
ioi
].
d°
.
øddr
, 0));

386 
ª˚ived⁄addr
 = &
iov
[
ioi
].
§c
.
œddr
;

387 
icm±¨gëaddr
 = &
iov
[
ioi
].
§c
.
øddr
;

390 
	`¶og
(
LOG_DEBUG
, "%s:ÖacketÑeceived from %s isÑelatedÅo client %s",

391 
fun˘i⁄
,

392 
	`sockaddr2°rög
(&
‰om
, 
‰om°r
, (fromstr)),

393 
	`sockaddr2°rög
(&
iov
[
ioi
].
§c
.
øddr
, 
NULL
, 0));

395 
	`£nd_icm≥º‹
(
s
,

396 
ª˚ived⁄addr
,

397 
icm±¨gëaddr
,

398 &
d°addr
,

399 
	`¡ohs
(
ù
->
ù_Àn
),

400 
	`¡ohs
(*
	`udphdr_uh_uÀn
(
udp
)),

401 
icmp
->
icmp_ty≥
,

402 
icmp
->
icmp_code
);

404 
	`¶og
(
LOG_DEBUG
, "%s:Ñemoving client %s from iov #%lu",

405 
fun˘i⁄
,

406 
	`sockaddr2°rög
(&
iov
[
ioi
].
§c
.
øddr
, 
NULL
, 0),

407 ()
ioi
);

409 
	`io_dñëe
(-1 , &
iov
[
ioi
], 
˛õ¡
->
s
, 
IO_CLOSE
);

410 
rc
 = 
RAWSOCKET_IO_DELETED
;

415 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

416 
	`¶og
(
LOG_DEBUG
,

419 
fun˘i⁄
,

420 
	`sockaddr2°rög
(&
‰om
, 
‰om°r
, (fromstr)),

421 
	`sockaddr2°rög
(&
§ˇddr
, 
§c°r
, (srcstr)),

422 
	`sockaddr2°rög
(&
d°addr
, 
d°°r
, (dststr)));

426  
rc
;

427 
	}
}

	@sockd/sockd_io.c

46 
	~"comm⁄.h
"

47 
	~"c⁄fig_∑r£.h
"

49 c⁄° 
	grcsid
[] =

61 #i‡
HAVE_UDP_SUPPORT


63 
	#UDP_INITIALCLIENTCOUNT
 (16Ë

	)

70 #i‡
BAREFOOTD


71 
	#RAW_SOCKETBUFFER
 (100 * 1000Ë

	)

74 
sigöfo
(
sig
, 
sigöfo_t
 *
si
, *
sc
);

75 
¥o˘ôÀupd©e
();

78 
io_c⁄√˘isö¥ogªss
(c⁄° 
sockd_io_t
 *
io
);

86 
size_t


87 
io_Æloˇãd
(
size_t
 *
t˝_io
, size_à*
t˝_fd
, size_à*
udp_io
, size_à*
udp_fd
);

101 
sockd_io_t
 *

102 
io_gë£t
(c⁄° 
nfds
, c⁄° 
fd_£t
 *
£t
);

115 
sockd_io_t
 *

116 
io_föddes¸ùt‹
(
d
);

122 
io_fûl£t
(
fd_£t
 *
£t
, 
™tiÊags
, fd_£à*
™tiÊags_£t
,

123 
timevÆ
 *
bwovîÊowtû
);

144 
io_fûl£t_c⁄√˘ö¥ogªss
(
fd_£t
 *
£t
);

155 
io_˛ór£t
(c⁄° 
sockd_io_t
 *
io
, c⁄° 
˛óøŒèrgës
, 
fd_£t
 *
£t
);

164 #i‡
HAVE_UDP_SUPPORT


176 
	gøwsockë
 = -1;

181 
io_timeouti•ossibÀ
(c⁄° 
sockd_io_t
 *
io
);

190 
time_t


191 
io_timeu¡ûtimeout
(
sockd_io_t
 *
io
, c⁄° 
timevÆ
 *
äow
,

192 
timeouây≥_t
 *
ty≥
, c⁄° 
doudpsync
);

209 
timevÆ
 *

210 
io_gëtimeout
(
timevÆ
 *
timeout
);

221 
sockd_io_t
 *

222 
io_gëtimedout
();

233 
gë√wios
();

240 
‰ìbuf„rs
(c⁄° 
sockd_io_t
 *
io
);

246 
c⁄√˘°©us
(
sockd_io_t
 *
io
, *
badfd
);

265 #i‡
SOCKS_SERVER


282 
ruÀ_t
 
	gfwdruÀv
[
SOCKD_IOMAX
];

283 
ruÀ_t
 
	gª∂yruÀv
[
SOCKD_IOMAX
];

289 
ud±¨gë_t
 
	gud±¨gëv
[
SOCKD_IOMAX
][2];

294 
	#IO_CLEAR_ALL_SETS
(
io
, 
˛óøŒèrgës
) \

296 
	`io_˛ór£t
((
io
), (
˛óøŒèrgës
), 
buffw£t
); \

297 
	`io_˛ór£t
((
io
), (
˛óøŒèrgës
), 
bu‰£t
); \

298 
	`io_˛ór£t
((
io
), (
˛óøŒèrgës
), 
√wr£t
); \

299 
	`io_˛ór£t
((
io
), (
˛óøŒèrgës
), 
r£t
); \

300 
	`io_˛ór£t
((
io
), (
˛óøŒèrgës
), 
tmp£t
); \

301 
	`io_˛ór£t
((
io
), (
˛óøŒèrgës
), 
ud¥£t
); \

302 
	`io_˛ór£t
((
io
), (
˛óøŒèrgës
), 
w£t
); \

303 
	`io_˛ór£t
((
io
), (
˛óøŒèrgës
), 
x£t
); \

304 }  0)

	)

306 
sockd_io_t
 
	giov
[
SOCKD_IOMAX
];

307 c⁄° 
size_t
 
	gioc
 = 
ELEMENTS
(
iov
);

308 
io°©e_t
 
	gio°©e
;

317 
timevÆ
 
	gbwovîÊowtû
;

320 
	$run_io
()

322 c⁄° *
fun˘i⁄
 = "run_io()";

323 
siga˘i⁄
 
siga˘
;

324 
fd_£t
 *
r£t
, *
w£t
, *
x£t
, *
√wr£t
, *
tmp£t
, *
bu‰£t
, *
buffw£t
, *
ud¥£t
,

325 *
zîo£t
;

326 
p
, 
mayhavëimedout
;

327 #i‡
DIAGNOSTIC
 && 0

328 
size_t
 
‰ìfds_öôüŒy
, 
logfds_öôüŒy
;

331 
	`bzîo
(&
siga˘
, (sigact));

332 
siga˘
.
ß_Êags
 = 
SA_RESTART
 | 
SA_NOCLDSTOP
 | 
SA_SIGINFO
;

333 
siga˘
.
ß_siga˘i⁄
 = 
sigöfo
;

335 #i‡
HAVE_SIGNAL_SIGINFO


336 i‡(
	`siga˘i⁄
(
SIGINFO
, &
siga˘
, 
NULL
) != 0)

337 
	`£º
("%s: siga˘i⁄(SIGINFO)", 
fun˘i⁄
);

341 i‡(
	`siga˘i⁄
(
SIGUSR1
, &
siga˘
, 
NULL
) != 0)

342 
	`£º
("%s: siga˘i⁄(SIGUSR1)", 
fun˘i⁄
);

344 #i‡
HAVE_UDP_SUPPORT


345 
	`sockd_¥iv
(
SOCKD_PRIV_NET_ICMPACCESS
, 
PRIV_ON
);

346 i‡((
øwsockë
 = 
	`sockë
(
AF_INET
, 
SOCK_RAW
, 
IPPROTO_ICMP
)) == -1)

347 
	`¶og
(
BAREFOOTD
 ? 
LOG_NOTICE
 : 
LOG_DEBUG
,

350 
fun˘i⁄
);

352 
	`¶og
(
LOG_DEBUG
, "%s: cª©edÑaw sockë, fd %d", 
fun˘i⁄
, 
øwsockë
);

353 
	`sockd_¥iv
(
SOCKD_PRIV_NET_ICMPACCESS
, 
PRIV_OFF
);

355 i‡(
øwsockë
 != -1)

356 i‡(
	`£ä⁄blockög
(
øwsockë
, "rawsocket") == -1)

357 
	`£º
("%s: couldÇŸ makêøwsockëÇ⁄-blockög", 
fun˘i⁄
);

359 #i‡
HAVE_PRIVILEGES


362 i‡(
sockscf
.
°©e
.
havïrivs
) {

363 
	`¥iv_dñ£t
(
sockscf
.
¥ivûeges
.
¥ivûeged
, 
PRIV_NET_ICMPACCESS
);

364 i‡(
	`£ç¥iv
(
PRIV_SET
, 
PRIV_PERMITTED
, 
sockscf
.
¥ivûeges
.
¥ivûeged
)

366 
	`sw¨n
("%s: setppriv()ÅoÑelinquish PRIV_NET_ICMPACCESS failed",

367 
fun˘i⁄
);

371 #i‡
BAREFOOTD


372 i‡(
øwsockë
 != -1) {

373 
sockÀn_t
 
›éí
 = (
p
);

374 i‡(
	`gësock›t
(
øwsockë
, 
SOL_SOCKET
, 
SO_RCVBUF
, &
p
, &
›éí
) != 0)

375 
	`sw¨n
("%s: gësock›t(SO_RCVBUF)", 
fun˘i⁄
);

377 i‡(
p
 < 
RAW_SOCKETBUFFER
) {

378 
p
 = 
RAW_SOCKETBUFFER
;

379 i‡(
	`£tsock›t
(
øwsockë
, 
SOL_SOCKET
, 
SO_RCVBUF
, &
p
, (p))

381 
	`sw¨n
("%s: failed setsockopt(SO_RCVBUF, %d) onÑaw socket",

382 
fun˘i⁄
, 
p
);

384 
	`¶og
(
LOG_DEBUG
, "%s: changed buffer sizeÅo %d bytes",

385 
fun˘i⁄
, 
p
);

388 
	`¶og
(
LOG_DEBUG
, "%s: default buffer size is %d bytes, keeping it",

389 
fun˘i⁄
, 
p
);

395 
buffw£t
 = 
	`Æloˇã_maxsize_fd£t
();

396 
bu‰£t
 = 
	`Æloˇã_maxsize_fd£t
();

397 
√wr£t
 = 
	`Æloˇã_maxsize_fd£t
();

398 
r£t
 = 
	`Æloˇã_maxsize_fd£t
();

399 
tmp£t
 = 
	`Æloˇã_maxsize_fd£t
();

400 
ud¥£t
 = 
	`Æloˇã_maxsize_fd£t
();

401 
w£t
 = 
	`Æloˇã_maxsize_fd£t
();

402 
x£t
 = 
	`Æloˇã_maxsize_fd£t
();

403 
zîo£t
 = 
	`Æloˇã_maxsize_fd£t
();

405 
	`FD_ZERO
(
zîo£t
);

407 
	`¥o˘ôÀupd©e
();

409 
io°©e
.
‰ìfds
 = (
size_t
)
	`‰ìdes¸ùt‹s
(
NULL
, NULL);

411 
mayhavëimedout
 = 0;

413 
	`sockd_¥öt_chûd_ªady_mesßge
(
io°©e
.
‰ìfds
);

415 #i‡
DIAGNOSTIC
 && 0

416 
‰ìfds_öôüŒy
 = 
io°©e
.
‰ìfds
;

417 
logfds_öôüŒy


418 
sockscf
.
log
.
fûíoc
 + (sockscf.log.
ty≥
 & 
LOGTYPE_SYSLOG
)

419 + 
sockscf
.
îæog
.
fûíoc
 + (sockscf.îæog.
ty≥
 & 
LOGTYPE_SYSLOG
);

461 
io°©us_t
 
io°©us
;

462 
sockd_io_t
 *
io
;

463 
timevÆ
 
timeout
, *
timeouçoöãr
;

464 
i
, 
bôs
, 
fú°_rbôs
, 
rbôs
, 
wbôs
, 
ud¥bôs
,

465 
√wsockësc⁄√˘ed
, 
badfd
;

467 #i‡
DIAGNOSTIC
 && 0

468 
size_t
 
t˝fd
, 
udpfd
, 
‰ìfds_now
, 
logfds_now
;

470 
	`io_Æloˇãd
(
NULL
, &
t˝fd
, NULL, &
udpfd
);

472 
logfds_now


473 
sockscf
.
log
.
fûíoc
 + (sockscf.log.
ty≥
 & 
LOGTYPE_SYSLOG
)

474 + 
sockscf
.
îæog
.
fûíoc
 + (sockscf.îæog.
ty≥
 & 
LOGTYPE_SYSLOG
);

476 
‰ìfds_now
 = (
size_t
)
	`‰ìdes¸ùt‹s
(
NULL
, NULL);

478 
	`SASSERTX
(
‰ìfds_now
 - 
logfds_now


479 >
‰ìfds_öôüŒy
 - 
logfds_öôüŒy
 - (
t˝fd
 + 
udpfd
));

482 
î∫o
 = 0;

485 i‡(
mayhavëimedout
) {

486 (
io
 = 
	`io_gëtimedout
()Ë!
NULL
) {

487 #i‡
HAVE_NEGOTIATE_PHASE


488 i‡(
	`io_c⁄√˘isö¥ogªss
(
io
)

489 && (
SOCKS_SERVER
 || 
io
->
ªqÊags
.
hâpc⁄√˘
)) {

490 
ª•⁄£_t
 
ª•⁄£
;

492 
	`¸óã_ª•⁄£
(
NULL
,

493 &
io
->
§c
.
auth
,

494 
io
->
°©e
.
¥oxy¥Ÿocﬁ
,

495 ()
	`sockscode
(
io
->
°©e
.
¥oxy¥Ÿocﬁ
,

496 
SOCKS_TTLEXPIRED
),

497 &
ª•⁄£
);

499 i‡(
	`£nd_ª•⁄£
(
io
->
§c
.
s
, &
ª•⁄£
) != 0)

500 
î∫o
 = 0;

504 
	`io_dñëe
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
io
, -1, 
IO_TIMEOUT
);

508 
mayhavëimedout
 = 0;

509 
rbôs
 = 
	`io_fûl£t
(
r£t
, 
MSG_OOB
, 
x£t
, &
bwovîÊowtû
);

520 
	`FD_COPY
(
buffw£t
, 
r£t
);

523 
	`FD_COPY
(
bu‰£t
, 
r£t
);

525 i‡(
sockscf
.
°©e
.
mŸhî
.
s
 != -1) {

526 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
s
, 
r£t
);

527 
rbôs
 = 
	`MAX
‘bôs, 
sockscf
.
°©e
.
mŸhî
.
s
);

530 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
r£t
);

531 
rbôs
 = 
	`MAX
‘bôs, 
sockscf
.
°©e
.
mŸhî
.
ack
);

534 i‡(
rbôs
 =-1 && !
	`timîis£t
(&
bwovîÊowtû
)) {

536 
	`SASSERTX
(
	`io_Æloˇãd
(
NULL
, NULL, NULL, NULL) == 0);

538 
	`¶og
(
LOG_DEBUG
, "%s:Ço connectionÅo mother,Ço clients;Éxiting",

539 
fun˘i⁄
);

541 #i‡
HAVE_VALGRIND_VALGRIND_H


542 i‡(
RUNNING_ON_VALGRIND
) {

544 
	`‰ì
(
r£t
);

548 
	`sockdexô
(
EXIT_SUCCESS
);

552 #i‡
BAREFOOTD


553 i‡(
øwsockë
 !-1 && (
	`io_udp˛õ¡s
(
ioc
, 
iov
, 1) > 0)) {

556 
	`FD_SET
(
øwsockë
, 
r£t
);

557 
rbôs
 = 
	`MAX
‘bôs, 
øwsockë
);

574 
wbôs
 = 
	`io_fûl£t_c⁄√˘ö¥ogªss
(
w£t
);

575 
√wsockësc⁄√˘ed
 = 0;

576 
bôs
 = 
	`MAX
(
rbôs
, 
wbôs
) + 1;

578 
	`¶og
(
LOG_DEBUG
, "%s: fú° sñe˘;ÑódabÀ/c⁄√˘ed?", 
fun˘i⁄
);

579 
	`£À˘n
(
bôs
,

580 
r£t
,

581 
bu‰£t
,

582 
buffw£t
,

583 
w£t
,

584 
x£t
,

585 
	`io_gëtimeout
(&
timeout
))) {

587 i‡(
î∫o
 =
EINTR
)

590 
	`SERR
(
î∫o
);

594 
mayhavëimedout
 = 1;

598 i‡(
sockscf
.
°©e
.
mŸhî
.
ack
 != -1

599 && 
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
r£t
)) {

600 
	`sockd_ªadmŸhîsc⁄åﬁsockë
(
fun˘i⁄
, 
sockscf
.
°©e
.
mŸhî
.
ack
);

601 
sockscf
.
°©e
.
mŸhî
.
s
 = sockscf.°©e.mŸhî.
ack
 = -1;

603 #i‡
BAREFOOTD


610 
	`io_ªmove_£ssi⁄
(
ioc
, 
iov
, 
NULL
, 
SOCKS_UDP
, 
IO_ADMINTERMINATION
);

611 
	`¥o˘ôÀupd©e
();

634 i‡(
sockscf
.
°©e
.
mŸhî
.
s
 != -1

635 && 
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
s
, 
r£t
)) {

636 i‡(
	`gë√wios
() == -1)

639 
	`¥o˘ôÀupd©e
();

648 
fú°_rbôs
 = 
bôs
;

653 i‡(
	`FD_CMP
(
zîo£t
, 
w£t
) != 0) {

654 
p
 = 0;Ö < 
bôs
; ++p) {

655 i‡(
	`FD_ISSET
(
p
, 
w£t
)) {

657 
io
 = 
	`io_föddes¸ùt‹
(
p
);

658 
	`SASSERTX
(
io
 !
NULL
);

659 
	`SASSERTX
(
p
 =
io
->
d°
.
s
);

661 i‡(
	`c⁄√˘°©us
(
io
, &
badfd
) == 0)

662 ++
√wsockësc⁄√˘ed
;

664 
	`SASSERTX
(
badfd
 != -1);

665 
	`SASSERTX
(
badfd
 =
io
->
§c
.
s


666 || 
badfd
 =
io
->
d°
.
s


667 || 
badfd
 =
io
->
c⁄åﬁ
.
s
);

669 
	`IO_CLEAR_ALL_SETS
(
io
, 1);

670 
	`io_dñëe
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
io
, 
badfd
, 
IO_IOERROR
);

675 i‡(
√wsockësc⁄√˘ed
 > 0)

676 
	`¥o˘ôÀupd©e
();

678 
	`¶og
(
LOG_DEBUG
, "%s: %dÇew socket%s finished connecting",

679 
fun˘i⁄
,

680 
√wsockësc⁄√˘ed
,

681 
√wsockësc⁄√˘ed
 == 1 ? "" : "s");

688 
	`fd£t›
(
bôs
, '|', 
r£t
, 
bu‰£t
,Ñset);

690 #i‡
BAREFOOTD


691 i‡(
øwsockë
 !-1 && 
	`FD_ISSET
‘awsockë, 
r£t
)) {

692 
	`FD_CLR
(
øwsockë
, 
r£t
);

694 i‡(
	`øwsockë_ªcv
(
øwsockë
, 
ioc
, 
iov
Ë=
RAWSOCKET_IO_DELETED
)

715 
i
 = 
	`io_fûl£t
(
tmp£t
, 0, 
NULL
, &
bwovîÊowtû
);

716 
rbôs
 = 
	`fd£t›
(
i
, '^', 
r£t
, 
tmp£t
, 
√wr£t
);

718 i‡(
sockscf
.
°©e
.
mŸhî
.
s
 != -1) {

719 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
s
, 
√wr£t
);

720 
rbôs
 = 
	`MAX
‘bôs, 
sockscf
.
°©e
.
mŸhî
.
s
);

723 
	`SASSERTX
(
sockscf
.
°©e
.
mŸhî
.
ack
 != -1);

724 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
√wr£t
);

725 
rbôs
 = 
	`MAX
‘bôs, 
sockscf
.
°©e
.
mŸhî
.
ack
);

728 #i‡
BAREFOOTD


733 i‡(
øwsockë
 != -1) {

734 
	`FD_SET
(
øwsockë
, 
√wr£t
);

735 
rbôs
 = 
	`MAX
‘bôs, 
øwsockë
);

748 
	`FD_ZERO
(
ud¥£t
);

749 
ud¥bôs
 = -1;

760 
wbôs
 = 
	`io_fûl£t_c⁄√˘ö¥ogªss
(
w£t
);

762 
p
 = 0;Ö < 
	`MAX
(
bôs
, 
fú°_rbôs
); ++p) {

763 
sockëto£t
;

765 i‡(
	`FD_ISSET
(
p
, 
buffw£t
)) {

773 
Ÿhî_side
;

775 
io
 = 
	`io_föddes¸ùt‹
(
p
);

777 
	`SASSERTX
(
io
 !
NULL
);

778 
	`SASSERTX
(
	`socks_buf„rhasbyãs
(
p
, 
WRITE_BUF
));

779 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
);

781 i‡(
p
 =
io
->
§c
.
s
)

782 
Ÿhî_side
 = 
io
->
d°
.
s
;

783 i‡(
p
 =
io
->
d°
.
s
)

784 
Ÿhî_side
 = 
io
->
§c
.
s
;

786 
	`SERRX
(
p
);

788 
	`¶og
(
LOG_DEBUG
,

791 
fun˘i⁄
, 
p
, 
Ÿhî_side
);

793 
	`FD_SET
(
Ÿhî_side
, 
r£t
);

794 
rbôs
 = 
	`MAX
(
Ÿhî_side
,Ñbits);

810 
	`FD_SET
(
p
, 
w£t
);

811 
wbôs
 = 
	`MAX
(wbôs, 
p
);

818 
io
 = 
NULL
;

821 i‡(!
	`FD_ISSET
(
p
, 
r£t
))

828 i‡(
io
 =
NULL
)

829 
io
 = 
	`io_föddes¸ùt‹
(
p
);

831 
	`SASSERTX
(
io
 !
NULL
);

837 
sockëto£t
 = -1;

854 i‡(
p
 =
io
->
§c
.
s
 ||Ö =io->
d°
.s) {

855 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
) {

862 
sockëto£t
 = 
p
;

864 
	`FD_SET
(
sockëto£t
, 
ud¥£t
);

865 
ud¥bôs
 = 
	`MAX
(ud¥bôs, 
sockëto£t
);

873 i‡(
p
 =
io
->
§c
.
s
) {

877 
sockëto£t
 = 
io
->
d°
.
s
;

880 
	`SASSERTX
(
p
 =
io
->
d°
.
s
);

884 
sockëto£t
 = 
io
->
§c
.
s
;

887 
	`SASSERTX
(
sockëto£t
 != -1);

889 
	`FD_SET
(
sockëto£t
, 
w£t
);

890 
wbôs
 = 
	`MAX
(wbôs, 
sockëto£t
);

893 #i‡
HAVE_CONTROL_CONNECTION


902 
ssize_t
 
r
;

903 
buf
[1024];

905 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 =
p
);

906 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 !io->
§c
.s);

907 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 !io->
d°
.s);

909 
sockëto£t
 = 
io
->
c⁄åﬁ
.
s
;

911 
	`SASSERTX
(
io
->
°©e
.
comm™d
 =
SOCKS_UDPASSOCIATE


912 || (
io
->
°©e
.
comm™d
 =
SOCKS_BINDREPLY


913 && 
io
->
°©e
.
exãnsi⁄
.
böd
));

919 
r
 = 
	`socks_ªcv‰om
(
io
->
c⁄åﬁ
.
s
,

920 
buf
,

921 (
buf
),

923 
NULL
,

924 
NULL
,

925 
NULL
,

926 &
io
->
c⁄åﬁ
.
auth
);

928 i‡(
r
 <= 0) {

929 
	`¶og
(
LOG_DEBUG
,

931 
fun˘i⁄
,

932 
	`sockaddr2°rög
(&
	`CONTROLIO
(
io
)->
øddr
, 
NULL
, 0),

933 
r
 =0 ? "EOF" : 
	`°ªº‹
(
î∫o
));

935 i‡(
io
->
§uÀ
.
m°©s_shmid
 != 0

936 && (
io
->
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)) {

937 
˛õ¡öfo_t
 
cöfo
;

939 
cöfo
.
‰om
 = 
io
->
c⁄åﬁ
.
øddr
;

940 
	`HOSTIDCOPY
(&
io
->
°©e
, &
cöfo
);

942 
	`SASSERTX
(!
io
->
c⁄åﬁ
.
°©e
.
Æ¨mdisc⁄√˘d⁄e
);

943 
	`Æ¨m_add_disc⁄√˘
(0,

944 &
io
->
§uÀ
,

945 
ALARM_INTERNAL
,

946 &
cöfo
,

947 
r
 =0 ? "EOF" : 
	`°ªº‹
(
î∫o
),

948 
sockscf
.
shmemfd
);

950 
io
->
c⁄åﬁ
.
°©e
.
Æ¨mdisc⁄√˘d⁄e
 = 1;

953 
	`IO_CLEAR_ALL_SETS
(
io
, 1);

955 
	`io_dñëe
(
sockscf
.
°©e
.
mŸhî
.
ack
,

956 
io
,

957 
io
->
c⁄åﬁ
.
s
,

958 
r
 =0 ? 
IO_CLOSE
 : 
IO_IOERROR
);

961 
visbuf
[256];

963 
	`¶og
(
LOG_NOTICE
, "%s: %ld unexpected byte%s over control "

965 
fun˘i⁄
,

966 ()
r
,

967 
r
 == 1 ? "" : "s",

968 
	`sockaddr2°rög
(&
	`CONTROLIO
(
io
)->
øddr
, 
NULL
, 0),

969 
	`°r2vis
(
buf
,

970 (
size_t
)
r
,

971 
visbuf
,

972 (
visbuf
)));

974 
	`FD_CLR
(
io
->
c⁄åﬁ
.
s
, 
r£t
);

976 
	`FD_SET
(
io
->
c⁄åﬁ
.
s
, 
√wr£t
);

977 
rbôs
 = 
	`MAX
‘bôs, 
io
->
c⁄åﬁ
.
s
);

982 
	`SASSERTX
(
sockëto£t
 != -1);

985 i‡(
√wsockësc⁄√˘ed
 || 
ud¥bôs
 > -1) {

990 
timeouçoöãr
 = &
timeout
;

991 
	`bzîo
(
timeouçoöãr
, (*timeoutpointer));

994 
timeouçoöãr
 = 
	`io_gëtimeout
(&
timeout
);

996 ++
rbôs
;

997 ++
wbôs
;

999 
bôs
 = 
	`MAX
(
rbôs
, 
wbôs
);

1001 i‡(
bôs
 == 0) {

1002 
	`¶og
(
LOG_DEBUG
,

1003 "%s:Çÿfd†tÿ£À˘(2Ë⁄ ...Ñe°¨tögÜo›", 
fun˘i⁄
);

1008 i‡(
	`FD_CMP
(
zîo£t
, 
√wr£t
) == 0

1009 && 
	`FD_CMP
(
zîo£t
, 
w£t
) == 0) {

1010 
	`¶og
(
LOG_DEBUG
,

1011 "%s:Çÿfd†tÿ£À˘(2Ë⁄ ...Ñe°¨tögÜo›", 
fun˘i⁄
);

1016 
	`¶og
(
LOG_DEBUG
, "%s: sec⁄d sñe˘; wh© i†wrôabÀ?", 
fun˘i⁄
);

1017 
	`£À˘n
(
bôs
, 
√wr£t
, 
NULL
, NULL, 
w£t
, NULL, 
timeouçoöãr
)) {

1019 i‡(
î∫o
 =
EINTR
)

1022 
	`SERR
(-1);

1026 
mayhavëimedout
 = 1;

1029 i‡(
sockscf
.
°©e
.
mŸhî
.
ack
 != -1

1030 && 
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
√wr£t
))

1033 i‡(
sockscf
.
°©e
.
mŸhî
.
s
 != -1

1034 && 
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
s
, 
√wr£t
)) {

1035 
	`FD_CLR
(
sockscf
.
°©e
.
mŸhî
.
s
, 
√wr£t
);

1036 
	`gë√wios
();

1042 
p
 = 0;Ö < 
rbôs
; ++p) {

1043 i‡(!
	`FD_ISSET
(
p
, 
√wr£t
))

1046 #i‡
BAREFOOTD


1048 i‡(
øwsockë
 !-1 && 
p
 ==Ñawsocket)

1052 
io
 = 
	`io_föddes¸ùt‹
(
p
);

1053 
	`SASSERTX
(
io
 !
NULL
);

1055 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP


1056 && (
p
 =
io
->
§c
.
s
 ||Ö =io->
d°
.s)) {

1057 
	`FD_SET
(
p
, 
ud¥£t
);

1058 
ud¥bôs
 = 
	`MAX
(ud¥bôs, 
p
);

1061 
	`FD_CLR
(
p
, 
√wr£t
);

1097 #i‡
HAVE_UDP_SUPPORT


1102 ++
ud¥bôs
;

1104 (
io
 = 
	`io_gë£t
(
ud¥bôs
, 
ud¥£t
)Ë!
NULL
) {

1105 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
);

1144 #i‡
BAREFOOTD


1145 i‡(
	`FD_ISSET
(
io
->
§c
.
s
, 
ud¥£t
)) {

1161 
io
->
d°
.
s
 = -1;

1162 
io°©us
 = 
	`doio_udp
(
io
, 
ud¥£t
, &
badfd
);

1164 i‡(
	`IOSTATUS_FATALERROR
(
io°©us
Ë&& 
badfd
 != -1) {

1165 i‡(
io
->
d°
.
s
 != -1)

1166 
	`FD_CLR
(
io
->
d°
.
s
, 
ud¥£t
);

1168 
	`io_dñëe
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
io
, 
badfd
, 
io°©us
);

1170 } 
io°©us
 !
IO_EAGAIN


1171 && 
io
->
d°
.
d°c
 > 0);

1173 i‡(
io
->
§c
.
s
 != -1)

1174 
	`FD_CLR
(
io
->
§c
.
s
, 
ud¥£t
);

1180 
	`SASSERTX
(
io
->
d°
.
s
 != -1);

1186 
	`SASSERTX
(!
	`FD_ISSET
(
io
->
§c
.
s
, 
ud¥£t
));

1188 
io°©us
 = 
	`doio_udp
(
io
, 
ud¥£t
, &
badfd
);

1190 i‡(
io
->
d°
.
s
 != -1)

1191 
	`FD_CLR
(
io
->
d°
.
s
, 
ud¥£t
);

1193 i‡(
	`IOSTATUS_FATALERROR
(
io°©us
Ë&& 
badfd
 != -1)

1194 
	`io_dñëe
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
io
, 
badfd
, 
io°©us
);

1210 
io°©us
 = 
	`doio_udp
(
io
, 
ud¥£t
, &
badfd
);

1212 
	`io_˛ór£t
(
io
, 
	`IOSTATUS_FATALERROR
(
io°©us
), 
ud¥£t
);

1214 i‡(
	`IOSTATUS_FATALERROR
(
io°©us
))

1215 
	`io_dñëe
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
io
, 
badfd
, 
io°©us
);

1227 
	`FD_ZERO
(
tmp£t
);

1228 (
io
 = 
	`io_gë£t
(
bôs
, 
w£t
)Ë!
NULL
) {

1229 
Êags
;

1231 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
);

1233 i‡(
io
->
°©e
.
comm™d
 =
SOCKS_CONNECT


1234 && !
io
->
d°
.
°©e
.
isc⁄√˘ed
) {

1236 
	`SASSERTX
(
	`FD_ISSET
(
io
->
d°
.
s
, 
w£t
));

1237 
	`FD_CLR
(
io
->
d°
.
s
, 
w£t
);

1239 i‡(
	`c⁄√˘°©us
(
io
, &
badfd
) == -1) {

1240 
	`SASSERTX
(
badfd
 =
io
->
§c
.
s
 || badfd =io->
d°
.s);

1241 
	`io_dñëe
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
io
, 
badfd
, 
IO_IOERROR
);

1254 i‡(
	`FD_CMP
(
tmp£t
, 
x£t
) != 0

1255 && (
	`FD_ISSET
(
io
->
§c
.
s
, 
x£t
Ë|| FD_ISSET(io->
d°
.s, xset)))

1256 
Êags
 = 
MSG_OOB
;

1258 
Êags
 = 0;

1260 
io°©us
 = 
	`doio_t˝
(
io
, 
r£t
, 
w£t
, 
Êags
, &
badfd
);

1262 
	`io_˛ór£t
(
io
, 
	`IOSTATUS_FATALERROR
(
io°©us
), 
r£t
);

1263 
	`io_˛ór£t
(
io
, 
	`IOSTATUS_FATALERROR
(
io°©us
), 
w£t
);

1265 i‡(
	`IOSTATUS_FATALERROR
(
io°©us
))

1266 
	`io_dñëe
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
io
, 
badfd
, 
io°©us
);

1269 #i‡
BAREFOOTD


1273 i‡(
øwsockë
 !-1 && 
	`FD_ISSET
‘awsockë, 
√wr£t
)) {

1274 
	`FD_CLR
(
øwsockë
, 
√wr£t
);

1275 ()
	`øwsockë_ªcv
(
øwsockë
, 
ioc
, 
iov
);

1288 
	}
}

1291 
	$io_¥ec⁄figlﬂd
()

1293 c⁄° *
fun˘i⁄
 = "io_preconfigload()";

1295 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

1296 
	}
}

1299 
	$io_po°c⁄figlﬂd
()

1301 c⁄° *
fun˘i⁄
 = "io_postconfigload()";

1302 
size_t
 
i
;

1304 
	`¶og
(
LOG_DEBUG
, "%s: io¯%ld", 
fun˘i⁄
, ()
ioc
);

1306 
i
 = 0; i < 
ioc
; ++i) {

1307 i‡(!
iov
[
i
].
Æloˇãd
)

1310 
	`io_upd©em⁄ô‹
(&
iov
[
i
]);

1312 i‡(
iov
[
i
].
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
)

1315 
	`SASSERTX
(
iov
[
i
].
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
);

1325 #i‡!
BAREFOOTD


1326 
iov
[
i
].
§c
.
°©e
.
u£_ßved_§uÀ
 = 0;

1327 
iov
[
i
].
d°
.
°©e
.
u£_ßved_§uÀ
 = 0;

1335 
	`¶og
(
LOG_DEBUG
, "%s: iov #%ld, dstc = %ld",

1336 
fun˘i⁄
, ()
ioc
, ()
iov
[
i
].
d°
.
d°c
);

1340 #i‡
BAREFOOTD


1349 
	`io_ªmove_£ssi⁄
(
ioc
,

1350 
iov
,

1351 &
ﬁdöã∫Æ
.
addrv
[
i
].
addr
,

1352 
ﬁdöã∫Æ
.
addrv
[
i
].
¥Ÿocﬁ
,

1353 
IO_ADMINTERMINATION
);

1354 
	`¥o˘ôÀupd©e
();

1357 
	}
}

1360 
	$˛o£_iodes¸ùt‹s
(
io
)

1361 c⁄° 
sockd_io_t
 *
io
;

1363 c⁄° *
fun˘i⁄
 = "close_iodescriptors()";

1364 
size_t
 
i
;

1365 
î∫o_s
, 
fdv
[] = { 
io
->
c⁄åﬁ
.
s
, io->
§c
.s, io->
d°
.s, -1 };

1367 #i‡
SOCKS_SERVER


1368 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
) {

1373 c⁄° 
size_t
 
d°off£t
 = 2;

1375 
	`SASSERTX
(
io
->
d°
.
d°c
 <= 2);

1377 
i
 = 0; i < 
io
->
d°
.
d°c
; ++i)

1378 
fdv
[
d°off£t
 + 
i
] = 
io
->
d°
.
d°v
[i].
s
;

1380 
i
 = 
d°off£t
 + i; i < 
	`ELEMENTS
(
fdv
); ++i)

1381 
fdv
[
i
] = -1;

1385 
î∫o_s
 = 
î∫o
;

1387 
i
 = 0; i < 
	`ELEMENTS
(
fdv
); ++i) {

1388 i‡(
fdv
[
i
] != -1) {

1389 i‡(
	`˛o£
(
fdv
[
i
]) == 0) {

1390 ++
io°©e
.
‰ìfds
;

1391 
fdv
[
i
] = -1;

1394 
	`SWARN
(
fdv
[
i
]);

1398 
î∫o
 = 
î∫o_s
;

1399 
	}
}

1402 
	$ªcv_io
(
s
, 
io
)

1403 
s
;

1404 
sockd_io_t
 *
io
;

1406 c⁄° *
fun˘i⁄
 = "recv_io()";

1407 #i‡
HAVE_GSSAPI


1408 
gss_buf„r_desc
 
gsßpi°©e
;

1409 
gsßpi°©emem
[
MAX_GSS_STATE
];

1411 
iovec
 
iovecv
[2];

1412 
timevÆ
 
äow
;

1413 
msghdr
 
msg
;

1414 
sockd_io_t
 
tmpio
;

1415 
ssize_t
 
ª˚ived
;

1416 
size_t
 
ioi
;

1417 
wóªchûd
, 
fdex≥˘
, 
fdª˚ived
, 
iovecc
;

1418 
	`CMSG_AALLOC
(
cmsg
, (Ë* 
FDPASS_MAX
);

1420 
	`bzîo
(
iovecv
, (iovecv));

1421 
iovecc
 = 0;

1423 
iovecv
[
iovecc
].
iov_ba£
 = &
tmpio
;

1424 
iovecv
[
iovecc
].
iov_Àn
 = (
tmpio
);

1425 ++
iovecc
;

1427 #i‡
HAVE_GSSAPI


1428 
iovecv
[
iovecc
].
iov_ba£
 = 
gsßpi°©emem
;

1429 
iovecv
[
iovecc
].
iov_Àn
 = (
gsßpi°©emem
);

1430 ++
iovecc
;

1433 
	`bzîo
(&
msg
, (msg));

1434 
msg
.
msg_iov
 = 
iovecv
;

1435 
msg
.
msg_iovÀn
 = 
iovecc
;

1436 
msg
.
msg_«me
 = 
NULL
;

1437 
msg
.
msg_«mñí
 = 0;

1440 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

1442 i‡(
io
 =
NULL
)

1443 
wóªchûd
 = 1;

1445 
wóªchûd
 = 0;

1447 
	`¶og
(
LOG_DEBUG
, "%s: %s",

1448 
fun˘i⁄
, 
wóªchûd
 ? "weáre child" : "weáre mother");

1450 i‡((
ª˚ived
 = 
	`ªcvmsgn
(
s
, &
msg
, 0)Ë< (
ssize_t
)(*
io
)) {

1451 i‡(
ª˚ived
 =-1 && 
î∫o
 =
EAGAIN
)

1454 
	`¶og
(
LOG_DEBUG
, "%s:Ñecvmsg(): unexpected shortÑead on socket "

1456 
fun˘i⁄
,

1457 
s
,

1458 ()
ª˚ived
,

1459 ()((*
io
)),

1460 
	`°ªº‹
(
î∫o
));

1465 i‡(
	`socks_msgha£º‹s
(
fun˘i⁄
, &
msg
))

1471 
ioi
 = 0;

1472 i‡(
wóªchûd
) {

1473 
	`SASSERTX
(
io
 =
NULL
);

1475 ; 
ioi
 < 
ioc
; ++ioi)

1476 i‡(!
iov
[
ioi
].
Æloˇãd
) {

1477 
io
 = &
iov
[
ioi
];

1481 i‡(
io
 =
NULL
) {

1487 
buf
;

1489 i‡(
	`ªcv
(
s
, &
buf
, (buf), 
MSG_PEEK
) > 0)

1494 
	`SERRX
(
	`io_Æloˇãd
(
NULL
, NULL, NULL, NULL));

1500 
	`SASSERTX
(
tmpio
.
Æloˇãd
 == 0);

1501 *
io
 = 
tmpio
;

1503 
	`SASSERTX
(
io
->
¸uÀ
.
bw
 =
NULL
);

1504 
	`SASSERTX
(
io
->
¸uÀ
.
ss
 =
NULL
);

1505 
	`SASSERTX
(
io
->
§uÀ
.
bw
 =
NULL
);

1506 
	`SASSERTX
(
io
->
§uÀ
.
ss
 =
NULL
);

1509 
io
->
°©e
.
comm™d
) {

1510 
SOCKS_BIND
:

1511 
SOCKS_BINDREPLY
:

1512 i‡(
io
->
°©e
.
exãnsi⁄
.
böd
)

1513 
fdex≥˘
 = 3;

1515 
fdex≥˘
 = 2;

1518 
SOCKS_CONNECT
:

1519 
fdex≥˘
 = 2;

1522 #i‡
HAVE_UDP_SUPPORT


1523 
SOCKS_UDPASSOCIATE
:

1525 #i‡
BAREFOOTD


1526 
fdex≥˘
 = 1;

1529 
fdex≥˘
 = 2;

1537 
	`SERRX
(
io
->
°©e
.
comm™d
);

1540 i‡(!
	`CMSG_RCPTLEN_ISOK
(
msg
, (Ë* 
fdex≥˘
)) {

1541 
	`sw¨nx
("%s:Ñeceived control message hasÅhe invalidÜen of %d",

1542 
fun˘i⁄
, ()
	`CMSG_TOTLEN
(
msg
));

1551 
	`SASSERTX
(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET
);

1552 
	`SASSERTX
(
cmsg
->
cmsg_ty≥
 =
SCM_RIGHTS
);

1554 
fdª˚ived
 = 0;

1556 
	`CMSG_GETOBJECT
(
io
->
§c
.
s
, 
cmsg
, (io->§c.sË* 
fdª˚ived
++);

1558 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
)

1559 
	`CMSG_GETOBJECT
(
io
->
d°
.
s
, 
cmsg
, (io->d°.sË* 
fdª˚ived
++);

1561 #i‡
DIAGNOSTIC


1562 
	`checksock›ti⁄s
(
io
->
§c
.
s
,

1563 
io
->
§c
.
œddr
.
ss_Ámûy
,

1564 
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ? 
SOCK_STREAM
 : 
SOCK_DGRAM
,

1567 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
)

1568 
	`checksock›ti⁄s
(
io
->
d°
.
s
, io->d°.
œddr
.
ss_Ámûy
, 
SOCK_STREAM
, 0);

1571 #i‡
HAVE_GSSAPI


1572 
gsßpi°©e
.
vÆue
 = 
gsßpi°©emem
;

1573 
gsßpi°©e
.
Àngth
 = 
ª˚ived
 - (*
io
);

1575 i‡(
gsßpi°©e
.
Àngth
 > 0)

1576 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1577 
	`¶og
(
LOG_DEBUG
, "%s:Ñead gssapistate of size %ld",

1578 
fun˘i⁄
, ()
gsßpi°©e
.
Àngth
);

1582 
io
->
°©e
.
comm™d
) {

1583 
SOCKS_BINDREPLY
:

1584 #i‡
HAVE_GSSAPI


1585 i‡(
io
->
d°
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

1586 i‡(
	`gsßpi_imp‹t_°©e
(&
io
->
d°
.
auth
.
md©a
.
gsßpi
.
°©e
.
id
,

1587 &
gsßpi°©e
) != 0)

1592 i‡(
io
->
°©e
.
exãnsi⁄
.
böd
) {

1593 
	`CMSG_GETOBJECT
(
io
->
c⁄åﬁ
.
s
,

1594 
cmsg
,

1595 (
io
->
c⁄åﬁ
.
s
Ë* 
fdª˚ived
++);

1597 #i‡
DIAGNOSTIC


1598 
	`checksock›ti⁄s
(
io
->
c⁄åﬁ
.
s
,

1599 
io
->
c⁄åﬁ
.
œddr
.
ss_Ámûy
,

1600 
SOCK_STREAM
,

1606 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 == -1);

1609 
SOCKS_CONNECT
:

1610 #i‡
HAVE_GSSAPI


1611 i‡(
io
->
§c
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

1612 i‡(
	`gsßpi_imp‹t_°©e
(&
io
->
§c
.
auth
.
md©a
.
gsßpi
.
°©e
.
id
,

1613 &
gsßpi°©e
) != 0)

1618 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 == -1);

1621 
SOCKS_UDPASSOCIATE
:

1622 #i‡
SOCKS_SERVER


1624 
	`CMSG_GETOBJECT
(
io
->
c⁄åﬁ
.
s
,

1625 
cmsg
,

1626 (
io
->
c⁄åﬁ
.
s
Ë* 
fdª˚ived
++);

1628 #i‡
HAVE_GSSAPI


1629 i‡(
io
->
§c
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

1630 i‡(
	`gsßpi_imp‹t_°©e
(&
io
->
§c
.
auth
.
md©a
.
gsßpi
.
°©e
.
id
,

1631 &
gsßpi°©e
) != 0)

1637 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 == -1);

1641 
	`SASSERTX
(
io
->
d°
.
s
 == -1);

1645 
	`SERRX
(
io
->
°©e
.
comm™d
);

1648 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
) {

1649 #i‡
DIAGNOSTIC


1650 
sockaddr_°‹age
 
addr
;

1651 
sockÀn_t
 
Àn
;

1653 
size_t
 
bufu£d
;

1654 
buf
[1024];

1656 
bufu£d
 = 0;

1658 
bufu£d
 +=

1659 
	`¢¥ötf
(&
buf
[
bufu£d
], (buf) - bufused,

1662 
fdª˚ived
,

1663 
io
->
°©e
.
comm™d
,

1664 
io
->
c⁄åﬁ
.
s
,

1665 
io
->
§c
.
s
,

1666 
io
->
d°
.
s
,

1667 ()
ioi
);

1669 
bufu£d
 +=

1670 
	`¢¥ötf
(&
buf
[
bufu£d
], (buf) - bufused,

1671 "§¯fd %d (%s)", 
io
->
§c
.
s
, 
	`sockë2°rög
(io->§c.s, 
NULL
, 0));

1673 
bufu£d
 +=

1674 
	`¢¥ötf
(&
buf
[
bufu£d
], (buf) - bufused,

1676 
io
->
d°
.
s
,

1677 
io
->
d°
.
s
 =-1 ? "N/A" : 
	`sockë2°rög
(io->d°.s, 
NULL
, 0));

1679 i‡(
io
->
c⁄åﬁ
.
s
 != -1) {

1680 
bufu£d
 +=

1681 
	`¢¥ötf
(&
buf
[
bufu£d
], (buf) - bufused,

1683 
io
->
c⁄åﬁ
.
s
, 
	`sockë2°rög
(io->c⁄åﬁ.s, 
NULL
, 0));

1686 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
buf
);

1688 #i‡
DIAGNOSTIC


1689 
Àn
 = (
addr
);

1690 i‡(
	`gësock«me
(
io
->
§c
.
s
, 
	`TOSA
(&
addr
), &
Àn
) == 0

1691 && 
	`IPADDRISBOUND
(&
addr
))

1692 
	`SASSERTX
(
	`sockaddøªeq
(&
io
->
§c
.
œddr
, &
addr
, 0));

1694 i‡(
io
->
§c
.
°©e
.
isc⁄√˘ed
) {

1695 
Àn
 = (
addr
);

1696 i‡(
	`gë≥î«me
(
io
->
§c
.
s
, 
	`TOSA
(&
addr
), &
Àn
) == 0

1697 && 
	`IPADDRISBOUND
(&
addr
))

1698 
	`SASSERTX
(
	`sockaddøªeq
(&
io
->
§c
.
øddr
, &
addr
, 0));

1701 i‡(
io
->
d°
.
s
 != -1) {

1702 
Àn
 = (
addr
);

1703 i‡(
	`gësock«me
(
io
->
d°
.
s
, 
	`TOSA
(&
addr
), &
Àn
) == 0

1704 && 
	`IPADDRISBOUND
(&
addr
))

1705 
	`SASSERTX
(
	`sockaddøªeq
(&
io
->
d°
.
œddr
, &
addr
, 0));

1707 i‡(
io
->
d°
.
°©e
.
isc⁄√˘ed
) {

1708 
Àn
 = (
addr
);

1709 i‡(
	`gë≥î«me
(
io
->
d°
.
s
, 
	`TOSA
(&
addr
), &
Àn
) == 0

1710 && 
	`IPADDRISBOUND
(&
addr
))

1711 
	`SASSERTX
(
	`sockaddøªeq
(&
io
->
d°
.
øddr
, &
addr
, 0));

1715 i‡(
io
->
c⁄åﬁ
.
s
 != -1) {

1716 
Àn
 = (
addr
);

1717 i‡(
	`gësock«me
(
io
->
c⁄åﬁ
.
s
, 
	`TOSA
(&
addr
), &
Àn
) == 0

1718 && 
	`IPADDRISBOUND
(&
addr
))

1719 
	`SASSERTX
(
	`sockaddøªeq
(&
io
->
c⁄åﬁ
.
œddr
, &
addr
, 0));

1721 
Àn
 = (
addr
);

1722 i‡(
	`gë≥î«me
(
io
->
c⁄åﬁ
.
s
, 
	`TOSA
(&
addr
), &
Àn
) == 0)

1723 
	`SASSERTX
(
	`sockaddøªeq
(&
io
->
c⁄åﬁ
.
øddr
, &
addr
, 0));

1728 i‡(
wóªchûd
) {

1729 
size_t
 
i
;

1731 
i
 = 0; i < 
io
->
extsockë›ti⁄c
; ++i)

1732 
io
->
extsockë›ti⁄v
[
i
].
öfo


1733 
	`›tvÆ2sock›t
(
io
->
extsockë›ti⁄v
[
i
].
Àvñ
,

1734 
io
->
extsockë›ti⁄v
[
i
].
›äame
);

1736 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

1738 
	`sockd_check_ù˛©ícy
("client objectÑeceived fromÑequestÖrocess",

1739 &
io
->
°©e
.
time
.
ªque°íd
,

1740 &
äow
,

1741 &
äow
);

1744 
io
->
œ°io
 = 
äow
;

1746 
io
->
°©e
.
comm™d
) {

1747 #i‡
SOCKS_SERVER


1748 
SOCKS_BINDREPLY
:

1749 
	`socks_Ælocbuf„r
(
io
->
§c
.
s
, 
SOCK_STREAM
);

1750 
	`socks_Ælocbuf„r
(
io
->
d°
.
s
, 
SOCK_STREAM
);

1752 
io
->
d°
.
is˛õ¡side
 = 1;

1754 i‡(
io
->
c⁄åﬁ
.
s
 != -1) {

1755 
	`SASSERTX
(
io
->
°©e
.
exãnsi⁄
.
böd
);

1756 
	`socks_Ælocbuf„r
(
io
->
c⁄åﬁ
.
s
, 
SOCK_STREAM
);

1762 #i‡
HAVE_UDP_SUPPORT


1763 
SOCKS_UDPASSOCIATE
: {

1765 
io
->
§c
.
is˛õ¡side
 = 1;

1767 #i‡
SOCKS_SERVER


1768 
io
->
cmd
.
udp
.
sfwdruÀ
 = &
fwdruÀv
[
ioi
];

1769 
io
->
cmd
.
udp
.
§ïlyruÀ
 = &
ª∂yruÀv
[
ioi
];

1770 
io
->
d°
.
d°v
 = 
ud±¨gëv
[
ioi
];

1771 
io
->
d°
.
d°cmax
 = 
	`ELEMENTS
(
ud±¨gëv
[
ioi
]);

1772 
io
->
d°
.
d°c
 = 0;

1774 i‡(
	`ADDRISBOUND
(&
io
->
§c
.
øddr
))

1775 
	`SASSERTX
(
io
->
§c
.
°©e
.
isc⁄√˘ed
);

1777 
	`SASSERTX
(!
io
->
§c
.
°©e
.
isc⁄√˘ed
);

1779 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 != -1);

1780 
	`socks_Ælocbuf„r
(
io
->
c⁄åﬁ
.
s
, 
SOCK_STREAM
);

1783 c⁄° 
size_t
 
mÆlocsize


1784 
UDP_INITIALCLIENTCOUNT
 * (*
io
->
d°
.
d°v
);

1786 
	`SASSERTX
(
io
->
§c
.
auth
.
mëhod
 =
AUTHMETHOD_NONE
);

1788 
	`SASSERTX
(
io
->
d°
.
s
 == -1);

1791 
io
->
d°
.
s
 = io->
§c
.s;

1793 i‡((
io
->
d°
.
d°v
 = 
	`mÆloc
(
mÆlocsize
)Ë=
NULL
) {

1794 
sockaddr_°‹age
 
œddr
;

1795 
buf
[
MAXSOCKADDRSTRING
];

1796 
sockÀn_t
 
Àn
 = (
œddr
);

1798 i‡(
	`gësock«me
(
io
->
§c
.
s
, 
	`TOSA
(&
œddr
), &
Àn
) == 0)

1799 
	`sockaddr2°rög
(&
œddr
, 
buf
, (buf));

1801 
	`SWARN
(
î∫o
);

1802 
	`¢¥ötf
(
buf
, (buf), "<unknown>");

1805 
	`sw¨n
("%s: failedÅoállocate %lu bytes of memory for initial "

1807 
fun˘i⁄
,

1808 ()(
mÆlocsize
),

1809 
UDP_INITIALCLIENTCOUNT
,

1810 
buf
);

1812 
	`˛o£
(
io
->
§c
.
s
);

1817 
io
->
d°
.
d°c
 = 0;

1818 
io
->
d°
.
d°cmax
 = 
UDP_INITIALCLIENTCOUNT
;

1826 
	`socks_Ælocbuf„r
(
io
->
§c
.
s
, 
SOCK_DGRAM
);

1832 
SOCKS_CONNECT
:

1833 i‡(!
io
->
d°
.
°©e
.
isc⁄√˘ed
)

1834 
io°©e
.
havec⁄√˘ö¥ogªss
 = 1;

1836 
io
->
§c
.
is˛õ¡side
 = 1;

1838 
	`socks_Ælocbuf„r
(
io
->
§c
.
s
, 
SOCK_STREAM
);

1839 
	`socks_Ælocbuf„r
(
io
->
d°
.
s
, 
SOCK_STREAM
);

1844 #i‡
HAVE_NEGOTIATE_PHASE


1845 i‡(
io
->
˛õ¡d©Æí
 != 0) {

1846 
	`¶og
(
LOG_DEBUG
,

1848 
fun˘i⁄
,

1849 ()
io
->
˛õ¡d©Æí
,

1850 
	`socksho°2°rög
(&
io
->
§c
.
ho°
, 
NULL
, 0));

1858 
	`socks_addtobuf„r
(
	`CONTROLIO
(
io
)->
s
,

1859 
READ_BUF
,

1861 
io
->
˛õ¡d©a
,

1862 
io
->
˛õ¡d©Æí
);

1864 
io
->
˛õ¡d©Æí
 = 0;

1868 
	`log_ruÀöfo_shmid
(
	`CRULE_OR_HRULE
(
io
), 
fun˘i⁄
, 
NULL
);

1870 i‡(
io
->
§uÀ
.
ty≥
 =
obje˘_n⁄e
) {

1871 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
);

1872 
	`SASSERTX
(!
HAVE_SOCKS_RULES
);

1875 
	`log_ruÀöfo_shmid
(&
io
->
§uÀ
, 
fun˘i⁄
, 
NULL
);

1884 ()
	`sockd_shm©
(
	`SHMEMRULE
(
io
), 
SHMEM_ALL
);

1886 
	`io_upd©em⁄ô‹
(
io
);

1892 
io
->
Æloˇãd
 = 1;

1895 
io°©e
.
‰ìfds
 -
fdª˚ived
;

1898 
	}
}

1901 
	$io_˛ór£t
(
io
, 
˛óøŒèrgës
, 
£t
)

1902 c⁄° 
sockd_io_t
 *
io
;

1903 c⁄° 
˛óøŒèrgës
;

1904 
fd_£t
 *
£t
;

1907 
	`SASSERTX
(
io
->
§c
.
s
 != -1);

1908 
	`FD_CLR
(
io
->
§c
.
s
, 
£t
);

1910 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
)

1911 
	`SASSERTX
(
io
->
d°
.
s
 != -1);

1913 i‡(
io
->
d°
.
s
 != -1)

1914 
	`FD_CLR
(
io
->
d°
.
s
, 
£t
);

1916 
io
->
°©e
.
comm™d
) {

1917 
SOCKS_CONNECT
:

1920 
SOCKS_BIND
:

1921 
SOCKS_BINDREPLY
:

1922 i‡(
io
->
°©e
.
exãnsi⁄
.
böd
) {

1923 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 != -1);

1924 
	`FD_CLR
(
io
->
c⁄åﬁ
.
s
, 
£t
);

1928 #i‡
HAVE_UDP_SUPPORT


1929 
SOCKS_UDPASSOCIATE
: {

1930 
size_t
 
i
;

1932 #i‡
HAVE_CONTROL_CONNECTION


1933 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 != -1);

1934 
	`FD_CLR
(
io
->
c⁄åﬁ
.
s
, 
£t
);

1938 i‡(
˛óøŒèrgës
)

1939 
i
 = 0; i < 
io
->
d°
.
d°c
; ++i)

1940 
	`FD_CLR
(
io
->
d°
.
d°v
[
i
].
s
, 
£t
);

1947 
	`SERRX
(
io
->
°©e
.
comm™d
);

1949 
	}
}

1951 
size_t


1952 
	$io_Æloˇãd
(
t˝io
, 
t˝fd
, 
udpio
, 
udpfd
)

1953 
size_t
 *
t˝io
;

1954 
size_t
 *
t˝fd
;

1955 
size_t
 *
udpio
;

1956 
size_t
 *
udpfd
;

1958 c⁄° *
fun˘i⁄
 = "io_allocated()";

1959 
size_t
 
i
, 
t˝io_mem
, 
t˝fd_mem
, 
udpio_mem
, 
udpfd_mem
;

1961 i‡(
t˝io
 =
NULL
)

1962 
t˝io
 = &
t˝io_mem
;

1964 i‡(
t˝fd
 =
NULL
)

1965 
t˝fd
 = &
t˝fd_mem
;

1967 i‡(
udpio
 =
NULL
)

1968 
udpio
 = &
udpio_mem
;

1970 i‡(
udpfd
 =
NULL
)

1971 
udpfd
 = &
udpfd_mem
;

1973 *
t˝io
 = *
t˝fd
 = *
udpio
 = *
udpfd
 = 0;

1975 
i
 = 0; i < 
ioc
; ++i) {

1976 i‡(!
iov
[
i
].
Æloˇãd
)

1979 
iov
[
i
].
°©e
.
¥Ÿocﬁ
) {

1980 #i‡
HAVE_UDP_SUPPORT


1981 
SOCKS_UDP
:

1982 ++(*
udpio
);

1984 ++(*
udpfd
);

1985 (*
udpfd
Ë+
iov
[
i
].
d°
.
d°c
;

1987 #i‡
HAVE_CONTROL_CONNECTION


1988 ++(*
t˝fd
);

1994 
SOCKS_TCP
:

1995 ++(*
t˝io
);

1997 (*
t˝fd
) += 1 + 1 ;

2001 
	`SERRX
(
iov
[
i
].
°©e
.
¥Ÿocﬁ
);

2004 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

2005 
	`¶og
(
LOG_DEBUG
, "%s: iov #%luállocated for %s",

2006 
fun˘i⁄
, ()
i
, 
	`¥Ÿocﬁ2°rög
(
iov
[i].
°©e
.
¥Ÿocﬁ
));

2009 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

2010 
	`¶og
(
LOG_DEBUG
, "%s:állocated forÅcp: %lu, udp: %lu",

2011 
fun˘i⁄
, ()*
t˝io
, ()*
udpio
);

2013  *
t˝io
 + *
udpio
;

2014 
	}
}

2017 
	$¥o˘ôÀupd©e
()

2019 
size_t
 
ö¥ogªss
;

2021 i‡(
io°©e
.
havec⁄√˘ö¥ogªss
) {

2022 
size_t
 
i
;

2024 
i
 = 
ö¥ogªss
 = 0; i < 
ioc
; ++i)

2025 i‡(
	`io_c⁄√˘isö¥ogªss
(&
iov
[
i
]))

2026 ++
ö¥ogªss
;

2029 
ö¥ogªss
 = 0;

2031 
	`£çro˘ôÀ
("%s: %lu/%lu (%lu inÖrogress)",

2032 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
),

2033 ()
	`io_Æloˇãd
(
NULL
, NULL, NULL, NULL),

2034 ()
SOCKD_IOMAX
,

2035 ()
ö¥ogªss
);

2036 
	}
}

2038 
sockd_io_t
 *

2039 
	$io_gë£t
(
nfds
, 
£t
)

2040 c⁄° 
nfds
;

2041 c⁄° 
fd_£t
 *
£t
;

2043 c⁄° *
fun˘i⁄
 = "io_getset()";

2044 
sockd_io_t
 *
be°
, *
evÆu©ög
;

2045 
size_t
 
i
;

2046 
s
;

2048 
s
 = 0, 
be°
 = 
NULL
; s < 
nfds
; ++s) {

2049 i‡(!
	`FD_ISSET
(
s
, 
£t
))

2055 
i
 = 0, 
evÆu©ög
 = 
NULL
; i < 
ioc
; ++i) {

2056 i‡(!
iov
[
i
].
Æloˇãd
)

2059 
iov
[
i
].
°©e
.
comm™d
) {

2060 
SOCKS_CONNECT
:

2061 i‡(
s
 =
iov
[
i
].
§c
.†|| s =iov[i].
d°
.s)

2062 
evÆu©ög
 = &
iov
[
i
];

2066 #i‡
SOCKS_SERVER


2067 
SOCKS_BINDREPLY
:

2068 i‡(
s
 =
iov
[
i
].
§c
.†|| s =iov[i].
d°
.s)

2069 
evÆu©ög
 = &
iov
[
i
];

2070 i‡(
iov
[
i
].
°©e
.
exãnsi⁄
.
böd
 && 
s
 =iov[i].
c⁄åﬁ
.s)

2071 
evÆu©ög
 = &
iov
[
i
];

2076 #i‡
HAVE_UDP_SUPPORT


2077 
SOCKS_UDPASSOCIATE
: {

2078 
ud±¨gë_t
 *
èrgë
;

2080 i‡(
s
 =
iov
[
i
].
§c
.s) {

2082 
iov
[
i
].
d°
.
s
 = -1;

2083 
evÆu©ög
 = &
iov
[
i
];

2085 i‡((
èrgë
 = 
	`˛õ¡ofsockë
(
s
,

2086 
iov
[
i
].
d°
.
d°c
,

2087 
iov
[
i
].
d°
.
d°v
)Ë!
NULL
) {

2088 
	`io_syncudp
(&
iov
[
i
], 
èrgë
);

2090 
	`SASSERTX
(
iov
[
i
].
d°
.
s
 != -1);

2091 
	`SASSERTX
(
iov
[
i
].
d°
.
s
 == s);

2093 
evÆu©ög
 = &
iov
[
i
];

2095 #i‡
HAVE_CONTROL_CONNECTION


2096 i‡(
s
 =
iov
[
i
].
c⁄åﬁ
.s)

2097 
evÆu©ög
 = &
iov
[
i
];

2108 i‡(
evÆu©ög
 !
NULL
)

2112 
	`SASSERTX
(
evÆu©ög
 !
NULL
);

2115 i‡(
be°
 =
NULL
 || 
	`timîcmp
(&
evÆu©ög
->
œ°io
, &best->lastio, <))

2116 
be°
 = 
evÆu©ög
;

2119  
be°
;

2120 
	}
}

2122 
sockd_io_t
 *

2123 
	$io_föddes¸ùt‹
(
d
)

2124 
d
;

2126 
size_t
 
i
;

2128 
i
 = 0; i < 
ioc
; ++i) {

2129 i‡(!
iov
[
i
].
Æloˇãd
)

2132 
iov
[
i
].
°©e
.
comm™d
) {

2133 
SOCKS_BIND
:

2134 
SOCKS_BINDREPLY
:

2135 i‡(
d
 =
iov
[
i
].
§c
.
s
 || d =iov[i].
d°
.s)

2136  &
iov
[
i
];

2137 i‡(!
iov
[
i
].
°©e
.
exãnsi⁄
.
böd
) {

2138 i‡(
d
 =
iov
[
i
].
c⁄åﬁ
.
s
)

2139  &
iov
[
i
];

2143 
SOCKS_CONNECT
:

2144 i‡(
d
 =
iov
[
i
].
§c
.
s
 || d =iov[i].
d°
.s)

2145  &
iov
[
i
];

2148 #i‡
HAVE_UDP_SUPPORT


2149 
SOCKS_UDPASSOCIATE
: {

2150 
ud±¨gë_t
 *
èrgë
;

2152 i‡(
d
 =
iov
[
i
].
§c
.
s
) {

2154 
iov
[
i
].
d°
.
s
 = -1;

2155  &
iov
[
i
];

2158 
èrgë
 = 
	`˛õ¡ofsockë
(
d
, 
iov
[
i
].
d°
.
d°c
, iov[i].d°.
d°v
);

2159 i‡(
èrgë
 !
NULL
) {

2160 
	`io_syncudp
(&
iov
[
i
], 
èrgë
);

2162 
	`SASSERTX
(
iov
[
i
].
d°
.
s
 != -1);

2163 
	`SASSERTX
(
iov
[
i
].
d°
.
s
 =
d
);

2165  &
iov
[
i
];

2168 #i‡
HAVE_CONTROL_CONNECTION


2169 i‡(
d
 =
iov
[
i
].
c⁄åﬁ
.
s
)

2170  &
iov
[
i
];

2178 
	`SERRX
(
iov
[
i
].
°©e
.
comm™d
);

2182  
NULL
;

2183 
	}
}

2186 
	$io_fûl£t
(
£t
, 
™tiÊags
, 
™tiÊags_£t
, 
bwovîÊowtû
)

2187 
fd_£t
 *
£t
;

2188 
™tiÊags
;

2189 
fd_£t
 *
™tiÊags_£t
;

2190 
timevÆ
 *
bwovîÊowtû
;

2192 c⁄° *
fun˘i⁄
 = "io_fillset()";

2193 
timevÆ
 
äow
, 
fú°bwovîÊowok
;

2194 
size_t
 
i
;

2195 
max
;

2197 i‡(
™tiÊags
 != 0)

2198 
	`SASSERTX
(
™tiÊags_£t
 !
NULL
);

2200 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

2201 
	`timî˛ór
(&
fú°bwovîÊowok
);

2203 
	`FD_ZERO
(
£t
);

2205 i‡(
™tiÊags_£t
 != 0)

2206 
	`FD_ZERO
(
™tiÊags_£t
);

2208 
i
 = 0, 
max
 = -1; i < 
ioc
; ++i) {

2209 
sockd_io_t
 *
io
 = &
iov
[
i
];

2211 i‡(!
io
->
Æloˇãd
)

2215 
	`SASSERTX
(!(
io
->
§c
.
°©e
.
fö_ª˚ived
 && io->
d°
.state.fin_received));

2217 #i‡
HAVE_CONTROL_CONNECTION


2221 i‡(
io
->
c⁄åﬁ
.
s
 != -1) {

2222 i‡(
™tiÊags
 & 
io
->
c⁄åﬁ
.
Êags
)

2223 
	`FD_SET
(
io
->
c⁄åﬁ
.
s
, 
™tiÊags_£t
);

2225 
	`FD_SET
(
io
->
c⁄åﬁ
.
s
, 
£t
);

2227 
max
 = 
	`MAX
(max, 
io
->
c⁄åﬁ
.
s
);

2232 #i‡
BAREFOOTD


2237 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
) {

2240 i‡(
	`SHMEMRULE
(
io
)->
bw_shmid
 != 0) {

2241 
timevÆ
 
bwovîÊowok
, 
howl⁄gtû
;

2243 i‡(
	`bw_ruÀhasovîÊown
(
	`SHMEMRULE
(
io
), &
äow
, &
bwovîÊowok
)) {

2244 i‡(!
	`timîis£t
(&
fú°bwovîÊowok
)

2245 || 
	`timîcmp
(&
bwovîÊowok
, &
fú°bwovîÊowok
, <))

2246 
fú°bwovîÊowok
 = 
bwovîÊowok
;

2248 
	`SASSERTX
(
	`timîcmp
(&
bwovîÊowok
, &
äow
, >));

2249 
	`timîsub
(&
bwovîÊowok
, &
äow
, &
howl⁄gtû
);

2250 
	`¶og
(
LOG_DEBUG
,

2254 
fun˘i⁄
,

2255 ()
i
,

2256 ()
	`SHMEMRULE
(
io
)->
numbî
,

2257 ()
	`SHMEMRULE
(
io
)->
bw_shmid
,

2258 
io
->
c⁄åﬁ
.
s
,

2259 
io
->
§c
.
s
,

2260 
io
->
d°
.
s
,

2261 ()
howl⁄gtû
.
tv_£c
,

2262 ()
howl⁄gtû
.
tv_u£c
,

2263 ()
bwovîÊowok
.
tv_£c
,

2264 ()
bwovîÊowok
.
tv_u£c
);

2270 #i‡
BAREFOOTD


2274 
io
->
°©e
.
comm™d
) {

2275 
SOCKS_BINDREPLY
:

2276 
SOCKS_CONNECT
:

2277 i‡(!
io
->
§c
.
°©e
.
fö_ª˚ived
) {

2278 i‡(
™tiÊags
 & 
io
->
§c
.
Êags
)

2279 
	`FD_SET
(
io
->
§c
.
s
, 
™tiÊags_£t
);

2281 
	`FD_SET
(
io
->
§c
.
s
, 
£t
);

2283 
max
 = 
	`MAX
(max, 
io
->
§c
.
s
);

2286 i‡(
io
->
d°
.
°©e
.
isc⁄√˘ed


2287 && !
io
->
d°
.
°©e
.
fö_ª˚ived
) {

2288 i‡(
™tiÊags
 & 
io
->
d°
.
Êags
)

2289 
	`FD_SET
(
io
->
d°
.
s
, 
™tiÊags_£t
);

2291 
	`FD_SET
(
io
->
d°
.
s
, 
£t
);

2293 
max
 = 
	`MAX
(max, 
io
->
d°
.
s
);

2298 #i‡
HAVE_UDP_SUPPORT


2299 
SOCKS_UDPASSOCIATE
: {

2300 
size_t
 
j
;

2303 
	`SASSERTX
(
io
->
§c
.
Êags
 == 0);

2304 
	`SASSERTX
(
io
->
d°
.
Êags
 == 0);

2306 
	`FD_SET
(
io
->
§c
.
s
, 
£t
);

2307 
max
 = 
	`MAX
(max, 
io
->
§c
.
s
);

2309 #i‡
BAREFOOTD


2320 
j
 = 0; j < 
io
->
d°
.
d°c
; ++j) {

2321 i‡(
io
->
d°
.
d°v
[
j
].
¸uÀ
.
bw_shmid
 != 0) {

2322 
timevÆ
 
bwovîÊowok
;

2324 
	`¶og
(
LOG_DEBUG
,

2327 
fun˘i⁄
,

2328 
	`sockaddr2°rög
(&
io
->
d°
.
d°v
[
j
].
˛õ¡
, 
NULL
, 0),

2329 ()
io
->
d°
.
d°v
[
j
].
¸uÀ
.
bw_shmid
);

2331 
	`SASSERTX
(
io
->
d°
.
d°v
[
j
].
¸uÀ
.
bw
 !
NULL
);

2332 i‡(
	`bw_ruÀhasovîÊown
(&
io
->
d°
.
d°v
[
j
].
¸uÀ
,

2333 &
äow
,

2334 &
bwovîÊowok
)) {

2335 i‡(!
	`timîis£t
(&
fú°bwovîÊowok
)

2336 || 
	`timîcmp
(&
bwovîÊowok
, &
fú°bwovîÊowok
, <))

2337 
fú°bwovîÊowok
 = 
bwovîÊowok
;

2343 
	`FD_SET
(
io
->
d°
.
d°v
[
j
].
s
, 
£t
);

2344 
max
 = 
	`MAX
(max, 
io
->
d°
.
d°v
[
j
].
s
);

2353 i‡(
io
->
§c
.
°©e
.
isc⁄√˘ed
) {

2354 
j
 = 0; j < 
io
->
d°
.
d°c
; ++j) {

2355 
	`SASSERTX
(
io
->
d°
.
d°v
[
j
].
s
 != -1);

2357 
	`FD_SET
(
io
->
d°
.
d°v
[
j
].
s
, 
£t
);

2358 
max
 = 
	`MAX
(max, 
io
->
d°
.
d°v
[
j
].
s
);

2368 
	`SASSERTX
(
io
->
d°
.
d°c
 == 0);

2369 
	`SASSERTX
(
io
->
d°
.
s
 == -1);

2379 i‡(
bwovîÊowtû
 !
NULL
)

2380 *
bwovîÊowtû
 = 
fú°bwovîÊowok
;

2382  
max
;

2383 
	}
}

2386 
	$io_fûl£t_c⁄√˘ö¥ogªss
(
£t
)

2387 
fd_£t
 *
£t
;

2389 c⁄° *
fun˘i⁄
 = "io_fillset_connectinprogress()";

2390 
i
, 
bôs
, 
cou¡
;

2392 i‡(
£t
 !
NULL
)

2393 
	`FD_ZERO
(
£t
);

2395 i‡(!
io°©e
.
havec⁄√˘ö¥ogªss
)

2398 
i
 = 
cou¡
 = 0, 
bôs
 = -1; (
size_t
)ò< 
ioc
; ++i) {

2399 i‡(
	`io_c⁄√˘isö¥ogªss
(&
iov
[
i
])) {

2400 i‡(
£t
 =
NULL
)

2401  
iov
[
i
].
d°
.
s
;

2403 
	`FD_SET
(
iov
[
i
].
d°
.
s
, 
£t
);

2405 
bôs
 = 
	`MAX
(bôs, 
iov
[
i
].
d°
.
s
);

2407 
	`¶og
(
LOG_DEBUG
, "%s: fd %d markedás still connecting",

2408 
fun˘i⁄
, 
iov
[
i
].
d°
.
s
);

2410 ++
cou¡
;

2414  
bôs
;

2415 
	}
}

2417 
timevÆ
 *

2418 
	$io_gëtimeout
(
timeout
)

2419 
timevÆ
 *
timeout
;

2421 c⁄° *
fun˘i⁄
 = "io_gettimeout()";

2422 
timevÆ
 
œ°_timeout
;

2423 
time_t
 
œ°_time
;

2424 
œ°_timeout_is£t
;

2425 
timevÆ
 
äow
, 
time_havebw
;

2426 
size_t
 
i
, 
t˝c
, 
udpc
;

2427 
havëimeout
;

2429 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

2431 i‡(
	`timîis£t
(&
bwovîÊowtû
)) {

2432 c⁄° 
timevÆ
 
sh‹ãnough
 = { 1, 0 };

2434 
	`timîsub
(&
bwovîÊowtû
, &
äow
, &
time_havebw
);

2436 
	`¶og
(
LOG_DEBUG
,

2438 
fun˘i⁄
,

2439 ()
bwovîÊowtû
.
tv_£c
,

2440 ()
bwovîÊowtû
.
tv_u£c
,

2441 ()
time_havebw
.
tv_£c
,

2442 ()
time_havebw
.
tv_u£c
);

2444 i‡(
time_havebw
.
tv_£c
 < 0) {

2445 
	`timî˛ór
(&
bwovîÊowtû
);

2446 
	`timî˛ór
(
timeout
);

2448  
timeout
;

2451 *
timeout
 = 
time_havebw
;

2452 i‡(
	`timîcmp
(
timeout
, &
sh‹ãnough
, <))

2453  
timeout
;

2455 
havëimeout
 = 1;

2458 
havëimeout
 = 0;

2460 
	`¶og
(
LOG_DEBUG
,

2463 
fun˘i⁄
,

2464 ()
œ°_time
,

2465 ()
äow
.
tv_£c
,

2466 ()
œ°_timeout_is£t
,

2467 ()
œ°_timeout
.
tv_£c
,

2468 ()
œ°_timeout
.
tv_u£c
);

2474 i‡(
œ°_timeout_is£t
 && 
œ°_time
 =
äow
.
tv_£c
) {

2481 
œ°_timeout
.
tv_£c
 = 1;

2482 
œ°_timeout
.
tv_u£c
 = 0;

2484 i‡(!
havëimeout


2485 || (
havëimeout
 && 
	`timîcmp
(
timeout
, &
œ°_timeout
, <)))

2486 *
timeout
 = 
œ°_timeout
;

2488  
timeout
;

2502 i‡(
	`io_Æloˇãd
(&
t˝c
, 
NULL
, &
udpc
, NULL) == 0) {

2503 
œ°_timeout_is£t
 = 0;

2504  
NULL
;

2507 
œ°_time
 = 
äow
.
tv_£c
;

2513 
i
 = 0; i < 
ioc
 && (
t˝c
 > 0 || 
udpc
 > 0); ++i) {

2514 
timevÆ
 
timeout_found
;

2516 i‡(!
iov
[
i
].
Æloˇãd
)

2519 i‡(
iov
[
i
].
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
)

2520 --
t˝c
;

2522 
	`SASSERTX
(
iov
[
i
].
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
);

2523 --
udpc
;

2526 
timeout_found
.
tv_£c
 = 
	`io_timeu¡ûtimeout
(&
iov
[
i
], &
äow
, 
NULL
, 0);

2527 
timeout_found
.
tv_u£c
 = 0;

2529 
	`¶og
(
LOG_DEBUG
, "%s:Åimeout for iov #%lu is in %lds",

2530 
fun˘i⁄
, ()
i
, ()
timeout_found
.
tv_£c
);

2532 i‡(
timeout_found
.
tv_£c
 !(
time_t
)-1) {

2533 i‡(!
havëimeout
 || 
	`timîcmp
(&
timeout_found
, 
timeout
, <)) {

2534 
havëimeout
 = 1;

2535 *
timeout
 = 
timeout_found
;

2538 
	`SASSERTX
(
havëimeout
);

2539 i‡(
timeout
->
tv_£c
 <= 0)

2544 i‡(
havëimeout
) {

2545 
	`SASSERTX
(
timeout
->
tv_£c
 >= 0);

2546 
	`SASSERTX
(
timeout
->
tv_u£c
 >= 0);

2554 
timeout
->
tv_u£c
 = 999999;

2556 
œ°_timeout
 = *
timeout
;

2559 
timeout
 = 
NULL
;

2561 
œ°_timeout_is£t
 = 
havëimeout
;

2563  
timeout
;

2564 
	}
}

2566 
sockd_io_t
 *

2567 
	$io_gëtimedout
()

2569 c⁄° *
fun˘i⁄
 = "io_gettimedout()";

2570 
timevÆ
 
äow
;

2571 
size_t
 
i
;

2573 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

2574 
i
 = 0; i < 
ioc
; ++i) {

2575 
timevÆ
 
timeout
;

2577 i‡(!
iov
[
i
].
Æloˇãd
)

2580 i‡((
timeout
.
tv_£c
 = 
	`io_timeu¡ûtimeout
(&
iov
[
i
], &
äow
, 
NULL
, 1))

2581 =(
time_t
)-1)

2584 
timeout
.
tv_u£c
 = 0;

2585 i‡(
timeout
.
tv_£c
 <= 0) {

2586 
	`¶og
(
LOG_DEBUG
,

2589 
fun˘i⁄
,

2590 ()
i
,

2591 
iov
[
i
].
c⁄åﬁ
.
s
,

2592 
iov
[
i
].
§c
.
s
,

2593 
iov
[
i
].
d°
.
s
,

2594 ()
iov
[
i
].
œ°io
.
tv_£c
,

2595 ()
iov
[
i
].
œ°io
.
tv_u£c
);

2597  &
iov
[
i
];

2601  
NULL
;

2602 
	}
}

2605 
	$io_timeouti•ossibÀ
(
io
)

2606 c⁄° 
sockd_io_t
 *
io
;

2609 i‡(!
io
->
Æloˇãd
)

2612 #i‡
HAVE_UDP_SUPPORT


2613 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
) {

2615 #i‡
BAREFOOTD


2616 
size_t
 
i
;

2618 
i
 = 0; i < 
io
->
d°
.
d°c
; ++i) {

2619 i‡(
io
->
d°
.
d°v
[
i
].
¸uÀ
.
timeout
.
udpio
 != 0)

2627  
io
->
§uÀ
.
timeout
.
udpio
 != 0;

2637 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
);

2639 i‡(
io
->
d°
.
°©e
.
isc⁄√˘ed
) {

2640 i‡(
io
->
§uÀ
.
timeout
.
t˝_fö_waô
 != 0

2641 || 
io
->
§uÀ
.
timeout
.
t˝io
 != 0)

2647  
io
->
§uÀ
.
timeout
.
c⁄√˘
 != 0;

2650 
	}
}

2652 
time_t


2653 
	$io_timeu¡ûtimeout
(
io
, 
äow
, 
timeouây≥
, 
doudpsync
)

2654 
sockd_io_t
 *
io
;

2655 c⁄° 
timevÆ
 *
äow
;

2656 
timeouây≥_t
 *
timeouây≥
;

2657 c⁄° 
doudpsync
;

2659 c⁄° *
fun˘i⁄
 = "io_timeuntiltimeout()";

2660 
timeouây≥_t
 
timeouây≥_mem
;

2661 
time_t
 *
œ°io
;

2662 
¥Ÿocﬁtimeout
;

2664 i‡(
timeouây≥
 =
NULL
)

2665 
timeouây≥
 = &
timeouây≥_mem
;

2667 *
timeouây≥
 = 
TIMEOUT_NOTSET
;

2669 i‡(!
	`io_timeouti•ossibÀ
(
io
))

2677 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
) {

2678 #i‡
BAREFOOTD


2679 
size_t
 
i
;

2680 
time_t
 
timeout
;

2682 
	`¶og
(
LOG_DEBUG
, "%s: scanning %lu udp clients forÇearestÅimeout",

2683 
fun˘i⁄
, ()
io
->
d°
.
d°c
);

2685 
i
 = 0, 
timeout
 = -1; i < 
io
->
d°
.
d°c
; ++i) {

2686 
ud±¨gë_t
 *
udp˛õ¡
 = &
io
->
d°
.
d°v
[
i
];

2688 
	`SASSERTX
(
äow
->
tv_£c
 >
udp˛õ¡
->
œ°io
.tv_sec);

2690 
timeout


2691 
	`socks_dif·ime
(
udp˛õ¡
->
¸uÀ
.
timeout
.
udpio
,

2692 
	`socks_dif·ime
(
äow
->
tv_£c
, 
udp˛õ¡
->
œ°io
.tv_sec));

2694 
	`¶og
(
LOG_DEBUG
, "%s:Åime untilÅimeout for udpclient %s is %ld",

2695 
fun˘i⁄
,

2696 
	`sockaddr2°rög
(&
udp˛õ¡
->
˛õ¡
, 
NULL
, 0),

2697 ()
timeout
);

2699 
timeout
 = 
	`MAX
(0,Åimeout);

2700 *
timeouây≥
 = 
TIMEOUT_IO
;

2702 i‡(
timeout
 <= 0) {

2703 
	`SASSERTX
(
udp˛õ¡
 !
NULL
);

2705 i‡(
doudpsync
)

2706 
	`io_syncudp
(
io
, 
udp˛õ¡
);

2712  
timeout
;

2715 *
timeouây≥
 = 
TIMEOUT_IO
;

2716 
¥Ÿocﬁtimeout
 = 
io
->
§uÀ
.
timeout
.
udpio
;

2717 
œ°io
 = (
time_t
 *)&
io
->œ°io.
tv_£c
;

2721 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
);

2723 i‡(
io
->
d°
.
°©e
.
isc⁄√˘ed
) {

2724 i‡(
io
->
§c
.
°©e
.
fö_ª˚ived
 || io->
d°
.state.fin_received) {

2725 i‡(
io
->
§uÀ
.
timeout
.
t˝_fö_waô
 == 0)

2726 *
timeouây≥
 = 
TIMEOUT_IO
;

2728 i‡(
io
->
§uÀ
.
timeout
.
t˝io
 == 0

2729 || 
io
->
§uÀ
.
timeout
.
t˝io
 > io->§uÀ.timeout.
t˝_fö_waô
) {

2730 *
timeouây≥
 = 
TIMEOUT_TCP_FIN_WAIT
;

2733 *
timeouây≥
 = 
TIMEOUT_IO
;

2737 *
timeouây≥
 = 
TIMEOUT_IO
;

2739 i‡(*
timeouây≥
 =
TIMEOUT_IO
)

2740 
¥Ÿocﬁtimeout
 = 
io
->
§uÀ
.
timeout
.
t˝io
;

2742 
	`SASSERTX
(*
timeouây≥
 =
TIMEOUT_TCP_FIN_WAIT
);

2743 
¥Ÿocﬁtimeout
 = 
io
->
§uÀ
.
timeout
.
t˝_fö_waô
;

2746 
œ°io
 = (
time_t
 *)&
io
->œ°io.
tv_£c
;

2749 *
timeouây≥
 = 
TIMEOUT_CONNECT
;

2750 
¥Ÿocﬁtimeout
 = 
io
->
§uÀ
.
timeout
.
c⁄√˘
;

2751 
œ°io
 = (
time_t
 *)&
io
->
°©e
.
time
.
√gŸüãíd
.
tv_£c
;

2755 i‡(
¥Ÿocﬁtimeout
 == 0)

2758 
	`SASSERTX
(
	`socks_dif·ime
(*
œ°io
, (
time_t
)
äow
->
tv_£c
) <= 0);

2760 i‡(
sockscf
.
›ti⁄
.
debug
)

2761 i‡(
	`MAX
(0, 
¥Ÿocﬁtimeout
 - 
	`socks_dif·ime
(
äow
->
tv_£c
, *
œ°io
)) == 0)

2762 
	`¶og
(
LOG_DEBUG
,

2765 
fun˘i⁄
,

2766 ()*
timeouây≥
,

2767 
¥Ÿocﬁtimeout
,

2768 ()
äow
->
tv_£c
,

2769 ()*
œ°io
,

2770 ()
	`socks_dif·ime
(
äow
->
tv_£c
, *
œ°io
),

2771 ()(
¥Ÿocﬁtimeout
 - 
	`socks_dif·ime
(
äow
->
tv_£c
, *
œ°io
)));

2773  
	`MAX
(0, 
¥Ÿocﬁtimeout
 - 
	`socks_dif·ime
(
äow
->
tv_£c
, *
œ°io
));

2774 
	}
}

2777 
	$gë√wios
()

2779 c⁄° *
fun˘i⁄
 = "getnewios()";

2780 c⁄° 
size_t
 
‰ìc
 = 
SOCKD_IOMAX
 - 
	`io_Æloˇãd
(
NULL
, NULL, NULL, NULL);

2781 
size_t
 
ª˚ivedc
;

2783 
ª˚ivedc
 = 
î∫o
 = 0;

2784  
	`ªcv_io
(
sockscf
.
°©e
.
mŸhî
.
s
, 
NULL
) == 0

2785 && 
ª˚ivedc
 < 
‰ìc
)

2786 ++
ª˚ivedc
;

2788 
	`¶og
(
LOG_DEBUG
, "%s:Ñeceived %luÇew io%s,Érrno = %d (%s)",

2789 
fun˘i⁄
,

2790 ()
ª˚ivedc
,

2791 
ª˚ivedc
 == 1 ? "" : "s",

2792 
î∫o
,

2793 
	`°ªº‹
(
î∫o
));

2795 i‡(
ª˚ivedc
 > 0) {

2796 
î∫o
 = 0;

2797  
ª˚ivedc
;

2800 
	`¶og
(
LOG_DEBUG
,

2803 
fun˘i⁄
,

2804 ()(
‰ìc
 + 1),

2805 ()
SOCKD_IOMAX
,

2806 
	`°ªº‹
(
î∫o
));

2810 
	}
}

2814 
	$sigöfo
(
sig
, 
si
, 
sc
)

2815 
sig
;

2816 
sigöfo_t
 *
si
;

2817 *
sc
;

2819 c⁄° *
fun˘i⁄
 = "siginfo()";

2820 c⁄° 
î∫o_s
 = 
î∫o
;

2821 #i‡
HAVE_UDP_SUPPORT


2822 
io°©_t
 *
°©s
;

2824 
days
, 
hours
, 
möuãs
, 
£c⁄ds
;

2825 
time_t
 
äow
;

2826 
size_t
 
i
;

2828 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

2830 
£c⁄ds
 = ()
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(&
äow
),

2831 
sockscf
.
°©
.
boŸ
);

2833 
	`£c⁄ds2days
(&
£c⁄ds
, &
days
, &
hours
, &
möuãs
);

2835 
	`¶og
(
LOG_INFO
, "io-child up %lu day%s, %lu:%.2lu:%.2lu",

2836 
days
, day†=1 ? "" : "s", 
hours
, 
möuãs
, 
£c⁄ds
);

2838 #i‡
HAVE_UDP_SUPPORT


2839 i‡((
°©s
 = 
	`io_gë_ro_°©s
()Ë=
NULL
)

2840 
	`¶og
(
LOG_INFO
, "noÑead-onlyÜatency informationávailable (yet)");

2842 
	`¶og
(
LOG_INFO
,

2846 ()
°©s
->
œãncyc
,

2847 
°©s
->
mö_us
,

2848 
°©s
->
max_us
,

2849 
°©s
->
medün_us
,

2850 
°©s
->
avîage_us
,

2851 
°©s
->
œ°_us
,

2852 
°©s
->
°ddev_us
);

2854 i‡((
°©s
 = 
	`io_gë_io_°©s
()Ë=
NULL
)

2855 
	`¶og
(
LOG_INFO
, "no i/oÜatency informationávailable (yet)");

2857 
	`¶og
(
LOG_INFO
,

2861 ()
°©s
->
œãncyc
,

2862 
°©s
->
mö_us
,

2863 
°©s
->
max_us
,

2864 
°©s
->
medün_us
,

2865 
°©s
->
avîage_us
,

2866 
°©s
->
œ°_us
,

2867 
°©s
->
°ddev_us
);

2870 
i
 = 0; i < 
ioc
; ++i) {

2871 c⁄° 
i§evî£d
 = (
iov
[
i
].
°©e
.
comm™d
 =
SOCKS_BINDREPLY
 ? 1 : 0);

2872 
uöt64_t
 
§c_wrôãn
, 
d°_wrôãn
;

2873 
sockd_io_dúe˘i⁄_t
 *
§c
, *
d°
;

2874 
socksho°_t
 
a
, 
b
;

2875 
§c°rög
[
MAX_IOLOGADDR
], 
d°°rög
[MAX_IOLOGADDR],

2876 
timeöfo
[64], 
idÀ°r
[64];

2878 i‡(!
iov
[
i
].
Æloˇãd
)

2881 i‡(
i§evî£d
) {

2882 
§c
 = &
iov
[
i
].
d°
;

2883 
d°
 = &
iov
[
i
].
§c
;

2886 
§c
 = &
iov
[
i
].src;

2887 
d°
 = &
iov
[
i
].dst;

2890 i‡(
iov
[
i
].
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP


2891 || 
d°
->
°©e
.
isc⁄√˘ed
)

2892 
	`¢¥öt‚
(
idÀ°r
, (idlestr), "%lds",

2893 ()
	`socks_dif·ime
(
äow
, 
iov
[
i
].
œ°io
.
tv_£c
));

2895 
	`¢¥öt‚
(
idÀ°r
, (idlestr),

2897 ()
	`socks_dif·ime
(
äow
,

2898 
iov
[
i
].
°©e
.
time
.
ªque°íd
.
tv_£c
));

2900 
	`¢¥ötf
(
timeöfo
, (timeinfo),

2902 ()
	`socks_dif·ime
(
äow
, 
iov
[
i
].
°©e
.
time
.
ac˚±ed
.
tv_£c
),

2903 
idÀ°r
);

2911 i‡(
iov
[
i
].
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
) {

2912 
size_t
 
§c_buf„ªd
, 
d°_buf„ªd
;

2913 
§c_buf„röfo
[64], 
d°_buf„röfo
[(src_bufferinfo)],

2914 
t˝öfo
[
MAXTCPINFOLEN
];

2915 
havesockëöfo
;

2917 #i‡
HAVE_RECVBUF_IOCTL


2918 
§c_so_rcvbuf
, 
d°_so_rcvbuf
;

2921 #i‡
HAVE_SENDBUF_IOCTL


2922 
§c_so_¢dbuf
, 
d°_so_¢dbuf
;

2925 
	`buûd_addr°r_§c
(
	`GET_HOSTIDV
(&
iov
[
i
].
°©e
),

2926 
	`GET_HOSTIDC
(&
iov
[
i
].
°©e
),

2927 &
§c
->
ho°
,

2928 
NULL
,

2929 
NULL
,

2930 
	`sockaddr2socksho°
(&
§c
->
œddr
, &
b
),

2931 &
§c
->
auth
,

2932 
NULL
,

2933 
§c°rög
,

2934 (
§c°rög
));

2936 
	`buûd_addr°r_d°
(
	`sockaddr2socksho°
(&
d°
->
œddr
, 
NULL
),

2937 
iov
[
i
].
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
 ?

2938 
NULL
 : 
	`sockaddr2socksho°
(&
d°
->
øddr
, &
a
),

2939 
iov
[
i
].
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
 ?

2940 
NULL
 : &
iov
[
i
].
°©e
.
¥oxychaö
.
exèddr
,

2941 
iov
[
i
].
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
 ?

2942 
	`sockaddr2socksho°
(&
d°
->
øddr
, &
a
)

2943 : &
d°
->
ho°
,

2944 &
d°
->
auth
,

2945 
NULL
,

2946 (
ö_addr
 *)
NULL
,

2948 
d°°rög
,

2949 (
d°°rög
));

2952 
§c_buf„ªd


2953 
	`socks_byãsöbuf„r
(
§c
->
s
,

2954 
WRITE_BUF
,

2955 #i‡
SOCKS_SERVER
 && 
HAVE_GSSAPI


2956 
§c
->
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI


2957 && 
§c
->
auth
.
md©a
.
gsßpi
.
°©e
.
wøp
 ?

2964 
d°_buf„ªd
 = 
	`socks_byãsöbuf„r
(
d°
->
s
, 
WRITE_BUF
, 0);

2966 *
§c_buf„röfo
 = 
NUL
;

2967 *
d°_buf„röfo
 = 
NUL
;

2969 #i‡
HAVE_RECVBUF_IOCTL
 || 
HAVE_SENDBUF_IOCTL


2971 
havesockëöfo
 = 1;

2975 
havesockëöfo
 = 0;

2979 #i‡
HAVE_RECVBUF_IOCTL


2980 i‡(
	`io˘l
(
d°
->
s
, 
RECVBUF_IOCTLVAL
, &
d°_so_rcvbuf
) != 0) {

2981 
	`sw¨n
("%s:Ñcvbuf size ioctl() on dst-fd %d failed",

2982 
fun˘i⁄
, 
d°
->
s
);

2985 
havesockëöfo
 = 1;

2987 i‡(
havesockëöfo
) {

2988 i‡(
	`io˘l
(
§c
->
s
, 
RECVBUF_IOCTLVAL
, &
§c_so_rcvbuf
) != 0) {

2989 
	`sw¨n
("%s:Ñecvbuf size ioctl() on src-fd %d failed",

2990 
fun˘i⁄
, 
§c
->
s
);

2991 
havesockëöfo
 = 0;

2996 #i‡
HAVE_SENDBUF_IOCTL


2997 i‡(
havesockëöfo
) {

2998 i‡(
	`io˘l
(
§c
->
s
, 
SENDBUF_IOCTLVAL
, &
§c_so_¢dbuf
) != 0) {

2999 
	`sw¨n
("%s: sendbuf size ioctl() on src-fd %d failed",

3000 
fun˘i⁄
, 
§c
->
s
);

3001 
havesockëöfo
 = 0;

3005 i‡(
havesockëöfo
) {

3006 i‡(
	`io˘l
(
d°
->
s
, 
SENDBUF_IOCTLVAL
, &
d°_so_¢dbuf
) != 0) {

3007 
	`sw¨n
("%s: sendbuf size ioctl() on dst-fd %d failed",

3008 
fun˘i⁄
, 
d°
->
s
);

3009 
havesockëöfo
 = 0;

3014 #i‡
HAVE_SENDBUF_IOCTL
 && 
HAVE_RECVBUF_IOCTL


3015 i‡(
havesockëöfo
) {

3016 
	`¢¥ötf
(
§c_buf„röfo
, (src_bufferinfo),

3018 ()(
§c_buf„ªd


3019 + 
d°_so_rcvbuf


3020 + 
§c_so_¢dbuf
),

3021 ()
d°_so_rcvbuf
,

3022 ()
§c_buf„ªd
,

3023 ()
§c_so_¢dbuf
);

3025 
	`¢¥ötf
(
d°_buf„röfo
, (dst_bufferinfo),

3027 ()(
d°_buf„ªd


3028 + 
§c_so_rcvbuf


3029 + 
d°_so_¢dbuf
),

3030 ()
§c_so_rcvbuf
,

3031 ()
d°_buf„ªd
,

3032 ()
d°_so_¢dbuf
);

3035 #ñi‡
HAVE_SENDBUF_IOCTL
 && !
HAVE_RECVBUF_IOCTL


3036 i‡(
havesockëöfo
) {

3037 
	`¢¥ötf
(
§c_buf„röfo
, (src_bufferinfo),

3039 ()(
§c_buf„ªd
 + 
§c_so_¢dbuf
),

3040 ()
§c_buf„ªd
,

3041 ()
§c_so_¢dbuf
);

3043 
	`¢¥ötf
(
d°_buf„röfo
, (dst_bufferinfo),

3045 ()(
d°_buf„ªd
 + 
d°_so_¢dbuf
),

3046 ()
d°_buf„ªd
,

3047 ()
d°_so_¢dbuf
);

3050 #ñi‡!
HAVE_SENDBUF_IOCTL
 && 
HAVE_RECVBUF_IOCTL


3051 i‡(
havesockëöfo
) {

3052 
	`¢¥ötf
(
§c_buf„röfo
, (src_bufferinfo),

3054 ()(
§c_buf„ªd
 + 
d°_so_rcvbuf
),

3055 ()
d°_so_rcvbuf
,

3056 ()
§c_buf„ªd
);

3058 
	`¢¥ötf
(
d°_buf„röfo
, (dst_bufferinfo),

3060 ()(
d°_buf„ªd
 + 
§c_so_rcvbuf
),

3061 ()
§c_so_rcvbuf
,

3062 ()
d°_buf„ªd
);

3066 i‡(!
havesockëöfo
) {

3067 
	`¢¥ötf
(
§c_buf„röfo
, (src_bufferinfo),

3069 ()
§c_buf„ªd
,

3070 ()
§c_buf„ªd
);

3072 
	`¢¥ötf
(
d°_buf„röfo
, (dst_bufferinfo),

3074 ()
d°_buf„ªd
,

3075 ()
d°_buf„ªd
);

3078 
§c_wrôãn
 = 
§c
->
wrôãn
.
byãs
;

3079 
d°_wrôãn
 = 
d°
->
wrôãn
.
byãs
;

3081 i‡(
iov
[
i
].
§uÀ
.
log
.
t˝öfo
) {

3082 c⁄° *
öfo
;

3083 
fdv
[] = { 
§c
->
s
, 
d°
->s };

3085 i‡((
öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0)) == NULL)

3086 *
t˝öfo
 = 
NUL
;

3088 #i‡
DIAGNOSTIC


3089 i‡(
	`°æí
(
öfo
Ë>(
t˝öfo
))

3090 
	`SWARNX
(
	`°æí
(
öfo
));

3093 
	`¢¥ötf
(
t˝öfo
, (tcpinfo),

3096 
öfo
);

3100 *
t˝öfo
 = 
NUL
;

3102 
	`¶og
(
LOG_INFO
,

3104 "%"
PRIu64
" (+ %s) "

3106 "%"
PRIu64
" (+ %s)"

3108 
	`¥Ÿocﬁ2°rög
(
iov
[
i
].
°©e
.
¥Ÿocﬁ
),

3109 
§c°rög
,

3110 
d°°rög
,

3111 
timeöfo
,

3112 
d°_wrôãn
,

3113 
d°_buf„röfo
,

3114 
§c_wrôãn
,

3115 
§c_buf„röfo
,

3116 
t˝öfo
);

3119 #i‡
HAVE_UDP_SUPPORT


3120 i‡(
iov
[
i
].
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
) {

3121 
uöt64_t
 
§c_∑ckëswrôãn
, 
d°_∑ckëswrôãn
;

3122 
size_t
 
§ci
;

3124 
	#UDPLOG
() \

3126 i‡(*
d°°rög
 =
NUL
) { \

3127 
	`¶og
(
LOG_INFO
, \

3129 "byã†å™s„ºed: %"
PRIu64
" <-> %"PRIu64", " \

3130 "∑ckës: %"
PRIu64
" <-> %"PRIu64"", \

3131 
	`¥Ÿocﬁ2°rög
(
iov
[
i
].
°©e
.
¥Ÿocﬁ
), \

3132 
§c°rög
, \

3133 
timeöfo
, \

3134 
d°_wrôãn
, \

3135 
§c_wrôãn
, \

3136 
d°_∑ckëswrôãn
, \

3137 
§c_∑ckëswrôãn
); \

3140 
	`¶og
(
LOG_INFO
, \

3142 "byã†å™s„ºed: %"
PRIu64
" <-> %"PRIu64", " \

3143 "∑ckës: %"
PRIu64
" <-> %"PRIu64"", \

3144 
	`¥Ÿocﬁ2°rög
(
iov
[
i
].
°©e
.
¥Ÿocﬁ
), \

3145 
§c°rög
, \

3146 
d°°rög
, \

3147 
timeöfo
, \

3148 
d°_wrôãn
, \

3149 
§c_wrôãn
, \

3150 
d°_∑ckëswrôãn
, \

3151 
§c_∑ckëswrôãn
); \

3153 }  0)

	)

3155 #i‡
SOCKS_SERVER


3156 i‡(
d°
->
d°c
 == 0) {

3164 
	`buûd_addr°r_§c
(
	`GET_HOSTIDV
(&
iov
[
i
].
°©e
),

3165 
	`GET_HOSTIDC
(&
iov
[
i
].
°©e
),

3166 &
§c
->
ho°
,

3167 
NULL
,

3168 
NULL
,

3169 
	`sockaddr2socksho°
(&
§c
->
œddr
, &
b
),

3170 &
§c
->
auth
,

3171 
NULL
,

3172 
§c°rög
,

3173 (
§c°rög
));

3175 *
d°°rög
 = 
NUL
;

3177 
§c_wrôãn
 = 
§c
->
wrôãn
.
byãs
;

3178 
§c_∑ckëswrôãn
 = 
§c
->
wrôãn
.
∑ckës
;

3180 
d°_wrôãn
 = 
d°
->
wrôãn
.
byãs
;

3181 
d°_∑ckëswrôãn
 = 
d°
->
wrôãn
.
∑ckës
;

3183 
	`UDPLOG
();

3188 
§ci
 = 0; srcò< 
d°
->
d°c
; ++srci) {

3189 c⁄° 
ud±¨gë_t
 *
˛õ¡
 = &
d°
->
d°v
[
§ci
];

3190 
sockaddr_°‹age
 
addr
;

3191 
socksho°_t
 
ho°
;

3193 
§c_wrôãn
 = 
˛õ¡
->
˛õ¡_wrôãn
.
byãs
,

3194 
§c_∑ckëswrôãn
 = 
˛õ¡
->
˛õ¡_wrôãn
.
∑ckës
;

3196 
d°_wrôãn
 = 
˛õ¡
->
èrgë_wrôãn
.
byãs
,

3197 
d°_∑ckëswrôãn
 = 
˛õ¡
->
èrgë_wrôãn
.
∑ckës
;

3199 
	`buûd_addr°r_§c
(
	`GET_HOSTIDV
(&
iov
[
i
].
°©e
),

3200 
	`GET_HOSTIDC
(&
iov
[
i
].
°©e
),

3201 #i‡
BAREFOOTD


3202 
	`sockaddr2socksho°
(&
˛õ¡
->˛õ¡, &
a
),

3204 
	`sockaddr2socksho°
(&
iov
[
i
].
§c
.
øddr
, &
a
),

3206 
NULL
,

3207 
NULL
,

3208 
	`sockaddr2socksho°
(&
§c
->
œddr
, &
b
),

3209 &
§c
->
auth
,

3210 
NULL
,

3211 
§c°rög
,

3212 (
§c°rög
));

3214 
	`buûd_addr°r_d°
(
	`sockaddr2socksho°
(&
˛õ¡
->
œddr
, &
a
),

3215 
iov
[
i
].
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ


3216 =
PROXY_DIRECT
 ?

3217 
NULL
 : 
	`sockaddr2socksho°
(&
˛õ¡
->
øddr
, &
b
),

3218 
iov
[
i
].
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ


3219 =
PROXY_DIRECT
 ?

3220 
NULL
 : &
iov
[
i
].
°©e
.
¥oxychaö
.
exèddr
,

3221 
	`sockaddr2socksho°
(

3222 
	`socksho°2sockaddr
(&
˛õ¡
->
øddrho°
,

3223 &
addr
),

3224 &
ho°
),

3225 &
d°
->
auth
,

3226 
NULL
,

3227 (
ö_addr
 *)
NULL
,

3229 
d°°rög
,

3230 (
d°°rög
));

3232 
	`¢¥ötf
(
timeöfo
, (timeinfo), "age: %lus, idle: %lus",

3233 ()
	`socks_dif·ime
(
äow
, 
˛õ¡
->
fú°io
.
tv_£c
),

3234 ()
	`socks_dif·ime
(
äow
, 
˛õ¡
->
œ°io
.
tv_£c
));

3236 
	`UDPLOG
();

3242 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

3243 
	}
}

3246 
	$‰ìbuf„rs
(
io
)

3247 c⁄° 
sockd_io_t
 *
io
;

3249 i‡(
io
->
c⁄åﬁ
.
s
 != -1)

3250 
	`socks_‰ìbuf„r
(
io
->
c⁄åﬁ
.
s
);

3252 
	`socks_‰ìbuf„r
(
io
->
§c
.
s
);

3254 
io
->
°©e
.
¥Ÿocﬁ
) {

3255 
SOCKS_TCP
:

3256 
	`socks_‰ìbuf„r
(
io
->
d°
.
s
);

3259 #i‡
HAVE_UDP_SUPPORT


3260 
SOCKS_UDP
: {

3261 
size_t
 
i
;

3263 
	`SASSERTX
(
SOCKS_SERVER
);

3265 
i
 = 0; i < 
io
->
d°
.
d°c
; ++i)

3266 
	`socks_‰ìbuf„r
(
io
->
d°
.
d°v
[
i
].
s
);

3272 
	`SERRX
(
io
->
°©e
.
¥Ÿocﬁ
);

3275 
	}
}

3278 
	$c⁄√˘°©us
(
io
, 
badfd
)

3279 
sockd_io_t
 *
io
;

3280 *
badfd
;

3282 c⁄° *
fun˘i⁄
 = "connectstatus()";

3283 
˛õ¡öfo_t
 
cöfo
;

3284 
sockÀn_t
 
Àn
;

3285 
§c
[
MAXSOCKSHOSTSTRING
], 
d°
[MAXSOCKSHOSTSTRING], 
buf
[2048];

3287 
	`SASSERTX
(
	`io_c⁄√˘isö¥ogªss
(
io
));

3288 
	`SASSERTX
(
io
->
d°
.
°©e
.
îr
 == 0);

3290 *
badfd
 = -1;

3292 
cöfo
.
‰om
 = 
	`CONTROLIO
(
io
)->
øddr
;

3293 
	`HOSTIDCOPY
(&
io
->
°©e
, &
cöfo
);

3298 
Àn
 = (
io
->
d°
.
øddr
);

3299 i‡(
	`gë≥î«me
(
io
->
d°
.
s
, 
	`TOSA
(&io->d°.
øddr
), &
Àn
) == 0) {

3300 
iﬁogaddr_t
 
§c
, 
d°
;

3302 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
io
->
°©e
.
time
.
e°ablished
);

3304 
	`¶og
(
LOG_DEBUG
, "%s: connectÅo %s on fd %d completed successfully",

3305 
fun˘i⁄
, 
	`socksho°2°rög
(&
io
->
d°
.
ho°
, 
NULL
, 0), io->d°.
s
);

3307 
io
->
d°
.
°©e
.
isc⁄√˘ed
 = 1;

3309 #i‡
HAVE_NEGOTIATE_PHASE


3310 i‡(
SOCKS_SERVER
 || 
io
->
ªqÊags
.
hâpc⁄√˘
) {

3311 
î∫o
 = 0;

3313 i‡(
	`£nd_c⁄√˘ª•⁄£
(
io
->
§c
.
s
, 0, io) != 0) {

3314 i‡(
io
->
§uÀ
.
m°©s_shmid
 != 0

3315 && (
io
->
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)) {

3316 
	`SASSERTX
(!
io
->
§c
.
°©e
.
Æ¨mdisc⁄√˘d⁄e
);

3318 
	`Æ¨m_add_disc⁄√˘
(0,

3319 &
io
->
§uÀ
,

3320 
ALARM_INTERNAL
,

3321 &
cöfo
,

3322 
	`°ªº‹
(
î∫o
),

3323 
sockscf
.
shmemfd
);

3325 
io
->
§c
.
°©e
.
Æ¨mdisc⁄√˘d⁄e
 = 1;

3328 *
badfd
 = 
io
->
§c
.
s
;

3334 
	`£tc⁄fsock›ti⁄s
(
io
->
d°
.
s
,

3335 
io
->
c⁄åﬁ
.
s
,

3336 
io
->
°©e
.
¥Ÿocﬁ
,

3338 
io
->
extsockë›ti⁄c
,

3339 
io
->
extsockë›ti⁄v
,

3340 
SOCKETOPT_POST
,

3341 
SOCKETOPT_POST
);

3343 
	`öô_iﬁogaddr
(&
§c
,

3344 
obje˘_sockaddr
,

3345 &
io
->
§c
.
œddr
,

3346 
obje˘_socksho°
,

3347 &
io
->
§c
.
ho°
,

3348 &
io
->
§c
.
auth
,

3349 
	`GET_HOSTIDV
(&
io
->
°©e
),

3350 
	`GET_HOSTIDC
(&
io
->
°©e
));

3352 
	`öô_iﬁogaddr
(&
d°
,

3353 
obje˘_sockaddr
,

3354 &
io
->
d°
.
œddr
,

3355 
obje˘_sockaddr
,

3356 &
io
->
d°
.
øddr
,

3357 &
io
->
d°
.
auth
,

3358 
NULL
,

3361 i‡(
io
->
§uÀ
.
log
.
t˝öfo
) {

3362 
fdv
[] = { 
io
->
§c
.
s
, io->
d°
.s };

3363 c⁄° *
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

3365 i‡(
t˝öfo
 !
NULL
) {

3366 
	`¢¥ötf
(
buf
, (buf),

3369 
t˝öfo
);

3372 *
buf
 = 
NUL
;

3375 *
buf
 = 
NUL
;

3377 
	`iﬁog
(&
io
->
§uÀ
,

3378 &
io
->
°©e
,

3379 
OPERATION_CONNECT
,

3380 &
§c
,

3381 &
d°
,

3382 
NULL
,

3383 
NULL
,

3384 
buf
,

3385 
	`°æí
(
buf
));

3387 i‡(
	`io_fûl£t_c⁄√˘ö¥ogªss
(
NULL
) == -1)

3388 
io°©e
.
havec⁄√˘ö¥ogªss
 = 0;

3397 
	`¶og
(
LOG_DEBUG
, "%s: getpeername(2) on fd %d failed: %s",

3398 
fun˘i⁄
, 
io
->
d°
.
s
, 
	`°ªº‹
(
î∫o
));

3400 i‡(
io
->
§uÀ
.
m°©s_shmid
 != 0

3401 && (
io
->
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)) {

3402 
	`SASSERTX
(!
io
->
d°
.
°©e
.
Æ¨mdisc⁄√˘d⁄e
);

3404 
	`Æ¨m_add_disc⁄√˘
(0,

3405 &
io
->
§uÀ
,

3406 
ALARM_EXTERNAL
,

3407 &
cöfo
,

3408 
	`°ªº‹
(
î∫o
),

3409 
sockscf
.
shmemfd
);

3411 
io
->
d°
.
°©e
.
Æ¨mdisc⁄√˘d⁄e
 = 1;

3414 
Àn
 = (
î∫o
);

3415 ()
	`gësock›t
(
io
->
d°
.
s
, 
SOL_SOCKET
, 
SO_ERROR
, &
î∫o
, &
Àn
);

3417 i‡(
î∫o
 == 0) {

3418 
	`sw¨nx
("%s: strange ... getpeername(2) failed, but getsockopt(2) "

3420 
fun˘i⁄
);

3422 
io
->
d°
.
°©e
.
îr
 = 
î∫o
 = 
ECONNREFUSED
;

3425 
io
->
d°
.
°©e
.
îr
 = 
î∫o
;

3427 
	`¶og
(
LOG_DEBUG
,

3429 
fun˘i⁄
,

3430 
	`socksho°2°rög
(&
io
->
d°
.
ho°
, dst, (dst)),

3431 
io
->
d°
.
s
,

3432 
	`socksho°2°rög
(&
io
->
§c
.
ho°
, src, (src)),

3433 
	`°ªº‹
(
î∫o
));

3435 
	`log_c⁄√˘Áûed
(
EXTERNALIF
, 
d°
);

3437 #i‡
HAVE_NEGOTIATE_PHASE


3438 i‡(
SOCKS_SERVER
 || 
io
->
ªqÊags
.
hâpc⁄√˘
) {

3439 
	`SASSERTX
(
î∫o
 != 0);

3441 i‡(
	`£nd_c⁄√˘ª•⁄£
(
io
->
§c
.
s
, 
î∫o
, io) != 0)

3442 
î∫o
 = 
io
->
d°
.
°©e
.
îr
;

3446 *
badfd
 = 
io
->
d°
.
s
;

3448 
	}
}

3451 
	$io_upd©e
(
timíow
, 
bwu£d
, 
i_ªad
, 
i_wrôãn
,

3452 
e_ªad
, 
e_wrôãn
, 
ruÀ
, 
∑ckëruÀ
, 
lock
, 
uid
)

3453 c⁄° 
timevÆ
 *
timíow
;

3454 c⁄° 
size_t
 
bwu£d
;

3455 c⁄° 
iocou¡_t
 *
i_ªad
;

3456 c⁄° 
iocou¡_t
 *
i_wrôãn
;

3457 c⁄° 
iocou¡_t
 *
e_ªad
;

3458 c⁄° 
iocou¡_t
 *
e_wrôãn
;

3459 
ruÀ_t
 *
ruÀ
;

3460 
ruÀ_t
 *
∑ckëruÀ
;

3461 c⁄° 
lock
;

3462 c⁄° 
uöt32_t
 
uid
;

3464 c⁄° *
fun˘i⁄
 = "io_update()";

3465 c⁄° 
iocou¡_t
 
zîo
 = { 0 };

3466 
m⁄ô‹_°©s_t
 *
m⁄ô‹
;

3467 
did©èch
;

3469 
	`¶og
(
LOG_DEBUG
, "%s: bwused %lu, bw_shmid %lu, mstats_shmid %lu",

3470 
fun˘i⁄
,

3471 ()
bwu£d
,

3472 (
ruÀ
 =
NULL
 ||ÑuÀ->
bw_shmid
 == 0) ?

3473 0 : ()
ruÀ
->
bw_shmid
,

3474 ()
∑ckëruÀ
->
m°©s_shmid
);

3476 i‡(
ruÀ
 !
NULL
 &&ÑuÀ->
bw_shmid
 !0 && 
bwu£d
 != 0) {

3477 
	`SASSERTX
(
ruÀ
->
bw
 !
NULL
);

3478 
	`bw_upd©e
(
ruÀ
->
bw
, 
bwu£d
, 
timíow
, 
lock
);

3481 i‡(
∑ckëruÀ
->
m°©s_shmid
 == 0

3482 || !(
∑ckëruÀ
->
Æ¨msc⁄figuªd
 & 
ALARM_DATA
))

3485 i‡(
∑ckëruÀ
->
m°©s
 =
NULL
) {

3489 
	`SASSERTX
(
∑ckëruÀ
 !
ruÀ
);

3490 
	`SASSERTX
(
SOCKS_SERVER
);

3492 i‡(
	`sockd_shm©
(
∑ckëruÀ
, 
SHMEM_MONITOR
) != 0)

3495 
did©èch
 = 1;

3498 
did©èch
 = 0;

3500 
	`SASSERTX
(
∑ckëruÀ
->
m°©s
 !
NULL
);

3501 
m⁄ô‹
 = &
∑ckëruÀ
->
m°©s
->
obje˘
.monitor;

3503 
	#MPTCP_AUTH_UUID
 29

	)

3504 
i
;

3505 
u£r_öfo_t
 *
uif
 = &
∑ckëruÀ
->
m°©s
->
obje˘
.
m⁄ô‹
.
u£r_öfo
;

3506 i‡(
uif
) {

3507 
uuid
 = 0;

3508 
rc
 = -1;

3509 
Ø
 = ();

3510 
rc
 = 
	`gësock›t
(
uid
, 
IPPROTO_TCP
, 
MPTCP_AUTH_UUID
, &
uuid
, &
Ø
);

3512 
i
 = 0; i < 
uif
->
u£r_˙t
; i++) {

3513 i‡(
uuid
 !0 && 
uif
->
Æ¨m
[
i
].
uid
 == uuid) {

3520 
	`socks_lock
(
sockscf
.
shmemfd
, (
off_t
)
∑ckëruÀ
->
m°©s_shmid
, 1, 1, 1);

3522 
	`MUNPROTECT_SHMEMHEADER
(
∑ckëruÀ
->
m°©s
);

3524 i‡(
m⁄ô‹
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


3525 && 
i_ªad
 !
NULL


3526 && 
	`memcmp
(&
zîo
, 
i_ªad
, (zero)) != 0) {

3527 
m⁄ô‹
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
byãs
 +
i_ªad
->bytes;

3528 
m⁄ô‹
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°io
 = *
timíow
;

3531 i‡(
m⁄ô‹
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd


3532 && 
i_wrôãn
 !
NULL


3533 && 
	`memcmp
(&
zîo
, 
i_wrôãn
, (zero)) != 0) {

3534 
m⁄ô‹
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
byãs
 +
i_wrôãn
->bytes;

3535 
m⁄ô‹
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°io
 = *
timíow
;

3538 
uif
 ? uif->
Æ¨m
[
i
].
u∂ﬂds
 +
e_wrôãn
->
byãs
 : 0;

3542 i‡(
m⁄ô‹
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd


3543 && 
e_ªad
 !
NULL


3544 && 
	`memcmp
(&
zîo
, 
e_ªad
, (zero)) != 0) {

3545 
m⁄ô‹
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
byãs
 +
e_ªad
->bytes;

3546 
m⁄ô‹
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
œ°io
 = *
timíow
;

3549 i‡(
m⁄ô‹
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd


3550 && 
e_wrôãn
 !
NULL


3551 && 
	`memcmp
(&
zîo
, 
e_wrôãn
, (zero)) != 0) {

3552 
m⁄ô‹
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
byãs
 +
e_wrôãn
->bytes;

3553 
m⁄ô‹
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
œ°io
 = *
timíow
;

3556 
uif
 ? uif->
Æ¨m
[
i
].
dow∆ﬂds
 +
i_wrôãn
->
byãs
 : 0;

3557 
	`MPROTECT_SHMEMHEADER
(
∑ckëruÀ
->
m°©s
);

3559 
	`socks_u∆ock
(
sockscf
.
shmemfd
, (
off_t
)
∑ckëruÀ
->
m°©s_shmid
, 1);

3561 
	`¶og
(
LOG_DEBUG
,

3564 
fun˘i⁄
,

3565 ()
∑ckëruÀ
->
m°©s_shmid
,

3566 
i_ªad
 !
NULL
 && 
m⁄ô‹
->
öã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
 ?

3567 ()
i_ªad
->
byãs
 : 0,

3568 
i_wrôãn
 !
NULL
 && 
m⁄ô‹
->
öã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
 ?

3569 ()
i_wrôãn
->
byãs
 : 0,

3570 
e_ªad
 !
NULL
 && 
m⁄ô‹
->
exã∫Æ
.
Æ¨m
.
d©a
.
ªcv
.
isc⁄figuªd
 ?

3571 ()
e_ªad
->
byãs
 : 0,

3572 
e_wrôãn
 !
NULL
 && 
m⁄ô‹
->
exã∫Æ
.
Æ¨m
.
d©a
.
£nd
.
isc⁄figuªd
 ?

3573 ()
e_wrôãn
->
byãs
 : 0);

3575 i‡(
did©èch
)

3576 
	`sockd_shmdt
(
∑ckëruÀ
, 
SHMEM_MONITOR
);

3577 
	}
}

3580 
	$io_dñëe
(
mŸhî
, 
io
, 
badfd
, 
°©us
)

3581 
mŸhî
;

3582 
sockd_io_t
 *
io
;

3583 
badfd
;

3584 c⁄° 
io°©us_t
 
°©us
;

3586 c⁄° *
fun˘i⁄
 = "io_delete()";

3587 c⁄° 
i§evî£d
 = (
io
->
°©e
.
comm™d
 =
SOCKS_BINDREPLY
 ? 1 : 0);

3588 c⁄° 
î∫o_s
 = 
î∫o
;

3589 #i‡
HAVE_GSSAPI


3590 
OM_uöt32
 
maj‹_°©us
, 
mö‹_°©us
;

3592 
timevÆ
 
äow
;

3593 
ruÀ_t
 *
ruÀv
[] = {

3594 &
io
->
§uÀ
,

3595 #i‡
HAVE_SOCKS_HOSTID


3596 
io
->
hruÀ_is£t
 ? &io->
hruÀ
 : 
NULL
,

3598 &
io
->
¸uÀ
,

3600 
˛õ¡öfo_t
 
cöfo
;

3601 
size_t
 
ruÀi
;

3602 
buf
[512], 
t˝öfo
[
MAXTCPINFOLEN
];

3603 
comm™d
, 
¥Ÿocﬁ
;

3605 
	`¶og
(
LOG_DEBUG
,

3607 #i‡
HAVE_UDP_SUPPORT


3611 
fun˘i⁄
,

3612 
	`comm™d2°rög
(
io
->
°©e
.
comm™d
),

3613 
badfd
,

3614 
io
->
c⁄åﬁ
.
s
,

3615 
io
->
§c
.
s
,

3616 
io
->
d°
.
s


3617 #i‡
HAVE_UDP_SUPPORT


3619 ()
io
->
d°
.
d°c


3623 
	`SASSERTX
–
badfd
 == -1

3624 || 
badfd
 =
io
->
§c
.
s


3625 || 
badfd
 =
io
->
c⁄åﬁ
.
s


3626 || 
badfd
 =
io
->
d°
.
s
);

3628 
	`SASSERTX
(
io
->
Æloˇãd
);

3630 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

3632 #i‡
SOCKS_SERVER


3640 
size_t
 
d°i
 = 0;

3644 
ruÀi
 = 0;ÑuÀò< 
	`ELEMENTS
(
ruÀv
); ++rulei) {

3645 c⁄° 
ruÀ_t
 *
ruÀ
 = 
ruÀv
[
ruÀi
];

3646 
socksho°_t
 
a
, 
b
;

3647 
uöt64_t
 
§c_ªad
, 
§c_wrôãn
, 
d°_ªad
, 
d°_wrôãn
;

3648 
size_t
 
bufu£d
;

3649 
ö
[
MAX_IOLOGADDR
], 
out
[MAX_IOLOGADDR],

3650 
timeöfo
[512],

3651 
logmsg
[(
ö
Ë+ (
out
Ë+ 1024 + (
timeöfo
)];

3653 i‡(
ruÀ
 =
NULL
)

3656 #i‡!
HAVE_SOCKS_RULES


3657 i‡(
ruÀ
->
ty≥
 =
obje˘_¸uÀ
 && !
sockscf
.
›ti⁄
.
debug
)

3661 i‡(
ruÀ
->
log
.
disc⁄√˘


3662 || (
ruÀ
->
log
.
îr‹
 && (
°©us
 =
IO_IOERROR
)))

3667 
¥Ÿocﬁ
 = 
io
->
°©e
.protocol;

3669 i‡(
¥Ÿocﬁ
 =
SOCKS_TCP
 && 
ruÀ
->
log
.
t˝öfo
) {

3670 c⁄° *
öfo
;

3671 
fdv
[] = { 
	`CLIENTIO
(
io
)->
s
, 
	`EXTERNALIO
(io)->s };

3673 i‡((
öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0)) == NULL)

3674 *
t˝öfo
 = 
NUL
;

3676 #i‡
DIAGNOSTIC


3677 i‡(
	`°æí
(
öfo
Ë>(
t˝öfo
))

3678 
	`SWARNX
(
	`°æí
(
öfo
));

3681 
	`¢¥ötf
(
t˝öfo
, (tcpinfo),

3684 
öfo
);

3688 *
t˝öfo
 = 
NUL
;

3690 i‡(
ruÀ
->
ty≥
 =
obje˘_§uÀ
) {

3691 
	`buûd_addr°r_§c
(
	`GET_HOSTIDV
(&
io
->
°©e
),

3692 
	`GET_HOSTIDC
(&
io
->
°©e
),

3693 &
io
->
§c
.
ho°
,

3694 
NULL
,

3695 
NULL
,

3696 
	`sockaddr2socksho°
(&
io
->
§c
.
œddr
, 
NULL
),

3697 &
io
->
§c
.
auth
,

3698 
NULL
,

3699 
ö
,

3700 (
ö
));

3702 
io
->
°©e
.
comm™d
) {

3703 
SOCKS_BIND
:

3704 
SOCKS_BINDREPLY
:

3705 
SOCKS_CONNECT
:

3706 
	`buûd_addr°r_d°
(
	`sockaddr2socksho°
(&
io
->
d°
.
œddr
, &
a
),

3707 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ


3708 =
PROXY_DIRECT
 ?

3709 
NULL
 : 
	`sockaddr2socksho°
(&
io
->
d°
.
øddr
, &
b
),

3710 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ


3711 =
PROXY_DIRECT
 ?

3712 
NULL
 : &
io
->
°©e
.
¥oxychaö
.
exèddr
,

3713 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ


3714 =
PROXY_DIRECT
 ?

3715 
	`sockaddr2socksho°
(&
io
->
d°
.
øddr
, 
NULL
)

3716 : &
io
->
d°
.
ho°
,

3717 &
io
->
d°
.
auth
,

3718 
NULL
,

3719 (
ö_addr
 *)
NULL
,

3721 
out
,

3722 (
out
));

3725 #i‡
HAVE_UDP_SUPPORT


3726 
SOCKS_UDPASSOCIATE
: {

3727 
socksho°_t
 
a
, 
b
;

3729 i‡(
io
->
d°
.
d°c
 == 0)

3730 *
out
 = 
NUL
;

3732 
ud±¨gë_t
 *
ud±¨gë
;

3734 #i‡
SOCKS_SERVER


3739 
	`SASSERTX
(
d°i
 < 
io
->
d°
.
d°c
);

3740 
ud±¨gë
 = &
io
->
d°
.
d°v
[
d°i
];

3744 
	`SASSERTX
(
io
->
d°
.
s
 != -1);

3746 
ud±¨gë
 = 
	`˛õ¡ofsockë
(
io
->
d°
.
s
,

3747 
io
->
d°
.
d°c
,

3748 
io
->
d°
.
d°v
);

3750 
	`SASSERTX
(
ud±¨gë
 !
NULL
);

3754 
	`io_syncudp
(
io
, 
ud±¨gë
);

3756 
	`buûd_addr°r_d°
(
	`sockaddr2socksho°
(&
io
->
d°
.
œddr
, &
a
),

3757 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ


3758 =
PROXY_DIRECT
 ?

3759 
NULL
 : 
	`sockaddr2socksho°
(&
io
->
d°
.
øddr
, &
b
),

3760 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ


3761 =
PROXY_DIRECT
 ?

3762 
NULL
 : &
io
->
°©e
.
¥oxychaö
.
exèddr
,

3763 
io
->
d°
.
°©e
.
isc⁄√˘ed
 ?

3764 
	`sockaddr2socksho°
(&
io
->
d°
.
øddr
, &
b
Ë: 
NULL
,

3765 &
io
->
d°
.
auth
,

3766 
NULL
,

3767 
NULL
,

3769 
out
,

3770 (
out
));

3772 #i‡
SOCKS_SERVER


3773 i‡(++
d°i
 < 
io
->
d°
.
d°c
) {

3777 --
ruÀi
;

3787 
	`SERRX
(
io
->
°©e
.
comm™d
);

3790 
comm™d
 = 
io
->
°©e
.command;

3798 #i‡!
HAVE_SOCKS_RULES


3803 i‡(
¥Ÿocﬁ
 =
SOCKS_UDP
)

3807 
	`buûd_addr°r_§c
(
	`GET_HOSTIDV
(&
io
->
°©e
),

3808 
	`GET_HOSTIDC
(&
io
->
°©e
),

3809 &
	`CONTROLIO
(
io
)->
ho°
,

3810 
NULL
,

3811 
NULL
,

3812 
	`sockaddr2socksho°
(&
	`CONTROLIO
(
io
)->
œddr
, 
NULL
),

3813 &
io
->
ˇuth
,

3814 
NULL
,

3815 
ö
,

3816 (
ö
));

3818 #i‡
HAVE_SOCKS_RULES


3819 *
out
 = 
NUL
;

3822 
	`buûd_addr°r_d°
(
NULL
,

3823 
NULL
,

3824 
NULL
,

3825 &
io
->
d°
.
ho°
,

3826 &
io
->
d°
.
auth
,

3827 
NULL
,

3828 (
ö_addr
 *)
NULL
,

3830 
out
,

3831 (
out
));

3834 
	`SASSERTX
(
ruÀ
->
ty≥
 !
obje˘_§uÀ
);

3836 #i‡
HAVE_SOCKS_RULES


3837 
comm™d
 = (
ruÀ
->
ty≥
 =
obje˘_¸uÀ
 ? 
SOCKS_ACCEPT
: 
SOCKS_HOSTID
);

3838 
¥Ÿocﬁ
 = 
SOCKS_TCP
;

3841 
ruÀ
->
ty≥
) {

3842 
obje˘_¸uÀ
:

3843 i‡(
¥Ÿocﬁ
 =
SOCKS_TCP
)

3844 
comm™d
 = 
SOCKS_ACCEPT
;

3846 
comm™d
 = 
SOCKS_UDPASSOCIATE
;

3849 #i‡
HAVE_SOCKS_HOSTID


3850 
obje˘_hruÀ
:

3851 
comm™d
 = 
SOCKS_HOSTID
;

3856 
	`SERRX
(
ruÀ
->
ty≥
);

3862 
bufu£d
 = 
	`¢¥ötf
(
logmsg
, (logmsg), "%s(%lu): %s/%s ]: ",

3863 
ruÀ
->
vîdi˘
 =
VERDICT_PASS
 ?

3864 
VERDICT_PASSs
 : 
VERDICT_BLOCKs
,

3865 #i‡!
HAVE_SOCKS_RULES


3867 
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
 ?

3868 ()
io
->
¸uÀ
.
numbî


3869 : ()
ruÀ
->
numbî
,

3871 ()
ruÀ
->
numbî
,

3873 
	`¥Ÿocﬁ2°rög
(
¥Ÿocﬁ
),

3874 
	`comm™d2°rög
(
comm™d
));

3876 
§c_ªad
 = 
io
->
§c
.
ªad
.
byãs
;

3877 
§c_wrôãn
 = 
io
->
§c
.
wrôãn
.
byãs
;

3878 
d°_ªad
 = 
io
->
d°
.
ªad
.
byãs
;

3879 
d°_wrôãn
 = 
io
->
d°
.
wrôãn
.
byãs
;

3881 i‡(
¥Ÿocﬁ
 =
SOCKS_TCP
) {

3882 i‡(*
out
 =
NUL
) {

3883 
bufu£d
 +
	`¢¥ötf
(&
logmsg
[bufused], (logmsg) - bufused,

3884 "%"
PRIu64
" -> %s -> %"PRIu64"",

3885 (
i§evî£d
 ? 
d°_wrôãn
 : 
§c_wrôãn
),

3886 
ö
,

3887 (
i§evî£d
 ? 
§c_wrôãn
 : 
d°_wrôãn
));

3890 
bufu£d
 +
	`¢¥ötf
(&
logmsg
[bufused], (logmsg) - bufused,

3891 "%"
PRIu64
" -> %s -> %"PRIu64", "

3892 "%"
PRIu64
" -> %s -> %"PRIu64"",

3893 
§c_wrôãn
, 
ö
, 
§c_ªad
,

3894 
d°_wrôãn
, 
out
, 
d°_ªad
);

3897 
	`SASSERTX
(
¥Ÿocﬁ
 =
SOCKS_UDP
);

3899 i‡(
ruÀ
->
ty≥
 =
obje˘_§uÀ
) {

3900 
bufu£d
 +=

3901 
	`¢¥ötf
(&
logmsg
[
bufu£d
], (logmsg) - bufused,

3902 "%"
PRIu64
"/%"PRIu64" -> %s -> %"PRIu64"/%"PRIu64"",

3903 
§c_wrôãn
,

3904 
io
->
§c
.
wrôãn
.
∑ckës
,

3905 
ö
,

3906 
§c_ªad
,

3907 
io
->
§c
.
ªad
.
∑ckës
);

3910 i‡(*
out
 !
NUL
) {

3911 
bufu£d
 +=

3912 
	`¢¥ötf
(&
logmsg
[
bufu£d
], (logmsg) - bufused,

3913 ", %"
PRIu64
"/%"PRIu64" -> %s -> %"PRIu64"/%"PRIu64"",

3914 
d°_wrôãn
,

3915 
io
->
d°
.
wrôãn
.
∑ckës
,

3916 
out
,

3917 
d°_ªad
,

3918 
io
->
d°
.
ªad
.
∑ckës
);

3922 
	`SASSERTX
(*
out
 =
NUL
);

3925 
bufu£d
 = 
	`¢¥ötf
(
timeöfo
, (timeinfo),

3927 ()–
äow
.
tv_£c


3928 - 
io
->
°©e
.
time
.
ac˚±ed
.
tv_£c
));

3936 i‡(
sockscf
.
›ti⁄
.
debug


3937 #i‡
BAREFOOTD


3938 && 
¥Ÿocﬁ
 =
SOCKS_TCP


3941 
timevÆ
 
ac˚±2√g
, 
√g°¨t2√gföish
, 
£ssi⁄duøti⁄
;

3942 
e°ablished2io_°r
[16], 
√gföish2e°ablished_°r
[16];

3944 
	`timîsub
(&
io
->
°©e
.
time
.
√gŸüã°¨t
,

3945 &
io
->
°©e
.
time
.
ac˚±ed
,

3946 &
ac˚±2√g
);

3948 
	`timîsub
(&
io
->
°©e
.
time
.
√gŸüãíd
,

3949 &
io
->
°©e
.
time
.
√gŸüã°¨t
,

3950 &
√g°¨t2√gföish
);

3952 i‡(
io
->
°©e
.
time
.
e°ablished
.
tv_£c
 == 0)

3953 
	`STRCPY_ASSERTSIZE
(
√gföish2e°ablished_°r
, "N/A");

3955 
timevÆ
 
tdiff
;

3957 
	`timîsub
(&
io
->
°©e
.
time
.
e°ablished
,

3958 &
io
->
°©e
.
time
.
√gŸüãíd
,

3959 &
tdiff
);

3961 
	`¢¥ötf
(
√gföish2e°ablished_°r
, (
e°ablished2io_°r
),

3962 "%ld.%06lds", ()
tdiff
.
tv_£c
, (Èdiff.
tv_u£c
);

3965 i‡(
io
->
°©e
.
time
.
fú°io
.
tv_£c
 == 0)

3966 
	`STRCPY_ASSERTSIZE
(
e°ablished2io_°r
, "N/A");

3968 
timevÆ
 
tdiff
;

3970 
	`timîsub
(&
io
->
°©e
.
time
.
fú°io
, &io->°©e.time.
e°ablished
,

3971 &
tdiff
);

3973 
	`¢¥ötf
(
e°ablished2io_°r
, (established2io_str),

3974 "%ld.%06lds", ()
tdiff
.
tv_£c
, (Èdiff.
tv_u£c
);

3977 
	`timîsub
(&
äow
, &
io
->
°©e
.
time
.
ac˚±ed
, &
£ssi⁄duøti⁄
);

3979 
bufu£d
 +
	`¢¥ötf
(&
timeöfo
[bufused], (timeinfo) - bufused,

3986 ()
ac˚±2√g
.
tv_£c
,

3987 ()
ac˚±2√g
.
tv_u£c
,

3988 ()
√g°¨t2√gföish
.
tv_£c
,

3989 ()
√g°¨t2√gföish
.
tv_u£c
,

3990 
√gföish2e°ablished_°r
,

3991 
e°ablished2io_°r
,

3992 ()
£ssi⁄duøti⁄
.
tv_£c
,

3993 ()
£ssi⁄duøti⁄
.
tv_u£c
);

3996 
î∫o
 = 
î∫o_s
;

3997 
°©us
) {

3998 
IO_BLOCK
:

3999 
	`¶og
(
LOG_INFO
, "%s: blocked. %s%s", 
logmsg
, 
timeöfo
, 
t˝öfo
);

4002 
IO_IOERROR
:

4003 
IO_ERROR
:

4004 i‡(
î∫o
 != 0)

4005 
	`¢¥ötf
(
buf
, (buf), " (%s)", 
	`°ªº‹
(
î∫o
));

4007 *
buf
 = 
NUL
;

4009 
	`¶og
(
LOG_INFO
, "%s: %sÉrror%s. %s%s",

4010 
logmsg
,

4011 
badfd
 < 0 ? "session"

4012 : (
badfd
 =
io
->
d°
.
s
 && !
i§evî£d
) ?

4014 
buf
,

4015 
timeöfo
,

4016 
t˝öfo
);

4018 i‡(
badfd
 >0 && (
	`ERRNOISRST
(
î∫o
))) {

4019 i‡(
io
->
d°
.
s
 !-1 && 
badfd
 == io->dst.s)

4020 
	`sockd_r°⁄˛o£
(
io
->
§c
.
s
);

4021 i‡(
badfd
 =
io
->
§c
.
s
 && io->
d°
.s != -1)

4022 
	`sockd_r°⁄˛o£
(
io
->
d°
.
s
);

4026 
IO_CLOSE
:

4027 
	`¶og
(
LOG_INFO
, "%s: %s closed. %s%s",

4028 
logmsg
,

4029 
badfd
 < 0 ? "£ssi⁄" : badfd =
io
->
d°
.
s
 ?

4031 
timeöfo
,

4032 
t˝öfo
);

4035 
IO_TIMEOUT
: {

4036 c⁄° *
timeoutöfo
 = 
NULL
;

4037 
timeouây≥_t
 
timeouây≥
;

4038 
time_t
 
timeu¡ûtimeout
;

4040 
timeu¡ûtimeout
 = 
	`io_timeu¡ûtimeout
(
io
, &
äow
, &
timeouây≥
, 0);

4041 
	`SASSERTX
(
timeu¡ûtimeout
 <= 0);

4042 
	`SASSERTX
(
timeouây≥
 !
TIMEOUT_NOTSET
);

4044 i‡(
timeouây≥
 =
TIMEOUT_TCP_FIN_WAIT
) {

4045 
	`SASSERTX
(
io
->
§c
.
°©e
.
fö_ª˚ived


4046 || 
io
->
d°
.
°©e
.
fö_ª˚ived
);

4048 i‡(
io
->
d°
.
°©e
.
fö_ª˚ived
)

4049 
timeoutöfo
 = " (waiting for clientÅo close)";

4051 
timeoutöfo
 = " (waiting forÑemoteÖeerÅo close)";

4055 
	`¶og
(
LOG_INFO
, "%s: %s%s. %s%s",

4056 
logmsg
,

4057 
	`timeouây≥2°rög
(
timeouây≥
),

4058 
timeoutöfo
 =
NULL
 ? "" :Åimeoutinfo,

4059 
timeöfo
,

4060 
t˝öfo
);

4065 
IO_ADMINTERMINATION
:

4066 
	`¶og
(
LOG_INFO
, "%s:ádministrativeÅermination. %s%s",

4067 
logmsg
, 
timeöfo
, 
t˝öfo
);

4071 
	`SERRX
(
°©us
);

4074 #i‡
SOCKS_SERVER


4075 i‡(
io
->
°©e
.
comm™d
 =
SOCKS_BINDREPLY
 && 
ruÀ
->
ty≥
 =
obje˘_§uÀ
) {

4079 c⁄° 
‹igöÆ_comm™d
 = 
io
->
°©e
.
comm™d
;

4080 
iﬁogaddr_t
 
§c
, 
d°
;

4082 
	`öô_iﬁogaddr
(&
§c
,

4083 
obje˘_sockaddr
,

4084 &
io
->
§c
.
œddr
,

4085 
obje˘_socksho°
,

4086 
io
->
°©e
.
exãnsi⁄
.
böd
 ? 
NULL
 : &io->
cmd
.böd.
ho°
,

4087 &
io
->
§c
.
auth
,

4088 
	`GET_HOSTIDV
(&
io
->
°©e
),

4089 
	`GET_HOSTIDC
(&
io
->
°©e
));

4091 
	`öô_iﬁogaddr
(&
d°
,

4092 
obje˘_sockaddr
,

4093 &
io
->
d°
.
œddr
,

4094 
obje˘_sockaddr
,

4095 &
io
->
d°
.
øddr
,

4096 &
io
->
d°
.
auth
,

4097 
NULL
,

4100 
io
->
°©e
.
comm™d
 = 
SOCKS_BIND
;

4106 
	`iﬁog
(&
io
->
cmd
.
böd
.
ruÀ
,

4107 &
io
->
°©e
,

4108 
OPERATION_DISCONNECT
,

4109 &
d°
,

4110 &
§c
,

4111 
NULL
,

4112 
NULL
,

4113 
t˝öfo
,

4114 
	`°æí
(
t˝öfo
));

4116 
io
->
°©e
.
comm™d
 = 
‹igöÆ_comm™d
;

4121 #i‡
HAVE_GSSAPI


4122 i‡(
io
->
§c
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

4123 i‡((
maj‹_°©us


4124 
	`gss_dñëe_£c_c⁄ãxt
(&
mö‹_°©us
,

4125 &
io
->
§c
.
auth
.
md©a
.
gsßpi
.
°©e
.
id
,

4126 
GSS_C_NO_BUFFER
)Ë!
GSS_S_COMPLETE
) {

4127 i‡(!
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, (buf)))

4128 *
buf
 = 
NUL
;

4130 
	`sw¨nx
("%s: gss_delete_sec_context() of src failed%s%s",

4131 
fun˘i⁄
,

4132 *
buf
 =
NUL
 ? "" : ": ",

4133 *
buf
 =
NUL
 ? "" : buf);

4137 i‡(
io
->
d°
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

4138 i‡((
maj‹_°©us


4139 
	`gss_dñëe_£c_c⁄ãxt
(&
mö‹_°©us
,

4140 &
io
->
d°
.
auth
.
md©a
.
gsßpi
.
°©e
.
id
,

4141 
GSS_C_NO_BUFFER
)Ë!
GSS_S_COMPLETE
) {

4142 i‡(!
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, (buf)))

4143 *
buf
 = 
NUL
;

4145 
	`sw¨nx
("%s: gss_delete_sec_context() of dst failed%s%s",

4146 
fun˘i⁄
,

4147 *
buf
 =
NUL
 ? "" : ": ",

4148 *
buf
 =
NUL
 ? "" : buf);

4153 #i‡
BAREFOOTD


4154 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
) {

4160 
	`ªmove˛õ¡
(
io
->
d°
.
s
, &io->d°.
d°c
, io->d°.
d°v
);

4161 
	`socks_‰ìbuf„r
(
io
->
d°
.
s
);

4162 
io
->
d°
.
s
 = -1;

4168 
	`‰ìbuf„rs
(
io
);

4169 
	`io_add_Æ¨mdisc⁄√˘s
(
io
, "session delete");

4170 
	`˛o£_iodes¸ùt‹s
(
io
);

4172 i‡(
mŸhî
 != -1) {

4173 c⁄° 
öfo
 = (
io
->
°©e
.
comm™d
 =
SOCKS_UDPASSOCIATE
 ?

4174 
SOCKD_FREESLOT_UDP
 : 
SOCKD_FREESLOT_TCP
);

4177 i‡(
	`socks_£ndt⁄
(
mŸhî
,

4178 &
öfo
,

4179 (
öfo
),

4180 (
öfo
),

4182 
NULL
,

4184 
NULL
,

4185 
NULL
Ë!(
öfo
))

4186 
	`¶og
(
	`sockd_mŸhîexi°s
(Ë? 
LOG_WARNING
 : 
LOG_DEBUG
,

4188 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

4191 i‡(
io
->
°©e
.
comm™d
 =
SOCKS_CONNECT
)

4192 i‡(
	`io_fûl£t_c⁄√˘ö¥ogªss
(
NULL
) == -1)

4193 
io°©e
.
havec⁄√˘ö¥ogªss
 = 0;

4195 
	`HOSTIDCOPY
(&
io
->
°©e
, &
cöfo
);

4197 
	`log_ruÀöfo_shmid
(
	`CRULE_OR_HRULE
(
io
), 
fun˘i⁄
, "before SHMEM_UNUSE()");

4199 i‡(
io
->
§uÀ
.
ty≥
 =
obje˘_n⁄e
) {

4200 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
);

4201 
	`SASSERTX
(!
HAVE_SOCKS_RULES
);

4204 
	`log_ruÀöfo_shmid
(&
io
->
§uÀ
, 
fun˘i⁄
, "before SHMEM_UNUSE()");

4206 
	`SASSERTX
(!(
	`SHMID_ISSET
(
	`CRULE_OR_HRULE
(
io
)Ë&& SHMID_ISSET(&io->
§uÀ
)));

4208 
cöfo
.
‰om
 = 
	`CONTROLIO
(
io
)->
øddr
;

4210 #i‡
HAVE_CONTROL_CONNECTION


4212 
	`SHMEM_UNUSE
(
	`SHMEMRULE
(
io
), &
cöfo
, 
sockscf
.
shmemfd
, 
SHMEM_ALL
);

4216 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
)

4217 
	`SHMEM_UNUSE
(
	`SHMEMRULE
(
io
), &
cöfo
, 
sockscf
.
shmemfd
, 
SHMEM_ALL
);

4221 #i‡
SOCKS_SERVER


4222 
	`bzîo
(
io
->
d°
.
d°v
, (*io->d°.d°vË* io->d°.
d°c
);

4225 
	`bzîo
(
io
, (*io));

4227 
	`¥o˘ôÀupd©e
();

4228 
	}
}

4232 
	$io_c⁄√˘isö¥ogªss
(
io
)

4233 c⁄° 
sockd_io_t
 *
io
;

4235 i‡(
io
->
Æloˇãd


4236 && 
io
->
°©e
.
comm™d
 =
SOCKS_CONNECT


4237 && !
io
->
d°
.
°©e
.
isc⁄√˘ed
)

4241 
	}
}

4244 #i‡
COVENANT


4247 
	$ªcv_ª£¡˛õ¡
(
s
, 
˛õ¡
)

4248 
s
;

4249 
sockd_˛õ¡_t
 *
˛õ¡
;

4251 c⁄° *
fun˘i⁄
 = "recv_resentclient()";

4252 
iovec
 
iov
[2];

4253 
msghdr
 
msg
;

4254 
ioc
, 
fdex≥˘
, 
fdª˚ived
, 
r
;

4255 
	`CMSG_AALLOC
(
cmsg
, ());

4257 
ioc
 = 0;

4258 
	`bzîo
(
iov
, (iov));

4259 
iov
[
ioc
].
iov_ba£
 = 
˛õ¡
;

4260 
iov
[
ioc
].
iov_Àn
 = (*
˛õ¡
);

4261 ++
ioc
;

4263 
	`bzîo
(&
msg
, (msg));

4264 
msg
.
msg_iov
 = 
iov
;

4265 
msg
.
msg_iovÀn
 = 
ioc
;

4266 
msg
.
msg_«me
 = 
NULL
;

4267 
msg
.
msg_«mñí
 = 0;

4270 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

4272 i‡((
r
 = 
	`ªcvmsgn
(
s
, &
msg
, 0)Ë< (
ssize_t
)(*
˛õ¡
)) {

4273 
r
) {

4275 
	`sw¨n
("%s:Ñecvmsg(ËÁûed", 
fun˘i⁄
);

4279 
	`¶og
(
LOG_DEBUG
, "%s:Ñecvmsg(): other side closed connection",

4280 
fun˘i⁄
);

4284 
	`sw¨nx
("%s:Ñecvmsg(): unexpected shortÑead: %d/%ld",

4285 
fun˘i⁄
, 
r
, ()(*
˛õ¡
));

4291 i‡(
	`socks_msgha£º‹s
(
fun˘i⁄
, &
msg
))

4294 
r
 -(*
˛õ¡
);

4295 
fdex≥˘
 = 1;

4297 i‡(!
	`CMSG_RCPTLEN_ISOK
(
msg
, (Ë* 
fdex≥˘
)) {

4298 
	`sw¨nx
("%s:Ñeceived control message hasÅhe invalidÜen of %d",

4299 
fun˘i⁄
, ()
	`CMSG_TOTLEN
(
msg
));

4304 
	`SASSERTX
(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET
);

4305 
	`SASSERTX
(
cmsg
->
cmsg_ty≥
 =
SCM_RIGHTS
);

4307 
fdª˚ived
 = 0;

4308 i‡(
fdex≥˘
 > 0) {

4309 
	`CMSG_GETOBJECT
(
˛õ¡
->
s
, 
cmsg
, (˛õ¡->sË* 
fdª˚ived
++);

4311 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

4312 
	`¶og
(
LOG_DEBUG
, "%s:Ñeceived fd %d (%s) ...",

4313 
fun˘i⁄
, 
˛õ¡
->
s
, 
	`sockë2°rög
(˛õ¡->s, 
NULL
, 0));

4316 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

4317 
	`¶og
(
LOG_DEBUG
, "%s:Ñeceived %d descriptors for client",

4318 
fun˘i⁄
, 
fdª˚ived
);

4321 
	}
}

	@sockd/sockd_io_misc.c

44 
	~"comm⁄.h
"

45 
	~"m⁄ô‹.h
"

47 c⁄° 
	grcsid
[] =

51 
	$io_upd©em⁄ô‹
(
io
)

52 
sockd_io_t
 *
io
;

54 c⁄° *
fun˘i⁄
 = "io_updatemonitor()";

55 c⁄° 
m⁄ô‹_t
 *
√wm©ch
;

56 
m⁄ô‹_t
 
ﬁdm⁄ô‹
, 
√wm⁄ô‹
;

57 
ruÀ_t
 *
ruÀ
 = 
	`IORULE
(
io
);

58 
˛õ¡öfo_t
 
cöfo
;

59 
size_t
 
disc⁄√˘_√eded
;

60 
is_ßme
;

62 
	`SASSERTX
(
sockscf
.
°©e
.
ty≥
 =
PROC_IO
);

64 
	`¶og
(
LOG_DEBUG
,

67 
fun˘i⁄
,

68 
io
->
c⁄åﬁ
.
s
,

69 
io
->
§c
.
s
,

70 
io
->
d°
.
s
,

71 
	`¥Ÿocﬁ2°rög
(
io
->
°©e
.
¥Ÿocﬁ
),

72 
	`comm™d2°rög
(
io
->
°©e
.
comm™d
),

73 
ruÀ
->
m°©s_shmid
,

74 
ruÀ
->
m°©s
);

76 i‡(
ruÀ
->
m°©s_shmid
 != 0)

77 
	`SASSERTX
(
ruÀ
->
m°©s
 !
NULL
);

84 
	#DISCONNECT_NEEDED
(
_io
, 
_dodisc⁄√˘
) \

86 *(
_dodisc⁄√˘
) = 0; \

88 i‡(!
	`CONTROLIO
((
_io
))->
°©e
.
Æ¨mdisc⁄√˘d⁄e
) \

89 *(
_dodisc⁄√˘
Ë|
ALARM_INTERNAL
; \

91 i‡((
_io
)->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
) { \

92 i‡(!
	`EXTERNALIO
((
_io
))->
°©e
.
Æ¨mdisc⁄√˘d⁄e
) \

93 *(
_dodisc⁄√˘
Ë|
ALARM_EXTERNAL
; \

96 }  0)

	)

98 
	`DISCONNECT_NEEDED
(
io
, &
disc⁄√˘_√eded
);

100 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
) {

101 #i‡
HAVE_CONTROL_CONNECTION


102 c⁄° 
c⁄√˘i⁄°©e_t
 
ﬁd°©e
 = 
io
->
°©e
;

108 
io
->
°©e
.
¥Ÿocﬁ
 = 
SOCKS_TCP
;

109 
io
->
°©e
.
comm™d
 = 
SOCKS_ACCEPT
;

111 
√wm©ch
 = 
	`m⁄ô‹m©ch
(&
io
->
c⁄åﬁ
.
ho°
,

112 
	`sockaddr2socksho°
(&
io
->
c⁄åﬁ
.
œddr
, 
NULL
),

113 &
io
->
§c
.
auth
,

114 &
io
->
°©e
);

115 
io
->
°©e
 = 
ﬁd°©e
;

125 
√wm©ch
 = 
NULL
;

130 
√wm©ch
 = 
	`m⁄ô‹m©ch
(&
io
->
§c
.
ho°
,

131 &
io
->
d°
.
ho°
,

132 &
io
->
§c
.
auth
,

133 &
io
->
°©e
);

135 i‡(
√wm©ch
 =
NULL
) {

139 i‡(
ruÀ
->
m°©s_shmid
 == 0)

140 
is_ßme
 = 1;

142 
is_ßme
 = 0;

148 
	`SASSERTX
(
√wm©ch
->
m°©s_shmid
 != 0);

150 i‡(
ruÀ
->
m°©s_shmid
 == 0)

151 
is_ßme
 = 0;

153 
is_ßme
 = (
ruÀ
->
m°©s_shmid
 =
√wm©ch
->mstats_shmid);

156 
	`¶og
(
LOG_DEBUG
,

159 
fun˘i⁄
,

160 ()
ruÀ
->
m°©s_shmid
,

161 
√wm©ch
 =
NULL
 ? 0 : (Íewm©ch->
numbî
,

162 
√wm©ch
 =
NULL
 ? 0 : (Íewm©ch->
m°©s_shmid
,

163 
is_ßme
 ? "sameásÇow" : "different from before",

164 
√wm©ch
 =
NULL
 ? 0 : (Íewm©ch->
Æ¨msc⁄figuªd
);

166 i‡(
ruÀ
->
m°©s_shmid
 == 0

167 && (
√wm©ch
 =
NULL
 ||Çewm©ch->
m°©s_shmid
 == 0))

170 
cöfo
.
‰om
 = 
	`CONTROLIO
(
io
)->
øddr
;

171 
	`HOSTIDCOPY
(&
io
->
°©e
, &
cöfo
);

173 i‡(
√wm©ch
 =
NULL
) {

177 
	`SASSERTX
(
ruÀ
->
m°©s_shmid
 != 0);

179 i‡(
ruÀ
->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
) {

180 
	`io_add_Æ¨mdisc⁄√˘s
(
io
, 
fun˘i⁄
);

186 
	`CONTROLIO
(
io
)->
°©e
.
Æ¨mdisc⁄√˘d⁄e
 = 0;

187 
	`EXTERNALIO
(
io
)->
°©e
.
Æ¨mdisc⁄√˘d⁄e
 = 0;

190 
	`m⁄ô‹_unu£
(
ruÀ
->
m°©s
, &
cöfo
, 
sockscf
.
shmemfd
);

191 
	`sockd_shmdt
(
ruÀ
, 
SHMEM_MONITOR
);

193 
	`SHMEM_CLEAR
(
ruÀ
, 
SHMEM_MONITOR
, 1);

197 
	`SASSERTX
(
√wm©ch
->
m°©s
 =
NULL
);

198 
	`SASSERTX
(
√wm©ch
->
m°©s_shmid
 != 0);

200 i‡(
is_ßme
) {

210 
	`SASSERTX
(
ruÀ
->
m°©s_shmid
 =
√wm©ch
->mstats_shmid);

215 
	`SASSERTX
(
ruÀ
->
m°©s
 !
NULL
);

222 
ruÀ_t
 
tm¥uÀ
;

224 
	`COPY_MONITORFIELDS
(
√wm©ch
, &
tm¥uÀ
);

225 ()
	`sockd_shm©
(&
tm¥uÀ
, 
SHMEM_MONITOR
);

227 
	`COPY_MONITORFIELDS
(
ruÀ
, &
ﬁdm⁄ô‹
);

228 
	`COPY_MONITORFIELDS
(&
tm¥uÀ
, &
√wm⁄ô‹
);

230 
	`m⁄ô‹_move
(&
ﬁdm⁄ô‹
,

231 &
√wm⁄ô‹
,

233 
disc⁄√˘_√eded
,

234 &
cöfo
,

235 
sockscf
.
shmemfd
);

237 
	`COPY_MONITORFIELDS
(&
√wm⁄ô‹
, 
ruÀ
);

239 #i‡
DIAGNOSTIC


240 i‡(
ruÀ
->
m°©s_shmid
 != 0)

241 
	`SASSERTX
(
	`shmid2m⁄ô‹
(
ruÀ
->
m°©s_shmid
Ë!
NULL
);

249 
	}
}

253 
	$io_add_Æ¨mdisc⁄√˘s
(
io
, 
ªas⁄
)

254 
sockd_io_t
 *
io
;

255 c⁄° *
ªas⁄
;

257 c⁄° *
fun˘i⁄
 = "io_add_alarmdisconnect()";

258 
˛õ¡öfo_t
 
cöfo
;

259 
ruÀ_t
 *
ruÀ
 = 
	`IORULE
(
io
);

260 
size_t
 
side°odisc⁄√˘
;

262 i‡(
ruÀ
->
m°©s_shmid
 == 0

263 || !(
ruÀ
->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

266 
	`DISCONNECT_NEEDED
(
io
, &
side°odisc⁄√˘
);

268 i‡(
side°odisc⁄√˘
 == 0)

275 
cöfo
.
‰om
 = 
	`CONTROLIO
(
io
)->
øddr
;

276 
	`HOSTIDCOPY
(&
io
->
°©e
, &
cöfo
);

278 
	`Æ¨m_add_disc⁄√˘
(1,

279 
ruÀ
,

280 
side°odisc⁄√˘
,

281 &
cöfo
,

282 
ªas⁄
,

283 
sockscf
.
shmemfd
);

285 i‡(
side°odisc⁄√˘
 & 
ALARM_INTERNAL
)

286 
	`CONTROLIO
(
io
)->
°©e
.
Æ¨mdisc⁄√˘d⁄e
 = 1;

288 i‡(
side°odisc⁄√˘
 & 
ALARM_EXTERNAL
)

289 
	`EXTERNALIO
(
io
)->
°©e
.
Æ¨mdisc⁄√˘d⁄e
 = 1;

290 
	}
}

	@sockd/sockd_negotiate.c

45 
	~"comm⁄.h
"

46 
	~"m⁄ô‹.h
"

47 
	~"c⁄fig_∑r£.h
"

49 c⁄° 
	grcsid
[] =

52 
sockd_√gŸüã_t
 
	g√gv
[
SOCKD_NEGOTIATEMAX
];

53 c⁄° 
size_t
 
	g√gc
 = 
ELEMENTS
(
√gv
);

55 
sigöfo
(
sig
, 
sigöfo_t
 *
si
, *
sc
);

58 
logdisc⁄√˘
(c⁄° 
s
, 
sockd_√gŸüã_t
 *
√g
, c⁄° 
›î©i⁄_t
 
›
,

59 c⁄° 
iﬁogaddr_t
 *
§c
, c⁄° iﬁogaddr_à*
d°
,

60 c⁄° *
buf
, c⁄° 
size_t
 
buÊí
);

71 
£nd_√gŸüã
(
sockd_√gŸüã_t
 *
√g
);

81 
ªcv_√gŸüã
();

92 
dñëe_√gŸüã
(
sockd_√gŸüã_t
 *
√g
, c⁄° 
f‹w¨dedtomŸhî
);

100 
√g_fûl£t
(
fd_£t
 *
£t
, c⁄° 
skùcom∂ëed
, c⁄° 
skùö¥ogªss
);

115 
√g_˛ór£t
(
sockd_√gŸüã_t
 *
√g
, 
fd_£t
 *
£t
);

120 
sockd_√gŸüã_t
 *

121 
√g_gë£t
(
fd_£t
 *
£t
);

132 
size_t


133 
√g_com∂ëed
(c⁄° 
size_t
 
howm™y
);

139 
size_t


140 
√g_Æloˇãd
();

146 
¥o˘ôÀupd©e
();

151 
timevÆ
 *

152 
√g_gëtimeout
(
timevÆ
 *
timeout
);

161 #i‡
HAVE_NEGOTIATE_PHASE


162 
sockd_√gŸüã_t
 *

163 
√g_gëtimedout
(c⁄° 
timevÆ
 *
äow
);

175 
√g_˛ór£t
(
sockd_√gŸüã_t
 *
√g
, 
fd_£t
 *
£t
);

180 
sockd_√gŸüã_t
 *

181 
√g_gë£t
(
fd_£t
 *
£t
);

192 
size_t


193 
√g_com∂ëed
(c⁄° 
size_t
 
howm™y
);

199 
size_t


200 
√g_Æloˇãd
();

206 
¥o˘ôÀupd©e
();

211 
timevÆ
 *

212 
√g_gëtimeout
(
timevÆ
 *
timeout
);

222 
	$run_√gŸüã
()

224 c⁄° *
fun˘i⁄
 = "run_negotiate()";

225 
siga˘i⁄
 
siga˘
;

226 
fd_£t
 *
r£t
, *
r£tbuf
, *
tmp£t
, *
w£tmem
;

227 
£ndÁûed
;

229 
	`bzîo
(&
siga˘
, (sigact));

230 
siga˘
.
ß_Êags
 = 
SA_RESTART
 | 
SA_NOCLDSTOP
 | 
SA_SIGINFO
;

231 
siga˘
.
ß_siga˘i⁄
 = 
sigöfo
;

233 #i‡
HAVE_SIGNAL_SIGINFO


234 i‡(
	`siga˘i⁄
(
SIGINFO
, &
siga˘
, 
NULL
) != 0)

235 
	`£º
("%s: siga˘i⁄(SIGINFO)", 
fun˘i⁄
);

239 i‡(
	`siga˘i⁄
(
SIGUSR1
, &
siga˘
, 
NULL
) != 0)

240 
	`£º
("%s: siga˘i⁄(SIGINFO)", 
fun˘i⁄
);

242 
r£t
 = 
	`Æloˇã_maxsize_fd£t
();

243 
r£tbuf
 = 
	`Æloˇã_maxsize_fd£t
();

244 
tmp£t
 = 
	`Æloˇã_maxsize_fd£t
();

245 
w£tmem
 = 
	`Æloˇã_maxsize_fd£t
();

247 
	`¥o˘ôÀupd©e
();

249 
	`sockd_¥öt_chûd_ªady_mesßge
((
size_t
)
	`‰ìdes¸ùt‹s
(
NULL
, NULL));

251 
£ndÁûed
 = 0;

253 
√gŸüã_ªsu…_t
 
√g°©us
;

254 
timevÆ
 *
timeout
, 
timeoutmem
;

255 
sockd_√gŸüã_t
 *
√g
;

256 
timevÆ
 
äow
;

257 
fd_£t
 *
w£t
;

258 
fdbôs
;

260 
î∫o
 = 0;

263 #i‡
HAVE_NEGOTIATE_PHASE


264 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

265 (
√g
 = 
	`√g_gëtimedout
(&
äow
)Ë!
NULL
) {

266 c⁄° 
time_t
 
duøti⁄


267 
	`socks_dif·ime
(
äow
.
tv_£c
, 
√g
->
°©e
.
time
.
ac˚±ed
.tv_sec);

269 
iﬁogaddr_t
 
§c
;

270 
size_t
 
buÊí
;

271 
buf
[512];

273 
	`öô_iﬁogaddr
(&
§c
,

274 
obje˘_socksho°
,

275 &
√g
->
√g°©e
.
d°
,

276 
obje˘_socksho°
,

277 &
√g
->
√g°©e
.
§c
,

278 &
√g
->
ˇuth
,

279 
	`GET_HOSTIDV
(&
√g
->
°©e
),

280 
	`GET_HOSTIDC
(&
√g
->
°©e
));

282 i‡(
√g
->
√g°©e
.
com∂ëe
) {

283 
sockaddr_°‹age
 
p
;

285 
	`log_˛õ¡dr›≥d
(
	`socksho°2sockaddr
(&
√g
->
√g°©e
.
§c
, &
p
));

291 
buÊí
 = 
	`¢¥ötf
(
buf
, (buf),

293 
	`timeouây≥2°rög
(
TIMEOUT_NEGOTIATE
),

294 ()
duøti⁄
,

295 
duøti⁄
 == 1 ? "" : "s",

296 
√g
->
√g°©e
.
com∂ëe
 ?

300 
	`logdisc⁄√˘
(
√g
->
s
,Çeg, 
OPERATION_ERROR
, &
§c
, 
NULL
, 
buf
, 
buÊí
);

301 
	`dñëe_√gŸüã
(
√g
, 0);

304 
fdbôs
 = 
	`√g_fûl£t
(
r£t
,

305 
£ndÁûed
,

324 
fdbôs
 = -1;

325 
	`FD_ZERO
(
r£t
);

329 
	`FD_COPY
(
r£tbuf
, 
r£t
);

331 i‡(
	`√g_com∂ëed
(1Ë&& !
£ndÁûed
) {

332 
timeout
 = &
timeoutmem
;

333 
	`timî˛ór
(
timeout
);

336 
timeout
 = 
	`√g_gëtimeout
(&
timeoutmem
);

338 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
s
, 
r£t
);

339 
fdbôs
 = 
	`MAX
(fdbôs, 
sockscf
.
°©e
.
mŸhî
.
s
);

341 i‡(
£ndÁûed
) {

347 
	`FD_ZERO
(
w£tmem
);

348 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
s
, 
w£tmem
);

349 
w£t
 = 
w£tmem
;

351 
fdbôs
 = 
	`MAX
(fdbôs, 
sockscf
.
°©e
.
mŸhî
.
s
);

352 
£ndÁûed
 = 0;

355 
w£t
 = 
NULL
;

358 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
r£t
);

359 
fdbôs
 = 
	`MAX
(fdbôs, 
sockscf
.
°©e
.
mŸhî
.
ack
);

361 
	`SASSERTX
(
fdbôs
 >= 0);

363 ++
fdbôs
;

364 
	`£À˘n
(
fdbôs
, 
r£t
, 
r£tbuf
, 
NULL
, 
w£t
, NULL, 
timeout
)) {

366 i‡(
î∫o
 =
EINTR
)

369 
	`SERR
(-1);

373 i‡(
	`√g_com∂ëed
(1))

379 #i‡!
HAVE_NEGOTIATE_PHASE


385 
fdbôs
 = 
	`MAX
(fdbôs, 
	`√g_fûl£t
(
tmp£t
, 0, 1));

387 
	`fd£t›
(
fdbôs
, '|', 
r£t
, 
tmp£t
,Ñset);

390 
	`fd£t›
(
fdbôs
, '|', 
r£t
, 
r£tbuf
,Ñset);

397 
fdbôs
 = 
	`MAX
(fdbôs, 
	`√g_fûl£t
(
tmp£t
, 0, 1));

398 
	`fd£t›
(
fdbôs
, '|', 
r£t
, 
tmp£t
,Ñset);

401 i‡(
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
r£t
)) {

402 
	`sockd_ªadmŸhîsc⁄åﬁsockë
(
fun˘i⁄
, 
sockscf
.
°©e
.
mŸhî
.
ack
);

404 #i‡
HAVE_VALGRIND_VALGRIND_H


405 i‡(
RUNNING_ON_VALGRIND
) {

407 
	`‰ì
(
r£t
);

411 
	`sockdexô
(
EXIT_SUCCESS
);

414 i‡(
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
s
, 
r£t
)) {

415 i‡(
	`ªcv_√gŸüã
() == -1)

418 
	`¥o˘ôÀupd©e
();

420 
	`FD_CLR
(
sockscf
.
°©e
.
mŸhî
.
s
, 
r£t
);

423 (
√g
 = 
	`√g_gë£t
(
r£t
)Ë!
NULL
) {

424 
io_î∫o
;

426 
	`√g_˛ór£t
(
√g
, 
r£t
);

428 
î∫o
 = 0;

429 
√g°©us
 = 
	`ªcv_˛õ¡ªque°
(
√g
->
s
, &√g->
ªq
, &√g->
√g°©e
);

430 
io_î∫o
 = 
î∫o
;

432 
	`¶og
(
LOG_DEBUG
,

435 
fun˘i⁄
,

436 
	`socksho°2°rög
(&
√g
->
√g°©e
.
§c
, 
NULL
, 0),

437 
√g°©us
,

438 
î∫o
,

439 
î∫o
 == 0 ?

440 "nÿîr‹" : 
	`ERRNOISTMP
(
î∫o
) ?

443 
√g°©us
) {

444 
NEGOTIATE_CONTINUE
:

447 
NEGOTIATE_FINISHED
: {

448 i‡(!
	`timîis£t
(&
√g
->
°©e
.
time
.
√gŸüãíd
))

449 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
√g
->
°©e
.
time
.
√gŸüãíd
);

451 
√g
->
°©e
.
comm™d
 =Çeg->
ªq
.command;

452 
√g
->
°©e
.
¥Ÿocﬁ
 =Çeg->
ªq
.protocol;

453 
√g
->
°©e
.
¥oxy¥Ÿocﬁ
 =Çeg->
ªq
.
vîsi⁄
;

455 #i‡
COVENANT


456 i‡(
√g
->
√g°©e
.
haved⁄îuÀ•îmô
)

457 
	`¶og
(
LOG_DEBUG
,

460 
fun˘i⁄
,

461 
	`socksho°2°rög
(&
√g
->
√g°©e
.
§c
, 
NULL
, 0));

470 
sockaddr_°‹age
 
§c
, 
d°
;

471 
≥rmô
;

473 
	`socksho°2sockaddr
(&
√g
->
√g°©e
.
§c
, &src);

474 
	`socksho°2sockaddr
(&
√g
->
√g°©e
.
d°
, &dst);

476 
	`¶og
(
LOG_DEBUG
, "%s: second-levelácl check on %s -> %s",

477 
fun˘i⁄
,

478 
	`sockaddr2°rög
(&
§c
, 
NULL
, 0),

479 
	`socksho°2°rög
(&
√g
->
ªq
.
ho°
, 
NULL
, 0));

481 
≥rmô
 = 
	`ruÀ•îmô
(
√g
->
s
,

482 &
§c
,

483 &
d°
,

484 &
√g
->
ˇuth
,

485 &
√g
->
ßuth
,

486 &
√g
->
§uÀ
,

487 &
√g
->
°©e
,

488 &
√g
->
√g°©e
.
§c
,

489 &
√g
->
ªq
.
ho°
,

490 
NULL
,

491 
√g
->
√g°©e
.
emsg
,

492 (
√g
->
√g°©e
.
emsg
));

494 i‡(
≥rmô
)

495 
√g
->
√g°©e
.
haved⁄îuÀ•îmô
 = 1;

497 
iﬁogaddr_t
 
§c
;

498 
ª•⁄£_t
 
ª•⁄£
;

500 i‡(
√g
->
§uÀ
.
whyblock
.
missög¥oxyauth
) {

501 i‡(!
√g
->
√g°©e
.
havîeque°ed¥oxyauth
) {

502 
	`¶og
(
LOG_DEBUG
,

505 
fun˘i⁄
,

506 
	`socksho°2°rög
(&
√g
->
√g°©e
.
§c
, 
NULL
, 0));

508 
	`bzîo
(&
ª•⁄£
, (response));

509 
ª•⁄£
.
vîsi⁄
 = 
√g
->
°©e
.
¥oxy¥Ÿocﬁ
;

510 
ª•⁄£
.
ho°
 = 
√g
->
ªq
.host;

511 
ª•⁄£
.
ª∂y
.
hâp


512 
ª•⁄£
.
vîsi⁄
 =
PROXY_HTTP_10
 ?

513 
HTTP_NOTALLOWED
 : 
HTTP_PROXYAUTHREQUIRED
;

515 
	`£nd_ª•⁄£
(
√g
->
s
, &
ª•⁄£
);

517 
√g
->
√g°©e
.
com∂ëe
 = 0;

518 
√g
->
√g°©e
.
havîeque°ed¥oxyauth
 = 1;

519 
	`bzîo
(
√g
->
√g°©e
.
mem
, (neg->negstate.mem));

524 
	`¶og
(
LOG_DEBUG
,

528 
fun˘i⁄
,

529 
	`socksho°2°rög
(&
√g
->
√g°©e
.
§c
, 
NULL
, 0));

536 
	`öô_iﬁogaddr
(&
§c
,

537 
obje˘_socksho°
,

538 &
√g
->
√g°©e
.
d°
,

539 
obje˘_socksho°
,

540 &
√g
->
√g°©e
.
§c
,

541 &
√g
->
ˇuth
,

542 
	`GET_HOSTIDV
(&
√g
->
°©e
),

543 
	`GET_HOSTIDC
(&
√g
->
°©e
));

545 i‡(
√g
->
§uÀ
.
log
.
t˝öfo
) {

546 
fdv
[] = { 
√g
->
s
 };

548 
√g
->
°©e
.
t˝öfo


549 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

552 
	`iﬁog
(&
√g
->
§uÀ
,

553 &
√g
->
°©e
,

554 
OPERATION_CONNECT
,

555 &
§c
,

556 
NULL
,

557 
NULL
,

558 
NULL
,

559 
√g
->
√g°©e
.
emsg
,

560 
	`°æí
(
√g
->
√g°©e
.
emsg
));

562 
	`iﬁog
(&
√g
->
¸uÀ
,

563 &
√g
->
°©e
,

564 
OPERATION_CONNECT
,

565 &
§c
,

566 
NULL
,

567 
NULL
,

568 
NULL
,

569 
√g
->
√g°©e
.
emsg
,

570 
	`°æí
(
√g
->
√g°©e
.
emsg
));

572 
√g
->
°©e
.
t˝öfo
 = 
NULL
;

574 
	`bzîo
(&
ª•⁄£
, (response));

575 
ª•⁄£
.
vîsi⁄
 = 
√g
->
°©e
.
¥oxy¥Ÿocﬁ
;

576 
ª•⁄£
.
ho°
 = 
√g
->
ªq
.host;

577 
ª•⁄£
.
ª∂y
.
hâp
 = 
HTTP_FORBIDDEN
;

579 
	`£nd_ª•⁄£
(
√g
->
s
, &
ª•⁄£
);

580 
	`dñëe_√gŸüã
(
√g
, 0);

587 i‡(
w£t
 !
NULL
 && !
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
s
, wset)) {

588 
£ndÁûed
 = 1;

592 
î∫o
 = 0;

593 i‡(
	`£nd_√gŸüã
(
√g
) == 0) {

594 
	`dñëe_√gŸüã
(
√g
, 1);

595 
£ndÁûed
 = 0;

597 i‡(
	`ERRNOISTMP
(
î∫o
))

598 
£ndÁûed
 = 1;

600 
sockaddr_°‹age
 
p
;

602 
	`log_˛õ¡dr›≥d
(
	`socksho°2sockaddr
(&
√g
->
√g°©e
.
§c
, &
p
));

604 
	`dñëe_√gŸüã
(
√g
, 0);

612 
£ndÁûed
 = 0;

618 
NEGOTIATE_ERROR
:

619 
NEGOTIATE_EOF
: {

620 c⁄° *
îr‹
;

621 c⁄° 
time_t
 
duøti⁄
 = 
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(
NULL
),

622 
√g
->
°©e
.
time
.
ac˚±ed
.
tv_£c
);

623 
iﬁogaddr_t
 
§c
;

624 
ªas⁄
[256];

625 
èkögtoﬁ⁄g
 = 0, 
îr‹i£of
 = 0;

627 i‡(
	`ERRNOISTMP
(
io_î∫o
))

630 i‡(
√g°©us
 =
NEGOTIATE_EOF
) {

631 
îr‹
 = "eof fromÜocal client";

632 
îr‹i£of
 = 1;

635 i‡(*
√g
->
√g°©e
.
emsg
 =
NUL
) {

636 i‡(
io_î∫o
 == 0)

637 
îr‹
 = "local clientÖrotocolÉrror";

639 
îr‹
 = 
	`°ªº‹
(
io_î∫o
);

642 
îr‹
 = 
√g
->
√g°©e
.
emsg
;

645 i‡(
	`CRULE_OR_HRULE
(
√g
)->
m°©s_shmid
 != 0

646 && (
	`CRULE_OR_HRULE
(
√g
)->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)) {

647 
˛õ¡öfo_t
 
cöfo
;

648 
we˛o£d
;

650 i‡(
√g°©us
 =
NEGOTIATE_EOF
 || 
	`ERRNOISNETWORK
(
î∫o
))

651 
we˛o£d
 = 0;

653 
we˛o£d
 = 1;

655 
	`socksho°2sockaddr
(&
√g
->
√g°©e
.
§c
, &
cöfo
.
‰om
);

656 
	`HOSTIDCOPY
(&
√g
->
°©e
, &
cöfo
);

658 
	`Æ¨m_add_disc⁄√˘
(
we˛o£d
,

659 
	`CRULE_OR_HRULE
(
√g
),

660 
ALARM_INTERNAL
,

661 &
cöfo
,

662 
îr‹
,

663 
sockscf
.
shmemfd
);

666 i‡(!
îr‹i£of
 && 
√g
->
√g°©e
.
com∂ëe
) {

667 
timevÆ
 
tdiff
;

669 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

670 
	`timîsub
(&
äow
, &
√g
->
°©e
.
time
.
√gŸüãíd
, &
tdiff
);

672 i‡(
tdiff
.
tv_£c
 >
	`CRULE_OR_HRULE
(
√g
)->
timeout
.
√gŸüã
)

673 
èkögtoﬁ⁄g
 = 1;

676 
	`¢¥ötf
(
ªas⁄
, (reason),

678 ()
√g
->
√g°©e
.
ªqªad
,

679 ()
√g
->
√g°©e
.
ªqªad
 == 1 ? "" : "s",

680 
èkögtoﬁ⁄g
 ?

683 ()
duøti⁄
,

684 
duøti⁄
 == 1 ? "" : "s",

685 
îr‹
);

687 
	`öô_iﬁogaddr
(&
§c
,

688 
obje˘_socksho°
,

689 &
√g
->
√g°©e
.
d°
,

690 
obje˘_socksho°
,

691 &
√g
->
√g°©e
.
§c
,

692 &
√g
->
ˇuth
,

693 
	`GET_HOSTIDV
(&
√g
->
°©e
),

694 
	`GET_HOSTIDC
(&
√g
->
°©e
));

696 i‡(
√g
->
¸uÀ
.
log
.
t˝öfo
) {

697 
fdv
[] = { 
√g
->
s
 };

699 
√g
->
°©e
.
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

702 
	`logdisc⁄√˘
(
√g
->
s
,

703 
√g
,

704 
OPERATION_ERROR
,

705 &
§c
,

706 
NULL
,

707 
ªas⁄
,

708 
	`°æí
(
ªas⁄
));

710 
	`dñëe_√gŸüã
(
√g
, 0);

715 
	`SERRX
(
√g°©us
);

719 
	}
}

722 
	$√gŸüã_¥ec⁄figlﬂd
()

724 c⁄° *
fun˘i⁄
 = "negotiate_preconfigload()";

726 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

727 
	}
}

730 
	$√gŸüã_po°c⁄figlﬂd
()

732 c⁄° *
fun˘i⁄
 = "negotiate_postconfigload()";

733 
size_t
 
i
;

735 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

740 
i
 = 0; i < 
√gc
; ++i) {

741 c⁄° 
m⁄ô‹_t
 *
p
;

742 
m⁄ô‹_t
 
ﬁdm⁄ô‹
, 
√wm⁄ô‹
;

743 
˛õ¡öfo_t
 
cöfo
;

745 i‡(!
√gv
[
i
].
Æloˇãd
)

748 
	`SASSERTX
(
	`CRULE_OR_HRULE
(&
√gv
[
i
])->
m°©s
 =
NULL
);

750 
	`bzîo
(&
ﬁdm⁄ô‹
, (oldmonitor));

751 i‡(
	`CRULE_OR_HRULE
(&
√gv
[
i
])->
m°©s_shmid
 != 0)

752 
	`COPY_MONITORFIELDS
(
	`CRULE_OR_HRULE
(&
√gv
[
i
]), &
ﬁdm⁄ô‹
);

754 
p
 = 
	`m⁄ô‹m©ch
(&
√gv
[
i
].
√g°©e
.
§c
,

755 &
√gv
[
i
].
√g°©e
.
d°
,

756 &
√gv
[
i
].
ˇuth
,

757 &
√gv
[
i
].
°©e
);

759 i‡(
p
 =
NULL
)

760 
	`bzîo
(&
√wm⁄ô‹
, (newmonitor));

762 
	`SASSERTX
(
p
->
m°©s
 =
NULL
);

763 
√wm⁄ô‹
 = *
p
;

766 i‡(
ﬁdm⁄ô‹
.
m°©s_shmid
 =0 && 
√wm⁄ô‹
.mstats_shmid == 0)

769 
	`socksho°2sockaddr
(&
√gv
[
i
].
√g°©e
.
§c
, &
cöfo
.
‰om
);

770 
	`HOSTIDCOPY
(&
√gv
[
i
].
°©e
, &
cöfo
);

772 
	`m⁄ô‹_move
(&
ﬁdm⁄ô‹
,

773 &
√wm⁄ô‹
,

775 
ALARM_INTERNAL
,

776 &
cöfo
,

777 
sockscf
.
shmemfd
);

779 
	`COPY_MONITORFIELDS
(&
√wm⁄ô‹
, 
	`CRULE_OR_HRULE
(&
√gv
[
i
]));

781 #i‡
COVENANT


785 
	}
}

789 
	$£nd_√gŸüã
(
√g
)

790 
sockd_√gŸüã_t
 *
√g
;

792 c⁄° *
fun˘i⁄
 = "send_negotiate()";

793 #i‡
HAVE_GSSAPI


794 
gss_buf„r_desc
 
gsßpi°©e
 = { 0, 
NULL
 };

795 
gsßpi°©emem
[
MAX_GSS_STATE
];

797 
iovec
 
iov
[2];

798 
sockd_ªque°_t
 
ªq
;

799 
˛õ¡öfo_t
 
cöfo
;

800 
msghdr
 
msg
;

801 
ssize_t
 
w
;

802 
size_t
 
Àngth
, 
ioc
, 
fd£ndt
;

803 
	`CMSG_AALLOC
(
cmsg
, ());

804 
unu£
 = 0;

806 
	`socksho°2sockaddr
(&
√g
->
√g°©e
.
§c
, &
cöfo
.
‰om
);

807 
	`HOSTIDCOPY
(&
√g
->
°©e
, &
cöfo
);

809 i‡(
	`CRULE_OR_HRULE
(
√g
)->
bw_shmid
 != 0

810 && !
	`CRULE_OR_HRULE
(
√g
)->
bw_isöhîôabÀ
)

811 
unu£
 |
SHMEM_BW
;

813 i‡(
	`CRULE_OR_HRULE
(
√g
)->
ss_shmid
 != 0

814 && !
	`CRULE_OR_HRULE
(
√g
)->
ss_isöhîôabÀ
)

815 
unu£
 |
SHMEM_SS
;

817 i‡(
unu£
 != 0)

818 
	`¶og
(
LOG_DEBUG
,

820 
fun˘i⁄
, 
unu£
);

822 
	`¶og
(
LOG_DEBUG
, "%s:ÇÿshmemÅÿunu£/˛ór", 
fun˘i⁄
);

824 
	`SHMEM_UNUSE
(
	`CRULE_OR_HRULE
(
√g
), &
cöfo
, 
sockscf
.
shmemfd
, 
unu£
);

825 
	`SHMEM_CLEAR
(
	`CRULE_OR_HRULE
(
√g
), 
unu£
, 1);

826 
	`SHMEM_CLEAR
(
	`CRULE_OR_HRULE
(
√g
), 
SHMEM_ALL
, 0);

831 
	`bzîo
(&
ªq
, (req));

832 
	`socksho°2sockaddr
(&
√g
->
√g°©e
.
§c
, &
ªq
.
‰om
);

833 
	`socksho°2sockaddr
(&
√g
->
√g°©e
.
d°
, &
ªq
.
to
);

835 
ªq
.ªq = 
√g
->req;

836 
ªq
.
ªqöfo
.
comm™d
 = (
√g
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

837 
SOCKD_FREESLOT_TCP
 : 
SOCKD_FREESLOT_UDP
);

839 #i‡
HAVE_NEGOTIATE_PHASE


844 #i‡
COVENANT


845 i‡(
√g
->
ªq
.
Êags
.
hâpc⁄√˘
)

846 
Àngth
 = 0;

849 
Àngth
 = 
√g
->
√g°©e
.
ªqªad
;

850 
	`mem˝y
(
ªq
.
˛õ¡d©a
, 
√g
->
√g°©e
.
mem
, 
Àngth
);

854 i‡((
Àngth
 = 
	`socks_byãsöbuf„r
(
√g
->
s
, 
READ_BUF
, 0)) != 0) {

855 
	`¶og
(
Àngth
 > (
ªq
.
˛õ¡d©a
Ë? 
LOG_INFO
 : 
LOG_DEBUG
,

859 
fun˘i⁄
,

860 
	`sockë2°rög
(
√g
->
s
, 
NULL
, 0),

861 ()
Àngth
,

862 
Àngth
 > (
ªq
.
˛õ¡d©a
) ?

866 i‡(
Àngth
 > (
ªq
.
˛õ¡d©a
))

869 
	`socks_gë‰ombuf„r
(
√g
->
s
, 0, 
READ_BUF
, 0, 
ªq
.
˛õ¡d©a
, 
Àngth
);

873 
ªq
.
˛õ¡d©Æí
 = 
Àngth
;

875 i‡(
ªq
.
˛õ¡d©Æí
 > 0)

876 
	`¶og
(
LOG_DEBUG
,

878 
fun˘i⁄
, ()
ªq
.
˛õ¡d©Æí
);

881 
ªq
.
¸uÀ
 = 
√g
->crule;

883 #i‡
HAVE_SOCKS_HOSTID


884 
ªq
.
hruÀ
 = 
√g
->hrule;

885 
ªq
.
hruÀ_is£t
 = 
√g
->hrule_isset;

888 #i‡
COVENANT


889 
ªq
.
§uÀ
 = 
√g
->srule;

892 
ªq
.
ˇuth
 = 
√g
->cauth;

893 
ªq
.
ßuth
 = 
√g
->sauth;

895 
ªq
.
°©e
 = 
√g
->state;

897 
	`SASSERTX
(
	`¥oxy¥Ÿocﬁisknown
(
ªq
.
°©e
.
¥oxy¥Ÿocﬁ
));

899 
	`¶og
(
LOG_DEBUG
,

902 
fun˘i⁄
,

903 
	`sockaddr2°rög
(&
ªq
.
‰om
, 
NULL
, 0),

904 
	`comm™d2°rög
(
ªq
.
°©e
.
comm™d
),

905 
	`¥oxy¥Ÿocﬁ2°rög
(
ªq
.
°©e
.
¥oxy¥Ÿocﬁ
));

907 
	`bzîo
(
iov
, (iov));

908 
ioc
 = 0;

909 
Àngth
 = 0;

910 
iov
[
ioc
].
iov_ba£
 = &
ªq
;

911 
iov
[
ioc
].
iov_Àn
 = (
ªq
);

912 
Àngth
 +
iov
[
ioc
].
iov_Àn
;

913 ++
ioc
;

915 #i‡
HAVE_GSSAPI


916 i‡(
ªq
.
ßuth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

917 
gsßpi°©e
.
vÆue
 = 
gsßpi°©emem
;

918 
gsßpi°©e
.
Àngth
 = (
gsßpi°©emem
);

920 i‡(
	`gsßpi_exp‹t_°©e
(&
ªq
.
ßuth
.
md©a
.
gsßpi
.
°©e
.
id
, &
gsßpi°©e
)

924 
iov
[
ioc
].
iov_ba£
 = 
gsßpi°©e
.
vÆue
;

925 
iov
[
ioc
].
iov_Àn
 = 
gsßpi°©e
.
Àngth
;

926 
Àngth
 +
iov
[
ioc
].
iov_Àn
;

927 ++
ioc
;

929 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

930 
	`¶og
(
LOG_DEBUG
, "%s: gssapistate hasÜength %lu",

931 
fun˘i⁄
, ()
gsßpi°©e
.
Àngth
);

935 
fd£ndt
 = 0;

937 #i‡
BAREFOOTD


938 i‡(
ªq
.
°©e
.
comm™d
 !
SOCKS_UDPASSOCIATE
)

940 
	`CMSG_ADDOBJECT
(
√g
->
s
, 
cmsg
, “eg->sË* 
fd£ndt
++);

944 
	`CMSG_ADDOBJECT
(
√g
->
s
, 
cmsg
, “eg->sË* 
fd£ndt
++);

948 
	`bzîo
(&
msg
, (msg));

949 
msg
.
msg_iov
 = 
iov
;

950 
msg
.
msg_iovÀn
 = 
ioc
;

951 
msg
.
msg_«me
 = 
NULL
;

952 
msg
.
msg_«mñí
 = 0;

955 
	`CMSG_SETHDR_SEND
(
msg
, 
cmsg
, (Ë* 
fd£ndt
);

957 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
 && 
√g
->
s
 != -1)

958 
	`¶og
(
LOG_DEBUG
, "%s: sending fd %d (%s) ...",

959 
fun˘i⁄
, 
√g
->
s
, 
	`sockë2°rög
“eg->s, 
NULL
, 0));

961 i‡((
w
 = 
	`£ndmsgn
(
sockscf
.
°©e
.
mŸhî
.
s
, &
msg
, 0, 100)Ë!(
ssize_t
)
Àngth
){

962 
	`¶og
(
LOG_DEBUG
, "%s: sending clientÅo mother failed: %s",

963 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

965 #i‡
HAVE_GSSAPI


969 i‡(
gsßpi°©e
.
vÆue
 !
NULL
) {

970 i‡(
	`gsßpi_imp‹t_°©e
(&
ªq
.
ßuth
.
md©a
.
gsßpi
.
°©e
.
id
, &
gsßpi°©e
)

972 
	`sw¨nx
("%s: couldÇŸÑe-imp‹àgsßpò°©e", 
fun˘i⁄
);

977 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

978 
	`¶og
(
LOG_DEBUG
,

981 
fun˘i⁄
,

982 ()
fd£ndt
,

983 
ªq
.
°©e
.
comm™d
,

984 
	`mëhod2°rög
(
ªq
.
ˇuth
.
mëhod
),

985 
	`mëhod2°rög
(
ªq
.
ßuth
.
mëhod
),

986 
√g
->
s
);

989  (
size_t
)
w
 =
Àngth
 ? 0 : -1;

990 
	}
}

993 
	$ªcv_√gŸüã
()

995 c⁄° *
fun˘i⁄
 = "recv_negotiate()";

996 
sockd_˛õ¡_t
 
˛õ¡
;

997 
sockd_√gŸüã_t
 *
√g
;

998 
iovec
 
iov
[1];

999 
msghdr
 
msg
;

1000 
ssize_t
 
r
;

1001 
size_t
 
i
, 
‰ìc
, 
√wc
, 
Áûedc
;

1002 
	`CMSG_AALLOC
(
cmsg
, ());

1003 
ruÀöfo
[256];

1004 
≥rmô
, 
fdª˚ived
;

1006 
	`bzîo
(
iov
, (iov));

1007 
iov
[0].
iov_ba£
 = &
˛õ¡
;

1008 
iov
[0].
iov_Àn
 = (
˛õ¡
);

1010 
	`bzîo
(&
msg
, (msg));

1011 
msg
.
msg_iov
 = 
iov
;

1012 
msg
.
msg_iovÀn
 = 
	`ELEMENTS
(
iov
);

1013 
msg
.
msg_«me
 = 
NULL
;

1014 
msg
.
msg_«mñí
 = 0;

1017 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

1019 
√wc
 = 
Áûedc
 = 
î∫o
 = 0;

1020 
‰ìc
 = 
SOCKD_NEGOTIATEMAX
 - 
	`√g_Æloˇãd
();

1022 
√wc
 < 
‰ìc
) {

1023 c⁄° 
size_t
 
fdex≥˘
 = 1;

1024 
iﬁogaddr_t
 
§c
, 
d°
;

1025 
˛õ¡öfo_t
 
cöfo
;

1027 #i‡
DIAGNOSTIC


1028 
	`shmemcheck
();

1031 i‡((
r
 = 
	`ªcvmsgn
(
sockscf
.
°©e
.
mŸhî
.
s
, &
msg
, 0)Ë!(
˛õ¡
)) {

1032 
r
) {

1035 
	`¶og
(
LOG_DEBUG
,

1039 
fun˘i⁄
, ()
r
,

1040 ()
√wc
, ()
Áûedc
,

1041 
î∫o
, 
	`°ªº‹
(errno));

1045 
	`sw¨nx
("%s:Ñecvmsg(): unexpected shortÑead from motheráfter "

1047 
fun˘i⁄
,

1048 ()
√wc
,

1049 ()
r
,

1050 ()(
˛õ¡
));

1056 i‡(
	`socks_msgha£º‹s
(
fun˘i⁄
, &
msg
)) {

1057 ++
Áûedc
;

1064 
i
 = 0, 
√g
 = 
NULL
; i < 
√gc
; ++i)

1065 i‡(!
√gv
[
i
].
Æloˇãd
) {

1069 
√g
 = &
√gv
[
i
];

1073 i‡(
√g
 =
NULL
)

1074 
	`SERRX
(
	`√g_Æloˇãd
());

1076 i‡(!
	`CMSG_RCPTLEN_ISOK
(
msg
, (Ë* 
fdex≥˘
)) {

1077 
	`sw¨nx
("%s:Ñeceived control message hasÅhe invalidÜen of %d",

1078 
fun˘i⁄
, ()
	`CMSG_TOTLEN
(
msg
));

1080 ++
Áûedc
;

1084 
	`SASSERTX
(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET
);

1085 
	`SASSERTX
(
cmsg
->
cmsg_ty≥
 =
SCM_RIGHTS
);

1087 
fdª˚ived
 = 0;

1088 
	`CMSG_GETOBJECT
(
√g
->
s
, 
cmsg
, “eg->sË* 
fdª˚ived
++);

1090 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

1091 
	`¶og
(
LOG_DEBUG
, "%s:Ñeceived fd %d (%s) ...",

1092 
fun˘i⁄
, 
√g
->
s
, 
	`sockë2°rög
“eg->s, 
NULL
, 0));

1094 
√g
->
°©e
.
time
.
ac˚±ed
 = 
˛õ¡
.accepted;

1095 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
√g
->
°©e
.
time
.
√gŸüã°¨t
);

1097 
	`sockd_check_ù˛©ícy
("client objectÑeceived from mother",

1098 &
√g
->
°©e
.
time
.
ac˚±ed
,

1099 &
√g
->
°©e
.
time
.
√gŸüã°¨t
,

1100 &
√g
->
°©e
.
time
.
√gŸüã°¨t
);

1106 
	`sockaddr2socksho°
(&
˛õ¡
.
‰om
, &
√g
->
√g°©e
.
§c
);

1107 
	`sockaddr2socksho°
(&
˛õ¡
.
to
, &
√g
->
√g°©e
.
d°
);

1109 
√g
->
°©e
.
comm™d
 = 
SOCKS_ACCEPT
;

1110 
√g
->
°©e
.
¥Ÿocﬁ
 = 
SOCKS_TCP
;

1112 
√g
->
ªq
.
auth
 = &√g->
ßuth
;

1113 
√g
->
ˇuth
.
mëhod
 = 
AUTHMETHOD_NOTSET
;

1115 #i‡
PRERELEASE


1119 
≥rmô
 = 
	`ruÀ•îmô
(
√g
->
s
,

1120 &
˛õ¡
.
‰om
,

1121 &
˛õ¡
.
to
,

1122 
NULL
,

1123 &
√g
->
ˇuth
,

1124 &
√g
->
¸uÀ
,

1125 &
√g
->
°©e
,

1126 &
√g
->
√g°©e
.
§c
,

1127 &
√g
->
√g°©e
.
d°
,

1128 
NULL
,

1129 
ruÀöfo
,

1130 (
ruÀöfo
));

1132 
cöfo
.
‰om
 = 
˛õ¡
.from;

1133 
	`HOSTIDCOPY
(&
√g
->
°©e
, &
cöfo
);

1135 
	`£tc⁄fsock›ti⁄s
(
√g
->
s
,

1136 
√g
->
s
,

1137 
SOCKS_TCP
,

1139 
√g
->
¸uÀ
.
sockë›ti⁄c
,

1140 
√g
->
¸uÀ
.
sockë›ti⁄v
,

1141 
SOCKETOPT_ANYTIME
 | 
SOCKETOPT_POST
,

1142 
SOCKETOPT_ANYTIME
 | 
SOCKETOPT_POST
);

1151 
√g
->
ßuth
 =Çeg->
ˇuth
;

1154 
√g
->
ßuth
.
mëhod
 = 
AUTHMETHOD_NOTSET
;

1156 i‡(
≥rmô
) {

1157 i‡(
	`shmem_u£ruÀ
(&
√g
->
¸uÀ
, &
cöfo
, 
ruÀöfo
, (ruleinfo))

1159 
≥rmô
 = 0;

1160 
√g
->
¸uÀ
.
vîdi˘
 = 
VERDICT_BLOCK
;

1162 
	`SASSERTX
(!
	`SHMID_ISATTACHED
(&
√g
->
¸uÀ
));

1163 
	`SHMEM_CLEAR
(&
√g
->
¸uÀ
, 
SHMEM_ALL
, 1);

1167 
	`öô_iﬁogaddr
(&
§c
,

1168 
obje˘_sockaddr
,

1169 &
˛õ¡
.
to
,

1170 
obje˘_socksho°
,

1171 &
√g
->
√g°©e
.
§c
,

1172 &
√g
->
ˇuth
,

1173 
	`GET_HOSTIDV
(&
√g
->
°©e
),

1174 
	`GET_HOSTIDC
(&
√g
->
°©e
));

1176 
	`öô_iﬁogaddr
(&
d°
,

1177 
obje˘_n⁄e
,

1178 
NULL
,

1179 
obje˘_socksho°
,

1180 #i‡
BAREFOOTD


1181 &
√g
->
¸uÀ
.
exåa
.
boun˚to
,

1183 
NULL
,

1185 
NULL
,

1186 
NULL
,

1190 #i‡!
HAVE_SOCKS_RULES


1196 i‡(!
≥rmô
)

1197 
√g
->
°©e
.
comm™d
 = 
SOCKS_CONNECT
;

1199 i‡(!
≥rmô
 || 
sockscf
.
›ti⁄
.
debug
) {

1202 
	`logdisc⁄√˘
(
√g
->
s
,

1203 
√g
,

1204 
≥rmô
 ? 
OPERATION_ACCEPT
 : 
OPERATION_BLOCK
,

1205 &
§c
,

1206 #i‡
BAREFOOTD


1207 &
d°
,

1209 
NULL
,

1212 
ruÀöfo
,

1213 
	`°æí
(
ruÀöfo
));

1215 #i‡!
HAVE_SOCKS_RULES


1219 i‡(!
≥rmô
) {

1220 ++
Áûedc
;

1221 
	`dñëe_√gŸüã
(
√g
, 0);

1226 #i‡
HAVE_NEGOTIATE_PHASE


1227 
	`socks_Ælocbuf„r
(
√g
->
s
, 
SOCK_STREAM
);

1241 
	`socks_£tbuf„rfd
(
√g
->
s
, 
_IONBF
, 
MAXREQLEN
);

1244 #i‡
HAVE_PAM


1246 
	`STRCPY_ASSERTSIZE
(
√g
->
ßuth
.
md©a
.
∑m
.
£rvi˚«me
,

1247 
	`CRULE_OR_HRULE
(
√g
)->
°©e
.
∑m£rvi˚«me
);

1250 #i‡
HAVE_BSDAUTH


1252 
	`STRCPY_ASSERTSIZE
(
√g
->
ßuth
.
md©a
.
bsd
.
°yÀ
,

1253 
	`CRULE_OR_HRULE
(
√g
)->
°©e
.
bsdauth°yÀ«me
);

1256 #i‡
HAVE_GSSAPI


1258 
	`STRCPY_ASSERTSIZE
(
√g
->
ßuth
.
md©a
.
gsßpi
.
£rvi˚«me
,

1259 
	`CRULE_OR_HRULE
(
√g
)->
°©e
.
gsßpi£rvi˚«me
);

1261 
	`STRCPY_ASSERTSIZE
(
√g
->
ßuth
.
md©a
.
gsßpi
.
keyèb
,

1262 
	`CRULE_OR_HRULE
(
√g
)->
°©e
.
gsßpikeyèb
);

1264 
√g
->
ßuth
.
md©a
.
gsßpi
.
í¸y±i⁄


1265 
	`CRULE_OR_HRULE
(
√g
)->
°©e
.
gsßpõn¸y±i⁄
;

1268 #i‡
HAVE_SOCKS_HOSTID


1269 i‡(
sockscf
.
hruÀ
 !
NULL
) {

1280 
size_t
 
p
;

1282 
	`¶og
(
LOG_DEBUG
, "%s: checkögác˚s†through ho°idÑuÀs", 
fun˘i⁄
);

1284 
√g
->
°©e
.
comm™d
 = 
SOCKS_HOSTID
;

1285 
≥rmô
 = 
	`ruÀ•îmô
(
√g
->
s
,

1286 &
˛õ¡
.
‰om
,

1287 &
˛õ¡
.
to
,

1288 &
√g
->
ˇuth
,

1289 &
√g
->
ˇuth
,

1290 &
√g
->
hruÀ
,

1291 &
√g
->
°©e
,

1292 &
√g
->
√g°©e
.
§c
,

1293 &
√g
->
√g°©e
.
d°
,

1294 
NULL
,

1295 
ruÀöfo
,

1296 (
ruÀöfo
));

1301 i‡(!
≥rmô
 || (≥rmô && 
√g
->
°©e
.
ho°idc
 > 0)) {

1302 
√g
->
hruÀ_is£t
 = 1;

1304 
	`£tc⁄fsock›ti⁄s
(
√g
->
s
,

1306 
SOCKS_TCP
,

1308 
√g
->
hruÀ
.
sockë›ti⁄c
,

1309 
√g
->
hruÀ
.
sockë›ti⁄v
,

1310 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
,

1313 
	`HOSTIDCOPY
(&
§c
, &
√g
->
°©e
);

1315 i‡(
≥rmô
) {

1320 i‡(
	`ruÀ_öhîô‹u£
(&
√g
->
¸uÀ
,

1321 &
cöfo
,

1322 &
√g
->
hruÀ
,

1323 &
cöfo
,

1324 
ALARM_INTERNAL
,

1325 
ruÀöfo
,

1326 (
ruÀöfo
)) != 0) {

1327 
	`SHMEM_CLEAR
(&
√g
->
hruÀ
, 
SHMEM_ALL
, 1);

1328 
≥rmô
 = 0;

1332 i‡(
√g
->
hruÀ
.
log
.
t˝öfo
) {

1333 
fdv
[] = { 
√g
->
s
 };

1335 
√g
->
°©e
.
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

1338 
	`iﬁog
(&
√g
->
hruÀ
,

1339 &
√g
->
°©e
,

1340 
≥rmô
 ? 
OPERATION_HOSTID
 : 
OPERATION_BLOCK
,

1341 &
§c
,

1343 #i‡
BAREFOOTD


1344 &
d°
,

1346 
NULL
,

1349 
NULL
,

1350 
NULL
,

1351 
ruÀöfo
,

1352 
	`°æí
(
ruÀöfo
));

1354 i‡(!
≥rmô
) {

1358 
p
 = 
	`¢¥ötf
(
ruÀöfo
, (ruleinfo),

1360 
	`obje˘ty≥2°rög
(
√g
->
hruÀ
.
ty≥
),

1361 ()
√g
->
hruÀ
.
numbî
);

1363 i‡(
√g
->
¸uÀ
.
log
.
t˝öfo
 &&Çeg->
°©e
.t˝öfÿ=
NULL
) {

1364 
fdv
[] = { 
√g
->
s
 };

1366 
√g
->
°©e
.
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

1369 
√g
->
°©e
.
comm™d
 = 
HAVE_SOCKS_RULES
 ?

1370 
SOCKS_ACCEPT
 : 
SOCKS_CONNECT
;

1372 
	`iﬁog
(&
√g
->
¸uÀ
,

1373 &
√g
->
°©e
,

1374 
OPERATION_BLOCK
,

1375 &
§c
,

1377 #i‡
BAREFOOTD


1378 &
d°
,

1380 
NULL
,

1383 
NULL
,

1384 
NULL
,

1385 
ruÀöfo
,

1386 
p
);

1388 #i‡!
HAVE_SOCKS_RULES


1389 i‡(
sockscf
.
›ti⁄
.
debug
) {

1390 
√g
->
°©e
.
comm™d
 = 
SOCKS_ACCEPT
;

1395 
	`iﬁog
(&
√g
->
¸uÀ
,

1396 &
√g
->
°©e
,

1397 
OPERATION_BLOCK
,

1398 &
§c
,

1399 &
d°
,

1400 
NULL
,

1401 
NULL
,

1402 
ruÀöfo
,

1403 
p
);

1407 
√g
->
°©e
.
t˝öfo
 = 
NULL
;

1409 ++
Áûedc
;

1410 
	`dñëe_√gŸüã
(
√g
, 0);

1415 
√g
->
°©e
.
t˝öfo
 = 
NULL
;

1420 #i‡
BAREFOOTD


1422 
√g
->
ªq
.
vîsi⁄
 = 
PROXY_SOCKS_V5
;

1423 
√g
->
ªq
.
comm™d
 = 
SOCKS_CONNECT
;

1424 
√g
->
ªq
.
Êag
 = 0;

1425 
√g
->
ªq
.
¥Ÿocﬁ
 = 
SOCKS_TCP
;

1427 
	`ruÀaddr2socksho°
(&
√g
->
¸uÀ
.
exåa
.
boun˚to
,

1428 &
√g
->
ªq
.
ho°
,

1429 
√g
->
ªq
.
¥Ÿocﬁ
);

1431 
√g
->
√g°©e
.
com∂ëe
 = 1;

1433 #ñi‡
COVENANT


1435 i‡(
˛õ¡
.
˛õ¡d©Æí
 > 0) {

1436 
	`¶og
(
LOG_DEBUG
,

1440 
fun˘i⁄
,

1441 ()
˛õ¡
.
˛õ¡d©Æí
,

1442 
	`socksho°2°rög
(&
˛õ¡
.
ªque°
.
ho°
, 
NULL
, 0));

1444 
	`SASSERTX
(
˛õ¡
.
˛õ¡d©Æí
 <(
√g
->
√g°©e
.
mem
));

1445 
	`mem˝y
(
√g
->
√g°©e
.
mem
, 
˛õ¡
.
˛õ¡d©a
, clõ¡.
˛õ¡d©Æí
);

1446 
√g
->
√g°©e
.
ªqªad
 = 
˛õ¡
.
˛õ¡d©Æí
;

1447 
√g
->
√g°©e
.
com∂ëe
 = 1;

1448 
√g
->
ªq
 = 
˛õ¡
.
ªque°
;

1449 *
√g
->
ªq
.
auth
 = 
˛õ¡
.auth;

1457 i‡(
	`CRULE_OR_HRULE
(
√g
)->
m°©s_shmid
 != 0

1458 && 
	`CRULE_OR_HRULE
(
√g
)->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)

1459 
	`Æ¨m_add_c⁄√˘
(
	`CRULE_OR_HRULE
(
√g
),

1460 
ALARM_INTERNAL
,

1461 &
cöfo
,

1462 
sockscf
.
shmemfd
, 0);

1465 
√g
->
√g°©e
.
¸uÀ
 = &neg->crule;

1467 
√g
->
Æloˇãd
 = 1;

1468 ++
√wc
;

1471 i‡(
√wc
 =0 && 
Áûedc
 == 0) {

1472 
	`¶og
(
LOG_DEBUG
,

1475 
fun˘i⁄
,

1476 ()(
‰ìc
 + 1),

1477 ()
SOCKD_NEGOTIATEMAX
,

1478 
	`°ªº‹
(
î∫o
));

1483 i‡(
	`ERRNOISTMP
(
î∫o
))

1484 
î∫o
 = 0;

1486  
√wc
;

1487 
	}
}

1490 
	$dñëe_√gŸüã
(
√g
, 
f‹w¨dedtomŸhî
)

1491 
sockd_√gŸüã_t
 *
√g
;

1492 c⁄° 
f‹w¨dedtomŸhî
;

1494 c⁄° *
fun˘i⁄
 = "delete_negotiate()";

1496 
	`¶og
(
LOG_DEBUG
, "%s: f‹w¨dedtomŸhî: %d", 
fun˘i⁄
, 
f‹w¨dedtomŸhî
);

1498 i‡(!
f‹w¨dedtomŸhî
) {

1499 c⁄° 
cmd
 = (
√g
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

1500 
SOCKD_FREESLOT_TCP
 : 
SOCKD_FREESLOT_UDP
);

1501 
˛õ¡öfo_t
 
cöfo
;

1503 #i‡
HAVE_GSSAPI


1504 i‡(
√g
->
ßuth
.
mëhod
 =
AUTHMETHOD_GSSAPI


1505 && 
√g
->
ßuth
.
md©a
.
gsßpi
.
°©e
.
id
 !
GSS_C_NO_CONTEXT
) {

1506 
OM_uöt32
 
maj‹_°©us
, 
mö‹_°©us
;

1508 i‡((
maj‹_°©us


1509 
	`gss_dñëe_£c_c⁄ãxt
(&
mö‹_°©us
,

1510 &
√g
->
ßuth
.
md©a
.
gsßpi
.
°©e
.
id
,

1511 
GSS_C_NO_BUFFER
)Ë!
GSS_S_COMPLETE
){

1512 
buf
[512];

1514 i‡(!
	`gss_îr_is£t
(
maj‹_°©us
,

1515 
mö‹_°©us
,

1516 
buf
,

1517 (
buf
))) {

1518 *
buf
 = 
NUL
;

1520 
	`sw¨n
("%s: gss_delete_sec_context() failed%s%s",

1521 
fun˘i⁄
,

1522 *
buf
 =
NUL
 ? "" : ": ",

1523 *
buf
 =
NUL
 ? "" : buf);

1529 
	`socksho°2sockaddr
(&
√g
->
√g°©e
.
§c
, &
cöfo
.
‰om
);

1530 
	`HOSTIDCOPY
(&
√g
->
°©e
, &
cöfo
);

1532 i‡(
	`socks_£ndt⁄
(
sockscf
.
°©e
.
mŸhî
.
ack
,

1533 &
cmd
,

1534 (
cmd
),

1535 (
cmd
),

1537 
NULL
,

1539 
NULL
,

1540 
NULL
Ë!(
cmd
))

1541 
	`¶og
(
	`sockd_mŸhîexi°s
(Ë? 
LOG_WARNING
 : 
LOG_DEBUG
,

1543 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

1545 
	`SHMEM_UNUSE
(
	`CRULE_OR_HRULE
(
√g
),

1546 &
cöfo
,

1547 
sockscf
.
shmemfd
,

1548 
SHMEM_ALL
);

1551 #i‡
HAVE_NEGOTIATE_PHASE


1552 
	`socks_‰ìbuf„r
(
√g
->
s
);

1555 
	`˛o£
(
√g
->
s
);

1556 
	`bzîo
(
√g
, (*neg));

1557 
	`¥o˘ôÀupd©e
();

1558 
	}
}

1561 
	$√g_fûl£t
(
£t
, 
skùcom∂ëed
, 
skùö¥ogªss
)

1562 
fd_£t
 *
£t
;

1563 c⁄° 
skùcom∂ëed
;

1564 c⁄° 
skùö¥ogªss
;

1566 
size_t
 
i
;

1567 
max
;

1569 
	`FD_ZERO
(
£t
);

1570 
i
 = 0, 
max
 = -1; i < 
√gc
; ++i) {

1571 i‡(!
√gv
[
i
].
Æloˇãd
)

1574 #i‡!
HAVE_NEGOTIATE_PHASE


1575 
	`SASSERTX
(
√gv
[
i
].
√g°©e
.
com∂ëe
);

1578 i‡(
skùcom∂ëed
 && 
√gv
[
i
].
√g°©e
.
com∂ëe
)

1581 i‡(
skùö¥ogªss
 && !
√gv
[
i
].
√g°©e
.
com∂ëe
)

1584 
	`FD_SET
(
√gv
[
i
].
s
, 
£t
);

1585 
max
 = 
	`MAX
(max, 
√gv
[
i
].
s
);

1588  
max
;

1589 
	}
}

1592 
	$√g_˛ór£t
(
√g
, 
£t
)

1593 
sockd_√gŸüã_t
 *
√g
;

1594 
fd_£t
 *
£t
;

1597 
	`FD_CLR
(
√g
->
s
, 
£t
);

1598 
	}
}

1600 
sockd_√gŸüã_t
 *

1601 
	$√g_gë£t
(
£t
)

1602 
fd_£t
 *
£t
;

1604 
size_t
 
i
;

1606 
i
 = 0; i < 
√gc
; ++i) {

1607 i‡(!
√gv
[
i
].
Æloˇãd
)

1610 i‡(
	`FD_ISSET
(
√gv
[
i
].
s
, 
£t
))

1611  &
√gv
[
i
];

1614  
NULL
;

1615 
	}
}

1617 
size_t


1618 
	$√g_Æloˇãd
()

1620 
size_t
 
i
, 
Æloc
;

1622 
i
 = 0, 
Æloc
 = 0; i < 
√gc
; ++i)

1623 i‡(
√gv
[
i
].
Æloˇãd
)

1624 ++
Æloc
;

1626  
Æloc
;

1627 
	}
}

1629 
size_t


1630 
	$√g_com∂ëed
(
cou¡
)

1631 c⁄° 
size_t
 
cou¡
;

1633 
size_t
 
i
, 
com∂ëec
;

1635 
i
 = 0, 
com∂ëec
 = 0; i < 
√gc
; ++i)

1636 i‡(
√gv
[
i
].
Æloˇãd
 &&Çegv[i].
√g°©e
.
com∂ëe
)

1637 i‡(++
com∂ëec
 >
cou¡
)

1638  
com∂ëec
;

1640  
com∂ëec
;

1641 
	}
}

1644 
	$¥o˘ôÀupd©e
()

1647 
	`£çro˘ôÀ
("%s: %lu/%lu",

1648 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
),

1649 ()
	`√g_Æloˇãd
(),

1650 ()
SOCKD_NEGOTIATEMAX
);

1651 
	}
}

1654 
	$logdisc⁄√˘
(
s
, 
√g
, 
›
, 
§c
, 
d°
, 
buf
, 
buÊí
)

1655 c⁄° 
s
;

1656 
sockd_√gŸüã_t
 *
√g
;

1657 c⁄° 
›î©i⁄_t
 
›
;

1658 c⁄° 
iﬁogaddr_t
 *
§c
;

1659 c⁄° 
iﬁogaddr_t
 *
d°
;

1660 c⁄° *
buf
;

1661 c⁄° 
size_t
 
buÊí
;

1664 i‡(
√g
->
¸uÀ
.
log
.
t˝öfo
) {

1665 
fdv
[] = { 
√g
->
s
 };

1667 
√g
->
°©e
.
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

1670 
	`iﬁog
(&
√g
->
¸uÀ
,

1671 &
√g
->
°©e
,

1672 
›
,

1673 
§c
,

1674 
d°
,

1675 
NULL
,

1676 
NULL
,

1677 
buf
,

1678 
buÊí
);

1680 #i‡
HAVE_SOCKS_HOSTID


1681 i‡(
√g
->
hruÀ_is£t
) {

1682 i‡(
√g
->
°©e
.
t˝öfo
 =
NULL
 &&Çeg->
hruÀ
.
log
.tcpinfo) {

1683 
fdv
[] = { 
√g
->
s
 };

1685 
√g
->
°©e
.
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

1688 
	`iﬁog
(&
√g
->
hruÀ
,

1689 &
√g
->
°©e
,

1690 
›
,

1691 
§c
,

1692 
d°
,

1693 
NULL
,

1694 
NULL
,

1695 
buf
,

1696 
buÊí
);

1700 
√g
->
°©e
.
t˝öfo
 = 
NULL
;

1701 
	}
}

1704 
timevÆ
 *

1705 
	$√g_gëtimeout
(
timeout
)

1706 
timevÆ
 *
timeout
;

1708 #i‡
HAVE_NEGOTIATE_PHASE


1709 c⁄° *
fun˘i⁄
 = "neg_gettimeout()";

1710 
time_t
 
timíow
;

1711 
size_t
 
i
;

1712 
havëimeout
;

1714 
havëimeout
 = 0;

1715 
	`time_m⁄Ÿ⁄ic
(&
timíow
);

1717 
i
 = 0; i < 
√gc
; ++i) {

1718 i‡(!
√gv
[
i
].
Æloˇãd
)

1721 i‡(
	`CRULE_OR_HRULE
(&
√gv
[
i
])->
timeout
.
√gŸüã
 == 0)

1724 i‡(
havëimeout
)

1725 
timeout
->
tv_£c


1726 
	`MAX
(0,

1727 
	`MIN
(
timeout
->
tv_£c
,

1728 
	`socks_dif·ime
(
	`CRULE_OR_HRULE
(&
√gv
[
i
])->
timeout
.
√gŸüã
,

1729 
	`socks_dif·ime
(
timíow
,

1730 
√gv
[
i
].
°©e
.
time
.
√gŸüã°¨t
.
tv_£c
))));

1732 
timeout
->
tv_£c


1733 
	`MAX
(0,

1734 
	`socks_dif·ime
(
	`CRULE_OR_HRULE
(&
√gv
[
i
])->
timeout
.
√gŸüã
,

1735 
	`socks_dif·ime
(
timíow
,

1736 
√gv
[
i
].
°©e
.
time
.
√gŸüã°¨t
.
tv_£c
)));

1737 
havëimeout
 = 1;

1741 i‡(!
havëimeout
)

1742 
timeout
 = 
NULL
;

1748 
timeout
->
tv_u£c
 = 999999;

1752 
timeout
 = 
NULL
;

1755  
timeout
;

1756 
	}
}

1760 
	$sigöfo
(
sig
, 
si
, 
sc
)

1761 
sig
;

1762 
sigöfo_t
 *
si
;

1763 *
sc
;

1765 c⁄° *
fun˘i⁄
 = "siginfo()";

1766 c⁄° 
î∫o_s
 = 
î∫o
;

1767 
time_t
 
äow
;

1768 
days
, 
hours
, 
möuãs
, 
£c⁄ds
;

1769 
size_t
 
i
;

1771 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

1773 
£c⁄ds
 = ()
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(&
äow
),

1774 
sockscf
.
°©
.
boŸ
);

1776 
	`£c⁄ds2days
(&
£c⁄ds
, &
days
, &
hours
, &
möuãs
);

1778 
	`¶og
(
LOG_INFO
, "negotiate-child up %lu day%s, %lu:%.2lu:%.2lu",

1779 
days
, day†=1 ? "" : "s", 
hours
, 
möuãs
, 
£c⁄ds
);

1781 
i
 = 0; i < 
√gc
; ++i) {

1782 
§c°rög
[
MAX_IOLOGADDR
], *
t˝öfo
;

1784 i‡(!
√gv
[
i
].
Æloˇãd
)

1787 
	`buûd_addr°r_§c
(
	`GET_HOSTIDV
(&
√gv
[
i
].
°©e
),

1788 
	`GET_HOSTIDC
(&
√gv
[
i
].
°©e
),

1789 &
√gv
[
i
].
√g°©e
.
§c
,

1790 
NULL
,

1791 
NULL
,

1792 &
√gv
[
i
].
√g°©e
.
d°
,

1793 &
√gv
[
i
].
ˇuth
,

1794 
NULL
,

1795 
§c°rög
,

1796 (
§c°rög
));

1798 i‡(
	`CRULE_OR_HRULE
(&
√gv
[
i
])->
log
.
t˝öfo
) {

1799 
fdv
[] = { 
√gv
[
i
].
s
 };

1801 
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

1804 
t˝öfo
 = 
NULL
;

1806 
	`¶og
(
LOG_INFO
,

1809 
§c°rög
,

1810 ()
	`socks_dif·ime
(
äow
, 
√gv
[
i
].
°©e
.
time
.
√gŸüã°¨t
.
tv_£c
),

1811 
t˝öfo
 =
NULL
 ? "" : "\n",

1812 
t˝öfo
 =
NULL
 ? "" : " TCP_INFO:\n",

1813 
t˝öfo
 =
NULL
 ? "" :Åcpinfo);

1816 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

1817 
	}
}

1819 #i‡
HAVE_NEGOTIATE_PHASE


1820 
sockd_√gŸüã_t
 *

1821 
	$√g_gëtimedout
(c⁄° 
timevÆ
 *
äow
)

1823 
size_t
 
i
;

1825 
i
 = 0; i < 
√gc
; ++i) {

1826 i‡(!
√gv
[
i
].
Æloˇãd


1827 || 
	`CRULE_OR_HRULE
(&
√gv
[
i
])->
timeout
.
√gŸüã
 == 0)

1830 i‡(
	`socks_dif·ime
(
äow
->
tv_£c
, 
√gv
[
i
].
°©e
.
time
.
√gŸüã°¨t
.tv_sec)

1831 >
	`CRULE_OR_HRULE
(&
√gv
[
i
])->
timeout
.
√gŸüã
)

1832  &
√gv
[
i
];

1835  
NULL
;

1836 
	}
}

	@sockd/sockd_protocol.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

50 #i‡
SOCKS_SERVER


51 
√gŸüã_ªsu…_t


52 
ªcv_v4ªq
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

54 
√gŸüã_ªsu…_t


55 
ªcv_v5ªq
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

57 
√gŸüã_ªsu…_t


58 
ªcv_mëhods
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

60 
√gŸüã_ªsu…_t


61 
ªcv_vî
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

63 
√gŸüã_ªsu…_t


64 
ªcv_cmd
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

66 
√gŸüã_ªsu…_t


67 
ªcv_Êag
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

69 
√gŸüã_ªsu…_t


70 
ªcv_socksho°
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

72 
√gŸüã_ªsu…_t


73 
ªcv_©yp
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

75 
√gŸüã_ªsu…_t


76 
ªcv_p‹t
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

78 
√gŸüã_ªsu…_t


79 
ªcv_addªss
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

81 
√gŸüã_ªsu…_t


82 
ªcv_domaö
(
s
, 
ªque°_t
 *
ªque°
, 
√gŸüã_°©e_t
 *
°©e
);

84 
√gŸüã_ªsu…_t


85 
ªcv_u£∫ame
(
s
, 
ªque°_t
 *
ªque°
,

86 
√gŸüã_°©e_t
 *
°©e
);

88 
√gŸüã_ªsu…_t


89 
mëhod√gŸüã
(
s
, 
ªque°_t
 *
ªque°
,

90 
√gŸüã_°©e_t
 *
°©e
);

93 
√gŸüã_ªsu…_t


94 
	$ªcv_˛õ¡ªque°
(
s
, 
ªque°
, 
°©e
)

95 
s
;

96 
ªque°_t
 *
ªque°
;

97 
√gŸüã_°©e_t
 *
°©e
;

99 c⁄° *
fun˘i⁄
 = "recv_clientrequest()";

100 #i‡
HAVE_NEGOTIATE_PHASE


101 
√gŸüã_ªsu…_t
 
rc
;

104 
	`¶og
(
LOG_DEBUG
,

106 
fun˘i⁄
,

107 
s
,

108 
	`socksho°2°rög
(&
°©e
->
§c
, 
NULL
, 0),

109 
°©e
->
com∂ëe
,

110 ()
°©e
->
ªqªad
);

112 i‡(
°©e
->
com∂ëe
)

113  
NEGOTIATE_FINISHED
;

115 #i‡
HAVE_NEGOTIATE_PHASE


117 #i‡
SOCKS_SERVER


118 
	`CTASSERT
((
°©e
->
mem
Ë> (
MAXMETHODS
 + 
MAXNAMELEN
 + 
MAXPWLEN
));

121 i‡(
°©e
->
rcuºít
 !
NULL
)

122 
rc
 = 
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

124 
§c
[
MAXSOCKSHOSTSTRING
], 
d°
[(src)];

126 #i‡
SOCKS_SERVER


127 
	`INIT
((
ªque°
->
vîsi⁄
));

128 
	`CHECK
(&
ªque°
->
vîsi⁄
,Ñeque°->
auth
, 
NULL
);

130 
ªque°
->
vîsi⁄
) {

131 
PROXY_SOCKS_V4
:

132 
°©e
->
rcuºít
 = 
ªcv_v4ªq
;

135 
PROXY_SOCKS_V5
:

136 
°©e
->
rcuºít
 = 
ªcv_v5ªq
;

140 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

142 
ªque°
->
vîsi⁄
);

143  
NEGOTIATE_ERROR
;

146 #ñi‡
COVENANT


147 
°©e
->
rcuºít
 = 
ªcv_hâ¥eque°
;

149 
	`SASSERTX
(0);

152 
	`¶og
(
LOG_DEBUG
, "%s: initiatingÇegotiation with clientát %s "

154 
fun˘i⁄
,

155 
	`socksho°2°rög
(&
°©e
->
§c
, src, (src)),

156 
	`socksho°2°rög
(&
°©e
->
d°
, dst, (dst)));

158 
rc
 = 
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

161 
°©e
->
com∂ëe
 = (
rc
 =
NEGOTIATE_FINISHED
);

162  
rc
;

165 
	`SASSERTX
(
°©e
->
com∂ëe
);

166  
NEGOTIATE_FINISHED
;

170 
	}
}

172 #i‡
HAVE_NEGOTIATE_PHASE


174 
	$£nd_Áûuª
(
s
, 
ª•⁄£
, 
Áûuª
)

175 c⁄° 
s
;

176 
ª•⁄£_t
 *
ª•⁄£
;

177 c⁄° 
Áûuª
;

179 c⁄° *
fun˘i⁄
 = "send_failure()";

181 
	`socks_£t_ª•⁄£vÆue
(
ª•⁄£
, 
	`sockscode
‘e•⁄£->
vîsi⁄
, 
Áûuª
));

182 i‡(
	`£nd_ª•⁄£
(
s
, 
ª•⁄£
) != 0)

183 
	`¶og
(
LOG_DEBUG
, "%s: couldÇot send failureÅo client: %s",

184 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

186 #i‡
HAVE_GSSAPI


187 i‡(
ª•⁄£
->
auth
->
mëhod
 =
AUTHMETHOD_GSSAPI


188 && 
ª•⁄£
->
auth
->
md©a
.
gsßpi
.
°©e
.
id
 !
GSS_C_NO_CONTEXT
) {

189 
OM_uöt32
 
maj‹_°©us
, 
mö‹_°©us
;

190 
buf
[512];

192 i‡((
maj‹_°©us


193 
	`gss_dñëe_£c_c⁄ãxt
(&
mö‹_°©us
,

194 &
ª•⁄£
->
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

195 
GSS_C_NO_BUFFER
)Ë!
GSS_S_COMPLETE
) {

196 i‡(!
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
buf
, (buf)))

197 *
buf
 = 
NUL
;

199 
	`sw¨n
("%s: gss_delete_sec_context() failed%s%s",

200 
fun˘i⁄
,

201 *
buf
 =
NUL
 ? "" : ": ",

202 *
buf
 =
NUL
 ? "" : buf);

206 
	}
}

209 
	$£nd_ª•⁄£
(
s
, 
ª•⁄£
)

210 
s
;

211 c⁄° 
ª•⁄£_t
 *
ª•⁄£
;

213 c⁄° *
fun˘i⁄
 = "send_response()";

214 
iobuf„r_t
 *
tmpiobuf
;

215 
£ndto_öfo_t
 
£ndtoÊags
;

216 
ssize_t
 
£¡
;

217 
size_t
 
Àngth
;

218 #i‡
SOCKS_SERVER


219 
ª•⁄£mem
[(*
ª•⁄£
)], *
p
 =Ñesponsemem;

221 
ª•⁄£mem
[1024], *
p
 =Ñesponsemem;

224 
ª•⁄£
->
vîsi⁄
) {

225 #i‡
SOCKS_SERVER


226 
PROXY_SOCKS_V4REPLY_VERSION
:

236 
	`mem˝y
(
p
, &
ª•⁄£
->
vîsi⁄
, (response->version));

237 
p
 +(
ª•⁄£
->
vîsi⁄
);

240 
	`mem˝y
(
p
, &
ª•⁄£
->
ª∂y
.
socks
, (response->reply.socks));

241 
p
 +(
ª•⁄£
->
ª∂y
.
socks
);

243 
p
 = 
	`socksho°2mem
(&
ª•⁄£
->
ho°
,Ö,Ñe•⁄£->
vîsi⁄
);

244 
Àngth
 = 
p
 - 
ª•⁄£mem
;

248 
PROXY_SOCKS_V5
:

266 
	`mem˝y
(
p
, &
ª•⁄£
->
vîsi⁄
, (response->version));

267 
p
 +(
ª•⁄£
->
vîsi⁄
);

270 
	`mem˝y
(
p
, &
ª•⁄£
->
ª∂y
.
socks
, (response->reply.socks));

271 
p
 +(
ª•⁄£
->
ª∂y
.
socks
);

274 
	`mem˝y
(
p
, &
ª•⁄£
->
Êag
, (response->flag));

275 
p
 +(
ª•⁄£
->
Êag
);

277 
p
 = 
	`socksho°2mem
(&
ª•⁄£
->
ho°
,Ö,Ñe•⁄£->
vîsi⁄
);

280 #ñi‡
COVENANT


281 
PROXY_HTTP_10
:

282 
PROXY_HTTP_11
: {

283 
size_t
 
l
;

285 
l
 = 
	`hâ¥e•⁄£2mem
(
s
, 
ª•⁄£
, 
ª•⁄£mem
, (responsemem));

286 
p
 +
l
;

293 
	`SERRX
(
ª•⁄£
->
vîsi⁄
);

296 
Àngth
 = 
p
 - 
ª•⁄£mem
;

298 #i‡
SOCKS_SERVER


299 
	`¶og
(
LOG_DEBUG
, "%s: sendingÑesponse: %s,áuthmethod %d",

300 
fun˘i⁄
, 
	`socks_∑ckë2°rög
(
ª•⁄£
, 0),Ñe•⁄£->
auth
->
mëhod
);

303 
	`¶og
(
LOG_DEBUG
, "%s: sídögÑe•⁄£:\n%s", 
fun˘i⁄
, 
ª•⁄£mem
);

310 i‡(
	`socks_gëbuf„r
(
s
Ë=
NULL
)

311 
tmpiobuf
 = 
	`socks_Ælocbuf„r
(
s
, 
SOCK_STREAM
);

313 
tmpiobuf
 = 
NULL
;

315 
	`bzîo
(&
£ndtoÊags
, (sendtoflags));

316 
£ndtoÊags
.
side
 = 
INTERNALIF
;

318 
£¡
 = 
	`socks_£ndt⁄
(
s
,

319 
ª•⁄£mem
,

320 
Àngth
,

323 
NULL
,

325 &
£ndtoÊags
,

326 
ª•⁄£
->
auth
);

328 i‡(
tmpiobuf
 !
NULL
)

329 
	`socks_‰ìbuf„r
(
s
);

331 i‡(
£¡
 !(
ssize_t
)
Àngth
) {

332 
	`¶og
(
LOG_DEBUG
, "%s: socks_sendton(): %ld/%lu: %s",

333 
fun˘i⁄
, ()
£¡
, ()
Àngth
, 
	`°ªº‹
(
î∫o
));

339 
	}
}

342 
	$£nd_c⁄√˘ª•⁄£
(
s
, 
îr‹
, 
io
)

343 c⁄° 
s
;

344 c⁄° 
îr‹
;

345 
sockd_io_t
 *
io
;

347 
ª•⁄£_t
 
ª•⁄£
;

349 
	`¸óã_ª•⁄£
(

350 #i‡
SOCKS_SERVER


351 
	`sockaddr2socksho°
(&
io
->
d°
.
œddr
, 
NULL
),

352 #ñi‡
COVENANT


353 &
io
->
d°
.
ho°
,

358 &
io
->
§c
.
auth
,

359 
io
->
°©e
.
¥oxy¥Ÿocﬁ
,

360 
îr‹
 == 0 ?

361 
SOCKS_SUCCESS
 : ()
	`î∫o2ª∂y
(
îr‹
,

362 
io
->
°©e
.
¥oxy¥Ÿocﬁ
),

363 &
ª•⁄£
);

365 i‡(
	`£nd_ª•⁄£
(
s
, &
ª•⁄£
) != 0)

369 
	}
}

371 
ª•⁄£_t
 *

372 
	$¸óã_ª•⁄£
(
ho°
, 
auth
, 
vîsi⁄
, 
ª•⁄£code
, 
ª•⁄£
)

373 c⁄° 
socksho°_t
 *
ho°
;

374 
authmëhod_t
 *
auth
;

375 c⁄° 
vîsi⁄
;

376 c⁄° 
ª•⁄£code
;

377 
ª•⁄£_t
 *
ª•⁄£
;

380 
	`bzîo
(
ª•⁄£
, (*response));

381 
ª•⁄£
->
auth
 =áuth;

383 
vîsi⁄
) {

384 #i‡
SOCKS_SERVER


385 
PROXY_SOCKS_V4
:

386 
ª•⁄£
->
vîsi⁄
 = 
PROXY_SOCKS_V4REPLY_VERSION
;

389 
PROXY_SOCKS_V5
:

390 #ñi‡
COVENANT


391 
PROXY_HTTP_10
:

392 
PROXY_HTTP_11
:

394 
ª•⁄£
->
vîsi⁄
 = version;

398 
	`SERRX
(
vîsi⁄
);

401 i‡(
ho°
 !
NULL
)

402 
ª•⁄£
->
ho°
 = *host;

404 
ª•⁄£
->
ho°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

407 
	`socks_£t_ª•⁄£vÆue
(
ª•⁄£
,

408 
	`sockscode
(
vîsi⁄
, 
ª•⁄£code
));

410  
ª•⁄£
;

411 
	}
}

414 #i‡
SOCKS_SERVER


415 
√gŸüã_ªsu…_t


416 
	$ªcv_sock•ackë
(
s
, 
ªque°
, 
°©e
)

417 
s
;

418 
ªque°_t
 *
ªque°
;

419 
√gŸüã_°©e_t
 *
°©e
;

422  
	`ªcv_vî
(
s
, 
ªque°
, 
°©e
);

423 
	}
}

425 
√gŸüã_ªsu…_t


426 
	$ªcv_v4ªq
 (
s
, 
ªque°
, 
°©e
)

427 
s
;

428 
ªque°_t
 *
ªque°
;

429 
√gŸüã_°©e_t
 *
°©e
;

443 
ªque°
->
auth
->
mëhod
 = 
AUTHMETHOD_NONE
;

446 
°©e
->
rcuºít
 = 
ªcv_cmd
;

447  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

449 
	}
}

451 
√gŸüã_ªsu…_t


452 
	$ªcv_v5ªq
 (
s
, 
ªque°
, 
°©e
)

453 
s
;

454 
ªque°_t
 *
ªque°
;

455 
√gŸüã_°©e_t
 *
°©e
;

487 
	`INIT
(());

488 
	`CHECK
(&
°©e
->
mem
[
°¨t
], 
ªque°
->
auth
, 
NULL
);

490 
	`OCTETIFY
(
°©e
->
mem
[
°¨t
]);

492 
°©e
->
rcuºít
 = 
ªcv_mëhods
;

493  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

494 
	}
}

496 
√gŸüã_ªsu…_t


497 
	$ªcv_mëhods
(
s
, 
ªque°
, 
°©e
)

498 
s
;

499 
ªque°_t
 *
ªque°
;

500 
√gŸüã_°©e_t
 *
°©e
;

503 c⁄° *
fun˘i⁄
 = "recv_methods()";

504 
£ndto_öfo_t
 
£ndtoÊags
;

505 c⁄° 
mëhodc
 = 
°©e
->
mem
[
AUTH_NMETHODS
];

506 
ª∂y
[ 1

509 
buf
[(
AUTHMETHOD_MAX
 + 1) * (("0x00 (some methodname")

511 
size_t
 
bufu£d
;

512 
i
;

514 
	`INIT
(
mëhodc
);

515 
	`CHECK
(&
°©e
->
mem
[
°¨t
], 
ªque°
->
auth
, 
NULL
);

517 *
buf
 = 
NUL
;

518 
i
 = 
bufu£d
 = 0; i < 
mëhodc
; ++i)

519 
bufu£d
 +
	`¢¥ötf
(&
buf
[bufused], (buf) - bufused, "0x%x (%s), ",

520 
°©e
->
mem
[
°¨t
 + 
i
],

521 
	`mëhod2°rög
(
°©e
->
mem
[
°¨t
 + 
i
]));

523 i‡(
bufu£d
 >(
buf
) - 1)

524 
	`sw¨nx
("%s: suspiciously many (%u) methods offered by client %s",

525 
fun˘i⁄
, 
mëhodc
, 
	`socksho°2°rög
(&
°©e
->
§c
, 
NULL
, 0));

527 i‡(
bufu£d
 >
	`°æí
(", "Ë&& 
buf
[bufused - strlen(", ")] == ',')

528 
buf
[
bufu£d
 - 
	`°æí
(", ")] = 
NUL
;

530 
	`¶og
(
LOG_DEBUG
, "%s: client %s offered %dáuthentication method%s: %s",

531 
fun˘i⁄
,

532 
	`socksho°2°rög
(&
°©e
->
§c
, 
NULL
, 0),

533 
mëhodc
, methodc == 1 ? "" : "s",

534 
buf
);

536 
ªque°
->
auth
->
mëhod
) {

537 
AUTHMETHOD_NOTSET
:

538 
	`¶og
(
LOG_DEBUG
,

541 
fun˘i⁄
,

542 ()
°©e
->
¸uÀ
->°©e.
smëhodc
,

543 ()
°©e
->
¸uÀ
->°©e.
smëhodc
 == 1 ? "" : "s",

544 
	`mëhods2°rög
(
°©e
->
¸uÀ
->°©e.
smëhodc
,

545 
°©e
->
¸uÀ
->°©e.
smëhodv
,

546 
NULL
,

549 
ªque°
->
auth
->
mëhod
 = 
	`£À˘mëhod
(
°©e
->
¸uÀ
->°©e.
smëhodv
,

550 
°©e
->
¸uÀ
->°©e.
smëhodc
,

551 &
°©e
->
mem
[
°¨t
],

552 (
size_t
)
mëhodc
);

563 
size_t
 
i
;

565 
	`¶og
(
LOG_DEBUG
,

567 
fun˘i⁄
, 
ªque°
->
auth
->
mëhod
);

569 
i
 = 0; i < 
mëhodc
; ++i)

570 i‡(
°©e
->
mem
[
°¨t
 + 
i
] =
ªque°
->
auth
->
mëhod
)

573 i‡(
i
 >
mëhodc
)

574 
ªque°
->
auth
->
mëhod
 = 
AUTHMETHOD_NOACCEPT
;

589 
	`¶og
(
LOG_DEBUG
, "%s: sendingáuthenticationÑeply: VER: %d METHOD: %d (%s)",

590 
fun˘i⁄
,

591 
ªque°
->
vîsi⁄
,

592 
ªque°
->
auth
->
mëhod
,

593 
	`mëhod2°rög
(
ªque°
->
auth
->
mëhod
));

595 
ª∂y
[
AUTH_VERSION
] = 
ªque°
->
vîsi⁄
;

596 
ª∂y
[
AUTH_SELECTEDMETHOD
] = ()
ªque°
->
auth
->
mëhod
;

598 
	`bzîo
(&
£ndtoÊags
, (sendtoflags));

599 
£ndtoÊags
.
side
 = 
EXTERNALIF
;

601 i‡(
	`socks_£ndt⁄
(
s
,

602 
ª∂y
,

603 (
ª∂y
),

604 (
ª∂y
),

606 
NULL
,

608 &
£ndtoÊags
,

609 
ªque°
->
auth
Ë!(
ª∂y
))

610  
NEGOTIATE_ERROR
;

612 i‡(
ªque°
->
auth
->
mëhod
 =
AUTHMETHOD_NOACCEPT
) {

613 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

616  
NEGOTIATE_ERROR
;

619 
°©e
->
rcuºít
 = 
mëhod√gŸüã
;

620  
NEGOTIATE_CONTINUE
;

621 
	}
}

623 
√gŸüã_ªsu…_t


624 
	$mëhod√gŸüã
(
s
, 
ªque°
, 
°©e
)

625 
s
;

626 
ªque°_t
 *
ªque°
;

627 
√gŸüã_°©e_t
 *
°©e
;

631 
ªque°
->
auth
->
mëhod
) {

632 
AUTHMETHOD_NONE
:

633 
°©e
->
rcuºít
 = 
ªcv_sock•ackë
;

636 #i‡
HAVE_GSSAPI


637 
AUTHMETHOD_GSSAPI
:

638 
°©e
->
rcuºít
 = 
mëhod_gsßpi
;

642 
AUTHMETHOD_UNAME
:

643 
°©e
->
rcuºít
 = 
mëhod_u«me
;

647 
	`SERRX
(
ªque°
->
auth
->
mëhod
);

650  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

651 
	}
}

653 
√gŸüã_ªsu…_t


654 
	$ªcv_vî
(
s
, 
ªque°
, 
°©e
)

655 
s
;

656 
ªque°_t
 *
ªque°
;

657 
√gŸüã_°©e_t
 *
°©e
;

662 
	`INIT
((
ªque°
->
vîsi⁄
));

663 
	`CHECK
(&
ªque°
->
vîsi⁄
,Ñeque°->
auth
, 
NULL
);

665 
ªque°
->
vîsi⁄
) {

666 
PROXY_SOCKS_V4
:

667 
PROXY_SOCKS_V5
:

671 
	`¶og
(
LOG_DEBUG
, "unknow¿vîsi⁄ %d i¿ªque°", 
ªque°
->
vîsi⁄
);

672  
NEGOTIATE_ERROR
;

676 
°©e
->
rcuºít
 = 
ªcv_cmd
;

677  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

678 
	}
}

680 
√gŸüã_ªsu…_t


681 
	$ªcv_cmd
(
s
, 
ªque°
, 
°©e
)

682 
s
;

683 
ªque°_t
 *
ªque°
;

684 
√gŸüã_°©e_t
 *
°©e
;

686 c⁄° *
fun˘i⁄
 = "recv_cmd()";

688 
	`INIT
((
ªque°
->
comm™d
));

689 
	`CHECK
(&
ªque°
->
comm™d
,Ñeque°->
auth
, 
NULL
);

691 
ªque°
->
comm™d
) {

692 
SOCKS_BIND
:

693 
SOCKS_CONNECT
:

694 
ªque°
->
¥Ÿocﬁ
 = 
SOCKS_TCP
;

697 
SOCKS_UDPASSOCIATE
:

698 
ªque°
->
¥Ÿocﬁ
 = 
SOCKS_UDP
;

702 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

704 
	`¥oxy¥Ÿocﬁ2°rög
(
ªque°
->
vîsi⁄
),

705 
ªque°
->
comm™d
);

707  
NEGOTIATE_ERROR
;

710 
ªque°
->
vîsi⁄
) {

711 
PROXY_SOCKS_V4
:

712 
°©e
->
rcuºít
 = 
ªcv_socksho°
;

715 
PROXY_SOCKS_V5
:

716 
°©e
->
rcuºít
 = 
ªcv_Êag
;

720 
	`SERRX
(
ªque°
->
vîsi⁄
);

723  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

724 
	}
}

726 
√gŸüã_ªsu…_t


727 
	$ªcv_Êag
(
s
, 
ªque°
, 
°©e
)

728 
s
;

729 
ªque°_t
 *
ªque°
;

730 
√gŸüã_°©e_t
 *
°©e
;

733 
	`INIT
((
ªque°
->
Êag
));

734 
	`CHECK
(&
ªque°
->
Êag
,Ñeque°->
auth
, 
ªcv_socksho°
);

736 
	`SERRX
(0);

737 
	}
}

739 
√gŸüã_ªsu…_t


740 
	$ªcv_socksho°
(
s
, 
ªque°
, 
°©e
)

741 
s
;

742 
ªque°_t
 *
ªque°
;

743 
√gŸüã_°©e_t
 *
°©e
;

745 
ªque°
->
vîsi⁄
) {

746 
PROXY_SOCKS_V4
:

747 
°©e
->
rcuºít
 = 
ªcv_p‹t
;

750 
PROXY_SOCKS_V5
:

751 
°©e
->
rcuºít
 = 
ªcv_©yp
;

755 
	`SERRX
(
ªque°
->
vîsi⁄
);

758  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

759 
	}
}

761 
√gŸüã_ªsu…_t


762 
	$ªcv_©yp
(
s
, 
ªque°
, 
°©e
)

763 
s
;

764 
ªque°_t
 *
ªque°
;

765 
√gŸüã_°©e_t
 *
°©e
;

768 
	`INIT
((
ªque°
->
ho°
.
©y≥
));

769 
	`CHECK
(&
ªque°
->
ho°
.
©y≥
,Ñeque°->
auth
, 
ªcv_addªss
);

771 
	`SERRX
(0);

772 
	}
}

774 
√gŸüã_ªsu…_t


775 
	$ªcv_addªss
(
s
, 
ªque°
, 
°©e
)

776 
s
;

777 
ªque°_t
 *
ªque°
;

778 
√gŸüã_°©e_t
 *
°©e
;

781 
ªque°
->
vîsi⁄
) {

782 
PROXY_SOCKS_V4
: {

783 
	`INIT
((
ªque°
->
ho°
.
addr
.
ùv4
));

786 
ªque°
->
ho°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

788 
	`CHECK
(&
ªque°
->
ho°
.
addr
.
ùv4
,Ñeque°->
auth
, 
ªcv_u£∫ame
);

789 
	`SERRX
(0);

792 
PROXY_SOCKS_V5
:

793 
ªque°
->
ho°
.
©y≥
) {

794 
SOCKS_ADDR_IPV4
: {

795 
	`INIT
((
ªque°
->
ho°
.
addr
.
ùv4
));

796 
	`CHECK
(&
ªque°
->
ho°
.
addr
.
ùv4
,Ñeque°->
auth
, 
ªcv_p‹t
);

797 
	`SERRX
(0);

800 
SOCKS_ADDR_IPV6
: {

801 
	`INIT
((
ªque°
->
ho°
.
addr
.
ùv6
.
ù
));

802 
	`CHECK
(&
ªque°
->
ho°
.
addr
.
ùv6
.
ù
,Ñeque°->
auth
, 
ªcv_p‹t
);

803 
	`SERRX
(0);

806 
SOCKS_ADDR_DOMAIN
: {

807 
	`INIT
((*
ªque°
->
ho°
.
addr
.
domaö
));

808 
	`CHECK
(
ªque°
->
ho°
.
addr
.
domaö
,Ñeque°->
auth
, 
NULL
);

811 
	`OCTETIFY
(*
ªque°
->
ho°
.
addr
.
domaö
);

813 
°©e
->
rcuºít
 = 
ªcv_domaö
;

814  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

818 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

820 
	`¥oxy¥Ÿocﬁ2°rög
(
ªque°
->
vîsi⁄
),

821 
ªque°
->
comm™d
);

822  
NEGOTIATE_ERROR
;

826 
	`SERRX
(
ªque°
->
vîsi⁄
);

829 
	`SERRX
(0);

830 
	}
}

832 
√gŸüã_ªsu…_t


833 
	$ªcv_domaö
(
s
, 
ªque°
, 
°©e
)

834 
s
;

835 
ªque°_t
 *
ªque°
;

836 
√gŸüã_°©e_t
 *
°©e
;

838 
Æí
;

840 
	`INIT
(()*
ªque°
->
ho°
.
addr
.
domaö
);

841 
	`CHECK
(
ªque°
->
ho°
.
addr
.
domaö
 + 1,Ñeque°->
auth
, 
NULL
);

843 
Æí
 = *
ªque°
->
ho°
.
addr
.
domaö
;

846 
	`memmove
(
ªque°
->
ho°
.
addr
.
domaö
,Ñequest->host.addr.domain + 1,

847 (
size_t
)
Æí
);

848 
ªque°
->
ho°
.
addr
.
domaö
[
Æí
] = 
NUL
;

850 
°©e
->
rcuºít
 = 
ªcv_p‹t
;

851  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

852 
	}
}

854 
√gŸüã_ªsu…_t


855 
	$ªcv_p‹t
(
s
, 
ªque°
, 
°©e
)

856 
s
;

857 
ªque°_t
 *
ªque°
;

858 
√gŸüã_°©e_t
 *
°©e
;

861 
	`INIT
((
ªque°
->
ho°
.
p‹t
));

862 
	`CHECK
(&
ªque°
->
ho°
.
p‹t
,Ñeque°->
auth
, 
NULL
);

864 
ªque°
->
vîsi⁄
) {

865 
PROXY_SOCKS_V4
:

866 
°©e
->
rcuºít
 = 
ªcv_addªss
;

867  
°©e
->
	`rcuºít
(
s
, 
ªque°
, state);

869 
PROXY_SOCKS_V5
:

870  
NEGOTIATE_FINISHED
;

873 
	`SERRX
(
ªque°
->
vîsi⁄
);

876 
	`SERRX
(0);

877 
	}
}

879 
√gŸüã_ªsu…_t


880 
	$ªcv_u£∫ame
(
s
, 
ªque°
, 
°©e
)

881 
s
;

882 
ªque°_t
 *
ªque°
;

883 
√gŸüã_°©e_t
 *
°©e
;

885 c⁄° *
fun˘i⁄
 = "recv_username()";

886 *
u£∫ame
 = (*)&
°©e
->
mem
[(
ªque°
->
vîsi⁄
)

887 + (
ªque°
->
comm™d
)

888 + (
ªque°
->
ho°
.
p‹t
)

889 + (
ªque°
->
ho°
.
addr
.
ùv4
)];

892 
	`INIT
(
	`MIN
(1, 
	`MEMLEFT
()));

894 i‡(
	`MEMLEFT
() == 0) {

895 
vis°rög
[
MAXNAMELEN
 * 4 + 1];

904 
°©e
->
mem
[°©e->
ªqªad
 - 1] = 
NUL
;

906 
	`¢¥ötf
(
°©e
->
emsg
, (state->emsg),

910 
	`¥oxy¥Ÿocﬁ2°rög
(
ªque°
->
vîsi⁄
),

911 ()(
MAXNAMELEN
 - 1),

912 ()
	`°æí
(
u£∫ame
),

913 
	`°r2vis
(
u£∫ame
,

914 
	`°æí
(
u£∫ame
),

915 
vis°rög
,

916 (
vis°rög
)));

918 
	`¶og
(
LOG_NOTICE
, "%s: strange data from client %s: %s",

919 
fun˘i⁄
, 
	`socksho°2°rög
(&
°©e
->
§c
, 
NULL
, 0), sèã->
emsg
);

921  
NEGOTIATE_ERROR
;

924 
	`CHECK
(&
°©e
->
mem
[
°¨t
], 
ªque°
->
auth
, 
NULL
);

933 
°©e
->
rcuºít
 = 
ªcv_u£∫ame
;

934 } 
°©e
->
mem
[°©e->
ªqªad
 - 1] != 0);

935 
°©e
->
mem
[°©e->
ªqªad
 - 1] = 
NUL
;

937 
	`¶og
(
LOG_DEBUG
, "%s: gŸ sock†v4 u£∫ame: \"%s\"", 
fun˘i⁄
, 
u£∫ame
);

939 
°©e
->
rcuºít
 = 
NULL
;

940  
NEGOTIATE_FINISHED
;

941 
	}
}

	@sockd/sockd_request.c

45 
	~"comm⁄.h
"

46 
	~"c⁄fig_∑r£.h
"

48 c⁄° 
	grcsid
[] =

59 
	sªq
 {

60 
	mÆloˇãd
;

62 
ruÀ_t
 
	m¸uÀ
;

63 #i‡
HAVE_SOCKS_HOSTID


64 
ruÀ_t
 
	mhruÀ
;

65 
	mhruÀ_is£t
;

68 
sockaddr_°‹age
 
	m˛õ¡
;

69 
ªque°_t
 
	mªque°
;

70 
	mªque°_isvÆid
;

74 
	ms
;

75 
time_t
 
	m°¨âime
;

76 } 
	gªqv
[1];

77 c⁄° 
size_t
 
	gªqc
 = 
ELEMENTS
(
ªqv
);

79 
sigöfo
(
sig
, 
sigöfo_t
 *
si
, *
sc
);

81 
bödexã∫Æaddr
(
sockd_io_t
 *
io
, c⁄° 
ªque°_t
 *
ªq
,

82 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

92 
auth2°™d¨d
(c⁄° 
authmëhod_t
 *
auth
,áuthmëhod_à*
°dauth
);

99 
öô_ªq
(
ªq
 *ªq, c⁄° 
sockd_ªque°_t
 *
ªque°
);

100 
dñëe_ªq
(
ªq
 *req);

106 
öôlogaddrs
(c⁄° 
sockd_io_t
 *
io
, 
iﬁogaddr_t
 *
§c
, iﬁogaddr_à*
d°
,

107 
iﬁogaddr_t
 *
¥oxy
);

114 
c⁄vîåe•⁄£
(c⁄° 
ª•⁄£_t
 *
ﬁdªs
,Ñe•⁄£_à*
√wªs
,

115 c⁄° 
√wvîsi⁄
);

121 
io°©us_t


122 
d‹eque°
(c⁄° 
sockd_mŸhî_t
 *
mŸhî
, 
sockd_ªque°_t
 *
ªque°
,

123 
sockaddr_°‹age
 *
˛õ¡ud∑ddr
, *
we˛o£dfú°
,

124 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

148 
ªqho°isok
(
socksho°_t
 *
ho°
, c⁄° 
cmd
, *
emsg
,

149 c⁄° 
size_t
 
emsgÀn
);

162 
Êushio
(
mŸhî
, 
sockd_io_t
 *
io
);

171 
¥o˘ôÀupd©e
(c⁄° 
sockaddr_°‹age
 *
‰om
);

176 
rouã_t
 *

177 
gërouã
(c⁄° 
sockaddr_°‹age
 *
˛õ¡
, 
ªque°_t
 *
ªq
,

178 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

189 
£rvîchaö
(c⁄° 
èrgësockë
, c⁄° 
˛õ¡sockë
,

190 c⁄° 
sockaddr_°‹age
 *
˛õ¡
, c⁄° 
ªque°_t
 *
ªq
,

191 
¥oxychaööfo_t
 *
¥oxychaö
, 
authmëhod_t
 *
¥oxychaöauth
,

192 *
emsg
, c⁄° 
size_t
 
emsgÀn
);

213 #i‡
SOCKS_SERVER


215 
sockd_io_t
 *

216 
io_add
(
sockd_io_t
 *
iﬁi°
, c⁄° sockd_io_à*
√wio
);

222 
sockd_io_t
 *

223 
io_ªmove
(
sockd_io_t
 *
iﬁi°
, sockd_io_à*
rmio
);

229 
sockd_io_t
 *

230 
io_föd
(
sockd_io_t
 *
iﬁi°
, c⁄° 
sockaddr_°‹age
 *
addr
);

242 
	$run_ªque°
()

244 c⁄° *
fun˘i⁄
 = "run_request()";

245 
sockd_ªque°_t
 
ªq
;

246 
siga˘i⁄
 
siga˘
;

247 
fd_£t
 *
r£t
;

249 
	`bzîo
(&
siga˘
, (sigact));

250 
siga˘
.
ß_Êags
 = 
SA_RESTART
 | 
SA_NOCLDSTOP
 | 
SA_SIGINFO
;

251 
siga˘
.
ß_siga˘i⁄
 = 
sigöfo
;

253 #i‡
HAVE_SIGNAL_SIGINFO


254 i‡(
	`siga˘i⁄
(
SIGINFO
, &
siga˘
, 
NULL
) != 0)

255 
	`£º
("%s: siga˘i⁄(SIGINFO)", 
fun˘i⁄
);

259 i‡(
	`siga˘i⁄
(
SIGUSR1
, &
siga˘
, 
NULL
) != 0)

260 
	`£º
("%s: siga˘i⁄(SIGINFO)", 
fun˘i⁄
);

262 
r£t
 = 
	`Æloˇã_maxsize_fd£t
();

263 
ªq
.
s
 = -1;

265 
	`sockd_¥öt_chûd_ªady_mesßge
((
size_t
)
	`‰ìdes¸ùt‹s
(
NULL
, NULL));

271 #i‡
DIAGNOSTIC


272 c⁄° 
‰ìc


273 
	`‰ìdes¸ùt‹s
(
sockscf
.
›ti⁄
.
debug
 ? "°¨t" : 
NULL
, NULL);

275 
io°©us_t
 
io°©us
;

276 
sockaddr_°‹age
 
˛õ¡ud∑ddr
;

277 
comm™d
, 
emsg
[2048];

278 
fdbôs
, 
we˛o£dfú°
;

280 
î∫o
 = 0;

282 
	`¥o˘ôÀupd©e
(
NULL
);

284 
	`FD_ZERO
(
r£t
);

285 
fdbôs
 = -1;

287 i‡(
sockscf
.
°©e
.
mŸhî
.
s
 != -1) {

288 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
s
, 
r£t
);

289 
fdbôs
 = 
sockscf
.
°©e
.
mŸhî
.
s
;

293 
	`FD_SET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
r£t
);

294 
fdbôs
 = 
	`MAX
(fdbôs, 
sockscf
.
°©e
.
mŸhî
.
ack
);

296 ++
fdbôs
;

297 
	`£À˘n
(
fdbôs
, 
r£t
, 
NULL
, NULL, NULL, NULL, NULL)) {

299 i‡(
î∫o
 =
EINTR
)

302 
	`SERR
(-1);

306 
	`SERRX
(0);

309 i‡(
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
ack
, 
r£t
)) {

310 
	`sockd_ªadmŸhîsc⁄åﬁsockë
(
fun˘i⁄
, 
sockscf
.
°©e
.
mŸhî
.
ack
);

312 #i‡
HAVE_VALGRIND_VALGRIND_H


313 i‡(
RUNNING_ON_VALGRIND
) {

315 
	`‰ì
(
r£t
);

319 
	`sockdexô
(
EXIT_FAILURE
);

322 i‡(
	`FD_ISSET
(
sockscf
.
°©e
.
mŸhî
.
s
, 
r£t
)) {

323 i‡(
	`ªcv_ªq
(
sockscf
.
°©e
.
mŸhî
.
s
, &
ªq
) == -1) {

324 
	`¶og
(
LOG_INFO
, "%s:Ñecv_req() from mother failed: %s",

325 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

327 
	`˛o£
(
sockscf
.
°©e
.
mŸhî
.
s
);

328 
sockscf
.
°©e
.
mŸhî
.
s
 = -1;

334 
io°©us
 = 
	`d‹eque°
(&
sockscf
.
°©e
.
mŸhî
,

335 &
ªq
,

336 &
˛õ¡ud∑ddr
,

337 &
we˛o£dfú°
,

338 
emsg
,

339 (
emsg
));

341 i‡(
io°©us
 !
IO_NOERROR
) {

347 
›î©i⁄_t
 
›
;

348 
˛õ¡öfo_t
 
cöfo
;

349 
iﬁogaddr_t
 
§c
;

350 
ruÀ_t
 *
ruÀ
;

351 
size_t
 
ru£d
;

352 
ªas⁄
[(
emsg
) + 1024];

354 
	`¶og
(
LOG_DEBUG
,

357 
fun˘i⁄
, 
ªq
.
§uÀ_is£t
, 
we˛o£dfú°
, 
io°©us
, 
emsg
);

359 
	`log_ruÀöfo_shmid
(
	`CRULE_OR_HRULE
(&
ªq
), 
fun˘i⁄
, 
NULL
);

361 i‡(
ªq
.
§uÀ_is£t
)

362 
ruÀ
 = &
ªq
.
§uÀ
;

364 
ruÀ
 = 
	`CRULE_OR_HRULE
(&
ªq
);

366 
	`log_ruÀöfo_shmid
(
ruÀ
, 
fun˘i⁄
, 
NULL
);

368 i‡(
ªq
.
s
 == -1) {

369 
	`SASSERTX
(
BAREFOOTD
);

370 
	`SASSERTX
(
ªq
.
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
);

376 
	`SHMEM_CLEAR
(
	`CRULE_OR_HRULE
(&
ªq
), 
SHMEM_ALL
, 1);

378 
	`SASSERTX
(!
ªq
.
§uÀ_is£t
);

387 
cöfo
.
‰om
 = 
ªq
.from;

388 
	`HOSTIDCOPY
(&
ªq
.
°©e
, &
cöfo
);

390 
io°©us
) {

391 
IO_BLOCK
:

392 
ru£d
 = 0;

393 
›
 = 
OPERATION_BLOCK
;

396 
IO_CLOSE
:

397 
›
 = 
OPERATION_DISCONNECT
;

398 
ru£d
 = 0;

401 
IO_IOERROR
:

402 
IO_ERROR
:

403 
ru£d
 = 
	`¢¥ötf
(
ªas⁄
, (reason),

405 
›
 = 
OPERATION_ERROR
;

409 
	`SWARNX
(
io°©us
);

411 
ru£d
 = 0;

412 
›
 = 
OPERATION_ERROR
;

415 i‡(*
emsg
 !
NUL
)

416 
	`¢¥ötf
(&
ªas⁄
[
ru£d
], (reason) -Ñused,

418 
ru£d
 > 0 ? ": " : "",

419 
emsg
);

421 i‡(
ruÀ
->
m°©s_shmid
 != 0

422 && (
ruÀ
->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

423 
	`Æ¨m_add_disc⁄√˘
(
we˛o£dfú°
,

424 
ruÀ
,

425 
ALARM_INTERNAL
,

426 &
cöfo
,

427 
	`°ªº‹
(
î∫o
),

428 
sockscf
.
shmemfd
);

430 
	`SHMEM_UNUSE
(
ruÀ
, &
cöfo
, 
sockscf
.
shmemfd
, 
SHMEM_ALL
);

432 
ªq
.
°©e
.
¥Ÿocﬁ
) {

433 
SOCKS_TCP
:

434 
comm™d
 = 
SOCKD_FREESLOT_TCP
;

437 
SOCKS_UDP
:

438 
comm™d
 = 
SOCKD_FREESLOT_UDP
;

442 
	`SERRX
(
ªq
.
°©e
.
¥Ÿocﬁ
);

445 i‡(
	`socks_£ndt⁄
(
sockscf
.
°©e
.
mŸhî
.
ack
,

446 &
comm™d
,

447 (
comm™d
),

448 (
comm™d
),

450 
NULL
,

452 
NULL
,

453 
NULL
Ë!(
comm™d
))

454 
	`¶og
(
	`sockd_mŸhîexi°s
(Ë? 
LOG_WARNING
 : 
LOG_DEBUG
,

456 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

463 
	`öô_iﬁogaddr
(&
§c
,

464 
obje˘_sockaddr
,

465 &
ªq
.
to
,

466 
obje˘_sockaddr
,

467 &
ªq
.
‰om
,

468 &
ªq
.
ˇuth
,

469 
	`GET_HOSTIDV
(&
ªq
.
°©e
),

470 
	`GET_HOSTIDC
(&
ªq
.
°©e
));

472 #i‡
HAVE_SOCKS_HOSTID


473 i‡(
ªq
.
hruÀ_is£t
) {

474 
ªq
.
°©e
.
comm™d
 = 
SOCKS_HOSTID
;

475 
	`iﬁog
(&
ªq
.
hruÀ
,

476 &
ªq
.
°©e
,

477 
›
,

478 &
§c
,

479 
NULL
,

480 
NULL
,

481 
NULL
,

482 
ªas⁄
,

483 
	`°æí
(
ªas⁄
));

487 
ªq
.
°©e
.
comm™d
 = 
SOCKS_ACCEPT
;

488 
ªq
.
°©e
.
¥Ÿocﬁ
 = 
SOCKS_TCP
;

490 #i‡!
HAVE_SOCKS_RULES


491 i‡(
sockscf
.
›ti⁄
.
debug
)

493 
	`iﬁog
(&
ªq
.
¸uÀ
,

494 &
ªq
.
°©e
,

495 
›
,

496 &
§c
,

497 
NULL
,

498 
NULL
,

499 
NULL
,

500 
ªas⁄
,

501 
	`°æí
(
ªas⁄
));

504 
	`dñëe_ªq
(&
ªqv
[0]);

506 #i‡
DIAGNOSTIC


507 i‡(
‰ìc
 !
	`‰ìdes¸ùt‹s
(
sockscf
.
›ti⁄
.
debug
 ? "íd" : 
NULL
, NULL))

508 
	`sw¨nx
("%s:Üost %d file descriptor%s inÅotal while handlingÑequest",

509 
fun˘i⁄
,

510 
‰ìc
 - 
	`‰ìdes¸ùt‹s
(
NULL
, NULL),

511 
‰ìc
 - 
	`‰ìdes¸ùt‹s
(
NULL
, NULL) == 1 ? "" : "s");

514 
	}
}

517 
	$ªque°_¥ec⁄figlﬂd
()

519 c⁄° *
fun˘i⁄
 = "request_preconfigload()";

521 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

522 
	}
}

525 
	$ªque°_po°c⁄figlﬂd
()

527 c⁄° *
fun˘i⁄
 = "request_postconfigload()";

529 
	`¶og
(
LOG_DEBUG
, "%s", 
fun˘i⁄
);

530 
	}
}

534 
	$ªcv_ªq
(
s
, 
ªq
)

535 
s
;

536 
sockd_ªque°_t
 *
ªq
;

538 c⁄° *
fun˘i⁄
 = "recv_req()";

539 #i‡
HAVE_GSSAPI


540 
gsßpi°©emem
[
MAX_GSS_STATE
];

542 
iovec
 
iov
[2];

543 
msghdr
 
msg
;

544 
timevÆ
 
äow
;

545 
ssize_t
 
r
;

546 
ioc
, 
fdex≥˘
, 
fdª˚ived
;

547 
	`CMSG_AALLOC
(
cmsg
, ());

549 #i‡
BAREFOOTD


550 i‡(!
	`ALL_UDP_BOUNCED
()) {

557 
ruÀ_t
 *
ruÀ
;

558 
s°r
[
MAXRULEADDRSTRING
], 
t°r
[MAXRULEADDRSTRING],

559 
d°r
[
MAXRULEADDRSTRING
], 
emsg
[1024];

560 
foundruÀtoboun˚
 = 0;

562 
	`SASSERTX
(
	`pidismaömŸhî
(
sockscf
.
°©e
.
pid
));

564 
	`bzîo
(
ªq
, (*req));

566 
ruÀ
 = 
sockscf
.
¸uÀ
;ÑuÀ !
NULL
;ÑuÀ =ÑuÀ->
√xt
) {

567 
sockaddr_°‹age
 
addr
;

568 
gaõº
;

570 i‡(!
ruÀ
->
°©e
.
¥Ÿocﬁ
.
udp
 ||ÑuÀ->
boun˚d
)

573 
	`socksho°2sockaddr2
(
	`ruÀaddr2socksho°
(&
ruÀ
->
d°
, 
NULL
, 
SOCKS_UDP
),

574 &
ªq
->
to
,

575 &
gaõº
,

576 
emsg
,

577 (
emsg
));

579 i‡(
gaõº
 !0 || !
	`IPADDRISBOUND
(&
ªq
->
to
)) {

580 i‡(
gaõº
 != 0)

581 
	`log_ªsﬁveÁûed
(
ruÀ
->
d°
.
addr
.
domaö
, 
INTERNALIF
, 
gaõº
);

587 
	`£º
("%s: couldÇot convert \"%s\" in destination-portion "

589 
fun˘i⁄
,

590 
	`ruÀaddr2°rög
(&
ruÀ
->
d°
, 
ADDRINFO_ATYPE
, 
NULL
, 0),

591 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

592 ()
ruÀ
->
numbî
,

593 
emsg
);

596 i‡(
ruÀ
->
vîdi˘
 =
VERDICT_PASS
) {

597 
	`ruÀaddr2sockaddr2
(&
ruÀ
->
exåa
.
boun˚to
,

598 &
addr
,

599 
SOCKS_UDP
,

600 &
gaõº
,

601 
emsg
,

602 (
emsg
));

604 i‡(
gaõº
 !0 || !
	`IPADDRISBOUND
(&
addr
)) {

605 i‡(
gaõº
 != 0)

606 
	`log_ªsﬁveÁûed
(
ruÀ
->
exåa
.
boun˚to
.
addr
.
domaö
,

607 
EXTERNALIF
,

608 
gaõº
);

610 
	`sw¨n
("%s: couldÇot convert hostname \"%s\" in bounce-to "

612 
fun˘i⁄
,

613 
	`ruÀaddr2°rög
(&
ruÀ
->
exåa
.
boun˚to
,

614 
ADDRINFO_ATYPE
,

615 
NULL
,

617 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

618 ()
ruÀ
->
numbî
,

619 
emsg
);

632 
	`socksho°2sockaddr2
(
	`ruÀaddr2socksho°
(&
ruÀ
->
§c
, 
NULL
, 
SOCKS_UDP
),

633 &
ªq
->
‰om
,

634 &
gaõº
,

635 
emsg
,

636 (
emsg
));

638 i‡((
ruÀ
->
§c
.
©y≥
 =
SOCKS_ADDR_DOMAIN


639 || 
ruÀ
->
§c
.
©y≥
 =
SOCKS_ADDR_IFNAME
)

640 && !
	`IPADDRISBOUND
(&
ªq
->
‰om
)) {

641 i‡(
ruÀ
->
§c
.
©y≥
 =
SOCKS_ADDR_DOMAIN


642 && *
ruÀ
->
§c
.
addr
.
domaö
 == '.') {

648 
	`bzîo
(&
ªq
->
‰om
, (req->from));

649 
	`SET_SOCKADDR
(&
ªq
->
‰om
, 
AF_INET
);

652 i‡(
ruÀ
->
§c
.
©y≥
 =
SOCKS_ADDR_DOMAIN
 && 
gaõº
 != 0)

653 
	`log_ªsﬁveÁûed
(
ruÀ
->
§c
.
addr
.
domaö
, 
INTERNALIF
, 
gaõº
);

655 
	`sw¨n
("%s: couldÇot convert \"%s\" in source-portion of "

657 
fun˘i⁄
,

658 
	`ruÀaddr2°rög
(&
ruÀ
->
§c
, 
ADDRINFO_ATYPE
, 
NULL
, 0),

659 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

660 ()
ruÀ
->
numbî
,

661 
emsg
);

666 
	`¶og
(
LOG_DEBUG
,

669 
fun˘i⁄
,

670 
	`ruÀaddr2°rög
(&
ruÀ
->
§c
, 
ADDRINFO_PORT
, 
s°r
, (sstr)),

671 
	`ruÀaddr2°rög
(&
ruÀ
->
exåa
.
boun˚to
,

672 
ADDRINFO_PORT
,

673 
t°r
,

674 (
t°r
)),

675 
	`ruÀaddr2°rög
(&
ruÀ
->
d°
, 
ADDRINFO_PORT
, 
d°r
, (dstr)),

676 
	`obje˘ty≥2°rög
(
ruÀ
->
ty≥
),

677 ()
ruÀ
->
numbî
);

679 
ªq
->
¸uÀ
 = *
ruÀ
;

681 
ªq
->
ˇuth
.
mëhod
 = 
AUTHMETHOD_NONE
;

682 
ªq
->
ßuth
.
mëhod
 = 
AUTHMETHOD_NONE
;

683 
ªq
->
s
 = -1;

685 
ªq
->
°©e
.
comm™d
 = 
SOCKS_ACCEPT
;

686 
ªq
->
°©e
.
¥Ÿocﬁ
 = 
SOCKS_UDP
;

688 
ªq
->ªq.
vîsi⁄
 = 
PROXY_SOCKS_V5
;

689 
ªq
->ªq.
comm™d
 = 
SOCKS_UDPASSOCIATE
;

690 
ªq
->ªq.
Êag
 = 0;

696 
ªq
->ªq.
ho°
.
©y≥
 = 
ruÀ
->
d°
.atype;

698 
ªq
->ªq.
ho°
.
©y≥
) {

699 
SOCKS_ADDR_IPV4
:

700 
ªq
->ªq.
ho°
.
addr
.
ùv4
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

703 
SOCKS_ADDR_IPV6
:

704 
ªq
->ªq.
ho°
.
addr
.
ùv6
.
ù
 = 
ö6addr_™y
;

705 
ªq
->ªq.
ho°
.
addr
.
ùv6
.
sc›eid
 = 
ruÀ
->
d°
.addr.ipv6.scopeid;

709 
	`SERRX
(
ªq
->ªq.
ho°
.
©y≥
);

712 
ªq
->ªq.
ho°
.
p‹t
 = 
	`ht⁄s
(0);

714 
ªq
->ªq.
auth
 = &ªq->
ßuth
;

715 
ªq
->ªq.
¥Ÿocﬁ
 = 
SOCKS_UDP
;

720 
ªq
->
°©e
.
comm™d
 =Ñeq->req.command;

721 
ªq
->
°©e
.
¥oxy¥Ÿocﬁ
 =Ñeq->ªq.
vîsi⁄
;

723 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
ªq
->
°©e
.
time
.
ac˚±ed
);

724 
ªq
->
°©e
.
time
.
√gŸüã°¨t
 =Ñeq->°©e.time.
ac˚±ed
;

725 
ªq
->
°©e
.
time
.
√gŸüãíd
 =Ñeq->°©e.time.
ac˚±ed
;

726 
ªq
->
°©e
.
time
.
e°ablished
 =Ñeq->°©e.time.
ac˚±ed
;

728 
ruÀ
->
boun˚d
 = 1;

729 
foundruÀtoboun˚
 = 1;

733 i‡(
foundruÀtoboun˚
) {

734 
	`SASSERTX
(
ªq
->
s
 == -1);

738 
	`¶og
(
LOG_DEBUG
, "%s:Çÿm‹êaddªs£†tÿboun˚", 
fun˘i⁄
);

739 
sockscf
.
°©e
.
Æludpboun˚d
 = 1;

741 
î∫o
 = 
EAGAIN
;

747 
ioc
 = 0;

748 
	`bzîo
(
iov
, (iov));

749 
iov
[
ioc
].
iov_ba£
 = 
ªq
;

750 
iov
[
ioc
].
iov_Àn
 = (*
ªq
);

751 ++
ioc
;

753 #i‡
HAVE_GSSAPI


754 
iov
[
ioc
].
iov_ba£
 = 
gsßpi°©emem
;

755 
iov
[
ioc
].
iov_Àn
 = (
gsßpi°©emem
);

756 ++
ioc
;

759 
	`bzîo
(&
msg
, (msg));

760 
msg
.
msg_iov
 = 
iov
;

761 
msg
.
msg_iovÀn
 = 
ioc
;

762 
msg
.
msg_«me
 = 
NULL
;

763 
msg
.
msg_«mñí
 = 0;

766 
	`CMSG_SETHDR_RECV
(
msg
, 
cmsg
, 
	`CMSG_MEMSIZE
(cmsg));

768 i‡((
r
 = 
	`ªcvmsgn
(
s
, &
msg
, 0)Ë< (
ssize_t
)(*
ªq
)) {

769 
r
) {

771 
	`¶og
(
LOG_DEBUG
, "%s:Ñecvmsg() failed: %s",

772 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

776 
	`¶og
(
LOG_DEBUG
, "%s:Ñecvmsg(): other side closed connection",

777 
fun˘i⁄
);

781 
	`sw¨nx
("%s:Ñecvmsg(): unexpected shortÑead: %ld/%lu",

782 
fun˘i⁄
, ()
r
, ()(*
ªq
));

788 i‡(
	`socks_msgha£º‹s
(
fun˘i⁄
, &
msg
))

791 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
äow
);

792 
	`sockd_check_ù˛©ícy
("client objectÑeceived fromÇegotiateÖrocess",

793 &
ªq
->
°©e
.
time
.
√gŸüãíd
,

794 &
äow
,

795 &
äow
);

797 
	`SASSERTX
(
ªq
->
§uÀ
.
bw
 =
NULL
);

798 
	`SASSERTX
(
ªq
->
§uÀ
.
ss
 =
NULL
);

800 #i‡
BAREFOOTD


801 i‡(
ªq
->ªq.
comm™d
 =
SOCKS_UDPASSOCIATE
)

802 
fdex≥˘
 = 0;

804 
fdex≥˘
 = 1;

807 
fdex≥˘
 = 1;

810 i‡(!
	`CMSG_RCPTLEN_ISOK
(
msg
, (Ë* 
fdex≥˘
)) {

811 
	`sw¨nx
("%s:Ñeceived control message hasÅhe invalidÜen of %d",

812 
fun˘i⁄
, ()
	`CMSG_TOTLEN
(
msg
));

817 
fdª˚ived
 = 0;

818 i‡(
fdex≥˘
 > 0) {

819 
	`SASSERTX
(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET
);

820 
	`SASSERTX
(
cmsg
->
cmsg_ty≥
 =
SCM_RIGHTS
);

822 
	`CMSG_GETOBJECT
(
ªq
->
s
, 
cmsg
, ‘eq->sË* 
fdª˚ived
++);

824 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

825 
	`¶og
(
LOG_DEBUG
, "%s:Ñeceived fd %d (%s) ...",

826 
fun˘i⁄
, 
ªq
->
s
, 
	`sockë2°rög
‘eq->s, 
NULL
, 0));

829 
ªq
->ªq.
auth
 = &ªq->
ßuth
;

831 #i‡
HAVE_GSSAPI


832 i‡(
ªq
->ªq.
auth
->
mëhod
 =
AUTHMETHOD_GSSAPI
) {

833 
gss_buf„r_desc
 
gsßpi°©e
;

835 
r
 -(*
ªq
);

836 
	`SASSERTX
(
r
 > 0);

838 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

839 
	`¶og
(
LOG_DEBUG
, "%s:Ñód gsßpi°©êo‡sizê%ld", 
fun˘i⁄
, ()
r
);

841 
gsßpi°©e
.
vÆue
 = 
gsßpi°©emem
;

842 
gsßpi°©e
.
Àngth
 = 
r
;

844 i‡(
	`gsßpi_imp‹t_°©e
(&
ªq
->ªq.
auth
->
md©a
.
gsßpi
.
°©e
.
id
,

845 &
gsßpi°©e
) != 0)

850 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

851 
	`¶og
(
LOG_DEBUG
,

853 
fun˘i⁄
, 
fdª˚ived
, 
ªq
->ªq.
auth
->
mëhod
, 
s
);

856 
	}
}

858 
io°©us_t


859 
	$d‹eque°
(
mŸhî
, 
ªque°
, 
˛õ¡ud∑ddr
, 
we˛o£dfú°
, 
emsg
, 
emsgÀn
)

860 c⁄° 
sockd_mŸhî_t
 *
mŸhî
;

861 
sockd_ªque°_t
 *
ªque°
;

862 
sockaddr_°‹age
 *
˛õ¡ud∑ddr
;

863 *
we˛o£dfú°
;

864 *
emsg
;

865 c⁄° 
size_t
 
emsgÀn
;

867 c⁄° *
fun˘i⁄
 = "dorequest()";

868 
io°©us_t
 
io°©us
;

869 
sockd_io_t
 
io
;

870 
ª•⁄£_t
 
ª•⁄£
;

871 
iﬁogaddr_t
 *
§c
, 
§cmem
, *
d°
, 
d°mem
;

872 
˛õ¡öfo_t
 
cöfo
;

873 
size_t
 
msgÀn
;

874 
°rho°
[
MAXSOCKSHOSTSTRING
], 
buf
[(
MAXHOSTNAMELEN
 * 4) + 256];

875 
rc
;

876 #i‡
SOCKS_SERVER


877 
socksho°_t
 
ex≥˘edbödª∂y
, 
bödª∂yd°
;

880 #i‡
HAVE_SOCKS_RULES


881 
≥rmô
;

884 *
emsg
 = 
NUL
;

892 *
we˛o£dfú°
 = 1;

894 
	`¶og
(
LOG_DEBUG
,

897 
fun˘i⁄
,

898 
ªque°
->
°©e
.
comm™d
,

899 
	`sockaddr2°rög
(&
ªque°
->
‰om
, 
°rho°
, (strhost)),

900 
	`sockaddr2°rög
(&
ªque°
->
to
, 
NULL
, 0),

901 
	`obje˘ty≥2°rög
(
ªque°
->
¸uÀ
.
ty≥
),

902 ()
ªque°
->
¸uÀ
.
numbî
,

903 
	`mëhod2°rög
(
ªque°
->
ªq
.
auth
->
mëhod
),

904 
	`socks_∑ckë2°rög
(&
ªque°
->
ªq
, 1));

906 
	`¥o˘ôÀupd©e
(&
ªque°
->
‰om
);

907 
	`öô_ªq
(&
ªqv
[0], 
ªque°
);

909 
	`bzîo
(&
ª•⁄£
, (response));

910 
ª•⁄£
.
ho°
 = 
ªque°
->
ªq
.host;

911 
ª•⁄£
.
auth
 = 
ªque°
->
ªq
.auth;

913 
	`bzîo
(&
io
, (io));

915 
io
.
c⁄åﬁ
.
auth
.
mëhod
 = 
AUTHMETHOD_NOTSET
;

916 
io
.
c⁄åﬁ
.
s
 = -1;

917 
io
.
§c
 = io.
c⁄åﬁ
;

919 
io
.
d°
.
s
 = -1;

921 
io
.
ªqÊags
 = 
ªque°
->
ªq
.
Êags
;

922 
io
.
°©e
 = 
ªque°
->state;

924 
	`SASSERTX
(
	`¥oxy¥Ÿocﬁisknown
(
io
.
°©e
.
¥oxy¥Ÿocﬁ
));

926 
io
.
¸uÀ
 = 
ªque°
->crule;

928 #i‡
HAVE_SOCKS_HOSTID


929 
io
.
hruÀ
 = 
ªque°
->hrule;

930 
io
.
hruÀ_is£t
 = 
ªque°
->hrule_isset;

933 
io
.
ˇuth
 = 
ªque°
->cauth;

935 #i‡
HAVE_NEGOTIATE_PHASE


936 
	`CTASSERT
((
io
.
˛õ¡d©a
Ë=(
ªque°
->clientdata));

937 
io
.
˛õ¡d©Æí
 = 
ªque°
->clientdatalen;

938 
	`mem˝y
(
io
.
˛õ¡d©a
, 
ªque°
->˛õ¡d©a, io.
˛õ¡d©Æí
);

941 
§c
 = &
§cmem
;

942 
	`öô_iﬁogaddr
(
§c
,

943 
obje˘_sockaddr
,

944 &
ªque°
->
to
,

945 
obje˘_sockaddr
,

946 &
ªque°
->
‰om
,

947 
ªque°
->
ªq
.
auth
,

948 
	`GET_HOSTIDV
(&
ªque°
->
°©e
),

949 
	`GET_HOSTIDC
(&
ªque°
->
°©e
));

951 
d°
 = 
NULL
;

958 
ªque°
->
ªq
.
vîsi⁄
) {

959 #i‡
SOCKS_SERVER
 || 
BAREFOOTD


960 
PROXY_SOCKS_V4
:

961 
ª•⁄£
.
vîsi⁄
 = 
PROXY_SOCKS_V4REPLY_VERSION
;

964 
ªque°
->
ªq
.
ho°
.
©y≥
) {

965 
SOCKS_ADDR_IPV4
:

969 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "unrecognized v%dátype: %d",

970 
ªque°
->
ªq
.
vîsi⁄
,Ñeque°->ªq.
ho°
.
©y≥
);

972 
	`iﬁog
(&
io
.
¸uÀ
,

973 &
io
.
°©e
,

974 
OPERATION_ERROR
,

975 
§c
,

976 
d°
,

977 
NULL
,

978 
NULL
,

979 
emsg
,

980 
msgÀn
);

982 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
SOCKS_ADDR_UNSUPP
);

984 
	`˛o£
(
ªque°
->
s
);

985  
IO_ERROR
;

989 
ªque°
->
ªq
.
comm™d
) {

990 
SOCKS_BIND
:

991 
SOCKS_CONNECT
:

992 
io
.
°©e
.
¥Ÿocﬁ
 = 
SOCKS_TCP
;

993 
io
.
§c
.
°©e
.
isc⁄√˘ed
 = 1;

997 
io
.
°©e
.
comm™d
 = 
SOCKS_UNKNOWN
;

999 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1001 
ªque°
->
ªq
.
vîsi⁄
,Ñeque°->ªq.
comm™d
);

1003 
	`iﬁog
(&
io
.
¸uÀ
,

1004 &
io
.
°©e
,

1005 
OPERATION_ERROR
,

1006 
§c
,

1007 
d°
,

1008 
NULL
,

1009 
NULL
,

1010 
emsg
,

1011 
msgÀn
);

1013 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
SOCKS_CMD_UNSUPP
);

1015 
	`˛o£
(
ªque°
->
s
);

1016  
IO_ERROR
;

1020 
PROXY_SOCKS_V5
:

1021 
ª•⁄£
.
vîsi⁄
 = 
ªque°
->
ªq
.version;

1024 
ªque°
->
ªq
.
ho°
.
©y≥
) {

1025 
SOCKS_ADDR_IPV4
:

1026 
SOCKS_ADDR_IPV6
:

1027 
SOCKS_ADDR_DOMAIN
:

1031 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1033 
ªque°
->
ªq
.
vîsi⁄
,Ñeque°->ªq.
ho°
.
©y≥
);

1035 
	`iﬁog
(&
io
.
¸uÀ
,

1036 &
io
.
°©e
,

1037 
OPERATION_ERROR
,

1038 
§c
,

1039 
d°
,

1040 
NULL
,

1041 
NULL
,

1042 
emsg
,

1043 
msgÀn
);

1045 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
SOCKS_ADDR_UNSUPP
);

1047 
	`˛o£
(
ªque°
->
s
);

1048  
IO_ERROR
;

1052 
ªque°
->
ªq
.
comm™d
) {

1053 
SOCKS_BIND
:

1054 
SOCKS_CONNECT
:

1055 
io
.
°©e
.
¥Ÿocﬁ
 = 
SOCKS_TCP
;

1058 
SOCKS_UDPASSOCIATE
:

1059 
io
.
°©e
.
¥Ÿocﬁ
 = 
SOCKS_UDP
;

1063 
io
.
°©e
.
comm™d
 = 
SOCKS_UNKNOWN
;

1065 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1067 
ªque°
->
ªq
.
vîsi⁄
,Ñeque°->ªq.
comm™d
);

1069 
	`iﬁog
(&
io
.
¸uÀ
,

1070 &
io
.
°©e
,

1071 
OPERATION_ERROR
,

1072 
§c
,

1073 
d°
,

1074 
NULL
,

1075 
NULL
,

1076 
emsg
,

1077 
msgÀn
);

1079 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
SOCKS_CMD_UNSUPP
);

1081 
	`˛o£
(
ªque°
->
s
);

1082  
IO_ERROR
;

1088 #i‡
COVENANT


1089 
PROXY_HTTP_10
:

1090 
PROXY_HTTP_11
:

1091 
	`SASSERTX
(
ªque°
->
ªq
.
comm™d
 =
SOCKS_CONNECT
);

1092 
	`SASSERTX
 (
ªque°
->
ªq
.
ho°
.
©y≥
 =
SOCKS_ADDR_IPV4


1093 || 
ªque°
->
ªq
.
ho°
.
©y≥
 =
SOCKS_ADDR_IPV6


1094 || 
ªque°
->
ªq
.
ho°
.
©y≥
 =
SOCKS_ADDR_DOMAIN
);

1096 
ª•⁄£
.
vîsi⁄
 = 
ªque°
->
ªq
.version;

1097 
io
.
°©e
.
¥Ÿocﬁ
 = 
SOCKS_TCP
;

1102 
	`SERRX
(
ªque°
->
ªq
.
vîsi⁄
);

1105 
rc
 = 
	`ªqho°isok
(&
ªque°
->
ªq
.
ho°
,Ñeque°->ªq.
comm™d
, 
emsg
, 
emsgÀn
);

1107 i‡(
rc
 !
SOCKS_SUCCESS
) {

1108 
	`iﬁog
(&
io
.
¸uÀ
,

1109 &
io
.
°©e
,

1110 
OPERATION_ERROR
,

1111 
§c
,

1112 
d°
,

1113 
NULL
,

1114 
NULL
,

1115 
emsg
,

1116 
	`°æí
(
emsg
));

1118 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
rc
);

1120 
	`˛o£
(
ªque°
->
s
);

1121  
IO_ERROR
;

1127 
ªqv
[0].
ªque°_isvÆid
 = 1;

1129 
ªque°
->
ªq
.
comm™d
) {

1130 #i‡
SOCKS_SERVER


1131 
SOCKS_BIND
:

1139 
io
.
§c
.
s
 = 
ªque°
->s;

1140 
io
.
§c
.
°©e
.
isc⁄√˘ed
 = 1;

1141 
io
.
§c
.
œddr
 = 
ªque°
->
to
;

1142 
io
.
§c
.
øddr
 = 
ªque°
->
‰om
;

1143 
io
.
§c
.
auth
 = *
ªque°
->
ªq
.auth;

1144 
	`sockaddr2socksho°
(&
io
.
§c
.
øddr
, &io.§c.
ho°
);

1146 
io
.
d°
.
ho°
 = 
ªque°
->
ªq
.host;

1148 i‡(
io
.
d°
.
ho°
.
©y≥
 =
SOCKS_ADDR_IPV4


1149 && 
io
.
d°
.
ho°
.
addr
.
ùv4
.
s_addr
 =
	`ht⁄l
(
BINDEXTENSION_IPADDR
)) {

1150 
	`¶og
(
LOG_DEBUG
, "%s: bindÉxtensionÉnabled forÑequest from %s",

1151 
fun˘i⁄
, 
	`sockaddr2°rög
(&
ªque°
->
‰om
, 
NULL
, 0));

1153 
io
.
°©e
.
exãnsi⁄
.
böd
 = 1;

1156 
io
.
°©e
.
exãnsi⁄
.
böd
 = 0;

1163 
ªque°
->
ªq
.
vîsi⁄
) {

1164 
PROXY_SOCKS_V5
:

1174 
PROXY_SOCKS_V4
:

1180 
	`SASSERTX
(
ªque°
->
ªq
.
ho°
.
©y≥
 =
SOCKS_ADDR_IPV4
);

1182 i‡(
ªque°
->
ªq
.
ho°
.
addr
.
ùv4
.
s_addr
 !
	`ht⁄l
(0))

1183 
ªque°
->
ªq
.
ho°
.
p‹t
 = 
	`GET_SOCKADDRPORT
(&ªque°->
to
);

1188 
	`SERRX
(
ªque°
->
ªq
.
vîsi⁄
);

1194 
SOCKS_CONNECT
:

1195 
io
.
§c
.
s
 = 
ªque°
->s;

1196 
io
.
§c
.
°©e
.
isc⁄√˘ed
 = 1;

1197 
io
.
§c
.
œddr
 = 
ªque°
->
to
;

1198 
io
.
§c
.
øddr
 = 
ªque°
->
‰om
;

1199 
io
.
§c
.
auth
 = *
ªque°
->
ªq
.auth;

1200 
	`sockaddr2socksho°
(&
io
.
§c
.
øddr
, &io.§c.
ho°
);

1202 
io
.
d°
.
ho°
 = 
ªque°
->
ªq
.host;

1205 
SOCKS_UDPASSOCIATE
:

1211 #i‡
HAVE_CONTROL_CONNECTION


1212 
io
.
c⁄åﬁ
.
s
 = 
ªque°
->s;

1213 
io
.
c⁄åﬁ
.
°©e
.
isc⁄√˘ed
 = 1;

1214 
io
.
c⁄åﬁ
.
°©e
.
isc⁄√˘ed
 = 1;

1215 
io
.
c⁄åﬁ
.
œddr
 = 
ªque°
->
to
;

1216 
io
.
c⁄åﬁ
.
øddr
 = 
ªque°
->
‰om
;

1217 
io
.
c⁄åﬁ
.
auth
 = *
ªque°
->
ªq
.auth;

1220 
io
.
§c
.
auth
 = *
ªque°
->
ªq
.auth;

1222 
	`sockaddr2socksho°
(&
io
.
c⁄åﬁ
.
øddr
, &io.c⁄åﬁ.
ho°
);

1225 
io
.
§c
.
ho°
 = 
ªque°
->
ªq
.host;

1226 
	`socksho°2sockaddr
(&
io
.
§c
.
ho°
, &io.§c.
øddr
);

1228 
	`bzîo
(&
io
.
§c
.
œddr
, (io.src.laddr));

1229 
	`SET_SOCKADDR
(&
io
.
§c
.
œddr
, io.§c.
øddr
.
ss_Ámûy
);

1232 *
˛õ¡ud∑ddr
 = 
io
.
§c
.
øddr
;

1243 
	`SERRX
(
ªque°
->
ªq
.
comm™d
);

1249 
	`öô_iﬁogaddr
(
§c
,

1250 
obje˘_sockaddr
,

1251 &
io
.
§c
.
œddr
,

1252 
obje˘_socksho°
,

1253 &
io
.
§c
.
ho°
,

1254 &
io
.
§c
.
auth
,

1255 
	`GET_HOSTIDV
(&
io
.
°©e
),

1256 
	`GET_HOSTIDC
(&
io
.
°©e
));

1258 i‡(
io
.
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
) {

1259 
d°
 = &
d°mem
;

1261 
	`öô_iﬁogaddr
(
d°
,

1262 
obje˘_n⁄e
,

1263 
NULL
,

1264 
obje˘_socksho°
,

1265 &
io
.
d°
.
ho°
,

1266 &
io
.
d°
.
auth
,

1267 
NULL
,

1270 
ªque°
->
ªq
.
comm™d
) {

1271 #i‡
SOCKS_SERVER


1272 
SOCKS_BIND
:

1296 i‡(
io
.
°©e
.
exãnsi⁄
.
böd
) {

1297 
	`sockaddr2socksho°
(&
ªque°
->
‰om
, &
io
.
d°
.
ho°
);

1298 
bödª∂yd°
 = 
io
.
d°
.
ho°
;

1300 
	`bzîo
(&
ex≥˘edbödª∂y
, (expectedbindreply));

1301 
ex≥˘edbödª∂y
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

1304 
bödª∂yd°
 = 
io
.
§c
.
ho°
;

1306 i‡(
io
.
d°
.
ho°
.
addr
.
ùv4
.
s_addr
 =
	`ht⁄l
(0)) {

1307 
	`bzîo
(&
ex≥˘edbödª∂y
, (expectedbindreply));

1308 
ex≥˘edbödª∂y
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

1311 
ex≥˘edbödª∂y
 = 
io
.
d°
.
ho°
;

1313 
ex≥˘edbödª∂y
.
p‹t
 = 
	`ht⁄s
(0);

1316 
	`¶og
(
LOG_DEBUG
, "%s:Éxpecting bindreply from %s",

1317 
fun˘i⁄
, 
	`socksho°2°rög
(&
ex≥˘edbödª∂y
, 
NULL
, 0));

1322 
SOCKS_CONNECT
:

1332 
rc
 = 1;

1333 i‡(
	`£tsock›t
(
io
.
d°
.
s
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
rc
, (rc))

1335 
	`sw¨n
("%s: sësock›t(SO_REUSEADDR)", 
fun˘i⁄
);

1340 
	`SERRX
(
ªque°
->
ªq
.
comm™d
);

1344 #i‡
HAVE_SOCKS_RULES


1348 
ªque°
->
ªq
.
comm™d
) {

1349 #i‡
SOCKS_SERVER


1350 
SOCKS_BIND
: {

1351 
socksho°_t
 
boundho°
;

1358 i‡(
	`bödexã∫Æaddr
(&
io
, &
ªque°
->
ªq
, 
buf
, (buf)) == 0)

1359 
	`SASSERTX
(
io
.
d°
.
s
 != -1);

1361 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1364 
buf
);

1366 
	`iﬁog
(&
io
.
¸uÀ
,

1367 &
io
.
°©e
,

1368 
OPERATION_ERROR
,

1369 
§c
,

1370 
d°
,

1371 
NULL
,

1372 
NULL
,

1373 
emsg
,

1374 
msgÀn
);

1376 
	`£nd_Áûuª
(
	`CONTROLIO
(&
io
)->
s
, &
ª•⁄£
, 
SOCKS_NETUNREACH
);

1378 
	`˛o£_iodes¸ùt‹s
(&
io
);

1379  
IO_ERROR
;

1382 
	`sockaddr2socksho°
(&
io
.
d°
.
œddr
, &
boundho°
);

1383 
≥rmô
 = 
	`ruÀ•îmô
(
ªque°
->
s
,

1384 &
ªque°
->
‰om
,

1385 &
ªque°
->
to
,

1386 &
io
.
ˇuth
,

1387 &
io
.
§c
.
auth
,

1388 &
io
.
§uÀ
,

1389 &
io
.
°©e
,

1390 &
io
.
§c
.
ho°
,

1391 &
boundho°
,

1392 
NULL
,

1393 
emsg
,

1394 
emsgÀn
);

1405 
SOCKS_CONNECT
: {

1406 
socksho°_t
 
d°ho°m©ched
;

1408 
≥rmô
 = 
	`ruÀ•îmô
(
ªque°
->
s
,

1409 &
ªque°
->
‰om
,

1410 &
ªque°
->
to
,

1411 &
io
.
ˇuth
,

1412 &
io
.
§c
.
auth
,

1413 &
io
.
§uÀ
,

1414 &
io
.
°©e
,

1415 &
io
.
§c
.
ho°
,

1416 &
io
.
d°
.
ho°
,

1417 &
d°ho°m©ched
,

1418 
emsg
,

1419 
emsgÀn
);

1421 i‡(
≥rmô
) {

1422 i‡(!
	`socksho°¨ìq
(&
io
.
d°
.
ho°
, &
d°ho°m©ched
)) {

1426 
	`¶og
(
LOG_DEBUG
,

1428 
fun˘i⁄
,

1429 
	`socksho°2°rög
(&
io
.
d°
.
ho°
, 
°rho°
, (strhost)),

1430 
	`socksho°2°rög
(&
d°ho°m©ched
, 
NULL
, 0));

1432 
ªque°
->
ªq
.
ho°
 = 
io
.
d°
.ho° = 
d°ho°m©ched
;

1439 #i‡
HAVE_UDP_SUPPORT


1440 
SOCKS_UDPASSOCIATE
: {

1476 
socksho°_t
 *
§cho°
;

1478 i‡(
	`SOCKSHOSTISBOUND
(&
io
.
§c
.
ho°
)) {

1479 
§cho°
 = &
io
.
§c
.
ho°
;

1481 
	`¶og
(
LOG_DEBUG
,

1484 
fun˘i⁄
, 
	`socksho°2°rög
(&
io
.
§c
.
ho°
, 
NULL
, 0));

1487 
	`¶og
(
LOG_DEBUG
,

1490 
fun˘i⁄
, 
	`socksho°2°rög
(&
io
.
§c
.
ho°
, 
NULL
, 0));

1492 
§cho°
 = 
NULL
;

1495 i‡(
§cho°
 !
NULL
) {

1501 
≥rmô
 = 
	`ruÀ•îmô
(
ªque°
->
s
,

1502 &
ªque°
->
‰om
,

1503 &
ªque°
->
to
,

1504 &
io
.
ˇuth
,

1505 &
io
.
c⁄åﬁ
.
auth
,

1506 &
io
.
§uÀ
,

1507 &
io
.
°©e
,

1508 
§cho°
,

1509 
NULL
,

1510 
NULL
,

1511 
emsg
,

1512 
emsgÀn
);

1515 i‡(
§cho°
 =
NULL


1516 || (
§cho°
 !
NULL
 && 
≥rmô
)) {

1523 
≥rmô
 = 
	`ruÀ•îmô
(
ªque°
->
s
,

1524 &
ªque°
->
‰om
,

1525 &
ªque°
->
to
,

1526 &
io
.
ˇuth
,

1527 &
io
.
c⁄åﬁ
.
auth
,

1528 &
io
.
§uÀ
,

1529 &
io
.
°©e
,

1530 &
io
.
c⁄åﬁ
.
ho°
,

1531 
NULL
,

1532 
NULL
,

1533 
emsg
,

1534 
emsgÀn
);

1542 
	`SERRX
(
ªque°
->
ªq
.
comm™d
);

1548 
§c
->
auth_is£t
 = 1;

1549 
§c
->
auth
 = 
io
.src.auth;

1555 i‡(
≥rmô
) {

1582 
cöfo
.
‰om
 = 
ªque°
->from;

1583 
	`HOSTIDCOPY
(&
ªque°
->
°©e
, &
cöfo
);

1585 
rc
 = 
	`ruÀ_öhîô‹u£
(
	`CRULE_OR_HRULE
(&
io
),

1586 &
cöfo
,

1587 &
io
.
§uÀ
,

1588 &
cöfo
,

1589 
ALARM_INTERNAL
,

1590 
emsg
,

1591 
emsgÀn
);

1594 
ªque°
->
§uÀ
 = 
io
.srule;

1595 
ªque°
->
§uÀ_is£t
 = 1;

1597 i‡(
rc
 != 0) {

1602 i‡(
	`CRULE_OR_HRULE
(
ªque°
)->
m°©s_shmid
 != 0

1603 && (
	`CRULE_OR_HRULE
(
ªque°
)->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

1604 
	`Æ¨m_add_disc⁄√˘
(0,

1605 
	`CRULE_OR_HRULE
(
ªque°
),

1606 
ALARM_INTERNAL
,

1607 &
cöfo
,

1608 
	`°ªº‹
(
î∫o
),

1609 
sockscf
.
shmemfd
);

1611 
≥rmô
 = 0;

1615 
ªque°
->
§uÀ
 = 
io
.srule;

1616 
ªque°
->
§uÀ_is£t
 = 1;

1617 
	`SHMEM_MOVE
(
	`CRULE_OR_HRULE
(
ªque°
), &ªque°->
§uÀ
, 
SHMEM_ALL
);

1620 i‡(!
≥rmô
) {

1621 
	`iﬁog
(
	`IORULE
(&
io
),

1622 &
io
.
°©e
,

1623 
OPERATION_BLOCK
,

1624 
§c
,

1625 
d°
,

1626 
NULL
,

1627 
NULL
,

1628 
emsg
,

1629 
	`°æí
(
emsg
));

1631 #i‡
HAVE_NEGOTIATE_PHASE


1632 
	`£nd_Áûuª
(
	`CONTROLIO
(&
io
)->
s
, &
ª•⁄£
, 
SOCKS_NOTALLOWED
);

1635 
	`¢¥ötf
(
buf
, (buf),

1637 
	`obje˘ty≥2°rög
(
	`IORULE
(&
io
)->
ty≥
),

1638 ()
	`IORULE
(&
io
)->
numbî
,

1639 *
emsg
 =
NUL
 ? "" : ": ",

1640 
emsg
);

1642 
	`°∫˝y
(
emsg
, 
buf
, 
emsgÀn
 - 1);

1643 
emsg
[
emsgÀn
 - 1] = 
NUL
;

1645 
	`˛o£_iodes¸ùt‹s
(&
io
);

1646  
IO_BLOCK
;

1649 
	`SASSERTX
(
≥rmô
);

1657 
io
.
§c
.
auth
 = io.
c⁄åﬁ
.auth = io.
ˇuth
;

1666 
io
.
§uÀ
 = io.
¸uÀ
;

1667 
io
.
§uÀ
.
ty≥
 = 
obje˘_§uÀ
;

1669 
	`SHMEM_CLEAR
(&
io
.
§uÀ
, 
SHMEM_ALL
, 1);

1672 i‡(
io
.
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
) {

1673 i‡(
io
.
d°
.
s
 == -1) {

1674 i‡(
	`bödexã∫Æaddr
(&
io
, &
ªque°
->
ªq
, 
buf
, (buf)) == 0)

1675 
	`SASSERTX
(
io
.
d°
.
s
 != -1);

1677 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1680 
buf
);

1682 
	`iﬁog
(&
io
.
¸uÀ
,

1683 &
io
.
°©e
,

1684 
OPERATION_ERROR
,

1685 
§c
,

1686 
d°
,

1687 
NULL
,

1688 
NULL
,

1689 
emsg
,

1690 
msgÀn
);

1692 
	`£nd_Áûuª
(
	`CONTROLIO
(&
io
)->
s
, &
ª•⁄£
, 
SOCKS_NETUNREACH
);

1694 
	`˛o£_iodes¸ùt‹s
(&
io
);

1695  
IO_ERROR
;

1698 
	`£tc⁄fsock›ti⁄s
(
io
.
§c
.
s
,

1699 
io
.
§c
.
s
,

1700 
io
.
°©e
.
¥Ÿocﬁ
,

1702 
io
.
§uÀ
.
sockë›ti⁄c
,

1703 
io
.
§uÀ
.
sockë›ti⁄v
,

1704 
SOCKETOPT_ANYTIME
 | 
SOCKETOPT_POST
,

1708 
	`sockaddr2socksho°
(&
io
.
d°
.
œddr
, &d°->
loˇl
);

1709 
d°
->
loˇl_is£t
 = 1;

1712 
io
.
d°
.
s
 = -1;

1717 i‡(
io
.
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
) {

1718 
	`SASSERTX
(
io
.
d°
.
s
 != -1);

1720 i‡(
	`ªdúe˘
(
io
.
d°
.
s
,

1721 &
io
.
d°
.
œddr
,

1722 #i‡!
BAREFOOTD


1723 &
io
.
d°
.
ho°
,

1725 
ªque°
->
ªq
.
comm™d
,

1726 &
io
.
§uÀ
.
rdr_‰om


1727 #i‡!
BAREFOOTD


1728 , &
io
.
§uÀ
.
rdr_to


1732 i‡(
io
.
§uÀ
.
log
.
îr‹
) {

1733 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1734 "ªdúe˘(ËÁûed: %s", 
	`°ªº‹
(
î∫o
));

1735 
	`iﬁog
(&
io
.
§uÀ
,

1736 &
io
.
°©e
,

1737 
OPERATION_ERROR
,

1738 
§c
,

1739 
d°
,

1740 
NULL
,

1741 
NULL
,

1742 
emsg
,

1743 
msgÀn
);

1746 
	`£nd_Áûuª
(
	`CONTROLIO
(&
io
)->
s
,

1747 &
ª•⁄£
,

1748 
	`î∫o2ª∂y
(
î∫o
, 
ª•⁄£
.
vîsi⁄
));

1750 
	`˛o£_iodes¸ùt‹s
(&
io
);

1751  
IO_ERROR
;

1754 
	`£tsock›ti⁄s
(
io
.
d°
.
s
, io.d°.
œddr
.
ss_Ámûy
, 
SOCK_STREAM
, 0);

1756 
	`£tc⁄fsock›ti⁄s
(
io
.
d°
.
s
,

1757 
	`CONTROLIO
(&
io
)->
s
,

1758 
SOCKS_TCP
,

1760 
io
.
§uÀ
.
sockë›ti⁄c
,

1761 
io
.
§uÀ
.
sockë›ti⁄v
,

1762 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
,

1763 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
);

1766 
î∫o
 = 0;

1767 i‡(
	`£rvîchaö
(
io
.
d°
.
s
,

1768 
	`CONTROLIO
(&
io
)->
s
,

1769 &
io
.
§c
.
øddr
,

1770 &
ªque°
->
ªq
,

1771 &
io
.
°©e
.
¥oxychaö
,

1772 
io
.
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ? &io.
d°
.
auth
 : 
NULL
,

1773 
buf
,

1774 (
buf
)) == 0) {

1775 i‡(
io
.
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 !
PROXY_DIRECT
) {

1776 
sockÀn_t
 
söÀn
;

1778 
io
.
§c
.
°©e
.
isc⁄√˘ed
 = 1;

1779 
io
.
d°
.
°©e
.
isc⁄√˘ed
 = 1;

1781 
söÀn
 = (
io
.
d°
.
øddr
);

1782 i‡(
	`gë≥î«me
(
io
.
d°
.
s
, 
	`TOSA
(&io.d°.
øddr
), &
söÀn
) != 0) {

1783 
	`¶og
(
LOG_DEBUG
,

1786 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

1788 i‡(
io
.
§uÀ
.
log
.
îr‹
) {

1789 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1791 
	`°ªº‹
(
î∫o
));

1793 
	`iﬁog
(&
io
.
§uÀ
,

1794 &
io
.
°©e
,

1795 
OPERATION_ERROR
,

1796 
§c
,

1797 
d°
,

1798 
NULL
,

1799 
NULL
,

1800 
emsg
,

1801 
msgÀn
);

1804 *
we˛o£dfú°
 = 0;

1806 
	`˛o£_iodes¸ùt‹s
(&
io
);

1808  
IO_ERROR
;

1811 
	`£tc⁄fsock›ti⁄s
(
io
.
d°
.
s
,

1812 
ªque°
->
s
,

1813 
io
.
°©e
.
¥Ÿocﬁ
,

1815 
io
.
§uÀ
.
sockë›ti⁄c
,

1816 
io
.
§uÀ
.
sockë›ti⁄v
,

1817 
SOCKETOPT_POST
,

1818 
SOCKETOPT_POST
);

1820 i‡(
	`SHMEMRULE
(&
io
)->
m°©s_shmid
 != 0

1821 && (
	`SHMEMRULE
(&
io
)->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

1822 
	`Æ¨m_add_c⁄√˘
(
	`SHMEMRULE
(&
io
),

1823 
ALARM_EXTERNAL
,

1824 &
cöfo
,

1825 
sockscf
.
shmemfd
, &
io
);

1827 
io
.
ªqöfo
.
comm™d
 = (io.
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

1828 
SOCKD_FREESLOT_TCP
 : 
SOCKD_FREESLOT_UDP
);

1830 
	`Êushio
(
mŸhî
->
s
, &
io
);

1832  
IO_NOERROR
;

1837 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "£rvîchaö faûed: %s", 
buf
);

1839 
	`iﬁog
(
	`IORULE
(&
io
),

1840 &
io
.
°©e
,

1841 
OPERATION_ERROR
,

1842 
§c
,

1843 
d°
,

1844 
NULL
,

1845 
NULL
,

1846 
emsg
,

1847 
msgÀn
);

1849 
	`£nd_Áûuª
(
ªque°
->
s
,

1850 &
ª•⁄£
,

1851 
	`î∫o2ª∂y
(
î∫o
,

1852 
ª•⁄£
.
vîsi⁄
));

1854 
	`˛o£_iodes¸ùt‹s
(&
io
);

1855  
IO_ERROR
;

1858 
	`SASSERTX
(
io
.
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
);

1864 
	`socks_£t_ª•⁄£vÆue
(&
ª•⁄£
,

1865 
	`sockscode
(
ª•⁄£
.
vîsi⁄
, 
SOCKS_SUCCESS
));

1867 
rc
 = 0;

1868 
io°©us
 = 
IO_NOERROR
;

1870 
io
.
°©e
.
comm™d
) {

1871 #i‡
SOCKS_SERVER


1872 
SOCKS_BIND
: {

1873 
sockd_io_t
 *
iﬁi°
;

1874 
sockd_io_t
 
bödio
;

1875 
sockÀn_t
 
Àn
;

1876 
	esockëödex
 { 
˛õ¡
, 
chûdpùe
, 
ouΩùe
, 
ª∂y
, 
ªmŸe
 };

1879 
sv
[()(
ªmŸe
Ë+ 1] = { -1, -1, -1, -1, -1 }, 
emfûe
;

1887 
msgÀn
 = 0;

1889 i‡(
io
.
°©e
.
exãnsi⁄
.
böd
)

1890 
d°
->
≥î_is£t
 = 0;

1892 
d°
->
≥î_is£t
 = 1;

1893 
d°
->
≥î
 = 
io
.d°.
ho°
;

1896 i‡(
	`li°í
(
io
.
d°
.
s
, 
SOCKD_MAXCLIENTQUEUE
) != 0) {

1897 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1899 
	`°ªº‹
(
î∫o
));

1901 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

1903 
io°©us
 = 
IO_ERROR
;

1904 
rc
 = -1;

1907 i‡(
rc
 == 0) {

1908 
	`SASSERTX
(
sv
[
	`ELEMENTS
(sv) - 1] == -1);

1909 i‡(
io
.
°©e
.
exãnsi⁄
.
böd
) {

1910 
pùev
[2];

1925 i‡(
	`sockë∑ú
(
AF_LOCAL
, 
SOCK_STREAM
, 0, 
pùev
) == 0) {

1926 
sv
[
chûdpùe
] = 
pùev
[0];

1927 
sv
[
ouΩùe
] = 
pùev
[1];

1930 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1931 "sockë∑ú(ËÁûed: %s", 
	`°ªº‹
(
î∫o
));

1933 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

1935 
io°©us
 = 
IO_ERROR
;

1936 
rc
 = -1;

1941 i‡(
rc
 == 0) {

1946 
	`sockaddr2socksho°
(&
io
.
d°
.
œddr
, &
ª•⁄£
.
ho°
);

1947 i‡(
	`£nd_ª•⁄£
(
ªque°
->
s
, &
ª•⁄£
) != 0) {

1948 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

1950 
	`°ªº‹
(
î∫o
));

1952 
io°©us
 = 
IO_IOERROR
;

1953 
rc
 = -1;

1957 i‡(
rc
 != 0) {

1958 
	`iﬁog
(&
io
.
§uÀ
,

1959 &
io
.
°©e
,

1960 
OPERATION_ERROR
,

1961 
§c
,

1962 
d°
,

1963 
NULL
,

1964 
NULL
,

1965 
emsg
,

1966 
msgÀn
);

1968 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
SOCKS_FAILURE
);

1969 
	`˛o£_iodes¸ùt‹s
(&
io
);

1973 
	`iﬁog
(&
io
.
§uÀ
,

1974 &
io
.
°©e
,

1975 
OPERATION_CONNECT
,

1976 
§c
,

1977 
d°
,

1978 
NULL
,

1979 
NULL
,

1980 
NULL
,

1983 
emfûe
 = 0;

1984 
iﬁi°
 = 
NULL
;

1986 
bödio
 = 
io
;

1988 
bödio
.
°©e
.
comm™d
 = 
SOCKS_BINDREPLY
;

1990 
bödio
.
d°
.
ho°
 = 
bödª∂yd°
;

1992 i‡(
bödio
.
°©e
.
exãnsi⁄
.
böd
) {

1993 
	`socksho°2sockaddr
(&
bödio
.
d°
.
ho°
, &bödio.d°.
øddr
);

1996 
	`bzîo
(&
bödio
.
d°
.
œddr
, (bindio.dst.laddr));

1997 
	`SET_SOCKADDR
(&
bödio
.
d°
.
œddr
, 
AF_INET
);

1998 
	`TOIN
(&
bödio
.
d°
.
œddr
)->
sö_addr
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

1999 
	`TOIN
(&
bödio
.
d°
.
œddr
)->
sö_p‹t
 = 
	`ht⁄s
(0);

2002 
bödio
.
d°
.
œddr
 = 
io
.
§c
.laddr;

2003 
bödio
.
d°
.
øddr
 = 
io
.
§c
.raddr;

2006 
bödio
.
d°
.
auth
 = 
io
.
§c
.auth;

2008 
bödio
.
§c
.
auth
.
mëhod
 = 
AUTHMETHOD_NOTSET
;

2009 
bödio
.
§c
.
œddr
 = 
io
.
d°
.laddr;

2010 
	`sockaddr2socksho°
(&
bödio
.
§c
.
œddr
, &bödio.§c.
ho°
);

2015 
	`bzîo
(&
bödio
.
§c
.
øddr
, (bindio.src.raddr));

2016 
	`SET_SOCKADDR
(&
bödio
.
§c
.
øddr
, bödio.§c.
œddr
.
ss_Ámûy
);

2018 
bödio
.
cmd
.
böd
.
ho°
 = 
io
.
d°
.host;

2019 
bödio
.
cmd
.
böd
.
ruÀ
 = 
io
.
§uÀ
;

2027 
sv
[
˛õ¡
] = 
io
.
§c
.
s
;

2033 
fd_£t
 *
r£t
;

2034 
iﬁogaddr_t
 
ª∂y§c
, 
ª∂yd°
;

2035 
ruÀaddr_t
 
ruÀaddr
;

2036 
sockaddr_°‹age
 
ªmŸóddr
;

2037 
sockaddr_°‹age
 
ª∂yaddr
;

2038 
ª∂yªdúe˘
, 
fdbôs
;

2040 
	`öô_iﬁogaddr
(&
ª∂y§c
,

2041 
obje˘_sockaddr
,

2042 &
bödio
.
§c
.
œddr
,

2043 
obje˘_n⁄e
,

2044 
NULL
,

2045 
NULL
,

2046 
	`GET_HOSTIDV
(&
io
.
°©e
),

2047 
	`GET_HOSTIDC
(&
io
.
°©e
));

2050 i‡(
bödio
.
°©e
.
exãnsi⁄
.
böd
) {

2051 
	`öô_iﬁogaddr
(&
ª∂yd°
,

2052 
obje˘_n⁄e
,

2053 
NULL
,

2054 
obje˘_socksho°
,

2055 &
bödio
.
d°
.
ho°
,

2056 
NULL
,

2057 
NULL
,

2061 
ª∂yd°
 = *
§c
;

2063 i‡(
r£t
 =
NULL
)

2064 
r£t
 = 
	`Æloˇã_maxsize_fd£t
();

2066 
	`FD_ZERO
(
r£t
);

2069 
sv
[
ª∂y
] = -1;

2070 
sv
[
ªmŸe
] = -1;

2078 
fdbôs
 = -1;

2080 
	`FD_SET
(
mŸhî
->
ack
, 
r£t
);

2081 
fdbôs
 = 
	`MAX
(fdbôs, 
mŸhî
->
ack
);

2083 
	`FD_SET
(
sv
[
˛õ¡
], 
r£t
);

2084 
fdbôs
 = 
	`MAX
(fdbôs, 
sv
[
˛õ¡
]);

2086 i‡(!
emfûe
) {

2087 
	`FD_SET
(
io
.
d°
.
s
, 
r£t
);

2088 
fdbôs
 = 
	`MAX
(fdbôs, 
io
.
d°
.
s
);

2091 ++
fdbôs
;

2092 i‡((
rc
 = 
	`£À˘n
(
fdbôs
, 
r£t
, 
NULL
, NULL, NULL, NULL, NULL))

2094 i‡(
rc
 =-1 && 
î∫o
 =
EINTR
)

2097 
	`SERR
(
rc
);

2100 i‡(
	`FD_ISSET
(
mŸhî
->
ack
, 
r£t
)) {

2101 
	`¶og
(
LOG_DEBUG
,

2105 
fun˘i⁄
);

2110 i‡(
	`FD_ISSET
(
sv
[
˛õ¡
], 
r£t
)) {

2115 
ªque°_t
 
quîy
;

2116 
ª•⁄£_t
 
quîyª•⁄£
;

2117 
√gŸüã_°©e_t
 
°©e
;

2118 
sockaddr_°‹age
 
quîyaddr
;

2119 
√gŸüã_ªsu…_t
 
ªs
;

2121 
	`bzîo
(&
°©e
, (state));

2122 
	`bzîo
(&
quîy
, (query));

2123 
	`bzîo
(&
quîyª•⁄£
, (queryresponse));

2125 
quîy
.
auth
 = 
ªque°
->
ªq
.auth;

2126 
quîyª•⁄£
.
auth
 = 
quîy
.auth;

2128 
ªs
 = 
	`ªcv_sock•ackë
(
sv
[
˛õ¡
], &
quîy
, &
°©e
)) {

2129 
NEGOTIATE_CONTINUE
:

2130 
	`¶og
(
LOG_DEBUG
,

2132 
fun˘i⁄
);

2136 
NEGOTIATE_EOF
:

2137 
NEGOTIATE_ERROR
: {

2138 
›î©i⁄_t
 
›
;

2140 i‡(
ªs
 =
NEGOTIATE_ERROR
) {

2141 
msgÀn


2142 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

2144 
	`°ªº‹
(
î∫o
));

2146 
›
 = 
OPERATION_ERROR
;

2148 i‡(
	`ERRNOISNETWORK
(
î∫o
)) {

2149 
io°©us
 = 
IO_IOERROR
;

2150 *
we˛o£dfú°
 = 0;

2153 
io°©us
 = 
IO_ERROR
;

2156 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "eof from client");

2157 
›
 = 
OPERATION_DISCONNECT
;

2158 
io°©us
 = 
IO_CLOSE
;

2159 *
we˛o£dfú°
 = 0;

2162 
	`iﬁog
(&
io
.
§uÀ
,

2163 &
io
.
°©e
,

2164 
›
,

2165 
§c
,

2166 
d°
,

2167 
NULL
,

2168 
NULL
,

2169 
emsg
,

2170 
msgÀn
);

2172 
rc
 = -1;

2176 
NEGOTIATE_FINISHED
: {

2177 
sockd_io_t
 *
fio
;

2179 
	`¶og
(
LOG_DEBUG
, "received bindÑesolveÑequest: %s",

2180 
	`socks_∑ckë2°rög
(&
quîy
, 1));

2182 
quîy
.
vîsi⁄
) {

2183 
PROXY_SOCKS_V4
:

2184 
quîyª•⁄£
.
vîsi⁄
 = 
PROXY_SOCKS_V4REPLY_VERSION
;

2187 
PROXY_SOCKS_V5
:

2188 
quîyª•⁄£
.
vîsi⁄
 = 
quîy
.version;

2192 
	`SERRX
(
quîy
.
vîsi⁄
);

2195 
	`socksho°2sockaddr
(&
quîy
.
ho°
, &
quîyaddr
);

2196 i‡((
fio
 = 
	`io_föd
(
iﬁi°
, &
quîyaddr
)Ë=
NULL
) {

2197 
quîyª•⁄£
.
ho°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

2198 
quîyª•⁄£
.
ho°
.
addr
.
ùv4
.
s_addr
 = 
	`ht⁄l
(0);

2199 
quîyª•⁄£
.
ho°
.
p‹t
 = 
	`ht⁄s
(0);

2202 
	`SASSERTX
(
fio
->
°©e
.
comm™d
 =
SOCKS_BINDREPLY
);

2203 
	`SASSERTX
(
	`sockaddøªeq
(&
fio
->
d°
.
œddr
, &
quîyaddr
, 0));

2205 
	`sockaddr2socksho°
(&
fio
->
§c
.
øddr
,

2206 &
quîyª•⁄£
.
ho°
);

2209 i‡((
rc
 = 
	`£nd_ª•⁄£
(
sv
[
˛õ¡
], &
quîyª•⁄£
)) == 0){

2210 i‡(
fio
 !
NULL
) {

2211 
fio
->
ªqöfo
.
comm™d
 = 
SOCKD_NOP
;

2212 
	`Êushio
(
mŸhî
->
s
, 
fio
);

2214 
emfûe
 = 
	`MAX
(0,Émfile - 3);

2215 
iﬁi°
 = 
	`io_ªmove
(iﬁi°, 
fio
);

2220 
msgÀn


2221 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

2223 
	`°ªº‹
(
î∫o
));

2225 
	`iﬁog
(&
io
.
§uÀ
,

2226 &
io
.
°©e
,

2227 
OPERATION_ERROR
,

2228 
§c
,

2229 
d°
,

2230 
NULL
,

2231 
NULL
,

2232 
emsg
,

2233 
msgÀn
);

2235 *
we˛o£dfú°
 = 0;

2236 
io°©us
 = 
IO_IOERROR
;

2237 
rc
 = -1;

2244 
	`SERRX
(
ªs
);

2247 i‡(
rc
 == -1)

2251 i‡(!
	`FD_ISSET
(
io
.
d°
.
s
, 
r£t
))

2254 
Àn
 = (
ªmŸóddr
);

2255 i‡((
sv
[
ªmŸe
] = 
	`ac˚±n
(
io
.
d°
.
s
, &
ªmŸóddr
, &
Àn
))

2257 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

2259 
	`°ªº‹
(
î∫o
));

2261 
	`iﬁog
(&
io
.
§uÀ
,

2262 &
io
.
°©e
,

2263 
OPERATION_ERROR
,

2264 &
ª∂y§c
,

2265 &
ª∂yd°
,

2266 
NULL
,

2267 
NULL
,

2268 
emsg
,

2269 
msgÀn
);

2271 
î∫o
) {

2272 #ifde‡
EPROTO


2273 
EPROTO
:

2275 
EWOULDBLOCK
:

2276 
ECONNABORTED
:

2279 #ifde‡
ECONNRESET


2280 
ECONNRESET
:

2282 #ifde‡
ETIMEDOUT


2283 
ETIMEDOUT
:

2285 #ifde‡
EHOSTUNREACH


2286 
EHOSTUNREACH
:

2288 #ifde‡
ENETUNREACH


2289 
ENETUNREACH
:

2293 
EMFILE
:

2294 
ENFILE
:

2295 ++
emfûe
;

2299 
io°©us
 = 
IO_IOERROR
;

2303 
	`¶og
(
LOG_DEBUG
, "%s: gotá bindreply from %s",

2304 
fun˘i⁄
, 
	`sockaddr2°rög
(&
ªmŸóddr
, 
NULL
, 0));

2306 
	`sockaddr2socksho°
(&
ªmŸóddr
, &
bödio
.
§c
.
ho°
);

2307 
bödio
.
§c
.
øddr
 = 
ªmŸóddr
;

2308 
ª∂y§c
.
≥î_is£t
 = 1;

2309 
ª∂y§c
.
≥î
 = 
bödio
.
§c
.
ho°
;

2315 i‡(
io
.
°©e
.
exãnsi⁄
.
böd


2316 || ( 
ex≥˘edbödª∂y
.
©y≥
 =
SOCKS_ADDR_IPV4


2317 && 
ex≥˘edbödª∂y
.
addr
.
ùv4
.
s_addr
 =
	`ht⁄l
(0))

2318 || 
	`addrm©ch
(
	`socksho°2ruÀaddr
(&
ex≥˘edbödª∂y
, &
ruÀaddr
),

2319 &
bödio
.
§c
.
ho°
,

2320 
NULL
,

2321 
SOCKS_TCP
,

2323 
≥rmô
 = 
	`ruÀ•îmô
(
sv
[
ªmŸe
],

2324 &
ªmŸóddr
,

2325 &
io
.
d°
.
œddr
,

2326 
NULL
,

2327 &
bödio
.
§c
.
auth
,

2328 &
bödio
.
§uÀ
,

2329 &
bödio
.
°©e
,

2330 &
bödio
.
§c
.
ho°
,

2331 &
bödio
.
d°
.
ho°
,

2332 
NULL
,

2333 
emsg
,

2334 
emsgÀn
);

2335 
ª∂y§c
.
auth_is£t
 = 1;

2336 
ª∂y§c
.
auth
 = 
bödio
.
§c
.auth;

2339 
bödio
.
§uÀ
.
numbî
 = 0;

2340 
bödio
.
§uÀ
.
vîdi˘
 = 
VERDICT_BLOCK
;

2342 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

2344 
	`socksho°2°rög
(&
ex≥˘edbödª∂y
,

2345 
°rho°
,

2346 (
°rho°
)),

2347 
	`socksho°2°rög
(&
bödio
.
§c
.
ho°
, 
NULL
, 0));

2349 
≥rmô
 = 0;

2352 i‡(
≥rmô
) {

2367 c⁄° 
doöhîô
 = (
bödio
.
°©e
.
exãnsi⁄
.
böd
 == 0);

2369 
	`¶og
(
LOG_DEBUG
,

2372 
fun˘i⁄
,

2373 
	`obje˘ty≥2°rög
(
bödio
.
§uÀ
.
ty≥
),

2374 ()
bödio
.
§uÀ
.
numbî
,

2375 
doöhîô
 ? "consider inheriting" : "beággregated with",

2376 
	`obje˘ty≥2°rög
(
io
.
§uÀ
.
ty≥
),

2377 ()
io
.
§uÀ
.
numbî
);

2379 i‡(
doöhîô
) {

2380 
rc
 = 
	`ruÀ_öhîô‹u£
(&
io
.
§uÀ
,

2381 &
cöfo
,

2382 &
bödio
.
§uÀ
,

2383 &
cöfo
,

2384 
ALARM_INTERNAL
,

2385 
emsg
,

2386 
emsgÀn
);

2388 i‡(
rc
 != 0) {

2389 
≥rmô
 = 0;

2390 
bödio
.
§uÀ
.
vîdi˘
 = 
VERDICT_BLOCK
;

2394 i‡(
	`shmem_u£ruÀ
(&
bödio
.
§uÀ
, &
cöfo
, 
emsg
, 
emsgÀn
) != 0){

2395 
≥rmô
 = 0;

2396 
bödio
.
§uÀ
.
vîdi˘
 = 
VERDICT_BLOCK
;

2400 i‡(!
≥rmô
) {

2401 
	`SHMEM_CLEAR
(&
bödio
.
§uÀ
, 
SHMEM_ALL
, 1);

2403 i‡(!
bödio
.
°©e
.
exãnsi⁄
.
böd
) {

2413 i‡(
io
.
§uÀ
.
m°©s_shmid
 != 0

2414 && (
io
.
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

2415 
	`Æ¨m_add_disc⁄√˘
(0,

2416 &
io
.
§uÀ
,

2417 
ALARM_INTERNAL
,

2418 &
cöfo
,

2419 
	`°ªº‹
(
î∫o
),

2420 
sockscf
.
shmemfd
);

2424 
ªque°
->
§uÀ
 = 
bödio
.srule;

2425 
	`SASSERTX
(
ªque°
->
§uÀ_is£t
);

2429 i‡(!
≥rmô
) {

2430 
	`iﬁog
(&
bödio
.
§uÀ
,

2431 &
bödio
.
°©e
,

2432 
OPERATION_BLOCK
,

2433 &
ª∂y§c
,

2434 &
ª∂yd°
,

2435 
NULL
,

2436 
NULL
,

2437 
emsg
,

2438 
	`°æí
(
emsg
));

2440 i‡(!
bödio
.
°©e
.
exãnsi⁄
.
böd
) {

2446 
size_t
 
Àn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

2449 
	`sockaddr2°rög
(&
bödio
.
§c
.
øddr
,

2450 
NULL
,

2452 
	`obje˘ty≥2°rög
(
bödio
.
§uÀ
.
ty≥
),

2453 ()
bödio
.
§uÀ
.
numbî
);

2455 
ª•⁄£
.
ho°
 = 
bödio
.
§c
.host;

2456 
	`£nd_Áûuª
(
sv
[
˛õ¡
], &
ª•⁄£
, 
SOCKS_NOTALLOWED
);

2461 
î∫o
 = 0;

2462 
	`iﬁog
(&
io
.
§uÀ
,

2463 &
io
.
°©e
,

2464 
OPERATION_BLOCK
,

2465 
§c
,

2466 
d°
,

2467 
NULL
,

2468 
NULL
,

2469 
emsg
,

2470 
Àn
);

2472 
io°©us
 = 
IO_BLOCK
;

2476 
	`˛o£
(
sv
[
ªmŸe
]);

2481 
î∫o
 = 0;

2482 i‡(
	`ªdúe˘
(
sv
[
ª∂y
],

2483 &
ªmŸóddr
,

2484 
bödio
.
°©e
.
exãnsi⁄
.
böd
 ? &
bödª∂yd°
 : 
NULL
,

2485 
SOCKS_BINDREPLY
,

2486 &
bödio
.
§uÀ
.
rdr_‰om
,

2487 &
bödio
.
§uÀ
.
rdr_to
) != 0) {

2489 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

2490 "ªdúe˘(ËÁûed: %s", 
	`°ªº‹
(
î∫o
));

2492 
	`iﬁog
(&
bödio
.
§uÀ
,

2493 &
bödio
.
°©e
,

2494 
OPERATION_ERROR
,

2495 &
ª∂y§c
,

2496 &
ª∂yd°
,

2497 
NULL
,

2498 
NULL
,

2499 
emsg
,

2500 
msgÀn
);

2502 
	`˛o£
(
sv
[
ªmŸe
]);

2503 
	`˛o£
(
sv
[
ª∂y
]);

2505 
	`SHMEM_UNUSE
(&
bödio
.
§uÀ
,

2506 &
cöfo
,

2507 
sockscf
.
shmemfd
,

2508 
SHMEM_ALL
);

2512 
bödio
.
d°
.
ho°
 = 
bödª∂yd°
;

2513 
	`socksho°2sockaddr
(&
bödio
.
d°
.
ho°
, &bödio.d°.
øddr
);

2526 i‡(
bödio
.
°©e
.
exãnsi⁄
.
böd
)

2527 
ª∂yªdúe˘
 = 1;

2529 i‡(!
	`socksho°¨ìq
(&
bödª∂yd°
, &
io
.
§c
.
ho°
)) {

2530 
	`¶og
(
LOG_DEBUG
,

2533 
fun˘i⁄
, 
	`socksho°2°rög
(&
bödª∂yd°
, 
NULL
, 0));

2535 
ª∂yªdúe˘
 = 1;

2538 
ª∂yªdúe˘
 = 0;

2541 i‡(
bödio
.
°©e
.
exãnsi⁄
.
böd
 || 
ª∂yªdúe˘
) {

2547 i‡((
sv
[
ª∂y
] = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0)) == -1) {

2548 i‡(
io
.
§uÀ
.
log
.
îr‹
)

2549 
	`sw¨n
("%s: sockë(SOCK_STREAM)", 
fun˘i⁄
);

2551 
î∫o
) {

2552 
EMFILE
:

2553 
ENFILE
:

2554 ++
emfûe
;

2557 
ENOBUFS
:

2558 
	`˛o£
(
sv
[
ªmŸe
]);

2559 
	`SHMEM_UNUSE
(&
bödio
.
§uÀ
,

2560 &
cöfo
,

2561 
sockscf
.
shmemfd
,

2562 
SHMEM_ALL
);

2566 
io°©us
 = 
IO_IOERROR
;

2570 
	`£tsock›ti⁄s
(
sv
[
ª∂y
], 
AF_INET
, 
SOCK_STREAM
, 1);

2571 
	`£tc⁄fsock›ti⁄s
(
sv
[
˛õ¡
],

2572 
sv
[
ª∂y
],

2573 
bödio
.
°©e
.
¥Ÿocﬁ
,

2575 
bödio
.
§uÀ
.
sockë›ti⁄c
,

2576 
bödio
.
§uÀ
.
sockë›ti⁄v
,

2577 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
,

2578 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
);

2580 
ª∂yaddr
 = 
io
.
§c
.
œddr
;

2581 
	`SET_SOCKADDRPORT
(&
ª∂yaddr
, 
	`ht⁄s
(0));

2583 i‡(
	`socks_böd
(
sv
[
ª∂y
], &
ª∂yaddr
, 0) != 0) {

2584 
	`log_böd_Áûed
(
fun˘i⁄
, 
SOCKS_TCP
, &
ª∂yaddr
);

2586 
io°©us
 = 
IO_IOERROR
;

2590 
bödio
.
d°
.
œddr
 = 
ª∂yaddr
;

2591 
ª∂yd°
.
≥î_is£t
 = 1;

2592 
	`sockaddr2socksho°
(&
bödio
.
d°
.
œddr
, &
ª∂yd°
.
≥î
);

2594 
	`¶og
(
LOG_DEBUG
,

2596 
fun˘i⁄
,

2597 
	`socksho°2°rög
(&
bödª∂yd°
, 
°rho°
, (strhost)),

2598 
	`socksho°2°rög
(&
bödio
.
§c
.
ho°
, 
NULL
, 0));

2600 i‡(
	`socks_c⁄√˘ho°
(
sv
[
ª∂y
],

2601 
INTERNALIF
,

2602 &
bödª∂yd°
,

2603 
NULL
,

2604 
NULL
,

2605 
bödio
.
§uÀ
.
timeout
.
c⁄√˘
 ?

2606 ()
bödio
.
§uÀ
.
timeout
.
c⁄√˘
 : ()-1,

2607 
emsg
,

2608 
emsgÀn
) != 0) {

2609 
	`iﬁog
(&
bödio
.
§uÀ
,

2610 &
bödio
.
°©e
,

2611 
OPERATION_ERROR
,

2612 &
ª∂y§c
,

2613 &
ª∂yd°
,

2614 
NULL
,

2615 
NULL
,

2616 
emsg
,

2617 
	`°æí
(
emsg
));

2620 
	`iﬁog
(&
io
.
§uÀ
,

2621 &
io
.
°©e
,

2622 
OPERATION_ERROR
,

2623 
§c
,

2624 
d°
,

2625 
NULL
,

2626 
NULL
,

2627 
emsg
,

2628 
	`°æí
(
emsg
));

2630 
io°©us
 = 
IO_IOERROR
;

2634 
	`£tc⁄fsock›ti⁄s
(
sv
[
˛õ¡
],

2635 
sv
[
ª∂y
],

2636 
bödio
.
°©e
.
¥Ÿocﬁ
,

2638 
bödio
.
§uÀ
.
sockë›ti⁄c
,

2639 
bödio
.
§uÀ
.
sockë›ti⁄v
,

2640 
SOCKETOPT_POST
,

2641 
SOCKETOPT_POST
);

2643 i‡(
ª∂yªdúe˘
) {

2644 
	`˛o£
(
sv
[
˛õ¡
]);

2645 
sv
[
˛õ¡
] = sv[
ª∂y
];

2646 
sv
[
ª∂y
] = -1;

2650 i‡(
bödio
.
°©e
.
exãnsi⁄
.
böd
) {

2656 i‡((
bödio
.
c⁄åﬁ
.
s
 = 
	`dup
(
sv
[
chûdpùe
])) == -1) {

2657 
î∫o
) {

2658 
EMFILE
:

2659 
ENFILE
:

2660 i‡(
bödio
.
§uÀ
.
log
.
îr‹
)

2661 
	`sw¨n
("%s: dup()", 
fun˘i⁄
);

2663 ++
emfûe
;

2664 
	`˛o£
(
sv
[
ªmŸe
]);

2668 
	`SERR
(
bödio
.
c⁄åﬁ
.
s
);

2673 i‡(
bödio
.
°©e
.
exãnsi⁄
.
böd
 || 
ª∂yªdúe˘
) {

2674 i‡(
bödio
.
°©e
.
exãnsi⁄
.
böd
)

2675 
bödio
.
d°
.
s
 = 
sv
[
ª∂y
];

2677 
bödio
.
d°
.
s
 = 
sv
[
˛õ¡
];

2680 
bödio
.
d°
 = 
io
.
§c
;

2682 
bödio
.
§c
.
s
 = 
sv
[
ªmŸe
];

2684 
bödio
.
§c
.
°©e
.
isc⁄√˘ed
 = 1;

2685 
bödio
.
d°
.
°©e
.
isc⁄√˘ed
 = 1;

2687 i‡(
bödio
.
§uÀ
.
m°©s_shmid
 != 0

2688 && (
bödio
.
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

2689 
	`Æ¨m_add_c⁄√˘
(&
bödio
.
§uÀ
,

2690 
ALARM_EXTERNAL
,

2691 &
cöfo
,

2692 
sockscf
.
shmemfd
, &
io
);

2694 i‡(
bödio
.
°©e
.
exãnsi⁄
.
böd
)

2696 
iﬁi°
 = 
	`io_add
(iﬁi°, &
bödio
);

2698 
ª•⁄£
.
ho°
 = 
bödio
.
§c
.host;

2700 i‡(
	`£nd_ª•⁄£
(
sv
[
˛õ¡
], &
ª•⁄£
) != 0) {

2701 
	`˛o£_iodes¸ùt‹s
(&
io
);

2702 
io°©us
 = 
IO_IOERROR
;

2705 
bödio
.
ªqöfo
.
comm™d


2706 (
bödio
.
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

2707 
SOCKD_FREESLOT_TCP
 : 
SOCKD_FREESLOT_UDP
);

2709 
	`Êushio
(
mŸhî
->
s
, &
bödio
);

2713 
sv
[
˛õ¡
] = sv[
ªmŸe
] = -1;

2716 i‡(!
bödio
.
°©e
.
exãnsi⁄
.
böd
)

2720 i‡(
bödio
.
°©e
.
exãnsi⁄
.
böd
) {

2721 
sockd_io_t
 *
rmio
;

2724 (
rmio
 = 
	`io_föd
(
iﬁi°
, 
NULL
)) != NULL) {

2725 
	`˛o£_iodes¸ùt‹s
(
rmio
);

2726 
iﬁi°
 = 
	`io_ªmove
(iﬁi°, 
rmio
);

2731 
	`˛o£
(
io
.
d°
.
s
);

2733 
	`˛o£v
(
	`ELEMENTS
(
sv
), sv);

2738 
SOCKS_CONNECT
: {

2739 
rc
 = 
	`socks_c⁄√˘ho°
(
io
.
d°
.
s
,

2740 
EXTERNALIF
,

2741 &
io
.
d°
.
ho°
,

2742 &
io
.
d°
.
œddr
,

2743 &
io
.
d°
.
øddr
,

2745 
emsg
,

2746 
emsgÀn
);

2748 i‡(
rc
 == 0) {

2749 
io
.
d°
.
°©e
.
isc⁄√˘ed
 = 1;

2751 #i‡
HAVE_NEGOTIATE_PHASE


2752 i‡(
SOCKS_SERVER
 || 
io
.
ªqÊags
.
hâpc⁄√˘
) {

2753 
î∫o
 = 0;

2754 i‡(
	`£nd_c⁄√˘ª•⁄£
(
ªque°
->
s
, 
î∫o
, &
io
) != 0) {

2755 *
we˛o£dfú°
 = 0;

2756 
io°©us
 = 
IO_IOERROR
;

2758 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

2760 
	`°ªº‹
(
î∫o
));

2762 
	`˛o£_iodes¸ùt‹s
(&
io
);

2769 i‡(
î∫o
 =
EINPROGRESS
)

2775 
rc
 = 0;

2777 
rc
 = -1;

2778 
io°©us
 = 
IO_IOERROR
;

2780 #i‡
HAVE_NEGOTIATE_PHASE


2782 
	`SASSERTX
(
î∫o
 != 0);

2783 i‡(
	`£nd_c⁄√˘ª•⁄£
(
ªque°
->
s
, 
î∫o
, &
io
) != 0)

2784 
	`¶og
(
LOG_DEBUG
,

2786 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

2790 i‡(
	`ERRNOISRST
(
î∫o
))

2791 
	`sockd_r°⁄˛o£
(
io
.
d°
.
s
);

2797 i‡(
rc
 != 0) {

2798 
	`iﬁog
(&
io
.
§uÀ
,

2799 &
io
.
°©e
,

2800 
OPERATION_ERROR
,

2801 
§c
,

2802 
d°
,

2803 
NULL
,

2804 
NULL
,

2805 
emsg
,

2806 
	`°æí
(
emsg
));

2808 
	`˛o£_iodes¸ùt‹s
(&
io
);

2811 i‡(
	`SHMEMRULE
(&
io
)->
m°©s_shmid
 != 0

2812 && (
	`SHMEMRULE
(&
io
)->
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
))

2816 
	`Æ¨m_add_c⁄√˘
(
	`SHMEMRULE
(&
io
),

2817 
ALARM_EXTERNAL
,

2818 &
cöfo
,

2819 
sockscf
.
shmemfd
, &
io
);

2821 
io
.
§c
.
°©e
.
isc⁄√˘ed
 = 1;

2822 
	`SASSERTX
(
io
.
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
);

2823 
io
.
ªqöfo
.
comm™d
 = (io.
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

2824 
SOCKD_FREESLOT_TCP
 : 
SOCKD_FREESLOT_UDP
);

2826 
	`Êushio
(
mŸhî
->
s
, &
io
);

2832 #i‡
HAVE_UDP_SUPPORT


2833 
SOCKS_UDPASSOCIATE
: {

2847 
sockÀn_t
 
boundÀn
;

2848 
gaõº
;

2849 #i‡
SOCKS_SERVER


2850 
åõ¶e·
;

2853 
	`socksho°2sockaddr2
(&
io
.
§c
.
ho°
,

2854 &
io
.
§c
.
øddr
,

2855 &
gaõº
,

2856 
buf
,

2857 (
buf
));

2859 i‡(
gaõº
 != 0) {

2860 
	`SASSERTX
(
io
.
§c
.
ho°
.
©y≥
 =
SOCKS_ADDR_DOMAIN
);

2862 
	`log_ªsﬁveÁûed
(
io
.
§c
.
ho°
.
addr
.
domaö
, 
INTERNALIF
, 
gaõº
);

2864 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

2868 
	`socksho°2°rög
(&
io
.
§c
.
ho°
, 
NULL
, 0));

2870 
rc
 = 
SOCKS_HOSTUNREACH
;

2873 
rc
 = 
SOCKS_SUCCESS
;

2875 i‡(
rc
 =
SOCKS_SUCCESS
) {

2881 i‡(
ªque°
->
to
.
ss_Ámûy
 =
io
.
§c
.
øddr
.ss_family)

2888 
io
.
§c
.
œddr
 = 
ªque°
->
to
;

2890 i‡(
	`gëöaddr
(&
io
.
§c
.
œddr
, &io.§c.
øddr
, 
emsg
, 
emsgÀn
)

2891 =
NULL
) {

2892 
	`¶og
(
LOG_DEBUG
,

2895 
fun˘i⁄
,

2896 
	`ßÁmûy2°rög
(
io
.
§c
.
øddr
.
ss_Ámûy
),

2897 
	`sockaddr2°rög2
(&
io
.
§c
.
øddr
, 0, 
NULL
, 0),

2898 
emsg
);

2900 
rc
 = 
SOCKS_ADDR_UNSUPP
;

2905 i‡(
rc
 =
SOCKS_SUCCESS
) {

2906 
	`SASSERTX
(
io
.
§c
.
œddr
.
ss_Ámûy
 =
AF_INET


2907 || 
io
.
§c
.
œddr
.
ss_Ámûy
 =
AF_INET6
);

2913 i‡((
io
.
§c
.
s
 = 
	`sockë
(io.§c.
œddr
.
ss_Ámûy
, 
SOCK_DGRAM
, 0))

2915 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

2917 
	`°ªº‹
(
î∫o
));

2919 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

2921 
rc
 = 
SOCKS_FAILURE
;

2925 i‡(
rc
 !
SOCKS_SUCCESS
) {

2926 
	`iﬁog
(
	`IORULE
(&
io
),

2927 &
io
.
°©e
,

2928 
OPERATION_ERROR
,

2929 
§c
,

2930 
d°
,

2931 
NULL
,

2932 
NULL
,

2933 
emsg
,

2934 
msgÀn
);

2936 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
rc
);

2938 
	`˛o£_iodes¸ùt‹s
(&
io
);

2940 
io°©us
 = 
IO_IOERROR
;

2944 
	`SASSERTX
(
	`IPADDRISBOUND
(&
io
.
§c
.
œddr
));

2945 
	`SASSERTX
(
	`ßÁmûy_issuµ‹ãd
(
io
.
§c
.
œddr
.
ss_Ámûy
));

2947 
	`£tsock›ti⁄s
(
io
.
§c
.
s
, io.§c.
œddr
.
ss_Ámûy
, 
SOCK_DGRAM
, 1);

2949 
	`£tc⁄fsock›ti⁄s
(
io
.
§c
.
s
,

2950 
io
.
c⁄åﬁ
.
s
,

2951 
io
.
°©e
.
¥Ÿocﬁ
,

2953 
io
.
§uÀ
.
sockë›ti⁄c
,

2954 
io
.
§uÀ
.
sockë›ti⁄v
,

2955 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
,

2956 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
);

2958 #i‡
BAREFOOTD


2959 i‡((
rc
 = 
	`socks_böd
(
io
.
§c
.
s
, &io.§c.
œddr
, 1)) == 0)

2960 
rc
 = 
SOCKS_SUCCESS
;

2962 
rc
 = 
SOCKS_FAILURE
;

2976 i‡(
io
.
§uÀ
.
ud¥™ge
.
›
 =
ønge
)

2977 
åõ¶e·
 = 
	`MIN
(10,

2978 
	`¡ohs
(
io
.
§uÀ
.
ud¥™ge
.
íd
Ë-Çtohs(io.§uÀ.ud¥™ge.
°¨t
) + 1);

2980 
åõ¶e·
 = 1;

2983 i‡(
io
.
§uÀ
.
ud¥™ge
.
›
 =
ønge
) {

2984 
	`SET_SOCKADDRPORT
(&
io
.
§c
.
œddr
,

2985 
	`ht⁄s
(
	`¡ohs
(
io
.
§uÀ
.
ud¥™ge
.
°¨t
)

2986 + (
	`øndom
()

2987 % (
	`¡ohs
(
io
.
§uÀ
.
ud¥™ge
.
íd
)

2988 - 
	`¡ohs
(
io
.
§uÀ
.
ud¥™ge
.
°¨t
) + 1))));

2990 
	`¶og
(
LOG_DEBUG
,

2993 
fun˘i⁄
,

2994 
	`¡ohs
(
io
.
§uÀ
.
ud¥™ge
.
°¨t
),

2995 
	`¡ohs
(
io
.
§uÀ
.
ud¥™ge
.
íd
),

2996 
	`¡ohs
(
	`GET_SOCKADDRPORT
(&
io
.
§c
.
œddr
)));

2999 
	`SET_SOCKADDRPORT
(&
io
.
§c
.
œddr
, 
	`ht⁄s
(0));

3001 
rc
 = 
	`socks_böd
(
io
.
§c
.
s
, &io.§c.
œddr
, 0);

3002 } 
rc
 =-1 && (
î∫o
 =
EADDRINUSE
 || 
	`ERRNOISACCES
(errno))

3003 && 
io
.
§uÀ
.
ud¥™ge
.
›
 =
ønge
 && --
åõ¶e·
 > 0);

3005 i‡(
rc
 == 0)

3006 
rc
 = 
SOCKS_SUCCESS
;

3008 
rc
 = 
SOCKS_FAILURE
;

3011 i‡(
rc
 !
SOCKS_SUCCESS
) {

3012 i‡(
io
.
§uÀ
.
ud¥™ge
.
›
 !
n⁄e
) {

3017 
	`¶og
(
LOG_DEBUG
,

3020 
fun˘i⁄
,

3021 
	`¡ohs
(
io
.
§uÀ
.
ud¥™ge
.
°¨t
),

3022 
	`¡ohs
(
io
.
§uÀ
.
ud¥™ge
.
íd
));

3024 
rc
 = 
	`socks_bödöønge
(
io
.
§c
.
s
,

3025 &
io
.
§c
.
œddr
,

3026 
io
.
§uÀ
.
ud¥™ge
.
°¨t
,

3027 
io
.
§uÀ
.
ud¥™ge
.
íd
,

3028 
io
.
§uÀ
.
ud¥™ge
.
›
);

3029 i‡(
rc
 != 0) {

3030 
rc
 = 
SOCKS_FAILURE
;

3031 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "no freeÖorts inÑangeÅo bind");

3035 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot bindÜocaláddress %s: %s",

3036 
	`sockaddr2°rög
(&
io
.
§c
.
œddr
, 
°rho°
, (strhost)),

3037 
	`°ªº‹
(
î∫o
));

3040 i‡(
rc
 !
SOCKS_SUCCESS
) {

3041 
	`iﬁog
(
	`IORULE
(&
io
),

3042 &
io
.
°©e
,

3043 
OPERATION_ERROR
,

3044 
§c
,

3045 
d°
,

3046 
NULL
,

3047 
NULL
,

3048 
emsg
,

3049 
	`°æí
(
emsg
));

3051 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
rc
);

3052 
	`˛o£_iodes¸ùt‹s
(&
io
);

3054 
io°©us
 = 
IO_IOERROR
;

3059 i‡(
	`ADDRISBOUND
(&
io
.
§c
.
øddr
)) {

3064 
	`¶og
(
LOG_DEBUG
, "%s: connectingÅo udp clientátáddress %s",

3065 
fun˘i⁄
, 
	`sockaddr2°rög
(&
io
.
§c
.
øddr
, 
NULL
, 0));

3067 i‡(
	`socks_c⁄√˘ho°
(
io
.
§c
.
s
,

3068 
INTERNALIF
,

3069 
	`sockaddr2socksho°
(&
io
.
§c
.
øddr
, 
NULL
),

3070 
NULL
,

3071 
NULL
,

3073 
emsg
,

3074 
emsgÀn
) != 0) {

3075 
	`iﬁog
(
	`IORULE
(&
io
),

3076 &
io
.
°©e
,

3077 
OPERATION_ERROR
,

3078 
§c
,

3079 
d°
,

3080 
NULL
,

3081 
NULL
,

3082 
emsg
,

3083 
	`°æí
(
emsg
));

3085 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
SOCKS_HOSTUNREACH
);

3087 
	`˛o£_iodes¸ùt‹s
(&
io
);

3089 
io°©us
 = 
IO_IOERROR
;

3093 
io
.
§c
.
°©e
.
isc⁄√˘ed
 = 1;

3096 
io
.
d°
.
°©e
.
isc⁄√˘ed
 = 0;

3098 
boundÀn
 = (
io
.
§c
.
œddr
);

3099 i‡(
	`gësock«me
(
io
.
§c
.
s
, 
	`TOSA
(&io.§c.
œddr
), &
boundÀn
) != 0) {

3100 
	`SWARN
(
î∫o
);

3102 
msgÀn
 = 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

3103 "gësock«me(ËÁûed: %s", 
	`°ªº‹
(
î∫o
));

3105 
	`iﬁog
(
	`IORULE
(&
io
),

3106 &
io
.
°©e
,

3107 
OPERATION_ERROR
,

3108 
§c
,

3109 
d°
,

3110 
NULL
,

3111 
NULL
,

3112 
emsg
,

3113 
msgÀn
);

3115 
	`£nd_Áûuª
(
ªque°
->
s
, &
ª•⁄£
, 
SOCKS_FAILURE
);

3116 
	`˛o£_iodes¸ùt‹s
(&
io
);

3118 
io°©us
 = 
IO_IOERROR
;

3122 
	`¶og
(
LOG_DEBUG
, "%s:áddress bound on client side for udp: %s",

3123 
fun˘i⁄
, 
	`sockaddr2°rög
(&
io
.
§c
.
œddr
, 
NULL
, 0));

3127 i‡(
ªque°
->
ªq
.
Êag
 & 
SOCKS_USECLIENTPORT


3128 && 
sockscf
.
com∑t
.
dø·_5_05
)

3129 i‡(
	`GET_SOCKADDRPORT
(&
io
.
§c
.
øddr
)

3130 =
	`GET_SOCKADDRPORT
(&
io
.
d°
.
œddr
))

3131 
ª•⁄£
.
Êag
 |
SOCKS_USECLIENTPORT
;

3133 
	`sockaddr2socksho°
(&
io
.
§c
.
œddr
, &
ª•⁄£
.
ho°
);

3135 i‡(
	`£nd_ª•⁄£
(
ªque°
->
s
, &
ª•⁄£
) == 0) {

3136 
io
.
ªqöfo
.
comm™d
 = (io.
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

3137 
SOCKD_FREESLOT_TCP
 : 
SOCKD_FREESLOT_UDP
);

3138 
	`Êushio
(
mŸhî
->
s
, &
io
);

3141 
	`˛o£_iodes¸ùt‹s
(&
io
);

3142 *
we˛o£dfú°
 = 0;

3143 
io°©us
 = 
IO_IOERROR
;

3151 
	`SERRX
(
io
.
°©e
.
comm™d
);

3154 
rc
 = 
î∫o
;

3155 
	`SASSERTX
(
	`˛o£
(
ªque°
->
s
) == -1);

3156 
î∫o
 = 
rc
;

3158  
io°©us
;

3159 
	}
}

3162 
	$ªqho°isok
(
ho°
, 
cmd
, 
emsg
, 
emsgÀn
)

3163 
socksho°_t
 *
ho°
;

3164 c⁄° 
cmd
;

3165 *
emsg
;

3166 c⁄° 
size_t
 
emsgÀn
;

3168 c⁄° *
fun˘i⁄
 = "reqhostisok()";

3169 
sockaddr_°‹age
 
addr
;

3170 
gaõº
, 
mu°havóddr
, 
mu°havï‹t
;

3172 
	`¶og
(
LOG_DEBUG
, "%s: host %s, command %s",

3173 
fun˘i⁄
, 
	`socksho°2°rög
(
ho°
, 
NULL
, 0), 
	`comm™d2°rög
(
cmd
));

3175 i‡(
ho°
->
©y≥
 =
SOCKS_ADDR_IPV6


3176 && 
	`IN6_IS_ADDR_V4MAPPED
(&
ho°
->
addr
.
ùv6
.
ù
)) {

3186 
socksho°_t
 
c⁄vîãdho°
;

3188 
c⁄vîãdho°
 = *
ho°
;

3189 
	`ùv4_m≠≥d_to_ªguœr
(&
ho°
->
addr
.
ùv6
.
ù
, &
c⁄vîãdho°
.addr.
ùv4
);

3191 
ho°
->
©y≥
 = 
SOCKS_ADDR_IPV4
;

3192 
ho°
->
addr
.
ùv4
 = 
c⁄vîãdho°
.addr.ipv4;

3195 
	`socksho°2sockaddr2
(
ho°
, &
addr
, &
gaõº
, 
emsg
, 
emsgÀn
);

3197 i‡(
ho°
->
©y≥
 =
SOCKS_ADDR_DOMAIN
) {

3198 i‡(
addr
.
ss_Ámûy
 =
AF_UNSPEC
) {

3199 i‡(
gaõº
 != 0)

3200 
	`log_ªsﬁveÁûed
(
ho°
->
addr
.
domaö
,

3201 
cmd
 =
SOCKS_UDPASSOCIATE
 ?

3202 
INTERNALIF
 : 
EXTERNALIF
,

3203 
gaõº
);

3205  
SOCKS_HOSTUNREACH
;

3208 
	`SASSERTX
(
gaõº
 == 0);

3210 
	`¶og
(
LOG_DEBUG
, "%s: hostname %s in %s-requestÑesolvedÅoáddress %s",

3211 
fun˘i⁄
,

3212 
	`socksho°2°rög
(
ho°
, 
NULL
, 0),

3213 
	`comm™d2°rög
(
cmd
),

3214 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

3217 
cmd
) {

3218 
SOCKS_BIND
:

3219 i‡(
ho°
->
©y≥
 =
SOCKS_ADDR_IPV4


3220 && 
ho°
->
addr
.
ùv4
.
s_addr
 =
	`ht⁄l
(
BINDEXTENSION_IPADDR
))

3225 
SOCKS_CONNECT
:

3226 i‡(
ho°
->
©y≥
 =
SOCKS_ADDR_IPV4


3227 || 
ho°
->
©y≥
 =
SOCKS_ADDR_IPV6
) {

3228 i‡(!
	`exã∫Æ_has_globÆ_ßÁmûy
(
	`©y≥2ßÁmûy
(
ho°
->
©y≥
))) {

3229 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

3232 
	`©y≥2°rög
(
ho°
->
©y≥
),

3233 
	`©y≥2°rög
(
ho°
->
©y≥
));

3235  
SOCKS_ADDR_UNSUPP
;

3241 
SOCKS_UDPASSOCIATE
:

3242 i‡(
ho°
->
©y≥
 =
SOCKS_ADDR_IPV4


3243 || 
ho°
->
©y≥
 =
SOCKS_ADDR_IPV6
) {

3244 i‡(!
	`öã∫Æ_has_ßÁmûy
(
	`©y≥2ßÁmûy
(
ho°
->
©y≥
))) {

3256 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

3259 
	`©y≥2°rög
(
ho°
->
©y≥
),

3260 
	`©y≥2°rög
(
ho°
->
©y≥
));

3262 
	`¶og
(
LOG_DEBUG
, "%s: %s", 
fun˘i⁄
, 
emsg
);

3264 i‡(
	`SOCKSHOST_ADDRISBOUND
(
ho°
))

3265  
SOCKS_ADDR_UNSUPP
;

3272 
	`SERRX
(
cmd
);

3275 
cmd
) {

3276 
SOCKS_BIND
:

3277 
mu°havóddr
 = 0;

3278 
mu°havï‹t
 = 0;

3281 
SOCKS_CONNECT
:

3282 
mu°havóddr
 = 1;

3283 
mu°havï‹t
 = 1;

3286 
SOCKS_UDPASSOCIATE
:

3287 
mu°havóddr
 = 0;

3288 
mu°havï‹t
 = 0;

3292 
	`SERRX
(
cmd
);

3295 i‡(
mu°havóddr
 && !
	`IPADDRISBOUND
(&
addr
)) {

3296 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "unbound ipaddress (%s) inÑequest",

3297 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

3299  
SOCKS_ADDR_UNSUPP
;

3302 i‡(
mu°havï‹t
 && 
	`GET_SOCKADDRPORT
(&
addr
Ë=
	`ht⁄s
(0)) {

3303 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "unboundÖort (%s) inÑequest",

3304 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

3306  
SOCKS_ADDR_UNSUPP
;

3312 
cmd
) {

3313 
SOCKS_CONNECT
:

3314 i‡(
	`addrödex_⁄_li°íli°
(
sockscf
.
öã∫Æ
.
addrc
,

3315 
sockscf
.
öã∫Æ
.
addrv
,

3316 &
addr
,

3317 
SOCKS_TCP
 )

3319 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

3326 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

3328  
SOCKS_NOTALLOWED
;

3332 
SOCKS_UDPASSOCIATE
: {

3346 
is⁄öã∫Æ
 = 0, 
is⁄exã∫Æ
 = 0;

3349 
	`SET_SOCKADDRPORT
(&
addr
, 
	`ht⁄s
(0));

3351 i‡(
	`addrödex_⁄_li°íli°
(
sockscf
.
öã∫Æ
.
addrc
,

3352 
sockscf
.
öã∫Æ
.
addrv
,

3353 &
addr
,

3354 
SOCKS_TCP
 ) != -1)

3355 
is⁄öã∫Æ
 = 1;

3356 i‡(
	`addrödex_⁄_exã∫Æli°
(&
sockscf
.
exã∫Æ
, &
addr
) != -1)

3357 
is⁄exã∫Æ
 = 1;

3359 i‡(
is⁄öã∫Æ
 || 
is⁄exã∫Æ
) {

3393 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

3397 
is⁄öã∫Æ
 ? "internal" : "external",

3398 
	`sockaddr2°rög
(&
addr
, 
NULL
, 0));

3400  
SOCKS_NOTALLOWED
;

3411  
SOCKS_SUCCESS
;

3412 
	}
}

3416 
	$Êushio
(
mŸhî
, 
io
)

3417 
mŸhî
;

3418 
sockd_io_t
 *
io
;

3420 c⁄° *
fun˘i⁄
 = "flushio()";

3421 
dﬁog
;

3423 
	`SASSERTX
(
io
->
Æloˇãd
 == 0);

3425 
io
->
°©e
.
comm™d
) {

3426 
SOCKS_CONNECT
:

3427 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 == -1);

3429 
	`SASSERTX
(
io
->
§c
.
°©e
.
isc⁄√˘ed
);

3430 
	`SASSERTX
(
io
->
§c
.
s
 != -1);

3431 
	`SASSERTX
(
io
->
d°
.
s
 != -1);

3434 
SOCKS_BINDREPLY
:

3435 i‡(
io
->
°©e
.
exãnsi⁄
.
böd
)

3436 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 != -1);

3438 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 == -1);

3440 
	`SASSERTX
(
io
->
§c
.
s
 != -1);

3441 
	`SASSERTX
(
io
->
d°
.
s
 != -1);

3443 
	`SASSERTX
(
io
->
§c
.
°©e
.
isc⁄√˘ed
);

3444 
	`SASSERTX
(
io
->
d°
.
°©e
.
isc⁄√˘ed
);

3447 
SOCKS_UDPASSOCIATE
:

3448 
	`SASSERTX
(!
io
->
d°
.
°©e
.
isc⁄√˘ed
);

3449 
	`SASSERTX
(
io
->
d°
.
s
 == -1);

3451 #i‡
HAVE_CONTROL_CONNECTION


3452 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 != -1);

3453 
	`SASSERTX
(
io
->
c⁄åﬁ
.
°©e
.
isc⁄√˘ed
);

3455 
	`SASSERTX
(
io
->
§c
.
s
 != -1);

3458 
	`SASSERTX
(
io
->
c⁄åﬁ
.
s
 == -1);

3465 
	`SERRX
(
io
->
°©e
.
comm™d
);

3468 #i‡
HAVE_GSSAPI


3469 i‡(
	`CONTROLIO
(
io
)->
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
) {

3470 
OM_uöt32
 
mö‹_°©us
, 
maj‹_°©us
, 
maxÀn
;

3471 
emsg
[1024];

3473 
maj‹_°©us


3474 
	`gss_wøp_size_limô
(&
mö‹_°©us
,

3475 
	`CONTROLIO
(
io
)->
auth
.
md©a
.
gsßpi
.
°©e
.
id
,

3476 
	`CONTROLIO
(
io
)->
auth
.
md©a
.
gsßpi
.
°©e
.
¥Ÿe˘i⁄


3477 =
GSSAPI_CONFIDENTIALITY
 ?

3478 
GSS_REQ_CONF
 : 
GSS_REQ_INT
,

3479 
GSS_C_QOP_DEFAULT
,

3480 (
OM_uöt32
)(
MAXGSSAPITOKENLEN
 - 
GSSAPI_HLEN
),

3481 &
maxÀn
);

3483 i‡(
	`gss_îr_is£t
(
maj‹_°©us
, 
mö‹_°©us
, 
emsg
, (emsg)))

3484 
	`£ºx
("%s: gss_wøp_size_limô(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

3486 i‡(
maxÀn
 == 0)

3487 
	`£ºx
("%s: foráÅoken ofÜength %d, gss_wrap_size_limit()Ñeturned "

3490 
fun˘i⁄
, 
MAXGSSAPITOKENLEN
 - 
GSSAPI_HLEN
, 
maxÀn
);

3492 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

3493 
	`¶og
(
LOG_DEBUG
, "%s: gss_wrap_size_limit() for fd %d is %lu",

3494 
fun˘i⁄
, 
	`CONTROLIO
(
io
)->
s
, ()
maxÀn
);

3496 
	`CONTROLIO
(
io
)->
auth
.
md©a
.
gsßpi
.
°©e
.
maxgssd©a
 = 
maxÀn
;

3498 i‡(
io
->
§c
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
)

3499 
io
->
§c
.
auth
.
md©a
.
gsßpi
.
°©e
.
maxgssd©a
 = 
maxÀn
;

3501 i‡(
io
->
d°
.
auth
.
mëhod
 =
AUTHMETHOD_GSSAPI
)

3502 
io
->
d°
.
auth
.
md©a
.
gsßpi
.
°©e
.
maxgssd©a
 = 
maxÀn
;

3506 i‡(
io
->
°©e
.
comm™d
 =
SOCKS_CONNECT
) {

3513 
size_t
 
i
;

3515 
i
 = 0; i < 
io
->
§uÀ
.
sockë›ti⁄c
; ++i) {

3516 i‡(!
io
->
§uÀ
.
sockë›ti⁄v
[
i
].
isöã∫Æside


3517 && (
io
->
§uÀ
.
sockë›ti⁄v
[
i
].
öfo
 =
NULL


3518 || 
io
->
§uÀ
.
sockë›ti⁄v
[
i
].
öfo
->
ˇŒty≥
 =
po°⁄ly
)) {

3519 i‡(
io
->
§uÀ
.
sockë›ti⁄c
 >
	`ELEMENTS
(io->
extsockë›ti⁄v
)) {

3520 
	`sw¨nx
("%s: one or more socket options from socks-rule #%lu "

3524 
fun˘i⁄
,

3525 ()
io
->
§uÀ
.
numbî
,

3526 
io
->
d°
.
s
,

3527 ()
	`ELEMENTS
(
io
->
extsockë›ti⁄v
));

3532 
io
->
extsockë›ti⁄v
[io->
extsockë›ti⁄c
++]

3533 
io
->
§uÀ
.
sockë›ti⁄v
[
i
];

3538 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
io
->
°©e
.
time
.
ªque°íd
);

3540 i‡(
io
->
°©e
.
comm™d
 =
SOCKS_CONNECT


3541 && 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
)

3544 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
io
->
°©e
.
time
.
e°ablished
);

3547 
	`SASSERTX
(
io
->
¸uÀ
.
bw
 =
NULL
);

3548 
	`SASSERTX
(
io
->
¸uÀ
.
ss
 =
NULL
);

3549 
	`SASSERTX
(
io
->
§uÀ
.
bw
 =
NULL
);

3550 
	`SASSERTX
(
io
->
§uÀ
.
ss
 =
NULL
);

3552 
	`¶og
(
LOG_DEBUG
,

3554 
fun˘i⁄
, 
io
->
c⁄åﬁ
.
s
, io->
§c
.s, io->
d°
.s);

3556 i‡(
io
->
°©e
.
comm™d
 =
SOCKS_UDPASSOCIATE
)

3557 #i‡
BAREFOOTD


3558 
dﬁog
 = 0;

3560 
dﬁog
 = 1;

3563 i‡(
io
->
§c
.
°©e
.
isc⁄√˘ed
 && io->
d°
.state.isconnected)

3564 
dﬁog
 = 1;

3566 
dﬁog
 = 0;

3568 i‡(
dﬁog
) {

3569 
iﬁogaddr_t
 
§c
, 
d°
, 
¥oxy
;

3571 i‡(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP


3572 && 
io
->
§uÀ
.
log
.
t˝öfo


3573 && 
io
->
d°
.
°©e
.
isc⁄√˘ed
) {

3574 
fdv
[] = { 
	`CLIENTIO
(
io
)->
s
, 
	`EXTERNALIO
(io)->s };

3576 
io
->
°©e
.
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

3579 
	`öôlogaddrs
(
io
,

3580 &
§c
,

3581 
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ? &
d°
 : 
NULL
,

3582 &
¥oxy
);

3584 
	`iﬁog
(&
io
->
§uÀ
,

3585 &
io
->
°©e
,

3586 
OPERATION_CONNECT
,

3587 &
§c
,

3588 
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ? &
d°
 : 
NULL
,

3589 
NULL
,

3590 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
 ? 
NULL
 : &
¥oxy
,

3591 
NULL
,

3594 
io
->
°©e
.
t˝öfo
 = 
NULL
;

3597 i‡(
	`£nd_io
(
mŸhî
, 
io
) != 0) {

3598 #i‡
HAVE_NEGOTIATE_PHASE


3599 
ª•⁄£_t
 
ª•⁄£
;

3601 
iﬁogaddr_t
 
§c
, 
d°
, 
¥oxy
;

3603 i‡(
	`sockd_mŸhîexi°s
())

3604 
	`sw¨n
("%s: sending io object withÜocal client %sÅo mother failed",

3605 
fun˘i⁄
,

3606 
	`sockaddr2°rög
(&
	`CONTROLIO
(
io
)->
øddr
, 
NULL
, 0));

3608 #i‡
HAVE_NEGOTIATE_PHASE


3609 i‡(
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
) {

3610 
	`¸óã_ª•⁄£
(
NULL
,

3611 &
	`CONTROLIO
(
io
)->
auth
,

3612 
io
->
°©e
.
¥oxy¥Ÿocﬁ
,

3613 ()
	`î∫o2ª∂y
(
î∫o
, 
io
->
°©e
.
¥oxy¥Ÿocﬁ
),

3614 &
ª•⁄£
);

3616 i‡(
	`£nd_ª•⁄£
(
	`CONTROLIO
(
io
)->
s
, &
ª•⁄£
) != 0) {

3617 
	`¶og
(
LOG_DEBUG
,

3619 
fun˘i⁄
,

3620 
	`socksho°2°rög
(&
	`CONTROLIO
(
io
)->
ho°
, 
NULL
, 0),

3621 
	`CONTROLIO
(
io
)->
s
,

3622 
	`°ªº‹
(
î∫o
));

3628 
	`öôlogaddrs
(
io
,

3629 &
§c
,

3630 
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ? &
d°
 : 
NULL
,

3631 &
¥oxy
);

3633 
	`iﬁog
(&
io
->
§uÀ
,

3634 &
io
->
°©e
,

3635 
OPERATION_ERROR
,

3636 &
§c
,

3637 
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ? &
d°
 : 
NULL
,

3638 
NULL
,

3639 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
 ? 
NULL
 : &
¥oxy
,

3640 
NULL
,

3644 
	`˛o£_iodes¸ùt‹s
(
io
);

3645 
	}
}

3648 
	$¥o˘ôÀupd©e
(
‰om
)

3649 c⁄° 
sockaddr_°‹age
 *
‰om
;

3651 
	`£çro˘ôÀ
("%s: %s",

3652 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
),

3653 
‰om
 =
NULL
 ? "0/1" : "1/1");

3654 
	}
}

3656 
rouã_t
 *

3657 
	$gërouã
(
˛õ¡
, 
ªq
, 
emsg
, 
emsgÀn
)

3658 c⁄° 
sockaddr_°‹age
 *
˛õ¡
;

3659 
ªque°_t
 *
ªq
;

3660 *
emsg
;

3661 c⁄° 
size_t
 
emsgÀn
;

3663 c⁄° *
fun˘i⁄
 = "getroute()";

3664 c⁄° 
‹igöÆªqvîsi⁄
 = 
ªq
->
vîsi⁄
;

3665 
rouã_t
 
rouãmem
;

3666 
authmëhod_t
 
auth
;

3667 
rouã_t
 *
rouã
;

3669 
	`¶og
(
LOG_DEBUG
, "%s:Ñequest: %s,áuthmethod %d",

3670 
fun˘i⁄
, 
	`socks_∑ckë2°rög
(
ªq
, 1),Ñeq->
auth
->
mëhod
);

3672 
	`bzîo
(&
rouãmem
, (routemem));

3674 i‡(
sockscf
.
rouã
 =
NULL
) {

3675 
	`¶og
(
LOG_DEBUG
, "%s:Çÿrouãs, fakög dúe˘Ñouã", 
fun˘i⁄
);

3677 
rouãmem
.
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
 = 1;

3678  &
rouãmem
;

3690 
	`auth2°™d¨d
(
ªq
->
auth
, &auth);

3691 *
ªq
->
auth
 =áuth;

3693 
ªq
->
comm™d
) {

3694 
SOCKS_BIND
:

3695 
SOCKS_CONNECT
:

3698 
SOCKS_UDPASSOCIATE
:

3705 
	`bzîo
(&
ªq
->
ho°
.
addr
, (req->host.addr));

3706 
ªq
->
ho°
.
p‹t
 = 
	`ht⁄s
(0);

3708 
ªq
->
ho°
.
©y≥
) {

3709 
SOCKS_ADDR_IPV4
:

3710 
SOCKS_ADDR_IPV6
:

3713 
SOCKS_ADDR_DOMAIN
:

3714 
ªq
->
ho°
.
©y≥
 = 
SOCKS_ADDR_IPV4
;

3718 
	`SERRX
(
ªq
->
ho°
.
©y≥
);

3723 
	`SERRX
(
ªq
->
comm™d
);

3727 
ªq
->
vîsi⁄
 = 
PROXY_DIRECT
;

3729 
rouã
 = 
	`socks_ªque°pﬁish
(
ªq
,

3730 
	`sockaddr2socksho°
(
˛õ¡
, 
NULL
),

3731 &
ªq
->
ho°
);

3732 i‡(
rouã
 =
NULL
) {

3733 i‡(
ªq
->
comm™d
 =
SOCKS_CONNECT


3734 && 
ªq
->
ho°
.
©y≥
 =
SOCKS_ADDR_DOMAIN
) {

3746 
sockaddr_°‹age
 
ßddr
;

3747 
gaõº
;

3749 
	`¶og
(
LOG_DEBUG
,

3752 
fun˘i⁄
, 
	`socksho°2°rög
(&
ªq
->
ho°
, 
NULL
, 0));

3754 
	`socksho°2sockaddr2
(&
ªq
->
ho°
, &
ßddr
, &
gaõº
, 
emsg
, 
emsgÀn
);

3756 i‡(
gaõº
 != 0) {

3757 
	`log_ªsﬁveÁûed
(
ªq
->
ho°
.
addr
.
domaö
, 
EXTERNALIF
, 
gaõº
);

3758  
NULL
;

3766 
	`sockaddr2socksho°
(&
ßddr
, &
ªq
->
ho°
);

3768 i‡(
ªq
->
vîsi⁄
 =
PROXY_SOCKS_V4


3769 && 
ßddr
.
ss_Ámûy
 !
AF_INET
)

3773 
ªq
->
vîsi⁄
 = 
PROXY_SOCKS_V5
;

3775 
ªq
->
vîsi⁄
 = 
‹igöÆªqvîsi⁄
;

3777  
	`gërouã
(
˛õ¡
, 
ªq
, 
emsg
, 
emsgÀn
);

3780 i‡(
ªq
->
comm™d
 !
SOCKS_CONNECT
)

3781 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

3784 
	`comm™d2°rög
(
ªq
->
comm™d
));

3786 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

3789  
NULL
;

3793 
	`SASSERTX
(
rouã
 !
NULL
);

3794 
rouãmem
 = *
rouã
;

3796  &
rouãmem
;

3797 
	}
}

3800 
	$£rvîchaö
(
èrgësockë
, 
˛õ¡sockë
, 
˛õ¡
, 
ªq
,

3801 
¥oxychaö
, 
¥oxychaöauth
, 
emsg
, 
emsgÀn
)

3802 c⁄° 
èrgësockë
;

3803 c⁄° 
˛õ¡sockë
;

3804 c⁄° 
sockaddr_°‹age
 *
˛õ¡
;

3805 c⁄° 
ªque°_t
 *
ªq
;

3806 
¥oxychaööfo_t
 *
¥oxychaö
;

3807 
authmëhod_t
 *
¥oxychaöauth
;

3808 *
emsg
;

3809 
size_t
 
emsgÀn
;

3811 c⁄° *
fun˘i⁄
 = "serverchain()";

3812 
ª•⁄£_t
 
ª•⁄£
;

3813 
rouã_t
 *
rouã
;

3814 
socks_t
 
∑ckë
;

3815 
Àmsg
[512];

3816 
rc
, 
Êags
;

3818 
	`¶og
(
LOG_DEBUG
, "%s: client %s,áuth %s,Ñequest %s",

3819 
fun˘i⁄
,

3820 
	`sockaddr2°rög
(
˛õ¡
, 
NULL
, 0),

3821 
	`mëhod2°rög
(
ªq
->
auth
->
mëhod
),

3822 
	`socks_∑ckë2°rög
(
ªq
, 1));

3824 
	`bzîo
(&
∑ckë
, (packet));

3825 
∑ckë
.
°©e
.
auth
 = *
ªq
->auth;

3826 
∑ckë
.
ªq
 = *req;

3828 
∑ckë
.
ªq
.
auth
 = &∑ckë.
°©e
.auth;

3829 
∑ckë
.
ªs
.
auth
 = &∑ckë.
°©e
.auth;

3831 i‡((
rouã
 = 
	`gërouã
(
˛õ¡
, &
∑ckë
.
ªq
, 
emsg
, 
emsgÀn
)Ë=
NULL
)

3834 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
) {

3835 
	`¶og
(
LOG_DEBUG
, "%s: using direct system calls for fd %d",

3836 
fun˘i⁄
, 
èrgësockë
);

3838 
¥oxychaö
->
¥oxy¥Ÿocﬁ
 = 
PROXY_DIRECT
;

3842 i‡(
	`socks_rouã£tup
(
èrgësockë
,Å¨gësockë, 
rouã
, 
emsg
, 
emsgÀn
) != 0){

3843 
	`sw¨nx
("%s: socks_rouã£tup(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

3847 i‡((
rouã
 = 
	`socks_c⁄√˘rouã
(
èrgësockë
,

3848 &
∑ckë
,

3849 
	`sockaddr2socksho°
(
˛õ¡
, 
NULL
),

3850 &
∑ckë
.
ªq
.
ho°
,

3851 
Àmsg
,

3852 (
Àmsg
))Ë=
NULL
) {

3853 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

3854 "couldÇŸ c⁄√˘Åÿup°ªamÖroxy£rvî: %s", 
Àmsg
);

3859 
¥oxychaö
->
¥oxy¥Ÿocﬁ
 = 
∑ckë
.
ªq
.
vîsi⁄
;

3865 i‡((
Êags
 = 
	`£tblockög
(
èrgësockë
, "server-chaining")) == -1)

3873 
	`SASSERTX
(
	`socks_gëbuf„r
(
èrgësockë
Ë=
NULL
);

3875 
	`socks_Ælocbuf„r
(
èrgësockë
, 
SOCK_STREAM
);

3877 
rc
 = 
	`socks_√gŸüã
(
èrgësockë
,

3878 
èrgësockë
,

3879 &
∑ckë
,

3880 
rouã
,

3881 
emsg
,

3882 
emsgÀn
);

3884 
	`socks_‰ìbuf„r
(
èrgësockë
);

3886 i‡(
	`f˙é
(
èrgësockë
, 
F_SETFL
, 
Êags
) == -1)

3887 
	`sw¨n
("%s: fcntl(2) failedÅoÑestore flags on fd %dÅo %d",

3888 
fun˘i⁄
, 
èrgësockë
, 
Êags
);

3890 i‡(
rc
 != 0) {

3891 
	`¶og
(
LOG_DEBUG
, "%s: socks_negotiate() failed: %s",

3892 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

3898 
¥oxychaö
->
¥oxy¥Ÿocﬁ
 = ()
∑ckë
.
ªq
.
vîsi⁄
;

3900 
∑ckë
.
ªq
.
comm™d
) {

3901 
SOCKS_CONNECT
:

3902 
¥oxychaö
->
exèddr
 = 
∑ckë
.
ªs
.
ho°
;

3906 
	`SERRX
(
∑ckë
.
ªq
.
comm™d
);

3909 *
¥oxychaöauth
 = *
∑ckë
.
ªq
.
auth
;

3911 
	`c⁄vîåe•⁄£
(&
∑ckë
.
ªs
, &
ª•⁄£
, 
ªq
->
vîsi⁄
);

3912 
ª•⁄£
.
auth
 = 
ªq
->auth;

3914 i‡(
	`£nd_ª•⁄£
(
˛õ¡sockë
, &
ª•⁄£
) != 0)

3917 
	`¶og
(
LOG_DEBUG
,

3920 
fun˘i⁄
,

3921 
	`socksho°2°rög
(&
¥oxychaö
->
exèddr
, 
NULL
, 0),

3922 
	`mëhod2°rög
(
¥oxychaöauth
->
mëhod
),

3923 
	`mëhod2°rög
(
ª•⁄£
.
auth
->
mëhod
));

3927 
	}
}

3930 
	$c⁄vîåe•⁄£
(
ﬁdªs
, 
√wªs
, 
√wvîsi⁄
)

3931 c⁄° 
ª•⁄£_t
 *
ﬁdªs
;

3932 
ª•⁄£_t
 *
√wªs
;

3933 c⁄° 
√wvîsi⁄
;

3935 c⁄° *
fun˘i⁄
 = "convertresponse()";

3936 
gíîi¸ïly
;

3938 i‡(
ﬁdªs
->
vîsi⁄
 =
√wvîsi⁄


3939 || ( 
√wvîsi⁄
 =
PROXY_SOCKS_V4


3940 && 
ﬁdªs
->
vîsi⁄
 =
PROXY_SOCKS_V4REPLY_VERSION
)) {

3941 *
√wªs
 = *
ﬁdªs
;

3950 
ﬁdªs
->
vîsi⁄
) {

3951 
PROXY_HTTP_10
:

3952 
PROXY_HTTP_11
:

3953 
ﬁdªs
->
ª∂y
.
hâp
) {

3954 
HTTP_SUCCESS
:

3955 
gíîi¸ïly
 = 
SOCKS_SUCCESS
;

3958 
HTTP_NOTALLOWED
:

3959 
HTTP_FORBIDDEN
:

3960 
HTTP_PROXYAUTHREQUIRED
:

3961 
gíîi¸ïly
 = 
SOCKS_NOTALLOWED
;

3964 
HTTP_HOSTUNREACH
:

3965 
gíîi¸ïly
 = 
SOCKS_HOSTUNREACH
;

3969 
gíîi¸ïly
 = 
SOCKS_FAILURE
;

3974 
PROXY_UPNP
:

3975 
ﬁdªs
->
ª∂y
.
u≤p
) {

3976 
UPNP_SUCCESS
:

3977 
gíîi¸ïly
 = 
SOCKS_SUCCESS
;

3981 
gíîi¸ïly
 = 
SOCKS_FAILURE
;

3986 
PROXY_SOCKS_V4REPLY_VERSION
:

3987 
ﬁdªs
->
ª∂y
.
socks
) {

3988 
SOCKSV4_SUCCESS
:

3989 
gíîi¸ïly
 = 
SOCKS_SUCCESS
;

3992 
SOCKSV4_NO_IDENTD
:

3993 
SOCKSV4_BAD_ID
:

3994 
gíîi¸ïly
 = 
SOCKS_NOTALLOWED
;

3998 
gíîi¸ïly
 = 
SOCKS_FAILURE
;

4003 
PROXY_SOCKS_V5
:

4004 
gíîi¸ïly
 = 
ﬁdªs
->
ª∂y
.
socks
;

4008 
	`sw¨nx
("%s: unknow¿¥oxyÖrŸocﬁ: %d", 
fun˘i⁄
, 
ﬁdªs
->
vîsi⁄
);

4009 
gíîi¸ïly
 = 
SOCKS_FAILURE
;

4012 
√wvîsi⁄
) {

4013 
PROXY_SOCKS_V4
:

4014 i‡(
ﬁdªs
->
ho°
.
©y≥
 =
SOCKS_ADDR_IPV4
)

4015 
√wªs
->
ho°
 = 
ﬁdªs
->host;

4021 
sockaddr_°‹age
 
addr
;

4023 
	`socksho°2sockaddr
(&
ﬁdªs
->
ho°
, &
addr
);

4024 i‡(
	`IPADDRISBOUND
(&
addr
))

4025 
	`sockaddr2socksho°
(&
addr
, &
√wªs
->
ho°
);

4027 
	`sw¨nx
("%s: canÇotÑesolve hostname %s",

4028 
fun˘i⁄
, 
	`socksho°2°rög
(&
ﬁdªs
->
ho°
, 
NULL
, 0));

4030 
gíîi¸ïly
 = 
SOCKS_FAILURE
;

4034 
√wªs
->
vîsi⁄
 = 
PROXY_SOCKS_V4REPLY_VERSION
;

4037 
PROXY_SOCKS_V5
:

4042 
√wªs
->
Êag
 = 0;

4044 
√wªs
->
ho°
 = 
ﬁdªs
->host;

4045 
√wªs
->
vîsi⁄
 = 
√wvîsi⁄
;

4049 
	`SERRX
(
√wvîsi⁄
);

4052 
	`socks_£t_ª•⁄£vÆue
(
√wªs
, 
	`sockscode
(
√wvîsi⁄
, 
gíîi¸ïly
));

4054 
	`¶og
(
LOG_DEBUG
,

4057 
fun˘i⁄
,

4058 
ﬁdªs
->
vîsi⁄
,

4059 
√wªs
->
vîsi⁄
,

4060 
	`socks_gë_ª•⁄£vÆue
(
ﬁdªs
),

4061 
	`socks_gë_ª•⁄£vÆue
(
√wªs
));

4062 
	}
}

4065 
	$öô_ªq
(
ªq
, 
ªque°
)

4066 
ªq
 *req;

4067 c⁄° 
sockd_ªque°_t
 *
ªque°
;

4070 
ªq
->
°¨âime
 = 
	`time_m⁄Ÿ⁄ic
(
NULL
);

4072 
ªq
->
¸uÀ
 = 
ªque°
->crule;

4073 #i‡
HAVE_SOCKS_HOSTID


4074 
ªq
->
hruÀ
 = 
ªque°
->hrule;

4075 
ªq
->
hruÀ_is£t
 = 
ªque°
->hrule_isset;

4078 
ªq
->
˛õ¡
 = 
ªque°
->
‰om
;

4079 
ªq
->
ªque°_isvÆid
 = 1;

4080 
ªq
->
ªque°
 =Ñequest->req;

4081 
ªq
->
s
 = 
ªque°
->s;

4083 #i‡
HAVE_NEGOTIATE_PHASE


4084 
	`socks_Ælocbuf„r
(
ªq
->
s
, 
SOCK_STREAM
);

4087 
ªq
->
Æloˇãd
 = 1;

4088 
	}
}

4091 
	$dñëe_ªq
(
ªq
)

4092 
ªq
 *req;

4095 #i‡
HAVE_NEGOTIATE_PHASE


4096 
	`socks_‰ìbuf„r
(
ªq
->
s
);

4099 
ªq
->
Æloˇãd
 =Ñeq->
ªque°_isvÆid
 = 0;

4100 
	}
}

4104 
	$sigöfo
(
sig
, 
si
, 
sc
)

4105 
sig
;

4106 
sigöfo_t
 *
si
;

4107 *
sc
;

4109 c⁄° *
fun˘i⁄
 = "siginfo()";

4110 c⁄° 
î∫o_s
 = 
î∫o
;

4111 
time_t
 
äow
;

4112 
days
, 
hours
, 
möuãs
, 
£c⁄ds
;

4113 
size_t
 
i
;

4115 
	`SIGNAL_PROLOGUE
(
sig
, 
si
, 
î∫o_s
);

4117 
£c⁄ds
 = ()
	`socks_dif·ime
(
	`time_m⁄Ÿ⁄ic
(&
äow
),

4118 
sockscf
.
°©
.
boŸ
);

4120 
	`£c⁄ds2days
(&
£c⁄ds
, &
days
, &
hours
, &
möuãs
);

4122 
	`¶og
(
LOG_INFO
, "request-child up %lu day%s, %lu:%.2lu:%.2lu",

4123 
days
, day†=1 ? "" : "s", 
hours
, 
möuãs
, 
£c⁄ds
);

4125 
i
 = 0; i < 
ªqc
; ++i) {

4126 *
t˝öfo
, 
ªqöfo
[64];

4128 i‡(!
ªqv
[
i
].
Æloˇãd
)

4131 i‡(
	`CRULE_OR_HRULE
(&
ªqv
[
i
])->
log
.
t˝öfo
) {

4132 
fdv
[] = { 
ªqv
[
i
].
s
 };

4134 
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

4137 
t˝öfo
 = 
NULL
;

4139 i‡(
ªqv
[
i
].
ªque°_isvÆid
)

4140 
	`¢¥ötf
(
ªqöfo
, (reqinfo),

4142 
	`¥Ÿocﬁ2°rög
(
ªqv
[
i
].
ªque°
.
¥Ÿocﬁ
),

4143 
	`comm™d2°rög
(
ªqv
[
i
].
ªque°
.
comm™d
));

4145 
	`¢¥ötf
(
ªqöfo
, (reqinfo), "request");

4147 
	`¶og
(
LOG_INFO
,

4150 
	`sockaddr2°rög
(&
ªqv
[
i
].
˛õ¡
, 
NULL
, 0),

4151 
ªqöfo
,

4152 ()
	`socks_dif·ime
(
äow
, 
ªqv
[
i
].
°¨âime
),

4153 
t˝öfo
 =
NULL
 ? "" : "\n",

4154 
t˝öfo
 =
NULL
 ? "" : " TCP_INFO:\n",

4155 
t˝öfo
 =
NULL
 ? "" :Åcpinfo);

4158 
	`SIGNAL_EPILOGUE
(
sig
, 
si
, 
î∫o_s
);

4159 
	}
}

4162 
	$öôlogaddrs
(
io
, 
§c
, 
d°
, 
¥oxy
)

4163 c⁄° 
sockd_io_t
 *
io
;

4164 
iﬁogaddr_t
 *
§c
;

4165 
iﬁogaddr_t
 *
d°
;

4166 
iﬁogaddr_t
 *
¥oxy
;

4169 i‡(
§c
 !
NULL
)

4170 
	`öô_iﬁogaddr
(
§c
,

4171 
obje˘_sockaddr
,

4172 &
io
->
§c
.
œddr
,

4173 
obje˘_socksho°
,

4174 &
io
->
§c
.
ho°
,

4175 &
io
->
§c
.
auth
,

4176 
	`GET_HOSTIDV
(&
io
->
°©e
),

4177 
	`GET_HOSTIDC
(&
io
->
°©e
));

4179 i‡(
d°
 !
NULL
)

4180 
	`öô_iﬁogaddr
(
d°
,

4181 
obje˘_sockaddr
,

4182 &
io
->
d°
.
œddr
,

4183 
obje˘_socksho°
,

4184 &
io
->
d°
.
ho°
,

4185 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
 ?

4186 &
io
->
d°
.
auth
 : 
NULL
,

4187 
NULL
,

4190 i‡(
¥oxy
 !
NULL
 && 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 !
PROXY_DIRECT
)

4191 
	`öô_iﬁogaddr
(
¥oxy
,

4192 
obje˘_sockaddr
,

4193 &
io
->
d°
.
øddr
,

4194 
obje˘_socksho°
,

4195 &
io
->
°©e
.
¥oxychaö
.
exèddr
,

4196 &
io
->
d°
.
auth
,

4197 
NULL
,

4199 
	}
}

4202 
	$bödexã∫Æaddr
(
io
, 
_ªq
, 
emsg
, 
emsgÀn
)

4203 
sockd_io_t
 *
io
;

4204 c⁄° 
ªque°_t
 *
_ªq
;

4205 *
emsg
;

4206 c⁄° 
size_t
 
emsgÀn
;

4208 c⁄° *
fun˘i⁄
 = "bindexternaladdr()";

4209 c⁄° 
socksho°_t
 *
èrgë
;

4210 
ªque°_t
 
ªq
;

4211 
authmëhod_t
 
auth
;

4212 
rouã_t
 *
rouã
;

4213 
rc
;

4216 
	`¶og
(
LOG_DEBUG
, "%s:Ñequest: %s,áuthmethod %d",

4217 
fun˘i⁄
, 
	`socks_∑ckë2°rög
(
_ªq
, 1), _ªq->
auth
->
mëhod
);

4222 
auth
 = *
_ªq
->auth;

4223 
ªq
 = *
_ªq
;

4224 
ªq
.
auth
 = &auth;

4233 i‡((
rouã
 = 
	`gërouã
(&
io
->
§c
.
øddr
, &
ªq
, 
emsg
, 
emsgÀn
)Ë=
NULL
)

4236 i‡(
rouã
->
gw
.
°©e
.
¥oxy¥Ÿocﬁ
.
dúe˘
)

4237 
èrgë
 = &
ªq
.
ho°
;

4239 
èrgë
 = &
rouã
->
gw
.
addr
;

4244 i‡(
	`gëouèddr
(&
io
->
d°
.
œddr
,

4245 &
io
->
§c
.
œddr
,

4246 &
io
->
§c
.
øddr
,

4247 
ªq
.
comm™d
,

4248 
èrgë
,

4249 
emsg
,

4250 
emsgÀn
Ë=
NULL
)

4253 i‡(
	`PORTISRESERVED
(
	`GET_SOCKADDRPORT
(&
io
->
d°
.
œddr
))

4254 && !
sockscf
.
com∑t
.
ßmï‹t
) {

4255 
	`¶og
(
LOG_DEBUG
,

4258 
fun˘i⁄
, 
	`¡ohs
(
	`GET_SOCKADDRPORT
(&
io
->
d°
.
œddr
)));

4260 
	`SET_SOCKADDRPORT
(&
io
->
d°
.
œddr
, 
	`ht⁄s
(0));

4263 
io
->
d°
.
s
 = 
	`sockë
(io->d°.
œddr
.
ss_Ámûy
,

4264 
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
 ?

4265 
SOCK_STREAM
 : 
SOCK_DGRAM
,

4268 i‡(
io
->
d°
.
s
 == -1) {

4269 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇŸ cª©êsockë: %s", 
	`°ªº‹
(
î∫o
));

4273 i‡(
io
->
°©e
.
exãnsi⁄
.
böd
 && io->°©e.
comm™d
 =
SOCKS_BIND
) {

4274 
rc
 = 1;

4275 i‡(
	`£tsock›t
(
io
->
d°
.
s
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
rc
, (rc)) != 0)

4276 
	`sw¨n
("%s: sësock›t(SO_REUSEADDR)", 
fun˘i⁄
);

4279 i‡((
rc
 = 
	`socks_böd
(
io
->
d°
.
s
, &io->d°.
œddr
, 0)) != 0) {

4283 c⁄° 
ö_p‹t_t
 
p‹t_desúed
 = 
	`GET_SOCKADDRPORT
(&
io
->
d°
.
œddr
);

4285 
	`SET_SOCKADDRPORT
(&
io
->
d°
.
œddr
, 
	`ht⁄s
(0));

4287 i‡((
rc
 = 
	`socks_böd
(
io
->
d°
.
s
, &io->d°.
œddr
, 0)) == 0)

4288 
	`¶og
(
LOG_DEBUG
,

4290 
fun˘i⁄
,

4291 
	`¡ohs
(
p‹t_desúed
),

4292 
	`¡ohs
(
	`GET_SOCKADDRPORT
(&
io
->
d°
.
œddr
)));

4295 i‡(
rc
 != 0) {

4296 
	`log_böd_Áûed
(
fun˘i⁄
, 
SOCKS_TCP
, &
io
->
d°
.
œddr
);

4298 
	`¢¥ötf
(
emsg
, 
emsgÀn
,

4299 "ÁûedÅÿbödáddªs†⁄Éxã∫Æ side: %s", 
	`°ªº‹
(
î∫o
));

4304 
	`log_boundexã∫Æaddªss
(
fun˘i⁄
, &
io
->
d°
.
œddr
);

4307 
	}
}

4310 
	$auth2°™d¨d
(
auth
, 
°dauth
)

4311 c⁄° 
authmëhod_t
 *
auth
;

4312 
authmëhod_t
 *
°dauth
;

4314 c⁄° *
fun˘i⁄
 = "auth2standard()";

4316 
	`bzîo
(
°dauth
, (*stdauth));

4318 
auth
->
mëhod
) {

4319 
AUTHMETHOD_NONE
:

4320 
°dauth
->
mëhod
 = 
auth
->method;

4323 
AUTHMETHOD_UNAME
:

4324 
°dauth
->
md©a
.
u«me
 = 
auth
->mdata.uname;

4325 
°dauth
->
mëhod
 = 
auth
->method;

4328 #i‡
HAVE_GSSAPI


4329 
AUTHMETHOD_GSSAPI
:

4330 
°dauth
->
md©a
.
gsßpi
 = 
auth
->mdata.gssapi;

4331 
°dauth
->
mëhod
 = 
auth
->method;

4335 #i‡
HAVE_PAM


4336 
AUTHMETHOD_PAM_USERNAME
: {

4337 c⁄° 
authmëhod_∑m_t
 *
∑m
 = &
auth
->
md©a
.pam;

4339 
	`STRCPY_ASSERTSIZE
(
°dauth
->
md©a
.
u«me
.
«me
, 
∑m
->name);

4341 
	`STRCPY_ASSERTSIZE
(
°dauth
->
md©a
.
u«me
.
∑ssw‹d
, 
∑m
->password);

4343 
°dauth
->
mëhod
 = 
AUTHMETHOD_UNAME
;

4348 #i‡
HAVE_BSDAUTH


4349 
AUTHMETHOD_BSDAUTH
: {

4350 c⁄° 
authmëhod_bsd_t
 *
bsd
 = &
auth
->
md©a
.bsd;

4352 
	`STRCPY_ASSERTSIZE
(
°dauth
->
md©a
.
u«me
.
«me
, 
bsd
->name);

4354 
	`STRCPY_ASSERTSIZE
(
°dauth
->
md©a
.
u«me
.
∑ssw‹d
, 
bsd
->password);

4356 
°dauth
->
mëhod
 = 
AUTHMETHOD_UNAME
;

4362 
°dauth
->
mëhod
 = 
AUTHMETHOD_NONE
;

4365 i‡(
auth
->
mëhod
 !
°dauth
->method)

4366 
	`¶og
(
LOG_DEBUG
, "%s: converted fromáuthmethod %d (%s)Åo %d (%s)",

4367 
fun˘i⁄
,

4368 
auth
->
mëhod
,

4369 
	`mëhod2°rög
(
auth
->
mëhod
),

4370 
°dauth
->
mëhod
,

4371 
	`mëhod2°rög
(
°dauth
->
mëhod
));

4372 
	}
}

4375 #i‡
SOCKS_SERVER


4376 
sockd_io_t
 *

4377 
	$io_add
(
iﬁi°
, 
√wio
)

4378 
sockd_io_t
 *
iﬁi°
;

4379 c⁄° 
sockd_io_t
 *
√wio
;

4381 c⁄° *
fun˘i⁄
 = "io_add()";

4382 
sockd_io_t
 *
io
, *
¥evio
;

4384 
	`SASSERTX
(
√wio
->
√xt
 =
NULL
);

4386 
¥evio
 = 
io
 = 
iﬁi°
;

4387 
io
 !
NULL
) {

4388 
¥evio
 = 
io
;

4389 
io
 = io->
√xt
;

4392 i‡((
io
 = 
	`mÆloc
((*
√wio
))Ë=
NULL
)

4393 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
NOMEM
);

4395 *
io
 = *
√wio
;

4397 i‡(
¥evio
 =
NULL
)

4398 
¥evio
 = 
io
;

4400 
¥evio
->
√xt
 = 
io
;

4403  
iﬁi°
 =
NULL
 ? 
¥evio
 : iolist;

4404 
	}
}

4406 
sockd_io_t
 *

4407 
	$io_ªmove
(
iﬁi°
, 
rmio
)

4408 
sockd_io_t
 *
iﬁi°
;

4409 
sockd_io_t
 *
rmio
;

4411 
sockd_io_t
 *
io
, *
¥evio
;

4413 
	`SASSERTX
(
iﬁi°
 !
NULL
);

4415 i‡(
iﬁi°
 =
rmio
) {

4416 
iﬁi°
 = 
rmio
->
√xt
;

4417 
	`‰ì
(
rmio
);

4418  
iﬁi°
;

4421 
¥evio
 = 
iﬁi°
;

4422 
io
 = 
iﬁi°
->
√xt
;

4423 
io
 !
NULL
) {

4424 i‡(
io
 =
rmio
) {

4425 
¥evio
->
√xt
 = 
rmio
->next;

4426 
	`‰ì
(
rmio
);

4430 
¥evio
 = 
io
;

4431 
io
 = io->
√xt
;

4434  
iﬁi°
;

4435 
	}
}

4437 
sockd_io_t
 *

4438 
	$io_föd
(
iﬁi°
, 
addr
)

4439 
sockd_io_t
 *
iﬁi°
;

4440 c⁄° 
sockaddr_°‹age
 *
addr
;

4442 
sockd_io_t
 *
io
;

4444 i‡(
addr
 =
NULL
)

4445  
iﬁi°
;

4447 
io
 = 
iﬁi°
;

4448 
io
 !
NULL
)

4449 i‡(
	`sockaddøªeq
(&
io
->
§c
.
œddr
, 
addr
, 0)

4450 || 
	`sockaddøªeq
(&
io
->
d°
.
œddr
, 
addr
, 0)

4451 || 
	`sockaddøªeq
(&
io
->
c⁄åﬁ
.
œddr
, 
addr
, 0))

4452  
io
;

4454 
io
 = io->
√xt
;

4456  
NULL
;

4457 
	}
}

	@sockd/sockd_socket.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

50 
	#MAXSOCKETOPTIONS
 ( 1 \

57 )

	)

58 
	#MAXOPTIONNAME
 (16Ë

	)

60 
	mw™çrivûeges
;

61 
	mÀvñ
;

62 
	m›äame
;

63 
	m›tvÆ
;

64 
size_t
 
	m›éí
;

65 
	mãxäame
[
MAXOPTIONNAME
];

66 } 
	tsockë›ti⁄s_t
;

68 
size_t


69 
gë›ti⁄s
(c⁄° 
ß_Ámûy_t
 
Ámûy
, c⁄° 
ty≥
, c⁄° 
is˛õ¡side
,

70 
sockë›ti⁄s_t
 *
›ti⁄sv
, c⁄° 
size_t
 
›ti⁄sc
);

81 
	$sockd_unc⁄√˘
(
s
, 
ﬁd≥î
)

82 c⁄° 
s
;

83 c⁄° 
sockaddr_°‹age
 *
ﬁd≥î
;

85 c⁄° *
fun˘i⁄
 = "sockd_unconnect()";

86 
sockaddr_°‹age
 
loˇl
, 
ªmŸe
, 
√wloˇl
;

87 
sockÀn_t
 
addæí
;

88 
buf
[
MAXSOCKADDRSTRING
];

89 
havïìr
;

91 
addæí
 = (
loˇl
);

92 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
loˇl
), &
addæí
) != 0) {

93 
	`sw¨n
("%s: gësock«me()", 
fun˘i⁄
);

97 i‡(
	`gë≥î«me
(
s
, 
	`TOSA
(&
ªmŸe
), &
addæí
) != 0) {

98 #i‡
HAVE_LINUX_BUGS


99 i‡(
ﬁd≥î
 !
NULL
 && 
	`GET_SOCKADDRPORT
(ﬁd≥îË=
	`ht⁄s
(0))

109 
	`sw¨n
("%s: couldÇot unconnect fd %d from %s",

110 
fun˘i⁄
,

111 
s
,

112 
ﬁd≥î
 =
NULL
 ? "N/A" : 
	`sockaddr2°rög
(oldpeer, NULL, 0));

114 
	`SWARN
(
î∫o
);

117 
havïìr
 = 0;

120 
havïìr
 = 1;

122 
	`¶og
(
LOG_DEBUG
, "%s: unconnecting fd %d, currently connected from %sÅo %s",

123 
fun˘i⁄
,

124 
s
,

125 
	`sockaddr2°rög
(&
loˇl
, 
buf
, (buf)),

126 
havïìr
 ? 
	`sockaddr2°rög
(&
ªmŸe
, 
NULL
, 0) : "nothing");

128 
	`bzîo
(&
ªmŸe
, (remote));

129 
	`SET_SOCKADDR
(&
ªmŸe
, 
AF_UNSPEC
);

131 i‡(
	`c⁄√˘
(
s
, 
	`TOSA
(&
ªmŸe
), 
	`ßÀn
‘emŸe.
ss_Ámûy
)) != 0)

132 
	`¶og
(
LOG_DEBUG
, "%s: connectÅo %s failed: %s",

133 
fun˘i⁄
, 
	`sockaddr2°rög
(&
ªmŸe
, 
NULL
, 0), 
	`°ªº‹
(
î∫o
));

140 
addæí
 = (
√wloˇl
);

141 i‡(
	`gësock«me
(
s
, 
	`TOSA
(&
√wloˇl
), &
addæí
) != 0) {

142 
	`sw¨n
("%s: gësock«me(ËÁûedÅhê£c⁄dÅime", 
fun˘i⁄
);

146 i‡(
	`sockaddøªeq
(&
loˇl
, &
√wloˇl
, 0))

153 i‡(
	`socks_böd
(
s
, &
loˇl
, 1) != 0) {

154 
a
[
MAXSOCKADDRSTRING
], 
b
[MAXSOCKADDRSTRING];

155 
√w_s
;

157 
	`¶og
(
LOG_DEBUG
, "%s:Ñe-bind(2)áfter unconnecting failed: %s. "

161 
fun˘i⁄
,

162 
	`°ªº‹
(
î∫o
),

163 
	`sockaddr2°rög
(&
√wloˇl
, 
a
, (a)),

164 
	`sockaddr2°rög
(&
loˇl
, 
b
, (b)));

172 
√w_s
 = 1;

173 i‡(
	`£tsock›t
(
s
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
√w_s
, (new_s)) != 0)

174 
	`sw¨n
("%s: sësock›t(SO_REUSEADDR)", 
fun˘i⁄
);

176 i‡((
√w_s
 = 
	`sockë›tdup
(
s
, -1)) == -1) {

177 
	`sw¨n
("%s: sockë›tdup(%dËÁûed", 
fun˘i⁄
, 
s
);

181 i‡(
	`socks_böd
(
√w_s
, &
loˇl
, 1) != 0) {

182 
	`¶og
(
LOG_DEBUG
, "%s: bind ofÇew socketálso failed: %s",

183 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
));

185 
	`˛o£
(
√w_s
);

189 
	`¶og
(
LOG_DEBUG
, "%s: bind ofÇew socketÅoáddress %s succeeded",

190 
fun˘i⁄
, 
	`sockaddr2°rög
(&
loˇl
, 
NULL
, 0));

192 i‡(
	`dup2
(
√w_s
, 
s
) == -1) {

193 
	`sw¨n
("%s: dup2(ËÁûed", 
fun˘i⁄
);

195 
	`˛o£
(
√w_s
);

199 
	`˛o£
(
√w_s
);

203 
	}
}

206 
	$sockd_r°⁄˛o£
(
s
)

207 c⁄° 
s
;

209 c⁄° *
fun˘i⁄
 = "sockd_rstonclose()";

211 c⁄° 
lögî
Üinger = { 1, 0 };

213 i‡(
	`£tsock›t
(
s
,

214 
SOL_SOCKET
,

215 
SO_LINGER
,

216 &
lögî
,

217 (
lögî
)) != 0)

218 
	`¶og
(
LOG_DEBUG
,

220 
fun˘i⁄
, 
s
, 
	`°ªº‹
(
î∫o
));

221 
	}
}

224 
	$bödöã∫Æ
(
¥Ÿocﬁ
)

225 c⁄° 
¥Ÿocﬁ
;

227 c⁄° *
fun˘i⁄
 = "bindinternal()";

228 
size_t
 
i
;

230 
i
 = 0; i < 
sockscf
.
öã∫Æ
.
addrc
; ++i) {

231 
li°íaddªss_t
 *
l
 = &
sockscf
.
öã∫Æ
.
addrv
[
i
];

232 
vÆ
;

234 i‡(
l
->
¥Ÿocﬁ
 !=Örotocol)

237 i‡(
l
->
s
 != -1) {

238 
	`¶og
(
LOG_DEBUG
, "%s:áddress %s should be boundÅo fd %dálready",

239 
fun˘i⁄
,

240 
	`sockaddr2°rög
(&
l
->
addr
, 
NULL
, 0),

241 
l
->
s
);

243 
	`SASSERTX
(
	`fdis›í
(
l
->
s
));

249 
	`£tc⁄fsock›ti⁄s
(
l
->
s
,

250 
l
->
s
,

251 
SOCKS_TCP
,

254 
NULL
,

256 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
);

261 i‡((
l
->
s
 = 
	`sockë
÷->
addr
.
ss_Ámûy
, 
SOCK_STREAM
, 0)) == -1) {

262 
	`sw¨n
("%s: couldÇot create %s socket(2)",

263 
fun˘i⁄
, 
	`ßÁmûy2°rög
(
l
->
addr
.
ss_Ámûy
));

268 
	`£tsock›ti⁄s
(
l
->
s
,Ü->
addr
.
ss_Ámûy
, 
SOCK_STREAM
, 1);

281 
	`£tc⁄fsock›ti⁄s
(
l
->
s
,

282 
l
->
s
,

283 
SOCKS_TCP
,

286 
NULL
,

288 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
);

290 
vÆ
 = 1;

291 i‡(
	`£tsock›t
(
l
->
s
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
vÆ
, (val)) != 0)

292 
	`sw¨n
("%s: sësock›t(SO_REUSEADDR)", 
fun˘i⁄
);

294 #i‡!
HAVE_PRIVILEGES


303 
sockÀn_t
 
Àn
;

304 
uid_t
 
ﬁd_euid
;

305 
ch™ged_euid
 = 0;

307 
Àn
 = 
	`ßÀn
(
l
->
addr
.
ss_Ámûy
);

309 i‡(
	`PORTISRESERVED
(
	`GET_SOCKADDRPORT
(&
l
->
addr
))) {

310 
ﬁd_euid
 = 
	`gëeuid
();

312 i‡(
ﬁd_euid
 != 0) {

313 i‡(
	`£ãuid
(0) == 0) {

314 
sockscf
.
°©e
.
euid
 = 0;

315 
ch™ged_euid
 = 1;

320 i‡((
vÆ
 = 
	`böd
(
l
->
s
, 
	`TOSA
(&l->
addr
), 
Àn
)Ë=-1 && 
î∫o
 =
EADDRINUSE
)

322 
vÆ
 = 
	`böd
(
l
->
s
, 
	`TOSA
(&l->
addr
), 
Àn
);

324 i‡(
ch™ged_euid
) {

325 i‡(
	`£ãuid
(
ﬁd_euid
) == 0)

326 
sockscf
.
°©e
.
euid
 = 
ﬁd_euid
;

331 
vÆ
 = 
	`socks_böd
(
l
->
s
, &l->
addr
, 1);

335 i‡(
vÆ
 != 0) {

336 
	`sw¨n
("%s: bind ofáddress %s (address #%lu/%lu) for serverÅo "

338 
fun˘i⁄
,

339 
	`sockaddr2°rög
(&
l
->
addr
, 
NULL
, 0),

340 ()
i
 + 1,

341 ()
sockscf
.
öã∫Æ
.
addrc
);

346 
vÆ
 = 1;

347 i‡(
	`£tsock›t
(
l
->
s
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
vÆ
, (val)) != 0)

348 
	`sw¨n
("%s: sësock›t(SO_REUSEADDR)", 
fun˘i⁄
);

350 
	#MPTCP_AUTH_CLIENT_ENABLED
 28

	)

351 
m±˝_íabÀ
 = 1;

352 
rc
 = 
	`£tsock›t
(
l
->
s
, 
IPPROTO_TCP
, 
MPTCP_AUTH_CLIENT_ENABLED
, &
m±˝_íabÀ
, ());

353 i‡(
rc
 != 0)

354 
	`sw¨n
("%s: sësock›t(SO_REUSEADDR)", 
fun˘i⁄
);

356 i‡(
	`li°í
(
l
->
s
, 
SOCKD_MAXCLIENTQUEUE
) == -1) {

357 
	`sw¨n
("%s:Üi°í(%dËÁûed", 
fun˘i⁄
, 
SOCKD_MAXCLIENTQUEUE
);

364 i‡(
	`£ä⁄blockög
(
l
->
s
, "acceptingÇew clients") == -1)

369 
	}
}

372 
	$£tsock›ti⁄s
(
s
, 
Ámûy
, 
ty≥
, 
is˛õ¡side
)

373 c⁄° 
s
;

374 c⁄° 
ß_Ámûy_t
 
Ámûy
;

375 c⁄° 
ty≥
;

376 c⁄° 
is˛õ¡side
;

378 c⁄° *
fun˘i⁄
 = "setsockoptions()";

379 
sockë›ti⁄s_t
 
›ti⁄sv
[
MAXSOCKETOPTIONS
];

380 
size_t
 
›tc
, 
i
;

382 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Åype = %d, isclientside = %d",

383 
fun˘i⁄
, 
s
, 
ty≥
, 
is˛õ¡side
);

388 
›tc
 = 
	`gë›ti⁄s
(
Ámûy
, 
ty≥
, 
is˛õ¡side
, 
›ti⁄sv
, 
	`ELEMENTS
(optionsv));

389 
	`¶og
(
LOG_DEBUG
, "%s: %lu o±i⁄†tÿ£t", 
fun˘i⁄
, ()
›tc
);

391 
i
 = 0; i < 
›tc
; ++i) {

392 
rc
;

394 
	`SASSERTX
(*
›ti⁄sv
[
i
].
ãxäame
 !
NUL
);

396 i‡(
›ti⁄sv
[
i
].
w™çrivûeges
)

397 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_ON
);

399 
rc
 = 
	`£tsock›t
(
s
,

400 
›ti⁄sv
[
i
].
Àvñ
,

401 
›ti⁄sv
[
i
].
›äame
,

402 &
›ti⁄sv
[
i
].
›tvÆ
,

403 
›ti⁄sv
[
i
].
›éí
);

405 i‡(
›ti⁄sv
[
i
].
w™çrivûeges
)

406 
	`sockd_¥iv
(
SOCKD_PRIV_PRIVILEGED
, 
PRIV_OFF
);

408 i‡(
rc
 != 0) {

409 i‡(
›ti⁄sv
[
i
].
›äame
 =
SO_BROADCAST


410 && 
ty≥
 =
SOCK_DGRAM


411 && 
î∫o
 =
EPROTO
)

414 
	`sw¨n
("%s: setsockopt(%s)Åo value %d on fd %d failed",

415 
fun˘i⁄
, 
›ti⁄sv
[
i
].
ãxäame
, o±i⁄sv[i].
›tvÆ
, 
s
);

419 ()
	`£ä⁄blockög
(
s
, 
fun˘i⁄
);

421 i‡(
sockscf
.
›ti⁄
.
debug
) {

422 
sockÀn_t
 
Àn
;

423 
¢dbuf
, 
rcvbuf
;

425 
Àn
 = (
¢dbuf
);

426 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_SNDBUF
, &
¢dbuf
, &
Àn
) != 0) {

427 
	`sw¨n
("%s: couldÇot getÅhe size of SO_SNDBUF for fd %d",

428 
fun˘i⁄
, 
s
);

430 
¢dbuf
 = -1;

433 
Àn
 = (
rcvbuf
);

434 i‡(
	`gësock›t
(
s
, 
SOL_SOCKET
, 
SO_RCVBUF
, &
rcvbuf
, &
Àn
) != 0) {

435 
	`sw¨n
("%s: couldÇot getÅhe size of SO_RCVBUF for fd %d",

436 
fun˘i⁄
, 
s
);

438 
rcvbuf
 = -1;

441 
	`¶og
(
LOG_DEBUG
,

443 
fun˘i⁄
, 
s
, 
¢dbuf
, 
rcvbuf
);

446 #i‡
DIAGNOSTIC


447 
	`checksock›ti⁄s
(
s
, 
Ámûy
, 
ty≥
, 
is˛õ¡side
);

449 
	}
}

451 #i‡
DIAGNOSTIC


453 
	$checksock›ti⁄s
(
s
, 
Ámûy
, 
ty≥
, 
is˛õ¡side
)

454 c⁄° 
s
;

455 c⁄° 
ß_Ámûy_t
 
Ámûy
;

456 c⁄° 
ty≥
;

457 c⁄° 
is˛õ¡side
;

459 c⁄° *
fun˘i⁄
 = "checksockoptions()";

460 
sockë›ti⁄s_t
 
›ti⁄sv
[
MAXSOCKETOPTIONS
];

461 
size_t
 
›tc
, 
i
;

462 
vÆ
;

464 
	`¶og
(
LOG_DEBUG
, "%s: fd %d,Åype = %d, isclientside = %d",

465 
fun˘i⁄
, 
s
, 
ty≥
, 
is˛õ¡side
);

467 
›tc
 = 
	`gë›ti⁄s
(
Ámûy
, 
ty≥
, 
is˛õ¡side
, 
›ti⁄sv
, 
	`ELEMENTS
(optionsv));

468 
i
 = 0; i < 
›tc
; ++i) {

469 
sockÀn_t
 
vÆÀn
 = (
vÆ
);

470 
rc
;

472 #i‡
HAVE_LINUX_BUGS


473 #i‡
	`deföed
(
SO_SNDBUFFORCE
Ë|| deföed(
SO_RCVBUFFORCE
)

477 i‡(
›ti⁄sv
[
i
].
›äame
 =
SO_SNDBUFFORCE
)

478 
›ti⁄sv
[
i
].
›äame
 = 
SO_SNDBUF
;

479 i‡(
›ti⁄sv
[
i
].
›äame
 =
SO_RCVBUFFORCE
)

480 
›ti⁄sv
[
i
].
›äame
 = 
SO_RCVBUF
;

484 
rc
 = 
	`gësock›t
(
s
,

485 
›ti⁄sv
[
i
].
Àvñ
,

486 
›ti⁄sv
[
i
].
›äame
,

487 &
vÆ
,

488 &
vÆÀn
);

490 i‡(
rc
 != 0) {

491 i‡(
ty≥
 =
SOCK_STREAM
 && 
î∫o
 =
ECONNRESET
)

494 i‡(
›ti⁄sv
[
i
].
›äame
 =
SO_BROADCAST


495 && 
ty≥
 =
SOCK_DGRAM


496 && 
î∫o
 =
EPROTO
)

499 
	`sw¨n
("%s: couldÇot get socket option %s on fd %d",

500 
fun˘i⁄
, 
›ti⁄sv
[
i
].
ãxäame
, 
s
);

503 i‡(
vÆ
 !
›ti⁄sv
[
i
].
›tvÆ
) {

504 i‡((
›ti⁄sv
[
i
].
›tvÆ
 =1Ë&& 
vÆ
)

506 i‡(–
›ti⁄sv
[
i
].
›äame
 =
SO_SNDBUF


507 || 
›ti⁄sv
[
i
].
›äame
 =
SO_RCVBUF
)) {

508 i‡(
vÆ
 < 
›ti⁄sv
[
i
].
›tvÆ
)

509 
	`¶og
(
LOG_INFO
,

511 
fun˘i⁄
,

512 
›ti⁄sv
[
i
].
ãxäame
,

513 
s
,

514 
›ti⁄sv
[
i
].
›tvÆ
,

515 
vÆ
);

518 
	`¶og
((
ty≥
 =
SOCK_DGRAM
 && 
›ti⁄sv
[
i
].
›äame
 =
SO_BROADCAST
) ?

519 
LOG_DEBUG
 : 
LOG_WARNING
,

521 
fun˘i⁄
,

522 
›ti⁄sv
[
i
].
ãxäame
,

523 
s
,

524 
›ti⁄sv
[
i
].
›tvÆ
,

525 
vÆ
);

529 i‡((
vÆ
 = 
	`f˙é
(
s
, 
F_GETFL
, 0)) == -1)

530 
	`sw¨n
("%s: fcntl() failedÅo get descriptor flags of fd %d",

531 
fun˘i⁄
, 
s
);

533 i‡(! (
vÆ
 & 
O_NONBLOCK
))

534 
	`sw¨n
("%s: fd %d i†blockög", 
fun˘i⁄
, 
s
);

536 
	}
}

540 
size_t


541 
	$gë›ti⁄s
(
Ámûy
, 
ty≥
, 
is˛õ¡side
, 
›ti⁄sv
, 
›ti⁄sc
)

542 c⁄° 
ß_Ámûy_t
 
Ámûy
;

543 c⁄° 
ty≥
;

544 c⁄° 
is˛õ¡side
;

545 
sockë›ti⁄s_t
 *
›ti⁄sv
;

546 c⁄° 
size_t
 
›ti⁄sc
;

548 
size_t
 
›tc
;

550 
›tc
 = 0;

551 
ty≥
) {

552 
SOCK_STREAM
:

553 
›ti⁄sv
[
›tc
].
w™çrivûeges
 = 0;

554 
›ti⁄sv
[
›tc
].
Àvñ
 = 
IPPROTO_TCP
;

555 
›ti⁄sv
[
›tc
].
›äame
 = 
TCP_NODELAY
;

556 
›ti⁄sv
[
›tc
].
›tvÆ
 = 1;

557 
›ti⁄sv
[
›tc
].
›éí
 = (›ti⁄sv[›tc].
›tvÆ
);

558 
	`STRCPY_ASSERTSIZE
(
›ti⁄sv
[
›tc
].
ãxäame
, "TCP_NODELAY");

559 ++
›tc
;

560 
	`SASSERTX
(
›tc
 <
›ti⁄sc
);

562 
›ti⁄sv
[
›tc
].
w™çrivûeges
 = 0;

563 
›ti⁄sv
[
›tc
].
Àvñ
 = 
SOL_SOCKET
;

564 
›ti⁄sv
[
›tc
].
›äame
 = 
SO_OOBINLINE
;

565 
›ti⁄sv
[
›tc
].
›tvÆ
 = 1;

566 
›ti⁄sv
[
›tc
].
›éí
 = (›ti⁄sv[›tc].
›tvÆ
);

567 
	`STRCPY_ASSERTSIZE
(
›ti⁄sv
[
›tc
].
ãxäame
, "SO_OOBINLINE");

568 ++
›tc
;

569 
	`SASSERTX
(
›tc
 <
›ti⁄sc
);

571 i‡(
sockscf
.
›ti⁄
.
kì∑live
) {

572 
›ti⁄sv
[
›tc
].
w™çrivûeges
 = 0;

573 
›ti⁄sv
[
›tc
].
Àvñ
 = 
SOL_SOCKET
;

574 
›ti⁄sv
[
›tc
].
›äame
 = 
SO_KEEPALIVE
;

575 
›ti⁄sv
[
›tc
].
›tvÆ
 = 1;

576 
›ti⁄sv
[
›tc
].
›éí
 = (›ti⁄sv[›tc].
›tvÆ
);

577 
	`STRCPY_ASSERTSIZE
(
›ti⁄sv
[
›tc
].
ãxäame
, "SO_KEEPALIVE");

578 ++
›tc
;

579 
	`SASSERTX
(
›tc
 <
›ti⁄sc
);

584 
SOCK_DGRAM
:

585 
›ti⁄sv
[
›tc
].
w™çrivûeges
 = 0;

586 
›ti⁄sv
[
›tc
].
Àvñ
 = 
SOL_SOCKET
;

587 
›ti⁄sv
[
›tc
].
›äame
 = 
SO_BROADCAST
;

588 
›ti⁄sv
[
›tc
].
›tvÆ
 = 1;

589 
›ti⁄sv
[
›tc
].
›éí
 = (›ti⁄sv[›tc].
›tvÆ
);

590 
	`STRCPY_ASSERTSIZE
(
›ti⁄sv
[
›tc
].
ãxäame
, "SO_BROADCAST");

591 ++
›tc
;

592 
	`SASSERTX
(
›tc
 <
›ti⁄sc
);

594 #i‡
HAVE_SO_TIMESTAMP


595 
›ti⁄sv
[
›tc
].
w™çrivûeges
 = 0;

596 
›ti⁄sv
[
›tc
].
Àvñ
 = 
SOL_SOCKET
;

597 
›ti⁄sv
[
›tc
].
›äame
 = 
SO_TIMESTAMP
;

598 
›ti⁄sv
[
›tc
].
›tvÆ
 = 1;

599 
›ti⁄sv
[
›tc
].
›éí
 = (›ti⁄sv[›tc].
›tvÆ
);

600 
	`STRCPY_ASSERTSIZE
(
›ti⁄sv
[
›tc
].
ãxäame
, "SO_TIMESTAMP");

601 ++
›tc
;

602 
	`SASSERTX
(
›tc
 <
›ti⁄sc
);

608 
	`SERRX
(
ty≥
);

611 
	`SASSERTX
(
›tc
 <
›ti⁄sc
);

612  
›tc
;

613 
	}
}

	@sockd/sockd_tcp.c

45 
	~"comm⁄.h
"

47 c⁄° 
	grcsid
[] =

50 
ssize_t


51 
io_t˝_rw
(
sockd_io_dúe˘i⁄_t
 *
ö
, sockd_io_dúe˘i⁄_à*
out
, *
badfd
,

52 
io°©us_t
 *
io°©us
,

53 #i‡
COVENANT


54 c⁄° 
ªque°Êags_t
 *
ªqÊags
, 
size_t
 *
bufu£d
,

56 *
buf
, 
size_t
 
bufsize
, 
Êags
);

79 
io°©us_t


80 
	$doio_t˝
(
io
, 
r£t
, 
w£t
, 
Êags
, 
badfd
)

81 
sockd_io_t
 *
io
;

82 
fd_£t
 *
r£t
, *
w£t
;

83 c⁄° 
Êags
;

84 *
badfd
;

86 c⁄° *
fun˘i⁄
 = "doio_tcp()";

87 c⁄° 
i§evî£d
 = (
io
->
°©e
.
comm™d
 =
SOCKS_BINDREPLY
 ? 1 : 0);

88 
iocou¡_t
 
§c_ªad
 = 
io
->
§c
.
ªad
,

89 
§c_wrôãn
 = 
io
->
§c
.
wrôãn
,

90 
d°_ªad
 = 
io
->
d°
.
ªad
,

91 
d°_wrôãn
 = 
io
->
d°
.
wrôãn
;

92 
io°©us_t
 
io°©us
;

93 
£ndto_öfo_t
 
£ndtoÊags
;

94 
iﬁogaddr_t
 
§c
, 
d°
, 
¥oxy
;

95 °ru˘ { 
obje˘ty≥_t
 
ty≥
; *
obje˘
; } 
d°øddr
;

96 
ssize_t
 
r
, 
w
;

97 
size_t
 
bwu£d
;

98 
bŸhways
;

100 #i‡
COVENANT


102 *
buf
 = 
io
->
˛õ¡d©a
;

103 
size_t
 
buÊí
 = (
io
->
˛õ¡d©a
Ë- io->
˛õ¡d©Æí
;

104 
size_t
 
bufu£d
 = 
io
->
˛õ¡d©Æí
;

108 
buf
[
SOCKD_BUFSIZE
];

109 
size_t
 
buÊí
 = (
buf
);

114 
	`SASSERTX
(
io
->
Æloˇãd
);

115 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_TCP
);

116 
	`SASSERTX
(!(
io
->
§c
.
°©e
.
fö_ª˚ived
 && io->
d°
.state.fin_received));

118 i‡(
io
->
°©e
.
comm™d
 =
SOCKS_CONNECT
)

119 
	`SASSERTX
(
io
->
d°
.
°©e
.
isc⁄√˘ed
);

121 i‡((
	`FD_ISSET
(
io
->
§c
.
s
, 
r£t
Ë&& FD_ISSET(io->
d°
.s, 
w£t
))

122 || (
	`FD_ISSET
(
io
->
d°
.
s
, 
r£t
Ë&& FD_ISSET(io->
§c
.s, 
w£t
)))

125 
	`sw¨nx
("%s: FD_ISSET(io->src.s,Ñset) = %d, "

129 
fun˘i⁄
,

130 
	`FD_ISSET
(
io
->
§c
.
s
, 
r£t
),

131 
	`FD_ISSET
(
io
->
§c
.
s
, 
w£t
),

132 
	`FD_ISSET
(
io
->
d°
.
s
, 
r£t
),

133 
	`FD_ISSET
(
io
->
d°
.
s
, 
w£t
));

135 
	`SWARNX
(0);

137 *
badfd
 = 
io
->
d°
.
s
;

138  
IO_ERROR
;

141 
	`¶og
(
LOG_DEBUG
, "%s: control-fd %d, src-fd %d, dst-fd %d",

142 
fun˘i⁄
, 
io
->
c⁄åﬁ
.
s
, io->
§c
.s, io->
d°
.s);

144 i‡(!
	`timîis£t
(&
io
->
°©e
.
time
.
fú°io
))

145 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
io
->
°©e
.
time
.
fú°io
);

147 i‡(
	`FD_ISSET
(
io
->
§c
.
s
, 
r£t
Ë&& FD_ISSET(io->
d°
.s, 
w£t
)

148 && 
	`FD_ISSET
(
io
->
d°
.
s
, 
r£t
Ë&& FD_ISSET(io->
§c
.s, 
w£t
))

149 
bŸhways
 = 1;

151 
bŸhways
 = 0;

153 i‡(
	`SHMEMRULE
(
io
)->
bw_shmid
 != 0) {

161 
buÊí
 = 
	`MIN
(
	`SHMEMRULE
(
io
)->
bw
->
obje˘
.bw.
maxbps
, buflen);

163 
	`SASSERTX
(
	`SHMEMRULE
(
io
)->
bw
->
m°©e
.
˛õ¡s
 > 0);

164 
buÊí
 = 
	`MAX
(1,

165 ((
buÊí
 / 
	`SHMEMRULE
(
io
)->
bw
->
m°©e
.
˛õ¡s
)

166 / (
bŸhways
 ? 2 : 1)));

168 
	`¶og
(
LOG_DEBUG
,

170 
fun˘i⁄
,

171 ()
	`SHMEMRULE
(
io
)->
bw
->
m°©e
.
˛õ¡s
,

172 
bŸhways
 ? "yes" : "no",

173 ()
buÊí
);

176 
	`öô_iﬁogaddr
(&
§c
,

177 
obje˘_sockaddr
,

178 &
io
->
§c
.
œddr
,

179 
obje˘_sockaddr
,

180 &
io
->
§c
.
øddr
,

181 &
io
->
§c
.
auth
,

182 
	`GET_HOSTIDV
(&
io
->
°©e
),

183 
	`GET_HOSTIDC
(&
io
->
°©e
));

185 i‡(
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
) {

186 
d°øddr
.
obje˘
 = &
io
->
d°
.
øddr
;

187 
d°øddr
.
ty≥
 = 
obje˘_sockaddr
;

190 
d°øddr
.
obje˘
 = &
io
->
d°
.
ho°
;

191 
d°øddr
.
ty≥
 = 
obje˘_socksho°
;

194 
	`öô_iﬁogaddr
(&
d°
,

195 
obje˘_sockaddr
,

196 &
io
->
d°
.
œddr
,

197 
d°øddr
.
ty≥
,

198 
d°øddr
.
obje˘
,

199 &
io
->
d°
.
auth
,

200 
NULL
,

203 
	`öô_iﬁogaddr
(&
¥oxy
,

204 
obje˘_sockaddr
,

205 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
 ?

206 
NULL
 : &
io
->
d°
.
øddr
,

207 
obje˘_socksho°
,

208 
io
->
°©e
.
¥oxychaö
.
¥oxy¥Ÿocﬁ
 =
PROXY_DIRECT
 ?

209 
NULL
 : &
io
->
°©e
.
¥oxychaö
.
exèddr
,

210 
NULL
,

211 
NULL
,

214 
	#CHECK_ALARM
(
io°©us
) \

216 i‡(((
io°©us
Ë=
IO_IOERROR
 || (io°©usË=
IO_CLOSE
) \

217 && 
io
->
§uÀ
.
m°©s_shmid
 != 0 \

218 && (
io
->
§uÀ
.
Æ¨msc⁄figuªd
 & 
ALARM_DISCONNECT
)) { \

219 
sockd_io_dúe˘i⁄_t
 *
disc⁄√˘side
; \

220 
˛õ¡öfo_t
 
cöfo
; \

221 
Æ¨mside
, 
we˛o£dfú°
; \

223 
	`SASSERTX
(
io
->
§uÀ
.
m°©s
 !
NULL
); \

225 i‡(*
badfd
 =
io
->
§c
.
s
) { \

226 i‡(
io
->
§c
.
°©e
.
Æ¨mdisc⁄√˘d⁄e
) \

229 i‡(
io
->
d°
.
°©e
.
fö_ª˚ived
) \

230 
we˛o£dfú°
 = 1; \

232 
we˛o£dfú°
 = 0; \

234 i‡(
i§evî£d
) \

235 
Æ¨mside
 = 
ALARM_EXTERNAL
; \

237 
Æ¨mside
 = 
ALARM_INTERNAL
; \

239 
disc⁄√˘side
 = &
io
->
§c
; \

242 
	`SASSERTX
(*
badfd
 =
io
->
d°
.
s
); \

244 i‡(
io
->
d°
.
°©e
.
Æ¨mdisc⁄√˘d⁄e
) \

247 i‡(
io
->
§c
.
°©e
.
fö_ª˚ived
) \

248 
we˛o£dfú°
 = 1; \

250 
we˛o£dfú°
 = 0; \

252 i‡(
i§evî£d
) \

253 
Æ¨mside
 = 
ALARM_INTERNAL
; \

255 
Æ¨mside
 = 
ALARM_EXTERNAL
; \

257 
disc⁄√˘side
 = &
io
->
d°
; \

260 
cöfo
.
‰om
 = 
	`CONTROLIO
(
io
)->
øddr
; \

261 
	`HOSTIDCOPY
(&
io
->
°©e
, &
cöfo
); \

263 
	`Æ¨m_add_disc⁄√˘
(
we˛o£dfú°
, \

264 &
io
->
§uÀ
, \

265 
Æ¨mside
, \

266 &
cöfo
, \

267 (
io°©us
Ë=
IO_CLOSE
 ? "EOF" : 
	`°ªº‹
(
î∫o
), \

268 
sockscf
.
shmemfd
); \

270 
disc⁄√˘side
->
°©e
.
Æ¨mdisc⁄√˘d⁄e
 = 1; \

272 }  0)

	)

274 
	#CHECK_IOSTATUS
(
io°©us
) \

276 i‡(*(
io°©us
Ë=
IO_CLOSE
) { \

277 i‡(
io
->
§c
.
°©e
.
fö_ª˚ived
 && io->
d°
.state.fin_received) { \

279 *
badfd
 = (*badfd =
io
->
§c
.
s
 ? io->
d°
.s : io->src.s); \

281 
	`¶og
(
LOG_DEBUG
, \

284 
fun˘i⁄
, 
io
->
§c
.
s
, io->
d°
.s, \

285 *
badfd
 =
io
->
§c
.
s
 ? "Src" : "Dst", *badfd); \

288 *(
io°©us
Ë
IO_NOERROR
; \

290 }  0)

	)

292 
	`bzîo
(&
£ndtoÊags
, (sendtoflags));

293 
bwu£d
 = 0;

296 i‡(
	`FD_ISSET
(
io
->
§c
.
s
, 
r£t
Ë&& FD_ISSET(io->
d°
.s, 
w£t
)) {

297 
ÆlÊushed
;

299 
î∫o
 = 0;

300 *
badfd
 = -1;

311 
£ndtoÊags
.
side
 = 
i§evî£d
 ? 
INTERNALIF
 : 
EXTERNALIF
;

312 
w
 = 
	`socks_Êushbuf„r
(
io
->
d°
.
s
, -1, &
£ndtoÊags
);

313 
io
->
d°
.
wrôãn
.
byãs
 +
£ndtoÊags
.
tosockë
;

315 i‡(
w
 == -1) {

316 *
badfd
 = 
io
->
d°
.
s
;

318 i‡(!
	`ERRNOISTMP
(
î∫o
)) {

319 
	`CHECK_ALARM
(
IO_IOERROR
);

320  
IO_IOERROR
;

323 
ÆlÊushed
 = 0;

326 
ÆlÊushed
 = 1;

328 i‡(
ÆlÊushed
) {

329 
r
 = 
	`io_t˝_rw
(&
io
->
§c
,

330 &
io
->
d°
,

331 
badfd
,

332 &
io°©us
,

333 #i‡
COVENANT


334 &
io
->
ªqÊags
,

335 &
bufu£d
,

337 
buf
,

338 
buÊí
,

339 
Êags
);

341 
	`CHECK_ALARM
(
io°©us
);

342 
	`CHECK_IOSTATUS
(&
io°©us
);

344 i‡(
	`IOSTATUS_FATALERROR
(
io°©us
))

345  
io°©us
;

347 
r
) {

349 
r
 = 0;

354 
fdv
[] = { 
	`CLIENTIO
(
io
)->
s
, 
	`EXTERNALIO
(io)->s };

356 i‡(
io
->
§uÀ
.
log
.
t˝öfo


357 && (
io
->
§uÀ
.
log
.
io›î©i⁄
 || io->§uÀ.log.
d©a
)) {

358 
	`SASSERTX
(
io
->
°©e
.
t˝öfo
 =
NULL
);

359 
io
->
°©e
.
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

362 
	`iﬁog
(&
io
->
§uÀ
,

363 &
io
->
°©e
,

364 
OPERATION_IO
,

365 &
§c
,

366 &
d°
,

367 
NULL
,

368 &
¥oxy
,

369 
buf
,

370 (
size_t
)
r
);

372 
io
->
°©e
.
t˝öfo
 = 
NULL
;

376 
bwu£d
 +
r
;

381 i‡(
	`FD_ISSET
(
io
->
d°
.
s
, 
r£t
Ë&& FD_ISSET(io->
§c
.s, 
w£t
)) {

382 
ÆlÊushed
;

384 
î∫o
 = 0;

385 *
badfd
 = -1;

394 
£ndtoÊags
.
side
 = 
i§evî£d
 ? 
EXTERNALIF
 : 
INTERNALIF
;

395 
w
 = 
	`socks_Êushbuf„r
(
io
->
§c
.
s
, -1, &
£ndtoÊags
);

396 
io
->
§c
.
wrôãn
.
byãs
 +
£ndtoÊags
.
tosockë
;

398 i‡(
w
 == -1) {

399 *
badfd
 = 
io
->
§c
.
s
;

401 i‡(!
	`ERRNOISTMP
(
î∫o
)) {

402 
	`CHECK_ALARM
(
IO_IOERROR
);

403  
IO_ERROR
;

406 
ÆlÊushed
 = 0;

409 
ÆlÊushed
 = 1;

411 i‡(
ÆlÊushed
) {

412 
r
 = 
	`io_t˝_rw
(&
io
->
d°
,

413 &
io
->
§c
,

414 
badfd
,

415 &
io°©us
,

416 #i‡
COVENANT


417 &
io
->
ªqÊags
,

418 &
bufu£d
,

420 
buf
,

421 
buÊí
,

422 
Êags
);

424 
	`CHECK_ALARM
(
io°©us
);

425 
	`CHECK_IOSTATUS
(&
io°©us
);

427 i‡(
	`IOSTATUS_FATALERROR
(
io°©us
))

428  
io°©us
;

430 
r
) {

432 
r
 = 0;

437 
fdv
[] = { 
	`EXTERNALIO
(
io
)->
s
, 
	`CLIENTIO
(io)->s };

439 i‡(
io
->
§uÀ
.
log
.
t˝öfo


440 && (
io
->
§uÀ
.
log
.
io›î©i⁄
 || io->§uÀ.log.
d©a
)) {

441 
	`SASSERTX
(
io
->
°©e
.
t˝öfo
 =
NULL
);

442 
io
->
°©e
.
t˝öfo
 = 
	`gë_t˝öfo
(
	`ELEMENTS
(
fdv
), fdv, 
NULL
, 0);

445 
	`iﬁog
(&
io
->
§uÀ
,

446 &
io
->
°©e
,

447 
OPERATION_IO
,

448 &
d°
,

449 &
§c
,

450 &
¥oxy
,

451 
NULL
,

452 
buf
,

453 (
size_t
)
r
);

455 
io
->
°©e
.
t˝öfo
 = 
NULL
;

459 
bwu£d
 +
r
;

463 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
io
->
œ°io
);

464 
	`DO_IOCOUNT
(&
§c_ªad
, &
§c_wrôãn
, &
d°_ªad
, &
d°_wrôãn
, 
io
);

466 
	`io_upd©e
(&
io
->
œ°io
,

467 
bwu£d
,

468 
i§evî£d
 ? &
d°_ªad
 : &
§c_ªad
,

469 
i§evî£d
 ? &
d°_wrôãn
 : &
§c_wrôãn
,

470 
i§evî£d
 ? &
§c_ªad
 : &
d°_ªad
,

471 
i§evî£d
 ? &
§c_wrôãn
 : &
d°_wrôãn
,

472 
	`SHMEMRULE
(
io
),

473 
	`SHMEMRULE
(
io
),

474 
sockscf
.
shmemfd
,

475 
io
->
§c
.
s
);

477 
	`¶og
(
LOG_DEBUG
, "%s: bwu£d = %ld", 
fun˘i⁄
, ()
bwu£d
);

479 i‡(
bwu£d
)

480  
IO_NOERROR
;

482  
IO_EAGAIN
;

483 
	}
}

485 
ssize_t


486 
io_t˝_rw
(
ö
, 
out
, 
badfd
, 
io°©us
,

487 #i‡
COVENANT


488 
ªqÊags
, 
bufu£d
,

490 
buf
, 
bufsize
, 
Êags
)

491 
sockd_io_dúe˘i⁄_t
 *
	gö
;

492 
sockd_io_dúe˘i⁄_t
 *
	gout
;

493 *
	gbadfd
;

494 
io°©us_t
 *
	gio°©us
;

495 #i‡
COVENANT


496 c⁄° 
ªque°Êags_t
 *
	gªqÊags
;

497 
size_t
 *
	gbufu£d
;

499 *
	gbuf
;

500 
size_t
 
	gbufsize
;

501 
	gÊags
;

503 c⁄° *
	gfun˘i⁄
 = "io_tcp_rw()";

504 
£ndto_öfo_t
 
	g£ndtoÊags
;

505 
ªcv‰om_öfo_t
 
	gªcv‰omÊags
;

506 
ssize_t
 
	gr
, 
	gw
, 
	gp
;

508 
size_t
 
	gj
;

509 
size_t
 
	gÀnv
[] = { 60000, 60001, 60002, 60003, 60004, 60005, 60006, 60007,

513 #i‡!
COVENANT


514 
size_t
 
	gbufu£dmem
 = 0, *
	gbufu£d
 = &
bufu£dmem
;

517 
SASSERTX
(!
ö
->
°©e
.
fö_ª˚ived
);

519 *
	gio°©us
 = 
IO_NOERROR
;

521 i‡(
	gsockscf
.
	g›ti⁄
.
	gdebug
 >
DEBUG_VERBOSE
)

522 
¶og
(
LOG_DEBUG
,

524 
fun˘i⁄
,

525 
ö
->
s
,

526 
out
->
s
,

527 ()
bufsize
,

528 ()*
bufu£d
,

529 
Êags
);

531 i‡(
	gö
->
	g°©e
.
	gîr
 != 0) {

532 
î∫o
 = 
ö
->
°©e
.
îr
;

533 *
	gbadfd
 = 
ö
->
s
;

535 i‡(
	gout
->
	g°©e
.
	gîr
 != 0) {

536 
î∫o
 = 
out
->
°©e
.
îr
;

537 *
	gbadfd
 = 
out
->
s
;

540 *
	gbadfd
 = -1;

542 i‡(*
	gbadfd
 != -1) {

543 *
io°©us
 = 
IO_IOERROR
;

545 
¶og
(
LOG_DEBUG
,

547 
fun˘i⁄
, *
badfd
, 
°ªº‹
(
î∫o
));

570 i‡(
	gö
->
	gÊags
 & 
	gMSG_OOB
)

582 
	gÊags
 |
MSG_OOB
;

584 i‡(
	gÊags
 & 
	gMSG_OOB
) {

585 i‡(
sock©m¨k
(
ö
->
s
) != 1)

586 
Êags
 &~
MSG_OOB
;

588 
¶og
(
LOG_DEBUG
, "%s: havêOOB d©®⁄ fd %d", 
fun˘i⁄
, 
ö
->
s
);

599 
	gp
 = 
MIN
(
bufsize
 - *
bufu£d
, 
socks_‰ìöbuf„r
(
out
->
s
, 
WRITE_BUF
));

600 i‡(
	gp
 <= 0) {

601 
sw¨nx
("%s:Ço moreÑoom in iobuf for fd %d. "

606 
fun˘i⁄
, 
out
->
s
);

608 *
	gbadfd
 = 
out
->
s
;

609 
	gî∫o
 = 
ENOBUFS
;

610 *
	gio°©us
 = 
IO_ERROR
;

615 #i‡
HAVE_GSSAPI


621 i‡(
	gout
->
	gauth
.
	gmëhod
 =
AUTHMETHOD_GSSAPI
) {

622 
SASSERTX
(
out
->
auth
.
md©a
.
gsßpi
.
°©e
.
maxgssd©a
 > 0);

624 
	gp
 -
GSSAPI_OVERHEAD
(&
out
->
auth
.
md©a
.
gsßpi
.
°©e
);

625 
	gp
 = 
MIN
(
p
, (
ssize_t
)
out
->
auth
.
md©a
.
gsßpi
.
°©e
.
maxgssd©a
);

627 i‡(
	gp
 <= 0) {

632 
sw¨nx
("%s: write buffer for fd %d isálmost full. "

634 
fun˘i⁄
, 
out
->
s
,

635 ()
socks_‰ìöbuf„r
(
out
->
s
, 
WRITE_BUF
),

636 ()
socks_‰ìöbuf„r
(
out
->
s
, 
WRITE_BUF
) == 1 ?

638 ()
GSSAPI_OVERHEAD
(&
out
->
auth
.
md©a
.
gsßpi
.
°©e
));

640 
	gp
 = 1;

645 #i‡
COVENANT


646 i‡(
	gö
->
	gis˛õ¡side
 && !
	gªqÊags
->
	ghâpc⁄√˘
)

647 
	gÊags
 |
MSG_PEEK
;

650 
	gªcv‰omÊags
.
	gty≥
 = 
SOCK_STREAM
;

652 i‡(
	gö
->
	gis˛õ¡side
)

653 
	gªcv‰omÊags
.
	gside
 = 
INTERNALIF
;

655 
	gªcv‰omÊags
.
	gside
 = 
EXTERNALIF
;

658 
	gp
 = 
MIN
(
Ànv
[
j
 % 
ELEMENTS
÷ív)], 
p
);

659 ++
	gj
;

662 
SASSERTX
(
p
 >= 0);

663 
	gr
 = 
socks_ªcv‰om
(
ö
->
s
,

664 &
buf
[*
bufu£d
],

665 (
size_t
)
p
,

666 
Êags
 & ~
MSG_OOB
,

667 
NULL
,

668 
NULL
,

669 &
ªcv‰omÊags
,

670 &
ö
->
auth
);

672 i‡(
	gr
 <= 0) {

673 *
badfd
 = 
ö
->
s
;

675 i‡(
	gr
 == 0) {

686 *
io°©us
 = 
IO_CLOSE
;

688 
¶og
(
LOG_DEBUG
,

691 
fun˘i⁄
, 
ö
->
s
, ()
p
, 
out
->s, out->
°©e
.
fö_ª˚ived
);

693 
	gö
->
	g°©e
.
	gfö_ª˚ived
 = 1;

695 #i‡
HAVE_DARWIN


696 i‡(
	gö
->
	gªad
.
	gbyãs
 == 0) {

697 
sockÀn_t
 
›éí
;

698 
	g›t
;

700 
	g›éí
 = (
›t
);

701 i‡(
gësock›t
(
ö
->
s
, 
SOL_SOCKET
, 
SO_RCVBUF
, &
›t
, &
›éí
) == -1)

702 
sw¨n
("%s: gësock›t(SO_RCVBUF)", 
fun˘i⁄
);

704 i‡(
	g›t
 == 0)

705 
sw¨nx
("%s: ThereáppearsÅo beá bug inÅhe OS X Kernel, "

714 
fun˘i⁄
, 
PRODUCT
);

718 
SASSERTX
(
socks_byãsöbuf„r
(
out
->
s
, 
WRITE_BUF
, 0) == 0);

720 i‡(
	gout
->
	g°©e
.
	gfö_ª˚ived
)

721 
	gî∫o
 = 0;

726 
¶og
(
LOG_DEBUG
,

727 "%s: shuâög dow¿out->†(fd %dËf‹ wrôög", 
fun˘i⁄
, 
out
->
s
);

729 i‡(
shutdown
(
out
->
s
, 
SHUT_WR
) != 0) {

730 
¶og
(
LOG_DEBUG
,

733 
fun˘i⁄
,

734 
out
->
s
,

735 
ö
->
s
,

736 
°ªº‹
(
î∫o
),

737 
out
->
s
,

738 
out
->
°©e
.
fö_ª˚ived
 ? "Yes" : "No");

740 i‡(
	gout
->
	g°©e
.
	gfö_ª˚ived
)

745 
	gî∫o
 = 0;

747 *
	gbadfd
 = 
out
->
s
;

748 *
	gio°©us
 = 
IO_IOERROR
;

753 i‡(
ERRNOISTMP
(
î∫o
))

754 *
	gio°©us
 = 
IO_TMPERROR
;

756 *
	gio°©us
 = 
IO_IOERROR
;

759  
	gr
;

762 
	gö
->
	gªad
.
	gbyãs
 +
ªcv‰omÊags
.
‰omsockë
;

764 i‡(
	gsockscf
.
	g›ti⁄
.
	gdebug
 >
DEBUG_VERBOSE
)

765 
¶og
(
LOG_DEBUG
, "%s:Ñead %ld bytes (%lu from socket)",

766 
fun˘i⁄
, ()
r
, ()
ªcv‰omÊags
.
‰omsockë
);

768 #i‡
COVENANT


769 i‡(
	gö
->
	gis˛õ¡side
 && !
	gªqÊags
->
	ghâpc⁄√˘
) {

779 c⁄° *
	ghâp_eof
 = "\r\n\r\n";

780 
sockd_˛õ¡_t
 
	g˛õ¡
;

781 *
	gp
, 
	gemsg
[512];

783 
	gbuf
[*
bufu£d
 + 
r
] = 
NUL
;

784 
	gp
 = 
°r°r
(
buf
, 
hâp_eof
);

786 
¶og
(
LOG_DEBUG
, "%s:Ñead %ld bytesÇow, %lu bytes inÅotal. "

788 
fun˘i⁄
, ()
r
, ()*
bufu£d
 +Ñ,

789 
p
 =
NULL
 ? "Not yetát" : "Now have");

791 i‡(
	gp
 =
NULL
)

794 
	gr
 = (
p
 + 
°æí
(
hâp_eof
)Ë- 
buf
;

795 *
	gbufu£d
 = 0;

798 
	gÊags
 &~
MSG_PEEK
;

801 
	gw
 = 
socks_ªcv‰om
(
ö
->
s
,

802 &
buf
[*
bufu£d
],

803 
r
,

804 
Êags
 & ~
MSG_OOB
,

805 
NULL
,

806 
NULL
,

807 
NULL
,

808 &
ö
->
auth
);

809 
SASSERTX
(
r
 =
w
);

811 i‡(
	gp
 =
NULL
) {

812 
î∫o
 = 
EAGAIN
;

813 *
	gio°©us
 = 
IO_TMPERROR
;

814 *
	gbadfd
 = 
ö
->
s
;

823 
	g˛õ¡
.
	gªque°
.
	gauth
 = &
˛õ¡
.
auth
;

824 i‡(
∑r£_hâ¥eque°
(&
˛õ¡
.
ªque°
, 
buf
, 
emsg
, (emsg)) != 0) {

825 
visbuf
[2048];

827 
¶og
(
LOG_INFO
, "%s: failedÅoÖarse httpÑequest \"%s\" from %s: %s",

828 
fun˘i⁄
,

829 
sockë2°rög
(
ö
->
s
, 
NULL
, 0),

830 
°r2vis
(
buf
, 
r
, 
visbuf
, (visbuf)),

831 
emsg
);

834 i‡(!
socksho°¨ìq
(&
out
->
ho°
, &
˛õ¡
.
ªque°
.host)) {

835 
	gﬁd
[
MAXSOCKSHOSTSTRING
], 
	g√w
[MAXSOCKSHOSTSTRING];

837 
¶og
(
LOG_DEBUG
,

840 
fun˘i⁄
,

841 
sockë2°rög
(
ö
->
s
, 
NULL
, 0),

842 
socksho°2°rög
(&
out
->
ho°
, 
ﬁd
, (old)),

843 
socksho°2°rög
(&
˛õ¡
.
ªque°
.
ho°
, 
√w
, (new)));

845 
mem˝y
(
˛õ¡
.
˛õ¡d©a
, 
buf
, *
bufu£d
 + 
r
);

846 
	g˛õ¡
.
	g˛õ¡d©Æí
 = *
bufu£d
 + 
r
;

847 
	g˛õ¡
.
	gs
 = 
ö
->
s
;

848 
gëtimeofday_m⁄Ÿ⁄ic
(&
˛õ¡
.
ac˚±ed
);

852 i‡(
£nd_˛õ¡
(
sockscf
.
°©e
.
mŸhî
.
s
, &
˛õ¡
, 
buf
, *
bufu£d
) != 0)

853 
¶og
(
LOG_DEBUG
,

855 
fun˘i⁄
,

856 
sockaddr2°rög
(&
˛õ¡
.
‰om
, 
NULL
, 0));

858 *
	gio°©us
 = 
IO_ERROR
;

862 
¶og
(
LOG_DEBUG
, "%s:ÇoÖroblem,Åarget inÅheÇewÑequest isÅhe "

864 
fun˘i⁄
,

865 
socksho°2°rög
(&
˛õ¡
.
ªque°
.
ho°
, 
NULL
, 0));

869 i‡(
	gÊags
 & 
	gMSG_OOB
)

870 
	gö
->
	gÊags
 |
MSG_OOB
;

872 
	gö
->
	gÊags
 &~
MSG_OOB
;

878 i‡(
	gö
->
	gis˛õ¡side
)

879 
	g£ndtoÊags
.
	gside
 = 
EXTERNALIF
;

881 
	g£ndtoÊags
.
	gside
 = 
INTERNALIF
;

883 i‡((
	gw
 = 
socks_£ndto
(
out
->
s
,

884 
buf
,

885 
r
,

886 
Êags
,

887 
NULL
,

889 &
£ndtoÊags
,

890 &
out
->
auth
)) == -1) {

891 
¶og
(
LOG_DEBUG
, "%s: writeÅo fd %d failed. Wrote %ld/%ld: %s",

892 
fun˘i⁄
, 
out
->
s
, ()
w
, ()
r
, 
°ªº‹
(
î∫o
));

894 i‡(
ERRNOISTMP
(
î∫o
))

899 
	gw
 = 
socks_£ndto
(
out
->
s
,

900 
buf
,

901 
r
,

902 
Êags
,

903 
NULL
,

905 &
£ndtoÊags
,

906 &
out
->
auth
);

909 
	gout
->
	gwrôãn
.
	gbyãs
 +
£ndtoÊags
.
tosockë
;

911 i‡(
	gw
 !
r
) {

912 *
badfd
 = 
out
->
s
;

913 *
	gio°©us
 = 
IO_ERROR
;

915 i‡(
	gw
 > 0) {

916 
sw¨nx
("%s: wrote only %ld/%ld (%s)Åo fd %d, but we shouldÇever "

918 
fun˘i⁄
, ()
w
, ()
r
, 
°ªº‹
(
î∫o
), 
out
->
s
);

920 #i‡
PRERELEASE


921 
SERRX
(
out
->
s
);

923 
SWARNX
(
out
->
s
);

927 i‡(
	gsockscf
.
	g›ti⁄
.
	gdebug
 >
DEBUG_VERBOSE
)

928 
¶og
(
LOG_DEBUG
, "%s: wrote %ld bytes (%luÅo socket)",

929 
fun˘i⁄
, ()
w
, ()
£ndtoÊags
.
tosockë
);

961  
	gw
;

	@sockd/sockd_udp.c

45 
	~"comm⁄.h
"

46 
	~"c⁄fig_∑r£.h
"

48 c⁄° 
	grcsid
[] =

51 
øwsockë
;

52 
io°©e_t
 
io°©e
;

54 #i‡
HAVE_SO_TIMESTAMP


55 
	sio°©s
 {

56 
io°©_t
 
	mro
;

57 
io°©_t
 
	mrw
;

58 } 
	gio°©s
;

61 
io°©_t
 *

62 
io_upd©e°©
(
io°©_t
 *
io°©
);

71 
io_timîcmp
(c⁄° *
a
, c⁄° *
b
);

79 
io°©us_t


80 
	$doio_udp
(
io
, 
r£t
, 
badfd
)

81 
sockd_io_t
 *
io
;

82 
fd_£t
 *
r£t
;

83 *
badfd
;

138 c⁄° *
fun˘i⁄
 = "doio_udp()";

139 
io°©us_t
 
io°©us
;

140 
size_t
 
sideschecked
;

141 
iﬁogaddr_t
 
§c
, 
d°
;

143 #i‡
BAREFOOTD


145 
ruÀ_t
 
∑ckëruÀ
;

149 
ruÀ_t
 *
∑ckëruÀ
;

154 
	`SASSERTX
(
io
->
Æloˇãd
);

155 
	`SASSERTX
(
io
->
°©e
.
¥Ÿocﬁ
 =
SOCKS_UDP
);

157 #i‡
DIAGNOSTIC


158 
	`SASSERTX
(
	`socks_buf„rhasbyãs
(
io
->
§c
.
s
, 
WRITE_BUF
) == 0);

159 
	`SASSERTX
(
	`socks_buf„rhasbyãs
(
io
->
§c
.
s
, 
READ_BUF
) == 0);

160 
	`SASSERTX
(
	`socks_buf„rhasbyãs
(
io
->
d°
.
s
, 
WRITE_BUF
) == 0);

161 
	`SASSERTX
(
	`socks_buf„rhasbyãs
(
io
->
d°
.
s
, 
READ_BUF
) == 0);

164 
	`öô_iﬁogaddr
(&
§c
,

165 
obje˘_sockaddr
,

166 &
io
->
§c
.
œddr
,

167 
obje˘_sockaddr
,

168 &
io
->
§c
.
øddr
,

169 &
io
->
§c
.
auth
,

170 
NULL
,

173 
	`öô_iﬁogaddr
(&
d°
,

174 
obje˘_sockaddr
,

175 
io
->
d°
.
s
 =-1 ? 
NULL
 : &io->d°.
œddr
,

176 
obje˘_sockaddr
,

177 
io
->
d°
.
s
 =-1 ? 
NULL
 : &io->d°.
øddr
,

178 
io
->
d°
.
s
 =-1 ? 
NULL
 : &io->d°.
auth
,

179 
NULL
,

182 
	`¶og
(
LOG_DEBUG
, "%s: control-fd %d, src-fd %d, dst-fd %d",

183 
fun˘i⁄
, 
io
->
c⁄åﬁ
.
s
, io->
§c
.s, io->
d°
.s);

185 i‡(!
	`timîis£t
(&
io
->
°©e
.
time
.
fú°io
))

186 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
io
->
°©e
.
time
.
fú°io
);

188 
î∫o
 = 0;

189 *
badfd
 = -1;

191 
io°©us
 = 
IO_EAGAIN
;

192 
sideschecked
 = 0;

198 i‡(
	`FD_ISSET
(
io
->
§c
.
s
, 
r£t
)) {

199 c⁄° 
‹igöÆd°
 = 
io
->
d°
.
s
;

200 
iocou¡_t
 
§c_ªad
 = 
io
->
§c
.
ªad
,

201 
§c_wrôãn
 = 
io
->
§c
.
wrôãn
,

202 
d°_ªad
 = 
io
->
d°
.
ªad
,

203 
d°_wrôãn
 = 
io
->
d°
.
wrôãn
;

204 
iﬁogaddr_t
 
l§c
 = 
§c
, 
ld°
 = 
d°
;

205 
size_t
 
bwu£d
 = 0;

207 ++
sideschecked
;

214 
io
->
d°
.
s
 = -1;

216 #i‡
BAREFOOTD


225 
∑ckëruÀ
 = 
io
->
¸uÀ
;

227 
	`¶og
(
LOG_DEBUG
, "%s: client2target i/o on fd %d -> fd %d",

228 
fun˘i⁄
, 
io
->
§c
.
s
, io->
d°
.s);

230 
io°©us
 = 
	`io_udp_˛õ¡2èrgë
(&
io
->
§c
,

231 &
io
->
d°
,

232 &
io
->
ˇuth
,

233 &
io
->
°©e
,

234 &
l§c
,

235 &
ld°
,

236 
badfd
,

237 &
∑ckëruÀ
,

238 &
bwu£d
);

247 i‡(!
io
->
§c
.
°©e
.
u£_ßved_§uÀ
)

248 *
io
->
cmd
.
udp
.
sfwdruÀ
 = io->
§uÀ
;

250 
∑ckëruÀ
 = 
io
->
cmd
.
udp
.
sfwdruÀ
;

252 
	`¶og
(
LOG_DEBUG
, "%s: client2target i/o on fd %d -> {fd %d, fd %d}",

253 
fun˘i⁄
, 
io
->
§c
.
s
, io->
d°
.
d°v
[0].s, io->dst.dstv[1].s);

255 
io°©us
 = 
	`io_udp_˛õ¡2èrgë
(&
io
->
c⁄åﬁ
,

256 &
io
->
§c
,

257 &
io
->
d°
,

258 &
io
->
ˇuth
,

259 &
io
->
°©e
,

260 &
l§c
,

261 &
ld°
,

262 
badfd
,

263 
∑ckëruÀ
,

264 &
bwu£d
);

267 i‡(
	`IOSTATUS_FATALERROR
(
io°©us
))

269  
io°©us
;

271 i‡(
io°©us
 =
IO_NOERROR
) {

272 
	`DO_IOCOUNT
(&
§c_ªad
,

273 &
§c_wrôãn
,

274 &
d°_ªad
,

275 &
d°_wrôãn
,

276 
io
);

278 
	`io_upd©e
(&
io
->
œ°io
,

279 
bwu£d
,

280 &
§c_ªad
,

281 
NULL
,

282 
NULL
,

283 &
d°_wrôãn
,

285 #i‡
BAREFOOTD


286 &
∑ckëruÀ
,

287 &
∑ckëruÀ
,

291 &
io
->
§uÀ
,

292 
∑ckëruÀ
,

296 
sockscf
.
shmemfd
,

303 
io
->
d°
.
s
 = 
‹igöÆd°
;

306 
	`¶og
(
LOG_DEBUG
, "%s: someÇon-fatalÉrror, iostatus = %d",

307 
fun˘i⁄
, ()
io°©us
);

314 i‡(
io
->
d°
.
s
 !-1 && 
	`FD_ISSET
(io->d°.s, 
r£t
)) {

320 
iocou¡_t
 
§c_ªad
 = 
io
->
§c
.
ªad
,

321 
§c_wrôãn
 = 
io
->
§c
.
wrôãn
,

322 
d°_ªad
 = 
io
->
d°
.
ªad
,

323 
d°_wrôãn
 = 
io
->
d°
.
wrôãn
;

324 
iﬁogaddr_t
 
l§c
 = 
§c
, 
ld°
 = 
d°
;

325 
c⁄√˘i⁄°©e_t
 
ª∂y°©e
;

326 
size_t
 
bwu£d
 = 0;

328 #i‡
BAREFOOTD


329 
∑ckëruÀ
 = 
io
->
¸uÀ
;

332 
	`SASSERTX
(
io
->
cmd
.
udp
.
sfwdruÀ
 !
NULL
);

333 
	`SASSERTX
(
io
->
cmd
.
udp
.
§ïlyruÀ
 !
NULL
);

335 i‡(!
io
->
d°
.
°©e
.
u£_ßved_§uÀ
)

336 *
io
->
cmd
.
udp
.
§ïlyruÀ
 = io->
§uÀ
;

338 
∑ckëruÀ
 = 
io
->
cmd
.
udp
.
§ïlyruÀ
;

341 
ª∂y°©e
 = 
io
->
°©e
;

342 
ª∂y°©e
.
comm™d
 = 
SOCKS_UDPREPLY
;

344 ++
sideschecked
;

346 
	`¶og
(
LOG_DEBUG
,

348 
fun˘i⁄
, 
io
->
d°
.
s
, io->
§c
.s);

350 #i‡
BAREFOOTD


351 
io°©us
 = 
	`io_udp_èrgë2˛õ¡
(&
io
->
§c
,

352 &
io
->
d°
,

353 &
io
->
ˇuth
,

354 &
ª∂y°©e
,

355 &
l§c
,

356 &
ld°
,

357 
badfd
,

358 &
∑ckëruÀ
,

359 &
bwu£d
);

361 
io°©us
 = 
	`io_udp_èrgë2˛õ¡
(&
io
->
c⁄åﬁ
,

362 &
io
->
§c
,

363 &
io
->
d°
,

364 &
ª∂y°©e
,

365 &
l§c
,

366 &
ld°
,

367 
badfd
,

368 
∑ckëruÀ
,

369 &
bwu£d
);

373 i‡(
	`IOSTATUS_FATALERROR
(
io°©us
))

374  
io°©us
;

376 i‡(
io°©us
 =
IO_NOERROR
) {

377 
	`DO_IOCOUNT
(&
§c_ªad
,

378 &
§c_wrôãn
,

379 &
d°_ªad
,

380 &
d°_wrôãn
,

381 
io
);

383 
	`io_upd©e
(&
io
->
œ°io
,

384 
bwu£d
,

385 
NULL
,

386 &
§c_wrôãn
,

387 &
d°_ªad
,

388 
NULL
,

390 #i‡
BAREFOOTD


391 &
∑ckëruÀ
,

392 &
∑ckëruÀ
,

396 &
io
->
§uÀ
,

397 
∑ckëruÀ
,

401 
sockscf
.
shmemfd
, 0);

405 
	`SASSERTX
(
sideschecked
 > 0);

407 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
io
->
œ°io
);

409  
io°©us
;

410 
	}
}

412 
io°©us_t


413 
	$io_∑ckë_ª˚ived
(
ªcvÊags
, 
byã§e˚ived
, 
‰om
, 
ª˚ived⁄
)

414 c⁄° 
ªcv‰om_öfo_t
 *
ªcvÊags
;

415 c⁄° 
size_t
 
byã§e˚ived
;

416 c⁄° 
sockaddr_°‹age
 *
‰om
;

417 c⁄° 
sockaddr_°‹age
 *
ª˚ived⁄
;

419 c⁄° *
fun˘i⁄
 = "io_packet_received()";

420 #i‡
HAVE_SO_TIMESTAMP


421 
timevÆ
 
äow
, 
œãncy
;

424 i‡(
ªcvÊags
->
Êags
 & 
MSG_TRUNC
) {

425 
	`log_åunˇãdudp
(
fun˘i⁄
, 
‰om
, 
byã§e˚ived
);

426  
IO_TMPERROR
;

429 #i‡
HAVE_SO_TIMESTAMP


430 
	`gëtimeofday
(&
äow
, 
NULL
);

432 
	`io_addts
(
	`io_ˇlcuœãœãncy
(&
ªcvÊags
->
ts
, &
äow
, &
œãncy
), 
‰om
, 
NULL
);

435  
IO_NOERROR
;

436 
	}
}

438 
io°©us_t


439 
	$io_∑ckë_£¡
(
byã°o£nd
, 
byãs£¡
, 
t§e˚ived
, 
‰om
, 
to
, 
emsg
, 
emsgÀn
)

440 c⁄° 
size_t
 
byã°o£nd
;

441 c⁄° 
size_t
 
byãs£¡
;

442 c⁄° 
timevÆ
 *
t§e˚ived
;

443 c⁄° 
sockaddr_°‹age
 *
‰om
;

444 c⁄° 
sockaddr_°‹age
 *
to
;

445 *
emsg
;

446 
size_t
 
emsgÀn
;

448 c⁄° *
fun˘i⁄
 = "io_packet_sent()";

449 #i‡
HAVE_SO_TIMESTAMP


450 
timevÆ
 
äow
, 
œãncy
;

452 
	`gëtimeofday
(&
äow
, 
NULL
);

454 
	`io_addts
(
	`io_ˇlcuœãœãncy
(
t§e˚ived
, &
äow
, &
œãncy
), 
‰om
, 
to
);

457 i‡(
byã°o£nd
 !
byãs£¡
) {

458 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "%s", 
	`°ªº‹
(
î∫o
));

460 
	`¶og
(
LOG_DEBUG
, "%s: sídto(ËÁûed: %s", 
fun˘i⁄
, 
emsg
);

462 i‡(
	`ERRNOISTMP
(
î∫o
))

463  
IO_TMPERROR
;

465  
IO_IOERROR
;

468  
IO_NOERROR
;

469 
	}
}

471 
io°©_t
 *

472 
	$io_gë_io_°©s
()

475 #i‡
HAVE_SO_TIMESTAMP


476  
	`io_upd©e°©
(&
io°©s
.
rw
);

478  
NULL
;

480 
	}
}

482 
io°©_t
 *

483 
	$io_gë_ro_°©s
()

486 #i‡
HAVE_SO_TIMESTAMP


487  
	`io_upd©e°©
(&
io°©s
.
ro
);

489  
NULL
;

491 
	}
}

493 
timevÆ
 *

494 
	$io_ˇlcuœãœãncy
(
ts_ªcv
, 
äow
, 
œãncy
)

495 c⁄° 
timevÆ
 *
ts_ªcv
;

496 c⁄° 
timevÆ
 *
äow
;

497 
timevÆ
 *
œãncy
;

499 c⁄° *
fun˘i⁄
 = "io_calculatelatency()";

501 
	`timîsub
(
äow
, 
ts_ªcv
, 
œãncy
);

503  
œãncy
;

504 
	}
}

506 #i‡
HAVE_SO_TIMESTAMP


508 
	$io_addts
(
ts
, 
‰om
, 
to
)

509 c⁄° 
timevÆ
 *
ts
;

510 c⁄° 
sockaddr_°‹age
 *
‰om
;

511 c⁄° 
sockaddr_°‹age
 *
to
;

513 c⁄° *
fun˘i⁄
 = "io_addts()";

514 
io°©_t
 *
io°©
;

515 
f°r
[
MAXSOCKADDRSTRING
], 
t°r
[MAXSOCKADDRSTRING];

517 
	`¶og
(
ts
->
tv_£c
 < 0 ? 
LOG_WARNING
 : 
LOG_DEBUG
,

519 
fun˘i⁄
,

520 
	`sockaddr2°rög
(
‰om
, 
f°r
, (fstr)),

521 
to
 =
NULL
 ? "<ªad by us>" : 
	`sockaddr2°rög
—o, 
t°r
, (tstr)),

522 ()
ts
->
tv_£c
,

523 ()
ts
->
tv_u£c
,

524 
ts
->
tv_£c
 < 0 ?

527 i‡(
ts
->
tv_£c
 < 0)

530 i‡(
to
 =
NULL
)

531 
io°©
 = &
io°©s
.
ro
;

533 
io°©
 = &
io°©s
.
rw
;

535 i‡(
io°©
->
œ°œãncyi
 + 1 >
	`ELEMENTS
(io°©->
œãncyv
))

536 
io°©
->
œ°œãncyi
 = 0;

538 i‡(
io°©
->
œãncyc
 > 0)

539 ++
io°©
->
œ°œãncyi
;

541 i‡(
io°©
->
œãncyc
 < 
	`ELEMENTS
(io°©->
œãncyv
))

542 ++
io°©
->
œãncyc
;

546 
io°©
->
œãncyv
[io°©->
œ°œãncyi
] = *
ts
;

548 
	`SASSERTX
(
io°©
->
œãncyc
 <
	`ELEMENTS
(io°©->
œãncyv
));

549 
	`SASSERTX
(
io°©
->
œ°œãncyi
 <
	`ELEMENTS
(io°©->
œãncyv
));

550 
	}
}

552 
io°©_t
 *

553 
	$io_upd©e°©
(
io°©
)

554 
io°©_t
 *
io°©
;

556 c⁄° *
fun˘i⁄
 = "io_updatestat()";

558 i‡(
io°©
->
œãncyc
 == 0)

559  
NULL
;

561 
	`SASSERTX
(
io°©
->
œãncyc
 <
	`ELEMENTS
(io°©->
œãncyv
));

564 
	`SASSERTX
(
io°©
->
œ°œãncyi
 < 
	`ELEMENTS
(io°©->
œãncyv
));

565 
io°©
->
œ°_us
 = 
	`tv2us
(&io°©->
œãncyv
[io°©->
œ°œãncyi
]);

570 
	`qs‹t
(
io°©
->
œãncyv
,

571 
io°©
->
œãncyc
,

572 (*
io°©
->
œãncyv
),

573 
io_timîcmp
);

575 
io°©
->
mö_us
 = 
	`tv2us
(&io°©->
œãncyv
[0]);

576 
io°©
->
max_us
 = 
	`tv2us
(&io°©->
œãncyv
[io°©->
œãncyc
 - 1]);

577 
io°©
->
medün_us
 = 
	`medtv
(io°©->
œãncyv
, io°©->
œãncyc
);

578 
io°©
->
avîage_us
 = 
	`avgtv
(io°©->
œãncyv
, io°©->
œãncyc
);

579 
io°©
->
°ddev_us
 = 
	`°ddevtv
(io°©->
œãncyv
,

580 
io°©
->
œãncyc
,

581 
io°©
->
avîage_us
);

584 
i
 = 0; i < 
io°©
->
œãncyc
; ++i) {

585 
	`¶og
(
LOG_DEBUG
, "%s: index #%lu,Üatency: %ld.%06ld",

586 
fun˘i⁄
,

587 ()
i
,

588 ()
io°©
->
œãncyv
[
i
].
tv_£c
,

589 ()
io°©
->
œãncyv
[
i
].
tv_u£c
);

593  
io°©
;

594 
	}
}

597 
	$io_timîcmp
(
a
, 
b
)

598 c⁄° *
a
;

599 c⁄° *
b
;

602 i‡(
	`timîcmp
((c⁄° 
timevÆ
 *)
a
, (c⁄° timevÆ *)
b
, <))

605 i‡(
	`timîcmp
((c⁄° 
timevÆ
 *)
a
, (c⁄° timevÆ *)
b
, ==))

609 
	}
}

612 
ud±¨gë_t
 *

613 
	$öô˛õ¡
(
c⁄åﬁ
, 
˛õ¡_l
, 
˛õ¡_r
, 
toho°
, 
tﬂddr
, 
ruÀ
,

614 
emsg
, 
emsgÀn
, 
udpd°
)

615 c⁄° 
c⁄åﬁ
;

616 c⁄° 
sockaddr_°‹age
 *
˛õ¡_l
;

617 c⁄° 
sockaddr_°‹age
 *
˛õ¡_r
;

618 c⁄° 
socksho°_t
 *
toho°
;

619 c⁄° 
sockaddr_°‹age
 *
tﬂddr
;

620 c⁄° 
ruÀ_t
 *
ruÀ
;

621 *
emsg
;

622 c⁄° 
size_t
 
emsgÀn
;

623 
ud±¨gë_t
 *
udpd°
;

625 c⁄° *
fun˘i⁄
 = "initclient()";

626 
‰om°r
[
MAXSOCKADDRSTRING
], 
toho°°r
[
MAXSOCKSHOSTSTRING
],

627 
tﬂddr°r
[
MAXSOCKADDRSTRING
];

628 
s
, 
rc
;

630 
	`¶og
(
LOG_DEBUG
, "%s: from %sÅo %s (%s)",

631 
fun˘i⁄
,

632 
	`sockaddr2°rög
(
˛õ¡_r
, 
‰om°r
, (fromstr)),

633 
	`socksho°2°rög
(
toho°
, 
toho°°r
, (tohoststr)),

634 
	`sockaddr2°rög
(
tﬂddr
, 
tﬂddr°r
, (toaddrstr)));

636 
	`bzîo
(
udpd°
, (*udpdst));

638 
udpd°
->
øddrho°
 = *
toho°
;

639 
udpd°
->
øddr
 = *
tﬂddr
;

651 
î∫o
 = 0;

652 
s
 = -1;

654 i‡(
io°©e
.
‰ìfds
 <((
SOCKD_IOMAX
 - 1Ë* 
FDPASS_MAX
)

655 || (
s
 = 
	`sockë
(
udpd°
->
øddr
.
ss_Ámûy
, 
SOCK_DGRAM
, 0)) == -1) {

656 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot create %s udp socket: %s",

657 
	`ßÁmûy2°rög
(
udpd°
->
øddr
.
ss_Ámûy
),

658 
î∫o
 == 0 ?

659 "ÆªadyÑu¬ög sh‹ào‡sockës" : 
	`°ªº‹
(
î∫o
));

661 
	`sw¨nx
("%s: %s", 
fun˘i⁄
, 
emsg
);

663 i‡(
s
 != -1)

664 
	`˛o£
(
s
);

666  
NULL
;

669 
	`SASSERTX
(
s
 != -1);

671 i‡(
	`gëouèddr
(&
udpd°
->
œddr
,

672 
˛õ¡_l
,

673 
˛õ¡_r
,

674 
SOCKS_UDPASSOCIATE
,

675 &
udpd°
->
øddrho°
,

676 
emsg
,

677 
emsgÀn
Ë=
NULL
) {

678 
	`¶og
(
LOG_DEBUG
,

680 
fun˘i⁄
, 
	`socksho°2°rög
(&
udpd°
->
øddrho°
, 
NULL
, 0), 
emsg
);

682 
	`˛o£
(
s
);

683  
NULL
;

686 
	`£tsock›ti⁄s
(
s
, 
udpd°
->
øddr
.
ss_Ámûy
, 
SOCK_DGRAM
, 0);

688 
	`£tc⁄fsock›ti⁄s
(
s
,

689 
c⁄åﬁ
,

690 
SOCKS_UDP
,

692 
ruÀ
->
sockë›ti⁄c
,

693 
ruÀ
->
sockë›ti⁄v
,

694 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
,

695 
SOCKETOPT_PRE
 | 
SOCKETOPT_ANYTIME
);

697 i‡((
rc
 = 
	`socks_böd
(
s
, &
udpd°
->
œddr
, 0)) != 0) {

698 i‡(
	`GET_SOCKADDRPORT
(&
udpd°
->
œddr
Ë!
	`ht⁄s
(0))

699 
	`SET_SOCKADDRPORT
(&
udpd°
->
œddr
, 
	`ht⁄s
(0));

701 
rc
 = 
	`socks_böd
(
s
, &
udpd°
->
œddr
, 0);

704 i‡(
rc
 != 0) {

705 
	`log_böd_Áûed
(
fun˘i⁄
, 
SOCKS_UDP
, &
udpd°
->
œddr
);

707 
	`¢¥ötf
(
emsg
, 
emsgÀn
, "couldÇot bind udpáddress %s: %s",

708 
	`sockaddr2°rög
(&
udpd°
->
œddr
, 
NULL
, 0),

709 
	`°ªº‹
(
î∫o
));

711 
	`˛o£
(
s
);

712  
NULL
;

715 
	`log_boundexã∫Æaddªss
(
fun˘i⁄
, &
udpd°
->
œddr
);

717 #i‡
SOCKS_SERVER


723 
	`socks_Ælocbuf„r
(
s
, 
SOCK_DGRAM
);

731 #i‡
BAREFOOTD


732 
	`sockaddr˝y
(&
udpd°
->
˛õ¡
, 
˛õ¡_r
, 
	`ßÀn
(˛õ¡_r->
ss_Ámûy
));

733 
	`sockaddr2socksho°
(&
udpd°
->
˛õ¡
, &udpd°->
˛õ¡ho°
);

736 
	`gëtimeofday_m⁄Ÿ⁄ic
(&
udpd°
->
œ°io
);

737 
udpd°
->
fú°io
 = udpd°->
œ°io
;

738 
udpd°
->
s
 = s;

740 --
io°©e
.
‰ìfds
;

742 
	`¶og
(
LOG_DEBUG
,

744 
fun˘i⁄
, 
udpd°
->
s
, 
‰om°r
, 
toho°°r
);

746  
udpd°
;

747 
	}
}

749 
ud±¨gë_t
 *

750 
	$add˛õ¡
(
˛õ¡œddr
, 
˛õ¡
, 
˛õ¡c
, 
max˛õ¡c
, 
˛õ¡v
, 
°©e
, 
ruÀ
)

751 c⁄° 
sockaddr_°‹age
 *
˛õ¡œddr
;

752 c⁄° 
ud±¨gë_t
 *
˛õ¡
;

753 
size_t
 *
˛õ¡c
;

754 
size_t
 *
max˛õ¡c
;

755 
ud±¨gë_t
 **
˛õ¡v
;

756 c⁄° 
c⁄√˘i⁄°©e_t
 *
°©e
;

757 c⁄° 
ruÀ_t
 *
ruÀ
;

759 c⁄° *
fun˘i⁄
 = "addclient()";

760 #i‡
BAREFOOTD


761 
iﬁogaddr_t
 
§c
, 
d°
;

763 
˛õ¡_°r
[
MAXSOCKADDRSTRING
],

764 
œddr_°r
[
MAXSOCKADDRSTRING
],

765 
øddr_°r
[
MAXSOCKSHOSTSTRING
];

767 
	`¶og
(
LOG_DEBUG
,

770 
fun˘i⁄
,

771 
˛õ¡
->
s
,

772 
	`sockaddr2°rög
(&
˛õ¡
->˛õ¡, 
˛õ¡_°r
, (client_str)),

773 
	`sockaddr2°rög
(&
˛õ¡
->
œddr
, 
œddr_°r
, (laddr_str)),

774 
	`sockaddr2°rög
(&
˛õ¡
->
øddr
, 
øddr_°r
, (raddr_str)),

775 
	`socksho°2°rög
(&
˛õ¡
->
øddrho°
, 
NULL
, 0),

776 ()(*
˛õ¡c
 + 1),

777 ()(
io°©e
.
‰ìfds
 - 1));

779 i‡(*
˛õ¡c
 >*
max˛õ¡c
) {

780 
ud±¨gë_t
 *
pv
;

782 
	`SASSERTX
(*
˛õ¡c
 =*
max˛õ¡c
);

784 i‡((
pv
 = 
	`ªÆloc
(*
˛õ¡v
, ((*
max˛õ¡c
Ë+ 1Ë* (*pv))Ë=
NULL
) {

785 
	`sw¨n
("%s: failedÅoállocate memory forÇew udp client from %s",

786 
fun˘i⁄
, 
	`sockaddr2°rög
(&
˛õ¡
->˛õ¡, 
NULL
, 0));

788  
NULL
;

791 i‡(
pv
 !*
˛õ¡v
)

792 *
˛õ¡v
 = 
pv
;

794 *
max˛õ¡c
 += 1;

796 
	`¶og
(
LOG_DEBUG
,

799 
fun˘i⁄
, ()*
max˛õ¡c
, ()*
˛õ¡c
);

808 
	`SASSERTX
(*
˛õ¡c
 < *
max˛õ¡c
);

811 (*
˛õ¡v
)[*
˛õ¡c
] = *
˛õ¡
;

813 #i‡
BAREFOOTD


814 
	`öô_iﬁogaddr
(&
§c
,

815 
obje˘_sockaddr
,

816 
˛õ¡œddr
,

817 
obje˘_socksho°
,

818 &
˛õ¡
->
˛õ¡ho°
,

819 
NULL
,

820 
NULL
,

823 
	`öô_iﬁogaddr
(&
d°
,

824 
obje˘_sockaddr
,

825 &
˛õ¡
->
œddr
,

826 
obje˘_socksho°
,

827 &
˛õ¡
->
øddrho°
,

828 
NULL
,

829 
NULL
,

832 
	`iﬁog
(
ruÀ
,

833 
°©e
,

834 
OPERATION_CONNECT
,

835 &
§c
,

836 &
d°
,

837 
NULL
,

838 
NULL
,

839 
NULL
,

843  &(*
˛õ¡v
)[(*
˛õ¡c
)++];

844 
	}
}

847 
	$io_syncudp
(
io
, 
udp˛õ¡
)

848 
sockd_io_t
 *
io
;

849 
ud±¨gë_t
 *
udp˛õ¡
;

851 
io
->
°©e
.
time
.
e°ablished
 = 
udp˛õ¡
->
fú°io
;

853 #i‡
BAREFOOTD


854 
io
->
¸uÀ
 = 
udp˛õ¡
->crule;

857 
	`io_syncudp§c
(&
io
->
§c
, 
udp˛õ¡
);

859 
	`io_syncudpd°
(&
io
->
d°
, 
udp˛õ¡
);

860 
	}
}

863 
	$io_syncudp§c
(
§c
, 
udp˛õ¡
)

864 
sockd_io_dúe˘i⁄_t
 *
§c
;

865 c⁄° 
ud±¨gë_t
 *
udp˛õ¡
;

870 #i‡
BAREFOOTD


877 
§c
->
øddr
 = 
udp˛õ¡
->
˛õ¡
;

878 
§c
->
ho°
 = 
udp˛õ¡
->
˛õ¡ho°
;

881 
§c
->
ªad
 = 
udp˛õ¡
->
˛õ¡_ªad
;

882 
§c
->
wrôãn
 = 
udp˛õ¡
->
˛õ¡_wrôãn
;

883 
	}
}

887 
	$io_syncudpd°
(
d°
, 
ud±¨gë
)

888 
sockd_io_dúe˘i⁄_t
 *
d°
;

889 c⁄° 
ud±¨gë_t
 *
ud±¨gë
;

891 
d°
->
s
 = 
ud±¨gë
->s;

892 
d°
->
œddr
 = 
ud±¨gë
->laddr;

893 
d°
->
øddr
 = 
ud±¨gë
->raddr;

894 
d°
->
ho°
 = 
ud±¨gë
->
øddrho°
;

896 
d°
->
ªad
 = 
ud±¨gë
->
èrgë_ªad
;

897 
d°
->
wrôãn
 = 
ud±¨gë
->
èrgë_wrôãn
;

899 
d°
->
°©e
.
isc⁄√˘ed
 = 
ud±¨gë
->isconnected;

900 
	}
}

904 
ud±¨gë_t
 *

905 
	$˛õ¡ofsockë
(
s
, 
udp˛õ¡c
, 
udp˛õ¡v
)

906 c⁄° 
s
;

907 c⁄° 
size_t
 
udp˛õ¡c
;

908 
ud±¨gë_t
 *
udp˛õ¡v
;

910 
size_t
 
i
;

912 i‡(
i
 < 
udp˛õ¡c
 && 
udp˛õ¡v
[i].
s
 == s)

913  &
udp˛õ¡v
[
i
];

915 
i
 = 0; i < 
udp˛õ¡c
; ++i)

916 i‡(
udp˛õ¡v
[
i
].
s
 == s)

917  &
udp˛õ¡v
[
i
];

919  
NULL
;

920 
	}
}

	@sockd/sockd_util.c

45 c⁄° 
	grcsid
[] =

48 
	~"comm⁄.h
"

51 
	$£À˘mëhod
(
mëhodv
, 
mëhodc
, 
of„ªdv
, 
of„ªdc
)

52 c⁄° *
mëhodv
;

53 c⁄° 
size_t
 
mëhodc
;

54 c⁄° *
of„ªdv
;

55 c⁄° 
size_t
 
of„ªdc
;

57 c⁄° *
mëhodokv
;

58 
size_t
 
i
, 
mëhodokc
;

59 
ötmëhodv
[
MAXMETHODS
];

61 i‡(
of„ªdc
 == 0)

62  
AUTHMETHOD_NOACCEPT
;

64 
	`ch¨mëhod2ötmëhod
(
of„ªdc
, 
of„ªdv
, 
ötmëhodv
);

66 
i
 = 0; i < 
mëhodc
; ++i) {

67 i‡(
mëhodv
[
i
] > 
AUTHMETHOD_NOACCEPT
) {

72 c⁄° 
rfc931mëhodv
[] = { 
AUTHMETHOD_NONE
,

73 
AUTHMETHOD_UNAME
,

74 #i‡
HAVE_GSSAPI


75 
AUTHMETHOD_GSSAPI


79 c⁄° 
∑m_™y_mëhodv
[] = { 
AUTHMETHOD_UNAME
,

80 
AUTHMETHOD_NONE
,

81 #i‡
HAVE_GSSAPI


82 
AUTHMETHOD_GSSAPI
,

86 c⁄° 
∑m_addªss_mëhodv
[] = { 
AUTHMETHOD_UNAME
,

87 
AUTHMETHOD_NONE
,

88 #i‡
HAVE_GSSAPI


89 
AUTHMETHOD_GSSAPI
,

93 c⁄° 
∑m_∑ssw‹d_mëhodv
[] = { 
AUTHMETHOD_UNAME
 };

95 c⁄° 
bsdmëhodv
[] = { 
AUTHMETHOD_UNAME
,

96 #i‡
HAVE_GSSAPI


97 
AUTHMETHOD_GSSAPI
,

100 
size_t
 
ii
;

103 
mëhodv
[
i
]) {

104 
AUTHMETHOD_RFC931
:

105 
mëhodokc
 = 
	`ELEMENTS
(
rfc931mëhodv
);

106 
mëhodokv
 = 
rfc931mëhodv
;

109 
AUTHMETHOD_PAM_ANY
:

110 
mëhodokc
 = 
	`ELEMENTS
(
∑m_™y_mëhodv
);

111 
mëhodokv
 = 
∑m_™y_mëhodv
;

114 
AUTHMETHOD_PAM_ADDRESS
:

115 
mëhodokc
 = 
	`ELEMENTS
(
∑m_addªss_mëhodv
);

116 
mëhodokv
 = 
∑m_addªss_mëhodv
;

119 
AUTHMETHOD_PAM_USERNAME
:

120 
mëhodokc
 = 
	`ELEMENTS
(
∑m_∑ssw‹d_mëhodv
);

121 
mëhodokv
 = 
∑m_∑ssw‹d_mëhodv
;

124 
AUTHMETHOD_BSDAUTH
:

125 
mëhodokc
 = 
	`ELEMENTS
(
bsdmëhodv
);

126 
mëhodokv
 = 
bsdmëhodv
;

130 
	`SERRX
(
mëhodv
[
i
]);

133 
ii
 = 0; iò< 
mëhodokc
; ++ii)

134 i‡(
	`mëhodis£t
(
mëhodokv
[
ii
], 
ötmëhodv
, 
of„ªdc
))

135  
mëhodokv
[
ii
];

140 i‡(
	`memchr
(
of„ªdv
, ()
mëhodv
[
i
], 
of„ªdc
Ë!
NULL
)

141  
mëhodv
[
i
];

144  
AUTHMETHOD_NOACCEPT
;

145 
	}
}

148 
	$pidismŸhî
(
pid
)

149 
pid_t
 
pid
;

151 
size_t
 
i
;

153 i‡(
sockscf
.
°©e
.
mŸhîpidv
 =
NULL
)

156 
i
 = 0; i < 
sockscf
.
›ti⁄
.
£rvîc
; ++i)

157 i‡(
sockscf
.
°©e
.
mŸhîpidv
[
i
] =
pid
)

158  
i
 + 1;

161 
	}
}

164 
	$pidismaömŸhî
(
pid
)

165 
pid_t
 
pid
;

168  
	`pidismŸhî
(
pid
) == 1;

169 
	}
}

172 
	$des¸ùt‹i§e£rved
(
d
)

173 
d
;

175 
size_t
 
i
;

177 i‡(
d
 =
sockscf
.
ho°fd


178 || 
d
 =
sockscf
.
shmemfd


179 || 
d
 =
sockscf
.
loglock


181 #i‡
HAVE_LDAP


182 || 
d
 =
sockscf
.
ld≠fd


185 || 
d
 =
sockscf
.
shmemc⁄figfd


186 || 
	`FD_IS_RESERVED_EXTERNAL
(
d
))

190 i‡(
	`socks_logm©ch
(
d
, &
sockscf
.
log
)

191 || 
	`socks_logm©ch
(
d
, &
sockscf
.
îæog
))

194 
i
 = 0; i < 
	`ELEMENTS
(
sockscf
.
°©e
.
ª£rvedfdv
); ++i)

195 i‡(
d
 =
sockscf
.
°©e
.
ª£rvedfdv
[
i
])

199 
	}
}

202 
	$sig£rvîbrﬂdˇ°
(
sig
)

203 
sig
;

205 c⁄° *
fun˘i⁄
 = "sigserverbroadcast()";

206 
size_t
 
i
;

208 i‡(
sockscf
.
°©e
.
mŸhîpidv
 =
NULL
)

211 
i
 = 1; i < 
sockscf
.
›ti⁄
.
£rvîc
; ++i)

212 i‡(
sockscf
.
°©e
.
mŸhîpidv
[
i
] != 0) {

213 
	`¶og
(
LOG_DEBUG
, "%s: sending signal %dÅo mother %lu",

214 
fun˘i⁄
, 
sig
, ()(
sockscf
.
°©e
.
mŸhîpidv
[
i
]));

216 i‡(
	`kûl
(
sockscf
.
°©e
.
mŸhîpidv
[
i
], 
sig
) != 0)

217 
	`sw¨n
("%s: couldÇot send signal %dÅo motherÖrocess %lu",

218 
fun˘i⁄
,

219 
sig
,

220 ()
sockscf
.
°©e
.
mŸhîpidv
[
i
]);

222 
	}
}

225 
	$sockd_pushsig«l
(
sig
, 
sigöfo
)

226 c⁄° 
sig
;

227 c⁄° 
sigöfo_t
 *
sigöfo
;

229 c⁄° *
fun˘i⁄
 = "sockd_pushsignal()";

230 
sig£t_t
 
Æl
, 
ﬁdmask
;

231 
size_t
 
i
, 
Æªadythîe
;

233 
	`SASSERTX
(
sig
 > 0);

235 ()
	`sigfûl£t
(&
Æl
);

236 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
Æl
, &
ﬁdmask
) != 0) {

237 c⁄° *
msgv
[]

238 { 
fun˘i⁄
,

240 
	`…ﬂ
(
î∫o
, 
NULL
, 0),

241 
NULL


244 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

248 
i
 = 
Æªadythîe
 = 0; i < (
size_t
)
sockscf
.
°©e
.
sig«lc
; ++i)

249 i‡(
sockscf
.
°©e
.
sig«lv
[
i
].
sig«l
 =
sig
) {

250 
Æªadythîe
 = 1;

254 i‡(!
Æªadythîe
) {

255 i‡(
i
 < 
	`ELEMENTS
(
sockscf
.
°©e
.
sig«lv
)) {

256 
sockscf
.
°©e
.
sig«lv
[sockscf.°©e.
sig«lc
].
sig«l
 = 
sig
;

258 i‡(
sigöfo
 !
NULL
)

259 
sockscf
.
°©e
.
sig«lv
[sockscf.°©e.
sig«lc
].
sigöfo
 = *siginfo;

261 
	`bzîo
(&
sockscf
.
°©e
.
sig«lv
[sockscf.°©e.
sig«lc
].
sigöfo
,

262 (
sockscf
.
°©e
.
sig«lv
[sockscf.°©e.
sig«lc
].
sigöfo
));

264 ++
sockscf
.
°©e
.
sig«lc
;

267 
sigbuf
[32], 
pidbuf
[32], 
numbuf
[32];

268 c⁄° *
msgv
[]

269 { 
fun˘i⁄
,

271 
	`…ﬂ
(
sig
, 
sigbuf
, (sigbuf)),

273 
	`…ﬂ
(
sockscf
.
°©e
.
sig«lv
[sockscf.°©e.
sig«lc
 - 1]

274 .
sigöfo
.
si_pid
,

275 
pidbuf
,

276 (
pidbuf
)),

278 
	`…ﬂ
(
sockscf
.
°©e
.
sig«lc
, 
numbuf
, (numbuf)),

279 
NULL


282 
	`sig«l¶og
(
LOG_DEBUG
, 
msgv
);

286 
	`SWARNX
(
i
);

289 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0) {

290 c⁄° *
msgv
[]

291 { 
fun˘i⁄
,

293 
	`…ﬂ
(
î∫o
, 
NULL
, 0),

294 
NULL


297 
	`sig«l¶og
(
LOG_WARNING
, 
msgv
);

299 
	}
}

302 
	$sockd_p›sig«l
(
sigöfo_t
 *
sigöfo
)

304 c⁄° *
fun˘i⁄
 = "sockd_popsignal()";

305 
sig£t_t
 
Æl
, 
ﬁdmask
;

306 
sig
;

308 ()
	`sigfûl£t
(&
Æl
);

309 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
Æl
, &
ﬁdmask
) != 0)

310 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK)", 
fun˘i⁄
);

312 
	`SASSERTX
(
sockscf
.
°©e
.
sig«lc
 > 0);

314 
sig
 = 
sockscf
.
°©e
.
sig«lv
[0].
sig«l
;

315 *
sigöfo
 = 
sockscf
.
°©e
.
sig«lv
[0].siginfo;

317 
	`memmove
(
sockscf
.
°©e
.
sig«lv
,

318 &
sockscf
.
°©e
.
sig«lv
[1],

319 (*
sockscf
.
°©e
.
sig«lv
Ë* (--sockscf.°©e.
sig«lc
));

321 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, &
ﬁdmask
, 
NULL
) != 0)

322 
	`sw¨n
("%s: sig¥ocmask(SIG_SETMASK, &ﬁdmask, NULL)", 
fun˘i⁄
);

324  
sig
;

325 
	}
}

328 
	$sockd_h™dÀdsig«ls
()

330 c⁄° *
fun˘i⁄
 = "sockd_handledsignals()";

331 c⁄° 
î∫o_s
 = 
î∫o
;

332 
siga˘i⁄
 
ﬂ˘
;

333 
i
, 
rc
 = 0;

335 i‡(
sockscf
.
°©e
.
sig«lc
 == 0)

338 i‡(
sockscf
.
›ti⁄
.
debug
 >
DEBUG_VERBOSE
)

339 
i
 = 0, 
rc
 = 0; i < 
sockscf
.
°©e
.
sig«lc
; ++i)

340 
	`¶og
(
LOG_DEBUG
, "%s: signal #%d onÅhe stack is signal %d",

341 
fun˘i⁄
, 
i
 + 1, ()
sockscf
.
°©e
.
sig«lv
[i].
sig«l
);

343 
sockscf
.
°©e
.
sig«lc
) {

344 
sigöfo_t
 
sigöfo
;

345 c⁄° 
sig«l
 = 
	`sockd_p›sig«l
(&
sigöfo
);

347 
	`¶og
(
LOG_DEBUG
,

349 
fun˘i⁄
, 
sig«l
, 
sockscf
.
°©e
.
sig«lc
);

351 i‡(
	`siga˘i⁄
(
sig«l
, 
NULL
, &
ﬂ˘
) != 0)

352 
	`SERR
(0);

355 i‡(
ﬂ˘
.
ß_h™dÀr
 !
SIG_IGN
 && oa˘.ß_h™dÀ∏!
SIG_DFL
) {

356 
ﬂ˘
.
	`ß_siga˘i⁄
(-
sig«l
, &
sigöfo
, 
NULL
);

357 ++
rc
;

364 
	`¶og
(
LOG_DEBUG
, "%s:Ço handler for signal %dátÅhe moment",

365 
fun˘i⁄
, 
sig«l
);

368 
î∫o
 = 
î∫o_s
;

369  
rc
;

370 
	}
}

373 
	$‰ìdes¸ùt‹s
(
mesßge
, 
hfd
)

374 c⁄° *
mesßge
;

375 *
hfd
;

377 c⁄° 
î∫o_s
 = 
î∫o
;

378 
i
, 
‰ìfds
, 
tmp_hfd
, 
max
;

380 i‡(
sockscf
.
°©e
.
highe°fdöu£
 !0 && 
hfd
 =
NULL
)

382 
max
 = 
sockscf
.
°©e
.
highe°fdöu£
;

384 
max
 = 
sockscf
.
°©e
.
max›ífûes
;

386 i‡(
hfd
 =
NULL
) {

387 
tmp_hfd
 = 0;

388 
hfd
 = &
tmp_hfd
;

391 
i
 = 
‰ìfds
 = 0; i < 
max
; ++i)

392 i‡(
	`fdis›í
(()
i
))

393 *
hfd
 = 
	`MAX
(
i
, *hfd);

395 ++
‰ìfds
;

397 
‰ìfds
 +(
sockscf
.
°©e
.
max›ífûes
 - 
max
);

399 i‡(
mesßge
 !
NULL
)

400 
	`¶og
(
LOG_DEBUG
, "freedescriptors(%s): free : %d/%ld, highest in use: %d",

401 
mesßge
, 
‰ìfds
, ()
sockscf
.
°©e
.
max›ífûes
, *
hfd
);

403 
î∫o
 = 
î∫o_s
;

404  
‰ìfds
;

405 
	}
}

408 
	$sockd_mŸhîexi°s
()

410 c⁄° 
pid_t
 
pid
 = 
	`gëµid
();

411 
size_t
 
i
;

413 i‡(
sockscf
.
°©e
.
mŸhîpidv
 =
NULL
)

423 
i
 = 0; i < 
sockscf
.
›ti⁄
.
£rvîc
; ++i)

424 i‡(
sockscf
.
°©e
.
mŸhîpidv
[
i
] =
pid
)

428 
	}
}

431 
	$sockdexô
(
code
)

432 c⁄° 
code
;

434 c⁄° *
fun˘i⁄
 = "sockdexit()";

435 
siga˘i⁄
 
siga˘
;

436 
exôög
;

438 i‡(
exôög
)

439 
	`ab‹t
();

441 
exôög
 = 1;

446 
	`bzîo
(&
siga˘
, (sigact));

447 
siga˘
.
ß_h™dÀr
 = 
SIG_IGN
;

448 i‡(
	`siga˘i⁄
(
SIGTERM
, &
siga˘
, 
NULL
) != 0

449 || 
	`siga˘i⁄
(
SIGCHLD
, &
siga˘
, 
NULL
) != 0)

450 
	`sw¨n
("%s: siga˘i⁄()", 
fun˘i⁄
);

452 
	`¶og
(
LOG_DEBUG
, "%s: insig«»%d", 
fun˘i⁄
, ()
sockscf
.
°©e
.
ösig«l
);

454 i‡(
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
) {

455 
rußge
Ñusage;

457 
	`˛o£chûd
(0, 1);

459 #i‡
HAVE_ENABLED_PIDFILE


460 i‡(
sockscf
.
›ti⁄
.
pidfûewrôãn


461 && 
	`pidismaömŸhî
(
sockscf
.
°©e
.
pid
)) {

462 
	`sockd_¥iv
(
SOCKD_PRIV_FILE_WRITE
, 
PRIV_ON
);

464 i‡(
	`åunˇã
(
sockscf
.
›ti⁄
.
pidfûe
, 0) != 0)

465 
	`sw¨n
("%s:Årunˇã(%s)", 
fun˘i⁄
, 
sockscf
.
›ti⁄
.
pidfûe
);

467 
	`sockd_¥iv
(
SOCKD_PRIV_FILE_WRITE
, 
PRIV_OFF
);

471 i‡(
	`gërußge
(
RUSAGE_SELF
, &
rußge
) == 0)

472 
	`log_rußge
(
PROC_MOTHER
, 0, &
rußge
);

474 
	`log_rußge
(
PROC_MONITOR
, 0, &
sockscf
.
°©e
.
rußge_m⁄ô‹
);

475 
	`log_rußge
(
PROC_NEGOTIATE
, 0, &
sockscf
.
°©e
.
rußge_√gŸüã
);

476 
	`log_rußge
(
PROC_REQUEST
, 0, &
sockscf
.
°©e
.
rußge_ªque°
);

477 
	`log_rußge
(
PROC_IO
, 0, &
sockscf
.
°©e
.
rußge_io
);

480 i‡(
sockscf
.
°©e
.
ösig«l
)

481 
	`¶og
(
LOG_DEBUG
, "%s: shutting down on signal %d",

482 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
), sockscf.°©e.
ösig«l
);

484 
	`¶og
(
LOG_DEBUG
, "%s: shutting down",

485 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
));

488 #i‡
HAVE_PROFILING


489 i‡(
	`chdú
(
SOCKS_PROFILEDIR
) != 0) {

490 i‡(
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
)

491 
	`¶og
(
LOG_ERR
,

495 
fun˘i⁄
, 
	`°ªº‹
(
î∫o
), 
SOCKS_PROFILEDIR
, 
PRODUCT
);

498 
dú
[80];

500 
	`¢¥ötf
(
dú
, (dir), "%s.%ld",

501 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
), ()
	`gëpid
());

503 i‡(
	`mkdú
(
dú
, 
S_IRWXU
) != 0)

504 
	`sw¨n
("%s: mkdú(%s)", 
fun˘i⁄
, 
dú
);

506 i‡(
	`chdú
(
dú
) != 0)

507 
	`sw¨n
("%s: chdú(%s)", 
fun˘i⁄
, 
dú
);

511 i‡(
sockscf
.
°©e
.
ty≥
 =
PROC_MOTHER
) {

512 i‡(
	`pidismaömŸhî
(
sockscf
.
°©e
.
pid
)) {

513 
	`sig£rvîbrﬂdˇ°
(
SIGTERM
);

520 
	`ª£tc⁄fig
(&
sockscf
, 1);

523 i‡(
sockscf
.
°©e
.
ösig«l
)

524 
	`¶og
(
LOG_ALERT
, "%s[%d/%lu]: shutting down on signal %d",

525 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
),

526 
	`pidismŸhî
(
sockscf
.
°©e
.
pid
),

527 ()
sockscf
.
›ti⁄
.
£rvîc
,

528 
sockscf
.
°©e
.
ösig«l
);

530 
	`¶og
(
LOG_ALERT
, "%s[%d/%lu]: shutting down",

531 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
),

532 
	`pidismŸhî
(
sockscf
.
°©e
.
pid
),

533 ()
sockscf
.
›ti⁄
.
£rvîc
);

535 
	`exô
(
code
);

542 #i‡
HAVE_PROFILING


543 
	`exô
(
code
);

545 
	`fÊush
(
NULL
);

546 
	`_exô
(
code
);

548 
	}
}

	@sockd/statistics.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

51 
	$sockd_check_ù˛©ícy
(
des¸ùti⁄
, 
t£¡
, 
åe˚ived
, 
äow
)

52 c⁄° *
des¸ùti⁄
;

53 c⁄° 
timevÆ
 *
t£¡
;

54 c⁄° 
timevÆ
 *
åe˚ived
;

55 c⁄° 
timevÆ
 *
äow
;

57 #i‡
DIAGNOSTIC


58 c⁄° *
fun˘i⁄
 = "sockd_check_ipclatency()";

59 c⁄° 
size_t
 
ßm∂e¢ìded
 = 1000,

60 
möoccuªn˚s
 = 10;

61 c⁄° 
time_t
 
t£c⁄ds_bëwìn_w¨nögs
 = 60;

62 
timevÆ
 
tmaxdñay
, 
tmaxdñay_so_Ár
;

63 
size_t
 
ßm∂ec
;

64 
timevÆ
 
tdiff
;

66 
	`timîsub
(
åe˚ived
, 
t£¡
, &
tdiff
);

68 i‡(
tdiff
.
tv_£c
 < 0) {

69 
	`sw¨nx
("%s: strange ...ÑeceivedÅs (%ld.%06ld) isÉarlierÅhan "

71 
fun˘i⁄
,

72 ()
åe˚ived
->
tv_£c
,

73 ()
åe˚ived
->
tv_u£c
,

74 ()
t£¡
->
tv_£c
,

75 ()
t£¡
->
tv_u£c
);

80 
	`¶og
(
LOG_DEBUG
, "%s: %s: used %luusÅoÑeceive object",

81 
fun˘i⁄
, 
des¸ùti⁄
, 
	`tv2us
(&
tdiff
));

83 i‡(
	`timîis£t
(&
tmaxdñay
)) {

84 i‡(
	`timîcmp
(&
tdiff
, &
tmaxdñay
, >)) {

85 
time_t
 
éa°w¨n
, 
é⁄ge°
;

86 
size_t
 
ovîlﬂdc
;

88 ++
ovîlﬂdc
;

90 i‡((
time_t
)
	`tv2us
(&
tdiff
Ë> 
é⁄ge°
)

91 
é⁄ge°
 = (
time_t
)
	`tv2us
(&
tdiff
);

93 i‡(
	`socks_dif·ime
(
äow
->
tv_£c
, 
éa°w¨n
)

94 >
t£c⁄ds_bëwìn_w¨nögs
) {

95 i‡(
ovîlﬂdc
 >
möoccuªn˚s
)

96 
	`¶og
(
LOG_NOTICE
,

101 ()
ovîlﬂdc
,

102 ()
ovîlﬂdc
 == 1 ? "" : "s",

103 
des¸ùti⁄
,

104 ()
é⁄ge°
,

105 ()
	`socks_dif·ime
(
äow
->
tv_£c
, 
éa°w¨n
),

106 
	`tv2us
(&
tmaxdñay
));

108 
éa°w¨n
 = 
äow
->
tv_£c
;

109 
ovîlﬂdc
 = 0;

110 
é⁄ge°
 = 0;

119 i‡(
	`timîcmp
(&
tdiff
, &
tmaxdñay_so_Ár
, >))

120 
tmaxdñay_so_Ár
 = 
tdiff
;

122 i‡(
ßm∂ec
 =
ßm∂e¢ìded
) {

123 
tmaxdñay
 = 
tmaxdñay_so_Ár
;

125 
	`¶og
(
DEBUG
 ? 
LOG_INFO
 : 
LOG_DEBUG
,

127 
fun˘i⁄
,

128 
	`chûdty≥2°rög
(
sockscf
.
°©e
.
ty≥
),

129 ()
tmaxdñay
.
tv_£c
,

130 ()
tmaxdñay
.
tv_u£c
);

133 ++
ßm∂ec
;

137 
	}
}

	@sockd/udp_port.c

44 #ifde‡
HAVE_CONFIG_H


45 
	~"autoc⁄f.h
"

58 #i‡
HAVE_LINUX_BUGS


59 #unde‡
_XOPEN_SOURCE


60 #unde‡
_XOPEN_SOURCE_EXTENDED


63 
	~<sys/ty≥s.h
>

64 
	~<√töë/ö_sy°m.h
>

65 
	~<√töë/ö.h
>

66 
	~<√töë/ù.h
>

67 
	~<√töë/udp.h
>

69 c⁄° 
	grcsid
[] =

72 
ö_p‹t_t
 *
udphdr_uh_dp‹t
(
udphdr
 *
udp
);

73 
ö_p‹t_t
 *
udphdr_uh_•‹t
(
udphdr
 *
udp
);

74 
uöt16_t
 *
udphdr_uh_uÀn
(
udphdr
 *
udp
);

75 
uöt16_t
 *
udphdr_uh_sum
(
udphdr
 *
udp
);

77 
ö_p‹t_t
 *

78 
	$udphdr_uh_dp‹t
(
udphdr
 *
udp
)

81  &
udp
->
uh_dp‹t
;

82 
	}
}

84 
ö_p‹t_t
 *

85 
	$udphdr_uh_•‹t
(
udphdr
 *
udp
)

88  &
udp
->
uh_•‹t
;

89 
	}
}

91 
uöt16_t
 *

92 
	$udphdr_uh_uÀn
(
udphdr
 *
udp
)

95  &
udp
->
uh_uÀn
;

96 
	}
}

98 
uöt16_t
 *

99 
	$udphdr_uh_sum
(
udphdr
 *
udp
)

102  &
udp
->
uh_sum
;

103 
	}
}

	@unlicensed/bandwidth.c

44 
	~"comm⁄.h
"

46 
	~<m©h.h
>

48 c⁄° 
	grcsid
[] =

51 c⁄° 
	gmoduÀ_b™dwidth_vîsi⁄
[] =

56 
	$bw_u£
(
bw
, 
cöfo
, 
lock
)

57 
shmem_obje˘_t
 *
bw
;

58 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

59 c⁄° 
lock
;

62 ()
bw
;

63 
	}
}

66 
	$bw_unu£
(
bw
, 
cöfo
, 
lock
)

67 
shmem_obje˘_t
 *
bw
;

68 c⁄° 
˛õ¡öfo_t
 *
cöfo
;

69 c⁄° 
lock
;

72 ()
bw
;

73 
	}
}

75 
ssize_t


76 
	$bw_À·
(
bw
, 
lock
)

77 c⁄° 
shmem_obje˘_t
 *
bw
;

78 c⁄° 
lock
;

81 ()
bw
;

82  
SOCKD_BUFSIZE
;

83 
	}
}

86 
	$bw_upd©e
(
bw
, 
bwu£d
, 
bwu£dtime
, 
lock
)

87 
shmem_obje˘_t
 *
bw
;

88 
size_t
 
bwu£d
;

89 c⁄° 
timevÆ
 *
bwu£dtime
;

90 c⁄° 
lock
;

93 ()
bw
;

94 ()
bwu£d
;

95 ()
bwu£dtime
;

96 
	}
}

99 
	$bw_ruÀhasovîÊown
(
ruÀ
, 
äow
, 
ovîÊowok
)

100 c⁄° 
ruÀ_t
 *
ruÀ
;

101 c⁄° 
timevÆ
 *
äow
;

102 
timevÆ
 *
ovîÊowok
;

106 
	}
}

	@unlicensed/bandwidth_key.c

8 
	~"comm⁄.h
"

10 c⁄° 
	grcsid
[] =

13 c⁄° 
li˚n£key_t
 *
	gmoduÀ_b™dwidth_keyv
 = 
NULL
;

14 c⁄° 
size_t
 
	gmoduÀ_b™dwidth_keyc
 = 0;

	@unlicensed/checkmodule.c

46 
	~"comm⁄.h
"

48 c⁄° 
	grcsid
[] =

52 
	$checkmoduÀ
(
«me
)

53 c⁄° *
«me
;

55 c⁄° *
fun˘i⁄
 = "checkmodule()";

57 
	`yyîr‹x
("licenseÉrror: module \"%s\" isÇot installed. "

59 
«me
);

60 
	}
}

63 
	$li˚n£key2°rög
(
key
)

64 c⁄° 
li˚n£key_t
 *
key
;

66 c⁄° *
fun˘i⁄
 = "checkmodule()";

68 
	`yyîr‹x
("somethingáppearsÅo be wrong withÜicensed module installation. "

72  
NULL
;

73 
	}
}

	@unlicensed/ldap.c

50 
	~"comm⁄.h
"

52 c⁄° 
	grcsid
[] =

55 c⁄° 
	gmoduÀ_ld≠_vîsi⁄
[] =

58 #i‡
HAVE_LDAP


60 
	#LDAP_DEPRECATED
 1

	)

61 #i‡
HAVE_LDAP_REBIND_FUNCTION


62 
	#LDAP_REFERRALS


	)

64 #i‡
HAVE_KRB5_H


65 
	~<krb5.h
>

67 #i‡!
HAVE_COM_ERR_IN_KRB5


68 #i‡
HAVE_COM_ERR_H


69 
	~<com_îr.h
>

70 #ñi‡
HAVE_ET_COM_ERR_H


71 
	~<ë/com_îr.h
>

74 #i‡!
HAVE_ERROR_MESSAGE
 && 
HAVE_KRB5_GET_ERR_TEXT


75 
	#îr‹_mesßge
(
code
Ë
	`krb5_gë_îr_ãxt
(
k∑øm
.
c⁄ãxt
, code)

	)

76 #ñi‡!
HAVE_ERROR_MESSAGE
 && 
HAVE_KRB5_GET_ERROR_MESSAGE


77 
	#îr‹_mesßge
(
code
Ë
	`krb5_gë_îr‹_mesßge
(
k∑øm
.
c⁄ãxt
, code)

	)

78 #ñi‡!
HAVE_ERROR_MESSAGE


79 
	gîr_code
[17];

80 c⁄° *
KRB5_CALLCONV


81 
	$îr‹_mesßge
(
code
) {

82 
	`¢¥ötf
(
îr_code
, 16, "%ld", 
code
);

83  
îr_code
;

84 
	}
}

98 #i‡
HAVE_LBER_H


99 
	~<lbî.h
>

101 #i‡
HAVE_LDAP_H


102 
	~<ld≠.h
>

103 #ñi‡
HAVE_MOZLDAP_LDAP_H


104 
	~<mozld≠/ld≠.h
>

106 #i‡
HAVE_SASL_H


107 
	~<ß¶.h
>

108 #ñi‡
HAVE_SASL_SASL_H


109 
	~<ß¶/ß¶.h
>

110 #ñi‡
HAVE_SASL_DARWIN


111 
	sß¶_öãø˘
 {

112 
	mid
;

113 c⁄° *
	mchÆÀnge
;

114 c⁄° *
	m¥om±
;

115 c⁄° *
	mde‰esu…
;

116 c⁄° *
	mªsu…
;

117 
	mÀn
;

118 } 
	tß¶_öãø˘_t
;

119 
	#SASL_CB_USER
 (0x4001Ë

	)

120 
	#SASL_CB_AUTHNAME
 (0x4002Ë

	)

121 
	#SASL_CB_PASS
 (0x4004Ë

	)

122 
	#SASL_CB_ECHOPROMPT
 (0x4005Ë

	)

123 
	#SASL_CB_NOECHOPROMPT
 (0x4006Ë

	)

124 
	#SASL_CB_GETREALM
 (0x4008Ë

	)

125 
	#SASL_CB_LIST_END
 (0Ë

	)

128 #i‚de‡
LDAP_OPT_NETWORK_TIMEOUT


129 
	#LDAP_OPT_NETWORK_TIMEOUT
 (0)

	)

131 #i‚de‡
LDAP_X_OPT_CONNECT_TIMEOUT


132 
	#LDAP_X_OPT_CONNECT_TIMEOUT
 (0)

	)

136 
	$ld≠ˇche£tup
()

138 c⁄° *
fun˘i⁄
 = "ldapcachesetup()";

140 i‡((
sockscf
.
ld≠fd
 = 
	`socks_mklock
(
SOCKD_SHMEMFILE
, 
NULL
, 0)) == -1)

141 
	`£º
("%s: socks_mklock() failedÅo create shmemfile using base %s",

142 
fun˘i⁄
, 
SOCKD_SHMEMFILE
);

144 
	}
}

147 
	$ld≠groupm©ches
(
u£∫ame
, 
u£rdomaö
, 
group
, 
groupdomaö
, 
ruÀ
)

148 c⁄° *
u£∫ame
;

149 c⁄° *
u£rdomaö
;

150 c⁄° *
group
;

151 c⁄° *
groupdomaö
;

152 c⁄° 
ruÀ_t
 *
ruÀ
;

154 c⁄° *
fun˘i⁄
 = "ldapgroupmatches()";

156 ()
ruÀ
;

158 
	`¶og
(
LOG_DEBUG
, "%s: u£r: %†u£∏domaö: %s", 
fun˘i⁄
, 
u£∫ame
,

159 
u£rdomaö
 !
NULL
 ? userdomain : "NULL");

160 
	`¶og
(
LOG_DEBUG
, "%s: group: %†grou∞domaö: %s", 
fun˘i⁄
, 
group
,

161 
groupdomaö
 !
NULL
 ? groupdomain: "NULL");

164 
	}
}

167 
	$ˇche_ld≠_u£r
(
u£∫ame
, 
ªtvÆ
)

168 c⁄° *
u£∫ame
;

169 
ªtvÆ
;

172 ()
u£∫ame
;

173 ()
ªtvÆ
;

174 
	}
}

177 
	$ld≠_u£r_is_ˇched
(
u£∫ame
)

178 c⁄° *
u£∫ame
;

181 ()
u£∫ame
;

184 
	}
}

	@unlicensed/ldap_key.c

8 
	~"comm⁄.h
"

10 c⁄° 
	grcsid
[] =

13 c⁄° 
li˚n£key_t
 *
	gmoduÀ_ld≠_keyv
 = 
NULL
;

14 c⁄° 
size_t
 
	gmoduÀ_ld≠_keyc
 = 0;

	@unlicensed/redirect.c

44 
	~"comm⁄.h
"

46 c⁄° 
	grcsid
[] =

49 c⁄° 
	gmoduÀ_ªdúe˘_vîsi⁄
[] =

54 
	$ªdúe˘£tup
()

57 
	}
}

60 
ªdúe˘
(
s
, 
addr
,

61 #i‡!
BAREFOOTD


62 
ho°
,

64 
comm™d
, 
‰om


65 #i‡!
BAREFOOTD


66 , 
to


69 
	gs
;

70 
sockaddr_°‹age
 *
	gaddr
;

71 #i‡!
BAREFOOTD


72 
socksho°_t
 *
	gho°
;

74 
	gcomm™d
;

75 c⁄° 
ruÀaddr_t
 *
	g‰om
;

76 #i‡!
BAREFOOTD


77 c⁄° 
ruÀaddr_t
 *
	gto
;

81 ()
	gs
;

82 ()
	gaddr
;

83 #i‡!
BAREFOOTD


84 ()
	gho°
;

86 ()
	gcomm™d
;

87 ()
	g‰om
;

88 #i‡!
BAREFOOTD


89 ()
	gto
;

	@unlicensed/redirect_key.c

8 
	~"comm⁄.h
"

10 c⁄° 
	grcsid
[] =

13 c⁄° 
li˚n£key_t
 *
	gmoduÀ_ªdúe˘_keyv
 = 
NULL
;

14 c⁄° 
size_t
 
	gmoduÀ_ªdúe˘_keyc
 = 0;

	@/usr/include/arpa/inet.h

18 #i‚de‡
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<√töë/ö.h
>

25 #i‚de‡
__sockÀn_t_deföed


26 
__sockÀn_t
 
	tsockÀn_t
;

27 
	#__sockÀn_t_deföed


	)

30 
__BEGIN_DECLS


34 
ö_addr_t
 
	$öë_addr
 (c⁄° *
__˝
Ë
__THROW
;

37 
ö_addr_t
 
	$öë_ aof
 (
ö_addr
 
__ö
Ë
__THROW
;

41 
ö_addr
 
	$öë_makóddr
 (
ö_addr_t
 
__√t
, in_addr_à
__ho°
)

42 
__THROW
;

45 
ö_addr_t
 
	$öë_√tof
 (
ö_addr
 
__ö
Ë
__THROW
;

49 
ö_addr_t
 
	$öë_√tw‹k
 (c⁄° *
__˝
Ë
__THROW
;

53 *
	$öë_¡ﬂ
 (
ö_addr
 
__ö
Ë
__THROW
;

58 
	$öë_±⁄
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

59 *
__ª°ri˘
 
__buf
Ë
__THROW
;

64 c⁄° *
	$öë_¡›
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

65 *
__ª°ri˘
 
__buf
, 
sockÀn_t
 
__Àn
)

66 
__THROW
;

70 #ifde‡
__USE_MISC


73 
	$öë_©⁄
 (c⁄° *
__˝
, 
ö_addr
 *
__öp
Ë
__THROW
;

77 *
	$öë_√è
 (
ö_addr_t
 
__√t
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

82 *
	$öë_√t_¡›
 (
__af
, c⁄° *
__˝
, 
__bôs
,

83 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

88 
	$öë_√t_±⁄
 (
__af
, c⁄° *
__˝
,

89 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

94 
	$öë_nßp_addr
 (c⁄° *
__˝
,

95 *
__buf
, 
__Àn
Ë
__THROW
;

99 *
	$öë_nßp_¡ﬂ
 (
__Àn
, c⁄° *
__˝
,

100 *
__buf
Ë
__THROW
;

103 
__END_DECLS


	@/usr/include/arpa/nameser.h

52 #i‚de‡
_ARPA_NAMESER_H_


53 
	#_ARPA_NAMESER_H_


	)

57 
	#BIND_4_COMPAT


	)

59 
	~<sys/∑øm.h
>

60 #i‡(!
deföed
(
BSD
)) || (BSD < 199306)

61 
	~<sys/bôy≥s.h
>

63 
	~<sys/ty≥s.h
>

65 
	~<sys/cdefs.h
>

75 
	#__NAMESER
 19991006

	)

79 
	#NS_PACKETSZ
 512

	)

80 
	#NS_MAXDNAME
 1025

	)

81 
	#NS_MAXMSG
 65535

	)

82 
	#NS_MAXCDNAME
 255

	)

83 
	#NS_MAXLABEL
 63

	)

84 
	#NS_HFIXEDSZ
 12

	)

85 
	#NS_QFIXEDSZ
 4

	)

86 
	#NS_RRFIXEDSZ
 10

	)

87 
	#NS_INT32SZ
 4

	)

88 
	#NS_INT16SZ
 2

	)

89 
	#NS_INT8SZ
 1

	)

90 
	#NS_INADDRSZ
 4

	)

91 
	#NS_IN6ADDRSZ
 16

	)

92 
	#NS_CMPRSFLGS
 0xc0

	)

93 
	#NS_DEFAULTPORT
 53

	)

98 
	e__ns_£˘
 {

99 
	mns_s_qd
 = 0,

100 
	mns_s_zn
 = 0,

101 
	mns_s_™
 = 1,

102 
	mns_s_¥
 = 1,

103 
	mns_s_ns
 = 2,

104 
	mns_s_ud
 = 2,

105 
	mns_s_¨
 = 3,

106 
	mns_s_max
 = 4

107 } 
	tns_£˘
;

114 
	s__ns_msg
 {

115 c⁄° 
u_ch¨
 *
	m_msg
, *
	m_eom
;

116 
u_öt16_t
 
	m_id
, 
	m_Êags
, 
	m_cou¡s
[
ns_s_max
];

117 c⁄° 
u_ch¨
 *
	m_£˘i⁄s
[
ns_s_max
];

118 
ns_£˘
 
	m_£˘
;

119 
	m_ºnum
;

120 c⁄° 
u_ch¨
 *
	m_msg_±r
;

121 } 
	tns_msg
;

124 
	s_ns_Êagd©a
 { 
	mmask
, 
	mshi·
; };

125 c⁄° 
_ns_Êagd©a
 _ns_flagdata[];

129 
	#ns_msg_id
(
h™dÀ
Ë((h™dÀ).
_id
 + 0)

	)

130 
	#ns_msg_ba£
(
h™dÀ
Ë((h™dÀ).
_msg
 + 0)

	)

131 
	#ns_msg_íd
(
h™dÀ
Ë((h™dÀ).
_eom
 + 0)

	)

132 
	#ns_msg_size
(
h™dÀ
Ë((h™dÀ).
_eom
 - (h™dÀ).
_msg
)

	)

133 
	#ns_msg_cou¡
(
h™dÀ
, 
£˘i⁄
Ë((h™dÀ).
_cou¡s
[£˘i⁄] + 0)

	)

138 
	s__ns_º
 {

139 
	m«me
[
NS_MAXDNAME
];

140 
u_öt16_t
 
	mty≥
;

141 
u_öt16_t
 
	mº_˛ass
;

142 
u_öt32_t
 
	mâl
;

143 
u_öt16_t
 
	mrdÀngth
;

144 c⁄° 
u_ch¨
 * 
	mrd©a
;

145 } 
	tns_º
;

148 
	#ns_º_«me
(
º
Ë((‘r).
«me
[0] !'\0'Ë? (º).«mê: ".")

	)

149 
	#ns_º_ty≥
(
º
Ë((
ns_ty≥
)(‘r).
ty≥
 + 0))

	)

150 
	#ns_º_˛ass
(
º
Ë((
ns_˛ass
)(‘r).
º_˛ass
 + 0))

	)

151 
	#ns_º_âl
(
º
Ë(‘r).
âl
 + 0)

	)

152 
	#ns_º_rdÀn
(
º
Ë(‘r).
rdÀngth
 + 0)

	)

153 
	#ns_º_rd©a
(
º
Ë(‘r).
rd©a
 + 0)

	)

160 
	e__ns_Êag
 {

161 
	mns_f_qr
,

162 
	mns_f_›code
,

163 
	mns_f_Ø
,

164 
	mns_f_tc
,

165 
	mns_f_rd
,

166 
	mns_f_ø
,

167 
	mns_f_z
,

168 
	mns_f_ad
,

169 
	mns_f_cd
,

170 
	mns_f_rcode
,

171 
	mns_f_max


172 } 
	tns_Êag
;

177 
	e__ns_›code
 {

178 
	mns_o_quîy
 = 0,

179 
	mns_o_iquîy
 = 1,

180 
	mns_o_°©us
 = 2,

182 
	mns_o_nŸify
 = 4,

183 
	mns_o_upd©e
 = 5,

184 
	mns_o_max
 = 6

185 } 
	tns_›code
;

190 
	e__ns_rcode
 {

191 
	mns_r_n€º‹
 = 0,

192 
	mns_r_f‹mîr
 = 1,

193 
	mns_r_£rvÁû
 = 2,

194 
	mns_r_nxdomaö
 = 3,

195 
	mns_r_nŸim∂
 = 4,

196 
	mns_r_ªfu£d
 = 5,

198 
	mns_r_yxdomaö
 = 6,

199 
	mns_r_yxº£t
 = 7,

200 
	mns_r_nxº£t
 = 8,

201 
	mns_r_nŸauth
 = 9,

202 
	mns_r_nŸz⁄e
 = 10,

203 
	mns_r_max
 = 11,

205 
	mns_r_badvîs
 = 16,

207 
	mns_r_badsig
 = 16,

208 
	mns_r_badkey
 = 17,

209 
	mns_r_badtime
 = 18

210 } 
	tns_rcode
;

213 
	e__ns_upd©e_›î©i⁄
 {

214 
	mns_u›_dñëe
 = 0,

215 
	mns_u›_add
 = 1,

216 
	mns_u›_max
 = 2

217 } 
	tns_upd©e_›î©i⁄
;

222 
	sns_tsig_key
 {

223 
	m«me
[
NS_MAXDNAME
], 
	mÆg
[NS_MAXDNAME];

224 *
	md©a
;

225 
	mÀn
;

227 
ns_tsig_key
 
	tns_tsig_key
;

232 
	sns_t˝_tsig_°©e
 {

233 
	mcou¡î
;

234 
d°_key
 *
	mkey
;

235 *
	m˘x
;

236 
	msig
[
NS_PACKETSZ
];

237 
	msigÀn
;

239 
ns_t˝_tsig_°©e
 
	tns_t˝_tsig_°©e
;

241 
	#NS_TSIG_FUDGE
 300

	)

242 
	#NS_TSIG_TCP_COUNT
 100

	)

243 
	#NS_TSIG_ALG_HMAC_MD5
 "HMAC-MD5.SIG-ALG.REG.INT"

	)

245 
	#NS_TSIG_ERROR_NO_TSIG
 -10

	)

246 
	#NS_TSIG_ERROR_NO_SPACE
 -11

	)

247 
	#NS_TSIG_ERROR_FORMERR
 -12

	)

252 
	e__ns_ty≥
 {

253 
	mns_t_övÆid
 = 0,

254 
	mns_t_a
 = 1,

255 
	mns_t_ns
 = 2,

256 
	mns_t_md
 = 3,

257 
	mns_t_mf
 = 4,

258 
	mns_t_˙ame
 = 5,

259 
	mns_t_sﬂ
 = 6,

260 
	mns_t_mb
 = 7,

261 
	mns_t_mg
 = 8,

262 
	mns_t_mr
 = 9,

263 
	mns_t_nuŒ
 = 10,

264 
	mns_t_wks
 = 11,

265 
	mns_t_±r
 = 12,

266 
	mns_t_höfo
 = 13,

267 
	mns_t_möfo
 = 14,

268 
	mns_t_mx
 = 15,

269 
	mns_t_txt
 = 16,

270 
	mns_t_Ω
 = 17,

271 
	mns_t_afsdb
 = 18,

272 
	mns_t_x25
 = 19,

273 
	mns_t_isdn
 = 20,

274 
	mns_t_π
 = 21,

275 
	mns_t_nßp
 = 22,

276 
	mns_t_nßp_±r
 = 23,

277 
	mns_t_sig
 = 24,

278 
	mns_t_key
 = 25,

279 
	mns_t_px
 = 26,

280 
	mns_t_gpos
 = 27,

281 
	mns_t_ØØ
 = 28,

282 
	mns_t_loc
 = 29,

283 
	mns_t_nxt
 = 30,

284 
	mns_t_eid
 = 31,

285 
	mns_t_nimloc
 = 32,

286 
	mns_t_§v
 = 33,

287 
	mns_t_©ma
 = 34,

288 
	mns_t_«±r
 = 35,

289 
	mns_t_kx
 = 36,

290 
	mns_t_˚π
 = 37,

291 
	mns_t_a6
 = 38,

292 
	mns_t_d«me
 = 39,

293 
	mns_t_sök
 = 40,

294 
	mns_t_›t
 = 41,

295 
	mns_t_≠l
 = 42,

296 
	mns_t_tkey
 = 249,

297 
	mns_t_tsig
 = 250,

298 
	mns_t_ix‰
 = 251,

299 
	mns_t_ax‰
 = 252,

300 
	mns_t_maûb
 = 253,

301 
	mns_t_maûa
 = 254,

302 
	mns_t_™y
 = 255,

303 
	mns_t_zx‰
 = 256,

304 
	mns_t_max
 = 65536

305 } 
	tns_ty≥
;

308 
	#ns_t_qt_p
(
t
Ë(
	`ns_t_x‰_p
—Ë|| (tË=
ns_t_™y
 || \

309 (
t
Ë=
ns_t_maûb
 || (tË=
ns_t_maûa
)

	)

311 
	#ns_t_mº_p
(
t
Ë(—Ë=
ns_t_tsig
 || (tË=
ns_t_›t
)

	)

313 
	#ns_t_º_p
(
t
Ë(!
	`ns_t_qt_p
—Ë&& !
	`ns_t_mº_p
—))

	)

314 
	#ns_t_udp_p
(
t
Ë(—Ë!
ns_t_ax‰
 && (tË!
ns_t_zx‰
)

	)

315 
	#ns_t_x‰_p
(
t
Ë(—Ë=
ns_t_ax‰
 || (tË=
ns_t_ix‰
 || \

316 (
t
Ë=
ns_t_zx‰
)

	)

321 
	e__ns_˛ass
 {

322 
	mns_c_övÆid
 = 0,

323 
	mns_c_ö
 = 1,

324 
	mns_c_2
 = 2,

325 
	mns_c_chaos
 = 3,

326 
	mns_c_hs
 = 4,

328 
	mns_c_n⁄e
 = 254,

329 
	mns_c_™y
 = 255,

330 
	mns_c_max
 = 65536

331 } 
	tns_˛ass
;

335 
	e__ns_key_ty≥s
 {

336 
	mns_kt_rß
 = 1,

337 
	mns_kt_dh
 = 2,

338 
	mns_kt_dß
 = 3,

339 
	mns_kt_¥iv©e
 = 254

340 } 
	tns_key_ty≥s
;

342 
	e__ns_˚π_ty≥s
 {

343 
	m˚π_t_pkix
 = 1,

344 
	m˚π_t_•ki
 = 2,

345 
	m˚π_t_pgp
 = 3,

346 
	m˚π_t_uæ
 = 253,

347 
	m˚π_t_oid
 = 254

348 } 
	tns_˚π_ty≥s
;

351 
	#NS_KEY_TYPEMASK
 0xC000

	)

352 
	#NS_KEY_TYPE_AUTH_CONF
 0x0000

	)

353 
	#NS_KEY_TYPE_CONF_ONLY
 0x8000

	)

354 
	#NS_KEY_TYPE_AUTH_ONLY
 0x4000

	)

355 
	#NS_KEY_TYPE_NO_KEY
 0xC000

	)

357 
	#NS_KEY_NO_AUTH
 0x8000

	)

358 
	#NS_KEY_NO_CONF
 0x4000

	)

359 
	#NS_KEY_RESERVED2
 0x2000

	)

360 
	#NS_KEY_EXTENDED_FLAGS
 0x1000

	)

361 
	#NS_KEY_RESERVED4
 0x0800

	)

362 
	#NS_KEY_RESERVED5
 0x0400

	)

363 
	#NS_KEY_NAME_TYPE
 0x0300

	)

364 
	#NS_KEY_NAME_USER
 0x0000

	)

365 
	#NS_KEY_NAME_ENTITY
 0x0200

	)

366 
	#NS_KEY_NAME_ZONE
 0x0100

	)

367 
	#NS_KEY_NAME_RESERVED
 0x0300

	)

368 
	#NS_KEY_RESERVED8
 0x0080

	)

369 
	#NS_KEY_RESERVED9
 0x0040

	)

370 
	#NS_KEY_RESERVED10
 0x0020

	)

371 
	#NS_KEY_RESERVED11
 0x0010

	)

372 
	#NS_KEY_SIGNATORYMASK
 0x000F

	)

373 
	#NS_KEY_RESERVED_BITMASK
 ( 
NS_KEY_RESERVED2
 | \

374 
NS_KEY_RESERVED4
 | \

375 
NS_KEY_RESERVED5
 | \

376 
NS_KEY_RESERVED8
 | \

377 
NS_KEY_RESERVED9
 | \

378 
NS_KEY_RESERVED10
 | \

379 
NS_KEY_RESERVED11
 )

	)

380 
	#NS_KEY_RESERVED_BITMASK2
 0xFFFF

	)

382 
	#NS_ALG_MD5RSA
 1

	)

383 
	#NS_ALG_DH
 2

	)

384 
	#NS_ALG_DSA
 3

	)

385 
	#NS_ALG_DSS
 
NS_ALG_DSA


	)

386 
	#NS_ALG_EXPIRE_ONLY
 253

	)

387 
	#NS_ALG_PRIVATE_OID
 254

	)

390 
	#NS_KEY_PROT_TLS
 1

	)

391 
	#NS_KEY_PROT_EMAIL
 2

	)

392 
	#NS_KEY_PROT_DNSSEC
 3

	)

393 
	#NS_KEY_PROT_IPSEC
 4

	)

394 
	#NS_KEY_PROT_ANY
 255

	)

397 
	#NS_MD5RSA_MIN_BITS
 512

	)

398 
	#NS_MD5RSA_MAX_BITS
 4096

	)

400 
	#NS_MD5RSA_MAX_BYTES
 ((
NS_MD5RSA_MAX_BITS
+7/8)*2+3)

	)

402 
	#NS_MD5RSA_MAX_BASE64
 (((
NS_MD5RSA_MAX_BYTES
+2)/3)*4)

	)

403 
	#NS_MD5RSA_MIN_SIZE
 ((
NS_MD5RSA_MIN_BITS
+7)/8)

	)

404 
	#NS_MD5RSA_MAX_SIZE
 ((
NS_MD5RSA_MAX_BITS
+7)/8)

	)

406 
	#NS_DSA_SIG_SIZE
 41

	)

407 
	#NS_DSA_MIN_SIZE
 213

	)

408 
	#NS_DSA_MAX_BYTES
 405

	)

411 
	#NS_SIG_TYPE
 0

	)

412 
	#NS_SIG_ALG
 2

	)

413 
	#NS_SIG_LABELS
 3

	)

414 
	#NS_SIG_OTTL
 4

	)

415 
	#NS_SIG_EXPIR
 8

	)

416 
	#NS_SIG_SIGNED
 12

	)

417 
	#NS_SIG_FOOT
 16

	)

418 
	#NS_SIG_SIGNER
 18

	)

420 
	#NS_NXT_BITS
 8

	)

421 
	#NS_NXT_BIT_SET
–
n
,
p
Ë’[“)/
NS_NXT_BITS
] |(0x80>>(“)%NS_NXT_BITS)))

	)

422 
	#NS_NXT_BIT_CLEAR
(
n
,
p
Ë’[“)/
NS_NXT_BITS
] &~(0x80>>(“)%NS_NXT_BITS)))

	)

423 
	#NS_NXT_BIT_ISSET
(
n
,
p
Ë’[“)/
NS_NXT_BITS
] & (0x80>>(“)%NS_NXT_BITS)))

	)

424 
	#NS_NXT_MAX
 127

	)

429 
	#NS_OPT_DNSSEC_OK
 0x8000U

	)

430 
	#NS_OPT_NSID
 3

	)

435 
	#NS_GET16
(
s
, 
˝
) do { \

436 c⁄° 
u_ch¨
 *
t_˝
 = (c⁄° u_ch¨ *)(
˝
); \

437 (
s
Ë((
u_öt16_t
)
t_˝
[0] << 8) \

438 | ((
u_öt16_t
)
t_˝
[1]) \

440 (
˝
Ë+
NS_INT16SZ
; \

441 } 0)

	)

443 
	#NS_GET32
(
l
, 
˝
) do { \

444 c⁄° 
u_ch¨
 *
t_˝
 = (c⁄° u_ch¨ *)(
˝
); \

445 (
l
Ë((
u_öt32_t
)
t_˝
[0] << 24) \

446 | ((
u_öt32_t
)
t_˝
[1] << 16) \

447 | ((
u_öt32_t
)
t_˝
[2] << 8) \

448 | ((
u_öt32_t
)
t_˝
[3]) \

450 (
˝
Ë+
NS_INT32SZ
; \

451 } 0)

	)

453 
	#NS_PUT16
(
s
, 
˝
) do { \

454 
u_öt16_t
 
t_s
 = (u_öt16_t)(
s
); \

455 
u_ch¨
 *
t_˝
 = (u_ch¨ *)(
˝
); \

456 *
t_˝
++ = 
t_s
 >> 8; \

457 *
t_˝
 = 
t_s
; \

458 (
˝
Ë+
NS_INT16SZ
; \

459 } 0)

	)

461 
	#NS_PUT32
(
l
, 
˝
) do { \

462 
u_öt32_t
 
t_l
 = (u_öt32_t)(
l
); \

463 
u_ch¨
 *
t_˝
 = (u_ch¨ *)(
˝
); \

464 *
t_˝
++ = 
t_l
 >> 24; \

465 *
t_˝
++ = 
t_l
 >> 16; \

466 *
t_˝
++ = 
t_l
 >> 8; \

467 *
t_˝
 = 
t_l
; \

468 (
˝
Ë+
NS_INT32SZ
; \

469 } 0)

	)

471 
__BEGIN_DECLS


472 
	$ns_msg_gëÊag
 (
ns_msg
, Ë
__THROW
;

473 
u_öt
 
	$ns_gë16
 (c⁄° 
u_ch¨
 *Ë
__THROW
;

474 
u_l⁄g
 
	$ns_gë32
 (c⁄° 
u_ch¨
 *Ë
__THROW
;

475 
	$ns_put16
 (
u_öt
, 
u_ch¨
 *Ë
__THROW
;

476 
	$ns_put32
 (
u_l⁄g
, 
u_ch¨
 *Ë
__THROW
;

477 
	$ns_öô∑r£
 (c⁄° 
u_ch¨
 *, , 
ns_msg
 *Ë
__THROW
;

478 
	$ns_skùº
 (c⁄° 
u_ch¨
 *, c⁄° u_ch¨ *, 
ns_£˘
, )

479 
__THROW
;

480 
	$ns_∑r£º
 (
ns_msg
 *, 
ns_£˘
, , 
ns_º
 *Ë
__THROW
;

481 
	$ns_•röår
 (c⁄° 
ns_msg
 *, c⁄° 
ns_º
 *,

482 c⁄° *, c⁄° *, *, 
size_t
)

483 
__THROW
;

484 
	$ns_•röårf
 (c⁄° 
u_ch¨
 *, 
size_t
, const *,

485 
ns_˛ass
, 
ns_ty≥
, 
u_l⁄g
, c⁄° 
u_ch¨
 *,

486 
size_t
, const *, const *,

487 *, 
size_t
Ë
__THROW
;

488 
	$ns_f‹m©_âl
 (
u_l⁄g
, *, 
size_t
Ë
__THROW
;

489 
	$ns_∑r£_âl
 (c⁄° *, 
u_l⁄g
 *Ë
__THROW
;

490 
u_öt32_t
 
	$ns_d©ëo£cs
 (c⁄° *, *Ë
__THROW
;

491 
	$ns_«me_¡ﬁ
 (c⁄° 
u_ch¨
 *, u_ch¨ *, 
size_t
Ë
__THROW
;

492 
	$ns_«me_¡›
 (c⁄° 
u_ch¨
 *, *, 
size_t
Ë
__THROW
;

493 
	$ns_«me_±⁄
 (c⁄° *, 
u_ch¨
 *, 
size_t
Ë
__THROW
;

494 
	$ns_«me_u≈ack
 (c⁄° 
u_ch¨
 *, const u_char *,

495 c⁄° 
u_ch¨
 *, u_ch¨ *, 
size_t
Ë
__THROW
;

496 
	$ns_«me_∑ck
 (c⁄° 
u_ch¨
 *, u_char *, ,

497 c⁄° 
u_ch¨
 **, c⁄° u_ch¨ **Ë
__THROW
;

498 
	$ns_«me_uncom¥ess
 (c⁄° 
u_ch¨
 *, const u_char *,

499 c⁄° 
u_ch¨
 *, *, 
size_t
Ë
__THROW
;

500 
	$ns_«me_com¥ess
 (c⁄° *, 
u_ch¨
 *, 
size_t
,

501 c⁄° 
u_ch¨
 **, c⁄° u_ch¨ **Ë
__THROW
;

502 
	$ns_«me_skù
 (c⁄° 
u_ch¨
 **, c⁄° u_ch¨ *Ë
__THROW
;

503 
	$ns_«me_rﬁlback
 (c⁄° 
u_ch¨
 *, const u_char **,

504 c⁄° 
u_ch¨
 **Ë
__THROW
;

505 
	$ns_sign
 (
u_ch¨
 *, *, , , *,

506 c⁄° 
u_ch¨
 *, , u_ch¨ *, *, 
time_t
Ë
__THROW
;

507 
	$ns_sign2
 (
u_ch¨
 *, *, , , *,

508 c⁄° 
u_ch¨
 *, , u_ch¨ *, *, 
time_t
,

509 
u_ch¨
 **, u_ch¨ **Ë
__THROW
;

510 
	$ns_sign_t˝
 (
u_ch¨
 *, *, , ,

511 
ns_t˝_tsig_°©e
 *, Ë
__THROW
;

512 
	$ns_sign_t˝2
 (
u_ch¨
 *, *, , ,

513 
ns_t˝_tsig_°©e
 *, ,

514 
u_ch¨
 **, u_ch¨ **Ë
__THROW
;

515 
	$ns_sign_t˝_öô
 (*, c⁄° 
u_ch¨
 *, ,

516 
ns_t˝_tsig_°©e
 *Ë
__THROW
;

517 
u_ch¨
 *
	$ns_föd_tsig
 (
u_ch¨
 *, u_ch¨ *Ë
__THROW
;

518 
	$ns_vîify
 (
u_ch¨
 *, *, *, const u_char *, ,

519 
u_ch¨
 *, *, 
time_t
 *, Ë
__THROW
;

520 
	$ns_vîify_t˝
 (
u_ch¨
 *, *, 
ns_t˝_tsig_°©e
 *, )

521 
__THROW
;

522 
	$ns_vîify_t˝_öô
 (*, c⁄° 
u_ch¨
 *, ,

523 
ns_t˝_tsig_°©e
 *Ë
__THROW
;

524 
	$ns_ßmedomaö
 (c⁄° *, c⁄° *Ë
__THROW
;

525 
	$ns_subdomaö
 (c⁄° *, c⁄° *Ë
__THROW
;

526 
	$ns_makeˇn⁄
 (c⁄° *, *, 
size_t
Ë
__THROW
;

527 
	$ns_ßmíame
 (c⁄° *, c⁄° *Ë
__THROW
;

528 
__END_DECLS


530 #ifde‡
BIND_4_COMPAT


531 
	~<¨∑/«me£r_com∑t.h
>

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #unde‡
_ASSERT_H


25 #unde‡
as£π


26 #unde‡
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #unde‡
as£π_≥º‹


34 
	#_ASSERT_H
 1

	)

35 
	~<„©uªs.h
>

37 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #i‚de‡
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£π_Áû
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
,

70 
__löe
, c⁄° *
__fun˘i⁄
)

71 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

74 
	$__as£π_≥º‹_Áû
 (
__î∫um
, c⁄° *
__fûe
,

75 
__löe
, c⁄° *
__fun˘i⁄
)

76 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

81 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

82 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

85 
__END_DECLS


88 
	#as£π
(
ex¥
) \

89 ((
ex¥
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£π_Áû
 (
	`__STRING
(
ex¥
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£π_≥º‹
(
î∫um
) \

95 (!(
î∫um
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #i‡
deföed
 
__˝lu•lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((c⁄° *Ë0)

	)

118 #i‡
deföed
 
__USE_ISOC11
 && !deföed 
__˝lu•lus


120 #unde‡
°©ic_as£π


121 
	#°©ic_as£π
 
_Sètic_as£π


	)

	@/usr/include/com_err.h

11 #i‡!
deföed
(
__COM_ERR_H
Ë&& !deföed(
__COM_ERR_H__
)

13 #ifde‡
__GNUC__


14 
	#COM_ERR_ATTR
(
x
Ë
	`__©åibuã__
(x)

	)

16 
	#COM_ERR_ATTR
(
x
)

	)

19 
	~<°ddef.h
>

20 
	~<°d¨g.h
>

22 
	tîrcode_t
;

24 
	sîr‹_èbÀ
 {

25 c⁄° * c⁄° * 
	mmsgs
;

26 
	mba£
;

27 
	mn_msgs
;

29 
	gë_li°
;

31 
	$com_îr
 (const *, , const *, ...)

32 
	`COM_ERR_ATTR
((
	`f‹m©
(
¥ötf
, 3, 4)));

34 
	$com_îr_va
 (c⁄° *
whﬂmi
, 
îrcode_t
 
code
, c⁄° *
fmt
,

35 
va_li°
 
¨gs
)

36 
	`COM_ERR_ATTR
((
	`f‹m©
(
¥ötf
, 3, 0)));

38 c⁄° *
	`îr‹_mesßge
 ();

39 (*
com_îr_hook
Ë(c⁄° *, , c⁄° *, 
va_li°
);

40 (*
	`£t_com_îr_hook
 ((*) (const *, ,

41 c⁄° *, 
va_li°
)))

42 (c⁄° *, , c⁄° *, 
va_li°
);

43 (*
	$ª£t_com_îr_hook
 ()) (const *, ,

44 c⁄° *, 
va_li°
);

45 
	`öô_îr‹_èbÀ
(c⁄° * c⁄° *
msgs
, 
ba£
, 
cou¡
);

46 *(*
	`£t_com_îr_gëãxt
 (*(*) (const *)))

49 
îrcode_t
 
	`add_îr‹_èbÀ
(c⁄° 
îr‹_èbÀ
 * 
ë
);

50 
îrcode_t
 
	`ªmove_îr‹_èbÀ
(c⁄° 
îr‹_èbÀ
 * 
ë
);

51 
	`add_to_îr‹_èbÀ
(
ë_li°
 *
√w_èbÀ
);

54 c⁄° *
	`com_right
(
ë_li°
 *
li°
, 
code
);

55 c⁄° *
	`com_right_r
(
ë_li°
 *
li°
, 
code
, *
°r
, 
size_t
 
Àn
);

56 
	`öôülize_îr‹_èbÀ_r
(
ë_li°
 **
li°
,

57 c⁄° **
mesßges
,

58 
num_îr‹s
,

59 
ba£
);

60 
	`‰ì_îr‹_èbÀ
(
ë_li°
 *
ë
);

63 
	`ë_li°_lock
();

64 
	`ë_li°_u∆ock
();

66 
	#__COM_ERR_H


	)

67 
	#__COM_ERR_H__


	)

	@/usr/include/crypt.h

24 #i‚de‡
_CRYPT_H


25 
	#_CRYPT_H
 1

	)

27 
	~<„©uªs.h
>

29 
__BEGIN_DECLS


32 *
	$¸y±
 (c⁄° *
__key
, c⁄° *
__ß…
)

33 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

36 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

40 
	$í¸y±
 (*
__glibc_block
, 
__edÊag
)

41 
__THROW
 
	`__n⁄nuŒ
 ((1));

43 #ifde‡
__USE_GNU


46 
	s¸y±_d©a


48 
keysched
[16 * 8];

49 
sb0
[32768];

50 
sb1
[32768];

51 
sb2
[32768];

52 
sb3
[32768];

54 
¸y±_3_buf
[14];

55 
cuºít_ß…
[2];

56 
cuºít_ß…bôs
;

57 
dúe˘i⁄
, 
öôülized
;

60 *
	$¸y±_r
 (c⁄° *
__key
, c⁄° *
__ß…
,

61 
¸y±_d©a
 * 
__ª°ri˘
 
__d©a
)

62 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

64 
	$£tkey_r
 (c⁄° *
__key
,

65 
¸y±_d©a
 * 
__ª°ri˘
 
__d©a
)

66 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

68 
	$í¸y±_r
 (*
__glibc_block
, 
__edÊag
,

69 
¸y±_d©a
 * 
__ª°ri˘
 
__d©a
)

70 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

73 
__END_DECLS


	@/usr/include/ctype.h

22 #i‚def 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	g__BEGIN_DECLS


30 #i‚de‡
_ISbô


39 
	~<ídün.h
>

40 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


41 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

43 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

48 
	m_ISuµî
 = 
_ISbô
 (0),

49 
	m_ISlowî
 = 
_ISbô
 (1),

50 
	m_ISÆpha
 = 
_ISbô
 (2),

51 
	m_ISdigô
 = 
_ISbô
 (3),

52 
	m_ISxdigô
 = 
_ISbô
 (4),

53 
	m_IS•a˚
 = 
_ISbô
 (5),

54 
	m_IS¥öt
 = 
_ISbô
 (6),

55 
	m_ISgøph
 = 
_ISbô
 (7),

56 
	m_ISbœnk
 = 
_ISbô
 (8),

57 
	m_IS˙ål
 = 
_ISbô
 (9),

58 
	m_ISpun˘
 = 
_ISbô
 (10),

59 
	m_ISÆnum
 = 
_ISbô
 (11)

79 c⁄° **
	$__˘y≥_b_loc
 ()

80 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

81 c⁄° 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

82 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

83 c⁄° 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

84 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

87 #i‚de‡
__˝lu•lus


88 
	#__is˘y≥
(
c
, 
ty≥
) \

89 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

90 #ñi‡
deföed
 
__USE_EXTERN_INLINES


91 
	#__is˘y≥_f
(
ty≥
) \

92 
__exã∫_ölöe
 \

93 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

95  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

96 
	}

	)
}

99 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

100 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

102 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__ex˘y≥
 (
iß um
);

111 
__ex˘y≥
 (
ißÕha
);

112 
__ex˘y≥
 (
is˙ål
);

113 
__ex˘y≥
 (
isdigô
);

114 
__ex˘y≥
 (
i¶owî
);

115 
__ex˘y≥
 (
isgøph
);

116 
__ex˘y≥
 (
i•röt
);

117 
__ex˘y≥
 (
i•un˘
);

118 
__ex˘y≥
 (
is•a˚
);

119 
__ex˘y≥
 (
isuµî
);

120 
__ex˘y≥
 (
isxdigô
);

124 
	$tﬁowî
 (
__c
Ë
__THROW
;

127 
	$touµî
 (
__c
Ë
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__ex˘y≥
 (
isbœnk
);

138 
__END_NAMESPACE_C99


141 #ifde‡
__USE_GNU


143 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

146 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


150 
	$ißscii
 (
__c
Ë
__THROW
;

154 
	$tﬂscii
 (
__c
Ë
__THROW
;

158 
	`__ex˘y≥
 (
_touµî
);

159 
	`__ex˘y≥
 (
_tﬁowî
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

164 (
__exãnsi⁄__
 \

165 ({ 
__ªs
; \

166 i‡( (
c
) > 1) \

168 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

174 
__ªs
 = 
f
 
¨gs
; \

177 
__ªs
 = (
a
)[(Ë(
c
)]; \

178 
__ªs
; 
	}
}))

	)

180 #i‡!
deföed
 
__NO_CTYPE


181 #ifde‡
__is˘y≥_f


182 
	$__is˘y≥_f
 (
Ænum
)

183 
	$__is˘y≥_f
 (
Æpha
)

184 
	$__is˘y≥_f
 (
˙ål
)

185 
	$__is˘y≥_f
 (
digô
)

186 
	$__is˘y≥_f
 (
lowî
)

187 
	$__is˘y≥_f
 (
gøph
)

188 
	$__is˘y≥_f
 (
¥öt
)

189 
	$__is˘y≥_f
 (
pun˘
)

190 
	$__is˘y≥_f
 (
•a˚
)

191 
	$__is˘y≥_f
 (
uµî
)

192 
	$__is˘y≥_f
 (
xdigô
)

193 #ifde‡
__USE_ISOC99


194 
	$__is˘y≥_f
 (
bœnk
)

196 #ñi‡
deföed
 
__is˘y≥


197 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

198 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

199 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

200 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

201 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

202 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

203 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

204 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

205 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

206 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

207 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

208 #ifde‡
__USE_ISOC99


209 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

213 #ifde‡
__USE_EXTERN_INLINES


214 
__exã∫_ölöe
 

215 
	`__NTH
 (
	$tﬁowî
 (
__c
))

217  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

218 
	}
}

220 
__exã∫_ölöe
 

221 
__NTH
 (
	$touµî
 (
__c
))

223  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

224 
	}
}

227 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


228 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

229 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

232 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


233 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

234 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

236 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

237 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

243 #ifde‡
__USE_XOPEN2K8


257 
	~<xloˇÀ.h
>

261 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

262 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

264 
	#__ex˘y≥_l
(
«me
) \

265 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

271 
__ex˘y≥_l
 (
iß um_l
);

272 
__ex˘y≥_l
 (
ißÕha_l
);

273 
__ex˘y≥_l
 (
is˙ål_l
);

274 
__ex˘y≥_l
 (
isdigô_l
);

275 
__ex˘y≥_l
 (
i¶owî_l
);

276 
__ex˘y≥_l
 (
isgøph_l
);

277 
__ex˘y≥_l
 (
i•röt_l
);

278 
__ex˘y≥_l
 (
i•un˘_l
);

279 
__ex˘y≥_l
 (
is•a˚_l
);

280 
__ex˘y≥_l
 (
isuµî_l
);

281 
__ex˘y≥_l
 (
isxdigô_l
);

283 
__ex˘y≥_l
 (
isbœnk_l
);

287 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

288 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

291 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

292 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

294 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


295 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

296 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

297 
	#__touµî_l
(
c
, 
loˇÀ
) \

298 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

299 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

300 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

304 #i‚de‡
__NO_CTYPE


305 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

306 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

307 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

308 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

309 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

310 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

311 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

312 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

313 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

314 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

315 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

317 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

319 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


320 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

321 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

324 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

325 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

326 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

327 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

328 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

329 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

330 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

331 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

332 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

333 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

334 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

336 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

338 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


339 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

340 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/curl/curl.h

1 #i‚de‡
__CURL_CURL_H


2 
	#__CURL_CURL_H


	)

33 
	~"cuævî.h
"

34 
	~"cuæbuûd.h
"

35 
	~"cuæruÀs.h
"

41 #i‡(
deföed
(
_WIN32
Ë|| deföed(
__WIN32__
)) && \

42 !
deföed
(
WIN32
Ë&& !
	$deföed
(
__SYMBIAN32__
)

43 
	#WIN32


	)

46 
	~<°dio.h
>

47 
	~<limôs.h
>

49 #i‡
	`deföed
(
__FªeBSD__
) && (__FreeBSD__ >= 2)

51 
	~<o§ñd©e.h
>

55 
	~<sys/ty≥s.h
>

56 
	~<time.h
>

58 #i‡
	`deföed
(
WIN32
Ë&& !deföed(
_WIN32_WCE
Ë&& !deföed(
__CYGWIN__
)

59 #i‡!(
	`deföed
(
_WINSOCKAPI_
Ë|| deföed(
_WINSOCK_H
Ë|| deföed(
__LWIP_OPT_H__
))

62 
	~<wösock2.h
>

63 
	~<ws2t˝ù.h
>

70 #i‡
	`deföed
(
_AIX
Ë|| deföed(
__NOVELL_LIBC__
Ë|| deföed(
__NëBSD__
) || \

71 
	`deföed
(
__möix
Ë|| deföed(
__SYMBIAN32__
Ë|| deföed(
__INTEGRITY
) || \

72 
	`deföed
(
ANDROID
Ë|| deföed(
__ANDROID__
Ë|| deföed(
__O≥nBSD__
) || \

73 (
	`deföed
(
__FªeBSD_vîsi⁄
) && (__FreeBSD_version < 800000))

74 
	~<sys/£À˘.h
>

77 #i‡!
	`deföed
(
WIN32
Ë&& !deföed(
_WIN32_WCE
)

78 
	~<sys/sockë.h
>

81 #i‡!
	`deföed
(
WIN32
Ë&& !deföed(
__WATCOMC__
Ë&& !deföed(
__VXWORKS__
)

82 
	~<sys/time.h
>

85 #ifde‡
__BEOS__


86 
	~<suµ‹t/Suµ‹tDefs.h
>

89 #ifde‡ 
__˝lu•lus


93 
	tCURL
;

99 #ifde‡
CURL_STATICLIB


100 
	#CURL_EXTERN


	)

101 #ñi‡
	`deföed
(
WIN32
Ë|| deföed(
_WIN32
Ë|| deföed(
__SYMBIAN32__
)

102 #i‡
	`deföed
(
BUILDING_LIBCURL
)

103 
	#CURL_EXTERN
 
	`__de˛•ec
(
dŒexp‹t
)

	)

105 
	#CURL_EXTERN
 
	`__de˛•ec
(
dŒimp‹t
)

	)

107 #ñi‡
	`deföed
(
BUILDING_LIBCURL
Ë&& deföed(
CURL_HIDDEN_SYMBOLS
)

108 
	#CURL_EXTERN
 
CURL_EXTERN_SYMBOL


	)

110 
	#CURL_EXTERN


	)

113 #i‚de‡
cuæ_sockë_ty≥def


115 #i‡
	`deföed
(
WIN32
Ë&& !deföed(
__LWIP_OPT_H__
)

116 
SOCKET
 
	tcuæ_sockë_t
;

117 
	#CURL_SOCKET_BAD
 
INVALID_SOCKET


	)

119 
	tcuæ_sockë_t
;

120 
	#CURL_SOCKET_BAD
 -1

	)

122 
	#cuæ_sockë_ty≥def


	)

125 
	scuæ_hâµo°
 {

126 
cuæ_hâµo°
 *
√xt
;

127 *
«me
;

128 
«mñígth
;

129 *
c⁄ã¡s
;

130 
c⁄ã¡¶ígth
;

131 *
buf„r
;

132 
buf„æígth
;

133 *
c⁄ã¡ty≥
;

134 
cuæ_¶i°
* 
c⁄ã¡hódî
;

135 
cuæ_hâµo°
 *
m‹e
;

138 
Êags
;

139 
	#HTTPPOST_FILENAME
 (1<<0Ë

	)

140 
	#HTTPPOST_READFILE
 (1<<1Ë

	)

141 
	#HTTPPOST_PTRNAME
 (1<<2Ë

	)

143 
	#HTTPPOST_PTRCONTENTS
 (1<<3Ë

	)

145 
	#HTTPPOST_BUFFER
 (1<<4Ë

	)

146 
	#HTTPPOST_PTRBUFFER
 (1<<5Ë

	)

147 
	#HTTPPOST_CALLBACK
 (1<<6Ë

	)

152 *
showfûíame
;

155 *
u£Ω
;

161 (*
	tcuæ_¥ogªss_ˇŒback
)(*
	t˛õ¡p
,

162 
	td…ŸÆ
,

163 
	td ow
,

164 
	tu…ŸÆ
,

165 
	tu ow
);

169 (*
	tcuæ_x„röfo_ˇŒback
)(*
	t˛õ¡p
,

170 
	tcuæ_off_t
 
	td…ŸÆ
,

171 
	tcuæ_off_t
 
	td ow
,

172 
	tcuæ_off_t
 
	tu…ŸÆ
,

173 
	tcuæ_off_t
 
	tu ow
);

175 #i‚de‡
CURL_MAX_WRITE_SIZE


182 
	#CURL_MAX_WRITE_SIZE
 16384

	)

185 #i‚de‡
CURL_MAX_HTTP_HEADER


189 
	#CURL_MAX_HTTP_HEADER
 (100*1024)

	)

194 
	#CURL_WRITEFUNC_PAUSE
 0x10000001

	)

196 
	`size_t
 (*
	tcuæ_wrôe_ˇŒback
)(*
	tbuf„r
,

197 
	tsize_t
 
	tsize
,

198 
	tsize_t
 
	tnôems
,

199 *
	tout°ªam
);

205 
CURLFILETYPE_FILE
 = 0,

206 
CURLFILETYPE_DIRECTORY
,

207 
CURLFILETYPE_SYMLINK
,

208 
CURLFILETYPE_DEVICE_BLOCK
,

209 
CURLFILETYPE_DEVICE_CHAR
,

210 
CURLFILETYPE_NAMEDPIPE
,

211 
CURLFILETYPE_SOCKET
,

212 
CURLFILETYPE_DOOR
,

214 
CURLFILETYPE_UNKNOWN


215 } 
	tcuæfûëy≥
;

217 
	#CURLFINFOFLAG_KNOWN_FILENAME
 (1<<0)

	)

218 
	#CURLFINFOFLAG_KNOWN_FILETYPE
 (1<<1)

	)

219 
	#CURLFINFOFLAG_KNOWN_TIME
 (1<<2)

	)

220 
	#CURLFINFOFLAG_KNOWN_PERM
 (1<<3)

	)

221 
	#CURLFINFOFLAG_KNOWN_UID
 (1<<4)

	)

222 
	#CURLFINFOFLAG_KNOWN_GID
 (1<<5)

	)

223 
	#CURLFINFOFLAG_KNOWN_SIZE
 (1<<6)

	)

224 
	#CURLFINFOFLAG_KNOWN_HLINKCOUNT
 (1<<7)

	)

230 
	scuæ_fûeöfo
 {

231 *
fûíame
;

232 
cuæfûëy≥
 
fûëy≥
;

233 
time_t
 
time
;

234 
≥rm
;

235 
uid
;

236 
gid
;

237 
cuæ_off_t
 
size
;

238 
h¨dlöks
;

242 *
time
;

243 *
≥rm
;

244 *
u£r
;

245 *
group
;

246 *
èrgë
;

247 } 
°rögs
;

249 
Êags
;

252 * 
b_d©a
;

253 
size_t
 
b_size
;

254 
size_t
 
b_u£d
;

258 
	#CURL_CHUNK_BGN_FUNC_OK
 0

	)

259 
	#CURL_CHUNK_BGN_FUNC_FAIL
 1

	)

260 
	#CURL_CHUNK_BGN_FUNC_SKIP
 2

	)

265 (*
	tcuæ_chunk_bgn_ˇŒback
)(c⁄° *
	tå™s„r_öfo
,

266 *
	t±r
,

267 
	tªmaös
);

270 
	#CURL_CHUNK_END_FUNC_OK
 0

	)

271 
	#CURL_CHUNK_END_FUNC_FAIL
 1

	)

279 (*
	tcuæ_chunk_íd_ˇŒback
)(*
	t±r
);

282 
	#CURL_FNMATCHFUNC_MATCH
 0

	)

283 
	#CURL_FNMATCHFUNC_NOMATCH
 1

	)

284 
	#CURL_FNMATCHFUNC_FAIL
 2

	)

288 (*
	tcuæ_‚m©ch_ˇŒback
)(*
	t±r
,

289 c⁄° *
	t∑âîn
,

290 c⁄° *
	t°rög
);

293 
	#CURL_SEEKFUNC_OK
 0

	)

294 
	#CURL_SEEKFUNC_FAIL
 1

	)

295 
	#CURL_SEEKFUNC_CANTSEEK
 2

	)

297 (*
	tcuæ_£ek_ˇŒback
)(*
	tö°ªam
,

298 
	tcuæ_off_t
 
	toff£t
,

299 
	t‹igö
);

303 
	#CURL_READFUNC_ABORT
 0x10000000

	)

306 
	#CURL_READFUNC_PAUSE
 0x10000001

	)

308 
	`size_t
 (*
	tcuæ_ªad_ˇŒback
)(*
	tbuf„r
,

309 
	tsize_t
 
	tsize
,

310 
	tsize_t
 
	tnôems
,

311 *
	tö°ªam
);

314 
CURLSOCKTYPE_IPCXN
,

315 
CURLSOCKTYPE_ACCEPT
,

316 
CURLSOCKTYPE_LAST


317 } 
	tcuæsockty≥
;

321 
	#CURL_SOCKOPT_OK
 0

	)

322 
	#CURL_SOCKOPT_ERROR
 1

	)

324 
	#CURL_SOCKOPT_ALREADY_CONNECTED
 2

	)

326 (*
	tcuæ_sock›t_ˇŒback
)(*
	t˛õ¡p
,

327 
	tcuæ_sockë_t
 
	tcuæfd
,

328 
	tcuæsockty≥
 
	tpuΩo£
);

330 
	scuæ_sockaddr
 {

331 
Ámûy
;

332 
sockty≥
;

333 
¥Ÿocﬁ
;

334 
addæí
;

337 
sockaddr
 
addr
;

340 
cuæ_sockë_t


341 (*
	tcuæ_›ísockë_ˇŒback
)(*
	t˛õ¡p
,

342 
	tcuæsockty≥
 
	tpuΩo£
,

343 
	tcuæ_sockaddr
 *
	taddªss
);

346 (*
	tcuæ_˛o£sockë_ˇŒback
)(*
	t˛õ¡p
, 
	tcuæ_sockë_t
 
	tôem
);

349 
CURLIOE_OK
,

350 
CURLIOE_UNKNOWNCMD
,

351 
CURLIOE_FAILRESTART
,

352 
CURLIOE_LAST


353 } 
	tcuæi€º
;

356 
CURLIOCMD_NOP
,

357 
CURLIOCMD_RESTARTREAD
,

358 
CURLIOCMD_LAST


359 } 
	tcuæiocmd
;

361 
	`cuæi€º
 (*
	tcuæ_io˘l_ˇŒback
)(
	tCURL
 *
	th™dÀ
,

362 
	tcmd
,

363 *
	t˛õ¡p
);

371 *(*
	tcuæ_mÆloc_ˇŒback
)(
	tsize_t
 
	tsize
);

372 (*
	tcuæ_‰ì_ˇŒback
)(*
	t±r
);

373 *(*
	tcuæ_ªÆloc_ˇŒback
)(*
	t±r
, 
	tsize_t
 
	tsize
);

374 *(*
	tcuæ_°rdup_ˇŒback
)(c⁄° *
	t°r
);

375 *(*
	tcuæ_ˇŒoc_ˇŒback
)(
	tsize_t
 
	tnmemb
, size_à
	tsize
);

379 
CURLINFO_TEXT
 = 0,

380 
CURLINFO_HEADER_IN
,

381 
CURLINFO_HEADER_OUT
,

382 
CURLINFO_DATA_IN
,

383 
CURLINFO_DATA_OUT
,

384 
CURLINFO_SSL_DATA_IN
,

385 
CURLINFO_SSL_DATA_OUT
,

386 
CURLINFO_END


387 } 
	tcuæ_öfŸy≥
;

389 (*
	tcuæ_debug_ˇŒback
)

390 (
	tCURL
 *
	th™dÀ
,

391 
	tcuæ_öfŸy≥
 
	tty≥
,

392 *
	td©a
,

393 
	tsize_t
 
	tsize
,

394 *
	tu£Ωå
);

404 
CURLE_OK
 = 0,

405 
CURLE_UNSUPPORTED_PROTOCOL
,

406 
CURLE_FAILED_INIT
,

407 
CURLE_URL_MALFORMAT
,

408 
CURLE_NOT_BUILT_IN
,

410 
CURLE_COULDNT_RESOLVE_PROXY
,

411 
CURLE_COULDNT_RESOLVE_HOST
,

412 
CURLE_COULDNT_CONNECT
,

413 
CURLE_FTP_WEIRD_SERVER_REPLY
,

414 
CURLE_REMOTE_ACCESS_DENIED
,

417 
CURLE_FTP_ACCEPT_FAILED
,

419 
CURLE_FTP_WEIRD_PASS_REPLY
,

420 
CURLE_FTP_ACCEPT_TIMEOUT
,

423 
CURLE_FTP_WEIRD_PASV_REPLY
,

424 
CURLE_FTP_WEIRD_227_FORMAT
,

425 
CURLE_FTP_CANT_GET_HOST
,

426 
CURLE_OBSOLETE16
,

427 
CURLE_FTP_COULDNT_SET_TYPE
,

428 
CURLE_PARTIAL_FILE
,

429 
CURLE_FTP_COULDNT_RETR_FILE
,

430 
CURLE_OBSOLETE20
,

431 
CURLE_QUOTE_ERROR
,

432 
CURLE_HTTP_RETURNED_ERROR
,

433 
CURLE_WRITE_ERROR
,

434 
CURLE_OBSOLETE24
,

435 
CURLE_UPLOAD_FAILED
,

436 
CURLE_READ_ERROR
,

437 
CURLE_OUT_OF_MEMORY
,

442 
CURLE_OPERATION_TIMEDOUT
,

443 
CURLE_OBSOLETE29
,

444 
CURLE_FTP_PORT_FAILED
,

445 
CURLE_FTP_COULDNT_USE_REST
,

446 
CURLE_OBSOLETE32
,

447 
CURLE_RANGE_ERROR
,

448 
CURLE_HTTP_POST_ERROR
,

449 
CURLE_SSL_CONNECT_ERROR
,

450 
CURLE_BAD_DOWNLOAD_RESUME
,

451 
CURLE_FILE_COULDNT_READ_FILE
,

452 
CURLE_LDAP_CANNOT_BIND
,

453 
CURLE_LDAP_SEARCH_FAILED
,

454 
CURLE_OBSOLETE40
,

455 
CURLE_FUNCTION_NOT_FOUND
,

456 
CURLE_ABORTED_BY_CALLBACK
,

457 
CURLE_BAD_FUNCTION_ARGUMENT
,

458 
CURLE_OBSOLETE44
,

459 
CURLE_INTERFACE_FAILED
,

460 
CURLE_OBSOLETE46
,

461 
CURLE_TOO_MANY_REDIRECTS
 ,

462 
CURLE_UNKNOWN_OPTION
,

463 
CURLE_TELNET_OPTION_SYNTAX
 ,

464 
CURLE_OBSOLETE50
,

465 
CURLE_PEER_FAILED_VERIFICATION
,

467 
CURLE_GOT_NOTHING
,

468 
CURLE_SSL_ENGINE_NOTFOUND
,

469 
CURLE_SSL_ENGINE_SETFAILED
,

471 
CURLE_SEND_ERROR
,

472 
CURLE_RECV_ERROR
,

473 
CURLE_OBSOLETE57
,

474 
CURLE_SSL_CERTPROBLEM
,

475 
CURLE_SSL_CIPHER
,

476 
CURLE_SSL_CACERT
,

477 
CURLE_BAD_CONTENT_ENCODING
,

478 
CURLE_LDAP_INVALID_URL
,

479 
CURLE_FILESIZE_EXCEEDED
,

480 
CURLE_USE_SSL_FAILED
,

481 
CURLE_SEND_FAIL_REWIND
,

483 
CURLE_SSL_ENGINE_INITFAILED
,

484 
CURLE_LOGIN_DENIED
,

486 
CURLE_TFTP_NOTFOUND
,

487 
CURLE_TFTP_PERM
,

488 
CURLE_REMOTE_DISK_FULL
,

489 
CURLE_TFTP_ILLEGAL
,

490 
CURLE_TFTP_UNKNOWNID
,

491 
CURLE_REMOTE_FILE_EXISTS
,

492 
CURLE_TFTP_NOSUCHUSER
,

493 
CURLE_CONV_FAILED
,

494 
CURLE_CONV_REQD
,

499 
CURLE_SSL_CACERT_BADFILE
,

501 
CURLE_REMOTE_FILE_NOT_FOUND
,

502 
CURLE_SSH
,

506 
CURLE_SSL_SHUTDOWN_FAILED
,

508 
CURLE_AGAIN
,

511 
CURLE_SSL_CRL_BADFILE
,

513 
CURLE_SSL_ISSUER_ERROR
,

515 
CURLE_FTP_PRET_FAILED
,

516 
CURLE_RTSP_CSEQ_ERROR
,

517 
CURLE_RTSP_SESSION_ERROR
,

518 
CURLE_FTP_BAD_FILE_LIST
,

519 
CURLE_CHUNK_FAILED
,

520 
CURLE_NO_CONNECTION_AVAILABLE
,

522 
CURL_LAST


523 } 
	tCURLcode
;

525 #i‚de‡
CURL_NO_OLDIES


529 
	#CURLE_OBSOLETE10
 
CURLE_FTP_ACCEPT_FAILED


	)

530 
	#CURLE_OBSOLETE12
 
CURLE_FTP_ACCEPT_TIMEOUT


	)

533 
	#CURLOPT_ENCODING
 
CURLOPT_ACCEPT_ENCODING


	)

536 
	#CURLE_UNKNOWN_TELNET_OPTION
 
CURLE_UNKNOWN_OPTION


	)

540 
	#CURLE_SSL_PEER_CERTIFICATE
 
CURLE_PEER_FAILED_VERIFICATION


	)

544 
	#CURLE_OBSOLETE
 
CURLE_OBSOLETE50


	)

545 
	#CURLE_BAD_PASSWORD_ENTERED
 
CURLE_OBSOLETE46


	)

546 
	#CURLE_BAD_CALLING_ORDER
 
CURLE_OBSOLETE44


	)

547 
	#CURLE_FTP_USER_PASSWORD_INCORRECT
 
CURLE_OBSOLETE10


	)

548 
	#CURLE_FTP_CANT_RECONNECT
 
CURLE_OBSOLETE16


	)

549 
	#CURLE_FTP_COULDNT_GET_SIZE
 
CURLE_OBSOLETE32


	)

550 
	#CURLE_FTP_COULDNT_SET_ASCII
 
CURLE_OBSOLETE29


	)

551 
	#CURLE_FTP_WEIRD_USER_REPLY
 
CURLE_OBSOLETE12


	)

552 
	#CURLE_FTP_WRITE_ERROR
 
CURLE_OBSOLETE20


	)

553 
	#CURLE_LIBRARY_NOT_FOUND
 
CURLE_OBSOLETE40


	)

554 
	#CURLE_MALFORMAT_USER
 
CURLE_OBSOLETE24


	)

555 
	#CURLE_SHARE_IN_USE
 
CURLE_OBSOLETE57


	)

556 
	#CURLE_URL_MALFORMAT_USER
 
CURLE_NOT_BUILT_IN


	)

558 
	#CURLE_FTP_ACCESS_DENIED
 
CURLE_REMOTE_ACCESS_DENIED


	)

559 
	#CURLE_FTP_COULDNT_SET_BINARY
 
CURLE_FTP_COULDNT_SET_TYPE


	)

560 
	#CURLE_FTP_QUOTE_ERROR
 
CURLE_QUOTE_ERROR


	)

561 
	#CURLE_TFTP_DISKFULL
 
CURLE_REMOTE_DISK_FULL


	)

562 
	#CURLE_TFTP_EXISTS
 
CURLE_REMOTE_FILE_EXISTS


	)

563 
	#CURLE_HTTP_RANGE_ERROR
 
CURLE_RANGE_ERROR


	)

564 
	#CURLE_FTP_SSL_FAILED
 
CURLE_USE_SSL_FAILED


	)

568 
	#CURLE_OPERATION_TIMEOUTED
 
CURLE_OPERATION_TIMEDOUT


	)

570 
	#CURLE_HTTP_NOT_FOUND
 
CURLE_HTTP_RETURNED_ERROR


	)

571 
	#CURLE_HTTP_PORT_FAILED
 
CURLE_INTERFACE_FAILED


	)

572 
	#CURLE_FTP_COULDNT_STOR_FILE
 
CURLE_UPLOAD_FAILED


	)

574 
	#CURLE_FTP_PARTIAL_FILE
 
CURLE_PARTIAL_FILE


	)

575 
	#CURLE_FTP_BAD_DOWNLOAD_RESUME
 
CURLE_BAD_DOWNLOAD_RESUME


	)

580 
	#CURLE_ALREADY_COMPLETE
 99999

	)

585 
	`CURLcode
 (*
	tcuæ_c⁄v_ˇŒback
)(*
	tbuf„r
, 
	tsize_t
 
	tÀngth
);

587 
	`CURLcode
 (*
	tcuæ_s¶_˘x_ˇŒback
)(
	tCURL
 *
	tcuæ
,

588 *
	ts¶_˘x
,

590 *
	tu£Ωå
);

593 
CURLPROXY_HTTP
 = 0,

595 
CURLPROXY_HTTP_1_0
 = 1,

597 
CURLPROXY_SOCKS4
 = 4,

599 
CURLPROXY_SOCKS5
 = 5,

600 
CURLPROXY_SOCKS4A
 = 6,

601 
CURLPROXY_SOCKS5_HOSTNAME
 = 7

604 } 
	tcuæ_¥oxyty≥
;

622 
	#CURLAUTH_NONE
 (()0)

	)

623 
	#CURLAUTH_BASIC
 ((()1)<<0)

	)

624 
	#CURLAUTH_DIGEST
 ((()1)<<1)

	)

625 
	#CURLAUTH_GSSNEGOTIATE
 ((()1)<<2)

	)

626 
	#CURLAUTH_NTLM
 ((()1)<<3)

	)

627 
	#CURLAUTH_DIGEST_IE
 ((()1)<<4)

	)

628 
	#CURLAUTH_NTLM_WB
 ((()1)<<5)

	)

629 
	#CURLAUTH_ONLY
 ((()1)<<31)

	)

630 
	#CURLAUTH_ANY
 (~
CURLAUTH_DIGEST_IE
)

	)

631 
	#CURLAUTH_ANYSAFE
 (~(
CURLAUTH_BASIC
|
CURLAUTH_DIGEST_IE
))

	)

633 
	#CURLSSH_AUTH_ANY
 ~0

	)

634 
	#CURLSSH_AUTH_NONE
 0

	)

635 
	#CURLSSH_AUTH_PUBLICKEY
 (1<<0Ë

	)

636 
	#CURLSSH_AUTH_PASSWORD
 (1<<1Ë

	)

637 
	#CURLSSH_AUTH_HOST
 (1<<2Ë

	)

638 
	#CURLSSH_AUTH_KEYBOARD
 (1<<3Ë

	)

639 
	#CURLSSH_AUTH_AGENT
 (1<<4Ë

	)

640 
	#CURLSSH_AUTH_DEFAULT
 
CURLSSH_AUTH_ANY


	)

642 
	#CURLGSSAPI_DELEGATION_NONE
 0

	)

643 
	#CURLGSSAPI_DELEGATION_POLICY_FLAG
 (1<<0Ë

	)

644 
	#CURLGSSAPI_DELEGATION_FLAG
 (1<<1Ë

	)

646 
	#CURL_ERROR_SIZE
 256

	)

648 
	ecuæ_khty≥
 {

649 
CURLKHTYPE_UNKNOWN
,

650 
CURLKHTYPE_RSA1
,

651 
CURLKHTYPE_RSA
,

652 
CURLKHTYPE_DSS


655 
	scuæ_khkey
 {

656 c⁄° *
key
;

658 
size_t
 
Àn
;

659 
cuæ_khty≥
 
keyty≥
;

664 
	ecuæ_kh°©
 {

665 
CURLKHSTAT_FINE_ADD_TO_FILE
,

666 
CURLKHSTAT_FINE
,

667 
CURLKHSTAT_REJECT
,

668 
CURLKHSTAT_DEFER
,

671 
CURLKHSTAT_LAST


675 
	ecuæ_khm©ch
 {

676 
CURLKHMATCH_OK
,

677 
CURLKHMATCH_MISMATCH
,

678 
CURLKHMATCH_MISSING
,

679 
CURLKHMATCH_LAST


683 (*
	tcuæ_sshkeyˇŒback
Ë(
	tCURL
 *
	tósy
,

684 c⁄° 
	tcuæ_khkey
 *
	tknownkey
,

685 c⁄° 
	tcuæ_khkey
 *
	tfoundkey
,

686 
	tcuæ_khm©ch
,

687 *
	t˛õ¡p
);

691 
CURLUSESSL_NONE
,

692 
CURLUSESSL_TRY
,

693 
CURLUSESSL_CONTROL
,

694 
CURLUSESSL_ALL
,

695 
CURLUSESSL_LAST


696 } 
	tcuæ_u£s¶
;

705 
	#CURLSSLOPT_ALLOW_BEAST
 (1<<0)

	)

707 #i‚de‡
CURL_NO_OLDIES


713 
	#CURLFTPSSL_NONE
 
CURLUSESSL_NONE


	)

714 
	#CURLFTPSSL_TRY
 
CURLUSESSL_TRY


	)

715 
	#CURLFTPSSL_CONTROL
 
CURLUSESSL_CONTROL


	)

716 
	#CURLFTPSSL_ALL
 
CURLUSESSL_ALL


	)

717 
	#CURLFTPSSL_LAST
 
CURLUSESSL_LAST


	)

718 
	#cuæ_·ps¶
 
cuæ_u£s¶


	)

723 
CURLFTPSSL_CCC_NONE
,

724 
CURLFTPSSL_CCC_PASSIVE
,

725 
CURLFTPSSL_CCC_ACTIVE
,

726 
CURLFTPSSL_CCC_LAST


727 } 
	tcuæ_·pccc
;

731 
CURLFTPAUTH_DEFAULT
,

732 
CURLFTPAUTH_SSL
,

733 
CURLFTPAUTH_TLS
,

734 
CURLFTPAUTH_LAST


735 } 
	tcuæ_·∑uth
;

739 
CURLFTP_CREATE_DIR_NONE
,

740 
CURLFTP_CREATE_DIR
,

743 
CURLFTP_CREATE_DIR_RETRY
,

745 
CURLFTP_CREATE_DIR_LAST


746 } 
	tcuæ_·p¸óãdú
;

750 
CURLFTPMETHOD_DEFAULT
,

751 
CURLFTPMETHOD_MULTICWD
,

752 
CURLFTPMETHOD_NOCWD
,

753 
CURLFTPMETHOD_SINGLECWD
,

754 
CURLFTPMETHOD_LAST


755 } 
	tcuæ_·pmëhod
;

758 
	#CURLPROTO_HTTP
 (1<<0)

	)

759 
	#CURLPROTO_HTTPS
 (1<<1)

	)

760 
	#CURLPROTO_FTP
 (1<<2)

	)

761 
	#CURLPROTO_FTPS
 (1<<3)

	)

762 
	#CURLPROTO_SCP
 (1<<4)

	)

763 
	#CURLPROTO_SFTP
 (1<<5)

	)

764 
	#CURLPROTO_TELNET
 (1<<6)

	)

765 
	#CURLPROTO_LDAP
 (1<<7)

	)

766 
	#CURLPROTO_LDAPS
 (1<<8)

	)

767 
	#CURLPROTO_DICT
 (1<<9)

	)

768 
	#CURLPROTO_FILE
 (1<<10)

	)

769 
	#CURLPROTO_TFTP
 (1<<11)

	)

770 
	#CURLPROTO_IMAP
 (1<<12)

	)

771 
	#CURLPROTO_IMAPS
 (1<<13)

	)

772 
	#CURLPROTO_POP3
 (1<<14)

	)

773 
	#CURLPROTO_POP3S
 (1<<15)

	)

774 
	#CURLPROTO_SMTP
 (1<<16)

	)

775 
	#CURLPROTO_SMTPS
 (1<<17)

	)

776 
	#CURLPROTO_RTSP
 (1<<18)

	)

777 
	#CURLPROTO_RTMP
 (1<<19)

	)

778 
	#CURLPROTO_RTMPT
 (1<<20)

	)

779 
	#CURLPROTO_RTMPE
 (1<<21)

	)

780 
	#CURLPROTO_RTMPTE
 (1<<22)

	)

781 
	#CURLPROTO_RTMPS
 (1<<23)

	)

782 
	#CURLPROTO_RTMPTS
 (1<<24)

	)

783 
	#CURLPROTO_GOPHER
 (1<<25)

	)

784 
	#CURLPROTO_ALL
 (~0Ë

	)

788 
	#CURLOPTTYPE_LONG
 0

	)

789 
	#CURLOPTTYPE_OBJECTPOINT
 10000

	)

790 
	#CURLOPTTYPE_FUNCTIONPOINT
 20000

	)

791 
	#CURLOPTTYPE_OFF_T
 30000

	)

796 #ifde‡
CINIT


797 #unde‡
CINIT


800 #ifde‡
CURL_ISOCPP


801 
	#CINIT
(
«
,
t
,
nu
Ë
CURLOPT_
 ##Ç®
CURLOPTTYPE_
 ##Å + 
	)
nu

804 
	#LONG
 
CURLOPTTYPE_LONG


	)

805 
	#OBJECTPOINT
 
CURLOPTTYPE_OBJECTPOINT


	)

806 
	#FUNCTIONPOINT
 
CURLOPTTYPE_FUNCTIONPOINT


	)

807 
	#OFF_T
 
CURLOPTTYPE_OFF_T


	)

808 
	#CINIT
(
«me
,
ty≥
,
numbî
Ë
CURLOPT_
Çamêty≥ + 
	)
number

819 
	`CINIT
(
FILE
, 
OBJECTPOINT
, 1),

822 
	`CINIT
(
URL
, 
OBJECTPOINT
, 2),

825 
	`CINIT
(
PORT
, 
LONG
, 3),

828 
	`CINIT
(
PROXY
, 
OBJECTPOINT
, 4),

831 
	`CINIT
(
USERPWD
, 
OBJECTPOINT
, 5),

834 
	`CINIT
(
PROXYUSERPWD
, 
OBJECTPOINT
, 6),

837 
	`CINIT
(
RANGE
, 
OBJECTPOINT
, 7),

842 
	`CINIT
(
INFILE
, 
OBJECTPOINT
, 9),

846 
	`CINIT
(
ERRORBUFFER
, 
OBJECTPOINT
, 10),

850 
	`CINIT
(
WRITEFUNCTION
, 
FUNCTIONPOINT
, 11),

854 
	`CINIT
(
READFUNCTION
, 
FUNCTIONPOINT
, 12),

857 
	`CINIT
(
TIMEOUT
, 
LONG
, 13),

868 
	`CINIT
(
INFILESIZE
, 
LONG
, 14),

871 
	`CINIT
(
POSTFIELDS
, 
OBJECTPOINT
, 15),

874 
	`CINIT
(
REFERER
, 
OBJECTPOINT
, 16),

878 
	`CINIT
(
FTPPORT
, 
OBJECTPOINT
, 17),

881 
	`CINIT
(
USERAGENT
, 
OBJECTPOINT
, 18),

890 
	`CINIT
(
LOW_SPEED_LIMIT
, 
LONG
, 19),

893 
	`CINIT
(
LOW_SPEED_TIME
, 
LONG
, 20),

901 
	`CINIT
(
RESUME_FROM
, 
LONG
, 21),

904 
	`CINIT
(
COOKIE
, 
OBJECTPOINT
, 22),

907 
	`CINIT
(
HTTPHEADER
, 
OBJECTPOINT
, 23),

910 
	`CINIT
(
HTTPPOST
, 
OBJECTPOINT
, 24),

913 
	`CINIT
(
SSLCERT
, 
OBJECTPOINT
, 25),

916 
	`CINIT
(
KEYPASSWD
, 
OBJECTPOINT
, 26),

919 
	`CINIT
(
CRLF
, 
LONG
, 27),

922 
	`CINIT
(
QUOTE
, 
OBJECTPOINT
, 28),

926 
	`CINIT
(
WRITEHEADER
, 
OBJECTPOINT
, 29),

930 
	`CINIT
(
COOKIEFILE
, 
OBJECTPOINT
, 31),

934 
	`CINIT
(
SSLVERSION
, 
LONG
, 32),

937 
	`CINIT
(
TIMECONDITION
, 
LONG
, 33),

941 
	`CINIT
(
TIMEVALUE
, 
LONG
, 34),

949 
	`CINIT
(
CUSTOMREQUEST
, 
OBJECTPOINT
, 36),

952 
	`CINIT
(
STDERR
, 
OBJECTPOINT
, 37),

957 
	`CINIT
(
POSTQUOTE
, 
OBJECTPOINT
, 39),

959 
	`CINIT
(
WRITEINFO
, 
OBJECTPOINT
, 40),

961 
	`CINIT
(
VERBOSE
, 
LONG
, 41),

962 
	`CINIT
(
HEADER
, 
LONG
, 42),

963 
	`CINIT
(
NOPROGRESS
, 
LONG
, 43),

964 
	`CINIT
(
NOBODY
, 
LONG
, 44),

965 
	`CINIT
(
FAILONERROR
, 
LONG
, 45),

966 
	`CINIT
(
UPLOAD
, 
LONG
, 46),

967 
	`CINIT
(
POST
, 
LONG
, 47),

968 
	`CINIT
(
DIRLISTONLY
, 
LONG
, 48),

970 
	`CINIT
(
APPEND
, 
LONG
, 50),

974 
	`CINIT
(
NETRC
, 
LONG
, 51),

976 
	`CINIT
(
FOLLOWLOCATION
, 
LONG
, 52),

978 
	`CINIT
(
TRANSFERTEXT
, 
LONG
, 53),

979 
	`CINIT
(
PUT
, 
LONG
, 54),

987 
	`CINIT
(
PROGRESSFUNCTION
, 
FUNCTIONPOINT
, 56),

991 
	`CINIT
(
PROGRESSDATA
, 
OBJECTPOINT
, 57),

992 
	#CURLOPT_XFERINFODATA
 
CURLOPT_PROGRESSDATA


	)

995 
	`CINIT
(
AUTOREFERER
, 
LONG
, 58),

999 
	`CINIT
(
PROXYPORT
, 
LONG
, 59),

1002 
	`CINIT
(
POSTFIELDSIZE
, 
LONG
, 60),

1005 
	`CINIT
(
HTTPPROXYTUNNEL
, 
LONG
, 61),

1008 
	`CINIT
(
INTERFACE
, 
OBJECTPOINT
, 62),

1013 
	`CINIT
(
KRBLEVEL
, 
OBJECTPOINT
, 63),

1016 
	`CINIT
(
SSL_VERIFYPEER
, 
LONG
, 64),

1020 
	`CINIT
(
CAINFO
, 
OBJECTPOINT
, 65),

1026 
	`CINIT
(
MAXREDIRS
, 
LONG
, 68),

1030 
	`CINIT
(
FILETIME
, 
LONG
, 69),

1033 
	`CINIT
(
TELNETOPTIONS
, 
OBJECTPOINT
, 70),

1036 
	`CINIT
(
MAXCONNECTS
, 
LONG
, 71),

1038 
	`CINIT
(
CLOSEPOLICY
, 
LONG
, 72),

1045 
	`CINIT
(
FRESH_CONNECT
, 
LONG
, 74),

1050 
	`CINIT
(
FORBID_REUSE
, 
LONG
, 75),

1054 
	`CINIT
(
RANDOM_FILE
, 
OBJECTPOINT
, 76),

1057 
	`CINIT
(
EGDSOCKET
, 
OBJECTPOINT
, 77),

1061 
	`CINIT
(
CONNECTTIMEOUT
, 
LONG
, 78),

1065 
	`CINIT
(
HEADERFUNCTION
, 
FUNCTIONPOINT
, 79),

1070 
	`CINIT
(
HTTPGET
, 
LONG
, 80),

1075 
	`CINIT
(
SSL_VERIFYHOST
, 
LONG
, 81),

1079 
	`CINIT
(
COOKIEJAR
, 
OBJECTPOINT
, 82),

1082 
	`CINIT
(
SSL_CIPHER_LIST
, 
OBJECTPOINT
, 83),

1086 
	`CINIT
(
HTTP_VERSION
, 
LONG
, 84),

1091 
	`CINIT
(
FTP_USE_EPSV
, 
LONG
, 85),

1094 
	`CINIT
(
SSLCERTTYPE
, 
OBJECTPOINT
, 86),

1097 
	`CINIT
(
SSLKEY
, 
OBJECTPOINT
, 87),

1100 
	`CINIT
(
SSLKEYTYPE
, 
OBJECTPOINT
, 88),

1103 
	`CINIT
(
SSLENGINE
, 
OBJECTPOINT
, 89),

1108 
	`CINIT
(
SSLENGINE_DEFAULT
, 
LONG
, 90),

1111 
	`CINIT
(
DNS_USE_GLOBAL_CACHE
, 
LONG
, 91),

1114 
	`CINIT
(
DNS_CACHE_TIMEOUT
, 
LONG
, 92),

1117 
	`CINIT
(
PREQUOTE
, 
OBJECTPOINT
, 93),

1120 
	`CINIT
(
DEBUGFUNCTION
, 
FUNCTIONPOINT
, 94),

1123 
	`CINIT
(
DEBUGDATA
, 
OBJECTPOINT
, 95),

1126 
	`CINIT
(
COOKIESESSION
, 
LONG
, 96),

1130 
	`CINIT
(
CAPATH
, 
OBJECTPOINT
, 97),

1133 
	`CINIT
(
BUFFERSIZE
, 
LONG
, 98),

1138 
	`CINIT
(
NOSIGNAL
, 
LONG
, 99),

1141 
	`CINIT
(
SHARE
, 
OBJECTPOINT
, 100),

1145 
	`CINIT
(
PROXYTYPE
, 
LONG
, 101),

1150 
	`CINIT
(
ACCEPT_ENCODING
, 
OBJECTPOINT
, 102),

1153 
	`CINIT
(
PRIVATE
, 
OBJECTPOINT
, 103),

1156 
	`CINIT
(
HTTP200ALIASES
, 
OBJECTPOINT
, 104),

1161 
	`CINIT
(
UNRESTRICTED_AUTH
, 
LONG
, 105),

1166 
	`CINIT
(
FTP_USE_EPRT
, 
LONG
, 106),

1171 
	`CINIT
(
HTTPAUTH
, 
LONG
, 107),

1176 
	`CINIT
(
SSL_CTX_FUNCTION
, 
FUNCTIONPOINT
, 108),

1180 
	`CINIT
(
SSL_CTX_DATA
, 
OBJECTPOINT
, 109),

1186 
	`CINIT
(
FTP_CREATE_MISSING_DIRS
, 
LONG
, 110),

1191 
	`CINIT
(
PROXYAUTH
, 
LONG
, 111),

1197 
	`CINIT
(
FTP_RESPONSE_TIMEOUT
, 
LONG
, 112),

1198 
	#CURLOPT_SERVER_RESPONSE_TIMEOUT
 
CURLOPT_FTP_RESPONSE_TIMEOUT


	)

1203 
	`CINIT
(
IPRESOLVE
, 
LONG
, 113),

1210 
	`CINIT
(
MAXFILESIZE
, 
LONG
, 114),

1215 
	`CINIT
(
INFILESIZE_LARGE
, 
OFF_T
, 115),

1220 
	`CINIT
(
RESUME_FROM_LARGE
, 
OFF_T
, 116),

1225 
	`CINIT
(
MAXFILESIZE_LARGE
, 
OFF_T
, 117),

1231 
	`CINIT
(
NETRC_FILE
, 
OBJECTPOINT
, 118),

1238 
	`CINIT
(
USE_SSL
, 
LONG
, 119),

1241 
	`CINIT
(
POSTFIELDSIZE_LARGE
, 
OFF_T
, 120),

1244 
	`CINIT
(
TCP_NODELAY
, 
LONG
, 121),

1264 
	`CINIT
(
FTPSSLAUTH
, 
LONG
, 129),

1266 
	`CINIT
(
IOCTLFUNCTION
, 
FUNCTIONPOINT
, 130),

1267 
	`CINIT
(
IOCTLDATA
, 
OBJECTPOINT
, 131),

1274 
	`CINIT
(
FTP_ACCOUNT
, 
OBJECTPOINT
, 134),

1277 
	`CINIT
(
COOKIELIST
, 
OBJECTPOINT
, 135),

1280 
	`CINIT
(
IGNORE_CONTENT_LENGTH
, 
LONG
, 136),

1286 
	`CINIT
(
FTP_SKIP_PASV_IP
, 
LONG
, 137),

1290 
	`CINIT
(
FTP_FILEMETHOD
, 
LONG
, 138),

1293 
	`CINIT
(
LOCALPORT
, 
LONG
, 139),

1298 
	`CINIT
(
LOCALPORTRANGE
, 
LONG
, 140),

1302 
	`CINIT
(
CONNECT_ONLY
, 
LONG
, 141),

1306 
	`CINIT
(
CONV_FROM_NETWORK_FUNCTION
, 
FUNCTIONPOINT
, 142),

1310 
	`CINIT
(
CONV_TO_NETWORK_FUNCTION
, 
FUNCTIONPOINT
, 143),

1315 
	`CINIT
(
CONV_FROM_UTF8_FUNCTION
, 
FUNCTIONPOINT
, 144),

1319 
	`CINIT
(
MAX_SEND_SPEED_LARGE
, 
OFF_T
, 145),

1320 
	`CINIT
(
MAX_RECV_SPEED_LARGE
, 
OFF_T
, 146),

1323 
	`CINIT
(
FTP_ALTERNATIVE_TO_USER
, 
OBJECTPOINT
, 147),

1326 
	`CINIT
(
SOCKOPTFUNCTION
, 
FUNCTIONPOINT
, 148),

1327 
	`CINIT
(
SOCKOPTDATA
, 
OBJECTPOINT
, 149),

1331 
	`CINIT
(
SSL_SESSIONID_CACHE
, 
LONG
, 150),

1334 
	`CINIT
(
SSH_AUTH_TYPES
, 
LONG
, 151),

1337 
	`CINIT
(
SSH_PUBLIC_KEYFILE
, 
OBJECTPOINT
, 152),

1338 
	`CINIT
(
SSH_PRIVATE_KEYFILE
, 
OBJECTPOINT
, 153),

1341 
	`CINIT
(
FTP_SSL_CCC
, 
LONG
, 154),

1344 
	`CINIT
(
TIMEOUT_MS
, 
LONG
, 155),

1345 
	`CINIT
(
CONNECTTIMEOUT_MS
, 
LONG
, 156),

1349 
	`CINIT
(
HTTP_TRANSFER_DECODING
, 
LONG
, 157),

1350 
	`CINIT
(
HTTP_CONTENT_DECODING
, 
LONG
, 158),

1354 
	`CINIT
(
NEW_FILE_PERMS
, 
LONG
, 159),

1355 
	`CINIT
(
NEW_DIRECTORY_PERMS
, 
LONG
, 160),

1359 
	`CINIT
(
POSTREDIR
, 
LONG
, 161),

1362 
	`CINIT
(
SSH_HOST_PUBLIC_KEY_MD5
, 
OBJECTPOINT
, 162),

1368 
	`CINIT
(
OPENSOCKETFUNCTION
, 
FUNCTIONPOINT
, 163),

1369 
	`CINIT
(
OPENSOCKETDATA
, 
OBJECTPOINT
, 164),

1372 
	`CINIT
(
COPYPOSTFIELDS
, 
OBJECTPOINT
, 165),

1375 
	`CINIT
(
PROXY_TRANSFER_MODE
, 
LONG
, 166),

1378 
	`CINIT
(
SEEKFUNCTION
, 
FUNCTIONPOINT
, 167),

1379 
	`CINIT
(
SEEKDATA
, 
OBJECTPOINT
, 168),

1382 
	`CINIT
(
CRLFILE
, 
OBJECTPOINT
, 169),

1385 
	`CINIT
(
ISSUERCERT
, 
OBJECTPOINT
, 170),

1388 
	`CINIT
(
ADDRESS_SCOPE
, 
LONG
, 171),

1392 
	`CINIT
(
CERTINFO
, 
LONG
, 172),

1395 
	`CINIT
(
USERNAME
, 
OBJECTPOINT
, 173),

1396 
	`CINIT
(
PASSWORD
, 
OBJECTPOINT
, 174),

1399 
	`CINIT
(
PROXYUSERNAME
, 
OBJECTPOINT
, 175),

1400 
	`CINIT
(
PROXYPASSWORD
, 
OBJECTPOINT
, 176),

1409 
	`CINIT
(
NOPROXY
, 
OBJECTPOINT
, 177),

1412 
	`CINIT
(
TFTP_BLKSIZE
, 
LONG
, 178),

1415 
	`CINIT
(
SOCKS5_GSSAPI_SERVICE
, 
OBJECTPOINT
, 179),

1418 
	`CINIT
(
SOCKS5_GSSAPI_NEC
, 
LONG
, 180),

1424 
	`CINIT
(
PROTOCOLS
, 
LONG
, 181),

1430 
	`CINIT
(
REDIR_PROTOCOLS
, 
LONG
, 182),

1433 
	`CINIT
(
SSH_KNOWNHOSTS
, 
OBJECTPOINT
, 183),

1437 
	`CINIT
(
SSH_KEYFUNCTION
, 
FUNCTIONPOINT
, 184),

1440 
	`CINIT
(
SSH_KEYDATA
, 
OBJECTPOINT
, 185),

1443 
	`CINIT
(
MAIL_FROM
, 
OBJECTPOINT
, 186),

1446 
	`CINIT
(
MAIL_RCPT
, 
OBJECTPOINT
, 187),

1449 
	`CINIT
(
FTP_USE_PRET
, 
LONG
, 188),

1452 
	`CINIT
(
RTSP_REQUEST
, 
LONG
, 189),

1455 
	`CINIT
(
RTSP_SESSION_ID
, 
OBJECTPOINT
, 190),

1458 
	`CINIT
(
RTSP_STREAM_URI
, 
OBJECTPOINT
, 191),

1461 
	`CINIT
(
RTSP_TRANSPORT
, 
OBJECTPOINT
, 192),

1464 
	`CINIT
(
RTSP_CLIENT_CSEQ
, 
LONG
, 193),

1467 
	`CINIT
(
RTSP_SERVER_CSEQ
, 
LONG
, 194),

1470 
	`CINIT
(
INTERLEAVEDATA
, 
OBJECTPOINT
, 195),

1473 
	`CINIT
(
INTERLEAVEFUNCTION
, 
FUNCTIONPOINT
, 196),

1476 
	`CINIT
(
WILDCARDMATCH
, 
LONG
, 197),

1480 
	`CINIT
(
CHUNK_BGN_FUNCTION
, 
FUNCTIONPOINT
, 198),

1484 
	`CINIT
(
CHUNK_END_FUNCTION
, 
FUNCTIONPOINT
, 199),

1487 
	`CINIT
(
FNMATCH_FUNCTION
, 
FUNCTIONPOINT
, 200),

1490 
	`CINIT
(
CHUNK_DATA
, 
OBJECTPOINT
, 201),

1493 
	`CINIT
(
FNMATCH_DATA
, 
OBJECTPOINT
, 202),

1496 
	`CINIT
(
RESOLVE
, 
OBJECTPOINT
, 203),

1499 
	`CINIT
(
TLSAUTH_USERNAME
, 
OBJECTPOINT
, 204),

1502 
	`CINIT
(
TLSAUTH_PASSWORD
, 
OBJECTPOINT
, 205),

1505 
	`CINIT
(
TLSAUTH_TYPE
, 
OBJECTPOINT
, 206),

1517 
	`CINIT
(
TRANSFER_ENCODING
, 
LONG
, 207),

1521 
	`CINIT
(
CLOSESOCKETFUNCTION
, 
FUNCTIONPOINT
, 208),

1522 
	`CINIT
(
CLOSESOCKETDATA
, 
OBJECTPOINT
, 209),

1525 
	`CINIT
(
GSSAPI_DELEGATION
, 
LONG
, 210),

1528 
	`CINIT
(
DNS_SERVERS
, 
OBJECTPOINT
, 211),

1532 
	`CINIT
(
ACCEPTTIMEOUT_MS
, 
LONG
, 212),

1535 
	`CINIT
(
TCP_KEEPALIVE
, 
LONG
, 213),

1538 
	`CINIT
(
TCP_KEEPIDLE
, 
LONG
, 214),

1539 
	`CINIT
(
TCP_KEEPINTVL
, 
LONG
, 215),

1542 
	`CINIT
(
SSL_OPTIONS
, 
LONG
, 216),

1545 
	`CINIT
(
MAIL_AUTH
, 
OBJECTPOINT
, 217),

1548 
	`CINIT
(
SASL_IR
, 
LONG
, 218),

1553 
	`CINIT
(
XFERINFOFUNCTION
, 
FUNCTIONPOINT
, 219),

1556 
	`CINIT
(
XOAUTH2_BEARER
, 
OBJECTPOINT
, 220),

1561 
	`CINIT
(
DNS_INTERFACE
, 
OBJECTPOINT
, 221),

1565 
	`CINIT
(
DNS_LOCAL_IP4
, 
OBJECTPOINT
, 222),

1569 
	`CINIT
(
DNS_LOCAL_IP6
, 
OBJECTPOINT
, 223),

1572 
	`CINIT
(
LOGIN_OPTIONS
, 
OBJECTPOINT
, 224),

1574 
CURLOPT_LASTENTRY


1575 } 
	tCURL›ti⁄
;

1577 #i‚de‡
CURL_NO_OLDIES


1584 
	#CURLOPT_POST301
 
CURLOPT_POSTREDIR


	)

1589 
	#CURLOPT_SSLKEYPASSWD
 
CURLOPT_KEYPASSWD


	)

1590 
	#CURLOPT_FTPAPPEND
 
CURLOPT_APPEND


	)

1591 
	#CURLOPT_FTPLISTONLY
 
CURLOPT_DIRLISTONLY


	)

1592 
	#CURLOPT_FTP_SSL
 
CURLOPT_USE_SSL


	)

1596 
	#CURLOPT_SSLCERTPASSWD
 
CURLOPT_KEYPASSWD


	)

1597 
	#CURLOPT_KRB4LEVEL
 
CURLOPT_KRBLEVEL


	)

1601 #unde‡
CURLOPT_DNS_USE_GLOBAL_CACHE


1608 
	#CURL_IPRESOLVE_WHATEVER
 0

	)

1610 
	#CURL_IPRESOLVE_V4
 1

	)

1611 
	#CURL_IPRESOLVE_V6
 2

	)

1614 
	#CURLOPT_WRITEDATA
 
CURLOPT_FILE


	)

1615 
	#CURLOPT_READDATA
 
CURLOPT_INFILE


	)

1616 
	#CURLOPT_HEADERDATA
 
CURLOPT_WRITEHEADER


	)

1617 
	#CURLOPT_RTSPHEADER
 
CURLOPT_HTTPHEADER


	)

1621 
CURL_HTTP_VERSION_NONE
,

1624 
CURL_HTTP_VERSION_1_0
,

1625 
CURL_HTTP_VERSION_1_1
,

1626 
CURL_HTTP_VERSION_2_0
,

1628 
CURL_HTTP_VERSION_LAST


1635 
CURL_RTSPREQ_NONE
,

1636 
CURL_RTSPREQ_OPTIONS
,

1637 
CURL_RTSPREQ_DESCRIBE
,

1638 
CURL_RTSPREQ_ANNOUNCE
,

1639 
CURL_RTSPREQ_SETUP
,

1640 
CURL_RTSPREQ_PLAY
,

1641 
CURL_RTSPREQ_PAUSE
,

1642 
CURL_RTSPREQ_TEARDOWN
,

1643 
CURL_RTSPREQ_GET_PARAMETER
,

1644 
CURL_RTSPREQ_SET_PARAMETER
,

1645 
CURL_RTSPREQ_RECORD
,

1646 
CURL_RTSPREQ_RECEIVE
,

1647 
CURL_RTSPREQ_LAST


1651 
	eCURL_NETRC_OPTION
 {

1652 
CURL_NETRC_IGNORED
,

1654 
CURL_NETRC_OPTIONAL
,

1656 
CURL_NETRC_REQUIRED
,

1659 
CURL_NETRC_LAST


1663 
CURL_SSLVERSION_DEFAULT
,

1664 
CURL_SSLVERSION_TLSv1
,

1665 
CURL_SSLVERSION_SSLv2
,

1666 
CURL_SSLVERSION_SSLv3
,

1667 
CURL_SSLVERSION_TLSv1_0
,

1668 
CURL_SSLVERSION_TLSv1_1
,

1669 
CURL_SSLVERSION_TLSv1_2
,

1671 
CURL_SSLVERSION_LAST


1674 
	eCURL_TLSAUTH
 {

1675 
CURL_TLSAUTH_NONE
,

1676 
CURL_TLSAUTH_SRP
,

1677 
CURL_TLSAUTH_LAST


1685 
	#CURL_REDIR_GET_ALL
 0

	)

1686 
	#CURL_REDIR_POST_301
 1

	)

1687 
	#CURL_REDIR_POST_302
 2

	)

1688 
	#CURL_REDIR_POST_303
 4

	)

1689 
	#CURL_REDIR_POST_ALL
 \

1690 (
CURL_REDIR_POST_301
|
CURL_REDIR_POST_302
|
CURL_REDIR_POST_303
)

	)

1693 
CURL_TIMECOND_NONE
,

1695 
CURL_TIMECOND_IFMODSINCE
,

1696 
CURL_TIMECOND_IFUNMODSINCE
,

1697 
CURL_TIMECOND_LASTMOD
,

1699 
CURL_TIMECOND_LAST


1700 } 
	tcuæ_TimeC⁄d
;

1705 
CURL_EXTERN
 (
cuæ_°ªquÆ
)(c⁄° *
s1
, c⁄° *
s2
);

1706 
CURL_EXTERN
 (
cuæ_°∫equÆ
)(c⁄° *
s1
, c⁄° *
s2
, 
size_t
 
n
);

1709 #ifde‡
CFINIT


1710 #unde‡
CFINIT


1713 #ifde‡
CURL_ISOCPP


1714 
	#CFINIT
(
«me
Ë
CURLFORM_
 ## 
	)
name

1717 
	#CFINIT
(
«me
Ë
CURLFORM_
 
	)
name

1721 
	`CFINIT
(
NOTHING
),

1724 
	`CFINIT
(
COPYNAME
),

1725 
	`CFINIT
(
PTRNAME
),

1726 
	`CFINIT
(
NAMELENGTH
),

1727 
	`CFINIT
(
COPYCONTENTS
),

1728 
	`CFINIT
(
PTRCONTENTS
),

1729 
	`CFINIT
(
CONTENTSLENGTH
),

1730 
	`CFINIT
(
FILECONTENT
),

1731 
	`CFINIT
(
ARRAY
),

1732 
	`CFINIT
(
OBSOLETE
),

1733 
	`CFINIT
(
FILE
),

1735 
	`CFINIT
(
BUFFER
),

1736 
	`CFINIT
(
BUFFERPTR
),

1737 
	`CFINIT
(
BUFFERLENGTH
),

1739 
	`CFINIT
(
CONTENTTYPE
),

1740 
	`CFINIT
(
CONTENTHEADER
),

1741 
	`CFINIT
(
FILENAME
),

1742 
	`CFINIT
(
END
),

1743 
	`CFINIT
(
OBSOLETE2
),

1745 
	`CFINIT
(
STREAM
),

1747 
CURLFORM_LASTENTRY


1748 } 
	tCURLf‹m›ti⁄
;

1750 #unde‡
CFINIT


1753 
	scuæ_f‹ms
 {

1754 
CURLf‹m›ti⁄
 
›ti⁄
;

1755 c⁄° *
vÆue
;

1775 
CURL_FORMADD_OK
,

1777 
CURL_FORMADD_MEMORY
,

1778 
CURL_FORMADD_OPTION_TWICE
,

1779 
CURL_FORMADD_NULL
,

1780 
CURL_FORMADD_UNKNOWN_OPTION
,

1781 
CURL_FORMADD_INCOMPLETE
,

1782 
CURL_FORMADD_ILLEGAL_ARRAY
,

1783 
CURL_FORMADD_DISABLED
,

1785 
CURL_FORMADD_LAST


1786 } 
	tCURLFORMcode
;

1797 
CURL_EXTERN
 
CURLFORMcode
 
	`cuæ_f‹madd
(
cuæ_hâµo°
 **
hâµo°
,

1798 
cuæ_hâµo°
 **
œ°_po°
,

1809 
	`size_t
 (*
	tcuæ_f‹mgë_ˇŒback
)(*
	t¨g
, c⁄° *
	tbuf
,

1810 
	tsize_t
 
	tÀn
);

1822 
CURL_EXTERN
 
	`cuæ_f‹mgë
(
cuæ_hâµo°
 *
f‹m
, *
¨g
,

1823 
cuæ_f‹mgë_ˇŒback
 
≠≥nd
);

1831 
CURL_EXTERN
 
	`cuæ_f‹m‰ì
(
cuæ_hâµo°
 *
f‹m
);

1841 
CURL_EXTERN
 *
	`cuæ_gëív
(c⁄° *
v¨übÀ
);

1850 
CURL_EXTERN
 *
	`cuæ_vîsi⁄
();

1861 
CURL_EXTERN
 *
	`cuæ_ósy_esˇ≥
(
CURL
 *
h™dÀ
,

1862 c⁄° *
°rög
,

1863 
Àngth
);

1866 
CURL_EXTERN
 *
	`cuæ_esˇ≥
(c⁄° *
°rög
,

1867 
Àngth
);

1881 
CURL_EXTERN
 *
	`cuæ_ósy_u√sˇ≥
(
CURL
 *
h™dÀ
,

1882 c⁄° *
°rög
,

1883 
Àngth
,

1884 *
ouéígth
);

1887 
CURL_EXTERN
 *
	`cuæ_u√sˇ≥
(c⁄° *
°rög
,

1888 
Àngth
);

1898 
CURL_EXTERN
 
	`cuæ_‰ì
(*
p
);

1910 
CURL_EXTERN
 
CURLcode
 
	`cuæ_globÆ_öô
(
Êags
);

1925 
CURL_EXTERN
 
CURLcode
 
	`cuæ_globÆ_öô_mem
(
Êags
,

1926 
cuæ_mÆloc_ˇŒback
 
m
,

1927 
cuæ_‰ì_ˇŒback
 
f
,

1928 
cuæ_ªÆloc_ˇŒback
 
r
,

1929 
cuæ_°rdup_ˇŒback
 
s
,

1930 
cuæ_ˇŒoc_ˇŒback
 
c
);

1940 
CURL_EXTERN
 
	`cuæ_globÆ_˛ónup
();

1943 
	scuæ_¶i°
 {

1944 *
d©a
;

1945 
cuæ_¶i°
 *
√xt
;

1956 
CURL_EXTERN
 
cuæ_¶i°
 *
	`cuæ_¶i°_≠≥nd
(curl_slist *,

1966 
CURL_EXTERN
 
	`cuæ_¶i°_‰ì_Æl
(
cuæ_¶i°
 *);

1977 
CURL_EXTERN
 
time_t
 
	`cuæ_gëd©e
(c⁄° *
p
, c⁄°Åime_à*
unu£d
);

1981 
	scuæ_˚πöfo
 {

1982 
num_of_˚πs
;

1983 
cuæ_¶i°
 **
˚πöfo
;

1990 
CURLSSLBACKEND_NONE
 = 0,

1991 
CURLSSLBACKEND_OPENSSL
 = 1,

1992 
CURLSSLBACKEND_GNUTLS
 = 2,

1993 
CURLSSLBACKEND_NSS
 = 3,

1994 
CURLSSLBACKEND_QSOSSL
 = 4,

1995 
CURLSSLBACKEND_GSKIT
 = 5,

1996 
CURLSSLBACKEND_POLARSSL
 = 6,

1997 
CURLSSLBACKEND_CYASSL
 = 7,

1998 
CURLSSLBACKEND_SCHANNEL
 = 8,

1999 
CURLSSLBACKEND_DARWINSSL
 = 9

2000 } 
	tcuæ_s¶backíd
;

2005 
	scuæ_és£ssi⁄öfo
 {

2006 
cuæ_s¶backíd
 
backíd
;

2007 *
öã∫Æs
;

2010 
	#CURLINFO_STRING
 0x100000

	)

2011 
	#CURLINFO_LONG
 0x200000

	)

2012 
	#CURLINFO_DOUBLE
 0x300000

	)

2013 
	#CURLINFO_SLIST
 0x400000

	)

2014 
	#CURLINFO_MASK
 0x0fffff

	)

2015 
	#CURLINFO_TYPEMASK
 0xf00000

	)

2018 
CURLINFO_NONE
,

2019 
CURLINFO_EFFECTIVE_URL
 = 
CURLINFO_STRING
 + 1,

2020 
CURLINFO_RESPONSE_CODE
 = 
CURLINFO_LONG
 + 2,

2021 
CURLINFO_TOTAL_TIME
 = 
CURLINFO_DOUBLE
 + 3,

2022 
CURLINFO_NAMELOOKUP_TIME
 = 
CURLINFO_DOUBLE
 + 4,

2023 
CURLINFO_CONNECT_TIME
 = 
CURLINFO_DOUBLE
 + 5,

2024 
CURLINFO_PRETRANSFER_TIME
 = 
CURLINFO_DOUBLE
 + 6,

2025 
CURLINFO_SIZE_UPLOAD
 = 
CURLINFO_DOUBLE
 + 7,

2026 
CURLINFO_SIZE_DOWNLOAD
 = 
CURLINFO_DOUBLE
 + 8,

2027 
CURLINFO_SPEED_DOWNLOAD
 = 
CURLINFO_DOUBLE
 + 9,

2028 
CURLINFO_SPEED_UPLOAD
 = 
CURLINFO_DOUBLE
 + 10,

2029 
CURLINFO_HEADER_SIZE
 = 
CURLINFO_LONG
 + 11,

2030 
CURLINFO_REQUEST_SIZE
 = 
CURLINFO_LONG
 + 12,

2031 
CURLINFO_SSL_VERIFYRESULT
 = 
CURLINFO_LONG
 + 13,

2032 
CURLINFO_FILETIME
 = 
CURLINFO_LONG
 + 14,

2033 
CURLINFO_CONTENT_LENGTH_DOWNLOAD
 = 
CURLINFO_DOUBLE
 + 15,

2034 
CURLINFO_CONTENT_LENGTH_UPLOAD
 = 
CURLINFO_DOUBLE
 + 16,

2035 
CURLINFO_STARTTRANSFER_TIME
 = 
CURLINFO_DOUBLE
 + 17,

2036 
CURLINFO_CONTENT_TYPE
 = 
CURLINFO_STRING
 + 18,

2037 
CURLINFO_REDIRECT_TIME
 = 
CURLINFO_DOUBLE
 + 19,

2038 
CURLINFO_REDIRECT_COUNT
 = 
CURLINFO_LONG
 + 20,

2039 
CURLINFO_PRIVATE
 = 
CURLINFO_STRING
 + 21,

2040 
CURLINFO_HTTP_CONNECTCODE
 = 
CURLINFO_LONG
 + 22,

2041 
CURLINFO_HTTPAUTH_AVAIL
 = 
CURLINFO_LONG
 + 23,

2042 
CURLINFO_PROXYAUTH_AVAIL
 = 
CURLINFO_LONG
 + 24,

2043 
CURLINFO_OS_ERRNO
 = 
CURLINFO_LONG
 + 25,

2044 
CURLINFO_NUM_CONNECTS
 = 
CURLINFO_LONG
 + 26,

2045 
CURLINFO_SSL_ENGINES
 = 
CURLINFO_SLIST
 + 27,

2046 
CURLINFO_COOKIELIST
 = 
CURLINFO_SLIST
 + 28,

2047 
CURLINFO_LASTSOCKET
 = 
CURLINFO_LONG
 + 29,

2048 
CURLINFO_FTP_ENTRY_PATH
 = 
CURLINFO_STRING
 + 30,

2049 
CURLINFO_REDIRECT_URL
 = 
CURLINFO_STRING
 + 31,

2050 
CURLINFO_PRIMARY_IP
 = 
CURLINFO_STRING
 + 32,

2051 
CURLINFO_APPCONNECT_TIME
 = 
CURLINFO_DOUBLE
 + 33,

2052 
CURLINFO_CERTINFO
 = 
CURLINFO_SLIST
 + 34,

2053 
CURLINFO_CONDITION_UNMET
 = 
CURLINFO_LONG
 + 35,

2054 
CURLINFO_RTSP_SESSION_ID
 = 
CURLINFO_STRING
 + 36,

2055 
CURLINFO_RTSP_CLIENT_CSEQ
 = 
CURLINFO_LONG
 + 37,

2056 
CURLINFO_RTSP_SERVER_CSEQ
 = 
CURLINFO_LONG
 + 38,

2057 
CURLINFO_RTSP_CSEQ_RECV
 = 
CURLINFO_LONG
 + 39,

2058 
CURLINFO_PRIMARY_PORT
 = 
CURLINFO_LONG
 + 40,

2059 
CURLINFO_LOCAL_IP
 = 
CURLINFO_STRING
 + 41,

2060 
CURLINFO_LOCAL_PORT
 = 
CURLINFO_LONG
 + 42,

2061 
CURLINFO_TLS_SESSION
 = 
CURLINFO_SLIST
 + 43,

2064 
CURLINFO_LASTONE
 = 43

2065 } 
	tCURLINFO
;

2069 
	#CURLINFO_HTTP_CODE
 
CURLINFO_RESPONSE_CODE


	)

2072 
CURLCLOSEPOLICY_NONE
,

2074 
CURLCLOSEPOLICY_OLDEST
,

2075 
CURLCLOSEPOLICY_LEAST_RECENTLY_USED
,

2076 
CURLCLOSEPOLICY_LEAST_TRAFFIC
,

2077 
CURLCLOSEPOLICY_SLOWEST
,

2078 
CURLCLOSEPOLICY_CALLBACK
,

2080 
CURLCLOSEPOLICY_LAST


2081 } 
	tcuæ_˛o£pﬁicy
;

2083 
	#CURL_GLOBAL_SSL
 (1<<0)

	)

2084 
	#CURL_GLOBAL_WIN32
 (1<<1)

	)

2085 
	#CURL_GLOBAL_ALL
 (
CURL_GLOBAL_SSL
|
CURL_GLOBAL_WIN32
)

	)

2086 
	#CURL_GLOBAL_NOTHING
 0

	)

2087 
	#CURL_GLOBAL_DEFAULT
 
CURL_GLOBAL_ALL


	)

2088 
	#CURL_GLOBAL_ACK_EINTR
 (1<<2)

	)

2097 
CURL_LOCK_DATA_NONE
 = 0,

2102 
CURL_LOCK_DATA_SHARE
,

2103 
CURL_LOCK_DATA_COOKIE
,

2104 
CURL_LOCK_DATA_DNS
,

2105 
CURL_LOCK_DATA_SSL_SESSION
,

2106 
CURL_LOCK_DATA_CONNECT
,

2107 
CURL_LOCK_DATA_LAST


2108 } 
	tcuæ_lock_d©a
;

2112 
CURL_LOCK_ACCESS_NONE
 = 0,

2113 
CURL_LOCK_ACCESS_SHARED
 = 1,

2114 
CURL_LOCK_ACCESS_SINGLE
 = 2,

2115 
CURL_LOCK_ACCESS_LAST


2116 } 
	tcuæ_lock_ac˚ss
;

2118 (*
	tcuæ_lock_fun˘i⁄
)(
	tCURL
 *
	th™dÀ
,

2119 
	tcuæ_lock_d©a
 
	td©a
,

2120 
	tcuæ_lock_ac˚ss
 
	tlockty≥
,

2121 *
	tu£Ωå
);

2122 (*
	tcuæ_u∆ock_fun˘i⁄
)(
	tCURL
 *
	th™dÀ
,

2123 
	tcuæ_lock_d©a
 
	td©a
,

2124 *
	tu£Ωå
);

2126 
	tCURLSH
;

2129 
CURLSHE_OK
,

2130 
CURLSHE_BAD_OPTION
,

2131 
CURLSHE_IN_USE
,

2132 
CURLSHE_INVALID
,

2133 
CURLSHE_NOMEM
,

2134 
CURLSHE_NOT_BUILT_IN
,

2135 
CURLSHE_LAST


2136 } 
	tCURLSHcode
;

2139 
CURLSHOPT_NONE
,

2140 
CURLSHOPT_SHARE
,

2141 
CURLSHOPT_UNSHARE
,

2142 
CURLSHOPT_LOCKFUNC
,

2143 
CURLSHOPT_UNLOCKFUNC
,

2144 
CURLSHOPT_USERDATA
,

2146 
CURLSHOPT_LAST


2147 } 
	tCURLSH›ti⁄
;

2149 
CURL_EXTERN
 
CURLSH
 *
	`cuæ_sh¨e_öô
();

2150 
CURL_EXTERN
 
CURLSHcode
 
	`cuæ_sh¨e_£t›t
(
CURLSH
 *, 
CURLSH›ti⁄
 
›ti⁄
, ...);

2151 
CURL_EXTERN
 
CURLSHcode
 
	`cuæ_sh¨e_˛ónup
(
CURLSH
 *);

2158 
CURLVERSION_FIRST
,

2159 
CURLVERSION_SECOND
,

2160 
CURLVERSION_THIRD
,

2161 
CURLVERSION_FOURTH
,

2162 
CURLVERSION_LAST


2163 } 
	tCURLvîsi⁄
;

2170 
	#CURLVERSION_NOW
 
CURLVERSION_FOURTH


	)

2173 
CURLvîsi⁄
 
age
;

2174 c⁄° *
vîsi⁄
;

2175 
vîsi⁄_num
;

2176 c⁄° *
ho°
;

2177 
„©uªs
;

2178 c⁄° *
s¶_vîsi⁄
;

2179 
s¶_vîsi⁄_num
;

2180 c⁄° *
libz_vîsi⁄
;

2182 c⁄° * c⁄° *
¥Ÿocﬁs
;

2185 c⁄° *
¨es
;

2186 
¨es_num
;

2189 c⁄° *
libidn
;

2194 
ic⁄v_vî_num
;

2196 c⁄° *
libssh_vîsi⁄
;

2198 } 
	tcuæ_vîsi⁄_öfo_d©a
;

2200 
	#CURL_VERSION_IPV6
 (1<<0Ë

	)

2201 
	#CURL_VERSION_KERBEROS4
 (1<<1Ë

	)

2202 
	#CURL_VERSION_SSL
 (1<<2Ë

	)

2203 
	#CURL_VERSION_LIBZ
 (1<<3Ë

	)

2204 
	#CURL_VERSION_NTLM
 (1<<4Ë

	)

2205 
	#CURL_VERSION_GSSNEGOTIATE
 (1<<5Ë

	)

2206 
	#CURL_VERSION_DEBUG
 (1<<6Ë

	)

2207 
	#CURL_VERSION_ASYNCHDNS
 (1<<7Ë

	)

2208 
	#CURL_VERSION_SPNEGO
 (1<<8Ë

	)

2209 
	#CURL_VERSION_LARGEFILE
 (1<<9Ë

	)

2210 
	#CURL_VERSION_IDN
 (1<<10Ë

	)

2211 
	#CURL_VERSION_SSPI
 (1<<11Ë

	)

2212 
	#CURL_VERSION_CONV
 (1<<12Ë

	)

2213 
	#CURL_VERSION_CURLDEBUG
 (1<<13Ë

	)

2214 
	#CURL_VERSION_TLSAUTH_SRP
 (1<<14Ë

	)

2215 
	#CURL_VERSION_NTLM_WB
 (1<<15Ë

	)

2216 
	#CURL_VERSION_HTTP2
 (1<<16Ë

	)

2226 
CURL_EXTERN
 
cuæ_vîsi⁄_öfo_d©a
 *
	`cuæ_vîsi⁄_öfo
(
CURLvîsi⁄
);

2237 
CURL_EXTERN
 c⁄° *
	`cuæ_ósy_°ªº‹
(
CURLcode
);

2248 
CURL_EXTERN
 c⁄° *
	`cuæ_sh¨e_°ªº‹
(
CURLSHcode
);

2259 
CURL_EXTERN
 
CURLcode
 
	`cuæ_ósy_∑u£
(
CURL
 *
h™dÀ
, 
bômask
);

2261 
	#CURLPAUSE_RECV
 (1<<0)

	)

2262 
	#CURLPAUSE_RECV_CONT
 (0)

	)

2264 
	#CURLPAUSE_SEND
 (1<<2)

	)

2265 
	#CURLPAUSE_SEND_CONT
 (0)

	)

2267 
	#CURLPAUSE_ALL
 (
CURLPAUSE_RECV
|
CURLPAUSE_SEND
)

	)

2268 
	#CURLPAUSE_CONT
 (
CURLPAUSE_RECV_CONT
|
CURLPAUSE_SEND_CONT
)

	)

2270 #ifde‡ 
__˝lu•lus


2271 
	}
}

2276 
	~"ósy.h
"

2277 
	~"mu…i.h
"

2280 #i‡
deföed
(
__GNUC__
Ë&& deföed(
__GNUC_MINOR__
) && \

2281 ((
__GNUC__
 > 4Ë|| (__GNUC__ =4 && 
__GNUC_MINOR__
 >= 3)) && \

2282 !
deföed
(
__˝lu•lus
Ë&& !
	$deföed
(
CURL_DISABLE_TYPECHECK
)

2283 
	~"ty≥check-gcc.h
"

2285 #i‡
	`deföed
(
__STDC__
) && (__STDC__ >= 1)

2289 
	#cuæ_ósy_£t›t
(
h™dÀ
,
›t
,
∑øm
Ë
	`cuæ_ósy_£t›t
(h™dÀ,›t,∑øm)

	)

2290 
	#cuæ_ósy_gëöfo
(
h™dÀ
,
öfo
,
¨g
Ë
	`cuæ_ósy_gëöfo
(h™dÀ,öfo,¨g)

	)

2291 
	#cuæ_sh¨e_£t›t
(
sh¨e
,
›t
,
∑øm
Ë
	`cuæ_sh¨e_£t›t
(sh¨e,›t,∑øm)

	)

2292 
	#cuæ_mu…i_£t›t
(
h™dÀ
,
›t
,
∑øm
Ë
	`cuæ_mu…i_£t›t
(h™dÀ,›t,∑øm)

	)

	@/usr/include/dlfcn.h

19 #i‚def 
_DLFCN_H


20 
	#_DLFCN_H
 1

	)

22 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

27 
	~<bôs/dlf˙.h
>

30 #ifde‡
__USE_GNU


35 
	#RTLD_NEXT
 ((*Ë-1l)

	)

40 
	#RTLD_DEFAULT
 ((*Ë0)

	)

44 
	tLmid_t
;

47 
	#LM_ID_BASE
 0

	)

48 
	#LM_ID_NEWLM
 -1

	)

52 
__BEGIN_DECLS


56 *
	$dl›í
 (c⁄° *
__fûe
, 
__mode
Ë
__THROWNL
;

60 
	$dl˛o£
 (*
__h™dÀ
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1));

64 *
	$dlsym
 (*
__ª°ri˘
 
__h™dÀ
,

65 c⁄° *
__ª°ri˘
 
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

67 #ifde‡
__USE_GNU


69 *
	$dlm›í
 (
Lmid_t
 
__nsid
, c⁄° *
__fûe
, 
__mode
Ë
__THROWNL
;

73 *
	$dlvsym
 (*
__ª°ri˘
 
__h™dÀ
,

74 c⁄° *
__ª°ri˘
 
__«me
,

75 c⁄° *
__ª°ri˘
 
__vîsi⁄
)

76 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

82 *
	$dÀº‹
 (Ë
__THROW
;

85 #ifde‡
__USE_GNU


90 c⁄° *
dli_‚ame
;

91 *
dli_fba£
;

92 c⁄° *
dli_¢ame
;

93 *
dli_ßddr
;

94 } 
	tDl_öfo
;

98 
	$dœddr
 (c⁄° *
__addªss
, 
Dl_öfo
 *
__öfo
)

99 
__THROW
 
	`__n⁄nuŒ
 ((2));

102 
	$dœddr1
 (c⁄° *
__addªss
, 
Dl_öfo
 *
__öfo
,

103 **
__exåa_öfo
, 
__Êags
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

111 
RTLD_DL_SYMENT
 = 1,

114 
RTLD_DL_LINKMAP
 = 2

123 
	$dlöfo
 (*
__ª°ri˘
 
__h™dÀ
,

124 
__ªque°
, *
__ª°ri˘
 
__¨g
)

125 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

131 
RTLD_DI_LMID
 = 1,

135 
RTLD_DI_LINKMAP
 = 2,

137 
RTLD_DI_CONFIGADDR
 = 3,

144 
RTLD_DI_SERINFO
 = 4,

145 
RTLD_DI_SERINFOSIZE
 = 5,

149 
RTLD_DI_ORIGIN
 = 6,

151 
RTLD_DI_PROFILENAME
 = 7,

152 
RTLD_DI_PROFILEOUT
 = 8,

157 
RTLD_DI_TLS_MODID
 = 9,

163 
RTLD_DI_TLS_DATA
 = 10,

165 
RTLD_DI_MAX
 = 10

173 *
dls_«me
;

174 
dls_Êags
;

175 } 
	tDl_£Ω©h
;

181 
size_t
 
dls_size
;

182 
dls_˙t
;

183 
Dl_£Ω©h
 
dls_£Ω©h
[1];

184 } 
	tDl_£röfo
;

188 
__END_DECLS


	@/usr/include/errno.h

22 #i‚def 
_ERRNO_H


26 #i‚def 
__√ed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<„©uªs.h
>

31 
	g__BEGIN_DECLS


35 
	~<bôs/î∫o.h
>

36 #unde‡
__√ed_Em©h


38 #ifdef 
_ERRNO_H


45 #i‚def 
î∫o


46 
î∫o
;

49 #ifde‡
__USE_GNU


54 *
¥ogøm_övoˇti⁄_«me
, *
¥ogøm_övoˇti⁄_sh‹t_«me
;

58 
	g__END_DECLS


66 #i‡
deföed
 
__USE_GNU
 || deföed 
__√ed_îr‹_t


67 #i‚de‡
__îr‹_t_deföed


68 
	tîr‹_t
;

69 
	#__îr‹_t_deföed
 1

	)

71 #unde‡
__√ed_îr‹_t


	@/usr/include/et/com_err.h

11 #i‡!
deföed
(
__COM_ERR_H
Ë&& !deföed(
__COM_ERR_H__
)

13 #ifde‡
__GNUC__


14 
	#COM_ERR_ATTR
(
x
Ë
	`__©åibuã__
(x)

	)

16 
	#COM_ERR_ATTR
(
x
)

	)

19 
	~<°ddef.h
>

20 
	~<°d¨g.h
>

22 
	tîrcode_t
;

24 
	sîr‹_èbÀ
 {

25 c⁄° * c⁄° * 
	mmsgs
;

26 
	mba£
;

27 
	mn_msgs
;

29 
	gë_li°
;

31 
	$com_îr
 (const *, , const *, ...)

32 
	`COM_ERR_ATTR
((
	`f‹m©
(
¥ötf
, 3, 4)));

34 
	$com_îr_va
 (c⁄° *
whﬂmi
, 
îrcode_t
 
code
, c⁄° *
fmt
,

35 
va_li°
 
¨gs
)

36 
	`COM_ERR_ATTR
((
	`f‹m©
(
¥ötf
, 3, 0)));

38 c⁄° *
	`îr‹_mesßge
 ();

39 (*
com_îr_hook
Ë(c⁄° *, , c⁄° *, 
va_li°
);

40 (*
	`£t_com_îr_hook
 ((*) (const *, ,

41 c⁄° *, 
va_li°
)))

42 (c⁄° *, , c⁄° *, 
va_li°
);

43 (*
	$ª£t_com_îr_hook
 ()) (const *, ,

44 c⁄° *, 
va_li°
);

45 
	`öô_îr‹_èbÀ
(c⁄° * c⁄° *
msgs
, 
ba£
, 
cou¡
);

46 *(*
	`£t_com_îr_gëãxt
 (*(*) (const *)))

49 
îrcode_t
 
	`add_îr‹_èbÀ
(c⁄° 
îr‹_èbÀ
 * 
ë
);

50 
îrcode_t
 
	`ªmove_îr‹_èbÀ
(c⁄° 
îr‹_èbÀ
 * 
ë
);

51 
	`add_to_îr‹_èbÀ
(
ë_li°
 *
√w_èbÀ
);

54 c⁄° *
	`com_right
(
ë_li°
 *
li°
, 
code
);

55 c⁄° *
	`com_right_r
(
ë_li°
 *
li°
, 
code
, *
°r
, 
size_t
 
Àn
);

56 
	`öôülize_îr‹_èbÀ_r
(
ë_li°
 **
li°
,

57 c⁄° **
mesßges
,

58 
num_îr‹s
,

59 
ba£
);

60 
	`‰ì_îr‹_èbÀ
(
ë_li°
 *
ë
);

63 
	`ë_li°_lock
();

64 
	`ë_li°_u∆ock
();

66 
	#__COM_ERR_H


	)

67 
	#__COM_ERR_H__


	)

	@/usr/include/execinfo.h

18 #i‚de‡
_EXECINFO_H


19 
	#_EXECINFO_H
 1

	)

21 
	~<„©uªs.h
>

23 
__BEGIN_DECLS


27 
	$backåa˚
 (**
__¨øy
, 
__size
Ë
	`__n⁄nuŒ
 ((1));

32 **
	$backåa˚_symbﬁs
 (*c⁄° *
__¨øy
, 
__size
)

33 
__THROW
 
	`__n⁄nuŒ
 ((1));

38 
	$backåa˚_symbﬁs_fd
 (*c⁄° *
__¨øy
, 
__size
, 
__fd
)

39 
__THROW
 
	`__n⁄nuŒ
 ((1));

41 
__END_DECLS


	@/usr/include/fcntl.h

22 #i‚def 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


31 
	~<bôs/ty≥s.h
>

35 
	~<bôs/f˙é.h
>

40 #i‚de‡
__mode_t_deföed


41 
__mode_t
 
	tmode_t
;

42 
	#__mode_t_deföed


	)

45 #i‚de‡
__off_t_deföed


46 #i‚de‡
__USE_FILE_OFFSET64


47 
__off_t
 
	toff_t
;

49 
__off64_t
 
	toff_t
;

51 
	#__off_t_deföed


	)

54 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


55 
__off64_t
 
	toff64_t
;

56 
	#__off64_t_deföed


	)

59 #i‚de‡
__pid_t_deföed


60 
__pid_t
 
	tpid_t
;

61 
	#__pid_t_deföed


	)

65 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


66 
	#__√ed_time•ec


	)

67 
	~<time.h
>

68 
	~<bôs/°©.h
>

70 
	#S_IFMT
 
__S_IFMT


	)

71 
	#S_IFDIR
 
__S_IFDIR


	)

72 
	#S_IFCHR
 
__S_IFCHR


	)

73 
	#S_IFBLK
 
__S_IFBLK


	)

74 
	#S_IFREG
 
__S_IFREG


	)

75 #ifde‡
__S_IFIFO


76 
	#S_IFIFO
 
__S_IFIFO


	)

78 #ifde‡
__S_IFLNK


79 
	#S_IFLNK
 
__S_IFLNK


	)

81 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
Ë&& deföed 
__S_IFSOCK


82 
	#S_IFSOCK
 
__S_IFSOCK


	)

87 
	#S_ISUID
 
__S_ISUID


	)

88 
	#S_ISGID
 
__S_ISGID


	)

90 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


92 
	#S_ISVTX
 
__S_ISVTX


	)

95 
	#S_IRUSR
 
__S_IREAD


	)

96 
	#S_IWUSR
 
__S_IWRITE


	)

97 
	#S_IXUSR
 
__S_IEXEC


	)

99 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

101 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

102 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

103 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

105 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

107 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

108 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

109 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

111 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

114 #ifdef 
__USE_MISC


115 #i‚de‡
R_OK


118 
	#R_OK
 4

	)

119 
	#W_OK
 2

	)

120 
	#X_OK
 1

	)

121 
	#F_OK
 0

	)

126 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


127 
	#SEEK_SET
 0

	)

128 
	#SEEK_CUR
 1

	)

129 
	#SEEK_END
 2

	)

137 
f˙é
 (
__fd
, 
__cmd
, ...);

145 #i‚de‡
__USE_FILE_OFFSET64


146 
	$›í
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

148 #ifde‡
__REDIRECT


149 
	`__REDIRECT
 (
›í
, (c⁄° *
__fûe
, 
__oÊag
, ...), 
›í64
)

150 
	`__n⁄nuŒ
 ((1));

152 
	#›í
 
›í64


	)

155 #ifde‡
__USE_LARGEFILE64


156 
	$›í64
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

159 #ifde‡
__USE_ATFILE


169 #i‚de‡
__USE_FILE_OFFSET64


170 
	$›í©
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

171 
	`__n⁄nuŒ
 ((2));

173 #ifde‡
__REDIRECT


174 
	`__REDIRECT
 (
›í©
, (
__fd
, c⁄° *
__fûe
, 
__oÊag
,

175 ...), 
›í©64
Ë
	`__n⁄nuŒ
 ((2));

177 
	#›í©
 
›í©64


	)

180 #ifde‡
__USE_LARGEFILE64


181 
	$›í©64
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

182 
	`__n⁄nuŒ
 ((2));

191 #i‚de‡
__USE_FILE_OFFSET64


192 
	$¸ót
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

194 #ifde‡
__REDIRECT


195 
	`__REDIRECT
 (
¸ót
, (c⁄° *
__fûe
, 
mode_t
 
__mode
),

196 
¸ót64
Ë
	`__n⁄nuŒ
 ((1));

198 
	#¸ót
 
¸ót64


	)

201 #ifde‡
__USE_LARGEFILE64


202 
	$¸ót64
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

205 #i‡!
deföed
 
F_LOCK
 && (deföed 
__USE_MISC
 || (deföed 
__USE_XOPEN_EXTENDED
 \

206 && !
deföed
 
__USE_POSIX
))

215 
	#F_ULOCK
 0

	)

216 
	#F_LOCK
 1

	)

217 
	#F_TLOCK
 2

	)

218 
	#F_TEST
 3

	)

220 #i‚de‡
__USE_FILE_OFFSET64


221 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Àn
);

223 #ifde‡
__REDIRECT


224 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
), 
lockf64
);

226 
	#lockf
 
lockf64


	)

229 #ifde‡
__USE_LARGEFILE64


230 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Àn
);

234 #ifde‡
__USE_XOPEN2K


237 #i‚de‡
__USE_FILE_OFFSET64


238 
	$posix_Ádvi£
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
,

239 
__advi£
Ë
__THROW
;

241 #ifde‡
__REDIRECT_NTH


242 
	`__REDIRECT_NTH
 (
posix_Ádvi£
, (
__fd
, 
__off64_t
 
__off£t
,

243 
__off64_t
 
__Àn
, 
__advi£
),

244 
posix_Ádvi£64
);

246 
	#posix_Ádvi£
 
posix_Ádvi£64


	)

249 #ifde‡
__USE_LARGEFILE64


250 
	$posix_Ádvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
,

251 
__advi£
Ë
__THROW
;

259 #i‚de‡
__USE_FILE_OFFSET64


260 
	`posix_ÁŒoˇã
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
);

262 #ifde‡
__REDIRECT


263 
	`__REDIRECT
 (
posix_ÁŒoˇã
, (
__fd
, 
__off64_t
 
__off£t
,

264 
__off64_t
 
__Àn
),

265 
posix_ÁŒoˇã64
);

267 
	#posix_ÁŒoˇã
 
posix_ÁŒoˇã64


	)

270 #ifde‡
__USE_LARGEFILE64


271 
	`posix_ÁŒoˇã64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
);

277 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄
 \

278 && 
deföed
 
__va_¨g_∑ck_Àn


279 
	~<bôs/f˙é2.h
>

282 
__END_DECLS


	@/usr/include/grp.h

22 #i‚def 
_GRP_H


23 
	#_GRP_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ty≥s.h
>

31 
	#__√ed_size_t


	)

32 
	~<°ddef.h
>

36 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K
Ë&& !deföed 
__gid_t_deföed


37 
__gid_t
 
	tgid_t
;

38 
	#__gid_t_deföed


	)

42 
	sgroup


44 *
	mgr_«me
;

45 *
	mgr_∑sswd
;

46 
__gid_t
 
	mgr_gid
;

47 **
	mgr_mem
;

51 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_GNU


52 
	#__√ed_FILE


	)

53 
	~<°dio.h
>

57 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


62 
£tgª¡
 ();

65 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

66 || 
deföed
 
__USE_XOPEN2K8


71 
ídgª¡
 ();

77 
group
 *
gëgª¡
 ();

80 #ifdef 
__USE_SVID


87 
group
 *
fgëgª¡
 (
FILE
 *
__°ªam
);

90 #ifde‡
__USE_GNU


97 
putgª¡
 (c⁄° 
group
 *
__ª°ri˘
 
__p
,

98 
FILE
 *
__ª°ri˘
 
__f
);

105 
group
 *
gëgrgid
 (
__gid_t
 
__gid
);

111 
group
 *
gëg∫am
 (c⁄° *
__«me
);

113 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


115 #ifde‡
__USE_MISC


118 
	#NSS_BUFLEN_GROUP
 1024

	)

134 #ifde‡
__USE_GNU


135 
gëgª¡_r
 (
group
 *
__ª°ri˘
 
__ªsu…buf
,

136 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

137 
group
 **
__ª°ri˘
 
__ªsu…
);

144 
gëgrgid_r
 (
__gid_t
 
__gid
, 
group
 *
__ª°ri˘
 
__ªsu…buf
,

145 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

146 
group
 **
__ª°ri˘
 
__ªsu…
);

152 
gëg∫am_r
 (c⁄° *
__ª°ri˘
 
__«me
,

153 
group
 *
__ª°ri˘
 
__ªsu…buf
,

154 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

155 
group
 **
__ª°ri˘
 
__ªsu…
);

157 #ifdef 
__USE_SVID


165 
fgëgª¡_r
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

166 
group
 *
__ª°ri˘
 
__ªsu…buf
,

167 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

168 
group
 **
__ª°ri˘
 
__ªsu…
);

174 #ifdef 
__USE_BSD


176 
	#__√ed_size_t


	)

177 
	~<°ddef.h
>

180 
	$£tgroups
 (
size_t
 
__n
, c⁄° 
__gid_t
 *
__groups
Ë
__THROW
;

190 
	`gëgrou∂i°
 (c⁄° *
__u£r
, 
__gid_t
 
__group
,

191 
__gid_t
 *
__groups
, *
__ngroups
);

201 
	`öôgroups
 (c⁄° *
__u£r
, 
__gid_t
 
__group
);

205 
__END_DECLS


	@/usr/include/gssapi.h

6 
	~<gsßpi/gsßpi.h
>

	@/usr/include/gssapi/gssapi.h

2 
	~<°döt.h
>

3 
	~<öây≥s.h
>

29 #i‚de‡
_GSSAPI_H_


30 
	#_GSSAPI_H_


	)

36 #i‡
deföed
(
__MACH__
Ë&& deföed(
__APPLE__
)

37 
	~<T¨gëC⁄dôi⁄Æs.h
>

38 #i‡
TARGET_RT_MAC_CFM


43 #ifde‡
__˝lu•lus


47 #i‡
TARGET_OS_MAC


48 #¥agm®
∑ck
(
push
,2)

51 #i‡
deföed
(
_MSDOS
Ë|| deföed(
_WIN32
)

52 
	~<wö-mac.h
>

55 #i‚de‡
KRB5_CALLCONV


56 
	#KRB5_CALLCONV


	)

57 
	#KRB5_CALLCONV_C


	)

63 
	~<°ddef.h
>

68 
	~<sys/ty≥s.h
>

78 
gss_«me_°ru˘
;

79 
gss_«me_°ru˘
 * 
	tgss_«me_t
;

81 
gss_¸ed_id_°ru˘
;

82 
gss_¸ed_id_°ru˘
 * 
	tgss_¸ed_id_t
;

84 
gss_˘x_id_°ru˘
;

85 
gss_˘x_id_°ru˘
 * 
	tgss_˘x_id_t
;

91 
uöt32_t
 
	tgss_uöt32
;

92 
öt32_t
 
	tgss_öt32
;

94 #ifde‡ 
OM_STRING


99 
OM_obje˘_idítifõr
 
	tgss_OID_desc
, *
	tgss_OID
;

104 
gss_uöt32
 
	tOM_uöt32
;

106 
	sgss_OID_desc_°ru˘
 {

107 
OM_uöt32
 
Àngth
;

108 *
ñemíts
;

109 } 
	tgss_OID_desc
, *
	tgss_OID
;

112 
	sgss_OID_£t_desc_°ru˘
 {

113 
size_t
 
cou¡
;

114 
gss_OID
 
ñemíts
;

115 } 
	tgss_OID_£t_desc
, *
	tgss_OID_£t
;

117 
	sgss_buf„r_desc_°ru˘
 {

118 
size_t
 
Àngth
;

119 *
vÆue
;

120 } 
	tgss_buf„r_desc
, *
	tgss_buf„r_t
;

122 
	sgss_ch™√l_bödögs_°ru˘
 {

123 
OM_uöt32
 
öôüt‹_addπy≥
;

124 
gss_buf„r_desc
 
öôüt‹_addªss
;

125 
OM_uöt32
 
ac˚±‹_addπy≥
;

126 
gss_buf„r_desc
 
ac˚±‹_addªss
;

127 
gss_buf„r_desc
 
≠∂iˇti⁄_d©a
;

128 } *
	tgss_ch™√l_bödögs_t
;

134 
OM_uöt32
 
	tgss_q›_t
;

135 
	tgss_¸ed_ußge_t
;

140 
	#GSS_C_DELEG_FLAG
 1

	)

141 
	#GSS_C_MUTUAL_FLAG
 2

	)

142 
	#GSS_C_REPLAY_FLAG
 4

	)

143 
	#GSS_C_SEQUENCE_FLAG
 8

	)

144 
	#GSS_C_CONF_FLAG
 16

	)

145 
	#GSS_C_INTEG_FLAG
 32

	)

146 
	#GSS_C_ANON_FLAG
 64

	)

147 
	#GSS_C_PROT_READY_FLAG
 128

	)

148 
	#GSS_C_TRANS_FLAG
 256

	)

149 
	#GSS_C_DELEG_POLICY_FLAG
 32768

	)

154 
	#GSS_C_BOTH
 0

	)

155 
	#GSS_C_INITIATE
 1

	)

156 
	#GSS_C_ACCEPT
 2

	)

161 
	#GSS_C_GSS_CODE
 1

	)

162 
	#GSS_C_MECH_CODE
 2

	)

167 
	#GSS_C_AF_UNSPEC
 0

	)

168 
	#GSS_C_AF_LOCAL
 1

	)

169 
	#GSS_C_AF_INET
 2

	)

170 
	#GSS_C_AF_IMPLINK
 3

	)

171 
	#GSS_C_AF_PUP
 4

	)

172 
	#GSS_C_AF_CHAOS
 5

	)

173 
	#GSS_C_AF_NS
 6

	)

174 
	#GSS_C_AF_NBS
 7

	)

175 
	#GSS_C_AF_ECMA
 8

	)

176 
	#GSS_C_AF_DATAKIT
 9

	)

177 
	#GSS_C_AF_CCITT
 10

	)

178 
	#GSS_C_AF_SNA
 11

	)

179 
	#GSS_C_AF_DEC√t
 12

	)

180 
	#GSS_C_AF_DLI
 13

	)

181 
	#GSS_C_AF_LAT
 14

	)

182 
	#GSS_C_AF_HYLINK
 15

	)

183 
	#GSS_C_AF_APPLETALK
 16

	)

184 
	#GSS_C_AF_BSC
 17

	)

185 
	#GSS_C_AF_DSS
 18

	)

186 
	#GSS_C_AF_OSI
 19

	)

187 
	#GSS_C_AF_NETBIOS
 20

	)

188 
	#GSS_C_AF_X25
 21

	)

190 
	#GSS_C_AF_NULLADDR
 255

	)

195 
	#GSS_C_NO_NAME
 ((
gss_«me_t
Ë0)

	)

196 
	#GSS_C_NO_BUFFER
 ((
gss_buf„r_t
Ë0)

	)

197 
	#GSS_C_NO_OID
 ((
gss_OID
Ë0)

	)

198 
	#GSS_C_NO_OID_SET
 ((
gss_OID_£t
Ë0)

	)

199 
	#GSS_C_NO_CONTEXT
 ((
gss_˘x_id_t
Ë0)

	)

200 
	#GSS_C_NO_CREDENTIAL
 ((
gss_¸ed_id_t
Ë0)

	)

201 
	#GSS_C_NO_CHANNEL_BINDINGS
 ((
gss_ch™√l_bödögs_t
Ë0)

	)

202 
	#GSS_C_EMPTY_BUFFER
 {0, 
NULL
}

	)

208 
	#GSS_C_NULL_OID
 
GSS_C_NO_OID


	)

209 
	#GSS_C_NULL_OID_SET
 
GSS_C_NO_OID_SET


	)

219 
	#GSS_C_QOP_DEFAULT
 0

	)

225 
	#GSS_C_INDEFINITE
 ((
OM_uöt32
Ë0xfffffffful)

	)

230 
	#GSS_S_COMPLETE
 0

	)

235 
	#GSS_C_CALLING_ERROR_OFFSET
 24

	)

236 
	#GSS_C_ROUTINE_ERROR_OFFSET
 16

	)

237 
	#GSS_C_SUPPLEMENTARY_OFFSET
 0

	)

238 
	#GSS_C_CALLING_ERROR_MASK
 ((
OM_uöt32
Ë0377ul)

	)

239 
	#GSS_C_ROUTINE_ERROR_MASK
 ((
OM_uöt32
Ë0377ul)

	)

240 
	#GSS_C_SUPPLEMENTARY_MASK
 ((
OM_uöt32
Ë0177777ul)

	)

247 
	#GSS_CALLING_ERROR
(
x
) \

248 ((
x
Ë& (
GSS_C_CALLING_ERROR_MASK
 << 
GSS_C_CALLING_ERROR_OFFSET
))

	)

249 
	#GSS_ROUTINE_ERROR
(
x
) \

250 ((
x
Ë& (
GSS_C_ROUTINE_ERROR_MASK
 << 
GSS_C_ROUTINE_ERROR_OFFSET
))

	)

251 
	#GSS_SUPPLEMENTARY_INFO
(
x
) \

252 ((
x
Ë& (
GSS_C_SUPPLEMENTARY_MASK
 << 
GSS_C_SUPPLEMENTARY_OFFSET
))

	)

253 
	#GSS_ERROR
(
x
) \

254 ((
x
Ë& ((
GSS_C_CALLING_ERROR_MASK
 << 
GSS_C_CALLING_ERROR_OFFSET
) | \

255 (
GSS_C_ROUTINE_ERROR_MASK
 << 
GSS_C_ROUTINE_ERROR_OFFSET
)))

	)

264 
	#GSS_S_CALL_INACCESSIBLE_READ
 \

265 (((
OM_uöt32
Ë1ulË<< 
GSS_C_CALLING_ERROR_OFFSET
)

	)

266 
	#GSS_S_CALL_INACCESSIBLE_WRITE
 \

267 (((
OM_uöt32
Ë2ulË<< 
GSS_C_CALLING_ERROR_OFFSET
)

	)

268 
	#GSS_S_CALL_BAD_STRUCTURE
 \

269 (((
OM_uöt32
Ë3ulË<< 
GSS_C_CALLING_ERROR_OFFSET
)

	)

274 
	#GSS_S_BAD_MECH
 (((
OM_uöt32
Ë1ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

275 
	#GSS_S_BAD_NAME
 (((
OM_uöt32
Ë2ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

276 
	#GSS_S_BAD_NAMETYPE
 (((
OM_uöt32
Ë3ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

277 
	#GSS_S_BAD_BINDINGS
 (((
OM_uöt32
Ë4ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

278 
	#GSS_S_BAD_STATUS
 (((
OM_uöt32
Ë5ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

279 
	#GSS_S_BAD_SIG
 (((
OM_uöt32
Ë6ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

280 
	#GSS_S_NO_CRED
 (((
OM_uöt32
Ë7ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

281 
	#GSS_S_NO_CONTEXT
 (((
OM_uöt32
Ë8ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

282 
	#GSS_S_DEFECTIVE_TOKEN
 (((
OM_uöt32
Ë9ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

283 
	#GSS_S_DEFECTIVE_CREDENTIAL
 \

284 (((
OM_uöt32
Ë10ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

285 
	#GSS_S_CREDENTIALS_EXPIRED
 \

286 (((
OM_uöt32
Ë11ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

287 
	#GSS_S_CONTEXT_EXPIRED
 \

288 (((
OM_uöt32
Ë12ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

289 
	#GSS_S_FAILURE
 (((
OM_uöt32
Ë13ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

290 
	#GSS_S_BAD_QOP
 (((
OM_uöt32
Ë14ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

291 
	#GSS_S_UNAUTHORIZED
 (((
OM_uöt32
Ë15ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

292 
	#GSS_S_UNAVAILABLE
 (((
OM_uöt32
Ë16ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

293 
	#GSS_S_DUPLICATE_ELEMENT
 \

294 (((
OM_uöt32
Ë17ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

295 
	#GSS_S_NAME_NOT_MN
 \

296 (((
OM_uöt32
Ë18ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

297 
	#GSS_S_BAD_MECH_ATTR
 \

298 (((
OM_uöt32
Ë19ulË<< 
GSS_C_ROUTINE_ERROR_OFFSET
)

	)

303 
	#GSS_S_CONTINUE_NEEDED
 (1 << (
GSS_C_SUPPLEMENTARY_OFFSET
 + 0))

	)

304 
	#GSS_S_DUPLICATE_TOKEN
 (1 << (
GSS_C_SUPPLEMENTARY_OFFSET
 + 1))

	)

305 
	#GSS_S_OLD_TOKEN
 (1 << (
GSS_C_SUPPLEMENTARY_OFFSET
 + 2))

	)

306 
	#GSS_S_UNSEQ_TOKEN
 (1 << (
GSS_C_SUPPLEMENTARY_OFFSET
 + 3))

	)

307 
	#GSS_S_GAP_TOKEN
 (1 << (
GSS_C_SUPPLEMENTARY_OFFSET
 + 4))

	)

314 #i‡
deföed
 (
_WIN32
Ë&& deföed (
_MSC_VER
)

315 #ifde‡
GSS_DLL_FILE


316 
	#GSS_DLLIMP
 
	`__de˛•ec
(
dŒexp‹t
)

	)

318 
	#GSS_DLLIMP
 
	`__de˛•ec
(
dŒimp‹t
)

	)

321 
	#GSS_DLLIMP


	)

335 
GSS_DLLIMP
 
gss_OID
 
GSS_C_NT_USER_NAME
;

347 
GSS_DLLIMP
 
gss_OID
 
GSS_C_NT_MACHINE_UID_NAME
;

359 
GSS_DLLIMP
 
gss_OID
 
GSS_C_NT_STRING_UID_NAME
;

378 
GSS_DLLIMP
 
gss_OID
 
GSS_C_NT_HOSTBASED_SERVICE_X
;

391 
GSS_DLLIMP
 
gss_OID
 
GSS_C_NT_HOSTBASED_SERVICE
;

403 
GSS_DLLIMP
 
gss_OID
 
GSS_C_NT_ANONYMOUS
;

416 
GSS_DLLIMP
 
gss_OID
 
GSS_C_NT_EXPORT_NAME
;

420 
OM_uöt32
 
KRB5_CALLCONV


421 
gss_acquúe_¸ed
(

422 
OM_uöt32
 *,

423 
gss_«me_t
,

424 
OM_uöt32
,

425 
gss_OID_£t
,

426 
gss_¸ed_ußge_t
,

427 
gss_¸ed_id_t
 *,

428 
gss_OID_£t
 *,

429 
OM_uöt32
 *);

431 
OM_uöt32
 
KRB5_CALLCONV


432 
gss_ªÀa£_¸ed
(

433 
OM_uöt32
 *,

434 
gss_¸ed_id_t
 *);

436 
OM_uöt32
 
KRB5_CALLCONV


437 
gss_öô_£c_c⁄ãxt
(

438 
OM_uöt32
 *,

439 
gss_¸ed_id_t
,

440 
gss_˘x_id_t
 *,

441 
gss_«me_t
,

442 
gss_OID
,

443 
OM_uöt32
,

444 
OM_uöt32
,

445 
gss_ch™√l_bödögs_t
,

446 
gss_buf„r_t
,

447 
gss_OID
 *,

448 
gss_buf„r_t
,

449 
OM_uöt32
 *,

450 
OM_uöt32
 *);

452 
OM_uöt32
 
KRB5_CALLCONV


453 
gss_ac˚±_£c_c⁄ãxt
(

454 
OM_uöt32
 *,

455 
gss_˘x_id_t
 *,

456 
gss_¸ed_id_t
,

457 
gss_buf„r_t
,

458 
gss_ch™√l_bödögs_t
,

459 
gss_«me_t
 *,

460 
gss_OID
 *,

461 
gss_buf„r_t
,

462 
OM_uöt32
 *,

463 
OM_uöt32
 *,

464 
gss_¸ed_id_t
 *);

466 
OM_uöt32
 
KRB5_CALLCONV


467 
gss_¥o˚ss_c⁄ãxt_tokí
(

468 
OM_uöt32
 *,

469 
gss_˘x_id_t
,

470 
gss_buf„r_t
);

473 
OM_uöt32
 
KRB5_CALLCONV


474 
gss_dñëe_£c_c⁄ãxt
(

475 
OM_uöt32
 *,

476 
gss_˘x_id_t
 *,

477 
gss_buf„r_t
);

480 
OM_uöt32
 
KRB5_CALLCONV


481 
gss_c⁄ãxt_time
(

482 
OM_uöt32
 *,

483 
gss_˘x_id_t
,

484 
OM_uöt32
 *);

488 
OM_uöt32
 
KRB5_CALLCONV


489 
gss_gë_mic
(

490 
OM_uöt32
 *,

491 
gss_˘x_id_t
,

492 
gss_q›_t
,

493 
gss_buf„r_t
,

494 
gss_buf„r_t
);

498 
OM_uöt32
 
KRB5_CALLCONV


499 
gss_vîify_mic
(
OM_uöt32
 *,

500 
gss_˘x_id_t
,

501 
gss_buf„r_t
,

502 
gss_buf„r_t
,

503 
gss_q›_t
 *

507 
OM_uöt32
 
KRB5_CALLCONV


508 
gss_wøp
(

509 
OM_uöt32
 *,

510 
gss_˘x_id_t
,

512 
gss_q›_t
,

513 
gss_buf„r_t
,

515 
gss_buf„r_t
);

519 
OM_uöt32
 
KRB5_CALLCONV


520 
gss_unwøp
(

521 
OM_uöt32
 *,

522 
gss_˘x_id_t
,

523 
gss_buf„r_t
,

524 
gss_buf„r_t
,

526 
gss_q›_t
 *);

529 
OM_uöt32
 
KRB5_CALLCONV


530 
gss_di•œy_°©us
(

531 
OM_uöt32
 *,

532 
OM_uöt32
,

534 
gss_OID
,

535 
OM_uöt32
 *,

536 
gss_buf„r_t
);

539 
OM_uöt32
 
KRB5_CALLCONV


540 
gss_ödiˇã_mechs
(

541 
OM_uöt32
 *,

542 
gss_OID_£t
 *);

545 
OM_uöt32
 
KRB5_CALLCONV


546 
gss_com∑ª_«me
(

547 
OM_uöt32
 *,

548 
gss_«me_t
,

549 
gss_«me_t
,

553 
OM_uöt32
 
KRB5_CALLCONV


554 
gss_di•œy_«me
(

555 
OM_uöt32
 *,

556 
gss_«me_t
,

557 
gss_buf„r_t
,

558 
gss_OID
 *);

561 
OM_uöt32
 
KRB5_CALLCONV


562 
gss_imp‹t_«me
(

563 
OM_uöt32
 *,

564 
gss_buf„r_t
,

565 
gss_OID
,

566 
gss_«me_t
 *);

568 
OM_uöt32
 
KRB5_CALLCONV


569 
gss_ªÀa£_«me
(

570 
OM_uöt32
 *,

571 
gss_«me_t
 *);

573 
OM_uöt32
 
KRB5_CALLCONV


574 
gss_ªÀa£_buf„r
(

575 
OM_uöt32
 *,

576 
gss_buf„r_t
);

578 
OM_uöt32
 
KRB5_CALLCONV


579 
gss_ªÀa£_oid_£t
(

580 
OM_uöt32
 *,

581 
gss_OID_£t
 *);

583 
OM_uöt32
 
KRB5_CALLCONV


584 
gss_öquúe_¸ed
(

585 
OM_uöt32
 *,

586 
gss_¸ed_id_t
,

587 
gss_«me_t
 *,

588 
OM_uöt32
 *,

589 
gss_¸ed_ußge_t
 *,

590 
gss_OID_£t
 *);

593 
OM_uöt32
 
KRB5_CALLCONV


594 
gss_öquúe_c⁄ãxt
(

595 
OM_uöt32
 *,

596 
gss_˘x_id_t
,

597 
gss_«me_t
 *,

598 
gss_«me_t
 *,

599 
OM_uöt32
 *,

600 
gss_OID
 *,

601 
OM_uöt32
 *,

606 
OM_uöt32
 
KRB5_CALLCONV


607 
gss_wøp_size_limô
(

608 
OM_uöt32
 *,

609 
gss_˘x_id_t
,

611 
gss_q›_t
,

612 
OM_uöt32
,

613 
OM_uöt32
 *);

616 
OM_uöt32
 
KRB5_CALLCONV


617 
gss_imp‹t_«me_obje˘
(

618 
OM_uöt32
 *,

620 
gss_OID
,

621 
gss_«me_t
 *);

624 
OM_uöt32
 
KRB5_CALLCONV


625 
gss_exp‹t_«me_obje˘
(

626 
OM_uöt32
 *,

627 
gss_«me_t
,

628 
gss_OID
,

632 
OM_uöt32
 
KRB5_CALLCONV


633 
gss_add_¸ed
(

634 
OM_uöt32
 *,

635 
gss_¸ed_id_t
,

636 
gss_«me_t
,

637 
gss_OID
,

638 
gss_¸ed_ußge_t
,

639 
OM_uöt32
,

640 
OM_uöt32
,

641 
gss_¸ed_id_t
 *,

642 
gss_OID_£t
 *,

643 
OM_uöt32
 *,

644 
OM_uöt32
 *);

647 
OM_uöt32
 
KRB5_CALLCONV


648 
gss_öquúe_¸ed_by_mech
(

649 
OM_uöt32
 *,

650 
gss_¸ed_id_t
,

651 
gss_OID
,

652 
gss_«me_t
 *,

653 
OM_uöt32
 *,

654 
OM_uöt32
 *,

655 
gss_¸ed_ußge_t
 *);

658 
OM_uöt32
 
KRB5_CALLCONV


659 
gss_exp‹t_£c_c⁄ãxt
(

660 
OM_uöt32
 *,

661 
gss_˘x_id_t
 *,

662 
gss_buf„r_t
);

665 
OM_uöt32
 
KRB5_CALLCONV


666 
gss_imp‹t_£c_c⁄ãxt
(

667 
OM_uöt32
 *,

668 
gss_buf„r_t
,

669 
gss_˘x_id_t
 *);

672 
OM_uöt32
 
KRB5_CALLCONV


673 
gss_ªÀa£_oid
(

674 
OM_uöt32
 *,

675 
gss_OID
 *);

678 
OM_uöt32
 
KRB5_CALLCONV


679 
gss_¸óã_em±y_oid_£t
(

680 
OM_uöt32
 *,

681 
gss_OID_£t
 *);

684 
OM_uöt32
 
KRB5_CALLCONV


685 
gss_add_oid_£t_membî
(

686 
OM_uöt32
 *,

687 
gss_OID
,

688 
gss_OID_£t
 *);

691 
OM_uöt32
 
KRB5_CALLCONV


692 
gss_ã°_oid_£t_membî
(

693 
OM_uöt32
 *,

694 
gss_OID
,

695 
gss_OID_£t
,

699 
OM_uöt32
 
KRB5_CALLCONV


700 
gss_°r_to_oid
(

701 
OM_uöt32
 *,

702 
gss_buf„r_t
,

703 
gss_OID
 *);

706 
OM_uöt32
 
KRB5_CALLCONV


707 
gss_oid_to_°r
(

708 
OM_uöt32
 *,

709 
gss_OID
,

710 
gss_buf„r_t
);

713 
OM_uöt32
 
KRB5_CALLCONV


714 
gss_öquúe_«mes_f‹_mech
(

715 
OM_uöt32
 *,

716 
gss_OID
,

717 
gss_OID_£t
 *);

720 
OM_uöt32
 
KRB5_CALLCONV


721 
gss_öquúe_mechs_f‹_«me
(

722 
OM_uöt32
 *,

723 c⁄° 
gss_«me_t
,

724 
gss_OID_£t
 *);

733 
OM_uöt32
 
KRB5_CALLCONV


734 
gss_sign
(

735 
OM_uöt32
 *,

736 
gss_˘x_id_t
,

738 
gss_buf„r_t
,

739 
gss_buf„r_t
);

741 
OM_uöt32
 
KRB5_CALLCONV


742 
gss_vîify
(

743 
OM_uöt32
 *,

744 
gss_˘x_id_t
,

745 
gss_buf„r_t
,

746 
gss_buf„r_t
,

749 
OM_uöt32
 
KRB5_CALLCONV


750 
gss_£Æ
(

751 
OM_uöt32
 *,

752 
gss_˘x_id_t
,

755 
gss_buf„r_t
,

757 
gss_buf„r_t
);

759 
OM_uöt32
 
KRB5_CALLCONV


760 
gss_un£Æ
(

761 
OM_uöt32
 *,

762 
gss_˘x_id_t
,

763 
gss_buf„r_t
,

764 
gss_buf„r_t
,

769 
OM_uöt32
 
KRB5_CALLCONV


770 
gss_exp‹t_«me
(

771 
OM_uöt32
 *,

772 c⁄° 
gss_«me_t
,

773 
gss_buf„r_t
);

776 
OM_uöt32
 
KRB5_CALLCONV


777 
gss_du∂iˇã_«me
(

778 
OM_uöt32
 *,

779 c⁄° 
gss_«me_t
,

780 
gss_«me_t
 *);

783 
OM_uöt32
 
KRB5_CALLCONV


784 
gss_ˇn⁄iˇlize_«me
(

785 
OM_uöt32
 *,

786 c⁄° 
gss_«me_t
,

787 c⁄° 
gss_OID
,

788 
gss_«me_t
 *);

792 
	#GSS_C_PRF_KEY_FULL
 0

	)

793 
	#GSS_C_PRF_KEY_PARTIAL
 1

	)

795 
OM_uöt32
 
KRB5_CALLCONV


796 
gss_p£udo_øndom
(

797 
OM_uöt32
 *,

798 
gss_˘x_id_t
,

800 c⁄° 
gss_buf„r_t
,

801 
ssize_t
,

802 
gss_buf„r_t
);

804 
OM_uöt32
 
KRB5_CALLCONV


805 
gss_°‹e_¸ed
(

806 
OM_uöt32
 *,

807 c⁄° 
gss_¸ed_id_t
,

808 
gss_¸ed_ußge_t
,

809 c⁄° 
gss_OID
,

810 
OM_uöt32
,

811 
OM_uöt32
,

812 
gss_OID_£t
 *,

813 
gss_¸ed_ußge_t
 *);

815 
OM_uöt32
 
KRB5_CALLCONV


816 
gss_£t_√g_mechs
(

817 
OM_uöt32
 *,

818 
gss_¸ed_id_t
,

819 c⁄° 
gss_OID_£t
);

821 #i‡
TARGET_OS_MAC


822 #¥agm®
∑ck
(
p›
)

825 #ifde‡
__˝lu•lus


831 
	#GSS_CALLING_ERROR_FIELD
(
x
) \

832 (((
x
Ë>> 
GSS_C_CALLING_ERROR_OFFSET
Ë& 
GSS_C_CALLING_ERROR_MASK
)

	)

833 
	#GSS_ROUTINE_ERROR_FIELD
(
x
) \

834 (((
x
Ë>> 
GSS_C_ROUTINE_ERROR_OFFSET
Ë& 
GSS_C_ROUTINE_ERROR_MASK
)

	)

835 
	#GSS_SUPPLEMENTARY_INFO_FIELD
(
x
) \

836 (((
x
Ë>> 
GSS_C_SUPPLEMENTARY_OFFSET
Ë& 
GSS_C_SUPPLEMENTARY_MASK
)

	)

839 
	#GSS_S_CRED_UNAVAIL
 
GSS_S_FAILURE


	)

844 c⁄° 
	tgss_buf„r_desc
 *
	tgss_c⁄°_buf„r_t
;

845 c⁄° 
	tgss_ch™√l_bödögs_°ru˘
 *
	tgss_c⁄°_ch™√l_bödögs_t
;

846 c⁄° 
	tgss_˘x_id_°ru˘
 *
	tgss_c⁄°_˘x_id_t
;

847 c⁄° 
	tgss_¸ed_id_°ru˘
 *
	tgss_c⁄°_¸ed_id_t
;

848 c⁄° 
	tgss_«me_°ru˘
 *
	tgss_c⁄°_«me_t
;

849 c⁄° 
	tgss_OID_desc
 *
	tgss_c⁄°_OID
;

850 c⁄° 
	tgss_OID_£t_desc
 *
	tgss_c⁄°_OID_£t
;

852 
OM_uöt32
 
KRB5_CALLCONV


853 
gss_ödiˇã_mechs_by_©ås
(

854 
OM_uöt32
 *,

855 
gss_c⁄°_OID_£t
,

856 
gss_c⁄°_OID_£t
,

857 
gss_c⁄°_OID_£t
,

858 
gss_OID_£t
 *);

860 
OM_uöt32
 
KRB5_CALLCONV


861 
gss_öquúe_©ås_f‹_mech
(

862 
OM_uöt32
 *,

863 
gss_c⁄°_OID
,

864 
gss_OID_£t
 *,

865 
gss_OID_£t
 *);

867 
OM_uöt32
 
KRB5_CALLCONV


868 
gss_di•œy_mech_©å
(

869 
OM_uöt32
 *,

870 
gss_c⁄°_OID
,

871 
gss_buf„r_t
,

872 
gss_buf„r_t
,

873 
gss_buf„r_t
);

875 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_MECH_CONCRETE
;

876 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_MECH_PSEUDO
;

877 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_MECH_COMPOSITE
;

878 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_MECH_NEGO
;

879 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_MECH_GLUE
;

880 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_NOT_MECH
;

881 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_DEPRECATED
;

882 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_NOT_DFLT_MECH
;

883 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_ITOK_FRAMED
;

884 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_AUTH_INIT
;

885 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_AUTH_TARG
;

886 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_AUTH_INIT_INIT
;

887 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_AUTH_TARG_INIT
;

888 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_AUTH_INIT_ANON
;

889 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_AUTH_TARG_ANON
;

890 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_DELEG_CRED
;

891 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_INTEG_PROT
;

892 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_CONF_PROT
;

893 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_MIC
;

894 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_WRAP
;

895 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_PROT_READY
;

896 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_REPLAY_DET
;

897 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_OOS_DET
;

898 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_CBINDINGS
;

899 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_PFS
;

900 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_COMPRESS
;

901 
GSS_DLLIMP
 
gss_c⁄°_OID
 
GSS_C_MA_CTX_TRANS
;

906 
OM_uöt32
 
KRB5_CALLCONV


907 
gss_öquúe_ß¶«me_f‹_mech
(

908 
OM_uöt32
 *,

909 c⁄° 
gss_OID
,

910 
gss_buf„r_t
,

911 
gss_buf„r_t
,

912 
gss_buf„r_t


915 
OM_uöt32
 
KRB5_CALLCONV


916 
gss_öquúe_mech_f‹_ß¶«me
(

917 
OM_uöt32
 *,

918 c⁄° 
gss_buf„r_t
,

919 
gss_OID
 *

	@/usr/include/gssapi/gssapi_ext.h

25 #i‚de‡
GSSAPI_EXT_H_


26 
	#GSSAPI_EXT_H_


	)

28 
	~<gsßpi/gsßpi.h
>

30 #ifde‡
__˝lu•lus


37 #i‚de‡
_WIN32


38 
OM_uöt32
 
KRB5_CALLCONV


39 
gss_≤ame_to_uid


40 (
OM_uöt32
 *
mö‹
,

41 c⁄° 
gss_«me_t
 
«me
,

42 c⁄° 
gss_OID
 
mech_ty≥
,

43 
uid_t
 *
uidOut
);

57 
OM_uöt32
 
KRB5_CALLCONV


58 
	ggss_loˇ ame


59 (
OM_uöt32
 *
	gmö‹
,

60 c⁄° 
gss_«me_t
 
	g«me
,

61 
gss_c⁄°_OID
 
	gmech_ty≥
,

62 
gss_buf„r_t
 
	gloˇ ame
);

77 
KRB5_CALLCONV


78 
gss_u£rok
(c⁄° 
gss_«me_t
 
«me
,

79 c⁄° *
u£∫ame
);

99 
OM_uöt32
 
KRB5_CALLCONV


100 
gss_auth‹ize_loˇ ame
(
OM_uöt32
 *
mö‹
,

101 c⁄° 
gss_«me_t
 
«me
,

102 c⁄° 
gss_«me_t
 
u£r
);

104 
OM_uöt32
 
KRB5_CALLCONV


105 
gss_acquúe_¸ed_wôh_∑ssw‹d
(

106 
OM_uöt32
 *,

107 c⁄° 
gss_«me_t
,

108 c⁄° 
gss_buf„r_t
,

109 
OM_uöt32
,

110 c⁄° 
gss_OID_£t
,

111 
gss_¸ed_ußge_t
,

112 
gss_¸ed_id_t
 *,

113 
gss_OID_£t
 *,

114 
OM_uöt32
 *);

116 
OM_uöt32
 
KRB5_CALLCONV


117 
gss_add_¸ed_wôh_∑ssw‹d
(

118 
OM_uöt32
 *,

119 c⁄° 
gss_¸ed_id_t
,

120 c⁄° 
gss_«me_t
,

121 c⁄° 
gss_OID
,

122 c⁄° 
gss_buf„r_t
,

123 
gss_¸ed_ußge_t
,

124 
OM_uöt32
,

125 
OM_uöt32
,

126 
gss_¸ed_id_t
 *,

127 
gss_OID_£t
 *,

128 
OM_uöt32
 *,

129 
OM_uöt32
 *);

134 
	sgss_buf„r_£t_desc_°ru˘
 {

135 
size_t
 
	gcou¡
;

136 
gss_buf„r_desc
 *
	gñemíts
;

137 } 
	tgss_buf„r_£t_desc
, *
	tgss_buf„r_£t_t
;

139 
	#GSS_C_NO_BUFFER_SET
 ((
gss_buf„r_£t_t
Ë0)

	)

141 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_¸óã_em±y_buf„r_£t


142 (
	gOM_uöt32
 * ,

143 
	ggss_buf„r_£t_t
 * );

145 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_add_buf„r_£t_membî


146 (
	gOM_uöt32
 * ,

147 c⁄° 
	ggss_buf„r_t
 ,

148 
	ggss_buf„r_£t_t
 * );

150 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_ªÀa£_buf„r_£t


151 (
	gOM_uöt32
 * ,

152 
	ggss_buf„r_£t_t
 * );

154 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_öquúe_£c_c⁄ãxt_by_oid


155 (
	gOM_uöt32
 * ,

156 c⁄° 
	ggss_˘x_id_t
 ,

157 c⁄° 
	ggss_OID
 ,

158 
	ggss_buf„r_£t_t
 * );

160 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_öquúe_¸ed_by_oid


161 (
	gOM_uöt32
 * ,

162 c⁄° 
	ggss_¸ed_id_t
 ,

163 c⁄° 
	ggss_OID
 ,

164 
	ggss_buf„r_£t_t
 * );

166 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_£t_£c_c⁄ãxt_›ti⁄


167 (
	gOM_uöt32
 * ,

168 
	ggss_˘x_id_t
 * ,

169 c⁄° 
	ggss_OID
 ,

170 c⁄° 
	ggss_buf„r_t
 );

172 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_£t_¸ed_›ti⁄


173 (
	gOM_uöt32
 * ,

174 
	ggss_¸ed_id_t
 * ,

175 c⁄° 
	ggss_OID
 ,

176 c⁄° 
	ggss_buf„r_t
 );

178 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss•i_mech_övoke


179 (
	gOM_uöt32
 * ,

180 c⁄° 
	ggss_OID
 ,

181 c⁄° 
	ggss_OID
 ,

182 
	ggss_buf„r_t
 );

188 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_wøp_´ad


189 (
	gOM_uöt32
 * ,

190 
	ggss_˘x_id_t
 ,

192 
	ggss_q›_t
 ,

193 
	ggss_buf„r_t
 ,

194 
	ggss_buf„r_t
 ,

196 
	ggss_buf„r_t
 );

198 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_unwøp_´ad


199 (
	gOM_uöt32
 * ,

200 
	ggss_˘x_id_t
 ,

201 
	ggss_buf„r_t
 ,

202 
	ggss_buf„r_t
 ,

203 
	ggss_buf„r_t
 ,

205 
	ggss_q›_t
 * );

210 
	#GSS_C_DCE_STYLE
 0x1000

	)

211 
	#GSS_C_IDENTIFY_FLAG
 0x2000

	)

212 
	#GSS_C_EXTENDED_ERROR_FLAG
 0x4000

	)

219 
GSS_DLLIMP
 
gss_OID
 
GSS_C_INQ_SSPI_SESSION_KEY
;

221 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_com∂ëe_auth_tokí


222 (
OM_uöt32
 *
	gmö‹_°©us
,

223 c⁄° 
gss_˘x_id_t
 
	gc⁄ãxt_h™dÀ
,

224 
gss_buf„r_t
 
	göput_mesßge_buf„r
);

226 
	sgss_iov_buf„r_desc_°ru˘
 {

227 
OM_uöt32
 
	gty≥
;

228 
gss_buf„r_desc
 
	gbuf„r
;

229 } 
	tgss_iov_buf„r_desc
, *
	tgss_iov_buf„r_t
;

231 
	#GSS_C_NO_IOV_BUFFER
 ((
gss_iov_buf„r_t
)0)

	)

233 
	#GSS_IOV_BUFFER_TYPE_EMPTY
 0

	)

234 
	#GSS_IOV_BUFFER_TYPE_DATA
 1

	)

235 
	#GSS_IOV_BUFFER_TYPE_HEADER
 2

	)

236 
	#GSS_IOV_BUFFER_TYPE_MECH_PARAMS
 3

	)

237 
	#GSS_IOV_BUFFER_TYPE_TRAILER
 7

	)

238 
	#GSS_IOV_BUFFER_TYPE_PADDING
 9

	)

239 
	#GSS_IOV_BUFFER_TYPE_STREAM
 10

	)

240 
	#GSS_IOV_BUFFER_TYPE_SIGN_ONLY
 11

	)

241 
	#GSS_IOV_BUFFER_TYPE_MIC_TOKEN
 12

	)

243 
	#GSS_IOV_BUFFER_FLAG_MASK
 0xFFFF0000

	)

244 
	#GSS_IOV_BUFFER_FLAG_ALLOCATE
 0x00010000

	)

245 
	#GSS_IOV_BUFFER_FLAG_ALLOCATED
 0x00020000

	)

247 
	#GSS_IOV_BUFFER_TYPE
(
_ty≥
Ë((_ty≥Ë& ~(
GSS_IOV_BUFFER_FLAG_MASK
))

	)

248 
	#GSS_IOV_BUFFER_FLAGS
(
_ty≥
Ë((_ty≥Ë& 
GSS_IOV_BUFFER_FLAG_MASK
)

	)

285 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_wøp_iov


287 
	gOM_uöt32
 *,

288 
	ggss_˘x_id_t
,

290 
	ggss_q›_t
,

292 
	ggss_iov_buf„r_desc
 *,

306 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_unwøp_iov


308 
	gOM_uöt32
 *,

309 
	ggss_˘x_id_t
,

311 
	ggss_q›_t
 *,

312 
	ggss_iov_buf„r_desc
 *,

319 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_wøp_iov_Àngth


321 
	gOM_uöt32
 *,

322 
	ggss_˘x_id_t
,

324 
	ggss_q›_t
,

326 
	ggss_iov_buf„r_desc
 *,

338 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_gë_mic_iov


340 
	gOM_uöt32
 *,

341 
	ggss_˘x_id_t
,

342 
	ggss_q›_t
,

343 
	ggss_iov_buf„r_desc
 *,

349 
OM_uöt32
 
KRB5_CALLCONV
 
gss_gë_mic_iov_Àngth
(

350 
OM_uöt32
 *,

351 
gss_˘x_id_t
,

352 
gss_q›_t
,

353 
gss_iov_buf„r_desc
 *,

361 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_vîify_mic_iov


363 
	gOM_uöt32
 *,

364 
	ggss_˘x_id_t
,

365 
	ggss_q›_t
 *,

366 
	ggss_iov_buf„r_desc
 *,

372 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_ªÀa£_iov_buf„r


374 
	gOM_uöt32
 *,

375 
	ggss_iov_buf„r_desc
 *,

381 
OM_uöt32
 
KRB5_CALLCONV


382 
gss_acquúe_¸ed_im≥rs⁄©e_«me
(

383 
OM_uöt32
 *,

384 c⁄° 
gss_¸ed_id_t
,

385 c⁄° 
gss_«me_t
,

386 
OM_uöt32
,

387 c⁄° 
gss_OID_£t
,

388 
gss_¸ed_ußge_t
,

389 
gss_¸ed_id_t
 *,

390 
gss_OID_£t
 *,

391 
OM_uöt32
 *);

393 
OM_uöt32
 
KRB5_CALLCONV


394 
gss_add_¸ed_im≥rs⁄©e_«me
(

395 
OM_uöt32
 *,

396 
gss_¸ed_id_t
,

397 c⁄° 
gss_¸ed_id_t
,

398 c⁄° 
gss_«me_t
,

399 c⁄° 
gss_OID
,

400 
gss_¸ed_ußge_t
,

401 
OM_uöt32
,

402 
OM_uöt32
,

403 
gss_¸ed_id_t
 *,

404 
gss_OID_£t
 *,

405 
OM_uöt32
 *,

406 
OM_uöt32
 *);

411 
GSS_DLLIMP
 
gss_buf„r_t
 
GSS_C_ATTR_LOCAL_LOGIN_USER
;

412 
GSS_DLLIMP
 
gss_OID
 
GSS_C_NT_COMPOSITE_EXPORT
;

414 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_di•œy_«me_ext


416 
	gOM_uöt32
 *,

417 
	ggss_«me_t
,

418 
	ggss_OID
,

419 
	ggss_buf„r_t


422 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_öquúe_«me


424 
	gOM_uöt32
 *,

425 
	ggss_«me_t
,

427 
	ggss_OID
 *,

428 
	ggss_buf„r_£t_t
 *

431 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_gë_«me_©åibuã


433 
	gOM_uöt32
 *,

434 
	ggss_«me_t
,

435 
	ggss_buf„r_t
,

438 
	ggss_buf„r_t
,

439 
	ggss_buf„r_t
,

443 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_£t_«me_©åibuã


445 
	gOM_uöt32
 *,

446 
	ggss_«me_t
,

448 
	ggss_buf„r_t
,

449 
	ggss_buf„r_t


452 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_dñëe_«me_©åibuã


454 
	gOM_uöt32
 *,

455 
	ggss_«me_t
,

456 
	ggss_buf„r_t


459 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_exp‹t_«me_composôe


461 
	gOM_uöt32
 *,

462 
	ggss_«me_t
,

463 
	ggss_buf„r_t


466 
gss_™y
 *
	tgss_™y_t
;

468 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_m≠_«me_to_™y


470 
	gOM_uöt32
 *,

471 
	ggss_«me_t
,

473 
	ggss_buf„r_t
,

474 
	ggss_™y_t
 *

477 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_ªÀa£_™y_«me_m≠pög


479 
	gOM_uöt32
 *,

480 
	ggss_«me_t
,

481 
	ggss_buf„r_t
,

482 
	ggss_™y_t
 *

486 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_íˇpsuœã_tokí


488 
	ggss_c⁄°_buf„r_t
,

489 
	ggss_c⁄°_OID
,

490 
	ggss_buf„r_t


493 
OM_uöt32
 
KRB5_CALLCONV
 
	ggss_deˇpsuœã_tokí


495 
	ggss_c⁄°_buf„r_t
,

496 
	ggss_c⁄°_OID
,

497 
	ggss_buf„r_t


500 
KRB5_CALLCONV
 
	ggss_oid_equÆ


502 
	ggss_c⁄°_OID
,

503 
	ggss_c⁄°_OID


508 
	sgss_key_vÆue_ñemít_°ru˘
 {

509 c⁄° *
	gkey
;

510 c⁄° *
	gvÆue
;

512 
gss_key_vÆue_ñemít_°ru˘
 
	tgss_key_vÆue_ñemít_desc
;

514 
	sgss_key_vÆue_£t_°ru˘
 {

515 
OM_uöt32
 
	gcou¡
;

516 
gss_key_vÆue_ñemít_desc
 *
	gñemíts
;

518 
gss_key_vÆue_£t_°ru˘
 
	tgss_key_vÆue_£t_desc
;

519 c⁄° 
	tgss_key_vÆue_£t_desc
 *
	tgss_c⁄°_key_vÆue_£t_t
;

521 
	#GSS_C_NO_CRED_STORE
 ((
gss_c⁄°_key_vÆue_£t_t
Ë0)

	)

523 
OM_uöt32
 
KRB5_CALLCONV


524 
gss_acquúe_¸ed_‰om
(

525 
OM_uöt32
 *,

526 
gss_«me_t
,

527 
OM_uöt32
,

528 
gss_OID_£t
,

529 
gss_¸ed_ußge_t
,

530 
gss_c⁄°_key_vÆue_£t_t
,

531 
gss_¸ed_id_t
 *,

532 
gss_OID_£t
 *,

533 
OM_uöt32
 *);

535 
OM_uöt32
 
KRB5_CALLCONV


536 
gss_add_¸ed_‰om
(

537 
OM_uöt32
 *,

538 
gss_¸ed_id_t
,

539 
gss_«me_t
,

540 
gss_OID
,

541 
gss_¸ed_ußge_t
,

542 
OM_uöt32
,

543 
OM_uöt32
,

544 
gss_c⁄°_key_vÆue_£t_t
,

545 
gss_¸ed_id_t
 *,

546 
gss_OID_£t
 *,

547 
OM_uöt32
 *,

548 
OM_uöt32
 *);

550 
OM_uöt32
 
KRB5_CALLCONV


551 
gss_°‹e_¸ed_öto
(

552 
OM_uöt32
 *,

553 
gss_¸ed_id_t
,

554 
gss_¸ed_ußge_t
,

555 
gss_OID
,

556 
OM_uöt32
,

557 
OM_uöt32
,

558 
gss_c⁄°_key_vÆue_£t_t
,

559 
gss_OID_£t
 *,

560 
gss_¸ed_ußge_t
 *);

562 
OM_uöt32
 
KRB5_CALLCONV


563 
gss_exp‹t_¸ed
(

564 
OM_uöt32
 *,

565 
gss_¸ed_id_t
,

566 
gss_buf„r_t
);

568 
OM_uöt32
 
KRB5_CALLCONV


569 
gss_imp‹t_¸ed
(

570 
OM_uöt32
 *,

571 
gss_buf„r_t
,

572 
gss_¸ed_id_t
 *);

574 #ifde‡
__˝lu•lus


	@/usr/include/gssapi/gssapi_generic.h

24 #i‚de‡
_GSSAPI_GENERIC_H_


25 
	#_GSSAPI_GENERIC_H_


	)

31 
	~<gsßpi/gsßpi.h
>

33 #i‡
deföed
(
__˝lu•lus
Ë&& !deföed(
GSSAPIGENERIC_BEGIN_DECLS
)

34 
	#GSSAPIGENERIC_BEGIN_DECLS
 "C" {

	)

35 
	#GSSAPIGENERIC_END_DECLS
 }

	)

37 
	#GSSAPIGENERIC_BEGIN_DECLS


	)

38 
	#GSSAPIGENERIC_END_DECLS


	)

41 
	#GSS_EMPTY_BUFFER
(
buf
Ë((bufË=
NULL
 || \

42 (
buf
)->
vÆue
 =
NULL
 || (buf)->
Àngth
 =0)

	)

44 
GSSAPIGENERIC_BEGIN_DECLS


50 
GSS_DLLIMP
 
gss_OID
 
gss_¡_u£r_«me
;

51 
GSS_DLLIMP
 
gss_OID
 
gss_¡_machöe_uid_«me
;

52 
GSS_DLLIMP
 
gss_OID
 
gss_¡_°rög_uid_«me
;

53 
gss_OID
 
gss_¡_£rvi˚_«me_v2
;

54 
GSS_DLLIMP
 
gss_OID
 
gss_¡_£rvi˚_«me
;

55 
gss_OID
 
gss_¡_exp‹ãd_«me
;

57 
	gGSSAPIGENERIC_END_DECLS


	@/usr/include/gssapi/gssapi_krb5.h

2 
	~<°döt.h
>

27 #i‚de‡
_GSSAPI_KRB5_H_


28 
	#_GSSAPI_KRB5_H_


	)

30 
	~<gsßpi/gsßpi.h
>

31 
	~<gsßpi/gsßpi_ext.h
>

32 
	~<krb5.h
>

35 #ifde‡
__˝lu•lus


42 
GSS_DLLIMP
 c⁄° 
gss_OID_desc
 * c⁄° 
GSS_KRB5_NT_PRINCIPAL_NAME
;

49 
	#GSS_KRB5_NT_HOSTBASED_SERVICE_NAME
 
GSS_C_NT_HOSTBASED_SERVICE


	)

58 
	#GSS_KRB5_NT_USER_NAME
 
GSS_C_NT_USER_NAME


	)

65 
	#GSS_KRB5_NT_MACHINE_UID_NAME
 
GSS_C_NT_MACHINE_UID_NAME


	)

72 
	#GSS_KRB5_NT_STRING_UID_NAME
 
GSS_C_NT_STRING_UID_NAME


	)

78 
GSS_DLLIMP
 c⁄° 
gss_OID_desc
 * c⁄° 
gss_mech_krb5
;

79 
GSS_DLLIMP
 c⁄° 
gss_OID_desc
 * c⁄° 
gss_mech_krb5_ﬁd
;

80 
GSS_DLLIMP
 c⁄° 
gss_OID_desc
 * c⁄° 
gss_mech_krb5_wr⁄g
;

81 
GSS_DLLIMP
 c⁄° 
gss_OID_desc
 * c⁄° 
gss_mech_ükîb
;

82 
GSS_DLLIMP
 c⁄° 
gss_OID_£t_desc
 * c⁄° 
gss_mech_£t_krb5
;

83 
GSS_DLLIMP
 c⁄° 
gss_OID_£t_desc
 * c⁄° 
gss_mech_£t_krb5_ﬁd
;

84 
GSS_DLLIMP
 c⁄° 
gss_OID_£t_desc
 * c⁄° 
gss_mech_£t_krb5_bŸh
;

86 
GSS_DLLIMP
 c⁄° 
gss_OID_desc
 * c⁄° 
gss_¡_krb5_«me
;

87 
GSS_DLLIMP
 c⁄° 
gss_OID_desc
 * c⁄° 
gss_¡_krb5_¥öcùÆ
;

89 
GSS_DLLIMP
 c⁄° 
gss_OID_desc
 
krb5_gss_oid_¨øy
[];

91 
	#gss_krb5_¡_gíîÆ_«me
 
gss_¡_krb5_«me


	)

92 
	#gss_krb5_¡_¥öcùÆ
 
gss_¡_krb5_¥öcùÆ


	)

93 
	#gss_krb5_¡_£rvi˚_«me
 
gss_¡_£rvi˚_«me


	)

94 
	#gss_krb5_¡_u£r_«me
 
gss_¡_u£r_«me


	)

95 
	#gss_krb5_¡_machöe_uid_«me
 
gss_¡_machöe_uid_«me


	)

96 
	#gss_krb5_¡_°rög_uid_«me
 
gss_¡_°rög_uid_«me


	)

99 #i‡
deföed
(
_WIN32
)

100 
	t__öt64
 
	tgss_uöt64
;

102 
	~<öây≥s.h
>

103 
uöt64_t
 
	tgss_uöt64
;

107 
	sgss_krb5_lucid_key
 {

108 
OM_uöt32
 
	gty≥
;

109 
OM_uöt32
 
	gÀngth
;

110 * 
	gd©a
;

111 } 
	tgss_krb5_lucid_key_t
;

113 
	sgss_krb5_rfc1964_keyd©a
 {

114 
OM_uöt32
 
	gsign_Æg
;

115 
OM_uöt32
 
	g£Æ_Æg
;

116 
gss_krb5_lucid_key_t
 
	g˘x_key
;

119 } 
	tgss_krb5_rfc1964_keyd©a_t
;

121 
	sgss_krb5_cfx_keyd©a
 {

122 
OM_uöt32
 
	ghave_ac˚±‹_subkey
;

125 
gss_krb5_lucid_key_t
 
	g˘x_key
;

128 
gss_krb5_lucid_key_t
 
	gac˚±‹_subkey
;

131 } 
	tgss_krb5_cfx_keyd©a_t
;

133 
	sgss_krb5_lucid_c⁄ãxt_v1
 {

134 
OM_uöt32
 
	gvîsi⁄
;

136 
OM_uöt32
 
	göôüã
;

137 
OM_uöt32
 
	gídtime
;

138 
gss_uöt64
 
	g£nd_£q
;

139 
gss_uöt64
 
	gªcv_£q
;

140 
OM_uöt32
 
	g¥Ÿocﬁ
;

148 
gss_krb5_rfc1964_keyd©a_t
 
	grfc1964_kd
;

149 
gss_krb5_cfx_keyd©a_t
 
	gcfx_kd
;

150 } 
	tgss_krb5_lucid_c⁄ãxt_v1_t
;

156 
	sgss_krb5_lucid_c⁄ãxt_vîsi⁄
 {

157 
OM_uöt32
 
	gvîsi⁄
;

158 } 
	tgss_krb5_lucid_c⁄ãxt_vîsi⁄_t
;

164 
	#gsskrb5_ªgi°î_ac˚±‹_idítôy
 
krb5_gss_ªgi°î_ac˚±‹_idítôy


	)

166 
OM_uöt32
 
KRB5_CALLCONV
 
krb5_gss_ªgi°î_ac˚±‹_idítôy
(const *);

168 
OM_uöt32
 
KRB5_CALLCONV
 
gss_krb5_gë_tkt_Êags
(

169 
OM_uöt32
 *
mö‹_°©us
,

170 
gss_˘x_id_t
 
c⁄ãxt_h™dÀ
,

171 
krb5_Êags
 *
tickë_Êags
);

173 
OM_uöt32
 
KRB5_CALLCONV
 
gss_krb5_c›y_cˇche
(

174 
OM_uöt32
 *
mö‹_°©us
,

175 
gss_¸ed_id_t
 
¸ed_h™dÀ
,

176 
krb5_cˇche
 
out_cˇche
);

178 
OM_uöt32
 
KRB5_CALLCONV
 
gss_krb5_cˇche_«me
(

179 
OM_uöt32
 *
mö‹_°©us
, c⁄° *
«me
,

180 c⁄° **
out_«me
);

205 
OM_uöt32
 
KRB5_CALLCONV


206 
gss_krb5_£t_ÆlowabÀ_í˘y≥s
(
OM_uöt32
 *
mö‹_°©us
,

207 
gss_¸ed_id_t
 
¸ed
,

208 
OM_uöt32
 
num_kty≥s
,

209 
krb5_í˘y≥
 *
kty≥s
);

242 
OM_uöt32
 
KRB5_CALLCONV


243 
gss_krb5_exp‹t_lucid_£c_c⁄ãxt
(
OM_uöt32
 *
mö‹_°©us
,

244 
gss_˘x_id_t
 *
c⁄ãxt_h™dÀ
,

245 
OM_uöt32
 
vîsi⁄
,

246 **
k˘x
);

252 
OM_uöt32
 
KRB5_CALLCONV


253 
gss_krb5_‰ì_lucid_£c_c⁄ãxt
(
OM_uöt32
 *
mö‹_°©us
,

254 *
k˘x
);

257 
OM_uöt32
 
KRB5_CALLCONV


258 
gsskrb5_exåa˘_authz_d©a_‰om_£c_c⁄ãxt
(
OM_uöt32
 *
mö‹_°©us
,

259 c⁄° 
gss_˘x_id_t
 
c⁄ãxt_h™dÀ
,

260 
ad_ty≥
,

261 
gss_buf„r_t
 
ad_d©a
);

263 
OM_uöt32
 
KRB5_CALLCONV


264 
gss_krb5_£t_¸ed_rˇche
(
OM_uöt32
 *
mö‹_°©us
,

265 
gss_¸ed_id_t
 
¸ed
,

266 
krb5_rˇche
 
rˇche
);

268 
OM_uöt32
 
KRB5_CALLCONV


269 
gsskrb5_exåa˘_authtime_‰om_£c_c⁄ãxt
(
OM_uöt32
 *, 
gss_˘x_id_t
, 
krb5_time°amp
 *);

271 
OM_uöt32
 
KRB5_CALLCONV


272 
gss_krb5_imp‹t_¸ed
(
OM_uöt32
 *
mö‹_°©us
,

273 
krb5_cˇche
 
id
,

274 
krb5_¥öcùÆ
 
keyèb_¥öcùÆ
,

275 
krb5_keyèb
 
keyèb
,

276 
gss_¸ed_id_t
 *
¸ed
);

278 #ifde‡
__˝lu•lus


	@/usr/include/ifaddrs.h

19 #i‚de‡
_IFADDRS_H


20 
	#_IFADDRS_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<sys/sockë.h
>

25 
__BEGIN_DECLS


29 
	siÁddrs


31 
iÁddrs
 *
	miÁ_√xt
;

33 *
	miÁ_«me
;

34 
	miÁ_Êags
;

36 
sockaddr
 *
	miÁ_addr
;

37 
sockaddr
 *
	miÁ_√tmask
;

44 
sockaddr
 *
	mifu_brﬂdaddr
;

45 
sockaddr
 *
	mifu_d°addr
;

46 } 
	miÁ_ifu
;

49 #i‚de‡
iÁ_brﬂdaddr


50 
	#iÁ_brﬂdaddr
 
iÁ_ifu
.
ifu_brﬂdaddr


	)

52 #i‚de‡
iÁ_d°addr


53 
	#iÁ_d°addr
 
iÁ_ifu
.
ifu_d°addr


	)

56 *
	miÁ_d©a
;

66 
	$gëiÁddrs
 (
iÁddrs
 **
__iÁp
Ë
__THROW
;

69 
	$‰ìiÁddrs
 (
iÁddrs
 *
__iÁ
Ë
__THROW
;

71 
__END_DECLS


	@/usr/include/inttypes.h

22 #i‚de‡
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<°döt.h
>

30 #i‚de‡
____gwch¨_t_deföed


31 #ifde‡
__˝lu•lus


32 
	#__gwch¨_t
 
wch¨_t


	)

33 #ñi‡
deföed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¨_t
;

36 
	#__√ed_wch¨_t


	)

37 
	~<°ddef.h
>

38 
wch¨_t
 
	t__gwch¨_t
;

40 
	#____gwch¨_t_deföed
 1

	)

43 #i‡
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Œ"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #i‡
__WORDSIZE
 == 64

273 
	mquŸ
;

274 
	mªm
;

275 } 
	timaxdiv_t
;

282 
__exãnsi⁄__
 
	mquŸ
;

283 
__exãnsi⁄__
 
	mªm
;

284 } 
	timaxdiv_t
;

290 
ötmax_t
 
	$imaxabs
 (
ötmax_t
 
__n
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
ötmax_t
 
__numî
, i¡max_à
__díom
)

294 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

297 
ötmax_t
 
	$°πoimax
 (c⁄° *
__ª°ri˘
 
__≈å
,

298 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

301 
uötmax_t
 
	$°πoumax
 (c⁄° *
__ª°ri˘
 
__≈å
,

302 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

305 
ötmax_t
 
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

306 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

307 
__THROW
;

310 
uötmax_t
 
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

311 
__gwch¨_t
 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
)

312 
__THROW
;

314 #ifde‡
__USE_EXTERN_INLINES


316 #i‡
__WORDSIZE
 == 64

318 
	$__°πﬁ_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

319 **
__ª°ri˘
 
__íd±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

323 
__exã∫_ölöe
 
ötmax_t


324 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

325 
ba£
))

327  
	`__°πﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

328 
	}
}

330 
	$__°πoul_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

331 ** 
__ª°ri˘
 
__íd±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

335 
__exã∫_ölöe
 
uötmax_t


336 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

337 
ba£
))

339  
	`__°πoul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc°ﬁ_öã∫Æ
 (c⁄° 
__gwch¨_t
 * 
__ª°ri˘
 
__≈å
,

343 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

347 
__exã∫_ölöe
 
ötmax_t


348 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

349 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

351  
	`__wc°ﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc°oul_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

355 
__ª°ri˘
 
__≈å
,

356 
__gwch¨_t
 **

357 
__ª°ri˘
 
__íd±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

361 
__exã∫_ölöe
 
uötmax_t


362 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

363 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

365  
	`__wc°oul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

366 
	}
}

370 
__exãnsi⁄__


371 
	$__°πﬁl_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

372 **
__ª°ri˘
 
__íd±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

376 
__exã∫_ölöe
 
ötmax_t


377 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

378 
ba£
))

380  
	`__°πﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

381 
	}
}

383 
__exãnsi⁄__


384 
	$__°πouŒ_öã∫Æ
 (const *

385 
__ª°ri˘
 
__≈å
,

387 
__ª°ri˘
 
__íd±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

392 
__exã∫_ölöe
 
uötmax_t


393 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

394 
ba£
))

396  
	`__°πouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

397 
	}
}

399 
__exãnsi⁄__


400 
	$__wc°ﬁl_öã∫Æ
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

401 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

405 
__exã∫_ölöe
 
ötmax_t


406 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

407 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

409  
	`__wc°ﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

410 
	}
}

413 
__exãnsi⁄__


414 
	$__wc°ouŒ_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

415 
__ª°ri˘
 
__≈å
,

416 
__gwch¨_t
 **

417 
__ª°ri˘
 
__íd±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

422 
__exã∫_ölöe
 
uötmax_t


423 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

424 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

426  
	`__wc°ouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/json-c/json.h

13 #i‚de‡
_js⁄_h_


14 
	#_js⁄_h_


	)

16 #ifde‡
__˝lu•lus


20 
	~"bôs.h
"

21 
	~"debug.h
"

22 
	~"lökhash.h
"

23 
	~"¨øyli°.h
"

24 
	~"js⁄_utû.h
"

25 
	~"js⁄_obje˘.h
"

26 
	~"js⁄_tokíî.h
"

27 
	~"js⁄_obje˘_ôî©‹.h
"

28 
	~"js⁄_c_vîsi⁄.h
"

30 #ifde‡
__˝lu•lus


	@/usr/include/krb5.h

8 
	~<krb5/krb5.h
>

	@/usr/include/lber.h

26 #i‚de‡
_LBER_H


27 
	#_LBER_H


	)

29 
	~<lbî_ty≥s.h
>

30 
	~<°rög.h
>

32 
	gLDAP_BEGIN_DECL


60 
	#LBER_CLASS_UNIVERSAL
 ((
bî_èg_t
Ë0x00U)

	)

61 
	#LBER_CLASS_APPLICATION
 ((
bî_èg_t
Ë0x40U)

	)

62 
	#LBER_CLASS_CONTEXT
 ((
bî_èg_t
Ë0x80U)

	)

63 
	#LBER_CLASS_PRIVATE
 ((
bî_èg_t
Ë0xc0U)

	)

64 
	#LBER_CLASS_MASK
 ((
bî_èg_t
Ë0xc0U)

	)

67 
	#LBER_PRIMITIVE
 ((
bî_èg_t
Ë0x00U)

	)

68 
	#LBER_CONSTRUCTED
 ((
bî_èg_t
Ë0x20U)

	)

69 
	#LBER_ENCODING_MASK
 ((
bî_èg_t
Ë0x20U)

	)

71 
	#LBER_BIG_TAG_MASK
 ((
bî_èg_t
Ë0x1fU)

	)

72 
	#LBER_MORE_TAG_MASK
 ((
bî_èg_t
Ë0x80U)

	)

79 
	#LBER_ERROR
 ((
bî_èg_t
Ë-1)

	)

80 
	#LBER_DEFAULT
 ((
bî_èg_t
Ë-1)

	)

83 
	#LBER_BOOLEAN
 ((
bî_èg_t
Ë0x01UL)

	)

84 
	#LBER_INTEGER
 ((
bî_èg_t
Ë0x02UL)

	)

85 
	#LBER_BITSTRING
 ((
bî_èg_t
Ë0x03UL)

	)

86 
	#LBER_OCTETSTRING
 ((
bî_èg_t
Ë0x04UL)

	)

87 
	#LBER_NULL
 ((
bî_èg_t
Ë0x05UL)

	)

88 
	#LBER_ENUMERATED
 ((
bî_èg_t
Ë0x0aUL)

	)

89 
	#LBER_SEQUENCE
 ((
bî_èg_t
Ë0x30ULË

	)

90 
	#LBER_SET
 ((
bî_èg_t
Ë0x31ULË

	)

93 
	#LBER_USE_DER
 0x01

	)

96 
	#LBER_OPT_BER_OPTIONS
 0x01

	)

97 
	#LBER_OPT_BER_DEBUG
 0x02

	)

98 
	#LBER_OPT_BER_REMAINING_BYTES
 0x03

	)

99 
	#LBER_OPT_BER_TOTAL_BYTES
 0x04

	)

100 
	#LBER_OPT_BER_BYTES_TO_WRITE
 0x05

	)

101 
	#LBER_OPT_BER_MEMCTX
 0x06

	)

103 
	#LBER_OPT_DEBUG_LEVEL
 
LBER_OPT_BER_DEBUG


	)

104 
	#LBER_OPT_REMAINING_BYTES
 
LBER_OPT_BER_REMAINING_BYTES


	)

105 
	#LBER_OPT_TOTAL_BYTES
 
LBER_OPT_BER_TOTAL_BYTES


	)

106 
	#LBER_OPT_BYTES_TO_WRITE
 
LBER_OPT_BER_BYTES_TO_WRITE


	)

108 
	#LBER_OPT_LOG_PRINT_FN
 0x8001

	)

109 
	#LBER_OPT_MEMORY_FNS
 0x8002

	)

110 
	#LBER_OPT_ERROR_FN
 0x8003

	)

111 
	#LBER_OPT_LOG_PRINT_FILE
 0x8004

	)

114 
	#LBER_OPT_MEMORY_INUSE
 0x8005

	)

115 
	#LBER_OPT_LOG_PROC
 0x8006

	)

117 * (*
	tBER_ERRNO_FN
Ë
	tLDAP_P
(( ));

119 (*
	tBER_LOG_PRINT_FN
Ë
	tLDAP_P
(–
	tLDAP_CONST
 *
	tbuf
 ));

121 * (
	tBER_MEMALLOC_FN
Ë
	tLDAP_P
(–
	tbî_Àn_t
 
	tsize
, *
	t˘x
 ));

122 * (
	tBER_MEMCALLOC_FN
Ë
	tLDAP_P
(–
	tbî_Àn_t
 
	tn
, bî_Àn_à
	tsize
, *
	t˘x
 ));

123 * (
	tBER_MEMREALLOC_FN
Ë
	tLDAP_P
(–*
	tp
, 
	tbî_Àn_t
 
	tsize
, *
	t˘x
 ));

124 (
	tBER_MEMFREE_FN
Ë
	tLDAP_P
(–*
	tp
, *
	t˘x
 ));

126 
	slbî_mem‹y_‚s
 {

127 
BER_MEMALLOC_FN
 *
bmf_mÆloc
;

128 
BER_MEMCALLOC_FN
 *
bmf_ˇŒoc
;

129 
BER_MEMREALLOC_FN
 *
bmf_ªÆloc
;

130 
BER_MEMFREE_FN
 *
bmf_‰ì
;

131 } 
	tBîMem‹yFun˘i⁄s
;

134 
	#LBER_SB_OPT_GET_FD
 1

	)

135 
	#LBER_SB_OPT_SET_FD
 2

	)

136 
	#LBER_SB_OPT_HAS_IO
 3

	)

137 
	#LBER_SB_OPT_SET_NONBLOCK
 4

	)

138 
	#LBER_SB_OPT_GET_SSL
 7

	)

139 
	#LBER_SB_OPT_DATA_READY
 8

	)

140 
	#LBER_SB_OPT_SET_READAHEAD
 9

	)

141 
	#LBER_SB_OPT_DRAIN
 10

	)

142 
	#LBER_SB_OPT_NEEDS_READ
 11

	)

143 
	#LBER_SB_OPT_NEEDS_WRITE
 12

	)

144 
	#LBER_SB_OPT_GET_MAX_INCOMING
 13

	)

145 
	#LBER_SB_OPT_SET_MAX_INCOMING
 14

	)

148 
	#LBER_SB_OPT_UNGET_BUF
 15

	)

151 
	#LBER_SB_OPT_OPT_MAX
 15

	)

154 
	#LBER_SBIOD_LEVEL_PROVIDER
 10

	)

155 
	#LBER_SBIOD_LEVEL_TRANSPORT
 20

	)

156 
	#LBER_SBIOD_LEVEL_APPLICATION
 30

	)

159 
	#LBER_OPT_SOCKBUF_DESC
 0x1000

	)

160 
	#LBER_OPT_SOCKBUF_OPTIONS
 0x1001

	)

161 
	#LBER_OPT_SOCKBUF_DEBUG
 0x1002

	)

164 
	$LBER_V
–Ë
bî_pvt_›t_⁄
;

165 
	#LBER_OPT_ON
 ((*Ë&
bî_pvt_›t_⁄
)

	)

166 
	#LBER_OPT_OFF
 ((*Ë0)

	)

168 
	#LBER_OPT_SUCCESS
 (0)

	)

169 
	#LBER_OPT_ERROR
 (-1)

	)

171 
bîñemít
 
	tBîEÀmít
;

172 
sockbuf
 
	tSockbuf
;

174 
sockbuf_io
 
	tSockbuf_IO
;

177 
	ssockbuf_io_desc
 {

178 
sbiod_Àvñ
;

179 
Sockbuf
 *
sbiod_sb
;

180 
Sockbuf_IO
 *
sbiod_io
;

181 *
sbiod_pvt
;

182 
sockbuf_io_desc
 *
sbiod_√xt
;

183 } 
	tSockbuf_IO_Desc
;

186 
	ssockbuf_io
 {

187 (*
sbi_£tup
)–
Sockbuf_IO_Desc
 *
sbiod
, *
¨g
 );

188 (*
sbi_ªmove
)–
Sockbuf_IO_Desc
 *
sbiod
 );

189 (*
sbi_˘æ
)–
Sockbuf_IO_Desc
 *
sbiod
, 
›t
, *
¨g
);

191 
	`bî_¶í_t
 (*
sbi_ªad
)–
Sockbuf_IO_Desc
 *
sbiod
, *
buf
,

192 
bî_Àn_t
 
Àn
 );

193 
	`bî_¶í_t
 (*
sbi_wrôe
)–
Sockbuf_IO_Desc
 *
sbiod
, *
buf
,

194 
bî_Àn_t
 
Àn
 );

196 (*
sbi_˛o£
)–
Sockbuf_IO_Desc
 *
sbiod
 );

200 
	#LBER_SBIOD_READ_NEXT
–
sbiod
, 
buf
, 
Àn
 ) \

201 –(
sbiod
)->
sbiod_√xt
->
sbiod_io
->
	`sbi_ªad
( (sbiod)->sbiod_next, \

202 
buf
, 
Àn
 ) )

	)

203 
	#LBER_SBIOD_WRITE_NEXT
–
sbiod
, 
buf
, 
Àn
 ) \

204 –(
sbiod
)->
sbiod_√xt
->
sbiod_io
->
	`sbi_wrôe
( (sbiod)->sbiod_next, \

205 
buf
, 
Àn
 ) )

	)

206 
	#LBER_SBIOD_CTRL_NEXT
–
sbiod
, 
›t
, 
¨g
 ) \

207 –(
sbiod
)->
sbiod_√xt
 ? \

208 –(
sbiod
)->
sbiod_√xt
->
sbiod_io
->
	`sbi_˘æ
( \

209 (
sbiod
)->
sbiod_√xt
, 
›t
, 
¨g
 ) ) : 0 )

	)

212 
	sbîvÆ
 {

213 
bî_Àn_t
 
bv_Àn
;

214 *
bv_vÆ
;

215 } 
	tBîVÆue
;

217 
BîVÆue
 *
	tBîV¨øy
;

224 
	$LBER_F
( )

225 
bî_îr‹_¥öt
 
	`LDAP_P
((

226 
LDAP_CONST
 *
d©a
 ));

228 
	$LBER_F
( )

229 
bî_b¥öt
 
	`LDAP_P
((

230 
LDAP_CONST
 *
d©a
, 
bî_Àn_t
 
Àn
 ));

232 
	$LBER_F
( )

233 
bî_dump
 
	`LDAP_P
((

234 
BîEÀmít
 *
bî
, 
öout
 ));

239 (*
	tBERDecodeCÆlback
Ë
	tLDAP_P
((

240 
	tBîEÀmít
 *
	tbî
,

241 *
	td©a
,

242 
	tmode
 ));

244 
	$LBER_F
–
bî_èg_t
 )

245 
bî_gë_èg
 
	`LDAP_P
((

246 
BîEÀmít
 *
bî
 ));

248 
	$LBER_F
–
bî_èg_t
 )

249 
bî_skù_èg
 
	`LDAP_P
((

250 
BîEÀmít
 *
bî
,

251 
bî_Àn_t
 *
Àn
 ));

253 
	$LBER_F
–
bî_èg_t
 )

254 
bî_≥ek_èg
 
	`LDAP_P
((

255 
BîEÀmít
 *
bî
,

256 
bî_Àn_t
 *
Àn
 ));

258 
	$LBER_F
–
bî_èg_t
 )

259 
bî_skù_ñemít
 
	`LDAP_P
((

260 
BîEÀmít
 *
bî
,

261 
bîvÆ
 *
bv
 ));

263 
	$LBER_F
–
bî_èg_t
 )

264 
bî_≥ek_ñemít
 
	`LDAP_P
((

265 
LDAP_CONST
 
BîEÀmít
 *
bî
,

266 
bîvÆ
 *
bv
 ));

268 
	$LBER_F
–
bî_èg_t
 )

269 
bî_gë_öt
 
	`LDAP_P
((

270 
BîEÀmít
 *
bî
,

271 
bî_öt_t
 *
num
 ));

273 
	$LBER_F
–
bî_èg_t
 )

274 
bî_gë_íum
 
	`LDAP_P
((

275 
BîEÀmít
 *
bî
,

276 
bî_öt_t
 *
num
 ));

278 
	$LBER_F
–
bî_èg_t
 )

279 
bî_gë_°rögb
 
	`LDAP_P
((

280 
BîEÀmít
 *
bî
,

281 *
buf
,

282 
bî_Àn_t
 *
Àn
 ));

284 
	#LBER_BV_ALLOC
 0x01

	)

285 
	#LBER_BV_NOTERM
 0x02

	)

286 
	#LBER_BV_STRING
 0x04

	)

291 
	$LBER_F
–
bî_èg_t
 )

292 
bî_gë_°rögbv
 
	`LDAP_P
((

293 
BîEÀmít
 *
bî
,

294 
bîvÆ
 *
bv
,

295 
›ti⁄s
 ));

297 
	$LBER_F
–
bî_èg_t
 )

298 
bî_gë_°röga
 
	`LDAP_P
((

299 
BîEÀmít
 *
bî
,

300 **
buf
 ));

302 
	$LBER_F
–
bî_èg_t
 )

303 
bî_gë_°rögÆ
 
	`LDAP_P
((

304 
BîEÀmít
 *
bî
,

305 
bîvÆ
 **
bv
 ));

307 
	$LBER_F
–
bî_èg_t
 )

308 
bî_gë_bô°röga
 
	`LDAP_P
((

309 
BîEÀmít
 *
bî
,

310 **
buf
,

311 
bî_Àn_t
 *
Àn
 ));

313 
	$LBER_F
–
bî_èg_t
 )

314 
bî_gë_nuŒ
 
	`LDAP_P
((

315 
BîEÀmít
 *
bî
 ));

317 
	$LBER_F
–
bî_èg_t
 )

318 
bî_gë_boﬁón
 
	`LDAP_P
((

319 
BîEÀmít
 *
bî
,

320 
bî_öt_t
 *
boﬁvÆ
 ));

322 
	$LBER_F
–
bî_èg_t
 )

323 
bî_fú°_ñemít
 
	`LDAP_P
((

324 
BîEÀmít
 *
bî
,

325 
bî_Àn_t
 *
Àn
,

326 **
œ°
 ));

328 
	$LBER_F
–
bî_èg_t
 )

329 
bî_√xt_ñemít
 
	`LDAP_P
((

330 
BîEÀmít
 *
bî
,

331 
bî_Àn_t
 *
Àn
,

332 
LDAP_CONST
 *
œ°
 ));

334 
	$LBER_F
–
bî_èg_t
 )

335 
bî_sˇnf
 
	`LDAP_P
((

336 
BîEÀmít
 *
bî
,

337 
LDAP_CONST
 *
fmt
,

340 
	$LBER_F
( )

341 
bî_decode_oid
 
	`LDAP_P
((

342 
bîvÆ
 *
ö
,

343 
bîvÆ
 *
out
 ));

348 
	$LBER_F
( )

349 
bî_ícode_oid
 
	`LDAP_P
((

350 
bîvÆ
 *
ö
,

351 
bîvÆ
 *
out
 ));

353 (*
	tBEREncodeCÆlback
Ë
	tLDAP_P
((

354 
	tBîEÀmít
 *
	tbî
,

355 *
	td©a
 ));

357 
	$LBER_F
( )

358 
bî_put_íum
 
	`LDAP_P
((

359 
BîEÀmít
 *
bî
,

360 
bî_öt_t
 
num
,

361 
bî_èg_t
 
èg
 ));

363 
	$LBER_F
( )

364 
bî_put_öt
 
	`LDAP_P
((

365 
BîEÀmít
 *
bî
,

366 
bî_öt_t
 
num
,

367 
bî_èg_t
 
èg
 ));

369 
	$LBER_F
( )

370 
bî_put_o°rög
 
	`LDAP_P
((

371 
BîEÀmít
 *
bî
,

372 
LDAP_CONST
 *
°r
,

373 
bî_Àn_t
 
Àn
,

374 
bî_èg_t
 
èg
 ));

376 
	$LBER_F
( )

377 
bî_put_bîvÆ
 
	`LDAP_P
((

378 
BîEÀmít
 *
bî
,

379 
bîvÆ
 *
bv
,

380 
bî_èg_t
 
èg
 ));

382 
	$LBER_F
( )

383 
bî_put_°rög
 
	`LDAP_P
((

384 
BîEÀmít
 *
bî
,

385 
LDAP_CONST
 *
°r
,

386 
bî_èg_t
 
èg
 ));

388 
	$LBER_F
( )

389 
bî_put_bô°rög
 
	`LDAP_P
((

390 
BîEÀmít
 *
bî
,

391 
LDAP_CONST
 *
°r
,

392 
bî_Àn_t
 
bôÀn
,

393 
bî_èg_t
 
èg
 ));

395 
	$LBER_F
( )

396 
bî_put_nuŒ
 
	`LDAP_P
((

397 
BîEÀmít
 *
bî
,

398 
bî_èg_t
 
èg
 ));

400 
	$LBER_F
( )

401 
bî_put_boﬁón
 
	`LDAP_P
((

402 
BîEÀmít
 *
bî
,

403 
bî_öt_t
 
boﬁvÆ
,

404 
bî_èg_t
 
èg
 ));

406 
	$LBER_F
( )

407 
bî_°¨t_£q
 
	`LDAP_P
((

408 
BîEÀmít
 *
bî
,

409 
bî_èg_t
 
èg
 ));

411 
	$LBER_F
( )

412 
bî_°¨t_£t
 
	`LDAP_P
((

413 
BîEÀmít
 *
bî
,

414 
bî_èg_t
 
èg
 ));

416 
	$LBER_F
( )

417 
bî_put_£q
 
	`LDAP_P
((

418 
BîEÀmít
 *
bî
 ));

420 
	$LBER_F
( )

421 
bî_put_£t
 
	`LDAP_P
((

422 
BîEÀmít
 *
bî
 ));

424 
	$LBER_F
( )

425 
bî_¥ötf
 
	`LDAP_P
((

426 
BîEÀmít
 *
bî
,

427 
LDAP_CONST
 *
fmt
,

435 
	$LBER_F
–
bî_¶í_t
 )

436 
bî_skù_d©a
 
	`LDAP_P
((

437 
BîEÀmít
 *
bî
,

438 
bî_Àn_t
 
Àn
 ));

440 
	$LBER_F
–
bî_¶í_t
 )

441 
bî_ªad
 
	`LDAP_P
((

442 
BîEÀmít
 *
bî
,

443 *
buf
,

444 
bî_Àn_t
 
Àn
 ));

446 
	$LBER_F
–
bî_¶í_t
 )

447 
bî_wrôe
 
	`LDAP_P
((

448 
BîEÀmít
 *
bî
,

449 
LDAP_CONST
 *
buf
,

450 
bî_Àn_t
 
Àn
,

451 
zîo
 ));

453 
	$LBER_F
( )

454 
bî_‰ì
 
	`LDAP_P
((

455 
BîEÀmít
 *
bî
,

456 
‰ìbuf
 ));

458 
	$LBER_F
( )

459 
bî_‰ì_buf
 
	`LDAP_P
(–
BîEÀmít
 *
bî
 ));

461 
	$LBER_F
( )

462 
bî_Êush2
 
	`LDAP_P
((

463 
Sockbuf
 *
sb
,

464 
BîEÀmít
 *
bî
,

465 
‰ìô
 ));

466 
	#LBER_FLUSH_FREE_NEVER
 (0x0Ë

	)

467 
	#LBER_FLUSH_FREE_ON_SUCCESS
 (0x1Ë

	)

468 
	#LBER_FLUSH_FREE_ON_ERROR
 (0x2)

	)

469 
	#LBER_FLUSH_FREE_ALWAYS
 (
LBER_FLUSH_FREE_ON_SUCCESS
|
LBER_FLUSH_FREE_ON_ERROR
)

	)

471 
	$LBER_F
( )

472 
bî_Êush
 
	`LDAP_P
((

473 
Sockbuf
 *
sb
,

474 
BîEÀmít
 *
bî
,

475 
‰ìô
 ));

477 
	$LBER_F
–
BîEÀmít
 * )

478 
bî_Æloc
 
	`LDAP_P
(( ));

480 
	$LBER_F
–
BîEÀmít
 * )

481 
dî_Æloc
 
	`LDAP_P
(( ));

483 
	$LBER_F
–
BîEÀmít
 * )

484 
bî_Æloc_t
 
	`LDAP_P
((

485 
bî›ti⁄s
 ));

487 
	$LBER_F
–
BîEÀmít
 * )

488 
bî_dup
 
	`LDAP_P
((

489 
BîEÀmít
 *
bî
 ));

491 
	$LBER_F
–
bî_èg_t
 )

492 
bî_gë_√xt
 
	`LDAP_P
((

493 
Sockbuf
 *
sb
,

494 
bî_Àn_t
 *
Àn
,

495 
BîEÀmít
 *
bî
 ));

497 
	$LBER_F
( )

498 
bî_öô2
 
	`LDAP_P
((

499 
BîEÀmít
 *
bî
,

500 
bîvÆ
 *
bv
,

501 
›ti⁄s
 ));

503 
	$LBER_F
( )

504 
bî_öô_w_nuŒc
 
	`LDAP_P
((

505 
BîEÀmít
 *
bî
,

506 
›ti⁄s
 ));

508 
	$LBER_F
( )

509 
bî_ª£t
 
	`LDAP_P
((

510 
BîEÀmít
 *
bî
,

511 
was_wrôög
 ));

513 
	$LBER_F
–
BîEÀmít
 * )

514 
bî_öô
 
	`LDAP_P
((

515 
bîvÆ
 *
bv
 ));

517 
	$LBER_F
( )

518 
bî_Ê©ãn
 
	`LDAP_P
((

519 
BîEÀmít
 *
bî
,

520 
bîvÆ
 **
bvPå
 ));

522 
	$LBER_F
( )

523 
bî_Ê©ãn2
 
	`LDAP_P
((

524 
BîEÀmít
 *
bî
,

525 
bîvÆ
 *
bv
,

526 
Æloc
 ));

528 
	$LBER_F
( )

529 
bî_ªmaöög
 
	`LDAP_P
((

530 
BîEÀmít
 *
bî
 ));

536 
	$LBER_F
( )

537 
bî_gë_›ti⁄
 
	`LDAP_P
((

538 *
ôem
,

539 
›ti⁄
,

540 *
outvÆue
));

542 
	$LBER_F
( )

543 
bî_£t_›ti⁄
 
	`LDAP_P
((

544 *
ôem
,

545 
›ti⁄
,

546 
LDAP_CONST
 *
övÆue
));

552 
	$LBER_F
–
Sockbuf
 * )

553 
bî_sockbuf_Æloc
 
	`LDAP_P
((

556 
	$LBER_F
( )

557 
bî_sockbuf_‰ì
 
	`LDAP_P
((

558 
Sockbuf
 *
sb
 ));

560 
	$LBER_F
( )

561 
bî_sockbuf_add_io
 
	`LDAP_P
((

562 
Sockbuf
 *
sb
,

563 
Sockbuf_IO
 *
sbio
,

564 
œyî
,

565 *
¨g
 ));

567 
	$LBER_F
( )

568 
bî_sockbuf_ªmove_io
 
	`LDAP_P
((

569 
Sockbuf
 *
sb
,

570 
Sockbuf_IO
 *
sbio
,

571 
œyî
 ));

573 
	$LBER_F
( )

574 
bî_sockbuf_˘æ
 
	`LDAP_P
((

575 
Sockbuf
 *
sb
,

576 
›t
,

577 *
¨g
 ));

579 
	$LBER_V
–
Sockbuf_IO
 ) 
bî_sockbuf_io_t˝
;

580 
	$LBER_V
–
Sockbuf_IO
 ) 
bî_sockbuf_io_ªadahód
;

581 
	$LBER_V
–
Sockbuf_IO
 ) 
bî_sockbuf_io_fd
;

582 
	$LBER_V
–
Sockbuf_IO
 ) 
bî_sockbuf_io_debug
;

583 
	$LBER_V
–
Sockbuf_IO
 ) 
bî_sockbuf_io_udp
;

588 
	$LBER_F
( * )

589 
bî_memÆloc
 
	`LDAP_P
((

590 
bî_Àn_t
 
s
 ));

592 
	$LBER_F
( * )

593 
bî_memªÆloc
 
	`LDAP_P
((

594 * 
p
,

595 
bî_Àn_t
 
s
 ));

597 
	$LBER_F
( * )

598 
bî_memˇŒoc
 
	`LDAP_P
((

599 
bî_Àn_t
 
n
,

600 
bî_Àn_t
 
s
 ));

602 
	$LBER_F
( )

603 
bî_mem‰ì
 
	`LDAP_P
((

604 * 
p
 ));

606 
	$LBER_F
( )

607 
bî_memv‰ì
 
	`LDAP_P
((

608 ** 
ve˘‹
 ));

610 
	$LBER_F
( )

611 
bî_bv‰ì
 
	`LDAP_P
((

612 
bîvÆ
 *
bv
 ));

614 
	$LBER_F
( )

615 
bî_bvec‰ì
 
	`LDAP_P
((

616 
bîvÆ
 **
bv
 ));

618 
	$LBER_F
( )

619 
bî_bveˇdd
 
	`LDAP_P
((

620 
bîvÆ
 ***
bvec
,

621 
bîvÆ
 *
bv
 ));

623 
	$LBER_F
–
bîvÆ
 * )

624 
bî_dupbv
 
	`LDAP_P
((

625 
bîvÆ
 *
d°
, bîvÆ *
§c
 ));

627 
	$LBER_F
–
bîvÆ
 * )

628 
bî_bvdup
 
	`LDAP_P
((

629 
bîvÆ
 *
§c
 ));

631 
	$LBER_F
–
bîvÆ
 * )

632 
bî_mem2bv
 
	`LDAP_P
((

633 
LDAP_CONST
 *, 
bî_Àn_t
 
Àn
, 
du∂iˇã
, 
bîvÆ
 *
bv
));

635 
	$LBER_F
–
bîvÆ
 * )

636 
bî_°r2bv
 
	`LDAP_P
((

637 
LDAP_CONST
 *, 
bî_Àn_t
 
Àn
, 
du∂iˇã
, 
bîvÆ
 *
bv
));

639 
	#bî_bv°r
(
a
Ë((
bî_°r2bv
)(◊), 0, 0, 
NULL
))

	)

640 
	#bî_bv°rdup
(
a
Ë((
bî_°r2bv
)(◊), 0, 1, 
NULL
))

	)

642 
	$LBER_F
( * )

643 
bî_°rdup
 
	`LDAP_P
((

644 
LDAP_CONST
 * ));

646 
	$LBER_F
–
bî_Àn_t
 )

647 
bî_°∫Àn
 
	`LDAP_P
((

648 
LDAP_CONST
 *
s
, 
bî_Àn_t
 
Àn
 ));

650 
	$LBER_F
( * )

651 
bî_°∫dup
 
	`LDAP_P
((

652 
LDAP_CONST
 *
s
, 
bî_Àn_t
 
l
 ));

654 
	$LBER_F
–
bîvÆ
 * )

655 
bî_bvª∂a˚
 
	`LDAP_P
((

656 
bîvÆ
 *
d°
, 
LDAP_CONST
 bîvÆ *
§c
 ));

658 
	$LBER_F
( )

659 
bî_bv¨øy_‰ì
 
	`LDAP_P
(–
BîV¨øy
 
p
 ));

661 
	$LBER_F
( )

662 
bî_bv¨øy_add
 
	`LDAP_P
(–
BîV¨øy
 *
p
, 
BîVÆue
 *
bv
 ));

664 
	#bî_bvcmp
(
v1
,
v2
) \

665 ((
v1
)->
bv_Àn
 < (
v2
)->bv_len \

666 ? -1 : ((
v1
)->
bv_Àn
 > (
v2
)->bv_len \

667 ? 1 : 
	`memcmp
((
v1
)->
bv_vÆ
, (
v2
)->bv_vÆ, (v1)->
bv_Àn
Ë))

	)

672 
	$LBER_F
–* ) 
bî_î∫o_addr
 
	`LDAP_P
(());

673 
	#bî_î∫o
 (*(
bî_î∫o_addr
)())

	)

675 
	#LBER_ERROR_NONE
 0

	)

676 
	#LBER_ERROR_PARAM
 0x1

	)

677 
	#LBER_ERROR_MEMORY
 0x2

	)

679 
LDAP_END_DECL


	@/usr/include/ldap.h

26 #i‚de‡
_LDAP_H


27 
	#_LDAP_H


	)

30 
	~<lbî.h
>

33 
	~<ld≠_„©uªs.h
>

35 
	gLDAP_BEGIN_DECL


37 
	#LDAP_VERSION1
 1

	)

38 
	#LDAP_VERSION2
 2

	)

39 
	#LDAP_VERSION3
 3

	)

41 
	#LDAP_VERSION_MIN
 
LDAP_VERSION2


	)

42 
	#LDAP_VERSION
 
LDAP_VERSION2


	)

43 
	#LDAP_VERSION_MAX
 
LDAP_VERSION3


	)

51 
	#LDAP_API_VERSION
 3001

	)

52 
	#LDAP_VENDOR_NAME
 "O≥nLDAP"

	)

55 
	#LDAP_API_FEATURE_X_OPENLDAP
 
LDAP_VENDOR_VERSION


	)

57 #i‡
deföed
–
LDAP_API_FEATURE_X_OPENLDAP_REENTRANT
 ) || \

58 –
deföed
–
LDAP_THREAD_SAFE
 ) && \

59 
	$deföed
–
LDAP_API_FEATURE_X_OPENLDAP_THREAD_SAFE
 ) )

62 
	#LDAP_API_FEATURE_THREAD_SAFE
 1

	)

63 
	#LDAP_API_FEATURE_SESSION_THREAD_SAFE
 1

	)

64 
	#LDAP_API_FEATURE_OPERATION_THREAD_SAFE
 1

	)

66 #i‡
	`deföed
–
LDAP_THREAD_SAFE
 ) && \

67 
	$deföed
–
LDAP_API_FEATURE_X_OPENLDAP_THREAD_SAFE
 )

73 
	#LDAP_PORT
 389

	)

74 
	#LDAPS_PORT
 636

	)

76 
	#LDAP_ROOT_DSE
 ""

	)

77 
	#LDAP_NO_ATTRS
 "1.1"

	)

78 
	#LDAP_ALL_USER_ATTRIBUTES
 "*"

	)

79 
	#LDAP_ALL_OPERATIONAL_ATTRIBUTES
 "+"

	)

82 
	#LDAP_MAXINT
 (2147483647)

	)

91 
	#LDAP_OPT_API_INFO
 0x0000

	)

92 
	#LDAP_OPT_DESC
 0x0001

	)

93 
	#LDAP_OPT_DEREF
 0x0002

	)

94 
	#LDAP_OPT_SIZELIMIT
 0x0003

	)

95 
	#LDAP_OPT_TIMELIMIT
 0x0004

	)

97 
	#LDAP_OPT_REFERRALS
 0x0008

	)

98 
	#LDAP_OPT_RESTART
 0x0009

	)

100 
	#LDAP_OPT_PROTOCOL_VERSION
 0x0011

	)

101 
	#LDAP_OPT_SERVER_CONTROLS
 0x0012

	)

102 
	#LDAP_OPT_CLIENT_CONTROLS
 0x0013

	)

104 
	#LDAP_OPT_API_FEATURE_INFO
 0x0015

	)

106 
	#LDAP_OPT_HOST_NAME
 0x0030

	)

107 
	#LDAP_OPT_RESULT_CODE
 0x0031

	)

108 
	#LDAP_OPT_ERROR_NUMBER
 
LDAP_OPT_RESULT_CODE


	)

109 
	#LDAP_OPT_DIAGNOSTIC_MESSAGE
 0x0032

	)

110 
	#LDAP_OPT_ERROR_STRING
 
LDAP_OPT_DIAGNOSTIC_MESSAGE


	)

111 
	#LDAP_OPT_MATCHED_DN
 0x0033

	)

114 
	#LDAP_OPT_SSPI_FLAGS
 0x0092

	)

117 
	#LDAP_OPT_SIGN
 0x0095

	)

118 
	#LDAP_OPT_ENCRYPT
 0x0096

	)

119 
	#LDAP_OPT_SASL_METHOD
 0x0097

	)

121 
	#LDAP_OPT_SECURITY_CONTEXT
 0x0099

	)

126 
	#LDAP_OPT_API_EXTENSION_BASE
 0x4000

	)

130 
	#LDAP_OPT_DEBUG_LEVEL
 0x5001

	)

131 
	#LDAP_OPT_TIMEOUT
 0x5002

	)

132 
	#LDAP_OPT_REFHOPLIMIT
 0x5003

	)

133 
	#LDAP_OPT_NETWORK_TIMEOUT
 0x5005

	)

134 
	#LDAP_OPT_URI
 0x5006

	)

135 
	#LDAP_OPT_REFERRAL_URLS
 0x5007

	)

136 
	#LDAP_OPT_SOCKBUF
 0x5008

	)

137 
	#LDAP_OPT_DEFBASE
 0x5009

	)

138 
	#LDAP_OPT_CONNECT_ASYNC
 0x5010

	)

139 
	#LDAP_OPT_CONNECT_CB
 0x5011

	)

140 
	#LDAP_OPT_SESSION_REFCNT
 0x5012

	)

143 
	#LDAP_OPT_X_TLS
 0x6000

	)

144 
	#LDAP_OPT_X_TLS_CTX
 0x6001

	)

145 
	#LDAP_OPT_X_TLS_CACERTFILE
 0x6002

	)

146 
	#LDAP_OPT_X_TLS_CACERTDIR
 0x6003

	)

147 
	#LDAP_OPT_X_TLS_CERTFILE
 0x6004

	)

148 
	#LDAP_OPT_X_TLS_KEYFILE
 0x6005

	)

149 
	#LDAP_OPT_X_TLS_REQUIRE_CERT
 0x6006

	)

150 
	#LDAP_OPT_X_TLS_PROTOCOL_MIN
 0x6007

	)

151 
	#LDAP_OPT_X_TLS_CIPHER_SUITE
 0x6008

	)

152 
	#LDAP_OPT_X_TLS_RANDOM_FILE
 0x6009

	)

153 
	#LDAP_OPT_X_TLS_SSL_CTX
 0x600®

	)

154 
	#LDAP_OPT_X_TLS_CRLCHECK
 0x600b

	)

155 
	#LDAP_OPT_X_TLS_CONNECT_CB
 0x600c

	)

156 
	#LDAP_OPT_X_TLS_CONNECT_ARG
 0x600d

	)

157 
	#LDAP_OPT_X_TLS_DHFILE
 0x600e

	)

158 
	#LDAP_OPT_X_TLS_NEWCTX
 0x600f

	)

159 
	#LDAP_OPT_X_TLS_CRLFILE
 0x6010

	)

160 
	#LDAP_OPT_X_TLS_PACKAGE
 0x6011

	)

162 
	#LDAP_OPT_X_TLS_NEVER
 0

	)

163 
	#LDAP_OPT_X_TLS_HARD
 1

	)

164 
	#LDAP_OPT_X_TLS_DEMAND
 2

	)

165 
	#LDAP_OPT_X_TLS_ALLOW
 3

	)

166 
	#LDAP_OPT_X_TLS_TRY
 4

	)

168 
	#LDAP_OPT_X_TLS_CRL_NONE
 0

	)

169 
	#LDAP_OPT_X_TLS_CRL_PEER
 1

	)

170 
	#LDAP_OPT_X_TLS_CRL_ALL
 2

	)

173 
	#LDAP_OPT_X_TLS_PROTOCOL
(
maj
,
mö
Ë(((majË<< 8Ë+ (mö))

	)

174 
	#LDAP_OPT_X_TLS_PROTOCOL_SSL2
 (2 << 8)

	)

175 
	#LDAP_OPT_X_TLS_PROTOCOL_SSL3
 (3 << 8)

	)

176 
	#LDAP_OPT_X_TLS_PROTOCOL_TLS1_0
 ((3 << 8Ë+ 1)

	)

177 
	#LDAP_OPT_X_TLS_PROTOCOL_TLS1_1
 ((3 << 8Ë+ 2)

	)

178 
	#LDAP_OPT_X_TLS_PROTOCOL_TLS1_2
 ((3 << 8Ë+ 3)

	)

181 
	#LDAP_OPT_X_SASL_MECH
 0x6100

	)

182 
	#LDAP_OPT_X_SASL_REALM
 0x6101

	)

183 
	#LDAP_OPT_X_SASL_AUTHCID
 0x6102

	)

184 
	#LDAP_OPT_X_SASL_AUTHZID
 0x6103

	)

185 
	#LDAP_OPT_X_SASL_SSF
 0x6104

	)

186 
	#LDAP_OPT_X_SASL_SSF_EXTERNAL
 0x6105

	)

187 
	#LDAP_OPT_X_SASL_SECPROPS
 0x6106

	)

188 
	#LDAP_OPT_X_SASL_SSF_MIN
 0x6107

	)

189 
	#LDAP_OPT_X_SASL_SSF_MAX
 0x6108

	)

190 
	#LDAP_OPT_X_SASL_MAXBUFSIZE
 0x6109

	)

191 
	#LDAP_OPT_X_SASL_MECHLIST
 0x610®

	)

192 
	#LDAP_OPT_X_SASL_NOCANON
 0x610b

	)

193 
	#LDAP_OPT_X_SASL_USERNAME
 0x610¯

	)

194 
	#LDAP_OPT_X_SASL_GSS_CREDS
 0x610d

	)

197 
	#LDAP_OPT_X_GSSAPI_DO_NOT_FREE_CONTEXT
 0x6200

	)

198 
	#LDAP_OPT_X_GSSAPI_ALLOW_REMOTE_PRINCIPAL
 0x6201

	)

204 
	#LDAP_OPT_X_KEEPALIVE_IDLE
 0x6300

	)

205 
	#LDAP_OPT_X_KEEPALIVE_PROBES
 0x6301

	)

206 
	#LDAP_OPT_X_KEEPALIVE_INTERVAL
 0x6302

	)

209 
	#LDAP_OPT_PRIVATE_EXTENSION_BASE
 0x7000

	)

217 
	#LDAP_OPT_SUCCESS
 0

	)

218 
	#LDAP_OPT_ERROR
 (-1)

	)

221 
	#LDAP_OPT_ON
 ((*Ë&
bî_pvt_›t_⁄
)

	)

222 
	#LDAP_OPT_OFF
 ((*Ë0)

	)

224 
	sld≠≠iöfo
 {

225 
ld≠ai_öfo_vîsi⁄
;

226 
	#LDAP_API_INFO_VERSION
 (1)

	)

227 
ld≠ai_≠i_vîsi⁄
;

228 
ld≠ai_¥Ÿocﬁ_vîsi⁄
;

229 **
ld≠ai_exãnsi⁄s
;

230 *
ld≠ai_víd‹_«me
;

231 
ld≠ai_víd‹_vîsi⁄
;

232 } 
	tLDAPAPIInfo
;

234 
	sld≠_≠i„©uª_öfo
 {

235 
ld≠aif_öfo_vîsi⁄
;

236 
	#LDAP_FEATURE_INFO_VERSION
 (1Ë

	)

237 * 
ld≠aif_«me
;

238 
ld≠aif_vîsi⁄
;

239 } 
	tLDAPAPIFótuªInfo
;

244 
	sld≠c⁄åﬁ
 {

245 * 
ld˘l_oid
;

246 
bîvÆ
 
ld˘l_vÆue
;

247 
ld˘l_is¸ôiˇl
;

248 } 
	tLDAPC⁄åﬁ
;

252 
	#LDAP_CONTROL_MANAGEDSAIT
 "2.16.840.1.113730.3.4.2"

	)

253 
	#LDAP_CONTROL_PROXY_AUTHZ
 "2.16.840.1.113730.3.4.18"

	)

254 
	#LDAP_CONTROL_SUBENTRIES
 "1.3.6.1.4.1.4203.1.10.1"

	)

256 
	#LDAP_CONTROL_VALUESRETURNFILTER
 "1.2.826.0.1.3344810.2.3"

	)

258 
	#LDAP_CONTROL_ASSERT
 "1.3.6.1.1.12"

	)

259 
	#LDAP_CONTROL_PRE_READ
 "1.3.6.1.1.13.1"

	)

260 
	#LDAP_CONTROL_POST_READ
 "1.3.6.1.1.13.2"

	)

262 
	#LDAP_CONTROL_SORTREQUEST
 "1.2.840.113556.1.4.473"

	)

263 
	#LDAP_CONTROL_SORTRESPONSE
 "1.2.840.113556.1.4.474"

	)

266 
	#LDAP_CONTROL_PAGEDRESULTS
 "1.2.840.113556.1.4.319"

	)

269 
	#LDAP_SYNC_OID
 "1.3.6.1.4.1.4203.1.9.1"

	)

270 
	#LDAP_CONTROL_SYNC
 
LDAP_SYNC_OID
 ".1"

	)

271 
	#LDAP_CONTROL_SYNC_STATE
 
LDAP_SYNC_OID
 ".2"

	)

272 
	#LDAP_CONTROL_SYNC_DONE
 
LDAP_SYNC_OID
 ".3"

	)

273 
	#LDAP_SYNC_INFO
 
LDAP_SYNC_OID
 ".4"

	)

275 
	#LDAP_SYNC_NONE
 0x00

	)

276 
	#LDAP_SYNC_REFRESH_ONLY
 0x01

	)

277 
	#LDAP_SYNC_RESERVED
 0x02

	)

278 
	#LDAP_SYNC_REFRESH_AND_PERSIST
 0x03

	)

280 
	#LDAP_SYNC_REFRESH_PRESENTS
 0

	)

281 
	#LDAP_SYNC_REFRESH_DELETES
 1

	)

283 
	#LDAP_TAG_SYNC_NEW_COOKIE
 ((
bî_èg_t
Ë0x80U)

	)

284 
	#LDAP_TAG_SYNC_REFRESH_DELETE
 ((
bî_èg_t
Ë0xa1U)

	)

285 
	#LDAP_TAG_SYNC_REFRESH_PRESENT
 ((
bî_èg_t
Ë0xa2U)

	)

286 
	#LDAP_TAG_SYNC_ID_SET
 ((
bî_èg_t
Ë0xa3U)

	)

288 
	#LDAP_TAG_SYNC_COOKIE
 ((
bî_èg_t
Ë0x04U)

	)

289 
	#LDAP_TAG_REFRESHDELETES
 ((
bî_èg_t
Ë0x01U)

	)

290 
	#LDAP_TAG_REFRESHDONE
 ((
bî_èg_t
Ë0x01U)

	)

291 
	#LDAP_TAG_RELOAD_HINT
 ((
bî_èg_t
Ë0x01U)

	)

293 
	#LDAP_SYNC_PRESENT
 0

	)

294 
	#LDAP_SYNC_ADD
 1

	)

295 
	#LDAP_SYNC_MODIFY
 2

	)

296 
	#LDAP_SYNC_DELETE
 3

	)

297 
	#LDAP_SYNC_NEW_COOKIE
 4

	)

302 
	#LDAP_CONTROL_PASSWORDPOLICYREQUEST
 "1.3.6.1.4.1.42.2.27.8.5.1"

	)

303 
	#LDAP_CONTROL_PASSWORDPOLICYRESPONSE
 "1.3.6.1.4.1.42.2.27.8.5.1"

	)

306 
	#LDAP_CONTROL_NOOP
 "1.3.6.1.4.1.4203.666.5.2"

	)

307 
	#LDAP_CONTROL_NO_SUBORDINATES
 "1.3.6.1.4.1.4203.666.5.11"

	)

308 
	#LDAP_CONTROL_RELAX
 "1.3.6.1.4.1.4203.666.5.12"

	)

309 
	#LDAP_CONTROL_MANAGEDIT
 
LDAP_CONTROL_RELAX


	)

310 
	#LDAP_CONTROL_SLURP
 "1.3.6.1.4.1.4203.666.5.13"

	)

311 
	#LDAP_CONTROL_VALSORT
 "1.3.6.1.4.1.4203.666.5.14"

	)

312 
	#LDAP_CONTROL_DONTUSECOPY
 "1.3.6.1.4.1.4203.666.5.15"

	)

313 
	#LDAP_CONTROL_X_DEREF
 "1.3.6.1.4.1.4203.666.5.16"

	)

314 
	#LDAP_CONTROL_X_WHATFAILED
 "1.3.6.1.4.1.4203.666.5.17"

	)

319 
	#LDAP_CONTROL_X_CHAINING_BEHAVIOR
 "1.3.6.1.4.1.4203.666.11.3"

	)

321 
	#LDAP_CHAINING_PREFERRED
 0

	)

322 
	#LDAP_CHAINING_REQUIRED
 1

	)

323 
	#LDAP_REFERRALS_PREFERRED
 2

	)

324 
	#LDAP_REFERRALS_REQUIRED
 3

	)

327 
	#LDAP_CONTROL_X_INCREMENTAL_VALUES
 "1.2.840.113556.1.4.802"

	)

328 
	#LDAP_CONTROL_X_DOMAIN_SCOPE
 "1.2.840.113556.1.4.1339"

	)

329 
	#LDAP_CONTROL_X_PERMISSIVE_MODIFY
 "1.2.840.113556.1.4.1413"

	)

330 
	#LDAP_CONTROL_X_SEARCH_OPTIONS
 "1.2.840.113556.1.4.1340"

	)

331 
	#LDAP_SEARCH_FLAG_DOMAIN_SCOPE
 1

	)

332 
	#LDAP_SEARCH_FLAG_PHANTOM_ROOT
 2

	)

333 
	#LDAP_CONTROL_X_TREE_DELETE
 "1.2.840.113556.1.4.805"

	)

336 
	#LDAP_CONTROL_X_EXTENDED_DN
 "1.2.840.113556.1.4.529"

	)

339 
	#LDAP_CONTROL_X_SESSION_TRACKING
 "1.3.6.1.4.1.21008.108.63.1"

	)

340 
	#LDAP_CONTROL_X_SESSION_TRACKING_RADIUS_ACCT_SESSION_ID
 \

341 
LDAP_CONTROL_X_SESSION_TRACKING
 ".1"

	)

342 
	#LDAP_CONTROL_X_SESSION_TRACKING_RADIUS_ACCT_MULTI_SESSION_ID
 \

343 
LDAP_CONTROL_X_SESSION_TRACKING
 ".2"

	)

344 
	#LDAP_CONTROL_X_SESSION_TRACKING_USERNAME
 \

345 
LDAP_CONTROL_X_SESSION_TRACKING
 ".3"

	)

349 
	#LDAP_CONTROL_DUPENT_REQUEST
 "2.16.840.1.113719.1.27.101.1"

	)

350 
	#LDAP_CONTROL_DUPENT_RESPONSE
 "2.16.840.1.113719.1.27.101.2"

	)

351 
	#LDAP_CONTROL_DUPENT_ENTRY
 "2.16.840.1.113719.1.27.101.3"

	)

352 
	#LDAP_CONTROL_DUPENT
 
LDAP_CONTROL_DUPENT_REQUEST


	)

355 
	#LDAP_CONTROL_PERSIST_REQUEST
 "2.16.840.1.113730.3.4.3"

	)

356 
	#LDAP_CONTROL_PERSIST_ENTRY_CHANGE_NOTICE
 "2.16.840.1.113730.3.4.7"

	)

357 
	#LDAP_CONTROL_PERSIST_ENTRY_CHANGE_ADD
 0x1

	)

358 
	#LDAP_CONTROL_PERSIST_ENTRY_CHANGE_DELETE
 0x2

	)

359 
	#LDAP_CONTROL_PERSIST_ENTRY_CHANGE_MODIFY
 0x4

	)

360 
	#LDAP_CONTROL_PERSIST_ENTRY_CHANGE_RENAME
 0x8

	)

363 
	#LDAP_CONTROL_VLVREQUEST
 "2.16.840.1.113730.3.4.9"

	)

364 
	#LDAP_CONTROL_VLVRESPONSE
 "2.16.840.1.113730.3.4.10"

	)

367 
	#LDAP_NOTICE_OF_DISCONNECTION
 "1.3.6.1.4.1.1466.20036"

	)

368 
	#LDAP_NOTICE_DISCONNECT
 
LDAP_NOTICE_OF_DISCONNECTION


	)

371 
	#LDAP_EXOP_START_TLS
 "1.3.6.1.4.1.1466.20037"

	)

373 
	#LDAP_EXOP_MODIFY_PASSWD
 "1.3.6.1.4.1.4203.1.11.1"

	)

374 
	#LDAP_TAG_EXOP_MODIFY_PASSWD_ID
 ((
bî_èg_t
Ë0x80U)

	)

375 
	#LDAP_TAG_EXOP_MODIFY_PASSWD_OLD
 ((
bî_èg_t
Ë0x81U)

	)

376 
	#LDAP_TAG_EXOP_MODIFY_PASSWD_NEW
 ((
bî_èg_t
Ë0x82U)

	)

377 
	#LDAP_TAG_EXOP_MODIFY_PASSWD_GEN
 ((
bî_èg_t
Ë0x80U)

	)

379 
	#LDAP_EXOP_CANCEL
 "1.3.6.1.1.8"

	)

380 
	#LDAP_EXOP_X_CANCEL
 
LDAP_EXOP_CANCEL


	)

382 
	#LDAP_EXOP_REFRESH
 "1.3.6.1.4.1.1466.101.119.1"

	)

383 
	#LDAP_TAG_EXOP_REFRESH_REQ_DN
 ((
bî_èg_t
Ë0x80U)

	)

384 
	#LDAP_TAG_EXOP_REFRESH_REQ_TTL
 ((
bî_èg_t
Ë0x81U)

	)

385 
	#LDAP_TAG_EXOP_REFRESH_RES_TTL
 ((
bî_èg_t
Ë0x81U)

	)

387 
	#LDAP_EXOP_WHO_AM_I
 "1.3.6.1.4.1.4203.1.11.3"

	)

388 
	#LDAP_EXOP_X_WHO_AM_I
 
LDAP_EXOP_WHO_AM_I


	)

391 
	#LDAP_EXOP_TURN
 "1.3.6.1.1.19"

	)

392 
	#LDAP_EXOP_X_TURN
 
LDAP_EXOP_TURN


	)

396 
	#LDAP_X_DISTPROC_BASE
 "1.3.6.1.4.1.4203.666.11.6"

	)

397 
	#LDAP_EXOP_X_CHAINEDREQUEST
 
LDAP_X_DISTPROC_BASE
 ".1"

	)

398 
	#LDAP_FEATURE_X_CANCHAINOPS
 
LDAP_X_DISTPROC_BASE
 ".2"

	)

399 
	#LDAP_CONTROL_X_RETURNCONTREF
 
LDAP_X_DISTPROC_BASE
 ".3"

	)

400 
	#LDAP_URLEXT_X_LOCALREFOID
 
LDAP_X_DISTPROC_BASE
 ".4"

	)

401 
	#LDAP_URLEXT_X_REFTYPEOID
 
LDAP_X_DISTPROC_BASE
 ".5"

	)

402 
	#LDAP_URLEXT_X_SEARCHEDSUBTREEOID
 \

403 
LDAP_X_DISTPROC_BASE
 ".6"

	)

404 
	#LDAP_URLEXT_X_FAILEDNAMEOID
 
LDAP_X_DISTPROC_BASE
 ".7"

	)

405 
	#LDAP_URLEXT_X_LOCALREF
 "x-loˇlRe„ªn˚"

	)

406 
	#LDAP_URLEXT_X_REFTYPE
 "x-ª„ªn˚Ty≥"

	)

407 
	#LDAP_URLEXT_X_SEARCHEDSUBTREE
 "x-£¨chedSubåì"

	)

408 
	#LDAP_URLEXT_X_FAILEDNAME
 "x-ÁûedName"

	)

410 #ifde‡
LDAP_DEVEL


411 
	#LDAP_X_TXN
 "1.3.6.1.4.1.4203.666.11.7"

	)

412 
	#LDAP_EXOP_X_TXN_START
 
LDAP_X_TXN
 ".1"

	)

413 
	#LDAP_CONTROL_X_TXN_SPEC
 
LDAP_X_TXN
 ".2"

	)

414 
	#LDAP_EXOP_X_TXN_END
 
LDAP_X_TXN
 ".3"

	)

415 
	#LDAP_EXOP_X_TXN_ABORTED_NOTICE
 
LDAP_X_TXN
 ".4"

	)

419 
	#LDAP_FEATURE_ALL_OP_ATTRS
 "1.3.6.1.4.1.4203.1.5.1"

	)

420 
	#LDAP_FEATURE_OBJECTCLASS_ATTRS
 \

421 "1.3.6.1.4.1.4203.1.5.2"

	)

422 
	#LDAP_FEATURE_ABSOLUTE_FILTERS
 "1.3.6.1.4.1.4203.1.5.3"

	)

423 
	#LDAP_FEATURE_LANGUAGE_TAG_OPTIONS
 "1.3.6.1.4.1.4203.1.5.4"

	)

424 
	#LDAP_FEATURE_LANGUAGE_RANGE_OPTIONS
 "1.3.6.1.4.1.4203.1.5.5"

	)

425 
	#LDAP_FEATURE_MODIFY_INCREMENT
 "1.3.6.1.1.14"

	)

428 
	#LDAP_FEATURE_SUBORDINATE_SCOPE
 \

429 "1.3.6.1.4.1.4203.666.8.1"

	)

430 
	#LDAP_FEATURE_CHILDREN_SCOPE
 
LDAP_FEATURE_SUBORDINATE_SCOPE


	)

454 
	#LDAP_TAG_MESSAGE
 ((
bî_èg_t
Ë0x30UË

	)

455 
	#LDAP_TAG_MSGID
 ((
bî_èg_t
Ë0x02UË

	)

457 
	#LDAP_TAG_LDAPDN
 ((
bî_èg_t
Ë0x04UË

	)

458 
	#LDAP_TAG_LDAPCRED
 ((
bî_èg_t
Ë0x04UË

	)

460 
	#LDAP_TAG_CONTROLS
 ((
bî_èg_t
Ë0xa0UË

	)

461 
	#LDAP_TAG_REFERRAL
 ((
bî_èg_t
Ë0xa3UË

	)

463 
	#LDAP_TAG_NEWSUPERIOR
 ((
bî_èg_t
Ë0x80UË

	)

465 
	#LDAP_TAG_EXOP_REQ_OID
 ((
bî_èg_t
Ë0x80UË

	)

466 
	#LDAP_TAG_EXOP_REQ_VALUE
 ((
bî_èg_t
Ë0x81UË

	)

467 
	#LDAP_TAG_EXOP_RES_OID
 ((
bî_èg_t
Ë0x8aUË

	)

468 
	#LDAP_TAG_EXOP_RES_VALUE
 ((
bî_èg_t
Ë0x8bUË

	)

470 
	#LDAP_TAG_IM_RES_OID
 ((
bî_èg_t
Ë0x80UË

	)

471 
	#LDAP_TAG_IM_RES_VALUE
 ((
bî_èg_t
Ë0x81UË

	)

473 
	#LDAP_TAG_SASL_RES_CREDS
 ((
bî_èg_t
Ë0x87UË

	)

476 
	#LDAP_REQ_BIND
 ((
bî_èg_t
Ë0x60UË

	)

477 
	#LDAP_REQ_UNBIND
 ((
bî_èg_t
Ë0x42UË

	)

478 
	#LDAP_REQ_SEARCH
 ((
bî_èg_t
Ë0x63UË

	)

479 
	#LDAP_REQ_MODIFY
 ((
bî_èg_t
Ë0x66UË

	)

480 
	#LDAP_REQ_ADD
 ((
bî_èg_t
Ë0x68UË

	)

481 
	#LDAP_REQ_DELETE
 ((
bî_èg_t
Ë0x4aUË

	)

482 
	#LDAP_REQ_MODDN
 ((
bî_èg_t
Ë0x6cUË

	)

483 
	#LDAP_REQ_MODRDN
 
LDAP_REQ_MODDN


	)

484 
	#LDAP_REQ_RENAME
 
LDAP_REQ_MODDN


	)

485 
	#LDAP_REQ_COMPARE
 ((
bî_èg_t
Ë0x6eUË

	)

486 
	#LDAP_REQ_ABANDON
 ((
bî_èg_t
Ë0x50UË

	)

487 
	#LDAP_REQ_EXTENDED
 ((
bî_èg_t
Ë0x77UË

	)

490 
	#LDAP_RES_BIND
 ((
bî_èg_t
Ë0x61UË

	)

491 
	#LDAP_RES_SEARCH_ENTRY
 ((
bî_èg_t
Ë0x64UË

	)

492 
	#LDAP_RES_SEARCH_REFERENCE
 ((
bî_èg_t
Ë0x73UË

	)

493 
	#LDAP_RES_SEARCH_RESULT
 ((
bî_èg_t
Ë0x65UË

	)

494 
	#LDAP_RES_MODIFY
 ((
bî_èg_t
Ë0x67UË

	)

495 
	#LDAP_RES_ADD
 ((
bî_èg_t
Ë0x69UË

	)

496 
	#LDAP_RES_DELETE
 ((
bî_èg_t
Ë0x6bUË

	)

497 
	#LDAP_RES_MODDN
 ((
bî_èg_t
Ë0x6dUË

	)

498 
	#LDAP_RES_MODRDN
 
LDAP_RES_MODDN


	)

499 
	#LDAP_RES_RENAME
 
LDAP_RES_MODDN


	)

500 
	#LDAP_RES_COMPARE
 ((
bî_èg_t
Ë0x6fUË

	)

501 
	#LDAP_RES_EXTENDED
 ((
bî_èg_t
Ë0x78UË

	)

502 
	#LDAP_RES_INTERMEDIATE
 ((
bî_èg_t
Ë0x79UË

	)

504 
	#LDAP_RES_ANY
 (-1)

	)

505 
	#LDAP_RES_UNSOLICITED
 (0)

	)

509 
	#LDAP_SASL_SIMPLE
 ((*)0)

	)

510 
	#LDAP_SASL_NULL
 ("")

	)

514 
	#LDAP_AUTH_NONE
 ((
bî_èg_t
Ë0x00UË

	)

515 
	#LDAP_AUTH_SIMPLE
 ((
bî_èg_t
Ë0x80UË

	)

516 
	#LDAP_AUTH_SASL
 ((
bî_èg_t
Ë0xa3UË

	)

517 
	#LDAP_AUTH_KRBV4
 ((
bî_èg_t
Ë0xffUË

	)

518 
	#LDAP_AUTH_KRBV41
 ((
bî_èg_t
Ë0x81UË

	)

519 
	#LDAP_AUTH_KRBV42
 ((
bî_èg_t
Ë0x82UË

	)

522 
	#LDAP_AUTH_NEGOTIATE
 ((
bî_èg_t
Ë0x04FFU)

	)

525 
	#LDAP_FILTER_AND
 ((
bî_èg_t
Ë0xa0UË

	)

526 
	#LDAP_FILTER_OR
 ((
bî_èg_t
Ë0xa1UË

	)

527 
	#LDAP_FILTER_NOT
 ((
bî_èg_t
Ë0xa2UË

	)

528 
	#LDAP_FILTER_EQUALITY
 ((
bî_èg_t
Ë0xa3UË

	)

529 
	#LDAP_FILTER_SUBSTRINGS
 ((
bî_èg_t
Ë0xa4UË

	)

530 
	#LDAP_FILTER_GE
 ((
bî_èg_t
Ë0xa5UË

	)

531 
	#LDAP_FILTER_LE
 ((
bî_èg_t
Ë0xa6UË

	)

532 
	#LDAP_FILTER_PRESENT
 ((
bî_èg_t
Ë0x87UË

	)

533 
	#LDAP_FILTER_APPROX
 ((
bî_èg_t
Ë0xa8UË

	)

534 
	#LDAP_FILTER_EXT
 ((
bî_èg_t
Ë0xa9UË

	)

537 
	#LDAP_FILTER_EXT_OID
 ((
bî_èg_t
Ë0x81UË

	)

538 
	#LDAP_FILTER_EXT_TYPE
 ((
bî_èg_t
Ë0x82UË

	)

539 
	#LDAP_FILTER_EXT_VALUE
 ((
bî_èg_t
Ë0x83UË

	)

540 
	#LDAP_FILTER_EXT_DNATTRS
 ((
bî_èg_t
Ë0x84UË

	)

543 
	#LDAP_SUBSTRING_INITIAL
 ((
bî_èg_t
Ë0x80UË

	)

544 
	#LDAP_SUBSTRING_ANY
 ((
bî_èg_t
Ë0x81UË

	)

545 
	#LDAP_SUBSTRING_FINAL
 ((
bî_èg_t
Ë0x82UË

	)

548 
	#LDAP_SCOPE_BASE
 ((
bî_öt_t
Ë0x0000)

	)

549 
	#LDAP_SCOPE_BASEOBJECT
 
LDAP_SCOPE_BASE


	)

550 
	#LDAP_SCOPE_ONELEVEL
 ((
bî_öt_t
Ë0x0001)

	)

551 
	#LDAP_SCOPE_ONE
 
LDAP_SCOPE_ONELEVEL


	)

552 
	#LDAP_SCOPE_SUBTREE
 ((
bî_öt_t
Ë0x0002)

	)

553 
	#LDAP_SCOPE_SUB
 
LDAP_SCOPE_SUBTREE


	)

554 
	#LDAP_SCOPE_SUBORDINATE
 ((
bî_öt_t
Ë0x0003Ë

	)

555 
	#LDAP_SCOPE_CHILDREN
 
LDAP_SCOPE_SUBORDINATE


	)

556 
	#LDAP_SCOPE_DEFAULT
 ((
bî_öt_t
Ë-1Ë

	)

559 
	#LDAP_SUBSTRING_INITIAL
 ((
bî_èg_t
Ë0x80UË

	)

560 
	#LDAP_SUBSTRING_ANY
 ((
bî_èg_t
Ë0x81UË

	)

561 
	#LDAP_SUBSTRING_FINAL
 ((
bî_èg_t
Ë0x82UË

	)

566 
	#LDAP_SUCCESS
 0x00

	)

568 
	#LDAP_RANGE
(
n
,
x
,
y
Ë(((xË<“)Ë&& (“Ë<(y)))

	)

570 
	#LDAP_OPERATIONS_ERROR
 0x01

	)

571 
	#LDAP_PROTOCOL_ERROR
 0x02

	)

572 
	#LDAP_TIMELIMIT_EXCEEDED
 0x03

	)

573 
	#LDAP_SIZELIMIT_EXCEEDED
 0x04

	)

574 
	#LDAP_COMPARE_FALSE
 0x05

	)

575 
	#LDAP_COMPARE_TRUE
 0x06

	)

576 
	#LDAP_AUTH_METHOD_NOT_SUPPORTED
 0x07

	)

577 
	#LDAP_STRONG_AUTH_NOT_SUPPORTED
 
LDAP_AUTH_METHOD_NOT_SUPPORTED


	)

578 
	#LDAP_STRONG_AUTH_REQUIRED
 0x08

	)

579 
	#LDAP_STRONGER_AUTH_REQUIRED
 
LDAP_STRONG_AUTH_REQUIRED


	)

580 
	#LDAP_PARTIAL_RESULTS
 0x09

	)

582 
	#LDAP_REFERRAL
 0x0®

	)

583 
	#LDAP_ADMINLIMIT_EXCEEDED
 0x0b

	)

584 
	#LDAP_UNAVAILABLE_CRITICAL_EXTENSION
 0x0¯

	)

585 
	#LDAP_CONFIDENTIALITY_REQUIRED
 0x0d

	)

586 
	#LDAP_SASL_BIND_IN_PROGRESS
 0x0ê

	)

588 
	#LDAP_ATTR_ERROR
(
n
Ë
	`LDAP_RANGE
(“),0x10,0x15Ë

	)

590 
	#LDAP_NO_SUCH_ATTRIBUTE
 0x10

	)

591 
	#LDAP_UNDEFINED_TYPE
 0x11

	)

592 
	#LDAP_INAPPROPRIATE_MATCHING
 0x12

	)

593 
	#LDAP_CONSTRAINT_VIOLATION
 0x13

	)

594 
	#LDAP_TYPE_OR_VALUE_EXISTS
 0x14

	)

595 
	#LDAP_INVALID_SYNTAX
 0x15

	)

597 
	#LDAP_NAME_ERROR
(
n
Ë
	`LDAP_RANGE
(“),0x20,0x24Ë

	)

599 
	#LDAP_NO_SUCH_OBJECT
 0x20

	)

600 
	#LDAP_ALIAS_PROBLEM
 0x21

	)

601 
	#LDAP_INVALID_DN_SYNTAX
 0x22

	)

602 
	#LDAP_IS_LEAF
 0x23

	)

603 
	#LDAP_ALIAS_DEREF_PROBLEM
 0x24

	)

605 
	#LDAP_SECURITY_ERROR
(
n
Ë
	`LDAP_RANGE
(“),0x2F,0x32Ë

	)

607 
	#LDAP_X_PROXY_AUTHZ_FAILURE
 0x2F

	)

608 
	#LDAP_INAPPROPRIATE_AUTH
 0x30

	)

609 
	#LDAP_INVALID_CREDENTIALS
 0x31

	)

610 
	#LDAP_INSUFFICIENT_ACCESS
 0x32

	)

612 
	#LDAP_SERVICE_ERROR
(
n
Ë
	`LDAP_RANGE
(“),0x33,0x36Ë

	)

614 
	#LDAP_BUSY
 0x33

	)

615 
	#LDAP_UNAVAILABLE
 0x34

	)

616 
	#LDAP_UNWILLING_TO_PERFORM
 0x35

	)

617 
	#LDAP_LOOP_DETECT
 0x36

	)

619 
	#LDAP_UPDATE_ERROR
(
n
Ë
	`LDAP_RANGE
(“),0x40,0x47Ë

	)

621 
	#LDAP_NAMING_VIOLATION
 0x40

	)

622 
	#LDAP_OBJECT_CLASS_VIOLATION
 0x41

	)

623 
	#LDAP_NOT_ALLOWED_ON_NONLEAF
 0x42

	)

624 
	#LDAP_NOT_ALLOWED_ON_RDN
 0x43

	)

625 
	#LDAP_ALREADY_EXISTS
 0x44

	)

626 
	#LDAP_NO_OBJECT_CLASS_MODS
 0x45

	)

627 
	#LDAP_RESULTS_TOO_LARGE
 0x46

	)

628 
	#LDAP_AFFECTS_MULTIPLE_DSAS
 0x47

	)

630 
	#LDAP_VLV_ERROR
 0x4C

	)

632 
	#LDAP_OTHER
 0x50

	)

635 
	#LDAP_CUP_RESOURCES_EXHAUSTED
 0x71

	)

636 
	#LDAP_CUP_SECURITY_VIOLATION
 0x72

	)

637 
	#LDAP_CUP_INVALID_DATA
 0x73

	)

638 
	#LDAP_CUP_UNSUPPORTED_SCHEME
 0x74

	)

639 
	#LDAP_CUP_RELOAD_REQUIRED
 0x75

	)

642 
	#LDAP_CANCELLED
 0x76

	)

643 
	#LDAP_NO_SUCH_OPERATION
 0x77

	)

644 
	#LDAP_TOO_LATE
 0x78

	)

645 
	#LDAP_CANNOT_CANCEL
 0x79

	)

648 
	#LDAP_ASSERTION_FAILED
 0x7A

	)

651 
	#LDAP_PROXIED_AUTHORIZATION_DENIED
 0x7B

	)

654 
	#LDAP_E_ERROR
(
n
Ë
	`LDAP_RANGE
(“),0x1000,0x3FFF)

	)

657 
	#LDAP_SYNC_REFRESH_REQUIRED
 0x1000

	)

661 
	#LDAP_X_ERROR
(
n
Ë
	`LDAP_RANGE
(“),0x4000,0xFFFF)

	)

663 
	#LDAP_X_SYNC_REFRESH_REQUIRED
 0x4100

	)

664 
	#LDAP_X_ASSERTION_FAILED
 0x410‡

	)

667 
	#LDAP_X_NO_OPERATION
 0x410e

	)

671 #ifde‡
LDAP_CONTROL_X_CHAINING_BEHAVIOR


672 
	#LDAP_X_NO_REFERRALS_FOUND
 0x4110

	)

673 
	#LDAP_X_CANNOT_CHAIN
 0x4111

	)

677 #ifde‡
LDAP_X_DISTPROC_BASE


678 
	#LDAP_X_INVALIDREFERENCE
 0x4112

	)

681 #ifde‡
LDAP_X_TXN


682 
	#LDAP_X_TXN_SPECIFY_OKAY
 0x4120

	)

683 
	#LDAP_X_TXN_ID_INVALID
 0x4121

	)

691 
	#LDAP_API_ERROR
(
n
Ë(“)<0)

	)

692 
	#LDAP_API_RESULT
(
n
Ë(“)<=0)

	)

694 
	#LDAP_SERVER_DOWN
 (-1)

	)

695 
	#LDAP_LOCAL_ERROR
 (-2)

	)

696 
	#LDAP_ENCODING_ERROR
 (-3)

	)

697 
	#LDAP_DECODING_ERROR
 (-4)

	)

698 
	#LDAP_TIMEOUT
 (-5)

	)

699 
	#LDAP_AUTH_UNKNOWN
 (-6)

	)

700 
	#LDAP_FILTER_ERROR
 (-7)

	)

701 
	#LDAP_USER_CANCELLED
 (-8)

	)

702 
	#LDAP_PARAM_ERROR
 (-9)

	)

703 
	#LDAP_NO_MEMORY
 (-10)

	)

704 
	#LDAP_CONNECT_ERROR
 (-11)

	)

705 
	#LDAP_NOT_SUPPORTED
 (-12)

	)

706 
	#LDAP_CONTROL_NOT_FOUND
 (-13)

	)

707 
	#LDAP_NO_RESULTS_RETURNED
 (-14)

	)

708 
	#LDAP_MORE_RESULTS_TO_RETURN
 (-15Ë

	)

709 
	#LDAP_CLIENT_LOOP
 (-16)

	)

710 
	#LDAP_REFERRAL_LIMIT_EXCEEDED
 (-17)

	)

711 
	#LDAP_X_CONNECTING
 (-18)

	)

720 
ld≠msg
 
	tLDAPMesßge
;

723 
	sld≠mod
 {

724 
mod_›
;

726 
	#LDAP_MOD_OP
 (0x0007)

	)

727 
	#LDAP_MOD_ADD
 (0x0000)

	)

728 
	#LDAP_MOD_DELETE
 (0x0001)

	)

729 
	#LDAP_MOD_REPLACE
 (0x0002)

	)

730 
	#LDAP_MOD_INCREMENT
 (0x0003Ë

	)

731 
	#LDAP_MOD_BVALUES
 (0x0080)

	)

737 *
mod_ty≥
;

738 
	umod_vÆs_u
 {

739 **
modv_°rvÆs
;

740 
bîvÆ
 **
modv_bvÆs
;

741 } 
mod_vÆs
;

742 
	#mod_vÆues
 
mod_vÆs
.
modv_°rvÆs


	)

743 
	#mod_bvÆues
 
mod_vÆs
.
modv_bvÆs


	)

744 } 
	tLDAPMod
;

751 
ld≠
 
	tLDAP
;

753 
	#LDAP_DEREF_NEVER
 0x00

	)

754 
	#LDAP_DEREF_SEARCHING
 0x01

	)

755 
	#LDAP_DEREF_FINDING
 0x02

	)

756 
	#LDAP_DEREF_ALWAYS
 0x03

	)

758 
	#LDAP_NO_LIMIT
 0

	)

761 
	#LDAP_MSG_ONE
 0x00

	)

762 
	#LDAP_MSG_ALL
 0x01

	)

763 
	#LDAP_MSG_RECEIVED
 0x02

	)

768 
	sld≠_uæ_desc
 {

769 
ld≠_uæ_desc
 *
lud_√xt
;

770 *
lud_scheme
;

771 *
lud_ho°
;

772 
lud_p‹t
;

773 *
lud_dn
;

774 **
lud_©ås
;

775 
lud_sc›e
;

776 *
lud_fûãr
;

777 **
lud_exts
;

778 
lud_¸ô_exts
;

779 } 
	tLDAPURLDesc
;

781 
	#LDAP_URL_SUCCESS
 0x00

	)

782 
	#LDAP_URL_ERR_MEM
 0x01

	)

783 
	#LDAP_URL_ERR_PARAM
 0x02

	)

785 
	#LDAP_URL_ERR_BADSCHEME
 0x03

	)

786 
	#LDAP_URL_ERR_BADENCLOSURE
 0x04

	)

787 
	#LDAP_URL_ERR_BADURL
 0x05

	)

788 
	#LDAP_URL_ERR_BADHOST
 0x06

	)

789 
	#LDAP_URL_ERR_BADATTRS
 0x07

	)

790 
	#LDAP_URL_ERR_BADSCOPE
 0x08

	)

791 
	#LDAP_URL_ERR_BADFILTER
 0x09

	)

792 
	#LDAP_URL_ERR_BADEXTS
 0x0®

	)

798 
ld≠_sync_t
 
	tld≠_sync_t
;

802 
LDAP_SYNC_CAPI_NONE
 = -1,

804 
LDAP_SYNC_CAPI_PHASE_FLAG
 = 0x10U,

805 
LDAP_SYNC_CAPI_IDSET_FLAG
 = 0x20U,

806 
LDAP_SYNC_CAPI_DONE_FLAG
 = 0x40U,

809 
LDAP_SYNC_CAPI_PRESENT
 = 
LDAP_SYNC_PRESENT
,

810 
LDAP_SYNC_CAPI_ADD
 = 
LDAP_SYNC_ADD
,

811 
LDAP_SYNC_CAPI_MODIFY
 = 
LDAP_SYNC_MODIFY
,

812 
LDAP_SYNC_CAPI_DELETE
 = 
LDAP_SYNC_DELETE
,

815 
LDAP_SYNC_CAPI_PRESENTS
 = ( 
LDAP_SYNC_CAPI_PHASE_FLAG
 | 
LDAP_SYNC_CAPI_PRESENT
 ),

816 
LDAP_SYNC_CAPI_DELETES
 = ( 
LDAP_SYNC_CAPI_PHASE_FLAG
 | 
LDAP_SYNC_CAPI_DELETE
 ),

818 
LDAP_SYNC_CAPI_PRESENTS_IDSET
 = ( 
LDAP_SYNC_CAPI_PRESENTS
 | 
LDAP_SYNC_CAPI_IDSET_FLAG
 ),

819 
LDAP_SYNC_CAPI_DELETES_IDSET
 = ( 
LDAP_SYNC_CAPI_DELETES
 | 
LDAP_SYNC_CAPI_IDSET_FLAG
 ),

821 
LDAP_SYNC_CAPI_DONE
 = ( 
LDAP_SYNC_CAPI_DONE_FLAG
 | 
LDAP_SYNC_CAPI_PRESENTS
 )

822 } 
	tld≠_sync_ª‰esh_t
;

832 (*
	tld≠_sync_£¨ch_íåy_f
Ë
	tLDAP_P
((

833 
	tld≠_sync_t
 *
	tls
,

834 
	tLDAPMesßge
 *
	tmsg
,

835 
	tbîvÆ
 *
	tíåyUUID
,

836 
	tld≠_sync_ª‰esh_t
 
	tpha£
 ));

842 (*
	tld≠_sync_£¨ch_ª„ªn˚_f
Ë
	tLDAP_P
((

843 
	tld≠_sync_t
 *
	tls
,

844 
	tLDAPMesßge
 *
	tmsg
 ));

859 (*
	tld≠_sync_öãrmedüã_f
Ë
	tLDAP_P
((

860 
	tld≠_sync_t
 *
	tls
,

861 
	tLDAPMesßge
 *
	tmsg
,

862 
	tBîV¨øy
 
	tsyncUUIDs
,

863 
	tld≠_sync_ª‰esh_t
 
	tpha£
 ));

870 (*
	tld≠_sync_£¨ch_ªsu…_f
Ë
	tLDAP_P
((

871 
	tld≠_sync_t
 *
	tls
,

872 
	tLDAPMesßge
 *
	tmsg
,

873 
	tª‰eshDñëes
 ));

879 
	sld≠_sync_t
 {

881 *
ls_ba£
;

882 
ls_sc›e
;

883 *
ls_fûãr
;

884 **
ls_©ås
;

885 
ls_timñimô
;

886 
ls_sizñimô
;

889 
ls_timeout
;

892 
ld≠_sync_£¨ch_íåy_f
 
ls_£¨ch_íåy
;

893 
ld≠_sync_£¨ch_ª„ªn˚_f
 
ls_£¨ch_ª„ªn˚
;

894 
ld≠_sync_öãrmedüã_f
 
ls_öãrmedüã
;

895 
ld≠_sync_£¨ch_ªsu…_f
 
ls_£¨ch_ªsu…
;

898 *
ls_¥iv©e
;

901 
LDAP
 *
ls_ld
;

909 
ls_msgid
;

913 
ls_ªlﬂdHöt
;

916 
bîvÆ
 
ls_cookõ
;

919 
ld≠_sync_ª‰esh_t
 
ls_ª‰eshPha£
;

929 
ld≠_c⁄ncb
;

930 
sockaddr
;

933 (
	tld≠_c⁄n_add_f
Ë
	tLDAP_P
(–
	tLDAP
 *
	tld
, 
	tSockbuf
 *
	tsb
, 
	tLDAPURLDesc
 *
	t§v
, 
	tsockaddr
 *
	taddr
,

934 
	tld≠_c⁄ncb
 *
	t˘x
 ));

936 (
	tld≠_c⁄n_dñ_f
Ë
	tLDAP_P
(–
	tLDAP
 *
	tld
, 
	tSockbuf
 *
	tsb
, 
	tld≠_c⁄ncb
 *
	t˘x
 ));

941 
	sld≠_c⁄ncb
 {

942 
ld≠_c⁄n_add_f
 *
lc_add
;

943 
ld≠_c⁄n_dñ_f
 *
lc_dñ
;

944 *
lc_¨g
;

945 } 
	tld≠_c⁄ncb
;

951 
timevÆ
;

956 
	$LDAP_F
( )

957 
ld≠_gë_›ti⁄
 
	`LDAP_P
((

958 
LDAP
 *
ld
,

959 
›ti⁄
,

960 *
outvÆue
));

962 
	$LDAP_F
( )

963 
ld≠_£t_›ti⁄
 
	`LDAP_P
((

964 
LDAP
 *
ld
,

965 
›ti⁄
,

966 
LDAP_CONST
 *
övÆue
));

969 (
	tLDAP_REBIND_PROC
Ë
	tLDAP_P
((

970 
	tLDAP
 *
	tld
, 
	tLDAP_CONST
 *
	tuæ
,

971 
	tbî_èg_t
 
	tªque°
, 
	tbî_öt_t
 
	tmsgid
,

972 *
	t∑øms
 ));

974 
	$LDAP_F
( )

975 
ld≠_£t_ªböd_¥oc
 
	`LDAP_P
((

976 
LDAP
 *
ld
,

977 
LDAP_REBIND_PROC
 *
ªböd_¥oc
,

978 *
∑øms
 ));

981 (
	tLDAP_NEXTREF_PROC
Ë
	tLDAP_P
((

982 
	tLDAP
 *
	tld
, ***
	tªf•
, *
	t˙ç
,

983 *
	t∑øms
 ));

985 
	$LDAP_F
( )

986 
ld≠_£t_√xåef_¥oc
 
	`LDAP_P
((

987 
LDAP
 *
ld
,

988 
LDAP_NEXTREF_PROC
 *
√xåef_¥oc
,

989 *
∑øms
 ));

992 (
	tLDAP_URLLIST_PROC
Ë
	tLDAP_P
((

993 
	tLDAP
 *
	tld
,

994 
	tLDAPURLDesc
 **
	tuæli°
,

995 
	tLDAPURLDesc
 **
	tuæ
,

996 *
	t∑øms
 ));

998 
	$LDAP_F
( )

999 
ld≠_£t_uæli°_¥oc
 
	`LDAP_P
((

1000 
LDAP
 *
ld
,

1001 
LDAP_URLLIST_PROC
 *
uæli°_¥oc
,

1002 *
∑øms
 ));

1007 #i‡
LDAP_DEPRECATED


1008 
	$LDAP_F
( )

1009 
ld≠_¸óã_c⁄åﬁ
 
	`LDAP_P
((

1010 
LDAP_CONST
 *
ªque°OID
,

1011 
BîEÀmít
 *
bî
,

1012 
is¸ôiˇl
,

1013 
LDAPC⁄åﬁ
 **
˘æp
 ));

1015 
	$LDAP_F
–
LDAPC⁄åﬁ
 * )

1016 
ld≠_föd_c⁄åﬁ
 
	`LDAP_P
((

1017 
LDAP_CONST
 *
oid
,

1018 
LDAPC⁄åﬁ
 **
˘æs
 ));

1021 
	$LDAP_F
( )

1022 
ld≠_c⁄åﬁ_¸óã
 
	`LDAP_P
((

1023 
LDAP_CONST
 *
ªque°OID
,

1024 
is¸ôiˇl
,

1025 
bîvÆ
 *
vÆue
,

1026 
dupvÆ
,

1027 
LDAPC⁄åﬁ
 **
˘æp
 ));

1029 
	$LDAP_F
–
LDAPC⁄åﬁ
 * )

1030 
ld≠_c⁄åﬁ_föd
 
	`LDAP_P
((

1031 
LDAP_CONST
 *
oid
,

1032 
LDAPC⁄åﬁ
 **
˘æs
,

1033 
LDAPC⁄åﬁ
 ***
√xt˘æp
 ));

1035 
	$LDAP_F
( )

1036 
ld≠_c⁄åﬁ_‰ì
 
	`LDAP_P
((

1037 
LDAPC⁄åﬁ
 *
˘æ
 ));

1039 
	$LDAP_F
( )

1040 
ld≠_c⁄åﬁs_‰ì
 
	`LDAP_P
((

1041 
LDAPC⁄åﬁ
 **
˘æs
 ));

1043 
	$LDAP_F
–
LDAPC⁄åﬁ
 ** )

1044 
ld≠_c⁄åﬁs_dup
 
	`LDAP_P
((

1045 
LDAPC⁄åﬁ
 *
LDAP_CONST
 *
c⁄åﬁs
 ));

1047 
	$LDAP_F
–
LDAPC⁄åﬁ
 * )

1048 
ld≠_c⁄åﬁ_dup
 
	`LDAP_P
((

1049 
LDAP_CONST
 
LDAPC⁄åﬁ
 *
c
 ));

1054 
	$LDAP_F
( )

1055 
ld≠_domaö2dn
 
	`LDAP_P
((

1056 
LDAP_CONST
 * 
domaö
,

1057 ** 
dn
 ));

1059 
	$LDAP_F
( )

1060 
ld≠_dn2domaö
 
	`LDAP_P
((

1061 
LDAP_CONST
 * 
dn
,

1062 ** 
domaö
 ));

1064 
	$LDAP_F
( )

1065 
ld≠_domaö2ho°li°
 
	`LDAP_P
((

1066 
LDAP_CONST
 *
domaö
,

1067 ** 
ho°li°
 ));

1072 
	$LDAP_F
( )

1073 
ld≠_exãnded_›î©i⁄
 
	`LDAP_P
((

1074 
LDAP
 *
ld
,

1075 
LDAP_CONST
 *
ªqoid
,

1076 
bîvÆ
 *
ªqd©a
,

1077 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1078 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1079 *
msgidp
 ));

1081 
	$LDAP_F
( )

1082 
ld≠_exãnded_›î©i⁄_s
 
	`LDAP_P
((

1083 
LDAP
 *
ld
,

1084 
LDAP_CONST
 *
ªqoid
,

1085 
bîvÆ
 *
ªqd©a
,

1086 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1087 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1088 **
ªtoidp
,

1089 
bîvÆ
 **
ªtd©≠
 ));

1091 
	$LDAP_F
( )

1092 
ld≠_∑r£_exãnded_ªsu…
 
	`LDAP_P
((

1093 
LDAP
 *
ld
,

1094 
LDAPMesßge
 *
ªs
,

1095 **
ªtoidp
,

1096 
bîvÆ
 **
ªtd©≠
,

1097 
‰ìô
 ));

1099 
	$LDAP_F
( )

1100 
ld≠_∑r£_öãrmedüã
 
	`LDAP_P
((

1101 
LDAP
 *
ld
,

1102 
LDAPMesßge
 *
ªs
,

1103 **
ªtoidp
,

1104 
bîvÆ
 **
ªtd©≠
,

1105 
LDAPC⁄åﬁ
 ***
£rvî˘æs
,

1106 
‰ìô
 ));

1112 
	$LDAP_F
( )

1113 
ld≠_ab™d⁄_ext
 
	`LDAP_P
((

1114 
LDAP
 *
ld
,

1115 
msgid
,

1116 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1117 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
 ));

1119 #i‡
LDAP_DEPRECATED


1120 
	$LDAP_F
( )

1121 
ld≠_ab™d⁄
 
	`LDAP_P
((

1122 
LDAP
 *
ld
,

1123 
msgid
 ));

1129 
	$LDAP_F
( )

1130 
ld≠_add_ext
 
	`LDAP_P
((

1131 
LDAP
 *
ld
,

1132 
LDAP_CONST
 *
dn
,

1133 
LDAPMod
 **
©ås
,

1134 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1135 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1136 *
msgidp
 ));

1138 
	$LDAP_F
( )

1139 
ld≠_add_ext_s
 
	`LDAP_P
((

1140 
LDAP
 *
ld
,

1141 
LDAP_CONST
 *
dn
,

1142 
LDAPMod
 **
©ås
,

1143 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1144 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
 ));

1146 #i‡
LDAP_DEPRECATED


1147 
	$LDAP_F
( )

1148 
ld≠_add
 
	`LDAP_P
((

1149 
LDAP
 *
ld
,

1150 
LDAP_CONST
 *
dn
,

1151 
LDAPMod
 **
©ås
 ));

1153 
	$LDAP_F
( )

1154 
ld≠_add_s
 
	`LDAP_P
((

1155 
LDAP
 *
ld
,

1156 
LDAP_CONST
 *
dn
,

1157 
LDAPMod
 **
©ås
 ));

1164 
	$LDAP_F
( )

1165 
ld≠_ß¶_böd
 
	`LDAP_P
((

1166 
LDAP
 *
ld
,

1167 
LDAP_CONST
 *
dn
,

1168 
LDAP_CONST
 *
mech™ism
,

1169 
bîvÆ
 *
¸ed
,

1170 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1171 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1172 *
msgidp
 ));

1179 
	#LDAP_SASL_AUTOMATIC
 0U

	)

1180 
	#LDAP_SASL_INTERACTIVE
 1U

	)

1181 
	#LDAP_SASL_QUIET
 2U

	)

1188 (
	tLDAP_SASL_INTERACT_PROC
Ë
	tLDAP_P
((

1189 
	tLDAP
 *
	tld
, 
	tÊags
, * 
	tdeÁu…s
, *
	töãø˘
 ));

1191 
	$LDAP_F
( )

1192 
ld≠_ß¶_öãø˘ive_böd
 
	`LDAP_P
((

1193 
LDAP
 *
ld
,

1194 
LDAP_CONST
 *
dn
,

1195 
LDAP_CONST
 *
ß¶Mech™ism
,

1196 
LDAPC⁄åﬁ
 **
£rvîC⁄åﬁs
,

1197 
LDAPC⁄åﬁ
 **
˛õ¡C⁄åﬁs
,

1200 
Êags
,

1201 
LDAP_SASL_INTERACT_PROC
 *
¥oc
,

1202 *
deÁu…s
,

1205 
LDAPMesßge
 *
ªsu…
,

1208 c⁄° **
rmech
,

1209 *
msgid
 ));

1211 
	$LDAP_F
( )

1212 
ld≠_ß¶_öãø˘ive_böd_s
 
	`LDAP_P
((

1213 
LDAP
 *
ld
,

1214 
LDAP_CONST
 *
dn
,

1215 
LDAP_CONST
 *
ß¶Mech™ism
,

1216 
LDAPC⁄åﬁ
 **
£rvîC⁄åﬁs
,

1217 
LDAPC⁄åﬁ
 **
˛õ¡C⁄åﬁs
,

1220 
Êags
,

1221 
LDAP_SASL_INTERACT_PROC
 *
¥oc
,

1222 *
deÁu…s
 ));

1224 
	$LDAP_F
( )

1225 
ld≠_ß¶_böd_s
 
	`LDAP_P
((

1226 
LDAP
 *
ld
,

1227 
LDAP_CONST
 *
dn
,

1228 
LDAP_CONST
 *
mech™ism
,

1229 
bîvÆ
 *
¸ed
,

1230 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1231 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1232 
bîvÆ
 **
£rvî¸edp
 ));

1234 
	$LDAP_F
( )

1235 
ld≠_∑r£_ß¶_böd_ªsu…
 
	`LDAP_P
((

1236 
LDAP
 *
ld
,

1237 
LDAPMesßge
 *
ªs
,

1238 
bîvÆ
 **
£rvî¸edp
,

1239 
‰ìô
 ));

1244 
	$LDAP_F
( )

1245 
ld≠_gsßpi_böd_s
 
	`LDAP_P
((

1246 
LDAP
 *
ld
,

1247 
LDAP_CONST
 *
dn
,

1248 
LDAP_CONST
 *
¸eds
));

1251 #i‡
LDAP_DEPRECATED


1256 
	$LDAP_F
( )

1257 
ld≠_böd
 
	`LDAP_P
((

1258 
LDAP
 *
ld
,

1259 
LDAP_CONST
 *
who
,

1260 
LDAP_CONST
 *
∑sswd
,

1261 
authmëhod
 ));

1263 
	$LDAP_F
( )

1264 
ld≠_böd_s
 
	`LDAP_P
((

1265 
LDAP
 *
ld
,

1266 
LDAP_CONST
 *
who
,

1267 
LDAP_CONST
 *
¸ed
,

1268 
authmëhod
 ));

1273 
	$LDAP_F
( )

1274 
ld≠_sim∂e_böd
 
	`LDAP_P
((

1275 
LDAP
 *
ld
,

1276 
LDAP_CONST
 *
who
,

1277 
LDAP_CONST
 *
∑sswd
 ));

1279 
	$LDAP_F
( )

1280 
ld≠_sim∂e_böd_s
 
	`LDAP_P
((

1281 
LDAP
 *
ld
,

1282 
LDAP_CONST
 *
who
,

1283 
LDAP_CONST
 *
∑sswd
 ));

1291 
	$LDAP_F
( )

1292 
ld≠_com∑ª_ext
 
	`LDAP_P
((

1293 
LDAP
 *
ld
,

1294 
LDAP_CONST
 *
dn
,

1295 
LDAP_CONST
 *
©å
,

1296 
bîvÆ
 *
bvÆue
,

1297 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1298 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1299 *
msgidp
 ));

1301 
	$LDAP_F
( )

1302 
ld≠_com∑ª_ext_s
 
	`LDAP_P
((

1303 
LDAP
 *
ld
,

1304 
LDAP_CONST
 *
dn
,

1305 
LDAP_CONST
 *
©å
,

1306 
bîvÆ
 *
bvÆue
,

1307 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1308 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
 ));

1310 #i‡
LDAP_DEPRECATED


1311 
	$LDAP_F
( )

1312 
ld≠_com∑ª
 
	`LDAP_P
((

1313 
LDAP
 *
ld
,

1314 
LDAP_CONST
 *
dn
,

1315 
LDAP_CONST
 *
©å
,

1316 
LDAP_CONST
 *
vÆue
 ));

1318 
	$LDAP_F
( )

1319 
ld≠_com∑ª_s
 
	`LDAP_P
((

1320 
LDAP
 *
ld
,

1321 
LDAP_CONST
 *
dn
,

1322 
LDAP_CONST
 *
©å
,

1323 
LDAP_CONST
 *
vÆue
 ));

1330 
	$LDAP_F
( )

1331 
ld≠_dñëe_ext
 
	`LDAP_P
((

1332 
LDAP
 *
ld
,

1333 
LDAP_CONST
 *
dn
,

1334 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1335 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1336 *
msgidp
 ));

1338 
	$LDAP_F
( )

1339 
ld≠_dñëe_ext_s
 
	`LDAP_P
((

1340 
LDAP
 *
ld
,

1341 
LDAP_CONST
 *
dn
,

1342 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1343 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
 ));

1345 #i‡
LDAP_DEPRECATED


1346 
	$LDAP_F
( )

1347 
ld≠_dñëe
 
	`LDAP_P
((

1348 
LDAP
 *
ld
,

1349 
LDAP_CONST
 *
dn
 ));

1351 
	$LDAP_F
( )

1352 
ld≠_dñëe_s
 
	`LDAP_P
((

1353 
LDAP
 *
ld
,

1354 
LDAP_CONST
 *
dn
 ));

1361 
	$LDAP_F
( )

1362 
ld≠_∑r£_ªsu…
 
	`LDAP_P
((

1363 
LDAP
 *
ld
,

1364 
LDAPMesßge
 *
ªs
,

1365 *
îrcodï
,

1366 **
m©chedd≈
,

1367 **
îrmsgp
,

1368 ***
ª„ºÆ•
,

1369 
LDAPC⁄åﬁ
 ***
£rvî˘æs
,

1370 
‰ìô
 ));

1372 
	$LDAP_F
( * )

1373 
ld≠_îr2°rög
 
	`LDAP_P
((

1374 
îr
 ));

1376 #i‡
LDAP_DEPRECATED


1377 
	$LDAP_F
( )

1378 
ld≠_ªsu…2îr‹
 
	`LDAP_P
((

1379 
LDAP
 *
ld
,

1380 
LDAPMesßge
 *
r
,

1381 
‰ìô
 ));

1383 
	$LDAP_F
( )

1384 
ld≠_≥º‹
 
	`LDAP_P
((

1385 
LDAP
 *
ld
,

1386 
LDAP_CONST
 *
s
 ));

1393 
	$LDAP_F
( )

1394 
ld≠_gsßpi_böd
 
	`LDAP_P
((

1395 
LDAP
 *
ld
,

1396 
LDAP_CONST
 *
dn
,

1397 
LDAP_CONST
 *
¸eds
 ));

1399 
	$LDAP_F
( )

1400 
ld≠_gsßpi_böd_s
 
	`LDAP_P
((

1401 
LDAP
 *
ld
,

1402 
LDAP_CONST
 *
dn
,

1403 
LDAP_CONST
 *
¸eds
 ));

1409 
	$LDAP_F
( )

1410 
ld≠_modify_ext
 
	`LDAP_P
((

1411 
LDAP
 *
ld
,

1412 
LDAP_CONST
 *
dn
,

1413 
LDAPMod
 **
mods
,

1414 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1415 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1416 *
msgidp
 ));

1418 
	$LDAP_F
( )

1419 
ld≠_modify_ext_s
 
	`LDAP_P
((

1420 
LDAP
 *
ld
,

1421 
LDAP_CONST
 *
dn
,

1422 
LDAPMod
 **
mods
,

1423 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1424 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
 ));

1426 #i‡
LDAP_DEPRECATED


1427 
	$LDAP_F
( )

1428 
ld≠_modify
 
	`LDAP_P
((

1429 
LDAP
 *
ld
,

1430 
LDAP_CONST
 *
dn
,

1431 
LDAPMod
 **
mods
 ));

1433 
	$LDAP_F
( )

1434 
ld≠_modify_s
 
	`LDAP_P
((

1435 
LDAP
 *
ld
,

1436 
LDAP_CONST
 *
dn
,

1437 
LDAPMod
 **
mods
 ));

1444 
	$LDAP_F
( )

1445 
ld≠_ª«me
 
	`LDAP_P
((

1446 
LDAP
 *
ld
,

1447 
LDAP_CONST
 *
dn
,

1448 
LDAP_CONST
 *
√wrdn
,

1449 
LDAP_CONST
 *
√wSu≥ri‹
,

1450 
dñëeﬁdrdn
,

1451 
LDAPC⁄åﬁ
 **
s˘æs
,

1452 
LDAPC⁄åﬁ
 **
c˘æs
,

1453 *
msgidp
 ));

1455 
	$LDAP_F
( )

1456 
ld≠_ª«me_s
 
	`LDAP_P
((

1457 
LDAP
 *
ld
,

1458 
LDAP_CONST
 *
dn
,

1459 
LDAP_CONST
 *
√wrdn
,

1460 
LDAP_CONST
 *
√wSu≥ri‹
,

1461 
dñëeﬁdrdn
,

1462 
LDAPC⁄åﬁ
 **
s˘æs
,

1463 
LDAPC⁄åﬁ
 **
c˘æs
 ));

1465 #i‡
LDAP_DEPRECATED


1466 
	$LDAP_F
( )

1467 
ld≠_ª«me2
 
	`LDAP_P
((

1468 
LDAP
 *
ld
,

1469 
LDAP_CONST
 *
dn
,

1470 
LDAP_CONST
 *
√wrdn
,

1471 
LDAP_CONST
 *
√wSu≥ri‹
,

1472 
dñëeﬁdrdn
 ));

1474 
	$LDAP_F
( )

1475 
ld≠_ª«me2_s
 
	`LDAP_P
((

1476 
LDAP
 *
ld
,

1477 
LDAP_CONST
 *
dn
,

1478 
LDAP_CONST
 *
√wrdn
,

1479 
LDAP_CONST
 *
√wSu≥ri‹
,

1480 
dñëeﬁdrdn
 ));

1482 
	$LDAP_F
( )

1483 
ld≠_modrdn
 
	`LDAP_P
((

1484 
LDAP
 *
ld
,

1485 
LDAP_CONST
 *
dn
,

1486 
LDAP_CONST
 *
√wrdn
 ));

1488 
	$LDAP_F
( )

1489 
ld≠_modrdn_s
 
	`LDAP_P
((

1490 
LDAP
 *
ld
,

1491 
LDAP_CONST
 *
dn
,

1492 
LDAP_CONST
 *
√wrdn
 ));

1494 
	$LDAP_F
( )

1495 
ld≠_modrdn2
 
	`LDAP_P
((

1496 
LDAP
 *
ld
,

1497 
LDAP_CONST
 *
dn
,

1498 
LDAP_CONST
 *
√wrdn
,

1499 
dñëeﬁdrdn
 ));

1501 
	$LDAP_F
( )

1502 
ld≠_modrdn2_s
 
	`LDAP_P
((

1503 
LDAP
 *
ld
,

1504 
LDAP_CONST
 *
dn
,

1505 
LDAP_CONST
 *
√wrdn
,

1506 
dñëeﬁdrdn
));

1513 #i‡
LDAP_DEPRECATED


1514 
	$LDAP_F
–
LDAP
 * )

1515 
ld≠_öô
 
	`LDAP_P
((

1516 
LDAP_CONST
 *
ho°
,

1517 
p‹t
 ));

1519 
	$LDAP_F
–
LDAP
 * )

1520 
ld≠_›í
 
	`LDAP_P
((

1521 
LDAP_CONST
 *
ho°
,

1522 
p‹t
 ));

1525 
	$LDAP_F
( )

1526 
ld≠_¸óã
 
	`LDAP_P
((

1527 
LDAP
 **
ldp
 ));

1529 
	$LDAP_F
( )

1530 
ld≠_öôülize
 
	`LDAP_P
((

1531 
LDAP
 **
ldp
,

1532 
LDAP_CONST
 *
uæ
 ));

1534 
	$LDAP_F
–
LDAP
 * )

1535 
ld≠_dup
 
	`LDAP_P
((

1536 
LDAP
 *
ﬁd
 ));

1542 
	$LDAP_F
( )

1543 
ld≠_és_ö∂a˚
 
	`LDAP_P
((

1544 
LDAP
 *
ld
 ));

1546 
	$LDAP_F
( )

1547 
ld≠_°¨t_és
 
	`LDAP_P
((

1548 
LDAP
 *
ld
,

1549 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1550 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1551 *
msgidp
 ));

1553 
	$LDAP_F
( )

1554 
ld≠_ö°Æl_és
 
	`LDAP_P
((

1555 
LDAP
 *
ld
 ));

1557 
	$LDAP_F
( )

1558 
ld≠_°¨t_és_s
 
	`LDAP_P
((

1559 
LDAP
 *
ld
,

1560 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1561 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
 ));

1566 
	$LDAP_F
–
LDAPMesßge
 * )

1567 
ld≠_fú°_mesßge
 
	`LDAP_P
((

1568 
LDAP
 *
ld
,

1569 
LDAPMesßge
 *
chaö
 ));

1571 
	$LDAP_F
–
LDAPMesßge
 * )

1572 
ld≠_√xt_mesßge
 
	`LDAP_P
((

1573 
LDAP
 *
ld
,

1574 
LDAPMesßge
 *
msg
 ));

1576 
	$LDAP_F
( )

1577 
ld≠_cou¡_mesßges
 
	`LDAP_P
((

1578 
LDAP
 *
ld
,

1579 
LDAPMesßge
 *
chaö
 ));

1584 
	$LDAP_F
–
LDAPMesßge
 * )

1585 
ld≠_fú°_ª„ªn˚
 
	`LDAP_P
((

1586 
LDAP
 *
ld
,

1587 
LDAPMesßge
 *
chaö
 ));

1589 
	$LDAP_F
–
LDAPMesßge
 * )

1590 
ld≠_√xt_ª„ªn˚
 
	`LDAP_P
((

1591 
LDAP
 *
ld
,

1592 
LDAPMesßge
 *
ªf
 ));

1594 
	$LDAP_F
( )

1595 
ld≠_cou¡_ª„ªn˚s
 
	`LDAP_P
((

1596 
LDAP
 *
ld
,

1597 
LDAPMesßge
 *
chaö
 ));

1599 
	$LDAP_F
( )

1600 
ld≠_∑r£_ª„ªn˚
 
	`LDAP_P
((

1601 
LDAP
 *
ld
,

1602 
LDAPMesßge
 *
ªf
,

1603 ***
ª„ºÆ•
,

1604 
LDAPC⁄åﬁ
 ***
£rvî˘æs
,

1605 
‰ìô
));

1611 
	$LDAP_F
–
LDAPMesßge
 * )

1612 
ld≠_fú°_íåy
 
	`LDAP_P
((

1613 
LDAP
 *
ld
,

1614 
LDAPMesßge
 *
chaö
 ));

1616 
	$LDAP_F
–
LDAPMesßge
 * )

1617 
ld≠_√xt_íåy
 
	`LDAP_P
((

1618 
LDAP
 *
ld
,

1619 
LDAPMesßge
 *
íåy
 ));

1621 
	$LDAP_F
( )

1622 
ld≠_cou¡_íåõs
 
	`LDAP_P
((

1623 
LDAP
 *
ld
,

1624 
LDAPMesßge
 *
chaö
 ));

1626 
	$LDAP_F
( )

1627 
ld≠_gë_íåy_c⁄åﬁs
 
	`LDAP_P
((

1628 
LDAP
 *
ld
,

1629 
LDAPMesßge
 *
íåy
,

1630 
LDAPC⁄åﬁ
 ***
£rvî˘æs
));

1636 
	$LDAP_F
–
LDAPMesßge
 * )

1637 
ld≠_dñëe_ªsu…_íåy
 
	`LDAP_P
((

1638 
LDAPMesßge
 **
li°
,

1639 
LDAPMesßge
 *
e
 ));

1641 
	$LDAP_F
( )

1642 
ld≠_add_ªsu…_íåy
 
	`LDAP_P
((

1643 
LDAPMesßge
 **
li°
,

1644 
LDAPMesßge
 *
e
 ));

1650 
	$LDAP_F
( * )

1651 
ld≠_gë_dn
 
	`LDAP_P
((

1652 
LDAP
 *
ld
,

1653 
LDAPMesßge
 *
íåy
 ));

1655 
	sld≠_ava
 {

1656 
bîvÆ
 
œ_©å
;

1657 
bîvÆ
 
œ_vÆue
;

1658 
œ_Êags
;

1659 
	#LDAP_AVA_NULL
 0x0000U

	)

1660 
	#LDAP_AVA_STRING
 0x0001U

	)

1661 
	#LDAP_AVA_BINARY
 0x0002U

	)

1662 
	#LDAP_AVA_NONPRINTABLE
 0x0004U

	)

1663 
	#LDAP_AVA_FREE_ATTR
 0x0010U

	)

1664 
	#LDAP_AVA_FREE_VALUE
 0x0020U

	)

1666 *
œ_¥iv©e
;

1667 } 
	tLDAPAVA
;

1669 
LDAPAVA
** 
	tLDAPRDN
;

1670 
LDAPRDN
* 
	tLDAPDN
;

1673 
	#LDAP_DN_FORMAT_LDAP
 0x0000U

	)

1674 
	#LDAP_DN_FORMAT_LDAPV3
 0x0010U

	)

1675 
	#LDAP_DN_FORMAT_LDAPV2
 0x0020U

	)

1676 
	#LDAP_DN_FORMAT_DCE
 0x0030U

	)

1677 
	#LDAP_DN_FORMAT_UFN
 0x0040U

	)

1678 
	#LDAP_DN_FORMAT_AD_CANONICAL
 0x0050U

	)

1679 
	#LDAP_DN_FORMAT_LBER
 0x00F0U

	)

1680 
	#LDAP_DN_FORMAT_MASK
 0x00F0U

	)

1683 
	#LDAP_DN_PRETTY
 0x0100U

	)

1684 
	#LDAP_DN_SKIP
 0x0200U

	)

1685 
	#LDAP_DN_P_NOLEADTRAILSPACES
 0x1000U

	)

1686 
	#LDAP_DN_P_NOSPACEAFTERRDN
 0x2000U

	)

1687 
	#LDAP_DN_PEDANTIC
 0xF000U

	)

1689 
	$LDAP_F
–Ë
ld≠_rdn‰ì
 
	`LDAP_P
(–
LDAPRDN
 
rdn
 ));

1690 
	$LDAP_F
–Ë
ld≠_dn‰ì
 
	`LDAP_P
(–
LDAPDN
 
dn
 ));

1692 
	$LDAP_F
( )

1693 
ld≠_bv2dn
 
	`LDAP_P
((

1694 
bîvÆ
 *
bv
,

1695 
LDAPDN
 *
dn
,

1696 
Êags
 ));

1698 
	$LDAP_F
( )

1699 
ld≠_°r2dn
 
	`LDAP_P
((

1700 
LDAP_CONST
 *
°r
,

1701 
LDAPDN
 *
dn
,

1702 
Êags
 ));

1704 
	$LDAP_F
( )

1705 
ld≠_dn2bv
 
	`LDAP_P
((

1706 
LDAPDN
 
dn
,

1707 
bîvÆ
 *
bv
,

1708 
Êags
 ));

1710 
	$LDAP_F
( )

1711 
ld≠_dn2°r
 
	`LDAP_P
((

1712 
LDAPDN
 
dn
,

1713 **
°r
,

1714 
Êags
 ));

1716 
	$LDAP_F
( )

1717 
ld≠_bv2rdn
 
	`LDAP_P
((

1718 
bîvÆ
 *
bv
,

1719 
LDAPRDN
 *
rdn
,

1720 **
√xt
,

1721 
Êags
 ));

1723 
	$LDAP_F
( )

1724 
ld≠_°r2rdn
 
	`LDAP_P
((

1725 
LDAP_CONST
 *
°r
,

1726 
LDAPRDN
 *
rdn
,

1727 **
√xt
,

1728 
Êags
 ));

1730 
	$LDAP_F
( )

1731 
ld≠_rdn2bv
 
	`LDAP_P
((

1732 
LDAPRDN
 
rdn
,

1733 
bîvÆ
 *
bv
,

1734 
Êags
 ));

1736 
	$LDAP_F
( )

1737 
ld≠_rdn2°r
 
	`LDAP_P
((

1738 
LDAPRDN
 
rdn
,

1739 **
°r
,

1740 
Êags
 ));

1742 
	$LDAP_F
( )

1743 
ld≠_dn_n‹mÆize
 
	`LDAP_P
((

1744 
LDAP_CONST
 *
ö
, 
iÊags
,

1745 **
out
, 
oÊags
 ));

1747 
	$LDAP_F
( * )

1748 
ld≠_dn2u‚
 
	`LDAP_P
((

1749 
LDAP_CONST
 *
dn
 ));

1751 
	$LDAP_F
( ** )

1752 
ld≠_ex∂ode_dn
 
	`LDAP_P
((

1753 
LDAP_CONST
 *
dn
,

1754 
nŸy≥s
 ));

1756 
	$LDAP_F
( ** )

1757 
ld≠_ex∂ode_rdn
 
	`LDAP_P
((

1758 
LDAP_CONST
 *
rdn
,

1759 
nŸy≥s
 ));

1761 
	tLDAPDN_ªwrôe_func


1762 
	tLDAP_P
(–
	tLDAPDN
 
	tdn
, 
	tÊags
, *
	t˘x
 ));

1764 
	$LDAP_F
( )

1765 
ld≠_X509dn2bv
 
	`LDAP_P
(–*
x509_«me
, 
bîvÆ
 *
dn
,

1766 
LDAPDN_ªwrôe_func
 *
func
, 
Êags
 ));

1768 
	$LDAP_F
( * )

1769 
ld≠_dn2d˚dn
 
	`LDAP_P
((

1770 
LDAP_CONST
 *
dn
 ));

1772 
	$LDAP_F
( * )

1773 
ld≠_d˚dn2dn
 
	`LDAP_P
((

1774 
LDAP_CONST
 *
d˚
 ));

1776 
	$LDAP_F
( * )

1777 
ld≠_dn2ad_ˇn⁄iˇl
 
	`LDAP_P
((

1778 
LDAP_CONST
 *
dn
 ));

1780 
	$LDAP_F
( )

1781 
ld≠_gë_dn_bî
 
	`LDAP_P
((

1782 
LDAP
 *
ld
, 
LDAPMesßge
 *
e
, 
BîEÀmít
 **
bîout
, 
bîvÆ
 *
dn
 ));

1784 
	$LDAP_F
( )

1785 
ld≠_gë_©åibuã_bî
 
	`LDAP_P
((

1786 
LDAP
 *
ld
, 
LDAPMesßge
 *
e
, 
BîEÀmít
 *
bî
, 
bîvÆ
 *
©å
,

1787 
bîvÆ
 **
vÆs
 ));

1792 
	$LDAP_F
( * )

1793 
ld≠_fú°_©åibuã
 
	`LDAP_P
((

1794 
LDAP
 *
ld
,

1795 
LDAPMesßge
 *
íåy
,

1796 
BîEÀmít
 **
bî
 ));

1798 
	$LDAP_F
( * )

1799 
ld≠_√xt_©åibuã
 
	`LDAP_P
((

1800 
LDAP
 *
ld
,

1801 
LDAPMesßge
 *
íåy
,

1802 
BîEÀmít
 *
bî
 ));

1808 
	$LDAP_F
–
bîvÆ
 ** )

1809 
ld≠_gë_vÆues_Àn
 
	`LDAP_P
((

1810 
LDAP
 *
ld
,

1811 
LDAPMesßge
 *
íåy
,

1812 
LDAP_CONST
 *
èrgë
 ));

1814 
	$LDAP_F
( )

1815 
ld≠_cou¡_vÆues_Àn
 
	`LDAP_P
((

1816 
bîvÆ
 **
vÆs
 ));

1818 
	$LDAP_F
( )

1819 
ld≠_vÆue_‰ì_Àn
 
	`LDAP_P
((

1820 
bîvÆ
 **
vÆs
 ));

1822 #i‡
LDAP_DEPRECATED


1823 
	$LDAP_F
( ** )

1824 
ld≠_gë_vÆues
 
	`LDAP_P
((

1825 
LDAP
 *
ld
,

1826 
LDAPMesßge
 *
íåy
,

1827 
LDAP_CONST
 *
èrgë
 ));

1829 
	$LDAP_F
( )

1830 
ld≠_cou¡_vÆues
 
	`LDAP_P
((

1831 **
vÆs
 ));

1833 
	$LDAP_F
( )

1834 
ld≠_vÆue_‰ì
 
	`LDAP_P
((

1835 **
vÆs
 ));

1841 
	$LDAP_F
( )

1842 
ld≠_ªsu…
 
	`LDAP_P
((

1843 
LDAP
 *
ld
,

1844 
msgid
,

1845 
Æl
,

1846 
timevÆ
 *
timeout
,

1847 
LDAPMesßge
 **
ªsu…
 ));

1849 
	$LDAP_F
( )

1850 
ld≠_msgty≥
 
	`LDAP_P
((

1851 
LDAPMesßge
 *
lm
 ));

1853 
	$LDAP_F
( )

1854 
ld≠_msgid
 
	`LDAP_P
((

1855 
LDAPMesßge
 *
lm
 ));

1857 
	$LDAP_F
( )

1858 
ld≠_msg‰ì
 
	`LDAP_P
((

1859 
LDAPMesßge
 *
lm
 ));

1861 
	$LDAP_F
( )

1862 
ld≠_msgdñëe
 
	`LDAP_P
((

1863 
LDAP
 *
ld
,

1864 
msgid
 ));

1870 
	$LDAP_F
( )

1871 
ld≠_bv2esˇ≥d_fûãr_vÆue
 
	`LDAP_P
((

1872 
bîvÆ
 *
ö
,

1873 
bîvÆ
 *
out
 ));

1875 
	$LDAP_F
( )

1876 
ld≠_£¨ch_ext
 
	`LDAP_P
((

1877 
LDAP
 *
ld
,

1878 
LDAP_CONST
 *
ba£
,

1879 
sc›e
,

1880 
LDAP_CONST
 *
fûãr
,

1881 **
©ås
,

1882 
©ås⁄ly
,

1883 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1884 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1885 
timevÆ
 *
timeout
,

1886 
sizñimô
,

1887 *
msgidp
 ));

1889 
	$LDAP_F
( )

1890 
ld≠_£¨ch_ext_s
 
	`LDAP_P
((

1891 
LDAP
 *
ld
,

1892 
LDAP_CONST
 *
ba£
,

1893 
sc›e
,

1894 
LDAP_CONST
 *
fûãr
,

1895 **
©ås
,

1896 
©ås⁄ly
,

1897 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1898 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
,

1899 
timevÆ
 *
timeout
,

1900 
sizñimô
,

1901 
LDAPMesßge
 **
ªs
 ));

1903 #i‡
LDAP_DEPRECATED


1904 
	$LDAP_F
( )

1905 
ld≠_£¨ch
 
	`LDAP_P
((

1906 
LDAP
 *
ld
,

1907 
LDAP_CONST
 *
ba£
,

1908 
sc›e
,

1909 
LDAP_CONST
 *
fûãr
,

1910 **
©ås
,

1911 
©ås⁄ly
 ));

1913 
	$LDAP_F
( )

1914 
ld≠_£¨ch_s
 
	`LDAP_P
((

1915 
LDAP
 *
ld
,

1916 
LDAP_CONST
 *
ba£
,

1917 
sc›e
,

1918 
LDAP_CONST
 *
fûãr
,

1919 **
©ås
,

1920 
©ås⁄ly
,

1921 
LDAPMesßge
 **
ªs
 ));

1923 
	$LDAP_F
( )

1924 
ld≠_£¨ch_°
 
	`LDAP_P
((

1925 
LDAP
 *
ld
,

1926 
LDAP_CONST
 *
ba£
,

1927 
sc›e
,

1928 
LDAP_CONST
 *
fûãr
,

1929 **
©ås
,

1930 
©ås⁄ly
,

1931 
timevÆ
 *
timeout
,

1932 
LDAPMesßge
 **
ªs
 ));

1938 
	$LDAP_F
( )

1939 
ld≠_unböd_ext
 
	`LDAP_P
((

1940 
LDAP
 *
ld
,

1941 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1942 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
));

1944 
	$LDAP_F
( )

1945 
ld≠_unböd_ext_s
 
	`LDAP_P
((

1946 
LDAP
 *
ld
,

1947 
LDAPC⁄åﬁ
 **
£rvî˘æs
,

1948 
LDAPC⁄åﬁ
 **
˛õ¡˘æs
));

1950 
	$LDAP_F
( )

1951 
ld≠_de°roy
 
	`LDAP_P
((

1952 
LDAP
 *
ld
));

1954 #i‡
LDAP_DEPRECATED


1955 
	$LDAP_F
( )

1956 
ld≠_unböd
 
	`LDAP_P
((

1957 
LDAP
 *
ld
 ));

1959 
	$LDAP_F
( )

1960 
ld≠_unböd_s
 
	`LDAP_P
((

1961 
LDAP
 *
ld
 ));

1967 
	$LDAP_F
( )

1968 
ld≠_put_vrFûãr
 
	`LDAP_P
((

1969 
BîEÀmít
 *
bî
,

1970 c⁄° *
vrf
 ));

1976 
	$LDAP_F
( * )

1977 
ld≠_memÆloc
 
	`LDAP_P
((

1978 
bî_Àn_t
 
s
 ));

1980 
	$LDAP_F
( * )

1981 
ld≠_memªÆloc
 
	`LDAP_P
((

1982 * 
p
,

1983 
bî_Àn_t
 
s
 ));

1985 
	$LDAP_F
( * )

1986 
ld≠_memˇŒoc
 
	`LDAP_P
((

1987 
bî_Àn_t
 
n
,

1988 
bî_Àn_t
 
s
 ));

1990 
	$LDAP_F
( )

1991 
ld≠_mem‰ì
 
	`LDAP_P
((

1992 * 
p
 ));

1994 
	$LDAP_F
( )

1995 
ld≠_memv‰ì
 
	`LDAP_P
((

1996 ** 
v
 ));

1998 
	$LDAP_F
( * )

1999 
ld≠_°rdup
 
	`LDAP_P
((

2000 
LDAP_CONST
 * ));

2002 
	$LDAP_F
( )

2003 
ld≠_mods_‰ì
 
	`LDAP_P
((

2004 
LDAPMod
 **
mods
,

2005 
‰ìmods
 ));

2008 #i‡
LDAP_DEPRECATED


2012 (
	tLDAP_SORT_AD_CMP_PROC
Ë
	tLDAP_P
((

2013 
	tLDAP_CONST
 *
	tÀ·
,

2014 
	tLDAP_CONST
 *
	tright
 ));

2016 (
	tLDAP_SORT_AV_CMP_PROC
Ë
	tLDAP_P
((

2017 
	tLDAP_CONST
 *
	tÀ·
,

2018 
	tLDAP_CONST
 *
	tright
 ));

2020 
	$LDAP_F
( )

2021 
ld≠_s‹t_íåõs
 
	`LDAP_P
(–
LDAP
 *
ld
,

2022 
LDAPMesßge
 **
chaö
,

2023 
LDAP_CONST
 *
©å
,

2024 
LDAP_SORT_AD_CMP_PROC
 *
cmp
 ));

2026 
	$LDAP_F
( )

2027 
ld≠_s‹t_vÆues
 
	`LDAP_P
((

2028 
LDAP
 *
ld
,

2029 **
vÆs
,

2030 
LDAP_SORT_AV_CMP_PROC
 *
cmp
 ));

2032 
	$LDAP_F
( )

2033 
ld≠_s‹t_°rˇ£cmp
 
	`LDAP_P
((

2034 
LDAP_CONST
 *
a
,

2035 
LDAP_CONST
 *
b
 ));

2041 
	$LDAP_F
( )

2042 
ld≠_is_ld≠_uæ
 
	`LDAP_P
((

2043 
LDAP_CONST
 *
uæ
 ));

2045 
	$LDAP_F
( )

2046 
ld≠_is_ld≠s_uæ
 
	`LDAP_P
((

2047 
LDAP_CONST
 *
uæ
 ));

2049 
	$LDAP_F
( )

2050 
ld≠_is_ld≠i_uæ
 
	`LDAP_P
((

2051 
LDAP_CONST
 *
uæ
 ));

2053 
	$LDAP_F
( )

2054 
ld≠_uæ_∑r£
 
	`LDAP_P
((

2055 
LDAP_CONST
 *
uæ
,

2056 
LDAPURLDesc
 **
ludµ
 ));

2058 
	$LDAP_F
( * )

2059 
ld≠_uæ_desc2°r
 
	`LDAP_P
((

2060 
LDAPURLDesc
 *
ludp
 ));

2062 
	$LDAP_F
( )

2063 
ld≠_‰ì_uædesc
 
	`LDAP_P
((

2064 
LDAPURLDesc
 *
ludp
 ));

2071 
	#LDAP_API_FEATURE_CANCEL
 1000

	)

2073 
	$LDAP_F
( )

2074 
ld≠_ˇn˚l
 
	`LDAP_P
(–
LDAP
 *
ld
,

2075 
ˇn˚lid
,

2076 
LDAPC⁄åﬁ
 **
s˘æs
,

2077 
LDAPC⁄åﬁ
 **
c˘æs
,

2078 *
msgidp
 ));

2080 
	$LDAP_F
( )

2081 
ld≠_ˇn˚l_s
 
	`LDAP_P
(–
LDAP
 *
ld
,

2082 
ˇn˚lid
,

2083 
LDAPC⁄åﬁ
 **
s˘æ
,

2084 
LDAPC⁄åﬁ
 **
c˘æ
 ));

2090 
	#LDAP_API_FEATURE_TURN
 1000

	)

2092 
	$LDAP_F
( )

2093 
ld≠_tu∫
 
	`LDAP_P
(–
LDAP
 *
ld
,

2094 
mutuÆ
,

2095 
LDAP_CONST
 * 
idítifõr
,

2096 
LDAPC⁄åﬁ
 **
s˘æs
,

2097 
LDAPC⁄åﬁ
 **
c˘æs
,

2098 *
msgidp
 ));

2100 
	$LDAP_F
( )

2101 
ld≠_tu∫_s
 
	`LDAP_P
(–
LDAP
 *
ld
,

2102 
mutuÆ
,

2103 
LDAP_CONST
 * 
idítifõr
,

2104 
LDAPC⁄åﬁ
 **
s˘æ
,

2105 
LDAPC⁄åﬁ
 **
c˘æ
 ));

2111 
	#LDAP_API_FEATURE_PAGED_RESULTS
 2000

	)

2113 
	$LDAP_F
( )

2114 
ld≠_¸óã_∑ge_c⁄åﬁ_vÆue
 
	`LDAP_P
((

2115 
LDAP
 *
ld
,

2116 
bî_öt_t
 
∑gesize
,

2117 
bîvÆ
 *
cookõ
,

2118 
bîvÆ
 *
vÆue
 ));

2120 
	$LDAP_F
( )

2121 
ld≠_¸óã_∑ge_c⁄åﬁ
 
	`LDAP_P
((

2122 
LDAP
 *
ld
,

2123 
bî_öt_t
 
∑gesize
,

2124 
bîvÆ
 *
cookõ
,

2125 
is¸ôiˇl
,

2126 
LDAPC⁄åﬁ
 **
˘æp
 ));

2128 #i‡
LDAP_DEPRECATED


2129 
	$LDAP_F
( )

2130 
ld≠_∑r£_∑ge_c⁄åﬁ
 
	`LDAP_P
((

2132 
LDAP
 *
ld
,

2133 
LDAPC⁄åﬁ
 **
˘æs
,

2134 
bî_öt_t
 *
cou¡
,

2135 
bîvÆ
 **
cookõ
 ));

2138 
	$LDAP_F
( )

2139 
ld≠_∑r£_∑gîe•⁄£_c⁄åﬁ
 
	`LDAP_P
((

2140 
LDAP
 *
ld
,

2141 
LDAPC⁄åﬁ
 *
˘æ
,

2142 
bî_öt_t
 *
cou¡
,

2143 
bîvÆ
 *
cookõ
 ));

2149 
	#LDAP_API_FEATURE_SERVER_SIDE_SORT
 2000

	)

2152 
	sld≠s‹tkey
 {

2153 *
©åibuãTy≥
;

2154 *
‹dîögRuÀ
;

2155 
ªvî£Ordî
;

2156 } 
	tLDAPS‹tKey
;

2158 
	$LDAP_F
( )

2159 
ld≠_¸óã_s‹t_keyli°
 
	`LDAP_P
((

2160 
LDAPS‹tKey
 ***
s‹tKeyLi°
,

2161 *
keySåög
 ));

2163 
	$LDAP_F
( )

2164 
ld≠_‰ì_s‹t_keyli°
 
	`LDAP_P
((

2165 
LDAPS‹tKey
 **
s‹tkeyli°
 ));

2167 
	$LDAP_F
( )

2168 
ld≠_¸óã_s‹t_c⁄åﬁ_vÆue
 
	`LDAP_P
((

2169 
LDAP
 *
ld
,

2170 
LDAPS‹tKey
 **
keyLi°
,

2171 
bîvÆ
 *
vÆue
 ));

2173 
	$LDAP_F
( )

2174 
ld≠_¸óã_s‹t_c⁄åﬁ
 
	`LDAP_P
((

2175 
LDAP
 *
ld
,

2176 
LDAPS‹tKey
 **
keyLi°
,

2177 
is¸ôiˇl
,

2178 
LDAPC⁄åﬁ
 **
˘æp
 ));

2180 
	$LDAP_F
( )

2181 
ld≠_∑r£_s‹åe•⁄£_c⁄åﬁ
 
	`LDAP_P
((

2182 
LDAP
 *
ld
,

2183 
LDAPC⁄åﬁ
 *
˘æ
,

2184 
bî_öt_t
 *
ªsu…
,

2185 **
©åibuã
 ));

2191 
	#LDAP_API_FEATURE_VIRTUAL_LIST_VIEW
 2000

	)

2194 
	sld≠vlvöfo
 {

2195 
bî_öt_t
 
ldvlv_vîsi⁄
;

2196 
bî_öt_t
 
ldvlv_bef‹e_cou¡
;

2197 
bî_öt_t
 
ldvlv_a·î_cou¡
;

2198 
bî_öt_t
 
ldvlv_off£t
;

2199 
bî_öt_t
 
ldvlv_cou¡
;

2200 
bîvÆ
 * 
ldvlv_©åvÆue
;

2201 
bîvÆ
 * 
ldvlv_c⁄ãxt
;

2202 * 
ldvlv_exåad©a
;

2203 } 
	tLDAPVLVInfo
;

2205 
	$LDAP_F
( )

2206 
ld≠_¸óã_vlv_c⁄åﬁ_vÆue
 
	`LDAP_P
((

2207 
LDAP
 *
ld
,

2208 
LDAPVLVInfo
 *
ldvli°p
,

2209 
bîvÆ
 *
vÆue
));

2211 
	$LDAP_F
( )

2212 
ld≠_¸óã_vlv_c⁄åﬁ
 
	`LDAP_P
((

2213 
LDAP
 *
ld
,

2214 
LDAPVLVInfo
 *
ldvli°p
,

2215 
LDAPC⁄åﬁ
 **
˘æp
 ));

2217 
	$LDAP_F
( )

2218 
ld≠_∑r£_vlvª•⁄£_c⁄åﬁ
 
	`LDAP_P
((

2219 
LDAP
 *
ld
,

2220 
LDAPC⁄åﬁ
 *
˘æs
,

2221 
bî_öt_t
 *
èrgë_po•
,

2222 
bî_öt_t
 *
li°_cou¡p
,

2223 
bîvÆ
 **
c⁄ãxç
,

2224 *
îrcodï
 ));

2230 
	#LDAP_API_FEATURE_WHOAMI
 1000

	)

2232 
	$LDAP_F
( )

2233 
ld≠_∑r£_whﬂmi
 
	`LDAP_P
((

2234 
LDAP
 *
ld
,

2235 
LDAPMesßge
 *
ªs
,

2236 
bîvÆ
 **
authzid
 ));

2238 
	$LDAP_F
( )

2239 
ld≠_whﬂmi
 
	`LDAP_P
(–
LDAP
 *
ld
,

2240 
LDAPC⁄åﬁ
 **
s˘æs
,

2241 
LDAPC⁄åﬁ
 **
c˘æs
,

2242 *
msgidp
 ));

2244 
	$LDAP_F
( )

2245 
ld≠_whﬂmi_s
 
	`LDAP_P
((

2246 
LDAP
 *
ld
,

2247 
bîvÆ
 **
authzid
,

2248 
LDAPC⁄åﬁ
 **
s˘æs
,

2249 
LDAPC⁄åﬁ
 **
c˘æs
 ));

2255 
	#LDAP_API_FEATURE_PASSWD_MODIFY
 1000

	)

2257 
	$LDAP_F
( )

2258 
ld≠_∑r£_∑sswd
 
	`LDAP_P
((

2259 
LDAP
 *
ld
,

2260 
LDAPMesßge
 *
ªs
,

2261 
bîvÆ
 *
√w∑sswd
 ));

2263 
	$LDAP_F
( )

2264 
ld≠_∑sswd
 
	`LDAP_P
(–
LDAP
 *
ld
,

2265 
bîvÆ
 *
u£r
,

2266 
bîvÆ
 *
ﬁdpw
,

2267 
bîvÆ
 *
√wpw
,

2268 
LDAPC⁄åﬁ
 **
s˘æs
,

2269 
LDAPC⁄åﬁ
 **
c˘æs
,

2270 *
msgidp
 ));

2272 
	$LDAP_F
( )

2273 
ld≠_∑sswd_s
 
	`LDAP_P
((

2274 
LDAP
 *
ld
,

2275 
bîvÆ
 *
u£r
,

2276 
bîvÆ
 *
ﬁdpw
,

2277 
bîvÆ
 *
√wpw
,

2278 
bîvÆ
 *
√w∑sswd
,

2279 
LDAPC⁄åﬁ
 **
s˘æs
,

2280 
LDAPC⁄åﬁ
 **
c˘æs
 ));

2282 #ifde‡
LDAP_CONTROL_PASSWORDPOLICYREQUEST


2287 
	#LDAP_API_FEATURE_PASSWORD_POLICY
 1000

	)

2289 
	e∑s•ﬁicyîr‹_íum
 {

2290 
PP_∑ssw‹dExpúed
 = 0,

2291 
PP_accou¡Locked
 = 1,

2292 
PP_ch™geA·îRe£t
 = 2,

2293 
PP_∑ssw‹dModNŸAŒowed
 = 3,

2294 
PP_mu°SuµlyOldPassw‹d
 = 4,

2295 
PP_ösufficõ¡Passw‹dQuÆôy
 = 5,

2296 
PP_∑ssw‹dTooSh‹t
 = 6,

2297 
PP_∑ssw‹dTooYoung
 = 7,

2298 
PP_∑ssw‹dInHi°‹y
 = 8,

2299 
PP_noEº‹
 = 65535

2300 } 
	tLDAPPassw‹dPﬁicyEº‹
;

2302 
	$LDAP_F
( )

2303 
ld≠_¸óã_∑ssw‹dpﬁicy_c⁄åﬁ
 
	`LDAP_P
((

2304 
LDAP
 *
ld
,

2305 
LDAPC⁄åﬁ
 **
˘æp
 ));

2307 
	$LDAP_F
( )

2308 
ld≠_∑r£_∑ssw‹dpﬁicy_c⁄åﬁ
 
	`LDAP_P
((

2309 
LDAP
 *
ld
,

2310 
LDAPC⁄åﬁ
 *
˘æ
,

2311 
bî_öt_t
 *
expúï
,

2312 
bî_öt_t
 *
gø˚p
,

2313 
LDAPPassw‹dPﬁicyEº‹
 *
îr‹p
 ));

2315 
	$LDAP_F
( const * )

2316 
ld≠_∑ssw‹dpﬁicy_îr2txt
 
	`LDAP_P
(–
LDAPPassw‹dPﬁicyEº‹
 ));

2323 
	#LDAP_API_FEATURE_REFRESH
 1000

	)

2325 
	$LDAP_F
( )

2326 
ld≠_∑r£_ª‰esh
 
	`LDAP_P
((

2327 
LDAP
 *
ld
,

2328 
LDAPMesßge
 *
ªs
,

2329 
bî_öt_t
 *
√wâl
 ));

2331 
	$LDAP_F
( )

2332 
ld≠_ª‰esh
 
	`LDAP_P
(–
LDAP
 *
ld
,

2333 
bîvÆ
 *
dn
,

2334 
bî_öt_t
 
âl
,

2335 
LDAPC⁄åﬁ
 **
s˘æs
,

2336 
LDAPC⁄åﬁ
 **
c˘æs
,

2337 *
msgidp
 ));

2339 
	$LDAP_F
( )

2340 
ld≠_ª‰esh_s
 
	`LDAP_P
((

2341 
LDAP
 *
ld
,

2342 
bîvÆ
 *
dn
,

2343 
bî_öt_t
 
âl
,

2344 
bî_öt_t
 *
√wâl
,

2345 
LDAPC⁄åﬁ
 **
s˘æs
,

2346 
LDAPC⁄åﬁ
 **
c˘æs
 ));

2351 #ifde‡
LDAP_X_TXN


2352 
	$LDAP_F
( )

2353 
ld≠_txn_°¨t
 
	`LDAP_P
(–
LDAP
 *
ld
,

2354 
LDAPC⁄åﬁ
 **
s˘æs
,

2355 
LDAPC⁄åﬁ
 **
c˘æs
,

2356 *
msgidp
 ));

2358 
	$LDAP_F
( )

2359 
ld≠_txn_°¨t_s
 
	`LDAP_P
(–
LDAP
 *
ld
,

2360 
LDAPC⁄åﬁ
 **
s˘æ
,

2361 
LDAPC⁄åﬁ
 **
c˘æ
,

2362 
bîvÆ
 **
ªâxnid
 ));

2364 
	$LDAP_F
( )

2365 
ld≠_txn_íd
 
	`LDAP_P
(–
LDAP
 *
ld
,

2366 
commô
,

2367 
bîvÆ
 *
txnid
,

2368 
LDAPC⁄åﬁ
 **
s˘æs
,

2369 
LDAPC⁄åﬁ
 **
c˘æs
,

2370 *
msgidp
 ));

2372 
	$LDAP_F
( )

2373 
ld≠_txn_íd_s
 
	`LDAP_P
(–
LDAP
 *
ld
,

2374 
commô
,

2375 
bîvÆ
 *
txnid
,

2376 
LDAPC⁄åﬁ
 **
s˘æ
,

2377 
LDAPC⁄åﬁ
 **
c˘æ
,

2378 *
ªtidp
 ));

2388 
	$LDAP_F
–
ld≠_sync_t
 * )

2389 
ld≠_sync_öôülize
 
	`LDAP_P
((

2390 
ld≠_sync_t
 *
ls
 ));

2395 
	$LDAP_F
( )

2396 
ld≠_sync_de°roy
 
	`LDAP_P
((

2397 
ld≠_sync_t
 *
ls
,

2398 
‰ìô
 ));

2403 
	$LDAP_F
( )

2404 
ld≠_sync_öô
 
	`LDAP_P
((

2405 
ld≠_sync_t
 *
ls
,

2406 
mode
 ));

2411 
	$LDAP_F
( )

2412 
ld≠_sync_öô_ª‰esh_⁄ly
 
	`LDAP_P
((

2413 
ld≠_sync_t
 *
ls
 ));

2418 
	$LDAP_F
( )

2419 
ld≠_sync_öô_ª‰esh_™d_≥rsi°
 
	`LDAP_P
((

2420 
ld≠_sync_t
 *
ls
 ));

2425 
	$LDAP_F
( )

2426 
ld≠_sync_pﬁl
 
	`LDAP_P
((

2427 
ld≠_sync_t
 *
ls
 ));

2429 #ifde‡
LDAP_CONTROL_X_SESSION_TRACKING


2434 
	$LDAP_F
( )

2435 
ld≠_¸óã_£ssi⁄_åackög_vÆue
 
	`LDAP_P
((

2436 
LDAP
 *
ld
,

2437 *
£ssi⁄Sour˚Ip
,

2438 *
£ssi⁄Sour˚Name
,

2439 *
f‹m©OID
,

2440 
bîvÆ
 *
£ssi⁄TøckögIdítifõr
,

2441 
bîvÆ
 *
vÆue
 ));

2443 
	$LDAP_F
( )

2444 
ld≠_¸óã_£ssi⁄_åackög
 
	`LDAP_P
((

2445 
LDAP
 *
ld
,

2446 *
£ssi⁄Sour˚Ip
,

2447 *
£ssi⁄Sour˚Name
,

2448 *
f‹m©OID
,

2449 
bîvÆ
 *
£ssi⁄TøckögIdítifõr
,

2450 
LDAPC⁄åﬁ
 **
˘æp
 ));

2452 
	$LDAP_F
( )

2453 
ld≠_∑r£_£ssi⁄_åackög_c⁄åﬁ
 
	`LDAP_P
((

2454 
LDAP
 *
ld
,

2455 
LDAPC⁄åﬁ
 *
˘æ
,

2456 
bîvÆ
 *
ù
,

2457 
bîvÆ
 *
«me
,

2458 
bîvÆ
 *
oid
,

2459 
bîvÆ
 *
id
 ));

2466 
	$LDAP_F
 ()

2467 
ld≠_¸óã_as£πi⁄_c⁄åﬁ_vÆue
 
	`LDAP_P
((

2468 
LDAP
 *
ld
,

2469 *
as£πi⁄
,

2470 
bîvÆ
 *
vÆue
 ));

2472 
	$LDAP_F
( )

2473 
ld≠_¸óã_as£πi⁄_c⁄åﬁ
 
	`LDAP_P
((

2474 
LDAP
 *
ld
,

2475 *
fûãr
,

2476 
is¸ôiˇl
,

2477 
LDAPC⁄åﬁ
 **
˘æp
 ));

2483 
	sLDAPDîefS≥c
 {

2484 *
dîefAâr
;

2485 **
©åibuãs
;

2486 } 
	tLDAPDîefS≥c
;

2488 
	sLDAPDîefVÆ
 {

2489 *
ty≥
;

2490 
BîV¨øy
 
vÆs
;

2491 
LDAPDîefVÆ
 *
√xt
;

2492 } 
	tLDAPDîefVÆ
;

2494 
	sLDAPDîefRes
 {

2495 *
dîefAâr
;

2496 
bîvÆ
 
dîefVÆ
;

2497 
LDAPDîefVÆ
 *
©åVÆs
;

2498 
LDAPDîefRes
 *
√xt
;

2499 } 
	tLDAPDîefRes
;

2501 
	$LDAP_F
( )

2502 
ld≠_¸óã_dîef_c⁄åﬁ_vÆue
 
	`LDAP_P
((

2503 
LDAP
 *
ld
,

2504 
LDAPDîefS≥c
 *
ds
,

2505 
bîvÆ
 *
vÆue
 ));

2507 
	$LDAP_F
( )

2508 
ld≠_¸óã_dîef_c⁄åﬁ
 
	`LDAP_P
((

2509 
LDAP
 *
ld
,

2510 
LDAPDîefS≥c
 *
ds
,

2511 
is¸ôiˇl
,

2512 
LDAPC⁄åﬁ
 **
˘æp
 ));

2514 
	$LDAP_F
( )

2515 
ld≠_dîe‰e•⁄£_‰ì
 
	`LDAP_P
((

2516 
LDAPDîefRes
 *
dr
 ));

2518 
	$LDAP_F
( )

2519 
ld≠_∑r£_dîe‰e•⁄£_c⁄åﬁ
 
	`LDAP_P
((

2520 
LDAP
 *
ld
,

2521 
LDAPC⁄åﬁ
 *
˘æ
,

2522 
LDAPDîefRes
 **
dΩ
 ));

2524 
	$LDAP_F
( )

2525 
ld≠_∑r£_dîef_c⁄åﬁ
 
	`LDAP_P
((

2526 
LDAP
 *
ld
,

2527 
LDAPC⁄åﬁ
 **
˘æs
,

2528 
LDAPDîefRes
 **
dΩ
 ));

2533 
	#LDAP_AUTH_NTLM_REQUEST
 ((
bî_èg_t
Ë0x8aU)

	)

2534 
	#LDAP_AUTH_NTLM_RESPONSE
 ((
bî_èg_t
Ë0x8bU)

	)

2535 
	$LDAP_F
( )

2536 
ld≠_¡lm_böd
 
	`LDAP_P
((

2537 
LDAP
 *
ld
,

2538 
LDAP_CONST
 *
dn
,

2539 
bî_èg_t
 
èg
,

2540 
bîvÆ
 *
¸ed
,

2541 
LDAPC⁄åﬁ
 **
s˘æs
,

2542 
LDAPC⁄åﬁ
 **
c˘æs
,

2543 *
msgidp
 ));

2544 
	$LDAP_F
( )

2545 
ld≠_∑r£_¡lm_böd_ªsu…
 
	`LDAP_P
((

2546 
LDAP
 *
ld
,

2547 
LDAPMesßge
 *
ªs
,

2548 
bîvÆ
 *
chÆÀnge
));

2550 
LDAP_END_DECL


	@/usr/include/limits.h

22 #i‚de‡
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<„©uªs.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

41 #i‚de‡
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<bôs/w‹dsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifde‡
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #i‡
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #i‡
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifde‡
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #i‡
deföed
 
__GNUC__
 && !deföed 
_GCC_LIMITS_H_


123 #ö˛ude_√xà<
limôs
.
h
>

129 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__


130 #i‚de‡
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #i‚de‡
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #i‚de‡
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<bôs/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<bôs/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<bôs/x›í_lim.h
>

	@/usr/include/math.h

23 #i‚def 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


32 
	~<bôs/huge_vÆ.h
>

33 #ifde‡
__USE_ISOC99


34 
	~<bôs/huge_vÆf.h
>

35 
	~<bôs/huge_vÆl.h
>

38 
	~<bôs/öf.h
>

41 
	~<bôs/«n.h
>

45 
	~<bôs/m©hdef.h
>

52 
	#__MATHCALL
(
fun˘i⁄
,
suffix
, 
¨gs
) \

53 
	`__MATHDECL
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
)

	)

54 
	#__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

55 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
); \

56 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
)

	)

57 
	#__MATHCALLX
(
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

58 
	`__MATHDECLX
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
)

	)

59 
	#__MATHDECLX
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

60 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
); \

61 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
)

	)

62 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

63 
ty≥
 
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
Ë
¨gs
 
__THROW


	)

65 
	#_MdoubÀ_
 

	)

66 
	#__MATH_PRECNAME
(
«me
,
r
Ë
	`__CONCAT
“ame,r)

	)

67 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

68 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

69 
	~<bôs/m©hˇŒs.h
>

70 #unde‡
_MdoubÀ_


71 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


72 #unde‡
_MdoubÀ_END_NAMESPACE


73 #unde‡
__MATH_PRECNAME


75 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


81 #i‚de‡
_MÊﬂt_


82 
	#_MÊﬂt_
 

	)

84 
	#_MdoubÀ_
 
_MÊﬂt_


	)

85 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f
##
	)
r

86 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<bôs/m©hˇŒs.h
>

89 #unde‡
_MdoubÀ_


90 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


91 #unde‡
_MdoubÀ_END_NAMESPACE


92 #unde‡
__MATH_PRECNAME


94 #i‡!(
deföed
 
__NO_LONG_DOUBLE_MATH
 && deföed 
_LIBC
) \

95 || 
deföed
 
__LDBL_COMPAT


96 #ifde‡
__LDBL_COMPAT


98 #ifde‡
__USE_ISOC99


99 
	$__∆dbl_√xâow¨df
 (
__x
, 
__y
)

100 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

101 #ifde‡
__REDIRECT_NTH


102 
	`__REDIRECT_NTH
 (
√xâow¨df
, (
__x
, 
__y
),

103 
__∆dbl_√xâow¨df
)

104 
	`__©åibuã__
 ((
__c⁄°__
));

105 
	`__REDIRECT_NTH
 (
√xâow¨d
, (
__x
, 
__y
),

106 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

107 
	`__REDIRECT_NTH
 (
√xâow¨dl
,

108 (
__x
, 
__y
),

109 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

113 #unde‡
__MATHDECL_1


114 
	#__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
Æüs
) \

115 
ty≥
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
), \

116 
¨gs
, 
Æüs
)

	)

117 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

118 
	`__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
	`__CONCAT
(fun˘i⁄,suffix))

	)

124 #i‚de‡
_Ml⁄g_doubÀ_


125 
	#_Ml⁄g_doubÀ_
 

	)

127 
	#_MdoubÀ_
 
_Ml⁄g_doubÀ_


	)

128 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
l
##
	)
r

129 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

130 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

131 
	#__MATH_DECLARE_LDOUBLE
 1

	)

132 
	~<bôs/m©hˇŒs.h
>

133 #unde‡
_MdoubÀ_


134 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


135 #unde‡
_MdoubÀ_END_NAMESPACE


136 #unde‡
__MATH_PRECNAME


141 #unde‡
__MATHDECL_1


142 #unde‡
__MATHDECL


143 #unde‡
__MATHCALL


146 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


148 
signgam
;

153 #ifde‡
__USE_ISOC99


191 
FP_NAN
 =

192 
	#FP_NAN
 0

	)

193 
FP_NAN
,

194 
FP_INFINITE
 =

195 
	#FP_INFINITE
 1

	)

196 
FP_INFINITE
,

197 
FP_ZERO
 =

198 
	#FP_ZERO
 2

	)

199 
FP_ZERO
,

200 
FP_SUBNORMAL
 =

201 
	#FP_SUBNORMAL
 3

	)

202 
FP_SUBNORMAL
,

203 
FP_NORMAL
 =

204 
	#FP_NORMAL
 4

	)

205 
FP_NORMAL


209 #ifde‡
__NO_LONG_DOUBLE_MATH


210 
	#Â˛assify
(
x
) \

211 ( (
x
Ë= (Ë? 
	`__Â˛assifyf
 (xË: 
	`__Â˛assify
 (x))

	)

213 
	#Â˛assify
(
x
) \

214 ( (
x
) ==  () \

215 ? 
	`__Â˛assifyf
 (
x
) \

216 :  (
x
) ==  () \

217 ? 
	`__Â˛assify
 (
x
Ë: 
	`__Â˛assifyl
 (x))

	)

221 #ifde‡
__NO_LONG_DOUBLE_MATH


222 
	#signbô
(
x
) \

223 ( (
x
Ë= (Ë? 
	`__signbôf
 (xË: 
	`__signbô
 (x))

	)

225 
	#signbô
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__signbôf
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__signbô
 (
x
Ë: 
	`__signbôl
 (x))

	)

233 #ifde‡
__NO_LONG_DOUBLE_MATH


234 
	#isföôe
(
x
) \

235 ( (
x
Ë= (Ë? 
	`__föôef
 (xË: 
	`__föôe
 (x))

	)

237 
	#isföôe
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__föôef
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__föôe
 (
x
Ë: 
	`__föôñ
 (x))

	)

245 
	#i¢‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_NORMAL
)

	)

249 #ifde‡
__NO_LONG_DOUBLE_MATH


250 
	#i¢™
(
x
) \

251 ( (
x
Ë= (Ë? 
	`__i¢™f
 (xË: 
	`__i¢™
 (x))

	)

253 
	#i¢™
(
x
) \

254 ( (
x
) ==  () \

255 ? 
	`__i¢™f
 (
x
) \

256 :  (
x
) ==  () \

257 ? 
	`__i¢™
 (
x
Ë: 
	`__i¢™l
 (x))

	)

261 #ifde‡
__NO_LONG_DOUBLE_MATH


262 
	#isöf
(
x
) \

263 ( (
x
Ë= (Ë? 
	`__isöff
 (xË: 
	`__isöf
 (x))

	)

265 
	#isöf
(
x
) \

266 ( (
x
) ==  () \

267 ? 
	`__isöff
 (
x
) \

268 :  (
x
) ==  () \

269 ? 
	`__isöf
 (
x
Ë: 
	`__isöÊ
 (x))

	)

273 
	#MATH_ERRNO
 1

	)

274 
	#MATH_ERREXCEPT
 2

	)

279 #i‚de‡
__FAST_MATH__


280 
	#m©h_îrh™dlög
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

285 #ifde‡
__USE_GNU


287 #ifde‡
__NO_LONG_DOUBLE_MATH


288 
	#issig«lög
(
x
) \

289 ( (
x
Ë= (Ë? 
	`__issig«lögf
 (xË: 
	`__issig«lög
 (x))

	)

291 
	#issig«lög
(
x
) \

292 ( (
x
) ==  () \

293 ? 
	`__issig«lögf
 (
x
) \

294 :  (
x
) ==  () \

295 ? 
	`__issig«lög
 (
x
Ë: 
	`__issig«lögl
 (x))

	)

299 #ifdef 
__USE_MISC


303 
_IEEE_
 = -1,

304 
_SVID_
,

305 
_XOPEN_
,

306 
_POSIX_
,

307 
_ISOC_


308 } 
	t_LIB_VERSION_TYPE
;

313 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

317 #ifde‡
__USE_SVID


323 #ifde‡
__˝lu•lus


324 
__ex˚±i⁄


326 
ex˚±i⁄


329 
ty≥
;

330 *
«me
;

331 
¨g1
;

332 
¨g2
;

333 
ªtvÆ
;

334 
	}
};

336 #ifde‡
__˝lu•lus


337 
	$m©hîr
 (
__ex˚±i⁄
 *
__exc
Ë
	`throw
 ();

339 
	`m©hîr
 (
ex˚±i⁄
 *
__exc
);

342 
	#X_TLOSS
 1.41484755040568800000e+16

	)

345 
	#DOMAIN
 1

	)

346 
	#SING
 2

	)

347 
	#OVERFLOW
 3

	)

348 
	#UNDERFLOW
 4

	)

349 
	#TLOSS
 5

	)

350 
	#PLOSS
 6

	)

353 
	#HUGE
 3.40282347e+38F

	)

357 #ifde‡
__USE_XOPEN


359 
	#MAXFLOAT
 3.40282347e+38F

	)

366 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


367 
	#M_E
 2.7182818284590452354

	)

368 
	#M_LOG2E
 1.4426950408889634074

	)

369 
	#M_LOG10E
 0.43429448190325182765

	)

370 
	#M_LN2
 0.69314718055994530942

	)

371 
	#M_LN10
 2.30258509299404568402

	)

372 
	#M_PI
 3.14159265358979323846

	)

373 
	#M_PI_2
 1.57079632679489661923

	)

374 
	#M_PI_4
 0.78539816339744830962

	)

375 
	#M_1_PI
 0.31830988618379067154

	)

376 
	#M_2_PI
 0.63661977236758134308

	)

377 
	#M_2_SQRTPI
 1.12837916709551257390

	)

378 
	#M_SQRT2
 1.41421356237309504880

	)

379 
	#M_SQRT1_2
 0.70710678118654752440

	)

385 #ifde‡
__USE_GNU


386 
	#M_El
 2.718281828459045235360287471352662498L

	)

387 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

388 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

389 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

390 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

391 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

392 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

393 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

394 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

395 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

396 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

397 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

398 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

405 #i‡
deföed
 
__STRICT_ANSI__
 && !deföed 
__NO_MATH_INLINES


406 
	#__NO_MATH_INLINES
 1

	)

409 #i‡
deföed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

416 
	#isgª©î
(
x
, 
y
Ë
	`__buûtö_isgª©î
(x, y)

	)

417 
	#isgª©îequÆ
(
x
, 
y
Ë
	`__buûtö_isgª©îequÆ
(x, y)

	)

418 
	#i¶ess
(
x
, 
y
Ë
	`__buûtö_i¶ess
(x, y)

	)

419 
	#i¶es£quÆ
(
x
, 
y
Ë
	`__buûtö_i¶es£quÆ
(x, y)

	)

420 
	#i¶essgª©î
(
x
, 
y
Ë
	`__buûtö_i¶essgª©î
(x, y)

	)

421 
	#isun‹dîed
(
u
, 
v
Ë
	`__buûtö_isun‹dîed
(u, v)

	)

425 #ifde‡
__USE_EXTERN_INLINES


426 
	~<bôs/m©hölöe.h
>

431 #i‡
deföed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

432 
	~<bôs/m©h-föôe.h
>

435 #ifde‡
__USE_ISOC99


439 #i‚de‡
isgª©î


440 
	#isgª©î
(
x
, 
y
) \

441 (
__exãnsi⁄__
 \

442 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

443 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x > __y; 
	}
}))

	)

447 #i‚de‡
isgª©îequÆ


448 
	#isgª©îequÆ
(
x
, 
y
) \

449 (
__exãnsi⁄__
 \

450 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

451 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x >__y; }))

	)

455 #i‚de‡
i¶ess


456 
	#i¶ess
(
x
, 
y
) \

457 (
__exãnsi⁄__
 \

458 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

459 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x < __y; }))

	)

463 #i‚de‡
i¶es£quÆ


464 
	#i¶es£quÆ
(
x
, 
y
) \

465 (
__exãnsi⁄__
 \

466 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

467 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x <__y; }))

	)

471 #i‚de‡
i¶essgª©î


472 
	#i¶essgª©î
(
x
, 
y
) \

473 (
__exãnsi⁄__
 \

474 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

475 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& (__x < __y || __y < __x); }))

	)

479 #i‚de‡
isun‹dîed


480 
	#isun‹dîed
(
u
, 
v
) \

481 (
__exãnsi⁄__
 \

482 ({ 
	`__ty≥of__
(
u
Ë
__u
 = (u); __ty≥of__(
v
Ë
__v
 = (v); \

483 
	`Â˛assify
 (
__u
Ë=
FP_NAN
 || fp˛assify (
__v
Ë=FP_NAN; }))

	)

488 
	g__END_DECLS


	@/usr/include/net/if.h

19 #i‚de‡
_NET_IF_H


20 
	#_NET_IF_H
 1

	)

22 
	~<„©uªs.h
>

24 #ifde‡
__USE_MISC


25 
	~<sys/ty≥s.h
>

26 
	~<sys/sockë.h
>

31 
	#IF_NAMESIZE
 16

	)

33 
	sif_«meödex


35 
	mif_ödex
;

36 *
	mif_«me
;

40 #ifde‡
__USE_MISC


44 
	mIFF_UP
 = 0x1,

45 
	#IFF_UP
 
IFF_UP


	)

46 
	mIFF_BROADCAST
 = 0x2,

47 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

48 
	mIFF_DEBUG
 = 0x4,

49 
	#IFF_DEBUG
 
IFF_DEBUG


	)

50 
	mIFF_LOOPBACK
 = 0x8,

51 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

52 
	mIFF_POINTOPOINT
 = 0x10,

53 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

54 
	mIFF_NOTRAILERS
 = 0x20,

55 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

56 
	mIFF_RUNNING
 = 0x40,

57 
	#IFF_RUNNING
 
IFF_RUNNING


	)

58 
	mIFF_NOARP
 = 0x80,

59 
	#IFF_NOARP
 
IFF_NOARP


	)

60 
	mIFF_PROMISC
 = 0x100,

61 
	#IFF_PROMISC
 
IFF_PROMISC


	)

64 
	mIFF_ALLMULTI
 = 0x200,

65 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

67 
	mIFF_MASTER
 = 0x400,

68 
	#IFF_MASTER
 
IFF_MASTER


	)

69 
	mIFF_SLAVE
 = 0x800,

70 
	#IFF_SLAVE
 
IFF_SLAVE


	)

72 
	mIFF_MULTICAST
 = 0x1000,

73 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

75 
	mIFF_PORTSEL
 = 0x2000,

76 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

77 
	mIFF_AUTOMEDIA
 = 0x4000,

78 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

79 
	mIFF_DYNAMIC
 = 0x8000

80 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

88 
	siÁddr


90 
sockaddr
 
	miÁ_addr
;

93 
sockaddr
 
	mifu_brﬂdaddr
;

94 
sockaddr
 
	mifu_d°addr
;

95 } 
	miÁ_ifu
;

96 
iÁ˚
 *
	miÁ_iÂ
;

97 
iÁddr
 *
	miÁ_√xt
;

100 
	#iÁ_brﬂdaddr
 
iÁ_ifu
.
ifu_brﬂdaddr


	)

101 
	#iÁ_d°addr
 
iÁ_ifu
.
ifu_d°addr


	)

111 
	sifm≠


113 
	mmem_°¨t
;

114 
	mmem_íd
;

115 
	mba£_addr
;

116 
	múq
;

117 
	mdma
;

118 
	mp‹t
;

126 
	si‰eq


128 
	#IFHWADDRLEN
 6

	)

129 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

132 
	mi‰n_«me
[
IFNAMSIZ
];

133 } 
	mi‰_i‰n
;

137 
sockaddr
 
	mi‰u_addr
;

138 
sockaddr
 
	mi‰u_d°addr
;

139 
sockaddr
 
	mi‰u_brﬂdaddr
;

140 
sockaddr
 
	mi‰u_√tmask
;

141 
sockaddr
 
	mi‰u_hwaddr
;

142 
	mi‰u_Êags
;

143 
	mi‰u_ivÆue
;

144 
	mi‰u_mtu
;

145 
ifm≠
 
	mi‰u_m≠
;

146 
	mi‰u_¶ave
[
IFNAMSIZ
];

147 
	mi‰u_√w«me
[
IFNAMSIZ
];

148 
__ˇddr_t
 
	mi‰u_d©a
;

149 } 
	mi‰_i‰u
;

151 
	#i‰_«me
 
i‰_i‰n
.
i‰n_«me


	)

152 
	#i‰_hwaddr
 
i‰_i‰u
.
i‰u_hwaddr


	)

153 
	#i‰_addr
 
i‰_i‰u
.
i‰u_addr


	)

154 
	#i‰_d°addr
 
i‰_i‰u
.
i‰u_d°addr


	)

155 
	#i‰_brﬂdaddr
 
i‰_i‰u
.
i‰u_brﬂdaddr


	)

156 
	#i‰_√tmask
 
i‰_i‰u
.
i‰u_√tmask


	)

157 
	#i‰_Êags
 
i‰_i‰u
.
i‰u_Êags


	)

158 
	#i‰_mëric
 
i‰_i‰u
.
i‰u_ivÆue


	)

159 
	#i‰_mtu
 
i‰_i‰u
.
i‰u_mtu


	)

160 
	#i‰_m≠
 
i‰_i‰u
.
i‰u_m≠


	)

161 
	#i‰_¶ave
 
i‰_i‰u
.
i‰u_¶ave


	)

162 
	#i‰_d©a
 
i‰_i‰u
.
i‰u_d©a


	)

163 
	#i‰_ifödex
 
i‰_i‰u
.
i‰u_ivÆue


	)

164 
	#i‰_b™dwidth
 
i‰_i‰u
.
i‰u_ivÆue


	)

165 
	#i‰_qÀn
 
i‰_i‰u
.
i‰u_ivÆue


	)

166 
	#i‰_√w«me
 
i‰_i‰u
.
i‰u_√w«me


	)

167 
	#_IOT_i‰eq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

168 
	#_IOT_i‰eq_sh‹t
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

169 
	#_IOT_i‰eq_öt
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

176 
	sifc⁄f


178 
	mifc_Àn
;

181 
__ˇddr_t
 
	mifcu_buf
;

182 
i‰eq
 *
	mifcu_ªq
;

183 } 
	mifc_ifcu
;

185 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

186 
	#ifc_ªq
 
ifc_ifcu
.
ifcu_ªq


	)

187 
	#_IOT_ifc⁄f
 
	`_IOT
(
	`_IOTS
(
ifc⁄f
),1,0,0,0,0Ë

	)

190 
__BEGIN_DECLS


193 
	$if_«mëoödex
 (c⁄° *
__i‚ame
Ë
__THROW
;

194 *
	$if_ödext⁄ame
 (
__ifödex
, *
__i‚ame
Ë
__THROW
;

197 
if_«meödex
 *
	$if_«meödex
 (Ë
__THROW
;

200 
	$if_‰ì«meödex
 (
if_«meödex
 *
__±r
Ë
__THROW
;

202 
__END_DECLS


	@/usr/include/netdb.h

22 #i‚def 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<√töë/ö.h
>

28 
	~<°döt.h
>

29 #ifde‡
__USE_MISC


32 
	~<Ωc/√tdb.h
>

35 #ifde‡
__USE_GNU


36 
	#__√ed_sigevít_t


	)

37 
	~<bôs/sigöfo.h
>

38 
	#__√ed_time•ec


	)

39 
	~<time.h
>

42 
	~<bôs/√tdb.h
>

45 
	#_PATH_HEQUIV
 "/ëc/ho°s.equiv"

	)

46 
	#_PATH_HOSTS
 "/ëc/ho°s"

	)

47 
	#_PATH_NETWORKS
 "/ëc/√tw‹ks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/ëc/nsswôch.c⁄f"

	)

49 
	#_PATH_PROTOCOLS
 "/ëc/¥Ÿocﬁs"

	)

50 
	#_PATH_SERVICES
 "/ëc/£rvi˚s"

	)

53 
	g__BEGIN_DECLS


55 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


58 
	#h_î∫o
 (*
	`__h_î∫o_loˇti⁄
 ())

	)

61 *
	$__h_î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifde‡
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifde‡
__USE_MISC


92 
	$hîr‹
 (c⁄° *
__°r
Ë
__THROW
;

95 c⁄° *
	$h°ªº‹
 (
__îr_num
Ë
__THROW
;

100 
	sho°ít


102 *
h_«me
;

103 **
h_Æü£s
;

104 
h_addπy≥
;

105 
h_Àngth
;

106 **
h_addr_li°
;

107 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


108 
	#h_addr
 
h_addr_li°
[0]

	)

117 
	`£tho°ít
 (
__°ay_›í
);

123 
	`ídho°ít
 ();

130 
ho°ít
 *
	`gëho°ít
 ();

137 
ho°ít
 *
	`gëho°byaddr
 (c⁄° *
__addr
, 
__sockÀn_t
 
__Àn
,

138 
__ty≥
);

144 
ho°ít
 *
	`gëho°by«me
 (c⁄° *
__«me
);

146 #ifde‡
__USE_MISC


155 
ho°ít
 *
	`gëho°by«me2
 (c⁄° *
__«me
, 
__af
);

167 
	`gëho°ít_r
 (
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

168 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

169 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

170 *
__ª°ri˘
 
__h_î∫›
);

172 
	`gëho°byaddr_r
 (c⁄° *
__ª°ri˘
 
__addr
, 
__sockÀn_t
 
__Àn
,

173 
__ty≥
,

174 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

175 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

176 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

177 *
__ª°ri˘
 
__h_î∫›
);

179 
	`gëho°by«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

180 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

181 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

182 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

183 *
__ª°ri˘
 
__h_î∫›
);

185 
	`gëho°by«me2_r
 (c⁄° *
__ª°ri˘
 
__«me
, 
__af
,

186 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

187 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

188 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

189 *
__ª°ri˘
 
__h_î∫›
);

198 
	`£äëít
 (
__°ay_›í
);

204 
	`íd√ã¡
 ();

211 
√ã¡
 *
	`gë√ã¡
 ();

218 
√ã¡
 *
	`gë√tbyaddr
 (
uöt32_t
 
__√t
, 
__ty≥
);

224 
√ã¡
 *
	`gë√tby«me
 (c⁄° *
__«me
);

226 #ifdef 
__USE_MISC


237 
	`gë√ã¡_r
 (
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

238 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

239 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

240 *
__ª°ri˘
 
__h_î∫›
);

242 
	`gë√tbyaddr_r
 (
uöt32_t
 
__√t
, 
__ty≥
,

243 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

244 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

245 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

246 *
__ª°ri˘
 
__h_î∫›
);

248 
	`gë√tby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

249 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

250 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

251 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

252 *
__ª°ri˘
 
__h_î∫›
);

257 
	s£rvít


259 *
s_«me
;

260 **
s_Æü£s
;

261 
s_p‹t
;

262 *
s_¥Ÿo
;

270 
	`£t£rvít
 (
__°ay_›í
);

276 
	`íd£rvít
 ();

283 
£rvít
 *
	`gë£rvít
 ();

290 
£rvít
 *
	`gë£rvby«me
 (c⁄° *
__«me
, c⁄° *
__¥Ÿo
);

297 
£rvít
 *
	`gë£rvbyp‹t
 (
__p‹t
, c⁄° *
__¥Ÿo
);

300 #ifdef 
__USE_MISC


308 
	`gë£rvít_r
 (
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

309 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

310 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

312 
	`gë£rvby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

313 c⁄° *
__ª°ri˘
 
__¥Ÿo
,

314 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

315 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

316 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

318 
	`gë£rvbyp‹t_r
 (
__p‹t
, c⁄° *
__ª°ri˘
 
__¥Ÿo
,

319 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

320 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

321 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

326 
	s¥Ÿ€¡


328 *
p_«me
;

329 **
p_Æü£s
;

330 
p_¥Ÿo
;

338 
	`£çrŸ€¡
 (
__°ay_›í
);

344 
	`íd¥Ÿ€¡
 ();

351 
¥Ÿ€¡
 *
	`gë¥Ÿ€¡
 ();

357 
¥Ÿ€¡
 *
	`gë¥Ÿoby«me
 (c⁄° *
__«me
);

363 
¥Ÿ€¡
 *
	`gë¥Ÿobynumbî
 (
__¥Ÿo
);

366 #ifdef 
__USE_MISC


374 
	`gë¥Ÿ€¡_r
 (
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

375 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

376 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

378 
	`gë¥Ÿoby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

379 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

380 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

381 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

383 
	`gë¥Ÿobynumbî_r
 (
__¥Ÿo
,

384 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

385 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

386 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

395 
	`£äëgª¡
 (c⁄° *
__√tgroup
);

403 
	`íd√tgª¡
 ();

412 
	`gë√tgª¡
 (**
__ª°ri˘
 
__ho°p
,

413 **
__ª°ri˘
 
__u£Ω
,

414 **
__ª°ri˘
 
__domaöp
);

423 
	`ö√tgr
 (c⁄° *
__√tgroup
, c⁄° *
__ho°
,

424 c⁄° *
__u£r
, c⁄° *
__domaö
);

432 
	`gë√tgª¡_r
 (**
__ª°ri˘
 
__ho°p
,

433 **
__ª°ri˘
 
__u£Ω
,

434 **
__ª°ri˘
 
__domaöp
,

435 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
);

439 #ifde‡
__USE_BSD


451 
	`rcmd
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

452 c⁄° *
__ª°ri˘
 
__locu£r
,

453 c⁄° *
__ª°ri˘
 
__ªmu£r
,

454 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

463 
	`rcmd_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

464 c⁄° *
__ª°ri˘
 
__locu£r
,

465 c⁄° *
__ª°ri˘
 
__ªmu£r
,

466 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

467 
ß_Ámûy_t
 
__af
);

479 
	`ªxec
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

480 c⁄° *
__ª°ri˘
 
__«me
,

481 c⁄° *
__ª°ri˘
 
__∑ss
,

482 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

491 
	`ªxec_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

492 c⁄° *
__ª°ri˘
 
__«me
,

493 c⁄° *
__ª°ri˘
 
__∑ss
,

494 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

495 
ß_Ámûy_t
 
__af
);

505 
	`ru£rok
 (c⁄° *
__rho°
, 
__su£r
,

506 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

515 
	`ru£rok_af
 (c⁄° *
__rho°
, 
__su£r
,

516 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

517 
ß_Ámûy_t
 
__af
);

528 
	`úu£rok
 (
uöt32_t
 
__øddr
, 
__su£r
,

529 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

539 
	`úu£rok_af
 (c⁄° *
__øddr
, 
__su£r
,

540 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

541 
ß_Ámûy_t
 
__af
);

551 
	`ºesvp‹t
 (*
__Æp‹t
);

560 
	`ºesvp‹t_af
 (*
__Æp‹t
, 
ß_Ámûy_t
 
__af
);

565 #ifdef 
__USE_POSIX


567 
	saddröfo


569 
ai_Êags
;

570 
ai_Ámûy
;

571 
ai_sockty≥
;

572 
ai_¥Ÿocﬁ
;

573 
sockÀn_t
 
ai_addæí
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ˇn⁄«me
;

576 
addröfo
 *
ai_√xt
;

579 #ifde‡
__USE_GNU


581 
	sgaicb


583 c⁄° *
¨_«me
;

584 c⁄° *
¨_£rvi˚
;

585 c⁄° 
addröfo
 *
¨_ªque°
;

586 
addröfo
 *
¨_ªsu…
;

588 
__ªtu∫
;

589 
__glibc_ª£rved
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifde‡
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifde‡
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifde‡
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifde‡
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`gëaddröfo
 (c⁄° *
__ª°ri˘
 
__«me
,

663 c⁄° *
__ª°ri˘
 
__£rvi˚
,

664 c⁄° 
addröfo
 *
__ª°ri˘
 
__ªq
,

665 
addröfo
 **
__ª°ri˘
 
__∑i
);

668 
	$‰ìaddröfo
 (
addröfo
 *
__ai
Ë
__THROW
;

671 c⁄° *
	$gai_°ªº‹
 (
__ecode
Ë
__THROW
;

677 
	`gë«meöfo
 (c⁄° 
sockaddr
 *
__ª°ri˘
 
__ß
,

678 
sockÀn_t
 
__ßÀn
, *
__ª°ri˘
 
__ho°
,

679 
sockÀn_t
 
__ho°Àn
, *
__ª°ri˘
 
__£rv
,

680 
sockÀn_t
 
__£rvÀn
, 
__Êags
);

683 #ifde‡
__USE_GNU


692 
	`gëaddröfo_a
 (
__mode
, 
gaicb
 *
__li°
[
__ª°ri˘_¨r
],

693 
__ít
, 
sigevít
 *
__ª°ri˘
 
__sig
);

703 
	`gai_su•íd
 (c⁄° 
gaicb
 *c⁄° 
__li°
[], 
__ít
,

704 c⁄° 
time•ec
 *
__timeout
);

707 
	$gai_îr‹
 (
gaicb
 *
__ªq
Ë
__THROW
;

710 
	$gai_ˇn˚l
 (
gaicb
 *
__gaicbp
Ë
__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/in.h

18 #i‚def 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<°döt.h
>

23 
	~<sys/sockë.h
>

24 
	~<bôs/ty≥s.h
>

27 
__BEGIN_DECLS


30 
uöt32_t
 
	tö_addr_t
;

31 
	sö_addr


33 
ö_addr_t
 
	ms_addr
;

37 
	~<bôs/ö.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_RAW
 = 255,

89 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

90 
	mIPPROTO_MAX


96 #i‚de‡
__USE_KERNEL_IPV6_DEFS


99 
	mIPPROTO_HOPOPTS
 = 0,

100 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

101 
	mIPPROTO_ROUTING
 = 43,

102 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

103 
	mIPPROTO_FRAGMENT
 = 44,

104 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

105 
	mIPPROTO_ICMPV6
 = 58,

106 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

107 
	mIPPROTO_NONE
 = 59,

108 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

109 
	mIPPROTO_DSTOPTS
 = 60,

110 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

111 
	mIPPROTO_MH
 = 135

112 
	#IPPROTO_MH
 
IPPROTO_MH


	)

117 
uöt16_t
 
	tö_p‹t_t
;

122 
	mIPPORT_ECHO
 = 7,

123 
	mIPPORT_DISCARD
 = 9,

124 
	mIPPORT_SYSTAT
 = 11,

125 
	mIPPORT_DAYTIME
 = 13,

126 
	mIPPORT_NETSTAT
 = 15,

127 
	mIPPORT_FTP
 = 21,

128 
	mIPPORT_TELNET
 = 23,

129 
	mIPPORT_SMTP
 = 25,

130 
	mIPPORT_TIMESERVER
 = 37,

131 
	mIPPORT_NAMESERVER
 = 42,

132 
	mIPPORT_WHOIS
 = 43,

133 
	mIPPORT_MTP
 = 57,

135 
	mIPPORT_TFTP
 = 69,

136 
	mIPPORT_RJE
 = 77,

137 
	mIPPORT_FINGER
 = 79,

138 
	mIPPORT_TTYLINK
 = 87,

139 
	mIPPORT_SUPDUP
 = 95,

142 
	mIPPORT_EXECSERVER
 = 512,

143 
	mIPPORT_LOGINSERVER
 = 513,

144 
	mIPPORT_CMDSERVER
 = 514,

145 
	mIPPORT_EFSSERVER
 = 520,

148 
	mIPPORT_BIFFUDP
 = 512,

149 
	mIPPORT_WHOSERVER
 = 513,

150 
	mIPPORT_ROUTESERVER
 = 520,

153 
	mIPPORT_RESERVED
 = 1024,

156 
	mIPPORT_USERRESERVED
 = 5000

164 
	#IN_CLASSA
(
a
Ë((((
ö_addr_t
)◊)Ë& 0x80000000Ë=0)

	)

165 
	#IN_CLASSA_NET
 0xff000000

	)

166 
	#IN_CLASSA_NSHIFT
 24

	)

167 
	#IN_CLASSA_HOST
 (0xfffffff‡& ~
IN_CLASSA_NET
)

	)

168 
	#IN_CLASSA_MAX
 128

	)

170 
	#IN_CLASSB
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xc0000000Ë=0x80000000)

	)

171 
	#IN_CLASSB_NET
 0xffff0000

	)

172 
	#IN_CLASSB_NSHIFT
 16

	)

173 
	#IN_CLASSB_HOST
 (0xfffffff‡& ~
IN_CLASSB_NET
)

	)

174 
	#IN_CLASSB_MAX
 65536

	)

176 
	#IN_CLASSC
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xc0000000)

	)

177 
	#IN_CLASSC_NET
 0xffffff00

	)

178 
	#IN_CLASSC_NSHIFT
 8

	)

179 
	#IN_CLASSC_HOST
 (0xfffffff‡& ~
IN_CLASSC_NET
)

	)

181 
	#IN_CLASSD
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xe0000000)

	)

182 
	#IN_MULTICAST
(
a
Ë
	`IN_CLASSD
◊)

	)

184 
	#IN_EXPERIMENTAL
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xe0000000)

	)

185 
	#IN_BADCLASS
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xf0000000)

	)

188 
	#INADDR_ANY
 ((
ö_addr_t
Ë0x00000000)

	)

190 
	#INADDR_BROADCAST
 ((
ö_addr_t
Ë0xffffffff)

	)

192 
	#INADDR_NONE
 ((
ö_addr_t
Ë0xffffffff)

	)

195 
	#IN_LOOPBACKNET
 127

	)

197 #i‚de‡
INADDR_LOOPBACK


198 
	#INADDR_LOOPBACK
 ((
ö_addr_t
Ë0x7f000001Ë

	)

202 
	#INADDR_UNSPEC_GROUP
 ((
ö_addr_t
Ë0xe0000000Ë

	)

203 
	#INADDR_ALLHOSTS_GROUP
 ((
ö_addr_t
Ë0xe0000001Ë

	)

204 
	#INADDR_ALLRTRS_GROUP
 ((
ö_addr_t
Ë0xe0000002Ë

	)

205 
	#INADDR_MAX_LOCAL_GROUP
 ((
ö_addr_t
Ë0xe00000ffË

	)

207 #i‚de‡
__USE_KERNEL_IPV6_DEFS


209 
	sö6_addr


213 
uöt8_t
 
	m__u6_addr8
[16];

214 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


215 
uöt16_t
 
	m__u6_addr16
[8];

216 
uöt32_t
 
	m__u6_addr32
[4];

218 } 
	m__ö6_u
;

219 
	#s6_addr
 
__ö6_u
.
__u6_addr8


	)

220 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


221 
	#s6_addr16
 
__ö6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__ö6_u
.
__u6_addr32


	)

227 c⁄° 
ö6_addr
 
ö6addr_™y
;

228 c⁄° 
ö6_addr
 
ö6addr_lo›back
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_ö


239 
__SOCKADDR_COMMON
 (
sö_
);

240 
ö_p‹t_t
 
	msö_p‹t
;

241 
ö_addr
 
	msö_addr
;

244 
	msö_zîo
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
ö_p‹t_t
) -

247  (
ö_addr
)];

250 #i‚de‡
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_ö6


254 
__SOCKADDR_COMMON
 (
sö6_
);

255 
ö_p‹t_t
 
	msö6_p‹t
;

256 
uöt32_t
 
	msö6_Êowöfo
;

257 
ö6_addr
 
	msö6_addr
;

258 
uöt32_t
 
	msö6_sc›e_id
;

262 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


264 
	sù_mªq


267 
ö_addr
 
	mimr_mu…üddr
;

270 
ö_addr
 
	mimr_öãrÁ˚
;

273 
	sù_mªq_sour˚


276 
ö_addr
 
	mimr_mu…üddr
;

279 
ö_addr
 
	mimr_öãrÁ˚
;

282 
ö_addr
 
	mimr_sour˚addr
;

286 #i‚de‡
__USE_KERNEL_IPV6_DEFS


288 
	sùv6_mªq


291 
ö6_addr
 
	mùv6mr_mu…üddr
;

294 
	mùv6mr_öãrÁ˚
;

298 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


300 
	sgroup_ªq


303 
uöt32_t
 
	mgr_öãrÁ˚
;

306 
sockaddr_°‹age
 
	mgr_group
;

309 
	sgroup_sour˚_ªq


312 
uöt32_t
 
	mg§_öãrÁ˚
;

315 
sockaddr_°‹age
 
	mg§_group
;

318 
sockaddr_°‹age
 
	mg§_sour˚
;

323 
	sù_msfûãr


326 
ö_addr
 
	mimsf_mu…üddr
;

329 
ö_addr
 
	mimsf_öãrÁ˚
;

332 
uöt32_t
 
	mimsf_fmode
;

335 
uöt32_t
 
	mimsf_num§c
;

337 
ö_addr
 
	mimsf_¶i°
[1];

340 
	#IP_MSFILTER_SIZE
(
num§c
Ë( (
ù_msfûãr
) \

341 -  (
ö_addr
) \

342 + (
num§c
Ë*  (
ö_addr
))

	)

344 
	sgroup_fûãr


347 
uöt32_t
 
	mgf_öãrÁ˚
;

350 
sockaddr_°‹age
 
	mgf_group
;

353 
uöt32_t
 
	mgf_fmode
;

356 
uöt32_t
 
	mgf_num§c
;

358 
sockaddr_°‹age
 
	mgf_¶i°
[1];

361 
	#GROUP_FILTER_SIZE
(
num§c
Ë( (
group_fûãr
) \

362 -  (
sockaddr_°‹age
) \

363 + ((
num§c
) \

364 *  (
sockaddr_°‹age
)))

	)

374 
uöt32_t
 
	$¡ohl
 (
uöt32_t
 
__√é⁄g
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

375 
uöt16_t
 
	$¡ohs
 (
uöt16_t
 
__√tsh‹t
)

376 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

377 
uöt32_t
 
	$ht⁄l
 (
uöt32_t
 
__ho°l⁄g
)

378 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

379 
uöt16_t
 
	$ht⁄s
 (
uöt16_t
 
__ho°sh‹t
)

380 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

382 
	~<ídün.h
>

385 
	~<bôs/byãsw≠.h
>

387 #ifde‡
__OPTIMIZE__


391 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


394 
	#¡ohl
(
x
Ë(x)

	)

395 
	#¡ohs
(
x
Ë(x)

	)

396 
	#ht⁄l
(
x
Ë(x)

	)

397 
	#ht⁄s
(
x
Ë(x)

	)

399 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


400 
	#¡ohl
(
x
Ë
	`__bsw≠_32
 (x)

	)

401 
	#¡ohs
(
x
Ë
	`__bsw≠_16
 (x)

	)

402 
	#ht⁄l
(
x
Ë
	`__bsw≠_32
 (x)

	)

403 
	#ht⁄s
(
x
Ë
	`__bsw≠_16
 (x)

	)

408 #ifde‡
__GNUC__


409 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

410 (
__exãnsi⁄__
 \

411 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

412 
__a
->
s6_addr32
[0] == 0 \

413 && 
__a
->
s6_addr32
[1] == 0 \

414 && 
__a
->
s6_addr32
[2] == 0 \

415 && 
__a
->
s6_addr32
[3] =0; 
	}
}))

	)

417 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

418 (
__exãnsi⁄__
 \

419 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

420 
__a
->
s6_addr32
[0] == 0 \

421 && 
__a
->
s6_addr32
[1] == 0 \

422 && 
__a
->
s6_addr32
[2] == 0 \

423 && 
__a
->
s6_addr32
[3] =
	`ht⁄l
 (1); }))

	)

425 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

426 (
__exãnsi⁄__
 \

427 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

428 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„800000); }))

	)

430 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

431 (
__exãnsi⁄__
 \

432 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

433 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„c00000); }))

	)

435 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

436 (
__exãnsi⁄__
 \

437 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

438 
__a
->
s6_addr32
[0] == 0 \

439 && 
__a
->
s6_addr32
[1] == 0 \

440 && 
__a
->
s6_addr32
[2] =
	`ht⁄l
 (0xffff); }))

	)

442 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

443 (
__exãnsi⁄__
 \

444 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

445 
__a
->
s6_addr32
[0] == 0 \

446 && 
__a
->
s6_addr32
[1] == 0 \

447 && 
__a
->
s6_addr32
[2] == 0 \

448 && 
	`¡ohl
 (
__a
->
s6_addr32
[3]Ë> 1; }))

	)

450 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

451 (
__exãnsi⁄__
 \

452 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

453 c⁄° 
ö6_addr
 *
__b
 = (c⁄° ö6_add∏*Ë(
b
); \

454 
__a
->
s6_addr32
[0] =
__b
->s6_addr32[0] \

455 && 
__a
->
s6_addr32
[1] =
__b
->s6_addr32[1] \

456 && 
__a
->
s6_addr32
[2] =
__b
->s6_addr32[2] \

457 && 
__a
->
s6_addr32
[3] =
__b
->s6_addr32[3]; }))

	)

459 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

460 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

461 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

462 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

463 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =0)

	)

465 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

466 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

467 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

468 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

469 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =
	`ht⁄l
 (1))

	)

471 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

472 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

473 =
	`ht⁄l
 (0x„800000))

	)

475 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

476 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

477 =
	`ht⁄l
 (0x„c00000))

	)

479 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

480 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

481 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

482 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =
	`ht⁄l
 (0xffff)))

	)

484 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

485 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

486 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

487 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0) \

488 && (
	`¡ohl
 (((c⁄° 
uöt32_t
 *Ë(
a
))[3]Ë> 1))

	)

490 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

491 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] =((c⁄° uöt32_à*Ë(
b
))[0]) \

492 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] =((c⁄° uöt32_à*Ë(
b
))[1]) \

493 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =((c⁄° uöt32_à*Ë(
b
))[2]) \

494 && (((c⁄° 
uöt32_t
 *Ë(
a
))[3] =((c⁄° uöt32_à*Ë(
b
))[3]))

	)

497 
	#IN6_IS_ADDR_MULTICAST
(
a
Ë(((c⁄° 
uöt8_t
 *Ë◊))[0] =0xff)

	)

499 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


501 
	$bödªsvp‹t
 (
__sockfd
, 
sockaddr_ö
 *
__sock_ö
Ë
__THROW
;

504 
	$bödªsvp‹t6
 (
__sockfd
, 
sockaddr_ö6
 *
__sock_ö
)

505 
__THROW
;

509 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

510 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

511 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x1))

	)

513 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

514 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

515 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x2))

	)

517 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

518 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

519 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x5))

	)

521 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

522 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

523 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x8))

	)

525 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

526 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

527 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0xe))

	)

530 #ifde‡
__USE_GNU


531 
cmsghdr
;

534 
	sö6_pktöfo


536 
ö6_addr
 
ùi6_addr
;

537 
ùi6_ifödex
;

541 
	sù6_mtuöfo


543 
sockaddr_ö6
 
ù6m_addr
;

544 
uöt32_t
 
ù6m_mtu
;

549 
	$öë6_›ti⁄_•a˚
 (
__nbyãs
)

550 
__THROW
 
__©åibuã_dïªˇãd__
;

551 
	$öë6_›ti⁄_öô
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

552 
__ty≥
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

553 
	$öë6_›ti⁄_≠≥nd
 (
cmsghdr
 *
__cmsg
,

554 c⁄° 
uöt8_t
 *
__ty≥p
, 
__mu…x
,

555 
__∂usy
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

556 
uöt8_t
 *
	$öë6_›ti⁄_Æloc
 (
cmsghdr
 *
__cmsg
, 
__d©Æí
,

557 
__mu…x
, 
__∂usy
)

558 
__THROW
 
__©åibuã_dïªˇãd__
;

559 
	$öë6_›ti⁄_√xt
 (c⁄° 
cmsghdr
 *
__cmsg
,

560 
uöt8_t
 **
__çåp
)

561 
__THROW
 
__©åibuã_dïªˇãd__
;

562 
	$öë6_›ti⁄_föd
 (c⁄° 
cmsghdr
 *
__cmsg
,

563 
uöt8_t
 **
__çåp
, 
__ty≥
)

564 
__THROW
 
__©åibuã_dïªˇãd__
;

568 
	$öë6_›t_öô
 (*
__extbuf
, 
sockÀn_t
 
__exéí
Ë
__THROW
;

569 
	$öë6_›t_≠≥nd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

570 
uöt8_t
 
__ty≥
, 
sockÀn_t
 
__Àn
, uöt8_à
__Æign
,

571 **
__d©abuÂ
Ë
__THROW
;

572 
	$öë6_›t_föish
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
)

573 
__THROW
;

574 
	$öë6_›t_£t_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

575 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

576 
	$öë6_›t_√xt
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

577 
uöt8_t
 *
__ty≥p
, 
sockÀn_t
 *
__À≈
,

578 **
__d©abuÂ
Ë
__THROW
;

579 
	$öë6_›t_föd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

580 
uöt8_t
 
__ty≥
, 
sockÀn_t
 *
__À≈
,

581 **
__d©abuÂ
Ë
__THROW
;

582 
	$öë6_›t_gë_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

583 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

587 
sockÀn_t
 
	$öë6_πh_•a˚
 (
__ty≥
, 
__£gmíts
Ë
__THROW
;

588 *
	$öë6_πh_öô
 (*
__bp
, 
sockÀn_t
 
__bp_Àn
, 
__ty≥
,

589 
__£gmíts
Ë
__THROW
;

590 
	$öë6_πh_add
 (*
__bp
, c⁄° 
ö6_addr
 *
__addr
Ë
__THROW
;

591 
	$öë6_πh_ªvî£
 (c⁄° *
__ö
, *
__out
Ë
__THROW
;

592 
	$öë6_πh_£gmíts
 (c⁄° *
__bp
Ë
__THROW
;

593 
ö6_addr
 *
	$öë6_πh_gëaddr
 (c⁄° *
__bp
, 
__ödex
)

594 
__THROW
;

600 
	$gëùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

601 
ö_addr
 
__group
, 
uöt32_t
 *
__fmode
,

602 
uöt32_t
 *
__num§c
, 
ö_addr
 *
__¶i°
)

603 
__THROW
;

606 
	$£tùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

607 
ö_addr
 
__group
, 
uöt32_t
 
__fmode
,

608 
uöt32_t
 
__num§c
,

609 c⁄° 
ö_addr
 *
__¶i°
)

610 
__THROW
;

614 
	$gësour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

615 c⁄° 
sockaddr
 *
__group
,

616 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 *
__fmode
,

617 
uöt32_t
 *
__num§c
,

618 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

621 
	$£tsour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

622 c⁄° 
sockaddr
 *
__group
,

623 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 
__fmode
,

624 
uöt32_t
 
__num§c
,

625 c⁄° 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

628 
__END_DECLS


	@/usr/include/netinet/in_systm.h

19 #i‚de‡
_NETINET_IN_SYSTM_H


20 
	#_NETINET_IN_SYSTM_H
 1

	)

22 
	~<sys/cdefs.h
>

23 
	~<sys/ty≥s.h
>

25 
__BEGIN_DECLS


34 
u_öt16_t
 
	tn_sh‹t
;

35 
u_öt32_t
 
	tn_l⁄g
;

36 
u_öt32_t
 
	tn_time
;

38 
	g__END_DECLS


	@/usr/include/netinet/ip.h

18 #i‚de‡
__NETINET_IP_H


19 
	#__NETINET_IP_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<sys/ty≥s.h
>

24 
	~<√töë/ö.h
>

26 
__BEGIN_DECLS


28 
	stime°amp


30 
u_öt8_t
 
	mÀn
;

31 
u_öt8_t
 
	m±r
;

32 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


33 
	mÊags
:4;

34 
	movîÊow
:4;

35 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


36 
	movîÊow
:4;

37 
	mÊags
:4;

41 
u_öt32_t
 
	md©a
[9];

44 
	sùhdr


46 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


47 
	mihl
:4;

48 
	mvîsi⁄
:4;

49 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


50 
	mvîsi⁄
:4;

51 
	mihl
:4;

55 
u_öt8_t
 
	mtos
;

56 
u_öt16_t
 
	mtŸ_Àn
;

57 
u_öt16_t
 
	mid
;

58 
u_öt16_t
 
	m‰ag_off
;

59 
u_öt8_t
 
	mâl
;

60 
u_öt8_t
 
	m¥Ÿocﬁ
;

61 
u_öt16_t
 
	mcheck
;

62 
u_öt32_t
 
	mßddr
;

63 
u_öt32_t
 
	mdaddr
;

67 #ifde‡
__USE_BSD


107 
	sù


109 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


110 
	mù_hl
:4;

111 
	mù_v
:4;

113 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


114 
	mù_v
:4;

115 
	mù_hl
:4;

117 
u_öt8_t
 
	mù_tos
;

118 
u_sh‹t
 
	mù_Àn
;

119 
u_sh‹t
 
	mù_id
;

120 
u_sh‹t
 
	mù_off
;

121 
	#IP_RF
 0x8000

	)

122 
	#IP_DF
 0x4000

	)

123 
	#IP_MF
 0x2000

	)

124 
	#IP_OFFMASK
 0x1ff‡

	)

125 
u_öt8_t
 
	mù_âl
;

126 
u_öt8_t
 
	mù_p
;

127 
u_sh‹t
 
	mù_sum
;

128 
ö_addr
 
	mù_§c
, 
	mù_d°
;

134 
	sù_time°amp


136 
u_öt8_t
 
	mùt_code
;

137 
u_öt8_t
 
	mùt_Àn
;

138 
u_öt8_t
 
	mùt_±r
;

139 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


140 
	mùt_Êg
:4;

141 
	mùt_oÊw
:4;

143 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


144 
	mùt_oÊw
:4;

145 
	mùt_Êg
:4;

147 
u_öt32_t
 
	md©a
[9];

151 
	#IPVERSION
 4

	)

152 
	#IP_MAXPACKET
 65535

	)

160 
	#IPTOS_ECN_MASK
 0x03

	)

161 
	#IPTOS_ECN
(
x
Ë((xË& 
IPTOS_ECN_MASK
)

	)

162 
	#IPTOS_ECN_NOT_ECT
 0x00

	)

163 
	#IPTOS_ECN_ECT1
 0x01

	)

164 
	#IPTOS_ECN_ECT0
 0x02

	)

165 
	#IPTOS_ECN_CE
 0x03

	)

173 
	#IPTOS_DSCP_MASK
 0xfc

	)

174 
	#IPTOS_DSCP
(
x
Ë((xË& 
IPTOS_DSCP_MASK
)

	)

175 
	#IPTOS_DSCP_AF11
 0x28

	)

176 
	#IPTOS_DSCP_AF12
 0x30

	)

177 
	#IPTOS_DSCP_AF13
 0x38

	)

178 
	#IPTOS_DSCP_AF21
 0x48

	)

179 
	#IPTOS_DSCP_AF22
 0x50

	)

180 
	#IPTOS_DSCP_AF23
 0x58

	)

181 
	#IPTOS_DSCP_AF31
 0x68

	)

182 
	#IPTOS_DSCP_AF32
 0x70

	)

183 
	#IPTOS_DSCP_AF33
 0x78

	)

184 
	#IPTOS_DSCP_AF41
 0x88

	)

185 
	#IPTOS_DSCP_AF42
 0x90

	)

186 
	#IPTOS_DSCP_AF43
 0x98

	)

187 
	#IPTOS_DSCP_EF
 0xb8

	)

194 
	#IPTOS_CLASS_MASK
 0xe0

	)

195 
	#IPTOS_CLASS
(
˛ass
Ë((˛assË& 
IPTOS_CLASS_MASK
)

	)

196 
	#IPTOS_CLASS_CS0
 0x00

	)

197 
	#IPTOS_CLASS_CS1
 0x20

	)

198 
	#IPTOS_CLASS_CS2
 0x40

	)

199 
	#IPTOS_CLASS_CS3
 0x60

	)

200 
	#IPTOS_CLASS_CS4
 0x80

	)

201 
	#IPTOS_CLASS_CS5
 0xa0

	)

202 
	#IPTOS_CLASS_CS6
 0xc0

	)

203 
	#IPTOS_CLASS_CS7
 0xe0

	)

205 
	#IPTOS_CLASS_DEFAULT
 
IPTOS_CLASS_CS0


	)

211 
	#IPTOS_TOS_MASK
 0x1E

	)

212 
	#IPTOS_TOS
(
tos
Ë(—osË& 
IPTOS_TOS_MASK
)

	)

213 
	#IPTOS_LOWDELAY
 0x10

	)

214 
	#IPTOS_THROUGHPUT
 0x08

	)

215 
	#IPTOS_RELIABILITY
 0x04

	)

216 
	#IPTOS_LOWCOST
 0x02

	)

217 
	#IPTOS_MINCOST
 
IPTOS_LOWCOST


	)

222 
	#IPTOS_PREC_MASK
 
IPTOS_CLASS_MASK


	)

223 
	#IPTOS_PREC
(
tos
Ë
	`IPTOS_CLASS
—os)

	)

224 
	#IPTOS_PREC_NETCONTROL
 
IPTOS_CLASS_CS7


	)

225 
	#IPTOS_PREC_INTERNETCONTROL
 
IPTOS_CLASS_CS6


	)

226 
	#IPTOS_PREC_CRITIC_ECP
 
IPTOS_CLASS_CS5


	)

227 
	#IPTOS_PREC_FLASHOVERRIDE
 
IPTOS_CLASS_CS4


	)

228 
	#IPTOS_PREC_FLASH
 
IPTOS_CLASS_CS3


	)

229 
	#IPTOS_PREC_IMMEDIATE
 
IPTOS_CLASS_CS2


	)

230 
	#IPTOS_PREC_PRIORITY
 
IPTOS_CLASS_CS1


	)

231 
	#IPTOS_PREC_ROUTINE
 
IPTOS_CLASS_CS0


	)

236 
	#IPOPT_COPY
 0x80

	)

237 
	#IPOPT_CLASS_MASK
 0x60

	)

238 
	#IPOPT_NUMBER_MASK
 0x1f

	)

240 
	#IPOPT_COPIED
(
o
Ë((oË& 
IPOPT_COPY
)

	)

241 
	#IPOPT_CLASS
(
o
Ë((oË& 
IPOPT_CLASS_MASK
)

	)

242 
	#IPOPT_NUMBER
(
o
Ë((oË& 
IPOPT_NUMBER_MASK
)

	)

244 
	#IPOPT_CONTROL
 0x00

	)

245 
	#IPOPT_RESERVED1
 0x20

	)

246 
	#IPOPT_DEBMEAS
 0x40

	)

247 
	#IPOPT_MEASUREMENT
 
IPOPT_DEBMEAS


	)

248 
	#IPOPT_RESERVED2
 0x60

	)

250 
	#IPOPT_EOL
 0

	)

251 
	#IPOPT_END
 
IPOPT_EOL


	)

252 
	#IPOPT_NOP
 1

	)

253 
	#IPOPT_NOOP
 
IPOPT_NOP


	)

255 
	#IPOPT_RR
 7

	)

256 
	#IPOPT_TS
 68

	)

257 
	#IPOPT_TIMESTAMP
 
IPOPT_TS


	)

258 
	#IPOPT_SECURITY
 130

	)

259 
	#IPOPT_SEC
 
IPOPT_SECURITY


	)

260 
	#IPOPT_LSRR
 131

	)

261 
	#IPOPT_SATID
 136

	)

262 
	#IPOPT_SID
 
IPOPT_SATID


	)

263 
	#IPOPT_SSRR
 137

	)

264 
	#IPOPT_RA
 148

	)

269 
	#IPOPT_OPTVAL
 0

	)

270 
	#IPOPT_OLEN
 1

	)

271 
	#IPOPT_OFFSET
 2

	)

272 
	#IPOPT_MINOFF
 4

	)

274 
	#MAX_IPOPTLEN
 40

	)

277 
	#IPOPT_TS_TSONLY
 0

	)

278 
	#IPOPT_TS_TSANDADDR
 1

	)

279 
	#IPOPT_TS_PRESPEC
 3

	)

282 
	#IPOPT_SECUR_UNCLASS
 0x0000

	)

283 
	#IPOPT_SECUR_CONFID
 0xf135

	)

284 
	#IPOPT_SECUR_EFTO
 0x789a

	)

285 
	#IPOPT_SECUR_MMMM
 0xbc4d

	)

286 
	#IPOPT_SECUR_RESTR
 0xaf13

	)

287 
	#IPOPT_SECUR_SECRET
 0xd788

	)

288 
	#IPOPT_SECUR_TOPSECRET
 0x6bc5

	)

293 
	#MAXTTL
 255

	)

294 
	#IPDEFTTL
 64

	)

295 
	#IPFRAGTTL
 60

	)

296 
	#IPTTLDEC
 1

	)

298 
	#IP_MSS
 576

	)

300 
	g__END_DECLS


	@/usr/include/netinet/ip_icmp.h

18 #i‚de‡
__NETINET_IP_ICMP_H


19 
	#__NETINET_IP_ICMP_H
 1

	)

21 
	~<sys/cdefs.h
>

22 
	~<sys/ty≥s.h
>

24 
__BEGIN_DECLS


26 
	sicmphdr


28 
u_öt8_t
 
	mty≥
;

29 
u_öt8_t
 
	mcode
;

30 
u_öt16_t
 
	mchecksum
;

35 
u_öt16_t
 
	mid
;

36 
u_öt16_t
 
	m£quí˚
;

37 } 
	mecho
;

38 
u_öt32_t
 
	mg©eway
;

41 
u_öt16_t
 
	m__glibc_ª£rved
;

42 
u_öt16_t
 
	mmtu
;

43 } 
	m‰ag
;

44 } 
	mun
;

47 
	#ICMP_ECHOREPLY
 0

	)

48 
	#ICMP_DEST_UNREACH
 3

	)

49 
	#ICMP_SOURCE_QUENCH
 4

	)

50 
	#ICMP_REDIRECT
 5

	)

51 
	#ICMP_ECHO
 8

	)

52 
	#ICMP_TIME_EXCEEDED
 11

	)

53 
	#ICMP_PARAMETERPROB
 12

	)

54 
	#ICMP_TIMESTAMP
 13

	)

55 
	#ICMP_TIMESTAMPREPLY
 14

	)

56 
	#ICMP_INFO_REQUEST
 15

	)

57 
	#ICMP_INFO_REPLY
 16

	)

58 
	#ICMP_ADDRESS
 17

	)

59 
	#ICMP_ADDRESSREPLY
 18

	)

60 
	#NR_ICMP_TYPES
 18

	)

64 
	#ICMP_NET_UNREACH
 0

	)

65 
	#ICMP_HOST_UNREACH
 1

	)

66 
	#ICMP_PROT_UNREACH
 2

	)

67 
	#ICMP_PORT_UNREACH
 3

	)

68 
	#ICMP_FRAG_NEEDED
 4

	)

69 
	#ICMP_SR_FAILED
 5

	)

70 
	#ICMP_NET_UNKNOWN
 6

	)

71 
	#ICMP_HOST_UNKNOWN
 7

	)

72 
	#ICMP_HOST_ISOLATED
 8

	)

73 
	#ICMP_NET_ANO
 9

	)

74 
	#ICMP_HOST_ANO
 10

	)

75 
	#ICMP_NET_UNR_TOS
 11

	)

76 
	#ICMP_HOST_UNR_TOS
 12

	)

77 
	#ICMP_PKT_FILTERED
 13

	)

78 
	#ICMP_PREC_VIOLATION
 14

	)

79 
	#ICMP_PREC_CUTOFF
 15

	)

80 
	#NR_ICMP_UNREACH
 15

	)

83 
	#ICMP_REDIR_NET
 0

	)

84 
	#ICMP_REDIR_HOST
 1

	)

85 
	#ICMP_REDIR_NETTOS
 2

	)

86 
	#ICMP_REDIR_HOSTTOS
 3

	)

89 
	#ICMP_EXC_TTL
 0

	)

90 
	#ICMP_EXC_FRAGTIME
 1

	)

93 #ifde‡
__USE_BSD


125 
	~<√töë/ö.h
>

126 
	~<√töë/ù.h
>

131 
	sicmp_ø_addr


133 
u_öt32_t
 
	múa_addr
;

134 
u_öt32_t
 
	múa_¥e„ªn˚
;

137 
	sicmp


139 
u_öt8_t
 
	micmp_ty≥
;

140 
u_öt8_t
 
	micmp_code
;

141 
u_öt16_t
 
	micmp_cksum
;

144 
u_ch¨
 
	mih_µå
;

145 
ö_addr
 
	mih_gwaddr
;

146 
	sih_id£q


148 
u_öt16_t
 
	micd_id
;

149 
u_öt16_t
 
	micd_£q
;

150 } 
	mih_id£q
;

151 
u_öt32_t
 
	mih_void
;

154 
	sih_pmtu


156 
u_öt16_t
 
	mùm_void
;

157 
u_öt16_t
 
	mùm_√xtmtu
;

158 } 
	mih_pmtu
;

160 
	sih_πødv


162 
u_öt8_t
 
	mút_num_addrs
;

163 
u_öt8_t
 
	mút_w∑
;

164 
u_öt16_t
 
	mút_li„time
;

165 } 
	mih_πødv
;

166 } 
	micmp_hun
;

167 
	#icmp_µå
 
icmp_hun
.
ih_µå


	)

168 
	#icmp_gwaddr
 
icmp_hun
.
ih_gwaddr


	)

169 
	#icmp_id
 
icmp_hun
.
ih_id£q
.
icd_id


	)

170 
	#icmp_£q
 
icmp_hun
.
ih_id£q
.
icd_£q


	)

171 
	#icmp_void
 
icmp_hun
.
ih_void


	)

172 
	#icmp_pmvoid
 
icmp_hun
.
ih_pmtu
.
ùm_void


	)

173 
	#icmp_√xtmtu
 
icmp_hun
.
ih_pmtu
.
ùm_√xtmtu


	)

174 
	#icmp_num_addrs
 
icmp_hun
.
ih_πødv
.
út_num_addrs


	)

175 
	#icmp_w∑
 
icmp_hun
.
ih_πødv
.
út_w∑


	)

176 
	#icmp_li„time
 
icmp_hun
.
ih_πødv
.
út_li„time


	)

181 
u_öt32_t
 
	môs_Ÿime
;

182 
u_öt32_t
 
	môs_πime
;

183 
u_öt32_t
 
	môs_âime
;

184 } 
	mid_ts
;

187 
ù
 
	midi_ù
;

189 } 
	mid_ù
;

190 
icmp_ø_addr
 
	mid_ødv
;

191 
u_öt32_t
 
	mid_mask
;

192 
u_öt8_t
 
	mid_d©a
[1];

193 } 
	micmp_dun
;

194 
	#icmp_Ÿime
 
icmp_dun
.
id_ts
.
ôs_Ÿime


	)

195 
	#icmp_πime
 
icmp_dun
.
id_ts
.
ôs_πime


	)

196 
	#icmp_âime
 
icmp_dun
.
id_ts
.
ôs_âime


	)

197 
	#icmp_ù
 
icmp_dun
.
id_ù
.
idi_ù


	)

198 
	#icmp_ødv
 
icmp_dun
.
id_ødv


	)

199 
	#icmp_mask
 
icmp_dun
.
id_mask


	)

200 
	#icmp_d©a
 
icmp_dun
.
id_d©a


	)

211 
	#ICMP_MINLEN
 8

	)

212 
	#ICMP_TSLEN
 (8 + 3 *  (
n_time
)Ë

	)

213 
	#ICMP_MASKLEN
 12

	)

214 
	#ICMP_ADVLENMIN
 (8 +  (
ù
Ë+ 8Ë

	)

215 #i‚de‡
_IP_VHL


216 
	#ICMP_ADVLEN
(
p
Ë(8 + (’)->
icmp_ù
.
ù_hl
 << 2Ë+ 8)

	)

219 
	#ICMP_ADVLEN
(
p
Ë(8 + (
	`IP_VHL_HL
(’)->
icmp_ù
.
ù_vhl
Ë<< 2Ë+ 8)

	)

225 
	#ICMP_UNREACH
 3

	)

226 
	#ICMP_SOURCEQUENCH
 4

	)

227 
	#ICMP_ROUTERADVERT
 9

	)

228 
	#ICMP_ROUTERSOLICIT
 10

	)

229 
	#ICMP_TIMXCEED
 11

	)

230 
	#ICMP_PARAMPROB
 12

	)

231 
	#ICMP_TSTAMP
 13

	)

232 
	#ICMP_TSTAMPREPLY
 14

	)

233 
	#ICMP_IREQ
 15

	)

234 
	#ICMP_IREQREPLY
 16

	)

235 
	#ICMP_MASKREQ
 17

	)

236 
	#ICMP_MASKREPLY
 18

	)

238 
	#ICMP_MAXTYPE
 18

	)

241 
	#ICMP_UNREACH_NET
 0

	)

242 
	#ICMP_UNREACH_HOST
 1

	)

243 
	#ICMP_UNREACH_PROTOCOL
 2

	)

244 
	#ICMP_UNREACH_PORT
 3

	)

245 
	#ICMP_UNREACH_NEEDFRAG
 4

	)

246 
	#ICMP_UNREACH_SRCFAIL
 5

	)

247 
	#ICMP_UNREACH_NET_UNKNOWN
 6

	)

248 
	#ICMP_UNREACH_HOST_UNKNOWN
 7

	)

249 
	#ICMP_UNREACH_ISOLATED
 8

	)

250 
	#ICMP_UNREACH_NET_PROHIB
 9

	)

251 
	#ICMP_UNREACH_HOST_PROHIB
 10

	)

252 
	#ICMP_UNREACH_TOSNET
 11

	)

253 
	#ICMP_UNREACH_TOSHOST
 12

	)

254 
	#ICMP_UNREACH_FILTER_PROHIB
 13

	)

255 
	#ICMP_UNREACH_HOST_PRECEDENCE
 14

	)

256 
	#ICMP_UNREACH_PRECEDENCE_CUTOFF
 15

	)

259 
	#ICMP_REDIRECT_NET
 0

	)

260 
	#ICMP_REDIRECT_HOST
 1

	)

261 
	#ICMP_REDIRECT_TOSNET
 2

	)

262 
	#ICMP_REDIRECT_TOSHOST
 3

	)

265 
	#ICMP_TIMXCEED_INTRANS
 0

	)

266 
	#ICMP_TIMXCEED_REASS
 1

	)

269 
	#ICMP_PARAMPROB_OPTABSENT
 1

	)

271 
	#ICMP_INFOTYPE
(
ty≥
) \

272 ((
ty≥
Ë=
ICMP_ECHOREPLY
 || (ty≥Ë=
ICMP_ECHO
 || \

273 (
ty≥
Ë=
ICMP_ROUTERADVERT
 || (ty≥Ë=
ICMP_ROUTERSOLICIT
 || \

274 (
ty≥
Ë=
ICMP_TSTAMP
 || (ty≥Ë=
ICMP_TSTAMPREPLY
 || \

275 (
ty≥
Ë=
ICMP_IREQ
 || (ty≥Ë=
ICMP_IREQREPLY
 || \

276 (
ty≥
Ë=
ICMP_MASKREQ
 || (ty≥Ë=
ICMP_MASKREPLY
)

	)

280 
	g__END_DECLS


	@/usr/include/netinet/tcp.h

32 #i‚de‡
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<„©uªs.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

54 
	#TCP_COOKIE_TRANSACTIONS
 15

	)

55 
	#TCP_THIN_LINEAR_TIMEOUTS
 16

	)

56 
	#TCP_THIN_DUPACK
 17

	)

57 
	#TCP_USER_TIMEOUT
 18

	)

58 
	#TCP_REPAIR
 19

	)

59 
	#TCP_REPAIR_QUEUE
 20

	)

60 
	#TCP_QUEUE_SEQ
 21

	)

61 
	#TCP_REPAIR_OPTIONS
 22

	)

62 
	#TCP_FASTOPEN
 23

	)

63 
	#TCP_TIMESTAMP
 24

	)

65 #ifde‡
__USE_MISC


66 
	~<sys/ty≥s.h
>

67 
	~<sys/sockë.h
>

69 
u_öt32_t
 
	tt˝_£q
;

74 
	st˝hdr


76 
__exãnsi⁄__
 union

80 
u_öt16_t
 
	mth_•‹t
;

81 
u_öt16_t
 
	mth_dp‹t
;

82 
t˝_£q
 
	mth_£q
;

83 
t˝_£q
 
	mth_ack
;

84 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


85 
u_öt8_t
 
	mth_x2
:4;

86 
u_öt8_t
 
	mth_off
:4;

88 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


89 
u_öt8_t
 
	mth_off
:4;

90 
u_öt8_t
 
	mth_x2
:4;

92 
u_öt8_t
 
	mth_Êags
;

93 
	#TH_FIN
 0x01

	)

94 
	#TH_SYN
 0x02

	)

95 
	#TH_RST
 0x04

	)

96 
	#TH_PUSH
 0x08

	)

97 
	#TH_ACK
 0x10

	)

98 
	#TH_URG
 0x20

	)

99 
u_öt16_t
 
	mth_wö
;

100 
u_öt16_t
 
	mth_sum
;

101 
u_öt16_t
 
	mth_uΩ
;

105 
u_öt16_t
 
	msour˚
;

106 
u_öt16_t
 
	mde°
;

107 
u_öt32_t
 
	m£q
;

108 
u_öt32_t
 
	mack_£q
;

109 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


110 
u_öt16_t
 
	mªs1
:4;

111 
u_öt16_t
 
	mdoff
:4;

112 
u_öt16_t
 
	mfö
:1;

113 
u_öt16_t
 
	msyn
:1;

114 
u_öt16_t
 
	mr°
:1;

115 
u_öt16_t
 
	mpsh
:1;

116 
u_öt16_t
 
	mack
:1;

117 
u_öt16_t
 
	murg
:1;

118 
u_öt16_t
 
	mªs2
:2;

119 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


120 
u_öt16_t
 
	mdoff
:4;

121 
u_öt16_t
 
	mªs1
:4;

122 
u_öt16_t
 
	mªs2
:2;

123 
u_öt16_t
 
	murg
:1;

124 
u_öt16_t
 
	mack
:1;

125 
u_öt16_t
 
	mpsh
:1;

126 
u_öt16_t
 
	mr°
:1;

127 
u_öt16_t
 
	msyn
:1;

128 
u_öt16_t
 
	mfö
:1;

132 
u_öt16_t
 
	mwödow
;

133 
u_öt16_t
 
	mcheck
;

134 
u_öt16_t
 
	murg_±r
;

141 
	mTCP_ESTABLISHED
 = 1,

142 
	mTCP_SYN_SENT
,

143 
	mTCP_SYN_RECV
,

144 
	mTCP_FIN_WAIT1
,

145 
	mTCP_FIN_WAIT2
,

146 
	mTCP_TIME_WAIT
,

147 
	mTCP_CLOSE
,

148 
	mTCP_CLOSE_WAIT
,

149 
	mTCP_LAST_ACK
,

150 
	mTCP_LISTEN
,

151 
	mTCP_CLOSING


154 
	#TCPOPT_EOL
 0

	)

155 
	#TCPOPT_NOP
 1

	)

156 
	#TCPOPT_MAXSEG
 2

	)

157 
	#TCPOLEN_MAXSEG
 4

	)

158 
	#TCPOPT_WINDOW
 3

	)

159 
	#TCPOLEN_WINDOW
 3

	)

160 
	#TCPOPT_SACK_PERMITTED
 4

	)

161 
	#TCPOLEN_SACK_PERMITTED
 2

	)

162 
	#TCPOPT_SACK
 5

	)

163 
	#TCPOPT_TIMESTAMP
 8

	)

164 
	#TCPOLEN_TIMESTAMP
 10

	)

165 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2Ë

	)

167 
	#TCPOPT_TSTAMP_HDR
 \

168 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

176 
	#TCP_MSS
 512

	)

178 
	#TCP_MAXWIN
 65535

	)

180 
	#TCP_MAX_WINSHIFT
 14

	)

182 
	#SOL_TCP
 6

	)

185 
	#TCPI_OPT_TIMESTAMPS
 1

	)

186 
	#TCPI_OPT_SACK
 2

	)

187 
	#TCPI_OPT_WSCALE
 4

	)

188 
	#TCPI_OPT_ECN
 8

	)

189 
	#TCPI_OPT_ECN_SEEN
 16

	)

190 
	#TCPI_OPT_SYN_DATA
 32

	)

193 
	et˝_ˇ_°©e


195 
	mTCP_CA_O≥n
 = 0,

196 
	mTCP_CA_Dis‹dî
 = 1,

197 
	mTCP_CA_CWR
 = 2,

198 
	mTCP_CA_Recovîy
 = 3,

199 
	mTCP_CA_Loss
 = 4

202 
	st˝_öfo


204 
u_öt8_t
 
	mt˝i_°©e
;

205 
u_öt8_t
 
	mt˝i_ˇ_°©e
;

206 
u_öt8_t
 
	mt˝i_ªå™smôs
;

207 
u_öt8_t
 
	mt˝i_¥obes
;

208 
u_öt8_t
 
	mt˝i_backoff
;

209 
u_öt8_t
 
	mt˝i_›ti⁄s
;

210 
u_öt8_t
 
	mt˝i_¢d_wsˇÀ
 : 4, 
	mt˝i_rcv_wsˇÀ
 : 4;

212 
u_öt32_t
 
	mt˝i_πo
;

213 
u_öt32_t
 
	mt˝i_©o
;

214 
u_öt32_t
 
	mt˝i_¢d_mss
;

215 
u_öt32_t
 
	mt˝i_rcv_mss
;

217 
u_öt32_t
 
	mt˝i_u«cked
;

218 
u_öt32_t
 
	mt˝i_ßcked
;

219 
u_öt32_t
 
	mt˝i_lo°
;

220 
u_öt32_t
 
	mt˝i_ªå™s
;

221 
u_öt32_t
 
	mt˝i_Áckës
;

224 
u_öt32_t
 
	mt˝i_œ°_d©a_£¡
;

225 
u_öt32_t
 
	mt˝i_œ°_ack_£¡
;

226 
u_öt32_t
 
	mt˝i_œ°_d©a_ªcv
;

227 
u_öt32_t
 
	mt˝i_œ°_ack_ªcv
;

230 
u_öt32_t
 
	mt˝i_pmtu
;

231 
u_öt32_t
 
	mt˝i_rcv_s°hªsh
;

232 
u_öt32_t
 
	mt˝i_πt
;

233 
u_öt32_t
 
	mt˝i_πtv¨
;

234 
u_öt32_t
 
	mt˝i_¢d_s°hªsh
;

235 
u_öt32_t
 
	mt˝i_¢d_cwnd
;

236 
u_öt32_t
 
	mt˝i_advmss
;

237 
u_öt32_t
 
	mt˝i_ª‹dîög
;

239 
u_öt32_t
 
	mt˝i_rcv_πt
;

240 
u_öt32_t
 
	mt˝i_rcv_•a˚
;

242 
u_öt32_t
 
	mt˝i_tŸÆ_ªå™s
;

247 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

249 
	st˝_md5sig


251 
sockaddr_°‹age
 
	mt˝m_addr
;

252 
u_öt16_t
 
	m__t˝m_∑d1
;

253 
u_öt16_t
 
	mt˝m_keyÀn
;

254 
u_öt32_t
 
	m__t˝m_∑d2
;

255 
u_öt8_t
 
	mt˝m_key
[
TCP_MD5SIG_MAXKEYLEN
];

259 
	st˝_ª∑ú_›t


261 
u_öt32_t
 
	m›t_code
;

262 
u_öt32_t
 
	m›t_vÆ
;

268 
	mTCP_NO_QUEUE
,

269 
	mTCP_RECV_QUEUE
,

270 
	mTCP_SEND_QUEUE
,

271 
	mTCP_QUEUES_NR
,

275 
	#TCP_COOKIE_MIN
 8

	)

276 
	#TCP_COOKIE_MAX
 16

	)

277 
	#TCP_COOKIE_PAIR_SIZE
 (2*
TCP_COOKIE_MAX
)

	)

280 
	#TCP_COOKIE_IN_ALWAYS
 (1 << 0Ë

	)

281 
	#TCP_COOKIE_OUT_NEVER
 (1 << 1Ë

	)

285 
	#TCP_S_DATA_IN
 (1 << 2Ë

	)

286 
	#TCP_S_DATA_OUT
 (1 << 3Ë

	)

288 
	#TCP_MSS_DEFAULT
 536U

	)

289 
	#TCP_MSS_DESIRED
 1220U

	)

291 
	st˝_cookõ_å™ß˘i⁄s


293 
u_öt16_t
 
	mt˝˘_Êags
;

294 
u_öt8_t
 
	m__t˝˘_∑d1
;

295 
u_öt8_t
 
	mt˝˘_cookõ_desúed
;

296 
u_öt16_t
 
	mt˝˘_s_d©a_desúed
;

297 
u_öt16_t
 
	mt˝˘_u£d
;

298 
u_öt8_t
 
	mt˝˘_vÆue
[
TCP_MSS_DEFAULT
];

	@/usr/include/netinet/udp.h

47 #i‚de‡
__NETINET_UDP_H


48 
	#__NETINET_UDP_H
 1

	)

50 
	~<„©uªs.h
>

51 
	~<sys/ty≥s.h
>

56 
	sudphdr


58 
__exãnsi⁄__
 union

62 
u_öt16_t
 
	muh_•‹t
;

63 
u_öt16_t
 
	muh_dp‹t
;

64 
u_öt16_t
 
	muh_uÀn
;

65 
u_öt16_t
 
	muh_sum
;

69 
u_öt16_t
 
	msour˚
;

70 
u_öt16_t
 
	mde°
;

71 
u_öt16_t
 
	mÀn
;

72 
u_öt16_t
 
	mcheck
;

78 
	#UDP_CORK
 1

	)

79 
	#UDP_ENCAP
 100

	)

83 
	#UDP_ENCAP_ESPINUDP_NON_IKE
 1

	)

84 
	#UDP_ENCAP_ESPINUDP
 2

	)

85 
	#UDP_ENCAP_L2TPINUDP
 3

	)

87 
	#SOL_UDP
 17

	)

	@/usr/include/pthread.h

18 #i‚de‡
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<ídün.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<bôs/±hªadty≥s.h
>

27 
	~<bôs/£tjmp.h
>

28 
	~<bôs/w‹dsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifde‡
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifde‡
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


86 #i‡
__PTHREAD_MUTEX_HAVE_ELISION
 == 1

87 
	#__PTHREAD_SPINS
 0, 0

	)

88 #ñi‡
__PTHREAD_MUTEX_HAVE_ELISION
 == 2

89 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

91 
	#__PTHREAD_SPINS
 0

	)

94 #ifde‡
__PTHREAD_MUTEX_HAVE_PREV


95 
	#PTHREAD_MUTEX_INITIALIZER
 \

96 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

97 #ifde‡
__USE_GNU


98 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

99 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

100 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

101 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

102 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

104 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

109 
	#PTHREAD_MUTEX_INITIALIZER
 \

110 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

111 #ifde‡
__USE_GNU


112 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

113 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

115 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

116 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

117 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

124 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


127 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

128 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

129 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

130 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


136 #i‚de‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 #i‡
__WORDSIZE
 == 64

138 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

143 
	#PTHREAD_RWLOCK_INITIALIZER
 \

144 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

145 #ifde‡
__USE_GNU


146 #ifde‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


147 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

149 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

151 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


152 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

153 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

154 0, 0, 0, 0 } }

	)

156 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

157 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

158 0 } }

	)

168 
	mPTHREAD_INHERIT_SCHED
,

169 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

170 
	mPTHREAD_EXPLICIT_SCHED


171 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

178 
	mPTHREAD_SCOPE_SYSTEM
,

179 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

180 
	mPTHREAD_SCOPE_PROCESS


181 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

188 
	mPTHREAD_PROCESS_PRIVATE
,

189 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

190 
	mPTHREAD_PROCESS_SHARED


191 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

197 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*Ë0, 0, 0 } }

	)

201 
	s_±hªad_˛ónup_buf„r


203 (*
	m__routöe
) (*);

204 *
	m__¨g
;

205 
	m__ˇn˚…y≥
;

206 
_±hªad_˛ónup_buf„r
 *
	m__¥ev
;

212 
	mPTHREAD_CANCEL_ENABLE
,

213 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

214 
	mPTHREAD_CANCEL_DISABLE


215 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

219 
	mPTHREAD_CANCEL_DEFERRED
,

220 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

221 
	mPTHREAD_CANCEL_ASYNCHRONOUS


222 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

224 
	#PTHREAD_CANCELED
 ((*Ë-1)

	)

228 
	#PTHREAD_ONCE_INIT
 0

	)

231 #ifde‡
__USE_XOPEN2K


235 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

239 
__BEGIN_DECLS


244 
±hªad_¸óã
 (
±hªad_t
 *
__ª°ri˘
 
__√wthªad
,

245 c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

246 *(*
__°¨t_routöe
) (*),

247 *
__ª°ri˘
 
__¨g
Ë
__THROWNL
 
__n⁄nuŒ
 ((1, 3));

253 
	$±hªad_exô
 (*
__ªtvÆ
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

261 
	`±hªad_joö
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
);

263 #ifde‡
__USE_GNU


266 
	$±hªad_åyjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
Ë
__THROW
;

274 
	`±hªad_timedjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
,

275 c⁄° 
time•ec
 *
__ab°ime
);

282 
	$±hªad_dëach
 (
±hªad_t
 
__th
Ë
__THROW
;

286 
±hªad_t
 
	$±hªad_£lf
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

289 
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
)

290 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

298 
	$±hªad_©å_öô
 (
±hªad_©å_t
 *
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

301 
	$±hªad_©å_de°roy
 (
±hªad_©å_t
 *
__©å
)

302 
__THROW
 
	`__n⁄nuŒ
 ((1));

305 
	$±hªad_©å_gëdëach°©e
 (c⁄° 
±hªad_©å_t
 *
__©å
,

306 *
__dëach°©e
)

307 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

310 
	$±hªad_©å_£tdëach°©e
 (
±hªad_©å_t
 *
__©å
,

311 
__dëach°©e
)

312 
__THROW
 
	`__n⁄nuŒ
 ((1));

316 
	$±hªad_©å_gëgu¨dsize
 (c⁄° 
±hªad_©å_t
 *
__©å
,

317 
size_t
 *
__gu¨dsize
)

318 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

321 
	$±hªad_©å_£tgu¨dsize
 (
±hªad_©å_t
 *
__©å
,

322 
size_t
 
__gu¨dsize
)

323 
__THROW
 
	`__n⁄nuŒ
 ((1));

327 
	$±hªad_©å_gësched∑øm
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

328 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

329 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

332 
	$±hªad_©å_£tsched∑øm
 (
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

333 c⁄° 
sched_∑øm
 *
__ª°ri˘


334 
__∑øm
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

337 
	$±hªad_©å_gëschedpﬁicy
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


338 
__©å
, *
__ª°ri˘
 
__pﬁicy
)

339 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

342 
	$±hªad_©å_£tschedpﬁicy
 (
±hªad_©å_t
 *
__©å
, 
__pﬁicy
)

343 
__THROW
 
	`__n⁄nuŒ
 ((1));

346 
	$±hªad_©å_gëöhîôsched
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


347 
__©å
, *
__ª°ri˘
 
__öhîô
)

348 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

351 
	$±hªad_©å_£töhîôsched
 (
±hªad_©å_t
 *
__©å
,

352 
__öhîô
)

353 
__THROW
 
	`__n⁄nuŒ
 ((1));

357 
	$±hªad_©å_gësc›e
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

358 *
__ª°ri˘
 
__sc›e
)

359 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

362 
	$±hªad_©å_£tsc›e
 (
±hªad_©å_t
 *
__©å
, 
__sc›e
)

363 
__THROW
 
	`__n⁄nuŒ
 ((1));

366 
	$±hªad_©å_gë°ackaddr
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


367 
__©å
, **
__ª°ri˘
 
__°ackaddr
)

368 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__©åibuã_dïªˇãd__
;

374 
	$±hªad_©å_£t°ackaddr
 (
±hªad_©å_t
 *
__©å
,

375 *
__°ackaddr
)

376 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
;

379 
	$±hªad_©å_gë°acksize
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


380 
__©å
, 
size_t
 *
__ª°ri˘
 
__°acksize
)

381 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

386 
	$±hªad_©å_£t°acksize
 (
±hªad_©å_t
 *
__©å
,

387 
size_t
 
__°acksize
)

388 
__THROW
 
	`__n⁄nuŒ
 ((1));

390 #ifde‡
__USE_XOPEN2K


392 
	$±hªad_©å_gë°ack
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

393 **
__ª°ri˘
 
__°ackaddr
,

394 
size_t
 *
__ª°ri˘
 
__°acksize
)

395 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

400 
	$±hªad_©å_£t°ack
 (
±hªad_©å_t
 *
__©å
, *
__°ackaddr
,

401 
size_t
 
__°acksize
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

404 #ifde‡
__USE_GNU


407 
	$±hªad_©å_£èfföôy_≈
 (
±hªad_©å_t
 *
__©å
,

408 
size_t
 
__˝u£tsize
,

409 c⁄° 
˝u_£t_t
 *
__˝u£t
)

410 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

414 
	$±hªad_©å_gëafföôy_≈
 (c⁄° 
±hªad_©å_t
 *
__©å
,

415 
size_t
 
__˝u£tsize
,

416 
˝u_£t_t
 *
__˝u£t
)

417 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

420 
	$±hªad_gë©å_deÁu…_≈
 (
±hªad_©å_t
 *
__©å
)

421 
__THROW
 
	`__n⁄nuŒ
 ((1));

425 
	$±hªad_£èâr_deÁu…_≈
 (c⁄° 
±hªad_©å_t
 *
__©å
)

426 
__THROW
 
	`__n⁄nuŒ
 ((1));

431 
	$±hªad_gë©å_≈
 (
±hªad_t
 
__th
, 
±hªad_©å_t
 *
__©å
)

432 
__THROW
 
	`__n⁄nuŒ
 ((2));

440 
	$±hªad_£tsched∑øm
 (
±hªad_t
 
__èrgë_thªad
, 
__pﬁicy
,

441 c⁄° 
sched_∑øm
 *
__∑øm
)

442 
__THROW
 
	`__n⁄nuŒ
 ((3));

445 
	$±hªad_gësched∑øm
 (
±hªad_t
 
__èrgë_thªad
,

446 *
__ª°ri˘
 
__pﬁicy
,

447 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

448 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

451 
	$±hªad_£tsched¥io
 (
±hªad_t
 
__èrgë_thªad
, 
__¥io
)

452 
__THROW
;

455 #ifde‡
__USE_GNU


457 
	$±hªad_gë«me_≈
 (
±hªad_t
 
__èrgë_thªad
, *
__buf
,

458 
size_t
 
__buÊí
)

459 
__THROW
 
	`__n⁄nuŒ
 ((2));

462 
	$±hªad_£äame_≈
 (
±hªad_t
 
__èrgë_thªad
, c⁄° *
__«me
)

463 
__THROW
 
	`__n⁄nuŒ
 ((2));

467 #ifde‡
__USE_UNIX98


469 
	$±hªad_gëc⁄cuºícy
 (Ë
__THROW
;

472 
	$±hªad_£tc⁄cuºícy
 (
__Àvñ
Ë
__THROW
;

475 #ifde‡
__USE_GNU


480 
	$±hªad_yõld
 (Ë
__THROW
;

485 
	$±hªad_£èfföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

486 c⁄° 
˝u_£t_t
 *
__˝u£t
)

487 
__THROW
 
	`__n⁄nuŒ
 ((3));

490 
	$±hªad_gëafföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

491 
˝u_£t_t
 *
__˝u£t
)

492 
__THROW
 
	`__n⁄nuŒ
 ((3));

505 
	`±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

506 (*
__öô_routöe
Ë()Ë
	`__n⁄nuŒ
 ((1, 2));

517 
	`±hªad_£tˇn˚l°©e
 (
__°©e
, *
__ﬁd°©e
);

521 
	`±hªad_£tˇn˚…y≥
 (
__ty≥
, *
__ﬁdty≥
);

524 
	`±hªad_ˇn˚l
 (
±hªad_t
 
__th
);

529 
	`±hªad_ã°ˇn˚l
 ();

538 
__jmp_buf
 
__ˇn˚l_jmp_buf
;

539 
__mask_was_ßved
;

540 } 
__ˇn˚l_jmp_buf
[1];

541 *
__∑d
[4];

542 } 
	t__±hªad_unwöd_buf_t
 
	t__©åibuã__
 ((
	t__Æig√d__
));

545 #i‚de‡
__˛ónup_f˘_©åibuã


546 
	#__˛ónup_f˘_©åibuã


	)

551 
	s__±hªad_˛ónup_‰ame


553 (*
__ˇn˚l_routöe
) (*);

554 *
__ˇn˚l_¨g
;

555 
__do_ô
;

556 
__ˇn˚l_ty≥
;

559 #i‡
deföed
 
__GNUC__
 && deföed 
__EXCEPTIONS


560 #ifde‡
__˝lu•lus


562 ˛as†
	c__±hªad_˛ónup_˛ass


564 (*
__ˇn˚l_routöe
) (*);

565 *
__ˇn˚l_¨g
;

566 
__do_ô
;

567 
__ˇn˚l_ty≥
;

569 
public
:

570 
	`__±hªad_˛ónup_˛ass
 ((*
__f˘
Ë(*), *
__¨g
)

571 : 
	`__ˇn˚l_routöe
 (
__f˘
), 
	`__ˇn˚l_¨g
 (
__¨g
), 
	$__do_ô
 (1) { }

572 ~
	$__±hªad_˛ónup_˛ass
 (Ë{ i‡(
__do_ô
Ë
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); 
	}
}

573 
	$__£tdoô
 (
__√wvÆ
Ë{ 
__do_ô
 = __√wvÆ; 
	}
}

574 
	$__de„r
 (Ë{ 
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
,

575 &
__ˇn˚l_ty≥
); 
	}
}

576 
	$__ª°‹e
 (Ëc⁄° { 
	`±hªad_£tˇn˚…y≥
 (
__ˇn˚l_ty≥
, 0); 
	}
}

586 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

588 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
)

	)

592 
	#±hªad_˛ónup_p›
(
execuã
) \

593 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

594 } 0)

	)

596 #ifde‡
__USE_GNU


600 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

602 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
); \

603 
__˛‰ame
.
	`__de„r
 ()

	)

608 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

609 
__˛‰ame
.
	`__ª°‹e
 (); \

610 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

611 } 0)

	)

618 
__exã∫_ölöe
 

619 
	$__±hªad_˛ónup_routöe
 (
__±hªad_˛ónup_‰ame
 *
__‰ame
)

621 i‡(
__‰ame
->
__do_ô
)

622 
__‰ame
->
	`__ˇn˚l_routöe
 (__‰ame->
__ˇn˚l_¨g
);

623 
	}
}

632 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

634 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

635 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

636 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

637 .
__do_ô
 = 1 };

	)

641 
	#±hªad_˛ónup_p›
(
execuã
) \

642 
__˛‰ame
.
__do_ô
 = (
execuã
); \

643 } 0)

	)

645 #ifde‡
__USE_GNU


649 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

651 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

652 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

653 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

654 .
__do_ô
 = 1 }; \

655 (Ë
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
, \

656 &
__˛‰ame
.
__ˇn˚l_ty≥
)

	)

661 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

662 (Ë
	`±hªad_£tˇn˚…y≥
 (
__˛‰ame
.
__ˇn˚l_ty≥
, 
NULL
); \

663 
__˛‰ame
.
__do_ô
 = (
execuã
); \

664 } 0)

	)

675 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

677 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

678 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

679 *
__ˇn˚l_¨g
 = (
¨g
); \

680 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

681 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

682 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

684 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

685 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

689 
	`__±hªad_ªgi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

690 dÿ{

	)

691 
__±hªad_ªgi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

692 
__˛ónup_f˘_©åibuã
;

696 
	#±hªad_˛ónup_p›
(
execuã
) \

699 
	`__±hªad_uƒegi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

700 i‡(
execuã
) \

701 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

702 } 0)

	)

703 
	$__±hªad_uƒegi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

704 
__˛ónup_f˘_©åibuã
;

706 #ifde‡
__USE_GNU


710 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

712 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

713 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

714 *
__ˇn˚l_¨g
 = (
¨g
); \

715 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

716 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

717 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

719 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

720 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

724 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (&
__ˇn˚l_buf
); \

725 dÿ{

	)

726 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (
__±hªad_unwöd_buf_t
 *
__buf
)

727 
__˛ónup_f˘_©åibuã
;

732 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

735 
	`__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (&
__ˇn˚l_buf
); \

736 i‡(
execuã
) \

737 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

738 
	}
} 0)

	)

739 
	$__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (
__±hªad_unwöd_buf_t
 *
__buf
)

740 
__˛ónup_f˘_©åibuã
;

744 
	$__±hªad_unwöd_√xt
 (
__±hªad_unwöd_buf_t
 *
__buf
)

745 
__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
__n‹ëu∫__
))

746 #i‚de‡
SHARED


747 
	`__©åibuã__
 ((
__wók__
))

753 
__jmp_buf_èg
;

754 
	$__sig£tjmp
 (
__jmp_buf_èg
 *
__ív
, 
__ßvemask
Ë
__THROWNL
;

760 
	$±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

761 c⁄° 
±hªad_muãx©å_t
 *
__muãx©å
)

762 
__THROW
 
	`__n⁄nuŒ
 ((1));

765 
	$±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
)

766 
__THROW
 
	`__n⁄nuŒ
 ((1));

769 
	$±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
)

770 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

773 
	$±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
)

774 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

776 #ifde‡
__USE_XOPEN2K


778 
	$±hªad_muãx_timedlock
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

779 c⁄° 
time•ec
 *
__ª°ri˘


780 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

784 
	$±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
)

785 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

789 
	$±hªad_muãx_gë¥io˚ûög
 (c⁄° 
±hªad_muãx_t
 *

790 
__ª°ri˘
 
__muãx
,

791 *
__ª°ri˘
 
__¥io˚ûög
)

792 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

796 
	$±hªad_muãx_£çrio˚ûög
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

797 
__¥io˚ûög
,

798 *
__ª°ri˘
 
__ﬁd_˚ûög
)

799 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

802 #ifde‡
__USE_XOPEN2K8


804 
	$±hªad_muãx_c⁄si°ít
 (
±hªad_muãx_t
 *
__muãx
)

805 
__THROW
 
	`__n⁄nuŒ
 ((1));

806 #ifde‡
__USE_GNU


807 
	$±hªad_muãx_c⁄si°ít_≈
 (
±hªad_muãx_t
 *
__muãx
)

808 
__THROW
 
	`__n⁄nuŒ
 ((1));

817 
	$±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
)

818 
__THROW
 
	`__n⁄nuŒ
 ((1));

821 
	$±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
)

822 
__THROW
 
	`__n⁄nuŒ
 ((1));

825 
	$±hªad_muãx©å_gëpsh¨ed
 (c⁄° 
±hªad_muãx©å_t
 *

826 
__ª°ri˘
 
__©å
,

827 *
__ª°ri˘
 
__psh¨ed
)

828 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

831 
	$±hªad_muãx©å_£çsh¨ed
 (
±hªad_muãx©å_t
 *
__©å
,

832 
__psh¨ed
)

833 
__THROW
 
	`__n⁄nuŒ
 ((1));

835 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


837 
	$±hªad_muãx©å_gëty≥
 (c⁄° 
±hªad_muãx©å_t
 *
__ª°ri˘


838 
__©å
, *
__ª°ri˘
 
__köd
)

839 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

844 
	$±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
, 
__köd
)

845 
__THROW
 
	`__n⁄nuŒ
 ((1));

849 
	$±hªad_muãx©å_gë¥Ÿocﬁ
 (c⁄° 
±hªad_muãx©å_t
 *

850 
__ª°ri˘
 
__©å
,

851 *
__ª°ri˘
 
__¥Ÿocﬁ
)

852 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

856 
	$±hªad_muãx©å_£çrŸocﬁ
 (
±hªad_muãx©å_t
 *
__©å
,

857 
__¥Ÿocﬁ
)

858 
__THROW
 
	`__n⁄nuŒ
 ((1));

861 
	$±hªad_muãx©å_gë¥io˚ûög
 (c⁄° 
±hªad_muãx©å_t
 *

862 
__ª°ri˘
 
__©å
,

863 *
__ª°ri˘
 
__¥io˚ûög
)

864 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

867 
	$±hªad_muãx©å_£çrio˚ûög
 (
±hªad_muãx©å_t
 *
__©å
,

868 
__¥io˚ûög
)

869 
__THROW
 
	`__n⁄nuŒ
 ((1));

871 #ifde‡
__USE_XOPEN2K


873 
	$±hªad_muãx©å_gërobu°
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

874 *
__robu°√ss
)

875 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

876 #ifde‡
__USE_GNU


877 
	$±hªad_muãx©å_gërobu°_≈
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

878 *
__robu°√ss
)

879 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

883 
	$±hªad_muãx©å_£åobu°
 (
±hªad_muãx©å_t
 *
__©å
,

884 
__robu°√ss
)

885 
__THROW
 
	`__n⁄nuŒ
 ((1));

886 #ifde‡
__USE_GNU


887 
	$±hªad_muãx©å_£åobu°_≈
 (
±hªad_muãx©å_t
 *
__©å
,

888 
__robu°√ss
)

889 
__THROW
 
	`__n⁄nuŒ
 ((1));

894 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


899 
	$±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

900 c⁄° 
±hªad_rwlock©å_t
 *
__ª°ri˘


901 
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

904 
	$±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
)

905 
__THROW
 
	`__n⁄nuŒ
 ((1));

908 
	$±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

909 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

912 
	$±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

913 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

915 #ifde‡
__USE_XOPEN2K


917 
	$±hªad_rwlock_timedrdlock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

918 c⁄° 
time•ec
 *
__ª°ri˘


919 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

923 
	$±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
)

924 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

927 
	$±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
)

928 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

930 #ifde‡
__USE_XOPEN2K


932 
	$±hªad_rwlock_timedwæock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

933 c⁄° 
time•ec
 *
__ª°ri˘


934 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

938 
	$±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
)

939 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

945 
	$±hªad_rwlock©å_öô
 (
±hªad_rwlock©å_t
 *
__©å
)

946 
__THROW
 
	`__n⁄nuŒ
 ((1));

949 
	$±hªad_rwlock©å_de°roy
 (
±hªad_rwlock©å_t
 *
__©å
)

950 
__THROW
 
	`__n⁄nuŒ
 ((1));

953 
	$±hªad_rwlock©å_gëpsh¨ed
 (c⁄° 
±hªad_rwlock©å_t
 *

954 
__ª°ri˘
 
__©å
,

955 *
__ª°ri˘
 
__psh¨ed
)

956 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

959 
	$±hªad_rwlock©å_£çsh¨ed
 (
±hªad_rwlock©å_t
 *
__©å
,

960 
__psh¨ed
)

961 
__THROW
 
	`__n⁄nuŒ
 ((1));

964 
	$±hªad_rwlock©å_gëköd_≈
 (c⁄° 
±hªad_rwlock©å_t
 *

965 
__ª°ri˘
 
__©å
,

966 *
__ª°ri˘
 
__¥ef
)

967 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

970 
	$±hªad_rwlock©å_£tköd_≈
 (
±hªad_rwlock©å_t
 *
__©å
,

971 
__¥ef
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

979 
	$±hªad_c⁄d_öô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

980 c⁄° 
±hªad_c⁄d©å_t
 *
__ª°ri˘
 
__c⁄d_©å
)

981 
__THROW
 
	`__n⁄nuŒ
 ((1));

984 
	$±hªad_c⁄d_de°roy
 (
±hªad_c⁄d_t
 *
__c⁄d
)

985 
__THROW
 
	`__n⁄nuŒ
 ((1));

988 
	$±hªad_c⁄d_sig«l
 (
±hªad_c⁄d_t
 *
__c⁄d
)

989 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

992 
	$±hªad_c⁄d_brﬂdˇ°
 (
±hªad_c⁄d_t
 *
__c⁄d
)

993 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1000 
	$±hªad_c⁄d_waô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

1001 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
)

1002 
	`__n⁄nuŒ
 ((1, 2));

1011 
	$±hªad_c⁄d_timedwaô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

1012 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

1013 c⁄° 
time•ec
 *
__ª°ri˘
 
__ab°ime
)

1014 
	`__n⁄nuŒ
 ((1, 2, 3));

1019 
	$±hªad_c⁄d©å_öô
 (
±hªad_c⁄d©å_t
 *
__©å
)

1020 
__THROW
 
	`__n⁄nuŒ
 ((1));

1023 
	$±hªad_c⁄d©å_de°roy
 (
±hªad_c⁄d©å_t
 *
__©å
)

1024 
__THROW
 
	`__n⁄nuŒ
 ((1));

1027 
	$±hªad_c⁄d©å_gëpsh¨ed
 (c⁄° 
±hªad_c⁄d©å_t
 *

1028 
__ª°ri˘
 
__©å
,

1029 *
__ª°ri˘
 
__psh¨ed
)

1030 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1033 
	$±hªad_c⁄d©å_£çsh¨ed
 (
±hªad_c⁄d©å_t
 *
__©å
,

1034 
__psh¨ed
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1036 #ifde‡
__USE_XOPEN2K


1038 
	$±hªad_c⁄d©å_gë˛ock
 (c⁄° 
±hªad_c⁄d©å_t
 *

1039 
__ª°ri˘
 
__©å
,

1040 
__˛ockid_t
 *
__ª°ri˘
 
__˛ock_id
)

1041 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1044 
	$±hªad_c⁄d©å_£t˛ock
 (
±hªad_c⁄d©å_t
 *
__©å
,

1045 
__˛ockid_t
 
__˛ock_id
)

1046 
__THROW
 
	`__n⁄nuŒ
 ((1));

1050 #ifde‡
__USE_XOPEN2K


1055 
	$±hªad_•ö_öô
 (
±hªad_•ölock_t
 *
__lock
, 
__psh¨ed
)

1056 
__THROW
 
	`__n⁄nuŒ
 ((1));

1059 
	$±hªad_•ö_de°roy
 (
±hªad_•ölock_t
 *
__lock
)

1060 
__THROW
 
	`__n⁄nuŒ
 ((1));

1063 
	$±hªad_•ö_lock
 (
±hªad_•ölock_t
 *
__lock
)

1064 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1067 
	$±hªad_•ö_åylock
 (
±hªad_•ölock_t
 *
__lock
)

1068 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1071 
	$±hªad_•ö_u∆ock
 (
±hªad_•ölock_t
 *
__lock
)

1072 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1079 
	$±hªad_b¨rõr_öô
 (
±hªad_b¨rõr_t
 *
__ª°ri˘
 
__b¨rõr
,

1080 c⁄° 
±hªad_b¨rõøâr_t
 *
__ª°ri˘


1081 
__©å
, 
__cou¡
)

1082 
__THROW
 
	`__n⁄nuŒ
 ((1));

1085 
	$±hªad_b¨rõr_de°roy
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1086 
__THROW
 
	`__n⁄nuŒ
 ((1));

1089 
	$±hªad_b¨rõr_waô
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1090 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1094 
	$±hªad_b¨rõøâr_öô
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1095 
__THROW
 
	`__n⁄nuŒ
 ((1));

1098 
	$±hªad_b¨rõøâr_de°roy
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1099 
__THROW
 
	`__n⁄nuŒ
 ((1));

1102 
	$±hªad_b¨rõøâr_gëpsh¨ed
 (c⁄° 
±hªad_b¨rõøâr_t
 *

1103 
__ª°ri˘
 
__©å
,

1104 *
__ª°ri˘
 
__psh¨ed
)

1105 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1108 
	$±hªad_b¨rõøâr_£çsh¨ed
 (
±hªad_b¨rõøâr_t
 *
__©å
,

1109 
__psh¨ed
)

1110 
__THROW
 
	`__n⁄nuŒ
 ((1));

1122 
	`±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

1123 (*
__de°r_fun˘i⁄
) (*))

1124 
__THROW
 
	`__n⁄nuŒ
 ((1));

1127 
	$±hªad_key_dñëe
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1130 *
	$±hªad_gë•ecific
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1133 
	$±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

1134 c⁄° *
__poöãr
Ë
__THROW
 ;

1137 #ifde‡
__USE_XOPEN2K


1139 
	$±hªad_gë˝u˛ockid
 (
±hªad_t
 
__thªad_id
,

1140 
__˛ockid_t
 *
__˛ock_id
)

1141 
__THROW
 
	`__n⁄nuŒ
 ((2));

1156 
	`±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1157 (*
__∑ª¡
) (),

1158 (*
__chûd
Ë()Ë
__THROW
;

1161 #ifde‡
__USE_EXTERN_INLINES


1163 
__exã∫_ölöe
 

1164 
	`__NTH
 (
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
))

1166  
__thªad1
 =
__thªad2
;

1167 
	}
}

1170 
	g__END_DECLS


	@/usr/include/pwd.h

22 #i‚def 
_PWD_H


23 
	#_PWD_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ty≥s.h
>

31 
	#__√ed_size_t


	)

32 
	~<°ddef.h
>

34 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


37 #i‚de‡
__gid_t_deföed


38 
__gid_t
 
	tgid_t
;

39 
	#__gid_t_deföed


	)

42 #i‚de‡
__uid_t_deföed


43 
__uid_t
 
	tuid_t
;

44 
	#__uid_t_deföed


	)

49 
	s∑sswd


51 *
	mpw_«me
;

52 *
	mpw_∑sswd
;

53 
__uid_t
 
	mpw_uid
;

54 
__gid_t
 
	mpw_gid
;

55 *
	mpw_gecos
;

56 *
	mpw_dú
;

57 *
	mpw_shñl
;

61 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_GNU


62 
	#__√ed_FILE


	)

63 
	~<°dio.h
>

67 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


72 
£çwít
 ();

78 
ídpwít
 ();

84 
∑sswd
 *
gëpwít
 ();

87 #ifdef 
__USE_SVID


94 
∑sswd
 *
fgëpwít
 (
FILE
 *
__°ªam
);

102 
puçwít
 (c⁄° 
∑sswd
 *
__ª°ri˘
 
__p
,

103 
FILE
 *
__ª°ri˘
 
__f
);

110 
∑sswd
 *
gëpwuid
 (
__uid_t
 
__uid
);

116 
∑sswd
 *
gëpw«m
 (c⁄° *
__«me
);

118 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


120 #ifde‡
__USE_MISC


123 
	#NSS_BUFLEN_PASSWD
 1024

	)

134 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


139 
gëpwít_r
 (
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

140 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

141 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

144 
gëpwuid_r
 (
__uid_t
 
__uid
,

145 
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

146 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

147 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

149 
gëpw«m_r
 (c⁄° *
__ª°ri˘
 
__«me
,

150 
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

151 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

152 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

155 #ifdef 
__USE_SVID


163 
fgëpwít_r
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

164 
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

165 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

166 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

171 #ifde‡
__USE_GNU


180 
gëpw
 (
__uid_t
 
__uid
, *
__buf„r
);

183 
	g__END_DECLS


	@/usr/include/regex.h

20 #i‚de‡
_REGEX_H


21 
	#_REGEX_H
 1

	)

23 
	~<sys/ty≥s.h
>

24 
	~<gnu/›ti⁄-groups.h
>

27 #ifde‡
__˝lu•lus


35 
	ts_ªg_t
;

36 
	ta˘ive_ªg_t
;

43 
	tªg_sy¡ax_t
;

45 #ifde‡
__USE_GNU


48 
	#RE_BACKSLASH_ESCAPE_IN_LISTS
 ((Ë1)

	)

53 
	#RE_BK_PLUS_QM
 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 << 1)

	)

59 
	#RE_CHAR_CLASSES
 (
RE_BK_PLUS_QM
 << 1)

	)

73 
	#RE_CONTEXT_INDEP_ANCHORS
 (
RE_CHAR_CLASSES
 << 1)

	)

81 
	#RE_CONTEXT_INDEP_OPS
 (
RE_CONTEXT_INDEP_ANCHORS
 << 1)

	)

85 
	#RE_CONTEXT_INVALID_OPS
 (
RE_CONTEXT_INDEP_OPS
 << 1)

	)

89 
	#RE_DOT_NEWLINE
 (
RE_CONTEXT_INVALID_OPS
 << 1)

	)

93 
	#RE_DOT_NOT_NULL
 (
RE_DOT_NEWLINE
 << 1)

	)

97 
	#RE_HAT_LISTS_NOT_NEWLINE
 (
RE_DOT_NOT_NULL
 << 1)

	)

102 
	#RE_INTERVALS
 (
RE_HAT_LISTS_NOT_NEWLINE
 << 1)

	)

106 
	#RE_LIMITED_OPS
 (
RE_INTERVALS
 << 1)

	)

110 
	#RE_NEWLINE_ALT
 (
RE_LIMITED_OPS
 << 1)

	)

115 
	#RE_NO_BK_BRACES
 (
RE_NEWLINE_ALT
 << 1)

	)

119 
	#RE_NO_BK_PARENS
 (
RE_NO_BK_BRACES
 << 1)

	)

123 
	#RE_NO_BK_REFS
 (
RE_NO_BK_PARENS
 << 1)

	)

127 
	#RE_NO_BK_VBAR
 (
RE_NO_BK_REFS
 << 1)

	)

133 
	#RE_NO_EMPTY_RANGES
 (
RE_NO_BK_VBAR
 << 1)

	)

137 
	#RE_UNMATCHED_RIGHT_PAREN_ORD
 (
RE_NO_EMPTY_RANGES
 << 1)

	)

141 
	#RE_NO_POSIX_BACKTRACKING
 (
RE_UNMATCHED_RIGHT_PAREN_ORD
 << 1)

	)

145 
	#RE_NO_GNU_OPS
 (
RE_NO_POSIX_BACKTRACKING
 << 1)

	)

153 
	#RE_DEBUG
 (
RE_NO_GNU_OPS
 << 1)

	)

158 
	#RE_INVALID_INTERVAL_ORD
 (
RE_DEBUG
 << 1)

	)

161 #ifde‡
__OPTION_POSIX_REGEXP_GLIBC


164 
	#RE_ICASE
 (
RE_INVALID_INTERVAL_ORD
 << 1)

	)

169 
	#RE_CARET_ANCHORS_HERE
 (
RE_ICASE
 << 1)

	)

173 
	#RE_CONTEXT_INVALID_DUP
 (
RE_CARET_ANCHORS_HERE
 << 1)

	)

177 
	#RE_NO_SUB
 (
RE_CONTEXT_INVALID_DUP
 << 1)

	)

185 
ªg_sy¡ax_t
 
ª_sy¡ax_›ti⁄s
;

187 #ifde‡
__USE_GNU


192 
	#RE_SYNTAX_EMACS
 0

	)

194 
	#RE_SYNTAX_AWK
 \

195 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 | 
RE_DOT_NOT_NULL
 \

196 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

197 | 
RE_NO_BK_VBAR
 | 
RE_NO_EMPTY_RANGES
 \

198 | 
RE_DOT_NEWLINE
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

199 | 
RE_CHAR_CLASSES
 \

200 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
 | 
RE_NO_GNU_OPS
)

	)

202 
	#RE_SYNTAX_GNU_AWK
 \

203 ((
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 \

204 | 
RE_INVALID_INTERVAL_ORD
) \

205 & ~(
RE_DOT_NOT_NULL
 | 
RE_CONTEXT_INDEP_OPS
 \

206 | 
RE_CONTEXT_INVALID_OPS
 ))

	)

208 
	#RE_SYNTAX_POSIX_AWK
 \

209 (
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 \

210 | 
RE_INTERVALS
 | 
RE_NO_GNU_OPS
 \

211 | 
RE_INVALID_INTERVAL_ORD
)

	)

213 
	#RE_SYNTAX_GREP
 \

214 (
RE_BK_PLUS_QM
 | 
RE_CHAR_CLASSES
 \

215 | 
RE_HAT_LISTS_NOT_NEWLINE
 | 
RE_INTERVALS
 \

216 | 
RE_NEWLINE_ALT
)

	)

218 
	#RE_SYNTAX_EGREP
 \

219 (
RE_CHAR_CLASSES
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

220 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_HAT_LISTS_NOT_NEWLINE
 \

221 | 
RE_NEWLINE_ALT
 | 
RE_NO_BK_PARENS
 \

222 | 
RE_NO_BK_VBAR
)

	)

224 
	#RE_SYNTAX_POSIX_EGREP
 \

225 (
RE_SYNTAX_EGREP
 | 
RE_INTERVALS
 | 
RE_NO_BK_BRACES
 \

226 | 
RE_INVALID_INTERVAL_ORD
)

	)

229 
	#RE_SYNTAX_ED
 
RE_SYNTAX_POSIX_BASIC


	)

231 
	#RE_SYNTAX_SED
 
RE_SYNTAX_POSIX_BASIC


	)

234 
	#_RE_SYNTAX_POSIX_COMMON
 \

235 (
RE_CHAR_CLASSES
 | 
RE_DOT_NEWLINE
 | 
RE_DOT_NOT_NULL
 \

236 | 
RE_INTERVALS
 | 
RE_NO_EMPTY_RANGES
)

	)

238 #ifde‡
__OPTION_POSIX_REGEXP_GLIBC


239 
	#RE_SYNTAX_POSIX_BASIC
 \

240 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_BK_PLUS_QM
 | 
RE_CONTEXT_INVALID_DUP
)

	)

242 
	#RE_SYNTAX_POSIX_BASIC
 \

243 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_BK_PLUS_QM
)

	)

249 
	#RE_SYNTAX_POSIX_MINIMAL_BASIC
 \

250 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_LIMITED_OPS
)

	)

252 
	#RE_SYNTAX_POSIX_EXTENDED
 \

253 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

254 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_NO_BK_BRACES
 \

255 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_VBAR
 \

256 | 
RE_CONTEXT_INVALID_OPS
 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

260 
	#RE_SYNTAX_POSIX_MINIMAL_EXTENDED
 \

261 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

262 | 
RE_CONTEXT_INVALID_OPS
 | 
RE_NO_BK_BRACES
 \

263 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

264 | 
RE_NO_BK_VBAR
 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

270 #ifde‡
RE_DUP_MAX


271 #unde‡
RE_DUP_MAX


274 
	#RE_DUP_MAX
 (0x7fff)

	)

282 
	#REG_EXTENDED
 1

	)

286 
	#REG_ICASE
 (
REG_EXTENDED
 << 1)

	)

291 
	#REG_NEWLINE
 (
REG_ICASE
 << 1)

	)

295 
	#REG_NOSUB
 (
REG_NEWLINE
 << 1)

	)

305 
	#REG_NOTBOL
 1

	)

308 
	#REG_NOTEOL
 (1 << 1)

	)

310 #ifde‡
__OPTION_POSIX_REGEXP_GLIBC


313 
	#REG_STARTEND
 (1 << 2)

	)

321 #i‡
deföed
 
_XOPEN_SOURCE
 || deföed 
__USE_XOPEN2K


322 
	gREG_ENOSYS
 = -1,

325 
	gREG_NOERROR
 = 0,

326 
	gREG_NOMATCH
,

330 
	gREG_BADPAT
,

331 
	gREG_ECOLLATE
,

332 
	gREG_ECTYPE
,

333 
	gREG_EESCAPE
,

334 
	gREG_ESUBREG
,

335 
	gREG_EBRACK
,

336 
	gREG_EPAREN
,

337 
	gREG_EBRACE
,

338 
	gREG_BADBR
,

339 
	gREG_ERANGE
,

340 
	gREG_ESPACE
,

341 
	gREG_BADRPT
,

344 
	gREG_EEND
,

345 
	gREG_ESIZE
,

346 
	gREG_ERPAREN


347 } 
	tªg_îrcode_t
;

355 #i‚de‡
RE_TRANSLATE_TYPE


356 
	#__RE_TRANSLATE_TYPE
 *

	)

357 #ifde‡
__USE_GNU


358 
	#RE_TRANSLATE_TYPE
 
__RE_TRANSLATE_TYPE


	)

362 #ifde‡
__USE_GNU


363 
	#__REPB_PREFIX
(
«me
Ë
	)
name

365 
	#__REPB_PREFIX
(
«me
Ë
__
##
	)
name

368 
	sª_∑âîn_buf„r


373 *
__REPB_PREFIX
(
buf„r
);

376 
__REPB_PREFIX
(
Æloˇãd
);

379 
__REPB_PREFIX
(
u£d
);

382 
ªg_sy¡ax_t
 
__REPB_PREFIX
(
sy¡ax
);

387 *
__REPB_PREFIX
(
Á°m≠
);

393 
__RE_TRANSLATE_TYPE
 
__REPB_PREFIX
(
å™¶©e
);

396 
size_t
 
	gª_nsub
;

402 
__REPB_PREFIX
(
ˇn_be_nuŒ
) : 1;

408 #ifde‡
__USE_GNU


409 
	#REGS_UNALLOCATED
 0

	)

410 
	#REGS_REALLOCATE
 1

	)

411 
	#REGS_FIXED
 2

	)

413 
__REPB_PREFIX
(
ªgs_Æloˇãd
) : 2;

417 
__REPB_PREFIX
(
Á°m≠_accuøã
) : 1;

421 
__REPB_PREFIX
(
no_sub
) : 1;

425 
__REPB_PREFIX
(
nŸ_bﬁ
) : 1;

428 
__REPB_PREFIX
(
nŸ_eﬁ
) : 1;

431 
__REPB_PREFIX
(
√wlöe_™ch‹
) : 1;

434 
ª_∑âîn_buf„r
 
	tªgex_t
;

437 
	tªgoff_t
;

440 #ifde‡
__USE_GNU


443 
	sª_ªgi°îs


445 
	gnum_ªgs
;

446 
ªgoff_t
 *
	g°¨t
;

447 
ªgoff_t
 *
	gíd
;

454 #i‚de‡
RE_NREGS


455 
	#RE_NREGS
 30

	)

465 
ªgoff_t
 
	grm_so
;

466 
ªgoff_t
 
	grm_eo
;

467 } 
	tªgm©ch_t
;

471 #ifde‡
__USE_GNU


474 
ªg_sy¡ax_t
 
ª_£t_sy¡ax
 (ªg_sy¡ax_à
__sy¡ax
);

484 c⁄° *
ª_compûe_∑âîn
 (c⁄° *
__∑âîn
, 
size_t
 
__Àngth
,

485 
ª_∑âîn_buf„r
 *
__buf„r
);

491 
ª_compûe_Á°m≠
 (
ª_∑âîn_buf„r
 *
__buf„r
);

499 
ª_£¨ch
 (
ª_∑âîn_buf„r
 *
__buf„r
, c⁄° *
__°rög
,

500 
__Àngth
, 
__°¨t
, 
__ønge
,

501 
ª_ªgi°îs
 *
__ªgs
);

506 
ª_£¨ch_2
 (
ª_∑âîn_buf„r
 *
__buf„r
,

507 c⁄° *
__°rög1
, 
__Àngth1
,

508 c⁄° *
__°rög2
, 
__Àngth2
, 
__°¨t
,

509 
__ønge
, 
ª_ªgi°îs
 *
__ªgs
, 
__°›
);

514 
ª_m©ch
 (
ª_∑âîn_buf„r
 *
__buf„r
, c⁄° *
__°rög
,

515 
__Àngth
, 
__°¨t
, 
ª_ªgi°îs
 *
__ªgs
);

519 
ª_m©ch_2
 (
ª_∑âîn_buf„r
 *
__buf„r
,

520 c⁄° *
__°rög1
, 
__Àngth1
,

521 c⁄° *
__°rög2
, 
__Àngth2
, 
__°¨t
,

522 
ª_ªgi°îs
 *
__ªgs
, 
__°›
);

537 
ª_£t_ªgi°îs
 (
ª_∑âîn_buf„r
 *
__buf„r
,

538 
ª_ªgi°îs
 *
__ªgs
,

539 
__num_ªgs
,

540 
ªgoff_t
 *
__°¨ts
,Ñegoff_à*
__íds
);

543 #i‡
deföed
 
_REGEX_RE_COMP
 || (deföed 
_LIBC
 && deföed 
__USE_BSD
)

544 #i‚de‡
_CRAY


546 *
ª_comp
 (const *);

547 
ª_exec
 (const *);

553 #i‚de‡
__ª°ri˘


554 #i‡! (2 < 
__GNUC__
 || (2 =__GNUC__ && 95 <
__GNUC_MINOR__
))

555 #i‡
deföed
 
ª°ri˘
 || 199901L <
__STDC_VERSION__


556 
	#__ª°ri˘
 
ª°ri˘


	)

558 
	#__ª°ri˘


	)

563 #i‚de‡
__ª°ri˘_¨r


564 #i‡(
__GNUC__
 > 3 || (__GNUC__ =3 && 
__GNUC_MINOR__
 >= 1)) \

565 && !
deföed
 
	g__GNUG__


566 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

568 
	#__ª°ri˘_¨r


	)

573 
ªgcomp
 (
ªgex_t
 *
__ª°ri˘
 
__¥eg
,

574 c⁄° *
__ª°ri˘
 
__∑âîn
,

575 
__cÊags
);

577 
ªgexec
 (c⁄° 
ªgex_t
 *
__ª°ri˘
 
__¥eg
,

578 c⁄° *
__ª°ri˘
 
__°rög
, 
size_t
 
__nm©ch
,

579 
ªgm©ch_t
 
__pm©ch
[
__ª°ri˘_¨r
],

580 
__eÊags
);

582 
size_t
 
ªgîr‹
 (
__îrcode
, c⁄° 
ªgex_t
 *
__ª°ri˘
 
__¥eg
,

583 *
__ª°ri˘
 
__îrbuf
, 
size_t
 
__îrbuf_size
);

585 
ªg‰ì
 (
ªgex_t
 *
__¥eg
);

588 #ifde‡
__˝lu•lus


	@/usr/include/resolv.h

52 #i‚de‡
_RESOLV_H_


56 
	~<sys/ty≥s.h
>

57 
	~<√töë/ö.h
>

59 #i‚de‡
__√ed_ªs_°©e


60 
	#_RESOLV_H_


	)

62 
	~<sys/∑øm.h
>

63 
	~<sys/cdefs.h
>

64 
	~<°dio.h
>

65 
	~<¨∑/«me£r.h
>

68 #i‚de‡
__ªs_°©e_deföed


69 
	#__ªs_°©e_deföed


	)

71 íum { 
	mªs_gﬂhód
, 
	mªs_√xäs
, 
	mªs_modifõd
, 
	mªs_d⁄e
, 
	mªs_îr‹
 }

72 
	tªs_£ndhooka˘
;

74 
	$ªs_£ndhooka˘
 (*
	tªs_£nd_qhook
Ë(
	tsockaddr_ö
 * c⁄° *
	t__ns
,

75 c⁄° 
	tu_ch¨
 **
	t__quîy
,

76 *
	t__quîyÀn
,

77 
	tu_ch¨
 *
	t__™s
,

78 
	t__™ssiz
,

79 *
	t__ª•Àn
);

81 
	$ªs_£ndhooka˘
 (*
	tªs_£nd_rhook
Ë(c⁄° 
	tsockaddr_ö
 *
	t__ns
,

82 c⁄° 
	tu_ch¨
 *
	t__quîy
,

83 
	t__quîyÀn
,

84 
	tu_ch¨
 *
	t__™s
,

85 
	t__™ssiz
,

86 *
	t__ª•Àn
);

91 
	#MAXNS
 3

	)

92 
	#MAXDFLSRCH
 3

	)

93 
	#MAXDNSRCH
 6

	)

94 
	#LOCALDOMAINPARTS
 2

	)

96 
	#RES_TIMEOUT
 5

	)

97 
	#MAXRESOLVSORT
 10

	)

98 
	#RES_MAXNDOTS
 15

	)

99 
	#RES_MAXRETRANS
 30

	)

100 
	#RES_MAXRETRY
 5

	)

101 
	#RES_DFLRETRY
 2

	)

102 
	#RES_MAXTIME
 65535

	)

104 
	s__ªs_°©e
 {

105 
ªå™s
;

106 
ªåy
;

107 
u_l⁄g
 
›ti⁄s
;

108 
nscou¡
;

109 
sockaddr_ö


110 
nßddr_li°
[
MAXNS
];

111 
	#nßddr
 
nßddr_li°
[0]

	)

112 
u_sh‹t
 
id
;

114 *
dn§ch
[
MAXDNSRCH
+1];

115 
defd«me
[256];

116 
u_l⁄g
 
pfcode
;

117 
ndŸs
:4;

118 
ns‹t
:4;

119 
ùv6_u«vaû
:1;

120 
unu£d
:23;

122 
ö_addr
 
addr
;

123 
u_öt32_t
 
mask
;

124 } 
s‹t_li°
[
MAXRESOLVSORT
];

126 
ªs_£nd_qhook
 
qhook
;

127 
ªs_£nd_rhook
 
rhook
;

128 
ªs_h_î∫o
;

129 
_vcsock
;

130 
u_öt
 
_Êags
;

133 
∑d
[52];

135 
u_öt16_t
 
nscou¡
;

136 
u_öt16_t
 
nsm≠
[
MAXNS
];

137 
nssocks
[
MAXNS
];

138 
u_öt16_t
 
nscou¡6
;

139 
u_öt16_t
 
nsöô
;

140 
sockaddr_ö6
 *
nßddrs
[
MAXNS
];

141 #ifde‡
_LIBC


142 
öô°amp


143 
	`__©åibuã__
((
∑cked
));

145 
_öô°amp
[2];

147 } 
_ext
;

148 } 
_u
;

151 
__ªs_°©e
 *
	tªs_°©e
;

152 #unde‡
__√ed_ªs_°©e


155 #ifde‡
_RESOLV_H_


164 
	#__RES
 19991006

	)

172 #i‚de‡
_PATH_RESCONF


173 
	#_PATH_RESCONF
 "/ëc/ªsﬁv.c⁄f"

	)

176 
	sªs_sym
 {

177 
numbî
;

178 * 
«me
;

179 * 
hum™«me
;

185 
	#RES_F_VC
 0x00000001

	)

186 
	#RES_F_CONN
 0x00000002

	)

187 
	#RES_F_EDNS0ERR
 0x00000004

	)

190 
	#RES_EXHAUSTIVE
 0x00000001

	)

195 
	#RES_INIT
 0x00000001

	)

196 
	#RES_DEBUG
 0x00000002

	)

197 
	#RES_AAONLY
 0x00000004

	)

198 
	#RES_USEVC
 0x00000008

	)

199 
	#RES_PRIMARY
 0x00000010

	)

200 
	#RES_IGNTC
 0x00000020

	)

201 
	#RES_RECURSE
 0x00000040

	)

202 
	#RES_DEFNAMES
 0x00000080

	)

203 
	#RES_STAYOPEN
 0x00000100

	)

204 
	#RES_DNSRCH
 0x00000200

	)

205 
	#RES_INSECURE1
 0x00000400

	)

206 
	#RES_INSECURE2
 0x00000800

	)

207 
	#RES_NOALIASES
 0x00001000

	)

208 
	#RES_USE_INET6
 0x00002000

	)

209 
	#RES_ROTATE
 0x00004000

	)

210 
	#RES_NOCHECKNAME
 0x00008000

	)

211 
	#RES_KEEPTSIG
 0x00010000

	)

212 
	#RES_BLAST
 0x00020000

	)

213 
	#RES_USEBSTRING
 0x00040000

	)

215 
	#RES_NOIP6DOTINT
 0x00080000

	)

217 
	#RES_USE_EDNS0
 0x00100000

	)

218 
	#RES_SNGLKUP
 0x00200000

	)

219 
	#RES_SNGLKUPREOP
 0x00400000

	)

221 
	#RES_USE_DNSSEC
 0x00800000

	)

222 
	#RES_NOTLDQUERY
 0x01000000

	)

225 
	#RES_DEFAULT
 (
RES_RECURSE
|
RES_DEFNAMES
|
RES_DNSRCH
|
RES_NOIP6DOTINT
)

	)

230 
	#RES_PRF_STATS
 0x00000001

	)

231 
	#RES_PRF_UPDATE
 0x00000002

	)

232 
	#RES_PRF_CLASS
 0x00000004

	)

233 
	#RES_PRF_CMD
 0x00000008

	)

234 
	#RES_PRF_QUES
 0x00000010

	)

235 
	#RES_PRF_ANS
 0x00000020

	)

236 
	#RES_PRF_AUTH
 0x00000040

	)

237 
	#RES_PRF_ADD
 0x00000080

	)

238 
	#RES_PRF_HEAD1
 0x00000100

	)

239 
	#RES_PRF_HEAD2
 0x00000200

	)

240 
	#RES_PRF_TTLID
 0x00000400

	)

241 
	#RES_PRF_HEADX
 0x00000800

	)

242 
	#RES_PRF_QUERY
 0x00001000

	)

243 
	#RES_PRF_REPLY
 0x00002000

	)

244 
	#RES_PRF_INIT
 0x00004000

	)

248 
__BEGIN_DECLS


249 
__ªs_°©e
 *
	$__ªs_°©e
(Ë
	`__©åibuã__
 ((
__c⁄°__
));

250 
__END_DECLS


251 
	#_ªs
 (*
	`__ªs_°©e
())

	)

253 #i‚de‡
__BIND_NOSTATIC


254 
	#Â_nquîy
 
__Â_nquîy


	)

255 
	#Â_quîy
 
__Â_quîy


	)

256 
	#ho°Æüs
 
__ho°Æüs


	)

257 
	#p_quîy
 
__p_quîy


	)

258 
	#ªs_˛o£
 
__ªs_˛o£


	)

259 
	#ªs_öô
 
__ªs_öô


	)

260 
	#ªs_isour£rvî
 
__ªs_isour£rvî


	)

261 
	#ªs_mkquîy
 
__ªs_mkquîy


	)

262 
	#ªs_quîy
 
__ªs_quîy


	)

263 
	#ªs_quîydomaö
 
__ªs_quîydomaö


	)

264 
	#ªs_£¨ch
 
__ªs_£¨ch


	)

265 
	#ªs_£nd
 
__ªs_£nd


	)

267 
__BEGIN_DECLS


268 
	$Â_nquîy
 (c⁄° 
u_ch¨
 *, , 
FILE
 *Ë
__THROW
;

269 
	$Â_quîy
 (c⁄° 
u_ch¨
 *, 
FILE
 *Ë
__THROW
;

270 c⁄° * 
	$ho°Æüs
 (c⁄° *Ë
__THROW
;

271 
	$p_quîy
 (c⁄° 
u_ch¨
 *Ë
__THROW
;

272 
	$ªs_˛o£
 (Ë
__THROW
;

273 
	$ªs_öô
 (Ë
__THROW
;

274 
	$ªs_isour£rvî
 (c⁄° 
sockaddr_ö
 *Ë
__THROW
;

275 
	$ªs_mkquîy
 (, c⁄° *, , , c⁄° 
u_ch¨
 *,

276 , c⁄° 
u_ch¨
 *, u_ch¨ *, Ë
__THROW
;

277 
	$ªs_quîy
 (c⁄° *, , , 
u_ch¨
 *, Ë
__THROW
;

278 
	$ªs_quîydomaö
 (const *, const *, , ,

279 
u_ch¨
 *, Ë
__THROW
;

280 
	$ªs_£¨ch
 (c⁄° *, , , 
u_ch¨
 *, Ë
__THROW
;

281 
	$ªs_£nd
 (c⁄° 
u_ch¨
 *, , u_ch¨ *, Ë
__THROW
;

282 
__END_DECLS


285 
	#b64_¡›
 
__b64_¡›


	)

286 
	#b64_±⁄
 
__b64_±⁄


	)

287 
	#dn_comp
 
__dn_comp


	)

288 
	#dn_cou¡_œbñs
 
__dn_cou¡_œbñs


	)

289 
	#dn_ex∑nd
 
__dn_ex∑nd


	)

290 
	#dn_skù«me
 
__dn_skù«me


	)

291 
	#Â_ªs°©
 
__Â_ªs°©


	)

292 
	#loc_©⁄
 
__loc_©⁄


	)

293 
	#loc_¡ﬂ
 
__loc_¡ﬂ


	)

294 
	#p_cd«me
 
__p_cd«me


	)

295 
	#p_cd¬ame
 
__p_cd¬ame


	)

296 
	#p_˛ass
 
__p_˛ass


	)

297 
	#p_fq«me
 
__p_fq«me


	)

298 
	#p_fq¬ame
 
__p_fq¬ame


	)

299 
	#p_›ti⁄
 
__p_›ti⁄


	)

300 
	#p_£c°od©e
 
__p_£c°od©e


	)

301 
	#p_£˘i⁄
 
__p_£˘i⁄


	)

302 
	#p_time
 
__p_time


	)

303 
	#p_ty≥
 
__p_ty≥


	)

304 
	#p_rcode
 
__p_rcode


	)

305 
	#pué⁄g
 
__pué⁄g


	)

306 
	#putsh‹t
 
__putsh‹t


	)

307 
	#ªs_dnok
 
__ªs_dnok


	)

308 
	#ªs_hnok
 
__ªs_hnok


	)

309 
	#ªs_ho°Æüs
 
__ªs_ho°Æüs


	)

310 
	#ªs_maûok
 
__ªs_maûok


	)

311 
	#ªs_«meöquîy
 
__ªs_«meöquîy


	)

312 
	#ªs_n˛o£
 
__ªs_n˛o£


	)

313 
	#ªs_nöô
 
__ªs_nöô


	)

314 
	#ªs_nmkquîy
 
__ªs_nmkquîy


	)

315 
	#ªs_≈quîy
 
__ªs_≈quîy


	)

316 
	#ªs_nquîy
 
__ªs_nquîy


	)

317 
	#ªs_nquîydomaö
 
__ªs_nquîydomaö


	)

318 
	#ªs_n£¨ch
 
__ªs_n£¨ch


	)

319 
	#ªs_n£nd
 
__ªs_n£nd


	)

320 
	#ªs_nisour£rvî
 
__ªs_nisour£rvî


	)

321 
	#ªs_ownok
 
__ªs_ownok


	)

322 
	#ªs_quîõsm©ch
 
__ªs_quîõsm©ch


	)

323 
	#ªs_øndomid
 
__ªs_øndomid


	)

324 
	#sym_¡›
 
__sym_¡›


	)

325 
	#sym_¡os
 
__sym_¡os


	)

326 
	#sym_°⁄
 
__sym_°⁄


	)

327 
__BEGIN_DECLS


328 
	$ªs_hnok
 (c⁄° *Ë
__THROW
;

329 
	$ªs_ownok
 (c⁄° *Ë
__THROW
;

330 
	$ªs_maûok
 (c⁄° *Ë
__THROW
;

331 
	$ªs_dnok
 (c⁄° *Ë
__THROW
;

332 
	$sym_°⁄
 (c⁄° 
ªs_sym
 *, c⁄° *, *Ë
__THROW
;

333 c⁄° * 
	$sym_¡os
 (c⁄° 
ªs_sym
 *, , *Ë
__THROW
;

334 c⁄° * 
	$sym_¡›
 (c⁄° 
ªs_sym
 *, , *Ë
__THROW
;

335 
	$b64_¡›
 (
u_ch¨
 c⁄° *, 
size_t
, *, size_tË
__THROW
;

336 
	$b64_±⁄
 (c⁄° *, 
u_ch¨
 *, 
size_t
Ë
__THROW
;

337 
	$loc_©⁄
 (c⁄° *
__ascii
, 
u_ch¨
 *
__bö¨y
Ë
__THROW
;

338 c⁄° * 
	$loc_¡ﬂ
 (c⁄° 
u_ch¨
 *
__bö¨y
, *
__ascii
Ë
__THROW
;

339 
	$dn_skù«me
 (c⁄° 
u_ch¨
 *, c⁄° u_ch¨ *Ë
__THROW
;

340 
	$pué⁄g
 (
u_öt32_t
, 
u_ch¨
 *Ë
__THROW
;

341 
	$putsh‹t
 (
u_öt16_t
, 
u_ch¨
 *Ë
__THROW
;

342 c⁄° * 
	$p_˛ass
 (Ë
__THROW
;

343 c⁄° * 
	$p_time
 (
u_öt32_t
Ë
__THROW
;

344 c⁄° * 
	$p_ty≥
 (Ë
__THROW
;

345 c⁄° * 
	$p_rcode
 (Ë
__THROW
;

346 c⁄° 
u_ch¨
 * 
	$p_cd¬ame
 (c⁄° 
u_ch¨
 *, c⁄° u_ch¨ *, , 
FILE
 *)

347 
__THROW
;

348 c⁄° 
u_ch¨
 * 
	$p_cd«me
 (c⁄° 
u_ch¨
 *, c⁄° u_ch¨ *, 
FILE
 *Ë
__THROW
;

349 c⁄° 
u_ch¨
 * 
	$p_fq¬ame
 (c⁄° 
u_ch¨
 *
__˝
, c⁄° u_ch¨ *
__msg
,

350 , *, Ë
__THROW
;

351 c⁄° 
u_ch¨
 * 
	$p_fq«me
 (c⁄° 
u_ch¨
 *, c⁄° u_ch¨ *, 
FILE
 *Ë
__THROW
;

352 c⁄° * 
	$p_›ti⁄
 (
u_l⁄g
 
__›ti⁄
Ë
__THROW
;

353 * 
	$p_£c°od©e
 (
u_l⁄g
Ë
__THROW
;

354 
	$dn_cou¡_œbñs
 (c⁄° *Ë
__THROW
;

355 
	$dn_comp
 (c⁄° *, 
u_ch¨
 *, , u_char **, u_char **)

356 
__THROW
;

357 
	$dn_ex∑nd
 (c⁄° 
u_ch¨
 *, const u_char *, const u_char *,

358 *, Ë
__THROW
;

359 
u_öt
 
	$ªs_øndomid
 (Ë
__THROW
;

360 
	$ªs_«meöquîy
 (const *, , ,

361 c⁄° 
u_ch¨
 *, c⁄° u_ch¨ *Ë
__THROW
;

362 
	$ªs_quîõsm©ch
 (c⁄° 
u_ch¨
 *, const u_char *,

363 c⁄° 
u_ch¨
 *, c⁄° u_ch¨ *Ë
__THROW
;

364 c⁄° * 
	$p_£˘i⁄
 (
__£˘i⁄
, 
__›code
Ë
__THROW
;

366 
	$ªs_nöô
 (
ªs_°©e
Ë
__THROW
;

367 
	$ªs_nisour£rvî
 (c⁄° 
ªs_°©e
,

368 c⁄° 
sockaddr_ö
 *Ë
__THROW
;

369 
	$Â_ªs°©
 (c⁄° 
ªs_°©e
, 
FILE
 *Ë
__THROW
;

370 
	$ªs_≈quîy
 (c⁄° 
ªs_°©e
, c⁄° 
u_ch¨
 *, , 
FILE
 *)

371 
__THROW
;

372 c⁄° * 
	$ªs_ho°Æüs
 (c⁄° 
ªs_°©e
, c⁄° *, *, 
size_t
)

373 
__THROW
;

374 
	$ªs_nquîy
 (
ªs_°©e
, c⁄° *, , , 
u_ch¨
 *, )

375 
__THROW
;

376 
	$ªs_n£¨ch
 (
ªs_°©e
, c⁄° *, , , 
u_ch¨
 *, )

377 
__THROW
;

378 
	$ªs_nquîydomaö
 (
ªs_°©e
, const *, const *, ,

379 , 
u_ch¨
 *, Ë
__THROW
;

380 
	$ªs_nmkquîy
 (
ªs_°©e
, , const *, , ,

381 c⁄° 
u_ch¨
 *, , const u_char *, u_char *,

382 Ë
__THROW
;

383 
	$ªs_n£nd
 (
ªs_°©e
, c⁄° 
u_ch¨
 *, , u_char *, )

384 
__THROW
;

385 
	$ªs_n˛o£
 (
ªs_°©e
Ë
__THROW
;

386 
__END_DECLS


	@/usr/include/rpc/rpc.h

35 #i‚de‡
_RPC_RPC_H


36 
	#_RPC_RPC_H
 1

	)

38 
	~<Ωc/ty≥s.h
>

39 
	~<√töë/ö.h
>

42 
	~<Ωc/xdr.h
>

45 
	~<Ωc/auth.h
>

48 
	~<Ωc/˛¡.h
>

51 
	~<Ωc/Ωc_msg.h
>

52 
	~<Ωc/auth_unix.h
>

53 
	~<Ωc/auth_des.h
>

56 
	~<Ωc/svc.h
>

57 
	~<Ωc/svc_auth.h
>

65 
	~<Ωc/√tdb.h
>

67 
__BEGIN_DECLS


70 
fd_£t
 *
	$__Ωc_thªad_svc_fd£t
 (Ë
	`__©åibuã__
 ((
__c⁄°__
));

71 
	#svc_fd£t
 (*
	`__Ωc_thªad_svc_fd£t
 ())

	)

73 
Ωc_¸óãîr
 *
	$__Ωc_thªad_¸óãîr
 ()

74 
	`__©åibuã__
 ((
__c⁄°__
));

75 
	#gë_Ωc_¸óãîr
(Ë(*
	`__Ωc_thªad_¸óãîr
 ())

	)

81 #ifde‡
_RPC_MT_VARS


82 
	#Ωc_¸óãîr
 (*
	`__Ωc_thªad_¸óãîr
 ())

	)

85 
pﬁlfd
 **
	$__Ωc_thªad_svc_pﬁlfd
 ()

86 
	`__©åibuã__
 ((
__c⁄°__
));

87 
	#svc_pﬁlfd
 (*
	`__Ωc_thªad_svc_pﬁlfd
 ())

	)

89 *
	$__Ωc_thªad_svc_max_pﬁlfd
 (Ë
	`__©åibuã__
 ((
__c⁄°__
));

90 
	#svc_max_pﬁlfd
 (*
	`__Ωc_thªad_svc_max_pﬁlfd
 ())

	)

92 
__END_DECLS


	@/usr/include/sched.h

19 #i‚def 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<„©uªs.h
>

25 
	~<bôs/ty≥s.h
>

27 
	#__√ed_size_t


	)

28 
	~<°ddef.h
>

30 
	#__√ed_time_t


	)

31 
	#__√ed_time•ec


	)

32 
	~<time.h
>

34 #i‚de‡
__pid_t_deföed


35 
__pid_t
 
	tpid_t
;

36 
	#__pid_t_deföed


	)

41 
	~<bôs/sched.h
>

43 
	#sched_¥i‹ôy
 
__sched_¥i‹ôy


	)

46 
__BEGIN_DECLS


49 
	$sched_£ç¨am
 (
__pid_t
 
__pid
, c⁄° 
sched_∑øm
 *
__∑øm
)

50 
__THROW
;

53 
	$sched_gë∑øm
 (
__pid_t
 
__pid
, 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

56 
	$sched_£tscheduÀr
 (
__pid_t
 
__pid
, 
__pﬁicy
,

57 c⁄° 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

60 
	$sched_gëscheduÀr
 (
__pid_t
 
__pid
Ë
__THROW
;

63 
	$sched_yõld
 (Ë
__THROW
;

66 
	$sched_gë_¥i‹ôy_max
 (
__Æg‹ôhm
Ë
__THROW
;

69 
	$sched_gë_¥i‹ôy_mö
 (
__Æg‹ôhm
Ë
__THROW
;

72 
	$sched_º_gë_öãrvÆ
 (
__pid_t
 
__pid
, 
time•ec
 *
__t
Ë
__THROW
;

75 #ifde‡
__USE_GNU


77 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

78 
	#CPU_SET
(
˝u
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

79 
	#CPU_CLR
(
˝u
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

80 
	#CPU_ISSET
(
˝u
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (˝u,  (
˝u_£t_t
), \

81 
˝u£ç
)

	)

82 
	#CPU_ZERO
(
˝u£ç
Ë
	`__CPU_ZERO_S
 ( (
˝u_£t_t
), cpu£ç)

	)

83 
	#CPU_COUNT
(
˝u£ç
Ë
	`__CPU_COUNT_S
 ( (
˝u_£t_t
), cpu£ç)

	)

85 
	#CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u, sësize, cpu£ç)

	)

86 
	#CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u, sësize, cpu£ç)

	)

87 
	#CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (cpu, setsize, \

88 
˝u£ç
)

	)

89 
	#CPU_ZERO_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_ZERO_S
 (£tsize, cpu£ç)

	)

90 
	#CPU_COUNT_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_COUNT_S
 (£tsize, cpu£ç)

	)

92 
	#CPU_EQUAL
(
˝u£ç1
, 
˝u£ç2
) \

93 
	`__CPU_EQUAL_S
 ( (
˝u_£t_t
), 
˝u£ç1
, 
˝u£ç2
)

	)

94 
	#CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

95 
	`__CPU_EQUAL_S
 (
£tsize
, 
˝u£ç1
, 
˝u£ç2
)

	)

97 
	#CPU_AND
(
de°£t
, 
§c£t1
, 
§c£t2
) \

98 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

99 
	#CPU_OR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

100 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

101 
	#CPU_XOR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

102 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

103 
	#CPU_AND_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

104 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

105 
	#CPU_OR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

107 
	#CPU_XOR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

110 
	#CPU_ALLOC_SIZE
(
cou¡
Ë
	`__CPU_ALLOC_SIZE
 (cou¡)

	)

111 
	#CPU_ALLOC
(
cou¡
Ë
	`__CPU_ALLOC
 (cou¡)

	)

112 
	#CPU_FREE
(
˝u£t
Ë
	`__CPU_FREE
 (˝u£t)

	)

116 
	$sched_£èfföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

117 c⁄° 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

120 
	$sched_gëafföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

121 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

124 
__END_DECLS


	@/usr/include/setjmp.h

22 #i‚def 
_SETJMP_H


23 
	#_SETJMP_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/£tjmp.h
>

30 
	~<bôs/sig£t.h
>

34 
	s__jmp_buf_èg


40 
__jmp_buf
 
	m__jmpbuf
;

41 
	m__mask_was_ßved
;

42 
__sig£t_t
 
	m__ßved_mask
;

46 
__BEGIN_NAMESPACE_STD


48 
__jmp_buf_èg
 
	tjmp_buf
[1];

52 
	$£tjmp
 (
jmp_buf
 
__ív
Ë
__THROWNL
;

54 
__END_NAMESPACE_STD


59 
	$__sig£tjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__ßvemask
Ë
__THROWNL
;

63 
	$_£tjmp
 (
__jmp_buf_èg
 
__ív
[1]Ë
__THROWNL
;

67 
	#£tjmp
(
ív
Ë
	`_£tjmp
 (ív)

	)

70 
__BEGIN_NAMESPACE_STD


74 
	$l⁄gjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
)

75 
__THROWNL
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

77 
__END_NAMESPACE_STD


79 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


83 
	$_l⁄gjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
)

84 
__THROWNL
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

88 #ifdef 
__USE_POSIX


92 
__jmp_buf_èg
 
	tsigjmp_buf
[1];

96 
	#sig£tjmp
(
ív
, 
ßvemask
Ë
	`__sig£tjmp
 (ív, savemask)

	)

102 
	$sigl⁄gjmp
 (
sigjmp_buf
 
__ív
, 
__vÆ
)

103 
__THROWNL
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

108 #i‡
__USE_FORTIFY_LEVEL
 > 0

109 
	~<bôs/£tjmp2.h
>

112 
__END_DECLS


	@/usr/include/shadow.h

20 #i‚de‡
_SHADOW_H


21 
	#_SHADOW_H
 1

	)

23 
	~<„©uªs.h
>

25 
	~<∑ths.h
>

27 
	#__√ed_FILE


	)

28 
	~<°dio.h
>

29 
	#__√ed_size_t


	)

30 
	~<°ddef.h
>

33 
	#SHADOW
 
_PATH_SHADOW


	)

36 
__BEGIN_DECLS


39 
	s•wd


41 *
	m•_«mp
;

42 *
	m•_pwdp
;

43 
	m•_l°chg
;

44 
	m•_mö
;

45 
	m•_max
;

46 
	m•_w¨n
;

48 
	m•_öa˘
;

50 
	m•_expúe
;

52 
	m•_Êag
;

62 
£t•ít
 ();

70 
íd•ít
 ();

78 
•wd
 *
gë•ít
 ();

86 
•wd
 *
gë•«m
 (c⁄° *
__«me
);

94 
•wd
 *
sgë•ít
 (c⁄° *
__°rög
);

102 
•wd
 *
fgë•ít
 (
FILE
 *
__°ªam
);

110 
put•ít
 (c⁄° 
•wd
 *
__p
, 
FILE
 *
__°ªam
);

113 #ifde‡
__USE_MISC


120 
gë•ít_r
 (
•wd
 *
__ªsu…_buf
, *
__buf„r
,

121 
size_t
 
__buÊí
, 
•wd
 **
__ªsu…
);

123 
gë•«m_r
 (c⁄° *
__«me
, 
•wd
 *
__ªsu…_buf
,

124 *
__buf„r
, 
size_t
 
__buÊí
,

125 
•wd
 **
__ªsu…
);

127 
sgë•ít_r
 (c⁄° *
__°rög
, 
•wd
 *
__ªsu…_buf
,

128 *
__buf„r
, 
size_t
 
__buÊí
,

129 
•wd
 **
__ªsu…
);

131 
fgë•ít_r
 (
FILE
 *
__°ªam
, 
•wd
 *
__ªsu…_buf
,

132 *
__buf„r
, 
size_t
 
__buÊí
,

133 
•wd
 **
__ªsu…
);

141 
	$lckpwdf
 (Ë
__THROW
;

144 
	$ulckpwdf
 (Ë
__THROW
;

146 
__END_DECLS


	@/usr/include/signal.h

22 #i‚def 
_SIGNAL_H


24 #i‡!
deföed
 
__√ed_sig_©omic_t
 && !deföed 
__√ed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


32 
	~<bôs/sig£t.h
>

36 #i‡
deföed
 
__√ed_sig_©omic_t
 || deföed 
_SIGNAL_H


37 #i‚de‡
__sig_©omic_t_deföed


38 
	#__sig_©omic_t_deföed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #unde‡
__√ed_sig_©omic_t


46 #i‡
deföed
 
__√ed_sig£t_t
 || (deföed 
_SIGNAL_H
 && deföed 
__USE_POSIX
)

47 #i‚de‡
__sig£t_t_deföed


48 
	#__sig£t_t_deföed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #unde‡
__√ed_sig£t_t


54 #ifde‡
_SIGNAL_H


56 
	~<bôs/ty≥s.h
>

57 
	~<bôs/signum.h
>

59 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


60 #i‚de‡
__pid_t_deföed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_deföed


	)

64 #ifde‡
__USE_XOPEN


66 #i‚de‡
__uid_t_deföed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_deföed


	)

72 #ifde‡
__USE_POSIX199309


74 
	#__√ed_time•ec


	)

75 
	~<time.h
>

78 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_XOPEN_EXTENDED


80 
	~<bôs/sigöfo.h
>

85 (*
	t__sigh™dÀr_t
) ();

90 
__sigh™dÀr_t
 
	$__sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

91 
__THROW
;

92 #ifde‡
__USE_GNU


93 
__sigh™dÀr_t
 
	$sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifde‡
__USE_BSD


102 
__sigh™dÀr_t
 
	$sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

103 
__THROW
;

106 #ifde‡
__REDIRECT_NTH


107 
__sigh™dÀr_t
 
	`__REDIRECT_NTH
 (
sig«l
,

108 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
),

109 
__sysv_sig«l
);

111 
	#sig«l
 
__sysv_sig«l


	)

114 
__END_NAMESPACE_STD


116 #ifde‡
__USE_XOPEN


119 
__sigh™dÀr_t
 
	$bsd_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

120 
__THROW
;

126 #ifde‡
__USE_POSIX


127 
	$kûl
 (
__pid_t
 
__pid
, 
__sig
Ë
__THROW
;

130 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


134 
	$kûÕg
 (
__pid_t
 
__pgΩ
, 
__sig
Ë
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$øi£
 (
__sig
Ë
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifde‡
__USE_SVID


144 
__sigh™dÀr_t
 
	$ssig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

145 
__THROW
;

146 
	$gsig«l
 (
__sig
Ë
__THROW
;

149 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K


151 
	`psig«l
 (
__sig
, c⁄° *
__s
);

154 #ifde‡
__USE_XOPEN2K


156 
	`psigöfo
 (c⁄° 
sigöfo_t
 *
__pöfo
, c⁄° *
__s
);

167 
	`__sig∑u£
 (
__sig_‹_mask
, 
__is_sig
);

169 #ifde‡
__USE_XOPEN


170 #ifde‡
__GNUC__


171 
	$sig∑u£
 (
__sig
Ë
	`__asm__
 ("__xpg_sigpause");

174 
	#sig∑u£
(
sig
Ë
	`__sig∑u£
 ((sig), 1)

	)

179 #ifde‡
__USE_BSD


186 
	#sigmask
(
sig
Ë
	`__sigmask
(sig)

	)

189 
	$sigblock
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

192 
	$sig£tmask
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

195 
	$siggëmask
 (Ë
__THROW
 
__©åibuã_dïªˇãd__
;

199 #ifde‡
__USE_MISC


200 
	#NSIG
 
_NSIG


	)

203 #ifde‡
__USE_GNU


204 
__sigh™dÀr_t
 
	tsigh™dÀr_t
;

208 #ifde‡
__USE_BSD


209 
__sigh™dÀr_t
 
	tsig_t
;

212 #ifde‡
__USE_POSIX


215 
	$sigem±y£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

218 
	$sigfûl£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

221 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

224 
	$sigdñ£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

227 
	$sigismembî
 (c⁄° 
sig£t_t
 *
__£t
, 
__signo
)

228 
__THROW
 
	`__n⁄nuŒ
 ((1));

230 #ifde‡
__USE_GNU


232 
	$sigi£m±y£t
 (c⁄° 
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

235 
	$sig™d£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

236 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

239 
	$sig‹£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

240 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

245 
	~<bôs/siga˘i⁄.h
>

248 
	$sig¥ocmask
 (
__how
, c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

249 
sig£t_t
 *
__ª°ri˘
 
__o£t
Ë
__THROW
;

256 
	$sigsu•íd
 (c⁄° 
sig£t_t
 *
__£t
Ë
	`__n⁄nuŒ
 ((1));

259 
	$siga˘i⁄
 (
__sig
, c⁄° 
siga˘i⁄
 *
__ª°ri˘
 
__a˘
,

260 
siga˘i⁄
 *
__ª°ri˘
 
__ﬂ˘
Ë
__THROW
;

263 
	$sig≥ndög
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

270 
	$sigwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
, *__ª°ri˘ 
__sig
)

271 
	`__n⁄nuŒ
 ((1, 2));

273 #ifde‡
__USE_POSIX199309


278 
	$sigwaôöfo
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

279 
sigöfo_t
 *
__ª°ri˘
 
__öfo
Ë
	`__n⁄nuŒ
 ((1));

286 
	$sigtimedwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

287 
sigöfo_t
 *
__ª°ri˘
 
__öfo
,

288 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
)

289 
	`__n⁄nuŒ
 ((1));

293 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, c⁄° 
sigvÆ
 
__vÆ
)

294 
__THROW
;

299 #ifde‡
__USE_BSD


303 c⁄° *c⁄° 
_sys_sigli°
[
_NSIG
];

304 c⁄° *c⁄° 
sys_sigli°
[
_NSIG
];

307 
	ssigvec


309 
__sigh™dÀr_t
 
sv_h™dÀr
;

310 
sv_mask
;

312 
sv_Êags
;

313 
	#sv_⁄°ack
 
sv_Êags


	)

317 
	#SV_ONSTACK
 (1 << 0)

	)

318 
	#SV_INTERRUPT
 (1 << 1)

	)

319 
	#SV_RESETHAND
 (1 << 2)

	)

327 
	$sigvec
 (
__sig
, c⁄° 
sigvec
 *
__vec
,

328 
sigvec
 *
__ovec
Ë
__THROW
;

332 
	~<bôs/sigc⁄ãxt.h
>

335 
	$sigªtu∫
 (
sigc⁄ãxt
 *
__s˝
Ë
__THROW
;

340 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


341 
	#__√ed_size_t


	)

342 
	~<°ddef.h
>

347 
	$sigöãºu±
 (
__sig
, 
__öãºu±
Ë
__THROW
;

349 
	~<bôs/sig°ack.h
>

350 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


352 
	~<sys/uc⁄ãxt.h
>

358 
	$sig°ack
 (
sig°ack
 *
__ss
, sig°ack *
__oss
)

359 
__THROW
 
__©åibuã_dïªˇãd__
;

363 
	$sigÆt°ack
 (c⁄° 
sigÆt°ack
 *
__ª°ri˘
 
__ss
,

364 
sigÆt°ack
 *
__ª°ri˘
 
__oss
Ë
__THROW
;

368 #ifde‡
__USE_XOPEN_EXTENDED


372 
	$sighﬁd
 (
__sig
Ë
__THROW
;

375 
	$sigªl£
 (
__sig
Ë
__THROW
;

378 
	$sigign‹e
 (
__sig
Ë
__THROW
;

381 
__sigh™dÀr_t
 
	$sig£t
 (
__sig
, 
__sigh™dÀr_t
 
__di•
Ë
__THROW
;

384 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


387 
	~<bôs/±hªadty≥s.h
>

388 
	~<bôs/sigthªad.h
>

395 
	$__libc_cuºít_sigπmö
 (Ë
__THROW
;

397 
	$__libc_cuºít_sigπmax
 (Ë
__THROW
;

401 
__END_DECLS


	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


25 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	~<bôs/ty≥s.h
>

36 
	#__√ed_FILE


	)

37 
	#__√ed___FILE


	)

41 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

51 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

52 || 
deföed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_deföed
 1

	)

58 #unde‡
__√ed_FILE


61 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_deföed
 1

	)

68 #unde‡
__√ed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


77 #ifde‡
__GNUC__


78 #i‚de‡
_VA_LIST_DEFINED


79 
_G_va_li°
 
	tva_li°
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<°d¨g.h
>

87 #ifde‡
__USE_XOPEN2K8


88 #i‚de‡
__off_t_deföed


89 #i‚de‡
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_deföed


	)

96 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_deföed


	)

101 #i‚de‡
__ssize_t_deföed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_deföed


	)

108 
__BEGIN_NAMESPACE_STD


109 #i‚de‡
__USE_FILE_OFFSET64


110 
_G_Âos_t
 
	tÂos_t
;

112 
_G_Âos64_t
 
	tÂos_t
;

114 
__END_NAMESPACE_STD


115 #ifde‡
__USE_LARGEFILE64


116 
_G_Âos64_t
 
	tÂos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #i‚de‡
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #i‚de‡
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifde‡
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


151 
	#P_tmpdú
 "/tmp"

	)

164 
	~<bôs/°dio_lim.h
>

168 
_IO_FILE
 *
°dö
;

169 
_IO_FILE
 *
°dout
;

170 
_IO_FILE
 *
°dîr
;

172 
	#°dö
 
°dö


	)

173 
	#°dout
 
°dout


	)

174 
	#°dîr
 
°dîr


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

180 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifde‡
__USE_ATFILE


185 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

186 c⁄° *
__√w
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #i‚de‡
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

197 #ifde‡
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

200 
	#tmpfûe
 
tmpfûe64


	)

204 #ifde‡
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

209 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifde‡
__USE_MISC


215 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

219 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


227 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

228 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`f˛o£
 (
FILE
 *
__°ªam
);

242 
	`fÊush
 (
FILE
 *
__°ªam
);

243 
__END_NAMESPACE_STD


245 #ifde‡
__USE_MISC


252 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

255 #ifde‡
__USE_GNU


262 
	`f˛o£Æl
 ();

266 
__BEGIN_NAMESPACE_STD


267 #i‚de‡
__USE_FILE_OFFSET64


272 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

273 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

278 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

279 c⁄° *
__ª°ri˘
 
__modes
,

280 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

282 #ifde‡
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

284 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

287 c⁄° *
__ª°ri˘
 
__modes
,

288 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

289 
__wur
;

291 
	#f›í
 
f›í64


	)

292 
	#‰e›í
 
‰e›í64


	)

295 
__END_NAMESPACE_STD


296 #ifde‡
__USE_LARGEFILE64


297 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

298 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

299 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

300 c⁄° *
__ª°ri˘
 
__modes
,

301 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

313 c⁄° *
__ª°ri˘
 
__modes
,

314 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

317 #ifde‡
__USE_XOPEN2K8


319 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

337 
__modes
, 
size_t
 
__n
Ë
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

344 
size_t
 
__size
Ë
__THROW
;

347 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

357 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

362 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

364 
	$•rötf
 (*
__ª°ri˘
 
__s
,

365 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

371 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

372 
_G_va_li°
 
__¨g
);

377 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

379 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

380 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

387 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

388 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

390 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

391 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

392 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifde‡
__USE_GNU


399 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

400 
_G_va_li°
 
__¨g
)

401 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

402 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

403 c⁄° *
__ª°ri˘
 
__fmt
, ...)

404 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

405 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

406 c⁄° *
__ª°ri˘
 
__fmt
, ...)

407 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

410 #ifde‡
__USE_XOPEN2K8


412 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

413 
_G_va_li°
 
__¨g
)

414 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

415 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

416 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

426 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

431 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

433 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

434 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

436 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

437 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

438 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

439 #ifde‡
__REDIRECT


443 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

444 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

445 
__isoc99_fsˇnf
Ë
__wur
;

446 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

447 
__isoc99_sˇnf
Ë
__wur
;

448 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

449 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

450 
__isoc99_ssˇnf
);

452 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

453 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

454 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

455 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

456 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

457 
	#fsˇnf
 
__isoc99_fsˇnf


	)

458 
	#sˇnf
 
__isoc99_sˇnf


	)

459 
	#ssˇnf
 
__isoc99_ssˇnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

472 
_G_va_li°
 
__¨g
)

473 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

479 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

480 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

483 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

484 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

485 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

487 #i‡!
deföed
 
__USE_GNU
 \

488 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

489 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

490 #ifde‡
__REDIRECT


494 
	`__REDIRECT
 (
vfsˇnf
,

495 (
FILE
 *
__ª°ri˘
 
__s
,

496 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

497 
__isoc99_vfsˇnf
)

498 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

499 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

500 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

501 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

502 
	`__REDIRECT_NTH
 (
vssˇnf
,

503 (c⁄° *
__ª°ri˘
 
__s
,

504 c⁄° *
__ª°ri˘
 
__f‹m©
,

505 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

506 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

508 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

509 c⁄° *
__ª°ri˘
 
__f‹m©
,

510 
_G_va_li°
 
__¨g
Ë
__wur
;

511 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

512 
_G_va_li°
 
__¨g
Ë
__wur
;

513 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

514 c⁄° *
__ª°ri˘
 
__f‹m©
,

515 
_G_va_li°
 
__¨g
Ë
__THROW
;

516 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

517 
	#vsˇnf
 
__isoc99_vsˇnf


	)

518 
	#vssˇnf
 
__isoc99_vssˇnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fgëc
 (
FILE
 *
__°ªam
);

532 
	`gëc
 (
FILE
 *
__°ªam
);

538 
	`gëch¨
 ();

539 
__END_NAMESPACE_STD


543 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

545 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


550 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

551 
	`gëch¨_u∆ocked
 ();

554 #ifde‡
__USE_MISC


561 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

565 
__BEGIN_NAMESPACE_STD


573 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

574 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

580 
	`putch¨
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

587 #ifde‡
__USE_MISC


594 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

597 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


602 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

603 
	`putch¨_u∆ocked
 (
__c
);

607 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

608 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

610 
	`gëw
 (
FILE
 *
__°ªam
);

613 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

623 
__wur
;

625 #i‡!
deföed
 
__USE_ISOC11
 \

626 || (
deföed
 
__˝lu•lus
 && __cplusplus <= 201103L)

638 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

640 
__END_NAMESPACE_STD


642 #ifde‡
__USE_GNU


649 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

650 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

666 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

667 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

668 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

669 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

670 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

678 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

679 
size_t
 *
__ª°ri˘
 
__n
,

680 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

695 
	`puts
 (c⁄° *
__s
);

702 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

709 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

715 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

716 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifde‡
__USE_GNU


726 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

727 
FILE
 *
__ª°ri˘
 
__°ªam
);

730 #ifde‡
__USE_MISC


737 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

739 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

740 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

754 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

759 
	`ªwöd
 (
FILE
 *
__°ªam
);

760 
__END_NAMESPACE_STD


767 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


768 #i‚de‡
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

778 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

780 #ifde‡
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#·ñlo
 
·ñlo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #i‚de‡
__USE_FILE_OFFSET64


798 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

803 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

805 #ifde‡
__REDIRECT


806 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

807 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

808 
	`__REDIRECT
 (
f£ços
,

809 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

811 
	#fgëpos
 
fgëpos64


	)

812 
	#f£ços
 
f£ços64


	)

815 
__END_NAMESPACE_STD


817 #ifde‡
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

819 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

820 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

821 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

828 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

830 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifde‡
__USE_MISC


835 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

836 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

837 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`≥º‹
 (c⁄° *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<bôs/sys_îæi°.h
>

856 #ifdef 
__USE_POSIX


858 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

861 #ifde‡
__USE_MISC


863 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

867 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

868 
deföed
 
__USE_MISC
)

873 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

879 
	`p˛o£
 (
FILE
 *
__°ªam
);

883 #ifdef 
__USE_POSIX


885 *
	$˘îmid
 (*
__s
Ë
__THROW
;

889 #ifde‡
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob°ack
;

899 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

900 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

901 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

902 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

903 c⁄° *
__ª°ri˘
 
__f‹m©
,

904 
_G_va_li°
 
__¨gs
)

905 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

909 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


913 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

917 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

920 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

923 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


927 
	#__√ed_gë›t


	)

928 
	~<gë›t.h
>

933 #ifde‡
__USE_EXTERN_INLINES


934 
	~<bôs/°dio.h
>

936 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


937 
	~<bôs/°dio2.h
>

939 #ifde‡
__LDBL_COMPAT


940 
	~<bôs/°dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

34 
	g__BEGIN_DECLS


36 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


37 
	#_STDLIB_H
 1

	)

39 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


41 
	~<bôs/waôÊags.h
>

42 
	~<bôs/waô°©us.h
>

44 #ifde‡
__USE_BSD


49 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


50 
	#__WAIT_INT
(
°©us
) \

51 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

52 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

54 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

62 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
waô
 *
	m__u±r
;

70 *
	m__ùå
;

71 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

90 #ifde‡
__WIFCONTINUED


91 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquŸ
;

100 
	mªm
;

101 } 
	tdiv_t
;

104 #i‚de‡
__ldiv_t_deföed


107 
	mquŸ
;

108 
	mªm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_deföed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


115 
__BEGIN_NAMESPACE_C99


117 
__exãnsi⁄__
 struct

119 
	mquŸ
;

120 
	mªm
;

121 } 
	tŒdiv_t
;

122 
	#__Œdiv_t_deföed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

139 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (c⁄° *
__≈å
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

147 
	$©oi
 (c⁄° *
__≈å
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

150 
	$©ﬁ
 (c⁄° *
__≈å
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

152 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

158 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

173 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

175 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

176 **
__ª°ri˘
 
__íd±r
)

177 
__THROW
 
	`__n⁄nuŒ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

184 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

185 
__THROW
 
	`__n⁄nuŒ
 ((1));

187 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifde‡
__USE_BSD


194 
__exãnsi⁄__


195 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

196 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

197 
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
__exãnsi⁄__


200 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

205 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__exãnsi⁄__


209 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

210 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

211 
__THROW
 
	`__n⁄nuŒ
 ((1));

213 
__exãnsi⁄__


214 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

215 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde‡
__USE_GNU


235 
	~<xloˇÀ.h
>

239 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

240 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

241 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

243 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

248 
__exãnsi⁄__


249 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

250 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

251 
__loˇÀ_t
 
__loc
)

252 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

254 
__exãnsi⁄__


255 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__ba£
, 
__loˇÀ_t
 
__loc
)

258 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

260 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

261 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

262 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

264 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

266 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

268 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

269 **
__ª°ri˘
 
__íd±r
,

270 
__loˇÀ_t
 
__loc
)

271 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

275 #ifde‡
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__exã∫_ölöe
 

278 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

280  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

281 
	}
}

282 
__exã∫_ölöe
 

283 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

285  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exãnsi⁄__
 
__exã∫_ölöe
 

292 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

294  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

308 
	$a64l
 (c⁄° *
__s
)

309 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


314 
	~<sys/ty≥s.h
>

321 
	$øndom
 (Ë
__THROW
;

324 
	$§™dom
 (
__£ed
Ë
__THROW
;

330 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

331 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

335 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

338 #ifde‡
__USE_MISC


343 
	søndom_d©a


345 
öt32_t
 *
Âå
;

346 
öt32_t
 *
Ωå
;

347 
öt32_t
 *
°©e
;

348 
ønd_ty≥
;

349 
ønd_deg
;

350 
ønd_£p
;

351 
öt32_t
 *
íd_±r
;

354 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

355 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

357 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

358 
__THROW
 
	`__n⁄nuŒ
 ((2));

360 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

361 
size_t
 
__°©ñí
,

362 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

363 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

365 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

366 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$ønd
 (Ë
__THROW
;

376 
	$§™d
 (
__£ed
Ë
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde‡
__USE_POSIX


381 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

385 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


389 
	$dønd48
 (Ë
__THROW
;

390 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

393 
	$Ã™d48
 (Ë
__THROW
;

394 
	$ƒ™d48
 (
__xsubi
[3])

395 
__THROW
 
	`__n⁄nuŒ
 ((1));

398 
	$mønd48
 (Ë
__THROW
;

399 
	$jønd48
 (
__xsubi
[3])

400 
__THROW
 
	`__n⁄nuŒ
 ((1));

403 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__n⁄nuŒ
 ((1));

406 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

408 #ifde‡
__USE_MISC


412 
	sdønd48_d©a


414 
__x
[3];

415 
__ﬁd_x
[3];

416 
__c
;

417 
__öô
;

418 
__exãnsi⁄__
 
__a
;

423 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

424 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

425 
	$î™d48_r
 (
__xsubi
[3],

426 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

427 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

430 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

431 *
__ª°ri˘
 
__ªsu…
)

432 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

433 
	$ƒ™d48_r
 (
__xsubi
[3],

434 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

435 *
__ª°ri˘
 
__ªsu…
)

436 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

439 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

440 *
__ª°ri˘
 
__ªsu…
)

441 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

442 
	$jønd48_r
 (
__xsubi
[3],

443 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

444 *
__ª°ri˘
 
__ªsu…
)

445 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

448 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

449 
__THROW
 
	`__n⁄nuŒ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

454 
	$lc⁄g48_r
 (
__∑øm
[7],

455 
dønd48_d©a
 *
__buf„r
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

462 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


463 
	#__mÆloc_™d_ˇŒoc_deföed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

468 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

469 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

483 
	$‰ì
 (*
__±r
Ë
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$c‰ì
 (*
__±r
Ë
__THROW
;

491 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


492 
	~<Æloˇ.h
>

495 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

496 || 
deföed
 
__USE_BSD


498 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

501 #ifde‡
__USE_XOPEN2K


503 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

504 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

507 #ifde‡
__USE_ISOC11


509 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

510 
__THROW
 
__©åibuã_mÆloc__
 
	`__©åibuã_Æloc_size__
 ((2)Ë
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

519 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

521 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


523 #ifde‡
__˝lu•lus


524 "C++" 
	`©_quick_exô
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

527 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

536 
__THROW
 
	`__n⁄nuŒ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

545 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


549 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

551 
__END_NAMESPACE_STD


553 #ifde‡
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

565 
__END_NAMESPACE_STD


567 #ifde‡
__USE_GNU


570 *
	$£cuª_gëív
 (c⁄° *
__«me
)

571 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

574 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


578 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

581 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


584 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

585 
__THROW
 
	`__n⁄nuŒ
 ((2));

588 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$˛óªnv
 (Ë
__THROW
;

599 #i‡
deföed
 
__USE_MISC
 \

600 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

606 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

609 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

610 || 
deföed
 
__USE_XOPEN2K8


619 #i‚de‡
__USE_FILE_OFFSET64


620 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

622 #ifde‡
__REDIRECT


623 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

624 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

626 
	#mk°emp
 
mk°emp64


	)

629 #ifde‡
__USE_LARGEFILE64


630 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

634 #ifde‡
__USE_MISC


641 #i‚de‡
__USE_FILE_OFFSET64


642 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

644 #ifde‡
__REDIRECT


645 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

646 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

648 
	#mk°emps
 
mk°emps64


	)

651 #ifde‡
__USE_LARGEFILE64


652 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

653 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

657 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


663 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

666 #ifde‡
__USE_GNU


673 #i‚de‡
__USE_FILE_OFFSET64


674 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

676 #ifde‡
__REDIRECT


677 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

678 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

680 
	#mko°emp
 
mko°emp64


	)

683 #ifde‡
__USE_LARGEFILE64


684 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

693 #i‚de‡
__USE_FILE_OFFSET64


694 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

695 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

697 #ifde‡
__REDIRECT


698 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

699 
__Êags
), 
mko°emps64
)

700 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

702 
	#mko°emps
 
mko°emps64


	)

705 #ifde‡
__USE_LARGEFILE64


706 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

707 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

725 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

728 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


734 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

735 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

740 #i‚de‡
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com∑r_‚_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

748 #ifde‡
__USE_GNU


749 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

756 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

757 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

759 #ifde‡
__USE_EXTERN_INLINES


760 
	~<bôs/°dlib-b£¨ch.h
>

765 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

766 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

767 #ifde‡
__USE_GNU


768 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

769 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

770 
	`__n⁄nuŒ
 ((1, 4));

775 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

776 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

777 
__END_NAMESPACE_STD


779 #ifde‡
__USE_ISOC99


780 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

781 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__numî
, 
__díom
)

790 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

792 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

793 
__END_NAMESPACE_STD


795 #ifde‡
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

798 
__díom
)

799 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

800 
__END_NAMESPACE_C99


804 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

805 || 
deföed
 
__USE_SVID


812 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

813 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

818 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

819 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

824 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

825 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

828 #ifde‡
__USE_MISC


830 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

831 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

832 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

833 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

834 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

835 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

836 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

837 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

842 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

843 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

844 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

846 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

847 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

850 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

851 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

852 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

854 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

855 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

856 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
;

866 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

867 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

870 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
;

874 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

875 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

877 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

878 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifde‡
__USE_SVID


888 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

892 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


899 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

900 *c⁄° *
__ª°ri˘
 
__tokís
,

901 **
__ª°ri˘
 
__vÆuï
)

902 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

906 #ifde‡
__USE_XOPEN


908 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

914 #ifde‡
__USE_XOPEN2KXSI


916 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

919 #ifde‡
__USE_XOPEN


924 
	$gø¡±
 (
__fd
Ë
__THROW
;

928 
	$u∆ock±
 (
__fd
Ë
__THROW
;

933 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

936 #ifde‡
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

941 
__THROW
 
	`__n⁄nuŒ
 ((2));

944 
	`gë±
 ();

947 #ifde‡
__USE_BSD


951 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

952 
__THROW
 
	`__n⁄nuŒ
 ((1));

955 
	~<bôs/°dlib-Êﬂt.h
>

958 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


959 
	~<bôs/°dlib.h
>

961 #ifde‡
__LDBL_COMPAT


962 
	~<bôs/°dlib-ldbl.h
>

966 #unde‡
__√ed_mÆloc_™d_ˇŒoc


968 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

39 #i‡
deföed
 
__˝lu•lus
 && (__˝lu•lu†>199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

47 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

50 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

51 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


58 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

69 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

73 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

78 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

81 #ifde‡
__OPTIMIZE__


82 
__exã∫_Æways_ölöe
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


85  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

88 
__exã∫_Æways_ölöe
 const *

89 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


91  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifde‡
__USE_GNU


104 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

107 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

110 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

111 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

115 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

118 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

121 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

132 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

133 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

137 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

138 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

141 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

144 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

151 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

152 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

154 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

155 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

156 
__THROW
 
	`__n⁄nuŒ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifde‡
__USE_XOPEN2K8


163 
	~<xloˇÀ.h
>

166 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

167 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

169 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

170 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

173 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

174 || 
deföed
 
__USE_XOPEN2K8


176 *
	$°rdup
 (c⁄° *
__s
)

177 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

183 #i‡
deföed
 
__USE_XOPEN2K8


184 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

185 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

188 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


190 
	#°rdu∑
(
s
) \

191 (
__exãnsi⁄__
 \

193 c⁄° *
__ﬁd
 = (
s
); \

194 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

195 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

196 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

197 
	}
}))

	)

200 
	#°∫du∑
(
s
, 
n
) \

201 (
__exãnsi⁄__
 \

203 c⁄° *
__ﬁd
 = (
s
); \

204 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

205 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

206 
__√w
[
__Àn
] = '\0'; \

207 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
°rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

218 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

221 #ifde‡
__OPTIMIZE__


222 
__exã∫_Æways_ölöe
 *

223 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


225  
__buûtö_°rchr
 (
__s
, 
__c
);

228 
__exã∫_Æways_ölöe
 const *

229 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


231  
__buûtö_°rchr
 (
__s
, 
__c
);

236 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

237 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

240 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`°ºchr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

245 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

248 #ifde‡
__OPTIMIZE__


249 
__exã∫_Æways_ölöe
 *

250 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


252  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

255 
__exã∫_Æways_ölöe
 const *

256 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


258  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

264 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifde‡
__USE_GNU


271 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

274 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

277 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

278 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

286 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

289 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

290 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

292 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

296 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

297 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

298 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

300 #ifde‡
__OPTIMIZE__


301 
__exã∫_Æways_ölöe
 *

302 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


304  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

307 
__exã∫_Æways_ölöe
 const *

308 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


310  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

313 
	}
}

315 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

316 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

319 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

323 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

324 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

325 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

327 #ifde‡
__OPTIMIZE__


328 
__exã∫_Æways_ölöe
 *

329 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


331  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

334 
__exã∫_Æways_ölöe
 const *

335 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


337  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

340 
	}
}

342 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

343 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

348 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

349 
__THROW
 
	`__n⁄nuŒ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

355 c⁄° *
__ª°ri˘
 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

358 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


359 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

360 **
__ª°ri˘
 
__ßve_±r
)

361 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

364 #ifde‡
__USE_GNU


366 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

368 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

370 c⁄° *
__√edÀ
)

371 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

373 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

374 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

378 #ifde‡
__USE_GNU


382 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

383 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

384 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

388 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

389 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

390 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

391 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

392 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

393 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$°æí
 (c⁄° *
__s
)

400 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

407 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

414 
__END_NAMESPACE_STD


415 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


423 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


426 #ifde‡
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

428 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

429 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

431 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

432 
__THROW
 
	`__n⁄nuŒ
 ((2));

433 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

438 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

439 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

443 #ifde‡
__USE_XOPEN2K8


445 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

451 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

453 #ifde‡
__USE_BSD


455 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

456 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

459 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

462 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

466 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`ödex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

471 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

474 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__exã∫_Æways_ölöe
 *

476 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


478  
	`__buûtö_ödex
 (
__s
, 
__c
);

481 
__exã∫_Æways_ölöe
 const *

482 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


484  
	`__buûtö_ödex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$ödex
 (c⁄° *
__s
, 
__c
)

490 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

494 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`rödex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

499 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

502 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__exã∫_Æways_ölöe
 *

504 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


506  
	`__buûtö_rödex
 (
__s
, 
__c
);

509 
__exã∫_Æways_ölöe
 const *

510 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


512  
	`__buûtö_rödex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$rödex
 (c⁄° *
__s
, 
__c
)

518 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

523 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

527 #ifdef 
__USE_GNU


528 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

529 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

530 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

534 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

535 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

538 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

546 
__loˇÀ_t
 
__loc
)

547 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

549 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

550 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

558 c⁄° *
__ª°ri˘
 
__dñim
)

559 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

567 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

569 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

574 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

575 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

576 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

577 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

578 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

585 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

588 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

593 #i‚de‡
ba£«me


598 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£«me
 (*
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

601 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

602 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

604 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

610 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

611 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

612 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


632 
	~<bôs/°rög.h
>

635 
	~<bôs/°rög2.h
>

638 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


640 
	~<bôs/°rög3.h
>

644 
__END_DECLS


	@/usr/include/strings.h

18 #i‚def 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

24 #i‡!
deföed
 
_STRING_H
 || !deföed 
__USE_BSD


26 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 
	~<°ddef.h
>

35 #i‡
deföed
 
__˝lu•lus
 && (__˝lu•lu†>199711L || 
__GNUC_PREREQ
 (4, 4))

36 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

39 
	g__BEGIN_DECLS


41 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


43 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

44 
__THROW
 
__©åibuã_puª__
;

47 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
Ë
__THROW
;

50 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
;

53 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


56 *
	`ödex
 (*
__s
, 
__c
)

57 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

58 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

59 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

61 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRING_H_PROTO


62 
__exã∫_Æways_ölöe
 *

63 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


65  
	`__buûtö_ödex
 (
__s
, 
__c
);

68 
__exã∫_Æways_ölöe
 const *

69 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


71  
	`__buûtö_ödex
 (
__s
, 
__c
);

74 
	}
}

76 *
	$ödex
 (c⁄° *
__s
, 
__c
)

77 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

81 #ifde‡
__CORRECT_ISO_CPP_STRINGS_H_PROTO


84 *
	`rödex
 (*
__s
, 
__c
)

85 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

86 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

87 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

89 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRING_H_PROTO


90 
__exã∫_Æways_ölöe
 *

91 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


93  
	`__buûtö_rödex
 (
__s
, 
__c
);

96 
__exã∫_Æways_ölöe
 const *

97 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


99  
	`__buûtö_rödex
 (
__s
, 
__c
);

102 
	}
}

104 *
	$rödex
 (c⁄° *
__s
, 
__c
)

105 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

109 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8
 || deföed 
__USE_XOPEN2K8XSI


112 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((const));

116 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

117 
__THROW
 
__©åibuã_puª__
;

120 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©åibuã_puª__
;

123 #ifdef 
__USE_XOPEN2K8


127 
	~<xloˇÀ.h
>

131 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__loc
)

132 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

134 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

135 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

136 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

139 
__END_DECLS


	@/usr/include/syslog.h

1 
	~<sys/sy¶og.h
>

	@/usr/include/time.h

22 #i‚def 
_TIME_H


24 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

25 ! 
deföed
 
	g__√ed_time•ec
)

26 
	#_TIME_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__√ed_size_t


	)

36 
	#__√ed_NULL


	)

37 
	~<°ddef.h
>

41 
	~<bôs/time.h
>

44 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


45 #i‚de‡
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

53 
	#__˛ock_t_deföed
 1

	)

55 
	~<bôs/ty≥s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__˛ock_t
 
	t˛ock_t
;

60 
	g__END_NAMESPACE_STD


61 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

66 #unde‡
__√ed_˛ock_t


68 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

69 
	#__time_t_deföed
 1

	)

71 
	~<bôs/ty≥s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde‡
__√ed_time_t


84 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

85 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

86 
	#__˛ockid_t_deföed
 1

	)

88 
	~<bôs/ty≥s.h
>

91 
__˛ockid_t
 
	t˛ockid_t
;

94 #unde‡
__˛ockid_time_t


96 #i‡!
deföed
 
__timî_t_deföed
 && \

97 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

98 
	#__timî_t_deföed
 1

	)

100 
	~<bôs/ty≥s.h
>

103 
__timî_t
 
	ttimî_t
;

106 #unde‡
__√ed_timî_t


109 #i‡(!
deföed
 
__time•ec_deföed
 \

110 && ((
deföed
 
_TIME_H
 \

111 && (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
 \

112 || 
deföed
 
__USE_ISOC11
)) \

113 || 
deföed
 
__√ed_time•ec
))

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 c⁄° *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 c⁄° *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 #ifde‡
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

195 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

196 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

199 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

205 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

206 c⁄° *
__ª°ri˘
 
__f‹m©
,

207 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde‡
__USE_XOPEN


213 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

214 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

215 
__THROW
;

218 #ifde‡
__USE_XOPEN2K8


221 
	~<xloˇÀ.h
>

223 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

224 c⁄° *
__ª°ri˘
 
__f‹m©
,

225 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

229 #ifde‡
__USE_GNU


230 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

231 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

232 
__loˇÀ_t
 
__loc
Ë
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

243 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

244 
__END_NAMESPACE_STD


246 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

250 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

254 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

255 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

264 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

265 
__END_NAMESPACE_STD


267 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


272 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

273 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

277 *
__ª°ri˘
 
__buf
Ë
__THROW
;

282 *
__tz«me
[2];

283 
__daylight
;

284 
__timez⁄e
;

287 #ifdef 
__USE_POSIX


289 *
tz«me
[2];

293 
	$tz£t
 (Ë
__THROW
;

296 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


297 
daylight
;

298 
timez⁄e
;

301 #ifde‡
__USE_SVID


304 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

310 
	#__i¶óp
(
yór
) \

311 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

314 #ifde‡
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

322 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

325 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

329 #ifde‡
__USE_POSIX199309


334 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

335 
time•ec
 *
__ªmaöög
);

339 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

342 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

345 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

346 
__THROW
;

348 #ifde‡
__USE_XOPEN2K


353 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

354 c⁄° 
time•ec
 *
__ªq
,

355 
time•ec
 *
__ªm
);

358 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

363 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

364 
sigevít
 *
__ª°ri˘
 
__evp
,

365 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

368 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

371 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

372 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

373 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

376 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

377 
__THROW
;

380 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

384 #ifde‡
__USE_ISOC11


386 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__n⁄nuŒ
 ((1));

391 #ifde‡
__USE_XOPEN_EXTENDED


403 
gëd©e_îr
;

412 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

415 #ifde‡
__USE_GNU


426 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

427 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #i‚def 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


32 #ifde‡
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #ñi‡
deföed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #ñi‡
deföed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #ñi‡
deföed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifde‡
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #ñi‡
deföed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #ñi‡
deföed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifde‡
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #ñi‡
deföed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #ñi‡
deföed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<bôs/posix_›t.h
>

205 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


206 
	~<bôs/ívú⁄míts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<bôs/ty≥s.h
>

219 #i‚def 
__ssize_t_deföed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_deföed


	)

224 
	#__√ed_size_t


	)

225 
	#__√ed_NULL


	)

226 
	~<°ddef.h
>

228 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


231 #i‚de‡
__gid_t_deföed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_deföed


	)

236 #i‚de‡
__uid_t_deföed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_deföed


	)

241 #i‚de‡
__off_t_deföed


242 #i‚de‡
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_deföed


	)

249 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_deföed


	)

254 #i‚de‡
__u£c⁄ds_t_deföed


255 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

256 
	#__u£c⁄ds_t_deföed


	)

259 #i‚de‡
__pid_t_deföed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_deföed


	)

265 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


266 #i‚de‡
__öçå_t_deföed


267 
__öçå_t
 
	töçå_t
;

268 
	#__öçå_t_deföed


	)

272 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


273 #i‚de‡
__sockÀn_t_deföed


274 
__sockÀn_t
 
	tsockÀn_t
;

275 
	#__sockÀn_t_deföed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$ac˚ss
 (c⁄° *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

289 #ifde‡
__USE_GNU


292 
	$euidac˚ss
 (c⁄° *
__«me
, 
__ty≥
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

296 
	$óc˚ss
 (c⁄° *
__«me
, 
__ty≥
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1));

300 #ifde‡
__USE_ATFILE


304 
	$Ác˚sßt
 (
__fd
, c⁄° *
__fûe
, 
__ty≥
, 
__Êag
)

305 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

310 #i‚def 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifde‡
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #i‡
deföed
 
__USE_BSD
 && !deföed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #i‚de‡
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

336 #ifde‡
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifde‡
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

346 
__THROW
;

353 
	`˛o£
 (
__fd
);

360 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

366 
ssize_t
 
	$wrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
Ë
__wur
;

368 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


369 #i‚de‡
__USE_FILE_OFFSET64


376 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

377 
__off_t
 
__off£t
Ë
__wur
;

384 
ssize_t
 
	$pwrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
Ë
__wur
;

387 #ifde‡
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

389 
__off64_t
 
__off£t
),

390 
¥ód64
Ë
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, c⁄° *
__buf
,

392 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

393 
pwrôe64
Ë
__wur
;

395 
	#¥ód
 
¥ód64


	)

396 
	#pwrôe
 
pwrôe64


	)

400 #ifde‡
__USE_LARGEFILE64


404 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

405 
__off64_t
 
__off£t
Ë
__wur
;

408 
ssize_t
 
	$pwrôe64
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
Ë
__wur
;

417 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

419 #ifde‡
__USE_GNU


422 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

432 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

444 
	`¶ìp
 (
__£c⁄ds
);

446 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

447 || 
deföed
 
__USE_BSD


452 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

453 
__THROW
;

460 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

469 
	`∑u£
 ();

473 
	$chown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

476 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

483 
	$lchown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

488 #ifde‡
__USE_ATFILE


491 
	$fchow«t
 (
__fd
, c⁄° *
__fûe
, 
__uid_t
 
__ow√r
,

492 
__gid_t
 
__group
, 
__Êag
)

493 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

497 
	$chdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

499 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


501 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

511 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

520 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

521 || 
deföed
 
__USE_BSD


525 *
	$gëwd
 (*
__buf
)

526 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

531 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

536 #ifde‡
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

543 **
__ívú⁄
;

544 #ifde‡
__USE_GNU


545 **
ívú⁄
;

551 
	$execve
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[],

552 *c⁄° 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

554 #ifde‡
__USE_XOPEN2K8


557 
	$„xecve
 (
__fd
, *c⁄° 
__¨gv
[], *c⁄° 
__ívp
[])

558 
__THROW
 
	`__n⁄nuŒ
 ((2));

563 
	$execv
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[])

564 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

568 
	$exe˛e
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

569 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

573 
	$exe˛
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

578 
	$execvp
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[])

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

584 
	$exe˛p
 (c⁄° *
__fûe
, c⁄° *
__¨g
, ...)

585 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

587 #ifde‡
__USE_GNU


590 
	$execv≥
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[],

591 *c⁄° 
__ívp
[])

592 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

596 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


598 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

603 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

609 
	~<bôs/c⁄‚ame.h
>

612 
	$∑thc⁄f
 (c⁄° *
__∑th
, 
__«me
)

613 
__THROW
 
	`__n⁄nuŒ
 ((1));

616 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

619 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

628 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

631 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

634 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

637 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

638 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


639 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

646 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

648 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


660 
	$£çgΩ
 (Ë
__THROW
;

667 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

669 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


671 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

675 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

678 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

681 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

684 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

689 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

702 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


705 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
 
__wur
;

708 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


710 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

719 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


722 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
 
__wur
;

725 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


727 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

730 #ifde‡
__USE_GNU


733 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

734 
__THROW
;

738 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

739 
__THROW
;

743 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

744 
__THROW
 
__wur
;

748 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$f‹k
 (Ë
__THROWNL
;

758 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

759 || 
deföed
 
__USE_BSD


764 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

770 *
	$ây«me
 (
__fd
Ë
__THROW
;

774 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

775 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

779 
	$ißây
 (
__fd
Ë
__THROW
;

781 #i‡
deföed
 
__USE_BSD
 \

782 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_UNIX98
)

785 
	$ây¶Ÿ
 (Ë
__THROW
;

790 
	$lök
 (c⁄° *
__‰om
, c⁄° *
__to
)

791 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

793 #ifde‡
__USE_ATFILE


796 
	$lök©
 (
__‰omfd
, c⁄° *
__‰om
, 
__tofd
,

797 c⁄° *
__to
, 
__Êags
)

798 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

801 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


803 
	$symlök
 (c⁄° *
__‰om
, c⁄° *
__to
)

804 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

809 
ssize_t
 
	$ªadlök
 (c⁄° *
__ª°ri˘
 
__∑th
,

810 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

811 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

814 #ifde‡
__USE_ATFILE


816 
	$symlök©
 (c⁄° *
__‰om
, 
__tofd
,

817 c⁄° *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

820 
ssize_t
 
	$ªadlök©
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

821 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

822 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

826 
	$u∆ök
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

828 #ifde‡
__USE_ATFILE


830 
	$u∆ök©
 (
__fd
, c⁄° *
__«me
, 
__Êag
)

831 
__THROW
 
	`__n⁄nuŒ
 ((2));

835 
	$rmdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

839 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

842 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

849 *
	`gëlogö
 ();

850 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_POSIX199506


857 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

860 #ifdef 
__USE_BSD


862 
	$£éogö
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

866 #ifdef 
__USE_POSIX2


870 
	#__√ed_gë›t


	)

871 
	~<gë›t.h
>

875 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


879 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

883 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

886 
	$£tho°«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

887 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

891 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

897 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

898 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

899 
	$£tdomaö«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

900 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

906 
	$vh™gup
 (Ë
__THROW
;

909 
	$ªvoke
 (c⁄° *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

917 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

918 
size_t
 
__off£t
, 
__sˇÀ
)

919 
__THROW
 
	`__n⁄nuŒ
 ((1));

925 
	$ac˘
 (c⁄° *
__«me
Ë
__THROW
;

929 *
	$gëu£rshñl
 (Ë
__THROW
;

930 
	$ídu£rshñl
 (Ë
__THROW
;

931 
	$£tu£rshñl
 (Ë
__THROW
;

937 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

941 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

944 
	$chroŸ
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

948 *
	$gë∑ss
 (c⁄° *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

956 
	`fsync
 (
__fd
);

959 #ifde‡
__USE_GNU


962 
	$syncfs
 (
__fd
Ë
__THROW
;

966 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


969 
	`gëho°id
 ();

972 
	$sync
 (Ë
__THROW
;

975 #i‡
deföed
 
__USE_BSD
 || !deföed 
__USE_XOPEN2K


978 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

983 
	$gëdèbÀsize
 (Ë
__THROW
;

989 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


992 #i‚de‡
__USE_FILE_OFFSET64


993 
	$åunˇã
 (c⁄° *
__fûe
, 
__off_t
 
__Àngth
)

994 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

996 #ifde‡
__REDIRECT_NTH


997 
	`__REDIRECT_NTH
 (
åunˇã
,

998 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
),

999 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1001 
	#åunˇã
 
åunˇã64


	)

1004 #ifde‡
__USE_LARGEFILE64


1005 
	$åunˇã64
 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
)

1006 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1011 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_POSIX199309
 \

1012 || 
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1015 #i‚de‡
__USE_FILE_OFFSET64


1016 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1018 #ifde‡
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1020 
·runˇã64
Ë
__wur
;

1022 
	#·runˇã
 
·runˇã64


	)

1025 #ifde‡
__USE_LARGEFILE64


1026 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1032 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

1033 || 
deföed
 
__USE_MISC


1037 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1043 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1047 #ifde‡
__USE_MISC


1058 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1063 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1075 
	#F_ULOCK
 0

	)

1076 
	#F_LOCK
 1

	)

1077 
	#F_TLOCK
 2

	)

1078 
	#F_TEST
 3

	)

1080 #i‚de‡
__USE_FILE_OFFSET64


1081 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1083 #ifde‡
__REDIRECT


1084 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1085 
lockf64
Ë
__wur
;

1087 
	#lockf
 
lockf64


	)

1090 #ifde‡
__USE_LARGEFILE64


1091 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1096 #ifde‡
__USE_GNU


1101 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1102 (
__exãnsi⁄__
 \

1103 ({ 
__ªsu…
; \

1104 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1105 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1106 
__ªsu…
; 
	}
}))

	)

1109 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1112 
fd©async
 (
__fûdes
);

1118 #ifdef 
__USE_XOPEN


1120 *
	$¸y±
 (c⁄° *
__key
, c⁄° *
__ß…
)

1121 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1125 
	$í¸y±
 (*
__glibc_block
, 
__edÊag
)

1126 
__THROW
 
	`__n⁄nuŒ
 ((1));

1133 
	$swab
 (c⁄° *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1134 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1140 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K


1142 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1147 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1148 
	~<bôs/uni°d.h
>

1151 
__END_DECLS


	@/usr/include/valgrind/valgrind.h

73 #i‚de‡
__VALGRIND_H


74 
	#__VALGRIND_H


	)

91 
	#__VALGRIND_MAJOR__
 3

	)

92 
	#__VALGRIND_MINOR__
 10

	)

95 
	~<°d¨g.h
>

111 #unde‡
PLAT_x86_d¨wö


112 #unde‡
PLAT_amd64_d¨wö


113 #unde‡
PLAT_x86_wö32


114 #unde‡
PLAT_amd64_wö64


115 #unde‡
PLAT_x86_löux


116 #unde‡
PLAT_amd64_löux


117 #unde‡
PLAT_µc32_löux


118 #unde‡
PLAT_µc64be_löux


119 #unde‡
PLAT_µc64À_löux


120 #unde‡
PLAT_¨m_löux


121 #unde‡
PLAT_¨m64_löux


122 #unde‡
PLAT_s390x_löux


123 #unde‡
PLAT_mùs32_löux


124 #unde‡
PLAT_mùs64_löux


127 #i‡
deföed
(
__APPLE__
Ë&& deföed(
__i386__
)

128 
	#PLAT_x86_d¨wö
 1

	)

129 #ñi‡
deföed
(
__APPLE__
Ë&& deföed(
__x86_64__
)

130 
	#PLAT_amd64_d¨wö
 1

	)

131 #ñi‡(
deföed
(
__MINGW32__
Ë&& !deföed(
__MINGW64__
)) \

132 || 
deföed
(
__CYGWIN32__
) \

133 || (
deföed
(
_WIN32
Ë&& 
	$deföed
(
_M_IX86
))

134 
	#PLAT_x86_wö32
 1

	)

135 #ñi‡
	`deföed
(
__MINGW64__
) \

136 || (
	`deföed
(
_WIN64
Ë&& 
	$deföed
(
_M_X64
))

137 
	#PLAT_amd64_wö64
 1

	)

138 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__i386__
)

139 
	#PLAT_x86_löux
 1

	)

140 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__x86_64__
)

141 
	#PLAT_amd64_löux
 1

	)

142 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__powîpc__
Ë&& !deföed(
__powîpc64__
)

143 
	#PLAT_µc32_löux
 1

	)

144 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__powîpc__
Ë&& deföed(
__powîpc64__
Ë&& 
_CALL_ELF
 != 2

146 
	#PLAT_µc64be_löux
 1

	)

147 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__powîpc__
Ë&& deföed(
__powîpc64__
Ë&& 
_CALL_ELF
 == 2

149 
	#PLAT_µc64À_löux
 1

	)

150 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__¨m__
Ë&& !deföed(
__Ørch64__
)

151 
	#PLAT_¨m_löux
 1

	)

152 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__Ørch64__
Ë&& !deföed(
__¨m__
)

153 
	#PLAT_¨m64_löux
 1

	)

154 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__s390__
Ë&& deföed(
__s390x__
)

155 
	#PLAT_s390x_löux
 1

	)

156 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__mùs__
Ë&& (
__mùs
==64)

157 
	#PLAT_mùs64_löux
 1

	)

158 #ñi‡
	`deföed
(
__löux__
Ë&& deföed(
__mùs__
Ë&& (
__mùs
!=64)

159 
	#PLAT_mùs32_löux
 1

	)

163 #i‡!
	`deföed
(
NVALGRIND
)

164 
	#NVALGRIND
 1

	)

187 
	#VALGRIND_DO_CLIENT_REQUEST
(
_zzq_ævÆ
, 
_zzq_deÁu…
, \

188 
_zzq_ªque°
, 
_zzq_¨g1
, 
_zzq_¨g2
, \

189 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

190 dÿ{ (
_zzq_ævÆ
Ë
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
((
_zzq_deÁu…
), \

191 (
_zzq_ªque°
), (
_zzq_¨g1
), (
_zzq_¨g2
), \

192 (
_zzq_¨g3
), (
_zzq_¨g4
), (
_zzq_¨g5
)); 
	}
} 0)

	)

194 
	#VALGRIND_DO_CLIENT_REQUEST_STMT
(
_zzq_ªque°
, 
_zzq_¨g1
, \

195 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

196 dÿ{ (Ë
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

197 (
_zzq_ªque°
), (
_zzq_¨g1
), (
_zzq_¨g2
), \

198 (
_zzq_¨g3
), (
_zzq_¨g4
), (
_zzq_¨g5
)); } 0)

	)

200 #i‡
deföed
(
NVALGRIND
)

205 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

206 
_zzq_deÁu…
, 
_zzq_ªque°
, \

207 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

208 (
_zzq_deÁu…
)

	)

249 #i‡
deföed
(
PLAT_x86_löux
Ë|| deföed(
PLAT_x86_d¨wö
) \

250 || (
deföed
(
PLAT_x86_wö32
Ë&& 
	$deföed
(
__GNUC__
))

254 
ƒaddr
;

256 
	tOrigFn
;

258 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

260 "rﬁ»$29, %%edò;Ñﬁ»$19, %%edi\n\t"

	)

262 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

263 
_zzq_deÁu…
, 
_zzq_ªque°
, \

264 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

265 
__exãnsi⁄__
 \

266 ({vﬁ©ûê
_zzq_¨gs
[6]; \

267 vﬁ©ûê
_zzq_ªsu…
; \

268 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

269 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

270 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

271 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

272 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

273 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

274 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

277 : "=d" (
_zzq_ªsu…
) \

278 : "a" (&
_zzq_¨gs
[0]), "0" (
_zzq_deÁu…
) \

281 
_zzq_ªsu…
; \

282 
	}
})

	)

284 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

285 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

286 vﬁ©ûê
__addr
; \

287 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

290 : "˜" (
__addr
) \

294 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

295 }

	)

297 
	#VALGRIND_CALL_NOREDIR_EAX
 \

298 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

300 "xchg»%%edx,%%edx\n\t"

	)

302 
	#VALGRIND_VEX_INJECT_IR
() \

304 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

308 } 0)

	)

314 #i‡
deföed
(
PLAT_x86_wö32
Ë&& !deföed(
__GNUC__
)

318 
	mƒaddr
;

320 
	tOrigFn
;

322 #i‡
deföed
(
_MSC_VER
)

324 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

325 
__asm
 
rﬁ
 
edi
, 3 __asmÑolÉdi, 13 \

326 
__asm
 
rﬁ
 
edi
, 29 __asmÑﬁÉdi, 19

	)

328 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

329 
_zzq_deÁu…
, 
_zzq_ªque°
, \

330 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

331 
	`vÆgröd_do_˛õ¡_ªque°_ex¥
((
uöçå_t
)(
_zzq_deÁu…
), \

332 (
uöçå_t
)(
_zzq_ªque°
), (uöçå_t)(
_zzq_¨g1
), \

333 (
uöçå_t
)(
_zzq_¨g2
), (uöçå_t)(
_zzq_¨g3
), \

334 (
uöçå_t
)(
_zzq_¨g4
), (uöçå_t)(
_zzq_¨g5
))

	)

336 
__ölöe
 
uöçå_t


337 
	$vÆgröd_do_˛õ¡_ªque°_ex¥
(
uöçå_t
 
_zzq_deÁu…
, uöçå_à
_zzq_ªque°
,

338 
uöçå_t
 
_zzq_¨g1
, uöçå_à
_zzq_¨g2
,

339 
uöçå_t
 
_zzq_¨g3
, uöçå_à
_zzq_¨g4
,

340 
uöçå_t
 
_zzq_¨g5
)

342 vﬁ©ûê
uöçå_t
 
_zzq_¨gs
[6];

343 vﬁ©ûê
_zzq_ªsu…
;

344 
_zzq_¨gs
[0] = (
uöçå_t
)(
_zzq_ªque°
);

345 
_zzq_¨gs
[1] = (
uöçå_t
)(
_zzq_¨g1
);

346 
_zzq_¨gs
[2] = (
uöçå_t
)(
_zzq_¨g2
);

347 
_zzq_¨gs
[3] = (
uöçå_t
)(
_zzq_¨g3
);

348 
_zzq_¨gs
[4] = (
uöçå_t
)(
_zzq_¨g4
);

349 
_zzq_¨gs
[5] = (
uöçå_t
)(
_zzq_¨g5
);

350 
__asm
 { __asm 
Àa
 
óx
, 
_zzq_¨gs
 __asm 
mov
 
edx
, 
_zzq_deÁu…


351 
__SPECIAL_INSTRUCTION_PREAMBLE


353 
__asm
 
xchg
 
ebx
,ebx

354 
__asm
 
mov
 
_zzq_ªsu…
, 
edx


356  
_zzq_ªsu…
;

357 
	}
}

359 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

360 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

361 vﬁ©ûê
__addr
; \

362 
__asm
 { 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

364 
__asm
 
xchg
 
ecx
,ecx \

365 
__asm
 
mov
 
__addr
, 
óx
 \

367 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

368 }

	)

370 
	#VALGRIND_CALL_NOREDIR_EAX
 
ERROR


	)

372 
	#VALGRIND_VEX_INJECT_IR
() \

374 
__asm
 { 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

375 
__asm
 
xchg
 
edi
,edi \

377 } 0)

	)

380 #îr‹ 
Unsuµ‹ãd
 
compûî
.

387 #i‡
deföed
(
PLAT_amd64_löux
Ë|| deföed(
PLAT_amd64_d¨wö
) \

388 || (
deföed
(
PLAT_amd64_wö64
Ë&& 
	$deföed
(
__GNUC__
))

392 
ƒaddr
;

394 
	tOrigFn
;

396 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

398 "rﬁq $61, %%rdò;Ñﬁq $51, %%rdi\n\t"

	)

400 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

401 
_zzq_deÁu…
, 
_zzq_ªque°
, \

402 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

403 
__exãnsi⁄__
 \

404 ({ vﬁ©ûê
_zzq_¨gs
[6]; \

405 vﬁ©ûê
_zzq_ªsu…
; \

406 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

407 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

408 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

409 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

410 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

411 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

412 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

415 : "=d" (
_zzq_ªsu…
) \

416 : "a" (&
_zzq_¨gs
[0]), "0" (
_zzq_deÁu…
) \

419 
_zzq_ªsu…
; \

420 
	}
})

	)

422 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

423 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

424 vﬁ©ûê
__addr
; \

425 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

428 : "˜" (
__addr
) \

432 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

433 }

	)

435 
	#VALGRIND_CALL_NOREDIR_RAX
 \

436 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

438 "xchgq %%rdx,%%rdx\n\t"

	)

440 
	#VALGRIND_VEX_INJECT_IR
() \

442 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

446 } 0)

	)

452 #i‡
deföed
(
PLAT_amd64_wö64
Ë&& !deföed(
__GNUC__
)

454 #îr‹ 
Unsuµ‹ãd
 
compûî
.

460 #i‡
deföed
(
PLAT_µc32_löux
)

464 
	mƒaddr
;

466 
	tOrigFn
;

468 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

470 "æwöm 0,0,29,0,31 ;Ñlwöm 0,0,19,0,31\n\t"

	)

472 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

473 
_zzq_deÁu…
, 
_zzq_ªque°
, \

474 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

476 
__exãnsi⁄__
 \

477 ({ 
_zzq_¨gs
[6]; \

478 
_zzq_ªsu…
; \

479 * 
_zzq_±r
; \

480 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

481 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

482 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

483 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

484 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

485 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

486 
_zzq_±r
 = 
_zzq_¨gs
; \

487 
__asm__
 volatile("mr 3,%1\n\t" \

489 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

493 : "=b" (
_zzq_ªsu…
) \

494 : "b" (
_zzq_deÁu…
), "b" (
_zzq_±r
) \

496 
_zzq_ªsu…
; \

497 })

	)

499 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

500 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

501 
__addr
; \

502 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

506 : "=b" (
__addr
) \

510 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

511 }

	)

513 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

514 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

516 "‹ 3,3,3\n\t"

	)

518 
	#VALGRIND_VEX_INJECT_IR
() \

520 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

523 } 0)

	)

529 #i‡
deföed
(
PLAT_µc64be_löux
)

533 
	mƒaddr
;

534 
	mr2
;

536 
	tOrigFn
;

538 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

540 "rŸldò0,0,61 ;ÑŸldò0,0,51\n\t"

	)

542 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

543 
_zzq_deÁu…
, 
_zzq_ªque°
, \

544 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

546 
__exãnsi⁄__
 \

547 ({ 
_zzq_¨gs
[6]; \

548 
_zzq_ªsu…
; \

549 * 
_zzq_±r
; \

550 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

551 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

552 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

553 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

554 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

555 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

556 
_zzq_±r
 = 
_zzq_¨gs
; \

557 
__asm__
 volatile("mr 3,%1\n\t" \

559 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

563 : "=b" (
_zzq_ªsu…
) \

564 : "b" (
_zzq_deÁu…
), "b" (
_zzq_±r
) \

566 
_zzq_ªsu…
; \

567 })

	)

569 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

570 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

571 
__addr
; \

572 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

576 : "=b" (
__addr
) \

580 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

581 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

585 : "=b" (
__addr
) \

589 
_zzq_‹ig
->
r2
 = 
__addr
; \

590 }

	)

592 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

593 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

595 "‹ 3,3,3\n\t"

	)

597 
	#VALGRIND_VEX_INJECT_IR
() \

599 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

602 } 0)

	)

606 #i‡
deföed
(
PLAT_µc64À_löux
)

610 
	mƒaddr
;

611 
	mr2
;

613 
	tOrigFn
;

615 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

617 "rŸldò0,0,61 ;ÑŸldò0,0,51\n\t"

	)

619 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

620 
_zzq_deÁu…
, 
_zzq_ªque°
, \

621 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

623 
__exãnsi⁄__
 \

624 ({ 
_zzq_¨gs
[6]; \

625 
_zzq_ªsu…
; \

626 * 
_zzq_±r
; \

627 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

628 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

629 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

630 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

631 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

632 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

633 
_zzq_±r
 = 
_zzq_¨gs
; \

634 
__asm__
 volatile("mr 3,%1\n\t" \

636 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

640 : "=b" (
_zzq_ªsu…
) \

641 : "b" (
_zzq_deÁu…
), "b" (
_zzq_±r
) \

643 
_zzq_ªsu…
; \

644 })

	)

646 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

647 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

648 
__addr
; \

649 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

653 : "=b" (
__addr
) \

657 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

658 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

662 : "=b" (
__addr
) \

666 
_zzq_‹ig
->
r2
 = 
__addr
; \

667 }

	)

669 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

670 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

672 "‹ 3,3,3\n\t"

	)

674 
	#VALGRIND_VEX_INJECT_IR
() \

676 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

679 } 0)

	)

685 #i‡
deföed
(
PLAT_¨m_löux
)

689 
	mƒaddr
;

691 
	tOrigFn
;

693 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

695 "movÑ12,Ñ12,Ñ‹ #29 ; movÑ12,Ñ12,Ñ‹ #19 \n\t"

	)

697 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

698 
_zzq_deÁu…
, 
_zzq_ªque°
, \

699 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

701 
__exãnsi⁄__
 \

702 ({vﬁ©ûê
_zzq_¨gs
[6]; \

703 vﬁ©ûê
_zzq_ªsu…
; \

704 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

705 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

706 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

707 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

708 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

709 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

710 
__asm__
 volatile("movÑ3, %1\n\t" \

712 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

716 : "Ù" (
_zzq_ªsu…
) \

717 : "r" (
_zzq_deÁu…
), "r" (&
_zzq_¨gs
[0]) \

719 
_zzq_ªsu…
; \

720 })

	)

722 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

723 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

724 
__addr
; \

725 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

729 : "Ù" (
__addr
) \

733 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

734 }

	)

736 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

737 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

739 "‹∏r12,Ñ12,Ñ12\n\t"

	)

741 
	#VALGRIND_VEX_INJECT_IR
() \

743 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

747 } 0)

	)

753 #i‡
deföed
(
PLAT_¨m64_löux
)

757 
	mƒaddr
;

759 
	tOrigFn
;

761 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

763 "r‹ x12, x12, #51 ;Ñ‹ x12, x12, #61 \n\t"

	)

765 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

766 
_zzq_deÁu…
, 
_zzq_ªque°
, \

767 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

769 
__exãnsi⁄__
 \

770 ({vﬁ©ûê
_zzq_¨gs
[6]; \

771 vﬁ©ûê
_zzq_ªsu…
; \

772 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

773 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

774 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

775 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

776 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

777 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

778 
__asm__
 volatile("mov x3, %1\n\t" \

780 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

784 : "Ù" (
_zzq_ªsu…
) \

785 : "r" (
_zzq_deÁu…
), "r" (&
_zzq_¨gs
[0]) \

787 
_zzq_ªsu…
; \

788 })

	)

790 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

791 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

792 
__addr
; \

793 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

797 : "Ù" (
__addr
) \

801 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

802 }

	)

804 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

805 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

807 "‹∏x12, x12, x12\n\t"

	)

809 
	#VALGRIND_VEX_INJECT_IR
() \

811 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

815 } 0)

	)

821 #i‡
deföed
(
PLAT_s390x_löux
)

825 
	mƒaddr
;

827 
	tOrigFn
;

833 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

837 "Ã 3,3\n\t"

	)

839 
	#__CLIENT_REQUEST_CODE
 "Ã 2,2\n\t"

	)

840 
	#__GET_NR_CONTEXT_CODE
 "Ã 3,3\n\t"

	)

841 
	#__CALL_NO_REDIR_CODE
 "Ã 4,4\n\t"

	)

842 
	#__VEX_INJECT_IR_CODE
 "Ã 5,5\n\t"

	)

844 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

845 
_zzq_deÁu…
, 
_zzq_ªque°
, \

846 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

847 
__exãnsi⁄__
 \

848 ({vﬁ©ûê
_zzq_¨gs
[6]; \

849 vﬁ©ûê
_zzq_ªsu…
; \

850 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

851 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

852 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

853 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

854 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

855 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

856 
__asm__
 volatile( \

860 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

861 
__CLIENT_REQUEST_CODE
 \

864 : "=d" (
_zzq_ªsu…
) \

865 : "a" (&
_zzq_¨gs
[0]), "0" (
_zzq_deÁu…
) \

868 
_zzq_ªsu…
; \

869 })

	)

871 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

872 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

873 vﬁ©ûê
__addr
; \

874 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

875 
__GET_NR_CONTEXT_CODE
 \

877 : "˜" (
__addr
) \

881 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

882 }

	)

884 
	#VALGRIND_CALL_NOREDIR_R1
 \

885 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

886 
__CALL_NO_REDIR_CODE


	)

888 
	#VALGRIND_VEX_INJECT_IR
() \

890 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

891 
__VEX_INJECT_IR_CODE
); \

892 } 0)

	)

898 #i‡
deföed
(
PLAT_mùs32_löux
)

902 
	mƒaddr
;

904 
	tOrigFn
;

910 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

914 "§»$0, $0, 19\n\t"

	)

916 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

917 
_zzq_deÁu…
, 
_zzq_ªque°
, \

918 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

919 
__exãnsi⁄__
 \

920 ({ vﬁ©ûê
_zzq_¨gs
[6]; \

921 vﬁ©ûê
_zzq_ªsu…
; \

922 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

923 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

924 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

925 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

926 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

927 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

928 
__asm__
 volatile("move $11, %1\n\t" \

930 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

934 : "Ù" (
_zzq_ªsu…
) \

935 : "r" (
_zzq_deÁu…
), "r" (&
_zzq_¨gs
[0]) \

937 
_zzq_ªsu…
; \

938 })

	)

940 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

941 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

942 vﬁ©ûê
__addr
; \

943 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

947 : "Ù" (
__addr
) \

951 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

952 }

	)

954 
	#VALGRIND_CALL_NOREDIR_T9
 \

955 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

957 "‹ $15, $15, $15\n\t"

	)

959 
	#VALGRIND_VEX_INJECT_IR
() \

961 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

964 } 0)

	)

971 #i‡
deföed
(
PLAT_mùs64_löux
)

975 
	mƒaddr
;

977 
	tOrigFn
;

983 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

985 "d¶»$0,$0,29 ; d¶»$0,$0,19\n\t"

	)

987 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

988 
_zzq_deÁu…
, 
_zzq_ªque°
, \

989 
_zzq_¨g1
, 
_zzq_¨g2
, 
_zzq_¨g3
, 
_zzq_¨g4
, 
_zzq_¨g5
) \

990 
__exãnsi⁄__
 \

991 ({ vﬁ©ûê
_zzq_¨gs
[6]; \

992 vﬁ©ûê
_zzq_ªsu…
; \

993 
_zzq_¨gs
[0] = ()(
_zzq_ªque°
); \

994 
_zzq_¨gs
[1] = ()(
_zzq_¨g1
); \

995 
_zzq_¨gs
[2] = ()(
_zzq_¨g2
); \

996 
_zzq_¨gs
[3] = ()(
_zzq_¨g3
); \

997 
_zzq_¨gs
[4] = ()(
_zzq_¨g4
); \

998 
_zzq_¨gs
[5] = ()(
_zzq_¨g5
); \

999 
__asm__
 volatile("move $11, %1\n\t" \

1001 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

1005 : "Ù" (
_zzq_ªsu…
) \

1006 : "r" (
_zzq_deÁu…
), "r" (&
_zzq_¨gs
[0]) \

1008 
_zzq_ªsu…
; \

1009 })

	)

1011 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_ævÆ
) \

1012 { vﬁ©ûê
OrigFn
* 
_zzq_‹ig
 = &(
_zzq_ævÆ
); \

1013 vﬁ©ûê
__addr
; \

1014 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

1018 : "Ù" (
__addr
) \

1021 
_zzq_‹ig
->
ƒaddr
 = 
__addr
; \

1022 }

	)

1024 
	#VALGRIND_CALL_NOREDIR_T9
 \

1025 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

1027 "‹ $15, $15, $15\n\t"

	)

1029 
	#VALGRIND_VEX_INJECT_IR
() \

1031 
__asm__
 vﬁ©ûe(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

1034 } 0)

	)

1074 
	#VG_CONCAT4
(
_Ø
,
_bb
,
_cc
,
_dd
Ë_Ø##_bb##_cc##
	)
_dd

1076 
	#I_WRAP_SONAME_FNNAME_ZU
(
s⁄ame
,
‚«me
) \

1077 
	`VG_CONCAT4
(
_vgw00000ZU_
,
s⁄ame
,
_
,
‚«me
)

	)

1079 
	#I_WRAP_SONAME_FNNAME_ZZ
(
s⁄ame
,
‚«me
) \

1080 
	`VG_CONCAT4
(
_vgw00000ZZ_
,
s⁄ame
,
_
,
‚«me
)

	)

1086 
	#VALGRIND_GET_ORIG_FN
(
_lvÆ
Ë
	`VALGRIND_GET_NR_CONTEXT
(_lvÆ)

	)

1094 
	#I_REPLACE_SONAME_FNNAME_ZU
(
s⁄ame
,
‚«me
) \

1095 
	`VG_CONCAT4
(
_vgr00000ZU_
,
s⁄ame
,
_
,
‚«me
)

	)

1097 
	#I_REPLACE_SONAME_FNNAME_ZZ
(
s⁄ame
,
‚«me
) \

1098 
	`VG_CONCAT4
(
_vgr00000ZZ_
,
s⁄ame
,
_
,
‚«me
)

	)

1103 
	#CALL_FN_v_v
(
‚±r
) \

1104 dÿ{ vﬁ©ûê
_junk
; \

1105 
	`CALL_FN_W_v
(
_junk
,
‚±r
); } 0)

	)

1107 
	#CALL_FN_v_W
(
‚±r
, 
¨g1
) \

1108 dÿ{ vﬁ©ûê
_junk
; \

1109 
	`CALL_FN_W_W
(
_junk
,
‚±r
,
¨g1
); } 0)

	)

1111 
	#CALL_FN_v_WW
(
‚±r
, 
¨g1
,
¨g2
) \

1112 dÿ{ vﬁ©ûê
_junk
; \

1113 
	`CALL_FN_W_WW
(
_junk
,
‚±r
,
¨g1
,
¨g2
); } 0)

	)

1115 
	#CALL_FN_v_WWW
(
‚±r
, 
¨g1
,
¨g2
,
¨g3
) \

1116 dÿ{ vﬁ©ûê
_junk
; \

1117 
	`CALL_FN_W_WWW
(
_junk
,
‚±r
,
¨g1
,
¨g2
,
¨g3
); } 0)

	)

1119 
	#CALL_FN_v_WWWW
(
‚±r
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

1120 dÿ{ vﬁ©ûê
_junk
; \

1121 
	`CALL_FN_W_WWWW
(
_junk
,
‚±r
,
¨g1
,
¨g2
,
¨g3
,
¨g4
); } 0)

	)

1123 
	#CALL_FN_v_5W
(
‚±r
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

1124 dÿ{ vﬁ©ûê
_junk
; \

1125 
	`CALL_FN_W_5W
(
_junk
,
‚±r
,
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
); } 0)

	)

1127 
	#CALL_FN_v_6W
(
‚±r
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

1128 dÿ{ vﬁ©ûê
_junk
; \

1129 
	`CALL_FN_W_6W
(
_junk
,
‚±r
,
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
); } 0)

	)

1131 
	#CALL_FN_v_7W
(
‚±r
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
,
¨g7
) \

1132 dÿ{ vﬁ©ûê
_junk
; \

1133 
	`CALL_FN_W_7W
(
_junk
,
‚±r
,
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
,
¨g7
); } 0)

	)

1137 #i‡
deföed
(
PLAT_x86_löux
Ë|| deföed(
PLAT_x86_d¨wö
)

1141 
	#__CALLER_SAVED_REGS
 "ecx", "edx"

	)

1148 
	#VALGRIND_ALIGN_STACK
 \

1150 "™d»$0xfffffff0,%%e•\n\t"

	)

1151 
	#VALGRIND_RESTORE_STACK
 \

1152 "mov»%%edi,%%e•\n\t"

	)

1157 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

1159 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1160 vﬁ©ûê
_¨gvec
[1]; \

1161 vﬁ©ûê
_ªs
; \

1162 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1163 
__asm__
 volatile( \

1164 
VALGRIND_ALIGN_STACK
 \

1166 
VALGRIND_CALL_NOREDIR_EAX
 \

1167 
VALGRIND_RESTORE_STACK
 \

1168 : "˜" (
_ªs
) \

1169 : "a" (&
_¨gvec
[0]) \

1170 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1172 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1173 } 0)

	)

1175 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

1177 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1178 vﬁ©ûê
_¨gvec
[2]; \

1179 vﬁ©ûê
_ªs
; \

1180 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1181 
_¨gvec
[1] = ()(
¨g1
); \

1182 
__asm__
 volatile( \

1183 
VALGRIND_ALIGN_STACK
 \

1187 
VALGRIND_CALL_NOREDIR_EAX
 \

1188 
VALGRIND_RESTORE_STACK
 \

1189 : "˜" (
_ªs
) \

1190 : "a" (&
_¨gvec
[0]) \

1191 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1193 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1194 } 0)

	)

1196 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
) \

1198 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1199 vﬁ©ûê
_¨gvec
[3]; \

1200 vﬁ©ûê
_ªs
; \

1201 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1202 
_¨gvec
[1] = ()(
¨g1
); \

1203 
_¨gvec
[2] = ()(
¨g2
); \

1204 
__asm__
 volatile( \

1205 
VALGRIND_ALIGN_STACK
 \

1210 
VALGRIND_CALL_NOREDIR_EAX
 \

1211 
VALGRIND_RESTORE_STACK
 \

1212 : "˜" (
_ªs
) \

1213 : "a" (&
_¨gvec
[0]) \

1214 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1216 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1217 } 0)

	)

1219 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
) \

1221 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1222 vﬁ©ûê
_¨gvec
[4]; \

1223 vﬁ©ûê
_ªs
; \

1224 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1225 
_¨gvec
[1] = ()(
¨g1
); \

1226 
_¨gvec
[2] = ()(
¨g2
); \

1227 
_¨gvec
[3] = ()(
¨g3
); \

1228 
__asm__
 volatile( \

1229 
VALGRIND_ALIGN_STACK
 \

1235 
VALGRIND_CALL_NOREDIR_EAX
 \

1236 
VALGRIND_RESTORE_STACK
 \

1237 : "˜" (
_ªs
) \

1238 : "a" (&
_¨gvec
[0]) \

1239 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1241 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1242 } 0)

	)

1244 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

1246 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1247 vﬁ©ûê
_¨gvec
[5]; \

1248 vﬁ©ûê
_ªs
; \

1249 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1250 
_¨gvec
[1] = ()(
¨g1
); \

1251 
_¨gvec
[2] = ()(
¨g2
); \

1252 
_¨gvec
[3] = ()(
¨g3
); \

1253 
_¨gvec
[4] = ()(
¨g4
); \

1254 
__asm__
 volatile( \

1255 
VALGRIND_ALIGN_STACK
 \

1261 
VALGRIND_CALL_NOREDIR_EAX
 \

1262 
VALGRIND_RESTORE_STACK
 \

1263 : "˜" (
_ªs
) \

1264 : "a" (&
_¨gvec
[0]) \

1265 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1267 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1268 } 0)

	)

1270 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

1272 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1273 vﬁ©ûê
_¨gvec
[6]; \

1274 vﬁ©ûê
_ªs
; \

1275 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1276 
_¨gvec
[1] = ()(
¨g1
); \

1277 
_¨gvec
[2] = ()(
¨g2
); \

1278 
_¨gvec
[3] = ()(
¨g3
); \

1279 
_¨gvec
[4] = ()(
¨g4
); \

1280 
_¨gvec
[5] = ()(
¨g5
); \

1281 
__asm__
 volatile( \

1282 
VALGRIND_ALIGN_STACK
 \

1290 
VALGRIND_CALL_NOREDIR_EAX
 \

1291 
VALGRIND_RESTORE_STACK
 \

1292 : "˜" (
_ªs
) \

1293 : "a" (&
_¨gvec
[0]) \

1294 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1296 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1297 } 0)

	)

1299 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

1301 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1302 vﬁ©ûê
_¨gvec
[7]; \

1303 vﬁ©ûê
_ªs
; \

1304 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1305 
_¨gvec
[1] = ()(
¨g1
); \

1306 
_¨gvec
[2] = ()(
¨g2
); \

1307 
_¨gvec
[3] = ()(
¨g3
); \

1308 
_¨gvec
[4] = ()(
¨g4
); \

1309 
_¨gvec
[5] = ()(
¨g5
); \

1310 
_¨gvec
[6] = ()(
¨g6
); \

1311 
__asm__
 volatile( \

1312 
VALGRIND_ALIGN_STACK
 \

1321 
VALGRIND_CALL_NOREDIR_EAX
 \

1322 
VALGRIND_RESTORE_STACK
 \

1323 : "˜" (
_ªs
) \

1324 : "a" (&
_¨gvec
[0]) \

1325 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1327 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1328 } 0)

	)

1330 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

1331 
¨g7
) \

1333 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1334 vﬁ©ûê
_¨gvec
[8]; \

1335 vﬁ©ûê
_ªs
; \

1336 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1337 
_¨gvec
[1] = ()(
¨g1
); \

1338 
_¨gvec
[2] = ()(
¨g2
); \

1339 
_¨gvec
[3] = ()(
¨g3
); \

1340 
_¨gvec
[4] = ()(
¨g4
); \

1341 
_¨gvec
[5] = ()(
¨g5
); \

1342 
_¨gvec
[6] = ()(
¨g6
); \

1343 
_¨gvec
[7] = ()(
¨g7
); \

1344 
__asm__
 volatile( \

1345 
VALGRIND_ALIGN_STACK
 \

1355 
VALGRIND_CALL_NOREDIR_EAX
 \

1356 
VALGRIND_RESTORE_STACK
 \

1357 : "˜" (
_ªs
) \

1358 : "a" (&
_¨gvec
[0]) \

1359 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1361 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1362 } 0)

	)

1364 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

1365 
¨g7
,
¨g8
) \

1367 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1368 vﬁ©ûê
_¨gvec
[9]; \

1369 vﬁ©ûê
_ªs
; \

1370 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1371 
_¨gvec
[1] = ()(
¨g1
); \

1372 
_¨gvec
[2] = ()(
¨g2
); \

1373 
_¨gvec
[3] = ()(
¨g3
); \

1374 
_¨gvec
[4] = ()(
¨g4
); \

1375 
_¨gvec
[5] = ()(
¨g5
); \

1376 
_¨gvec
[6] = ()(
¨g6
); \

1377 
_¨gvec
[7] = ()(
¨g7
); \

1378 
_¨gvec
[8] = ()(
¨g8
); \

1379 
__asm__
 volatile( \

1380 
VALGRIND_ALIGN_STACK
 \

1390 
VALGRIND_CALL_NOREDIR_EAX
 \

1391 
VALGRIND_RESTORE_STACK
 \

1392 : "˜" (
_ªs
) \

1393 : "a" (&
_¨gvec
[0]) \

1394 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1396 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1397 } 0)

	)

1399 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

1400 
¨g7
,
¨g8
,
¨g9
) \

1402 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1403 vﬁ©ûê
_¨gvec
[10]; \

1404 vﬁ©ûê
_ªs
; \

1405 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1406 
_¨gvec
[1] = ()(
¨g1
); \

1407 
_¨gvec
[2] = ()(
¨g2
); \

1408 
_¨gvec
[3] = ()(
¨g3
); \

1409 
_¨gvec
[4] = ()(
¨g4
); \

1410 
_¨gvec
[5] = ()(
¨g5
); \

1411 
_¨gvec
[6] = ()(
¨g6
); \

1412 
_¨gvec
[7] = ()(
¨g7
); \

1413 
_¨gvec
[8] = ()(
¨g8
); \

1414 
_¨gvec
[9] = ()(
¨g9
); \

1415 
__asm__
 volatile( \

1416 
VALGRIND_ALIGN_STACK
 \

1428 
VALGRIND_CALL_NOREDIR_EAX
 \

1429 
VALGRIND_RESTORE_STACK
 \

1430 : "˜" (
_ªs
) \

1431 : "a" (&
_¨gvec
[0]) \

1432 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1434 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1435 } 0)

	)

1437 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

1438 
¨g7
,
¨g8
,
¨g9
,
¨g10
) \

1440 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1441 vﬁ©ûê
_¨gvec
[11]; \

1442 vﬁ©ûê
_ªs
; \

1443 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1444 
_¨gvec
[1] = ()(
¨g1
); \

1445 
_¨gvec
[2] = ()(
¨g2
); \

1446 
_¨gvec
[3] = ()(
¨g3
); \

1447 
_¨gvec
[4] = ()(
¨g4
); \

1448 
_¨gvec
[5] = ()(
¨g5
); \

1449 
_¨gvec
[6] = ()(
¨g6
); \

1450 
_¨gvec
[7] = ()(
¨g7
); \

1451 
_¨gvec
[8] = ()(
¨g8
); \

1452 
_¨gvec
[9] = ()(
¨g9
); \

1453 
_¨gvec
[10] = ()(
¨g10
); \

1454 
__asm__
 volatile( \

1455 
VALGRIND_ALIGN_STACK
 \

1468 
VALGRIND_CALL_NOREDIR_EAX
 \

1469 
VALGRIND_RESTORE_STACK
 \

1470 : "˜" (
_ªs
) \

1471 : "a" (&
_¨gvec
[0]) \

1472 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1474 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1475 } 0)

	)

1477 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
, \

1478 
¨g6
,
¨g7
,
¨g8
,
¨g9
,
¨g10
, \

1479 
¨g11
) \

1481 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1482 vﬁ©ûê
_¨gvec
[12]; \

1483 vﬁ©ûê
_ªs
; \

1484 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1485 
_¨gvec
[1] = ()(
¨g1
); \

1486 
_¨gvec
[2] = ()(
¨g2
); \

1487 
_¨gvec
[3] = ()(
¨g3
); \

1488 
_¨gvec
[4] = ()(
¨g4
); \

1489 
_¨gvec
[5] = ()(
¨g5
); \

1490 
_¨gvec
[6] = ()(
¨g6
); \

1491 
_¨gvec
[7] = ()(
¨g7
); \

1492 
_¨gvec
[8] = ()(
¨g8
); \

1493 
_¨gvec
[9] = ()(
¨g9
); \

1494 
_¨gvec
[10] = ()(
¨g10
); \

1495 
_¨gvec
[11] = ()(
¨g11
); \

1496 
__asm__
 volatile( \

1497 
VALGRIND_ALIGN_STACK
 \

1511 
VALGRIND_CALL_NOREDIR_EAX
 \

1512 
VALGRIND_RESTORE_STACK
 \

1513 : "˜" (
_ªs
) \

1514 : "a" (&
_¨gvec
[0]) \

1515 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1517 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1518 } 0)

	)

1520 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
, \

1521 
¨g6
,
¨g7
,
¨g8
,
¨g9
,
¨g10
, \

1522 
¨g11
,
¨g12
) \

1524 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1525 vﬁ©ûê
_¨gvec
[13]; \

1526 vﬁ©ûê
_ªs
; \

1527 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1528 
_¨gvec
[1] = ()(
¨g1
); \

1529 
_¨gvec
[2] = ()(
¨g2
); \

1530 
_¨gvec
[3] = ()(
¨g3
); \

1531 
_¨gvec
[4] = ()(
¨g4
); \

1532 
_¨gvec
[5] = ()(
¨g5
); \

1533 
_¨gvec
[6] = ()(
¨g6
); \

1534 
_¨gvec
[7] = ()(
¨g7
); \

1535 
_¨gvec
[8] = ()(
¨g8
); \

1536 
_¨gvec
[9] = ()(
¨g9
); \

1537 
_¨gvec
[10] = ()(
¨g10
); \

1538 
_¨gvec
[11] = ()(
¨g11
); \

1539 
_¨gvec
[12] = ()(
¨g12
); \

1540 
__asm__
 volatile( \

1541 
VALGRIND_ALIGN_STACK
 \

1555 
VALGRIND_CALL_NOREDIR_EAX
 \

1556 
VALGRIND_RESTORE_STACK
 \

1557 : "˜" (
_ªs
) \

1558 : "a" (&
_¨gvec
[0]) \

1559 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "edi" \

1561 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1562 } 0)

	)

1568 #i‡
deföed
(
PLAT_amd64_löux
Ë|| deföed(
PLAT_amd64_d¨wö
)

1573 
	#__CALLER_SAVED_REGS
 "rcx", "rdx", "rsi", \

1574 "rdi", "r8", "r9", "r10", "r11"

	)

1630 #i‡
deföed
(
__GNUC__
Ë&& deföed(
__GCC_HAVE_DWARF2_CFI_ASM
)

1631 
	#__FRAME_POINTER
 \

1632 ,"r"(
	`__buûtö_dw¨f_cÁ
())

	)

1633 
	#VALGRIND_CFI_PROLOGUE
 \

1637 ".cfi_def_cÁÑbp, 0\n\t"

	)

1638 
	#VALGRIND_CFI_EPILOGUE
 \

1640 ".cfi_ª°‹e_°©e\n\t"

	)

1642 
	#__FRAME_POINTER


	)

1643 
	#VALGRIND_CFI_PROLOGUE


	)

1644 
	#VALGRIND_CFI_EPILOGUE


	)

1652 
	#VALGRIND_ALIGN_STACK
 \

1654 "™dq $0xfffffffffffffff0,%%r•\n\t"

	)

1655 
	#VALGRIND_RESTORE_STACK
 \

1656 "movq %%r14,%%r•\n\t"

	)

1682 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

1684 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1685 vﬁ©ûê
_¨gvec
[1]; \

1686 vﬁ©ûê
_ªs
; \

1687 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1688 
__asm__
 volatile( \

1689 
VALGRIND_CFI_PROLOGUE
 \

1690 
VALGRIND_ALIGN_STACK
 \

1693 
VALGRIND_CALL_NOREDIR_RAX
 \

1694 
VALGRIND_RESTORE_STACK
 \

1695 
VALGRIND_CFI_EPILOGUE
 \

1696 : "˜" (
_ªs
) \

1697 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1698 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1700 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1701 } 0)

	)

1703 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

1705 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1706 vﬁ©ûê
_¨gvec
[2]; \

1707 vﬁ©ûê
_ªs
; \

1708 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1709 
_¨gvec
[1] = ()(
¨g1
); \

1710 
__asm__
 volatile( \

1711 
VALGRIND_CFI_PROLOGUE
 \

1712 
VALGRIND_ALIGN_STACK
 \

1716 
VALGRIND_CALL_NOREDIR_RAX
 \

1717 
VALGRIND_RESTORE_STACK
 \

1718 
VALGRIND_CFI_EPILOGUE
 \

1719 : "˜" (
_ªs
) \

1720 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1721 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1723 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1724 } 0)

	)

1726 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
) \

1728 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1729 vﬁ©ûê
_¨gvec
[3]; \

1730 vﬁ©ûê
_ªs
; \

1731 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1732 
_¨gvec
[1] = ()(
¨g1
); \

1733 
_¨gvec
[2] = ()(
¨g2
); \

1734 
__asm__
 volatile( \

1735 
VALGRIND_CFI_PROLOGUE
 \

1736 
VALGRIND_ALIGN_STACK
 \

1741 
VALGRIND_CALL_NOREDIR_RAX
 \

1742 
VALGRIND_RESTORE_STACK
 \

1743 
VALGRIND_CFI_EPILOGUE
 \

1744 : "˜" (
_ªs
) \

1745 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1746 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1748 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1749 } 0)

	)

1751 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
) \

1753 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1754 vﬁ©ûê
_¨gvec
[4]; \

1755 vﬁ©ûê
_ªs
; \

1756 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1757 
_¨gvec
[1] = ()(
¨g1
); \

1758 
_¨gvec
[2] = ()(
¨g2
); \

1759 
_¨gvec
[3] = ()(
¨g3
); \

1760 
__asm__
 volatile( \

1761 
VALGRIND_CFI_PROLOGUE
 \

1762 
VALGRIND_ALIGN_STACK
 \

1768 
VALGRIND_CALL_NOREDIR_RAX
 \

1769 
VALGRIND_RESTORE_STACK
 \

1770 
VALGRIND_CFI_EPILOGUE
 \

1771 : "˜" (
_ªs
) \

1772 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1773 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1775 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1776 } 0)

	)

1778 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

1780 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1781 vﬁ©ûê
_¨gvec
[5]; \

1782 vﬁ©ûê
_ªs
; \

1783 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1784 
_¨gvec
[1] = ()(
¨g1
); \

1785 
_¨gvec
[2] = ()(
¨g2
); \

1786 
_¨gvec
[3] = ()(
¨g3
); \

1787 
_¨gvec
[4] = ()(
¨g4
); \

1788 
__asm__
 volatile( \

1789 
VALGRIND_CFI_PROLOGUE
 \

1790 
VALGRIND_ALIGN_STACK
 \

1797 
VALGRIND_CALL_NOREDIR_RAX
 \

1798 
VALGRIND_RESTORE_STACK
 \

1799 
VALGRIND_CFI_EPILOGUE
 \

1800 : "˜" (
_ªs
) \

1801 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1802 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1804 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1805 } 0)

	)

1807 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

1809 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1810 vﬁ©ûê
_¨gvec
[6]; \

1811 vﬁ©ûê
_ªs
; \

1812 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1813 
_¨gvec
[1] = ()(
¨g1
); \

1814 
_¨gvec
[2] = ()(
¨g2
); \

1815 
_¨gvec
[3] = ()(
¨g3
); \

1816 
_¨gvec
[4] = ()(
¨g4
); \

1817 
_¨gvec
[5] = ()(
¨g5
); \

1818 
__asm__
 volatile( \

1819 
VALGRIND_CFI_PROLOGUE
 \

1820 
VALGRIND_ALIGN_STACK
 \

1828 
VALGRIND_CALL_NOREDIR_RAX
 \

1829 
VALGRIND_RESTORE_STACK
 \

1830 
VALGRIND_CFI_EPILOGUE
 \

1831 : "˜" (
_ªs
) \

1832 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1833 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1835 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1836 } 0)

	)

1838 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

1840 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1841 vﬁ©ûê
_¨gvec
[7]; \

1842 vﬁ©ûê
_ªs
; \

1843 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1844 
_¨gvec
[1] = ()(
¨g1
); \

1845 
_¨gvec
[2] = ()(
¨g2
); \

1846 
_¨gvec
[3] = ()(
¨g3
); \

1847 
_¨gvec
[4] = ()(
¨g4
); \

1848 
_¨gvec
[5] = ()(
¨g5
); \

1849 
_¨gvec
[6] = ()(
¨g6
); \

1850 
__asm__
 volatile( \

1851 
VALGRIND_CFI_PROLOGUE
 \

1852 
VALGRIND_ALIGN_STACK
 \

1861 
VALGRIND_CALL_NOREDIR_RAX
 \

1862 
VALGRIND_RESTORE_STACK
 \

1863 
VALGRIND_CFI_EPILOGUE
 \

1864 : "˜" (
_ªs
) \

1865 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1866 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1868 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1869 } 0)

	)

1871 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

1872 
¨g7
) \

1874 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1875 vﬁ©ûê
_¨gvec
[8]; \

1876 vﬁ©ûê
_ªs
; \

1877 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1878 
_¨gvec
[1] = ()(
¨g1
); \

1879 
_¨gvec
[2] = ()(
¨g2
); \

1880 
_¨gvec
[3] = ()(
¨g3
); \

1881 
_¨gvec
[4] = ()(
¨g4
); \

1882 
_¨gvec
[5] = ()(
¨g5
); \

1883 
_¨gvec
[6] = ()(
¨g6
); \

1884 
_¨gvec
[7] = ()(
¨g7
); \

1885 
__asm__
 volatile( \

1886 
VALGRIND_CFI_PROLOGUE
 \

1887 
VALGRIND_ALIGN_STACK
 \

1897 
VALGRIND_CALL_NOREDIR_RAX
 \

1898 
VALGRIND_RESTORE_STACK
 \

1899 
VALGRIND_CFI_EPILOGUE
 \

1900 : "˜" (
_ªs
) \

1901 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1902 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1904 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1905 } 0)

	)

1907 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

1908 
¨g7
,
¨g8
) \

1910 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1911 vﬁ©ûê
_¨gvec
[9]; \

1912 vﬁ©ûê
_ªs
; \

1913 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1914 
_¨gvec
[1] = ()(
¨g1
); \

1915 
_¨gvec
[2] = ()(
¨g2
); \

1916 
_¨gvec
[3] = ()(
¨g3
); \

1917 
_¨gvec
[4] = ()(
¨g4
); \

1918 
_¨gvec
[5] = ()(
¨g5
); \

1919 
_¨gvec
[6] = ()(
¨g6
); \

1920 
_¨gvec
[7] = ()(
¨g7
); \

1921 
_¨gvec
[8] = ()(
¨g8
); \

1922 
__asm__
 volatile( \

1923 
VALGRIND_CFI_PROLOGUE
 \

1924 
VALGRIND_ALIGN_STACK
 \

1935 
VALGRIND_CALL_NOREDIR_RAX
 \

1936 
VALGRIND_RESTORE_STACK
 \

1937 
VALGRIND_CFI_EPILOGUE
 \

1938 : "˜" (
_ªs
) \

1939 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1940 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1942 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1943 } 0)

	)

1945 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

1946 
¨g7
,
¨g8
,
¨g9
) \

1948 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1949 vﬁ©ûê
_¨gvec
[10]; \

1950 vﬁ©ûê
_ªs
; \

1951 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1952 
_¨gvec
[1] = ()(
¨g1
); \

1953 
_¨gvec
[2] = ()(
¨g2
); \

1954 
_¨gvec
[3] = ()(
¨g3
); \

1955 
_¨gvec
[4] = ()(
¨g4
); \

1956 
_¨gvec
[5] = ()(
¨g5
); \

1957 
_¨gvec
[6] = ()(
¨g6
); \

1958 
_¨gvec
[7] = ()(
¨g7
); \

1959 
_¨gvec
[8] = ()(
¨g8
); \

1960 
_¨gvec
[9] = ()(
¨g9
); \

1961 
__asm__
 volatile( \

1962 
VALGRIND_CFI_PROLOGUE
 \

1963 
VALGRIND_ALIGN_STACK
 \

1975 
VALGRIND_CALL_NOREDIR_RAX
 \

1976 
VALGRIND_RESTORE_STACK
 \

1977 
VALGRIND_CFI_EPILOGUE
 \

1978 : "˜" (
_ªs
) \

1979 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

1980 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1982 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

1983 } 0)

	)

1985 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

1986 
¨g7
,
¨g8
,
¨g9
,
¨g10
) \

1988 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

1989 vﬁ©ûê
_¨gvec
[11]; \

1990 vﬁ©ûê
_ªs
; \

1991 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

1992 
_¨gvec
[1] = ()(
¨g1
); \

1993 
_¨gvec
[2] = ()(
¨g2
); \

1994 
_¨gvec
[3] = ()(
¨g3
); \

1995 
_¨gvec
[4] = ()(
¨g4
); \

1996 
_¨gvec
[5] = ()(
¨g5
); \

1997 
_¨gvec
[6] = ()(
¨g6
); \

1998 
_¨gvec
[7] = ()(
¨g7
); \

1999 
_¨gvec
[8] = ()(
¨g8
); \

2000 
_¨gvec
[9] = ()(
¨g9
); \

2001 
_¨gvec
[10] = ()(
¨g10
); \

2002 
__asm__
 volatile( \

2003 
VALGRIND_CFI_PROLOGUE
 \

2004 
VALGRIND_ALIGN_STACK
 \

2017 
VALGRIND_CALL_NOREDIR_RAX
 \

2018 
VALGRIND_RESTORE_STACK
 \

2019 
VALGRIND_CFI_EPILOGUE
 \

2020 : "˜" (
_ªs
) \

2021 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

2022 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

2024 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2025 } 0)

	)

2027 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2028 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
) \

2030 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2031 vﬁ©ûê
_¨gvec
[12]; \

2032 vﬁ©ûê
_ªs
; \

2033 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2034 
_¨gvec
[1] = ()(
¨g1
); \

2035 
_¨gvec
[2] = ()(
¨g2
); \

2036 
_¨gvec
[3] = ()(
¨g3
); \

2037 
_¨gvec
[4] = ()(
¨g4
); \

2038 
_¨gvec
[5] = ()(
¨g5
); \

2039 
_¨gvec
[6] = ()(
¨g6
); \

2040 
_¨gvec
[7] = ()(
¨g7
); \

2041 
_¨gvec
[8] = ()(
¨g8
); \

2042 
_¨gvec
[9] = ()(
¨g9
); \

2043 
_¨gvec
[10] = ()(
¨g10
); \

2044 
_¨gvec
[11] = ()(
¨g11
); \

2045 
__asm__
 volatile( \

2046 
VALGRIND_CFI_PROLOGUE
 \

2047 
VALGRIND_ALIGN_STACK
 \

2061 
VALGRIND_CALL_NOREDIR_RAX
 \

2062 
VALGRIND_RESTORE_STACK
 \

2063 
VALGRIND_CFI_EPILOGUE
 \

2064 : "˜" (
_ªs
) \

2065 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

2066 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

2068 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2069 } 0)

	)

2071 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2072 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
,
¨g12
) \

2074 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2075 vﬁ©ûê
_¨gvec
[13]; \

2076 vﬁ©ûê
_ªs
; \

2077 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2078 
_¨gvec
[1] = ()(
¨g1
); \

2079 
_¨gvec
[2] = ()(
¨g2
); \

2080 
_¨gvec
[3] = ()(
¨g3
); \

2081 
_¨gvec
[4] = ()(
¨g4
); \

2082 
_¨gvec
[5] = ()(
¨g5
); \

2083 
_¨gvec
[6] = ()(
¨g6
); \

2084 
_¨gvec
[7] = ()(
¨g7
); \

2085 
_¨gvec
[8] = ()(
¨g8
); \

2086 
_¨gvec
[9] = ()(
¨g9
); \

2087 
_¨gvec
[10] = ()(
¨g10
); \

2088 
_¨gvec
[11] = ()(
¨g11
); \

2089 
_¨gvec
[12] = ()(
¨g12
); \

2090 
__asm__
 volatile( \

2091 
VALGRIND_CFI_PROLOGUE
 \

2092 
VALGRIND_ALIGN_STACK
 \

2107 
VALGRIND_CALL_NOREDIR_RAX
 \

2108 
VALGRIND_RESTORE_STACK
 \

2109 
VALGRIND_CFI_EPILOGUE
 \

2110 : "˜" (
_ªs
) \

2111 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

2112 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r14", "r15" \

2114 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2115 } 0)

	)

2121 #i‡
deföed
(
PLAT_µc32_löux
)

2147 
	#__CALLER_SAVED_REGS
 \

2151 "r11", "r12", "r13"

	)

2158 
	#VALGRIND_ALIGN_STACK
 \

2160 "æwöm 1,1,0,0,27\n\t"

	)

2161 
	#VALGRIND_RESTORE_STACK
 \

2162 "m∏1,28\n\t"

	)

2167 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

2169 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2170 vﬁ©ûê
_¨gvec
[1]; \

2171 vﬁ©ûê
_ªs
; \

2172 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2173 
__asm__
 volatile( \

2174 
VALGRIND_ALIGN_STACK
 \

2177 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2178 
VALGRIND_RESTORE_STACK
 \

2180 : "Ù" (
_ªs
) \

2181 : "r" (&
_¨gvec
[0]) \

2182 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2184 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2185 } 0)

	)

2187 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

2189 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2190 vﬁ©ûê
_¨gvec
[2]; \

2191 vﬁ©ûê
_ªs
; \

2192 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2193 
_¨gvec
[1] = ()
¨g1
; \

2194 
__asm__
 volatile( \

2195 
VALGRIND_ALIGN_STACK
 \

2199 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2200 
VALGRIND_RESTORE_STACK
 \

2202 : "Ù" (
_ªs
) \

2203 : "r" (&
_¨gvec
[0]) \

2204 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2206 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2207 } 0)

	)

2209 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
) \

2211 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2212 vﬁ©ûê
_¨gvec
[3]; \

2213 vﬁ©ûê
_ªs
; \

2214 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2215 
_¨gvec
[1] = ()
¨g1
; \

2216 
_¨gvec
[2] = ()
¨g2
; \

2217 
__asm__
 volatile( \

2218 
VALGRIND_ALIGN_STACK
 \

2223 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2224 
VALGRIND_RESTORE_STACK
 \

2226 : "Ù" (
_ªs
) \

2227 : "r" (&
_¨gvec
[0]) \

2228 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2230 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2231 } 0)

	)

2233 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
) \

2235 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2236 vﬁ©ûê
_¨gvec
[4]; \

2237 vﬁ©ûê
_ªs
; \

2238 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2239 
_¨gvec
[1] = ()
¨g1
; \

2240 
_¨gvec
[2] = ()
¨g2
; \

2241 
_¨gvec
[3] = ()
¨g3
; \

2242 
__asm__
 volatile( \

2243 
VALGRIND_ALIGN_STACK
 \

2249 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2250 
VALGRIND_RESTORE_STACK
 \

2252 : "Ù" (
_ªs
) \

2253 : "r" (&
_¨gvec
[0]) \

2254 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2256 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2257 } 0)

	)

2259 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

2261 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2262 vﬁ©ûê
_¨gvec
[5]; \

2263 vﬁ©ûê
_ªs
; \

2264 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2265 
_¨gvec
[1] = ()
¨g1
; \

2266 
_¨gvec
[2] = ()
¨g2
; \

2267 
_¨gvec
[3] = ()
¨g3
; \

2268 
_¨gvec
[4] = ()
¨g4
; \

2269 
__asm__
 volatile( \

2270 
VALGRIND_ALIGN_STACK
 \

2277 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2278 
VALGRIND_RESTORE_STACK
 \

2280 : "Ù" (
_ªs
) \

2281 : "r" (&
_¨gvec
[0]) \

2282 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2284 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2285 } 0)

	)

2287 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

2289 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2290 vﬁ©ûê
_¨gvec
[6]; \

2291 vﬁ©ûê
_ªs
; \

2292 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2293 
_¨gvec
[1] = ()
¨g1
; \

2294 
_¨gvec
[2] = ()
¨g2
; \

2295 
_¨gvec
[3] = ()
¨g3
; \

2296 
_¨gvec
[4] = ()
¨g4
; \

2297 
_¨gvec
[5] = ()
¨g5
; \

2298 
__asm__
 volatile( \

2299 
VALGRIND_ALIGN_STACK
 \

2307 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2308 
VALGRIND_RESTORE_STACK
 \

2310 : "Ù" (
_ªs
) \

2311 : "r" (&
_¨gvec
[0]) \

2312 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2314 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2315 } 0)

	)

2317 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

2319 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2320 vﬁ©ûê
_¨gvec
[7]; \

2321 vﬁ©ûê
_ªs
; \

2322 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2323 
_¨gvec
[1] = ()
¨g1
; \

2324 
_¨gvec
[2] = ()
¨g2
; \

2325 
_¨gvec
[3] = ()
¨g3
; \

2326 
_¨gvec
[4] = ()
¨g4
; \

2327 
_¨gvec
[5] = ()
¨g5
; \

2328 
_¨gvec
[6] = ()
¨g6
; \

2329 
__asm__
 volatile( \

2330 
VALGRIND_ALIGN_STACK
 \

2339 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2340 
VALGRIND_RESTORE_STACK
 \

2342 : "Ù" (
_ªs
) \

2343 : "r" (&
_¨gvec
[0]) \

2344 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2346 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2347 } 0)

	)

2349 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2350 
¨g7
) \

2352 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2353 vﬁ©ûê
_¨gvec
[8]; \

2354 vﬁ©ûê
_ªs
; \

2355 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2356 
_¨gvec
[1] = ()
¨g1
; \

2357 
_¨gvec
[2] = ()
¨g2
; \

2358 
_¨gvec
[3] = ()
¨g3
; \

2359 
_¨gvec
[4] = ()
¨g4
; \

2360 
_¨gvec
[5] = ()
¨g5
; \

2361 
_¨gvec
[6] = ()
¨g6
; \

2362 
_¨gvec
[7] = ()
¨g7
; \

2363 
__asm__
 volatile( \

2364 
VALGRIND_ALIGN_STACK
 \

2374 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2375 
VALGRIND_RESTORE_STACK
 \

2377 : "Ù" (
_ªs
) \

2378 : "r" (&
_¨gvec
[0]) \

2379 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2381 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2382 } 0)

	)

2384 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2385 
¨g7
,
¨g8
) \

2387 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2388 vﬁ©ûê
_¨gvec
[9]; \

2389 vﬁ©ûê
_ªs
; \

2390 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2391 
_¨gvec
[1] = ()
¨g1
; \

2392 
_¨gvec
[2] = ()
¨g2
; \

2393 
_¨gvec
[3] = ()
¨g3
; \

2394 
_¨gvec
[4] = ()
¨g4
; \

2395 
_¨gvec
[5] = ()
¨g5
; \

2396 
_¨gvec
[6] = ()
¨g6
; \

2397 
_¨gvec
[7] = ()
¨g7
; \

2398 
_¨gvec
[8] = ()
¨g8
; \

2399 
__asm__
 volatile( \

2400 
VALGRIND_ALIGN_STACK
 \

2411 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2412 
VALGRIND_RESTORE_STACK
 \

2414 : "Ù" (
_ªs
) \

2415 : "r" (&
_¨gvec
[0]) \

2416 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2418 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2419 } 0)

	)

2421 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2422 
¨g7
,
¨g8
,
¨g9
) \

2424 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2425 vﬁ©ûê
_¨gvec
[10]; \

2426 vﬁ©ûê
_ªs
; \

2427 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2428 
_¨gvec
[1] = ()
¨g1
; \

2429 
_¨gvec
[2] = ()
¨g2
; \

2430 
_¨gvec
[3] = ()
¨g3
; \

2431 
_¨gvec
[4] = ()
¨g4
; \

2432 
_¨gvec
[5] = ()
¨g5
; \

2433 
_¨gvec
[6] = ()
¨g6
; \

2434 
_¨gvec
[7] = ()
¨g7
; \

2435 
_¨gvec
[8] = ()
¨g8
; \

2436 
_¨gvec
[9] = ()
¨g9
; \

2437 
__asm__
 volatile( \

2438 
VALGRIND_ALIGN_STACK
 \

2454 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2455 
VALGRIND_RESTORE_STACK
 \

2457 : "Ù" (
_ªs
) \

2458 : "r" (&
_¨gvec
[0]) \

2459 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2461 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2462 } 0)

	)

2464 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2465 
¨g7
,
¨g8
,
¨g9
,
¨g10
) \

2467 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2468 vﬁ©ûê
_¨gvec
[11]; \

2469 vﬁ©ûê
_ªs
; \

2470 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2471 
_¨gvec
[1] = ()
¨g1
; \

2472 
_¨gvec
[2] = ()
¨g2
; \

2473 
_¨gvec
[3] = ()
¨g3
; \

2474 
_¨gvec
[4] = ()
¨g4
; \

2475 
_¨gvec
[5] = ()
¨g5
; \

2476 
_¨gvec
[6] = ()
¨g6
; \

2477 
_¨gvec
[7] = ()
¨g7
; \

2478 
_¨gvec
[8] = ()
¨g8
; \

2479 
_¨gvec
[9] = ()
¨g9
; \

2480 
_¨gvec
[10] = ()
¨g10
; \

2481 
__asm__
 volatile( \

2482 
VALGRIND_ALIGN_STACK
 \

2501 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2502 
VALGRIND_RESTORE_STACK
 \

2504 : "Ù" (
_ªs
) \

2505 : "r" (&
_¨gvec
[0]) \

2506 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2508 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2509 } 0)

	)

2511 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2512 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
) \

2514 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2515 vﬁ©ûê
_¨gvec
[12]; \

2516 vﬁ©ûê
_ªs
; \

2517 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2518 
_¨gvec
[1] = ()
¨g1
; \

2519 
_¨gvec
[2] = ()
¨g2
; \

2520 
_¨gvec
[3] = ()
¨g3
; \

2521 
_¨gvec
[4] = ()
¨g4
; \

2522 
_¨gvec
[5] = ()
¨g5
; \

2523 
_¨gvec
[6] = ()
¨g6
; \

2524 
_¨gvec
[7] = ()
¨g7
; \

2525 
_¨gvec
[8] = ()
¨g8
; \

2526 
_¨gvec
[9] = ()
¨g9
; \

2527 
_¨gvec
[10] = ()
¨g10
; \

2528 
_¨gvec
[11] = ()
¨g11
; \

2529 
__asm__
 volatile( \

2530 
VALGRIND_ALIGN_STACK
 \

2552 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2553 
VALGRIND_RESTORE_STACK
 \

2555 : "Ù" (
_ªs
) \

2556 : "r" (&
_¨gvec
[0]) \

2557 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2559 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2560 } 0)

	)

2562 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2563 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
,
¨g12
) \

2565 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2566 vﬁ©ûê
_¨gvec
[13]; \

2567 vﬁ©ûê
_ªs
; \

2568 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

2569 
_¨gvec
[1] = ()
¨g1
; \

2570 
_¨gvec
[2] = ()
¨g2
; \

2571 
_¨gvec
[3] = ()
¨g3
; \

2572 
_¨gvec
[4] = ()
¨g4
; \

2573 
_¨gvec
[5] = ()
¨g5
; \

2574 
_¨gvec
[6] = ()
¨g6
; \

2575 
_¨gvec
[7] = ()
¨g7
; \

2576 
_¨gvec
[8] = ()
¨g8
; \

2577 
_¨gvec
[9] = ()
¨g9
; \

2578 
_¨gvec
[10] = ()
¨g10
; \

2579 
_¨gvec
[11] = ()
¨g11
; \

2580 
_¨gvec
[12] = ()
¨g12
; \

2581 
__asm__
 volatile( \

2582 
VALGRIND_ALIGN_STACK
 \

2607 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2608 
VALGRIND_RESTORE_STACK
 \

2610 : "Ù" (
_ªs
) \

2611 : "r" (&
_¨gvec
[0]) \

2612 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2614 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2615 } 0)

	)

2621 #i‡
deföed
(
PLAT_µc64be_löux
)

2626 
	#__CALLER_SAVED_REGS
 \

2630 "r11", "r12", "r13"

	)

2637 
	#VALGRIND_ALIGN_STACK
 \

2639 "ædi¸ 1,1,0,59\n\t"

	)

2640 
	#VALGRIND_RESTORE_STACK
 \

2641 "m∏1,28\n\t"

	)

2646 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

2648 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2649 vﬁ©ûê
_¨gvec
[3+0]; \

2650 vﬁ©ûê
_ªs
; \

2652 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2653 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2654 
__asm__
 volatile( \

2655 
VALGRIND_ALIGN_STACK
 \

2660 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2664 
VALGRIND_RESTORE_STACK
 \

2665 : "Ù" (
_ªs
) \

2666 : "r" (&
_¨gvec
[2]) \

2667 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2669 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2670 } 0)

	)

2672 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

2674 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2675 vﬁ©ûê
_¨gvec
[3+1]; \

2676 vﬁ©ûê
_ªs
; \

2678 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2679 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2680 
_¨gvec
[2+1] = ()
¨g1
; \

2681 
__asm__
 volatile( \

2682 
VALGRIND_ALIGN_STACK
 \

2688 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2692 
VALGRIND_RESTORE_STACK
 \

2693 : "Ù" (
_ªs
) \

2694 : "r" (&
_¨gvec
[2]) \

2695 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2697 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2698 } 0)

	)

2700 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
) \

2702 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2703 vﬁ©ûê
_¨gvec
[3+2]; \

2704 vﬁ©ûê
_ªs
; \

2706 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2707 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2708 
_¨gvec
[2+1] = ()
¨g1
; \

2709 
_¨gvec
[2+2] = ()
¨g2
; \

2710 
__asm__
 volatile( \

2711 
VALGRIND_ALIGN_STACK
 \

2718 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2722 
VALGRIND_RESTORE_STACK
 \

2723 : "Ù" (
_ªs
) \

2724 : "r" (&
_¨gvec
[2]) \

2725 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2727 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2728 } 0)

	)

2730 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
) \

2732 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2733 vﬁ©ûê
_¨gvec
[3+3]; \

2734 vﬁ©ûê
_ªs
; \

2736 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2737 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2738 
_¨gvec
[2+1] = ()
¨g1
; \

2739 
_¨gvec
[2+2] = ()
¨g2
; \

2740 
_¨gvec
[2+3] = ()
¨g3
; \

2741 
__asm__
 volatile( \

2742 
VALGRIND_ALIGN_STACK
 \

2750 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2754 
VALGRIND_RESTORE_STACK
 \

2755 : "Ù" (
_ªs
) \

2756 : "r" (&
_¨gvec
[2]) \

2757 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2759 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2760 } 0)

	)

2762 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

2764 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2765 vﬁ©ûê
_¨gvec
[3+4]; \

2766 vﬁ©ûê
_ªs
; \

2768 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2769 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2770 
_¨gvec
[2+1] = ()
¨g1
; \

2771 
_¨gvec
[2+2] = ()
¨g2
; \

2772 
_¨gvec
[2+3] = ()
¨g3
; \

2773 
_¨gvec
[2+4] = ()
¨g4
; \

2774 
__asm__
 volatile( \

2775 
VALGRIND_ALIGN_STACK
 \

2784 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2788 
VALGRIND_RESTORE_STACK
 \

2789 : "Ù" (
_ªs
) \

2790 : "r" (&
_¨gvec
[2]) \

2791 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2793 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2794 } 0)

	)

2796 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

2798 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2799 vﬁ©ûê
_¨gvec
[3+5]; \

2800 vﬁ©ûê
_ªs
; \

2802 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2803 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2804 
_¨gvec
[2+1] = ()
¨g1
; \

2805 
_¨gvec
[2+2] = ()
¨g2
; \

2806 
_¨gvec
[2+3] = ()
¨g3
; \

2807 
_¨gvec
[2+4] = ()
¨g4
; \

2808 
_¨gvec
[2+5] = ()
¨g5
; \

2809 
__asm__
 volatile( \

2810 
VALGRIND_ALIGN_STACK
 \

2820 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2824 
VALGRIND_RESTORE_STACK
 \

2825 : "Ù" (
_ªs
) \

2826 : "r" (&
_¨gvec
[2]) \

2827 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2829 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2830 } 0)

	)

2832 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

2834 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2835 vﬁ©ûê
_¨gvec
[3+6]; \

2836 vﬁ©ûê
_ªs
; \

2838 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2839 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2840 
_¨gvec
[2+1] = ()
¨g1
; \

2841 
_¨gvec
[2+2] = ()
¨g2
; \

2842 
_¨gvec
[2+3] = ()
¨g3
; \

2843 
_¨gvec
[2+4] = ()
¨g4
; \

2844 
_¨gvec
[2+5] = ()
¨g5
; \

2845 
_¨gvec
[2+6] = ()
¨g6
; \

2846 
__asm__
 volatile( \

2847 
VALGRIND_ALIGN_STACK
 \

2858 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2862 
VALGRIND_RESTORE_STACK
 \

2863 : "Ù" (
_ªs
) \

2864 : "r" (&
_¨gvec
[2]) \

2865 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2867 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2868 } 0)

	)

2870 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2871 
¨g7
) \

2873 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2874 vﬁ©ûê
_¨gvec
[3+7]; \

2875 vﬁ©ûê
_ªs
; \

2877 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2878 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2879 
_¨gvec
[2+1] = ()
¨g1
; \

2880 
_¨gvec
[2+2] = ()
¨g2
; \

2881 
_¨gvec
[2+3] = ()
¨g3
; \

2882 
_¨gvec
[2+4] = ()
¨g4
; \

2883 
_¨gvec
[2+5] = ()
¨g5
; \

2884 
_¨gvec
[2+6] = ()
¨g6
; \

2885 
_¨gvec
[2+7] = ()
¨g7
; \

2886 
__asm__
 volatile( \

2887 
VALGRIND_ALIGN_STACK
 \

2899 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2903 
VALGRIND_RESTORE_STACK
 \

2904 : "Ù" (
_ªs
) \

2905 : "r" (&
_¨gvec
[2]) \

2906 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2908 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2909 } 0)

	)

2911 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2912 
¨g7
,
¨g8
) \

2914 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2915 vﬁ©ûê
_¨gvec
[3+8]; \

2916 vﬁ©ûê
_ªs
; \

2918 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2919 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2920 
_¨gvec
[2+1] = ()
¨g1
; \

2921 
_¨gvec
[2+2] = ()
¨g2
; \

2922 
_¨gvec
[2+3] = ()
¨g3
; \

2923 
_¨gvec
[2+4] = ()
¨g4
; \

2924 
_¨gvec
[2+5] = ()
¨g5
; \

2925 
_¨gvec
[2+6] = ()
¨g6
; \

2926 
_¨gvec
[2+7] = ()
¨g7
; \

2927 
_¨gvec
[2+8] = ()
¨g8
; \

2928 
__asm__
 volatile( \

2929 
VALGRIND_ALIGN_STACK
 \

2942 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2946 
VALGRIND_RESTORE_STACK
 \

2947 : "Ù" (
_ªs
) \

2948 : "r" (&
_¨gvec
[2]) \

2949 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

2951 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

2952 } 0)

	)

2954 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

2955 
¨g7
,
¨g8
,
¨g9
) \

2957 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

2958 vﬁ©ûê
_¨gvec
[3+9]; \

2959 vﬁ©ûê
_ªs
; \

2961 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

2962 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

2963 
_¨gvec
[2+1] = ()
¨g1
; \

2964 
_¨gvec
[2+2] = ()
¨g2
; \

2965 
_¨gvec
[2+3] = ()
¨g3
; \

2966 
_¨gvec
[2+4] = ()
¨g4
; \

2967 
_¨gvec
[2+5] = ()
¨g5
; \

2968 
_¨gvec
[2+6] = ()
¨g6
; \

2969 
_¨gvec
[2+7] = ()
¨g7
; \

2970 
_¨gvec
[2+8] = ()
¨g8
; \

2971 
_¨gvec
[2+9] = ()
¨g9
; \

2972 
__asm__
 volatile( \

2973 
VALGRIND_ALIGN_STACK
 \

2991 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2995 
VALGRIND_RESTORE_STACK
 \

2996 : "Ù" (
_ªs
) \

2997 : "r" (&
_¨gvec
[2]) \

2998 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3000 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3001 } 0)

	)

3003 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3004 
¨g7
,
¨g8
,
¨g9
,
¨g10
) \

3006 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3007 vﬁ©ûê
_¨gvec
[3+10]; \

3008 vﬁ©ûê
_ªs
; \

3010 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3011 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3012 
_¨gvec
[2+1] = ()
¨g1
; \

3013 
_¨gvec
[2+2] = ()
¨g2
; \

3014 
_¨gvec
[2+3] = ()
¨g3
; \

3015 
_¨gvec
[2+4] = ()
¨g4
; \

3016 
_¨gvec
[2+5] = ()
¨g5
; \

3017 
_¨gvec
[2+6] = ()
¨g6
; \

3018 
_¨gvec
[2+7] = ()
¨g7
; \

3019 
_¨gvec
[2+8] = ()
¨g8
; \

3020 
_¨gvec
[2+9] = ()
¨g9
; \

3021 
_¨gvec
[2+10] = ()
¨g10
; \

3022 
__asm__
 volatile( \

3023 
VALGRIND_ALIGN_STACK
 \

3044 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

3048 
VALGRIND_RESTORE_STACK
 \

3049 : "Ù" (
_ªs
) \

3050 : "r" (&
_¨gvec
[2]) \

3051 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3053 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3054 } 0)

	)

3056 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3057 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
) \

3059 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3060 vﬁ©ûê
_¨gvec
[3+11]; \

3061 vﬁ©ûê
_ªs
; \

3063 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3064 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3065 
_¨gvec
[2+1] = ()
¨g1
; \

3066 
_¨gvec
[2+2] = ()
¨g2
; \

3067 
_¨gvec
[2+3] = ()
¨g3
; \

3068 
_¨gvec
[2+4] = ()
¨g4
; \

3069 
_¨gvec
[2+5] = ()
¨g5
; \

3070 
_¨gvec
[2+6] = ()
¨g6
; \

3071 
_¨gvec
[2+7] = ()
¨g7
; \

3072 
_¨gvec
[2+8] = ()
¨g8
; \

3073 
_¨gvec
[2+9] = ()
¨g9
; \

3074 
_¨gvec
[2+10] = ()
¨g10
; \

3075 
_¨gvec
[2+11] = ()
¨g11
; \

3076 
__asm__
 volatile( \

3077 
VALGRIND_ALIGN_STACK
 \

3101 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

3105 
VALGRIND_RESTORE_STACK
 \

3106 : "Ù" (
_ªs
) \

3107 : "r" (&
_¨gvec
[2]) \

3108 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3110 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3111 } 0)

	)

3113 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3114 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
,
¨g12
) \

3116 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3117 vﬁ©ûê
_¨gvec
[3+12]; \

3118 vﬁ©ûê
_ªs
; \

3120 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3121 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3122 
_¨gvec
[2+1] = ()
¨g1
; \

3123 
_¨gvec
[2+2] = ()
¨g2
; \

3124 
_¨gvec
[2+3] = ()
¨g3
; \

3125 
_¨gvec
[2+4] = ()
¨g4
; \

3126 
_¨gvec
[2+5] = ()
¨g5
; \

3127 
_¨gvec
[2+6] = ()
¨g6
; \

3128 
_¨gvec
[2+7] = ()
¨g7
; \

3129 
_¨gvec
[2+8] = ()
¨g8
; \

3130 
_¨gvec
[2+9] = ()
¨g9
; \

3131 
_¨gvec
[2+10] = ()
¨g10
; \

3132 
_¨gvec
[2+11] = ()
¨g11
; \

3133 
_¨gvec
[2+12] = ()
¨g12
; \

3134 
__asm__
 volatile( \

3135 
VALGRIND_ALIGN_STACK
 \

3162 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

3166 
VALGRIND_RESTORE_STACK
 \

3167 : "Ù" (
_ªs
) \

3168 : "r" (&
_¨gvec
[2]) \

3169 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3171 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3172 } 0)

	)

3177 #i‡
deföed
(
PLAT_µc64À_löux
)

3182 
	#__CALLER_SAVED_REGS
 \

3186 "r11", "r12", "r13"

	)

3193 
	#VALGRIND_ALIGN_STACK
 \

3195 "ædi¸ 1,1,0,59\n\t"

	)

3196 
	#VALGRIND_RESTORE_STACK
 \

3197 "m∏1,28\n\t"

	)

3202 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

3204 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3205 vﬁ©ûê
_¨gvec
[3+0]; \

3206 vﬁ©ûê
_ªs
; \

3208 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3209 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3210 
__asm__
 volatile( \

3211 
VALGRIND_ALIGN_STACK
 \

3216 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3220 
VALGRIND_RESTORE_STACK
 \

3221 : "Ù" (
_ªs
) \

3222 : "r" (&
_¨gvec
[2]) \

3223 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3225 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3226 } 0)

	)

3228 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

3230 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3231 vﬁ©ûê
_¨gvec
[3+1]; \

3232 vﬁ©ûê
_ªs
; \

3234 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3235 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3236 
_¨gvec
[2+1] = ()
¨g1
; \

3237 
__asm__
 volatile( \

3238 
VALGRIND_ALIGN_STACK
 \

3244 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3248 
VALGRIND_RESTORE_STACK
 \

3249 : "Ù" (
_ªs
) \

3250 : "r" (&
_¨gvec
[2]) \

3251 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3253 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3254 } 0)

	)

3256 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
) \

3258 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3259 vﬁ©ûê
_¨gvec
[3+2]; \

3260 vﬁ©ûê
_ªs
; \

3262 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3263 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3264 
_¨gvec
[2+1] = ()
¨g1
; \

3265 
_¨gvec
[2+2] = ()
¨g2
; \

3266 
__asm__
 volatile( \

3267 
VALGRIND_ALIGN_STACK
 \

3274 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3278 
VALGRIND_RESTORE_STACK
 \

3279 : "Ù" (
_ªs
) \

3280 : "r" (&
_¨gvec
[2]) \

3281 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3283 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3284 } 0)

	)

3286 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
) \

3288 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3289 vﬁ©ûê
_¨gvec
[3+3]; \

3290 vﬁ©ûê
_ªs
; \

3292 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3293 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3294 
_¨gvec
[2+1] = ()
¨g1
; \

3295 
_¨gvec
[2+2] = ()
¨g2
; \

3296 
_¨gvec
[2+3] = ()
¨g3
; \

3297 
__asm__
 volatile( \

3298 
VALGRIND_ALIGN_STACK
 \

3306 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3310 
VALGRIND_RESTORE_STACK
 \

3311 : "Ù" (
_ªs
) \

3312 : "r" (&
_¨gvec
[2]) \

3313 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3315 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3316 } 0)

	)

3318 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

3320 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3321 vﬁ©ûê
_¨gvec
[3+4]; \

3322 vﬁ©ûê
_ªs
; \

3324 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3325 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3326 
_¨gvec
[2+1] = ()
¨g1
; \

3327 
_¨gvec
[2+2] = ()
¨g2
; \

3328 
_¨gvec
[2+3] = ()
¨g3
; \

3329 
_¨gvec
[2+4] = ()
¨g4
; \

3330 
__asm__
 volatile( \

3331 
VALGRIND_ALIGN_STACK
 \

3340 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3344 
VALGRIND_RESTORE_STACK
 \

3345 : "Ù" (
_ªs
) \

3346 : "r" (&
_¨gvec
[2]) \

3347 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3349 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3350 } 0)

	)

3352 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

3354 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3355 vﬁ©ûê
_¨gvec
[3+5]; \

3356 vﬁ©ûê
_ªs
; \

3358 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3359 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3360 
_¨gvec
[2+1] = ()
¨g1
; \

3361 
_¨gvec
[2+2] = ()
¨g2
; \

3362 
_¨gvec
[2+3] = ()
¨g3
; \

3363 
_¨gvec
[2+4] = ()
¨g4
; \

3364 
_¨gvec
[2+5] = ()
¨g5
; \

3365 
__asm__
 volatile( \

3366 
VALGRIND_ALIGN_STACK
 \

3376 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3380 
VALGRIND_RESTORE_STACK
 \

3381 : "Ù" (
_ªs
) \

3382 : "r" (&
_¨gvec
[2]) \

3383 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3385 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3386 } 0)

	)

3388 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

3390 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3391 vﬁ©ûê
_¨gvec
[3+6]; \

3392 vﬁ©ûê
_ªs
; \

3394 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3395 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3396 
_¨gvec
[2+1] = ()
¨g1
; \

3397 
_¨gvec
[2+2] = ()
¨g2
; \

3398 
_¨gvec
[2+3] = ()
¨g3
; \

3399 
_¨gvec
[2+4] = ()
¨g4
; \

3400 
_¨gvec
[2+5] = ()
¨g5
; \

3401 
_¨gvec
[2+6] = ()
¨g6
; \

3402 
__asm__
 volatile( \

3403 
VALGRIND_ALIGN_STACK
 \

3414 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3418 
VALGRIND_RESTORE_STACK
 \

3419 : "Ù" (
_ªs
) \

3420 : "r" (&
_¨gvec
[2]) \

3421 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3423 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3424 } 0)

	)

3426 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3427 
¨g7
) \

3429 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3430 vﬁ©ûê
_¨gvec
[3+7]; \

3431 vﬁ©ûê
_ªs
; \

3433 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3434 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3435 
_¨gvec
[2+1] = ()
¨g1
; \

3436 
_¨gvec
[2+2] = ()
¨g2
; \

3437 
_¨gvec
[2+3] = ()
¨g3
; \

3438 
_¨gvec
[2+4] = ()
¨g4
; \

3439 
_¨gvec
[2+5] = ()
¨g5
; \

3440 
_¨gvec
[2+6] = ()
¨g6
; \

3441 
_¨gvec
[2+7] = ()
¨g7
; \

3442 
__asm__
 volatile( \

3443 
VALGRIND_ALIGN_STACK
 \

3455 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3459 
VALGRIND_RESTORE_STACK
 \

3460 : "Ù" (
_ªs
) \

3461 : "r" (&
_¨gvec
[2]) \

3462 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3464 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3465 } 0)

	)

3467 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3468 
¨g7
,
¨g8
) \

3470 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3471 vﬁ©ûê
_¨gvec
[3+8]; \

3472 vﬁ©ûê
_ªs
; \

3474 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3475 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3476 
_¨gvec
[2+1] = ()
¨g1
; \

3477 
_¨gvec
[2+2] = ()
¨g2
; \

3478 
_¨gvec
[2+3] = ()
¨g3
; \

3479 
_¨gvec
[2+4] = ()
¨g4
; \

3480 
_¨gvec
[2+5] = ()
¨g5
; \

3481 
_¨gvec
[2+6] = ()
¨g6
; \

3482 
_¨gvec
[2+7] = ()
¨g7
; \

3483 
_¨gvec
[2+8] = ()
¨g8
; \

3484 
__asm__
 volatile( \

3485 
VALGRIND_ALIGN_STACK
 \

3498 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3502 
VALGRIND_RESTORE_STACK
 \

3503 : "Ù" (
_ªs
) \

3504 : "r" (&
_¨gvec
[2]) \

3505 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3507 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3508 } 0)

	)

3510 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3511 
¨g7
,
¨g8
,
¨g9
) \

3513 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3514 vﬁ©ûê
_¨gvec
[3+9]; \

3515 vﬁ©ûê
_ªs
; \

3517 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3518 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3519 
_¨gvec
[2+1] = ()
¨g1
; \

3520 
_¨gvec
[2+2] = ()
¨g2
; \

3521 
_¨gvec
[2+3] = ()
¨g3
; \

3522 
_¨gvec
[2+4] = ()
¨g4
; \

3523 
_¨gvec
[2+5] = ()
¨g5
; \

3524 
_¨gvec
[2+6] = ()
¨g6
; \

3525 
_¨gvec
[2+7] = ()
¨g7
; \

3526 
_¨gvec
[2+8] = ()
¨g8
; \

3527 
_¨gvec
[2+9] = ()
¨g9
; \

3528 
__asm__
 volatile( \

3529 
VALGRIND_ALIGN_STACK
 \

3547 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3551 
VALGRIND_RESTORE_STACK
 \

3552 : "Ù" (
_ªs
) \

3553 : "r" (&
_¨gvec
[2]) \

3554 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3556 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3557 } 0)

	)

3559 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3560 
¨g7
,
¨g8
,
¨g9
,
¨g10
) \

3562 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3563 vﬁ©ûê
_¨gvec
[3+10]; \

3564 vﬁ©ûê
_ªs
; \

3566 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3567 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3568 
_¨gvec
[2+1] = ()
¨g1
; \

3569 
_¨gvec
[2+2] = ()
¨g2
; \

3570 
_¨gvec
[2+3] = ()
¨g3
; \

3571 
_¨gvec
[2+4] = ()
¨g4
; \

3572 
_¨gvec
[2+5] = ()
¨g5
; \

3573 
_¨gvec
[2+6] = ()
¨g6
; \

3574 
_¨gvec
[2+7] = ()
¨g7
; \

3575 
_¨gvec
[2+8] = ()
¨g8
; \

3576 
_¨gvec
[2+9] = ()
¨g9
; \

3577 
_¨gvec
[2+10] = ()
¨g10
; \

3578 
__asm__
 volatile( \

3579 
VALGRIND_ALIGN_STACK
 \

3600 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3604 
VALGRIND_RESTORE_STACK
 \

3605 : "Ù" (
_ªs
) \

3606 : "r" (&
_¨gvec
[2]) \

3607 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3609 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3610 } 0)

	)

3612 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3613 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
) \

3615 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3616 vﬁ©ûê
_¨gvec
[3+11]; \

3617 vﬁ©ûê
_ªs
; \

3619 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3620 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3621 
_¨gvec
[2+1] = ()
¨g1
; \

3622 
_¨gvec
[2+2] = ()
¨g2
; \

3623 
_¨gvec
[2+3] = ()
¨g3
; \

3624 
_¨gvec
[2+4] = ()
¨g4
; \

3625 
_¨gvec
[2+5] = ()
¨g5
; \

3626 
_¨gvec
[2+6] = ()
¨g6
; \

3627 
_¨gvec
[2+7] = ()
¨g7
; \

3628 
_¨gvec
[2+8] = ()
¨g8
; \

3629 
_¨gvec
[2+9] = ()
¨g9
; \

3630 
_¨gvec
[2+10] = ()
¨g10
; \

3631 
_¨gvec
[2+11] = ()
¨g11
; \

3632 
__asm__
 volatile( \

3633 
VALGRIND_ALIGN_STACK
 \

3657 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3661 
VALGRIND_RESTORE_STACK
 \

3662 : "Ù" (
_ªs
) \

3663 : "r" (&
_¨gvec
[2]) \

3664 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3666 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3667 } 0)

	)

3669 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3670 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
,
¨g12
) \

3672 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3673 vﬁ©ûê
_¨gvec
[3+12]; \

3674 vﬁ©ûê
_ªs
; \

3676 
_¨gvec
[1] = ()
_‹ig
.
r2
; \

3677 
_¨gvec
[2] = ()
_‹ig
.
ƒaddr
; \

3678 
_¨gvec
[2+1] = ()
¨g1
; \

3679 
_¨gvec
[2+2] = ()
¨g2
; \

3680 
_¨gvec
[2+3] = ()
¨g3
; \

3681 
_¨gvec
[2+4] = ()
¨g4
; \

3682 
_¨gvec
[2+5] = ()
¨g5
; \

3683 
_¨gvec
[2+6] = ()
¨g6
; \

3684 
_¨gvec
[2+7] = ()
¨g7
; \

3685 
_¨gvec
[2+8] = ()
¨g8
; \

3686 
_¨gvec
[2+9] = ()
¨g9
; \

3687 
_¨gvec
[2+10] = ()
¨g10
; \

3688 
_¨gvec
[2+11] = ()
¨g11
; \

3689 
_¨gvec
[2+12] = ()
¨g12
; \

3690 
__asm__
 volatile( \

3691 
VALGRIND_ALIGN_STACK
 \

3718 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3722 
VALGRIND_RESTORE_STACK
 \

3723 : "Ù" (
_ªs
) \

3724 : "r" (&
_¨gvec
[2]) \

3725 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r28" \

3727 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3728 } 0)

	)

3734 #i‡
deföed
(
PLAT_¨m_löux
)

3737 
	#__CALLER_SAVED_REGS
 "r0", "r1", "r2", "r3","r4","r14"

	)

3752 
	#VALGRIND_ALIGN_STACK
 \

3756 "mov sp,Ñ4\n\t"

	)

3757 
	#VALGRIND_RESTORE_STACK
 \

3758 "mov sp,Ñ10\n\t"

	)

3763 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

3765 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3766 vﬁ©ûê
_¨gvec
[1]; \

3767 vﬁ©ûê
_ªs
; \

3768 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

3769 
__asm__
 volatile( \

3770 
VALGRIND_ALIGN_STACK
 \

3772 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3773 
VALGRIND_RESTORE_STACK
 \

3775 : "Ù" (
_ªs
) \

3776 : "0" (&
_¨gvec
[0]) \

3777 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

3779 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3780 } 0)

	)

3782 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

3784 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3785 vﬁ©ûê
_¨gvec
[2]; \

3786 vﬁ©ûê
_ªs
; \

3787 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

3788 
_¨gvec
[1] = ()(
¨g1
); \

3789 
__asm__
 volatile( \

3790 
VALGRIND_ALIGN_STACK
 \

3793 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3794 
VALGRIND_RESTORE_STACK
 \

3796 : "Ù" (
_ªs
) \

3797 : "0" (&
_¨gvec
[0]) \

3798 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

3800 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3801 } 0)

	)

3803 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
) \

3805 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3806 vﬁ©ûê
_¨gvec
[3]; \

3807 vﬁ©ûê
_ªs
; \

3808 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

3809 
_¨gvec
[1] = ()(
¨g1
); \

3810 
_¨gvec
[2] = ()(
¨g2
); \

3811 
__asm__
 volatile( \

3812 
VALGRIND_ALIGN_STACK
 \

3816 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3817 
VALGRIND_RESTORE_STACK
 \

3819 : "Ù" (
_ªs
) \

3820 : "0" (&
_¨gvec
[0]) \

3821 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

3823 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3824 } 0)

	)

3826 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
) \

3828 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3829 vﬁ©ûê
_¨gvec
[4]; \

3830 vﬁ©ûê
_ªs
; \

3831 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

3832 
_¨gvec
[1] = ()(
¨g1
); \

3833 
_¨gvec
[2] = ()(
¨g2
); \

3834 
_¨gvec
[3] = ()(
¨g3
); \

3835 
__asm__
 volatile( \

3836 
VALGRIND_ALIGN_STACK
 \

3841 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3842 
VALGRIND_RESTORE_STACK
 \

3844 : "Ù" (
_ªs
) \

3845 : "0" (&
_¨gvec
[0]) \

3846 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

3848 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3849 } 0)

	)

3851 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

3853 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3854 vﬁ©ûê
_¨gvec
[5]; \

3855 vﬁ©ûê
_ªs
; \

3856 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

3857 
_¨gvec
[1] = ()(
¨g1
); \

3858 
_¨gvec
[2] = ()(
¨g2
); \

3859 
_¨gvec
[3] = ()(
¨g3
); \

3860 
_¨gvec
[4] = ()(
¨g4
); \

3861 
__asm__
 volatile( \

3862 
VALGRIND_ALIGN_STACK
 \

3868 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3869 
VALGRIND_RESTORE_STACK
 \

3871 : "Ù" (
_ªs
) \

3872 : "0" (&
_¨gvec
[0]) \

3873 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

3875 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3876 } 0)

	)

3878 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

3880 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3881 vﬁ©ûê
_¨gvec
[6]; \

3882 vﬁ©ûê
_ªs
; \

3883 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

3884 
_¨gvec
[1] = ()(
¨g1
); \

3885 
_¨gvec
[2] = ()(
¨g2
); \

3886 
_¨gvec
[3] = ()(
¨g3
); \

3887 
_¨gvec
[4] = ()(
¨g4
); \

3888 
_¨gvec
[5] = ()(
¨g5
); \

3889 
__asm__
 volatile( \

3890 
VALGRIND_ALIGN_STACK
 \

3899 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3900 
VALGRIND_RESTORE_STACK
 \

3902 : "Ù" (
_ªs
) \

3903 : "0" (&
_¨gvec
[0]) \

3904 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

3906 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3907 } 0)

	)

3909 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

3911 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3912 vﬁ©ûê
_¨gvec
[7]; \

3913 vﬁ©ûê
_ªs
; \

3914 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

3915 
_¨gvec
[1] = ()(
¨g1
); \

3916 
_¨gvec
[2] = ()(
¨g2
); \

3917 
_¨gvec
[3] = ()(
¨g3
); \

3918 
_¨gvec
[4] = ()(
¨g4
); \

3919 
_¨gvec
[5] = ()(
¨g5
); \

3920 
_¨gvec
[6] = ()(
¨g6
); \

3921 
__asm__
 volatile( \

3922 
VALGRIND_ALIGN_STACK
 \

3931 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3932 
VALGRIND_RESTORE_STACK
 \

3934 : "Ù" (
_ªs
) \

3935 : "0" (&
_¨gvec
[0]) \

3936 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

3938 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3939 } 0)

	)

3941 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3942 
¨g7
) \

3944 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3945 vﬁ©ûê
_¨gvec
[8]; \

3946 vﬁ©ûê
_ªs
; \

3947 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

3948 
_¨gvec
[1] = ()(
¨g1
); \

3949 
_¨gvec
[2] = ()(
¨g2
); \

3950 
_¨gvec
[3] = ()(
¨g3
); \

3951 
_¨gvec
[4] = ()(
¨g4
); \

3952 
_¨gvec
[5] = ()(
¨g5
); \

3953 
_¨gvec
[6] = ()(
¨g6
); \

3954 
_¨gvec
[7] = ()(
¨g7
); \

3955 
__asm__
 volatile( \

3956 
VALGRIND_ALIGN_STACK
 \

3967 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3968 
VALGRIND_RESTORE_STACK
 \

3970 : "Ù" (
_ªs
) \

3971 : "0" (&
_¨gvec
[0]) \

3972 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

3974 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

3975 } 0)

	)

3977 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

3978 
¨g7
,
¨g8
) \

3980 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

3981 vﬁ©ûê
_¨gvec
[9]; \

3982 vﬁ©ûê
_ªs
; \

3983 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

3984 
_¨gvec
[1] = ()(
¨g1
); \

3985 
_¨gvec
[2] = ()(
¨g2
); \

3986 
_¨gvec
[3] = ()(
¨g3
); \

3987 
_¨gvec
[4] = ()(
¨g4
); \

3988 
_¨gvec
[5] = ()(
¨g5
); \

3989 
_¨gvec
[6] = ()(
¨g6
); \

3990 
_¨gvec
[7] = ()(
¨g7
); \

3991 
_¨gvec
[8] = ()(
¨g8
); \

3992 
__asm__
 volatile( \

3993 
VALGRIND_ALIGN_STACK
 \

4004 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4005 
VALGRIND_RESTORE_STACK
 \

4007 : "Ù" (
_ªs
) \

4008 : "0" (&
_¨gvec
[0]) \

4009 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

4011 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4012 } 0)

	)

4014 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

4015 
¨g7
,
¨g8
,
¨g9
) \

4017 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4018 vﬁ©ûê
_¨gvec
[10]; \

4019 vﬁ©ûê
_ªs
; \

4020 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4021 
_¨gvec
[1] = ()(
¨g1
); \

4022 
_¨gvec
[2] = ()(
¨g2
); \

4023 
_¨gvec
[3] = ()(
¨g3
); \

4024 
_¨gvec
[4] = ()(
¨g4
); \

4025 
_¨gvec
[5] = ()(
¨g5
); \

4026 
_¨gvec
[6] = ()(
¨g6
); \

4027 
_¨gvec
[7] = ()(
¨g7
); \

4028 
_¨gvec
[8] = ()(
¨g8
); \

4029 
_¨gvec
[9] = ()(
¨g9
); \

4030 
__asm__
 volatile( \

4031 
VALGRIND_ALIGN_STACK
 \

4044 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4045 
VALGRIND_RESTORE_STACK
 \

4047 : "Ù" (
_ªs
) \

4048 : "0" (&
_¨gvec
[0]) \

4049 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

4051 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4052 } 0)

	)

4054 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

4055 
¨g7
,
¨g8
,
¨g9
,
¨g10
) \

4057 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4058 vﬁ©ûê
_¨gvec
[11]; \

4059 vﬁ©ûê
_ªs
; \

4060 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4061 
_¨gvec
[1] = ()(
¨g1
); \

4062 
_¨gvec
[2] = ()(
¨g2
); \

4063 
_¨gvec
[3] = ()(
¨g3
); \

4064 
_¨gvec
[4] = ()(
¨g4
); \

4065 
_¨gvec
[5] = ()(
¨g5
); \

4066 
_¨gvec
[6] = ()(
¨g6
); \

4067 
_¨gvec
[7] = ()(
¨g7
); \

4068 
_¨gvec
[8] = ()(
¨g8
); \

4069 
_¨gvec
[9] = ()(
¨g9
); \

4070 
_¨gvec
[10] = ()(
¨g10
); \

4071 
__asm__
 volatile( \

4072 
VALGRIND_ALIGN_STACK
 \

4086 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4087 
VALGRIND_RESTORE_STACK
 \

4089 : "Ù" (
_ªs
) \

4090 : "0" (&
_¨gvec
[0]) \

4091 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

4093 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4094 } 0)

	)

4096 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
, \

4097 
¨g6
,
¨g7
,
¨g8
,
¨g9
,
¨g10
, \

4098 
¨g11
) \

4100 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4101 vﬁ©ûê
_¨gvec
[12]; \

4102 vﬁ©ûê
_ªs
; \

4103 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4104 
_¨gvec
[1] = ()(
¨g1
); \

4105 
_¨gvec
[2] = ()(
¨g2
); \

4106 
_¨gvec
[3] = ()(
¨g3
); \

4107 
_¨gvec
[4] = ()(
¨g4
); \

4108 
_¨gvec
[5] = ()(
¨g5
); \

4109 
_¨gvec
[6] = ()(
¨g6
); \

4110 
_¨gvec
[7] = ()(
¨g7
); \

4111 
_¨gvec
[8] = ()(
¨g8
); \

4112 
_¨gvec
[9] = ()(
¨g9
); \

4113 
_¨gvec
[10] = ()(
¨g10
); \

4114 
_¨gvec
[11] = ()(
¨g11
); \

4115 
__asm__
 volatile( \

4116 
VALGRIND_ALIGN_STACK
 \

4132 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4133 
VALGRIND_RESTORE_STACK
 \

4135 : "Ù" (
_ªs
) \

4136 : "0" (&
_¨gvec
[0]) \

4137 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

4139 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4140 } 0)

	)

4142 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
, \

4143 
¨g6
,
¨g7
,
¨g8
,
¨g9
,
¨g10
, \

4144 
¨g11
,
¨g12
) \

4146 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4147 vﬁ©ûê
_¨gvec
[13]; \

4148 vﬁ©ûê
_ªs
; \

4149 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4150 
_¨gvec
[1] = ()(
¨g1
); \

4151 
_¨gvec
[2] = ()(
¨g2
); \

4152 
_¨gvec
[3] = ()(
¨g3
); \

4153 
_¨gvec
[4] = ()(
¨g4
); \

4154 
_¨gvec
[5] = ()(
¨g5
); \

4155 
_¨gvec
[6] = ()(
¨g6
); \

4156 
_¨gvec
[7] = ()(
¨g7
); \

4157 
_¨gvec
[8] = ()(
¨g8
); \

4158 
_¨gvec
[9] = ()(
¨g9
); \

4159 
_¨gvec
[10] = ()(
¨g10
); \

4160 
_¨gvec
[11] = ()(
¨g11
); \

4161 
_¨gvec
[12] = ()(
¨g12
); \

4162 
__asm__
 volatile( \

4163 
VALGRIND_ALIGN_STACK
 \

4179 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4180 
VALGRIND_RESTORE_STACK
 \

4182 : "Ù" (
_ªs
) \

4183 : "0" (&
_¨gvec
[0]) \

4184 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "r10" \

4186 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4187 } 0)

	)

4193 #i‡
deföed
(
PLAT_¨m64_löux
)

4196 
	#__CALLER_SAVED_REGS
 \

4203 "v26", "v27", "v28", "v29", "v30", "v31"

	)

4207 
	#VALGRIND_ALIGN_STACK
 \

4209 "bi¯•, x21, #15\n\t"

	)

4210 
	#VALGRIND_RESTORE_STACK
 \

4211 "mov sp, x21\n\t"

	)

4216 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

4218 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4219 vﬁ©ûê
_¨gvec
[1]; \

4220 vﬁ©ûê
_ªs
; \

4221 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4222 
__asm__
 volatile( \

4223 
VALGRIND_ALIGN_STACK
 \

4225 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4226 
VALGRIND_RESTORE_STACK
 \

4228 : "Ù" (
_ªs
) \

4229 : "0" (&
_¨gvec
[0]) \

4230 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4232 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4233 } 0)

	)

4235 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

4237 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4238 vﬁ©ûê
_¨gvec
[2]; \

4239 vﬁ©ûê
_ªs
; \

4240 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4241 
_¨gvec
[1] = ()(
¨g1
); \

4242 
__asm__
 volatile( \

4243 
VALGRIND_ALIGN_STACK
 \

4246 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4247 
VALGRIND_RESTORE_STACK
 \

4249 : "Ù" (
_ªs
) \

4250 : "0" (&
_¨gvec
[0]) \

4251 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4253 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4254 } 0)

	)

4256 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
) \

4258 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4259 vﬁ©ûê
_¨gvec
[3]; \

4260 vﬁ©ûê
_ªs
; \

4261 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4262 
_¨gvec
[1] = ()(
¨g1
); \

4263 
_¨gvec
[2] = ()(
¨g2
); \

4264 
__asm__
 volatile( \

4265 
VALGRIND_ALIGN_STACK
 \

4269 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4270 
VALGRIND_RESTORE_STACK
 \

4272 : "Ù" (
_ªs
) \

4273 : "0" (&
_¨gvec
[0]) \

4274 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4276 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4277 } 0)

	)

4279 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
) \

4281 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4282 vﬁ©ûê
_¨gvec
[4]; \

4283 vﬁ©ûê
_ªs
; \

4284 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4285 
_¨gvec
[1] = ()(
¨g1
); \

4286 
_¨gvec
[2] = ()(
¨g2
); \

4287 
_¨gvec
[3] = ()(
¨g3
); \

4288 
__asm__
 volatile( \

4289 
VALGRIND_ALIGN_STACK
 \

4294 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4295 
VALGRIND_RESTORE_STACK
 \

4297 : "Ù" (
_ªs
) \

4298 : "0" (&
_¨gvec
[0]) \

4299 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4301 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4302 } 0)

	)

4304 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

4306 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4307 vﬁ©ûê
_¨gvec
[5]; \

4308 vﬁ©ûê
_ªs
; \

4309 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4310 
_¨gvec
[1] = ()(
¨g1
); \

4311 
_¨gvec
[2] = ()(
¨g2
); \

4312 
_¨gvec
[3] = ()(
¨g3
); \

4313 
_¨gvec
[4] = ()(
¨g4
); \

4314 
__asm__
 volatile( \

4315 
VALGRIND_ALIGN_STACK
 \

4321 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4322 
VALGRIND_RESTORE_STACK
 \

4324 : "Ù" (
_ªs
) \

4325 : "0" (&
_¨gvec
[0]) \

4326 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4328 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4329 } 0)

	)

4331 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

4333 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4334 vﬁ©ûê
_¨gvec
[6]; \

4335 vﬁ©ûê
_ªs
; \

4336 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4337 
_¨gvec
[1] = ()(
¨g1
); \

4338 
_¨gvec
[2] = ()(
¨g2
); \

4339 
_¨gvec
[3] = ()(
¨g3
); \

4340 
_¨gvec
[4] = ()(
¨g4
); \

4341 
_¨gvec
[5] = ()(
¨g5
); \

4342 
__asm__
 volatile( \

4343 
VALGRIND_ALIGN_STACK
 \

4350 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4351 
VALGRIND_RESTORE_STACK
 \

4353 : "Ù" (
_ªs
) \

4354 : "0" (&
_¨gvec
[0]) \

4355 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4357 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4358 } 0)

	)

4360 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

4362 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4363 vﬁ©ûê
_¨gvec
[7]; \

4364 vﬁ©ûê
_ªs
; \

4365 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4366 
_¨gvec
[1] = ()(
¨g1
); \

4367 
_¨gvec
[2] = ()(
¨g2
); \

4368 
_¨gvec
[3] = ()(
¨g3
); \

4369 
_¨gvec
[4] = ()(
¨g4
); \

4370 
_¨gvec
[5] = ()(
¨g5
); \

4371 
_¨gvec
[6] = ()(
¨g6
); \

4372 
__asm__
 volatile( \

4373 
VALGRIND_ALIGN_STACK
 \

4381 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4382 
VALGRIND_RESTORE_STACK
 \

4384 : "Ù" (
_ªs
) \

4385 : "0" (&
_¨gvec
[0]) \

4386 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4388 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4389 } 0)

	)

4391 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

4392 
¨g7
) \

4394 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4395 vﬁ©ûê
_¨gvec
[8]; \

4396 vﬁ©ûê
_ªs
; \

4397 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4398 
_¨gvec
[1] = ()(
¨g1
); \

4399 
_¨gvec
[2] = ()(
¨g2
); \

4400 
_¨gvec
[3] = ()(
¨g3
); \

4401 
_¨gvec
[4] = ()(
¨g4
); \

4402 
_¨gvec
[5] = ()(
¨g5
); \

4403 
_¨gvec
[6] = ()(
¨g6
); \

4404 
_¨gvec
[7] = ()(
¨g7
); \

4405 
__asm__
 volatile( \

4406 
VALGRIND_ALIGN_STACK
 \

4415 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4416 
VALGRIND_RESTORE_STACK
 \

4418 : "Ù" (
_ªs
) \

4419 : "0" (&
_¨gvec
[0]) \

4420 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4422 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4423 } 0)

	)

4425 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

4426 
¨g7
,
¨g8
) \

4428 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4429 vﬁ©ûê
_¨gvec
[9]; \

4430 vﬁ©ûê
_ªs
; \

4431 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4432 
_¨gvec
[1] = ()(
¨g1
); \

4433 
_¨gvec
[2] = ()(
¨g2
); \

4434 
_¨gvec
[3] = ()(
¨g3
); \

4435 
_¨gvec
[4] = ()(
¨g4
); \

4436 
_¨gvec
[5] = ()(
¨g5
); \

4437 
_¨gvec
[6] = ()(
¨g6
); \

4438 
_¨gvec
[7] = ()(
¨g7
); \

4439 
_¨gvec
[8] = ()(
¨g8
); \

4440 
__asm__
 volatile( \

4441 
VALGRIND_ALIGN_STACK
 \

4451 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4452 
VALGRIND_RESTORE_STACK
 \

4454 : "Ù" (
_ªs
) \

4455 : "0" (&
_¨gvec
[0]) \

4456 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4458 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4459 } 0)

	)

4461 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

4462 
¨g7
,
¨g8
,
¨g9
) \

4464 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4465 vﬁ©ûê
_¨gvec
[10]; \

4466 vﬁ©ûê
_ªs
; \

4467 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4468 
_¨gvec
[1] = ()(
¨g1
); \

4469 
_¨gvec
[2] = ()(
¨g2
); \

4470 
_¨gvec
[3] = ()(
¨g3
); \

4471 
_¨gvec
[4] = ()(
¨g4
); \

4472 
_¨gvec
[5] = ()(
¨g5
); \

4473 
_¨gvec
[6] = ()(
¨g6
); \

4474 
_¨gvec
[7] = ()(
¨g7
); \

4475 
_¨gvec
[8] = ()(
¨g8
); \

4476 
_¨gvec
[9] = ()(
¨g9
); \

4477 
__asm__
 volatile( \

4478 
VALGRIND_ALIGN_STACK
 \

4491 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4492 
VALGRIND_RESTORE_STACK
 \

4494 : "Ù" (
_ªs
) \

4495 : "0" (&
_¨gvec
[0]) \

4496 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4498 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4499 } 0)

	)

4501 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

4502 
¨g7
,
¨g8
,
¨g9
,
¨g10
) \

4504 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4505 vﬁ©ûê
_¨gvec
[11]; \

4506 vﬁ©ûê
_ªs
; \

4507 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4508 
_¨gvec
[1] = ()(
¨g1
); \

4509 
_¨gvec
[2] = ()(
¨g2
); \

4510 
_¨gvec
[3] = ()(
¨g3
); \

4511 
_¨gvec
[4] = ()(
¨g4
); \

4512 
_¨gvec
[5] = ()(
¨g5
); \

4513 
_¨gvec
[6] = ()(
¨g6
); \

4514 
_¨gvec
[7] = ()(
¨g7
); \

4515 
_¨gvec
[8] = ()(
¨g8
); \

4516 
_¨gvec
[9] = ()(
¨g9
); \

4517 
_¨gvec
[10] = ()(
¨g10
); \

4518 
__asm__
 volatile( \

4519 
VALGRIND_ALIGN_STACK
 \

4534 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4535 
VALGRIND_RESTORE_STACK
 \

4537 : "Ù" (
_ªs
) \

4538 : "0" (&
_¨gvec
[0]) \

4539 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4541 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4542 } 0)

	)

4544 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

4545 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
) \

4547 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4548 vﬁ©ûê
_¨gvec
[12]; \

4549 vﬁ©ûê
_ªs
; \

4550 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4551 
_¨gvec
[1] = ()(
¨g1
); \

4552 
_¨gvec
[2] = ()(
¨g2
); \

4553 
_¨gvec
[3] = ()(
¨g3
); \

4554 
_¨gvec
[4] = ()(
¨g4
); \

4555 
_¨gvec
[5] = ()(
¨g5
); \

4556 
_¨gvec
[6] = ()(
¨g6
); \

4557 
_¨gvec
[7] = ()(
¨g7
); \

4558 
_¨gvec
[8] = ()(
¨g8
); \

4559 
_¨gvec
[9] = ()(
¨g9
); \

4560 
_¨gvec
[10] = ()(
¨g10
); \

4561 
_¨gvec
[11] = ()(
¨g11
); \

4562 
__asm__
 volatile( \

4563 
VALGRIND_ALIGN_STACK
 \

4580 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4581 
VALGRIND_RESTORE_STACK
 \

4583 : "Ù" (
_ªs
) \

4584 : "0" (&
_¨gvec
[0]) \

4585 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4587 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4588 } 0)

	)

4590 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

4591 
¨g7
,
¨g8
,
¨g9
,
¨g10
,
¨g11
, \

4592 
¨g12
) \

4594 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4595 vﬁ©ûê
_¨gvec
[13]; \

4596 vﬁ©ûê
_ªs
; \

4597 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4598 
_¨gvec
[1] = ()(
¨g1
); \

4599 
_¨gvec
[2] = ()(
¨g2
); \

4600 
_¨gvec
[3] = ()(
¨g3
); \

4601 
_¨gvec
[4] = ()(
¨g4
); \

4602 
_¨gvec
[5] = ()(
¨g5
); \

4603 
_¨gvec
[6] = ()(
¨g6
); \

4604 
_¨gvec
[7] = ()(
¨g7
); \

4605 
_¨gvec
[8] = ()(
¨g8
); \

4606 
_¨gvec
[9] = ()(
¨g9
); \

4607 
_¨gvec
[10] = ()(
¨g10
); \

4608 
_¨gvec
[11] = ()(
¨g11
); \

4609 
_¨gvec
[12] = ()(
¨g12
); \

4610 
__asm__
 volatile( \

4611 
VALGRIND_ALIGN_STACK
 \

4630 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4631 
VALGRIND_RESTORE_STACK
 \

4633 : "Ù" (
_ªs
) \

4634 : "0" (&
_¨gvec
[0]) \

4635 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
, "x21" \

4637 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4638 } 0)

	)

4644 #i‡
deföed
(
PLAT_s390x_löux
)

4650 #i‡
deföed
(
__GNUC__
Ë&& deföed(
__GCC_HAVE_DWARF2_CFI_ASM
)

4651 
	#__FRAME_POINTER
 \

4652 ,"d"(
	`__buûtö_dw¨f_cÁ
())

	)

4653 
	#VALGRIND_CFI_PROLOGUE
 \

4658 ".cfi_def_cÁÑ11, 0\n\t"

	)

4659 
	#VALGRIND_CFI_EPILOGUE
 \

4661 ".cfi_ª°‹e_°©e\n\t"

	)

4663 
	#__FRAME_POINTER


	)

4664 
	#VALGRIND_CFI_PROLOGUE
 \

4665 "lg∏1,%1\n\t"

	)

4666 
	#VALGRIND_CFI_EPILOGUE


	)

4678 
	#__CALLER_SAVED_REGS
 "0","1","2","3","4","5","14", \

4679 "f0","f1","f2","f3","f4","f5","f6","f7"

	)

4690 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

4692 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4693 vﬁ©ûê
_¨gvec
[1]; \

4694 vﬁ©ûê
_ªs
; \

4695 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4696 
__asm__
 volatile( \

4697 
VALGRIND_CFI_PROLOGUE
 \

4700 
VALGRIND_CALL_NOREDIR_R1
 \

4703 
VALGRIND_CFI_EPILOGUE
 \

4704 : "=d" (
_ªs
) \

4705 : "d" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4706 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"7" \

4708 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4709 } 0)

	)

4712 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

4714 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4715 vﬁ©ûê
_¨gvec
[2]; \

4716 vﬁ©ûê
_ªs
; \

4717 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4718 
_¨gvec
[1] = ()
¨g1
; \

4719 
__asm__
 volatile( \

4720 
VALGRIND_CFI_PROLOGUE
 \

4724 
VALGRIND_CALL_NOREDIR_R1
 \

4727 
VALGRIND_CFI_EPILOGUE
 \

4728 : "=d" (
_ªs
) \

4729 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4730 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"7" \

4732 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4733 } 0)

	)

4735 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
) \

4737 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4738 vﬁ©ûê
_¨gvec
[3]; \

4739 vﬁ©ûê
_ªs
; \

4740 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4741 
_¨gvec
[1] = ()
¨g1
; \

4742 
_¨gvec
[2] = ()
¨g2
; \

4743 
__asm__
 volatile( \

4744 
VALGRIND_CFI_PROLOGUE
 \

4749 
VALGRIND_CALL_NOREDIR_R1
 \

4752 
VALGRIND_CFI_EPILOGUE
 \

4753 : "=d" (
_ªs
) \

4754 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4755 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"7" \

4757 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4758 } 0)

	)

4760 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
) \

4762 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4763 vﬁ©ûê
_¨gvec
[4]; \

4764 vﬁ©ûê
_ªs
; \

4765 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4766 
_¨gvec
[1] = ()
¨g1
; \

4767 
_¨gvec
[2] = ()
¨g2
; \

4768 
_¨gvec
[3] = ()
¨g3
; \

4769 
__asm__
 volatile( \

4770 
VALGRIND_CFI_PROLOGUE
 \

4776 
VALGRIND_CALL_NOREDIR_R1
 \

4779 
VALGRIND_CFI_EPILOGUE
 \

4780 : "=d" (
_ªs
) \

4781 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4782 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"7" \

4784 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4785 } 0)

	)

4787 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
) \

4789 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4790 vﬁ©ûê
_¨gvec
[5]; \

4791 vﬁ©ûê
_ªs
; \

4792 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4793 
_¨gvec
[1] = ()
¨g1
; \

4794 
_¨gvec
[2] = ()
¨g2
; \

4795 
_¨gvec
[3] = ()
¨g3
; \

4796 
_¨gvec
[4] = ()
¨g4
; \

4797 
__asm__
 volatile( \

4798 
VALGRIND_CFI_PROLOGUE
 \

4805 
VALGRIND_CALL_NOREDIR_R1
 \

4808 
VALGRIND_CFI_EPILOGUE
 \

4809 : "=d" (
_ªs
) \

4810 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4811 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"7" \

4813 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4814 } 0)

	)

4816 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
) \

4818 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4819 vﬁ©ûê
_¨gvec
[6]; \

4820 vﬁ©ûê
_ªs
; \

4821 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4822 
_¨gvec
[1] = ()
¨g1
; \

4823 
_¨gvec
[2] = ()
¨g2
; \

4824 
_¨gvec
[3] = ()
¨g3
; \

4825 
_¨gvec
[4] = ()
¨g4
; \

4826 
_¨gvec
[5] = ()
¨g5
; \

4827 
__asm__
 volatile( \

4828 
VALGRIND_CFI_PROLOGUE
 \

4836 
VALGRIND_CALL_NOREDIR_R1
 \

4839 
VALGRIND_CFI_EPILOGUE
 \

4840 : "=d" (
_ªs
) \

4841 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4842 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"6","7" \

4844 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4845 } 0)

	)

4847 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
, \

4848 
¨g6
) \

4850 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4851 vﬁ©ûê
_¨gvec
[7]; \

4852 vﬁ©ûê
_ªs
; \

4853 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4854 
_¨gvec
[1] = ()
¨g1
; \

4855 
_¨gvec
[2] = ()
¨g2
; \

4856 
_¨gvec
[3] = ()
¨g3
; \

4857 
_¨gvec
[4] = ()
¨g4
; \

4858 
_¨gvec
[5] = ()
¨g5
; \

4859 
_¨gvec
[6] = ()
¨g6
; \

4860 
__asm__
 volatile( \

4861 
VALGRIND_CFI_PROLOGUE
 \

4870 
VALGRIND_CALL_NOREDIR_R1
 \

4873 
VALGRIND_CFI_EPILOGUE
 \

4874 : "=d" (
_ªs
) \

4875 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4876 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"6","7" \

4878 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4879 } 0)

	)

4881 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
, \

4882 
¨g6
, 
¨g7
) \

4884 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4885 vﬁ©ûê
_¨gvec
[8]; \

4886 vﬁ©ûê
_ªs
; \

4887 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4888 
_¨gvec
[1] = ()
¨g1
; \

4889 
_¨gvec
[2] = ()
¨g2
; \

4890 
_¨gvec
[3] = ()
¨g3
; \

4891 
_¨gvec
[4] = ()
¨g4
; \

4892 
_¨gvec
[5] = ()
¨g5
; \

4893 
_¨gvec
[6] = ()
¨g6
; \

4894 
_¨gvec
[7] = ()
¨g7
; \

4895 
__asm__
 volatile( \

4896 
VALGRIND_CFI_PROLOGUE
 \

4906 
VALGRIND_CALL_NOREDIR_R1
 \

4909 
VALGRIND_CFI_EPILOGUE
 \

4910 : "=d" (
_ªs
) \

4911 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4912 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"6","7" \

4914 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4915 } 0)

	)

4917 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
, \

4918 
¨g6
, 
¨g7
 ,
¨g8
) \

4920 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4921 vﬁ©ûê
_¨gvec
[9]; \

4922 vﬁ©ûê
_ªs
; \

4923 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4924 
_¨gvec
[1] = ()
¨g1
; \

4925 
_¨gvec
[2] = ()
¨g2
; \

4926 
_¨gvec
[3] = ()
¨g3
; \

4927 
_¨gvec
[4] = ()
¨g4
; \

4928 
_¨gvec
[5] = ()
¨g5
; \

4929 
_¨gvec
[6] = ()
¨g6
; \

4930 
_¨gvec
[7] = ()
¨g7
; \

4931 
_¨gvec
[8] = ()
¨g8
; \

4932 
__asm__
 volatile( \

4933 
VALGRIND_CFI_PROLOGUE
 \

4944 
VALGRIND_CALL_NOREDIR_R1
 \

4947 
VALGRIND_CFI_EPILOGUE
 \

4948 : "=d" (
_ªs
) \

4949 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4950 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"6","7" \

4952 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4953 } 0)

	)

4955 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
, \

4956 
¨g6
, 
¨g7
 ,
¨g8
, 
¨g9
) \

4958 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4959 vﬁ©ûê
_¨gvec
[10]; \

4960 vﬁ©ûê
_ªs
; \

4961 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

4962 
_¨gvec
[1] = ()
¨g1
; \

4963 
_¨gvec
[2] = ()
¨g2
; \

4964 
_¨gvec
[3] = ()
¨g3
; \

4965 
_¨gvec
[4] = ()
¨g4
; \

4966 
_¨gvec
[5] = ()
¨g5
; \

4967 
_¨gvec
[6] = ()
¨g6
; \

4968 
_¨gvec
[7] = ()
¨g7
; \

4969 
_¨gvec
[8] = ()
¨g8
; \

4970 
_¨gvec
[9] = ()
¨g9
; \

4971 
__asm__
 volatile( \

4972 
VALGRIND_CFI_PROLOGUE
 \

4984 
VALGRIND_CALL_NOREDIR_R1
 \

4987 
VALGRIND_CFI_EPILOGUE
 \

4988 : "=d" (
_ªs
) \

4989 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

4990 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"6","7" \

4992 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

4993 } 0)

	)

4995 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
, \

4996 
¨g6
, 
¨g7
 ,
¨g8
, 
¨g9
, 
¨g10
) \

4998 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

4999 vﬁ©ûê
_¨gvec
[11]; \

5000 vﬁ©ûê
_ªs
; \

5001 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5002 
_¨gvec
[1] = ()
¨g1
; \

5003 
_¨gvec
[2] = ()
¨g2
; \

5004 
_¨gvec
[3] = ()
¨g3
; \

5005 
_¨gvec
[4] = ()
¨g4
; \

5006 
_¨gvec
[5] = ()
¨g5
; \

5007 
_¨gvec
[6] = ()
¨g6
; \

5008 
_¨gvec
[7] = ()
¨g7
; \

5009 
_¨gvec
[8] = ()
¨g8
; \

5010 
_¨gvec
[9] = ()
¨g9
; \

5011 
_¨gvec
[10] = ()
¨g10
; \

5012 
__asm__
 volatile( \

5013 
VALGRIND_CFI_PROLOGUE
 \

5026 
VALGRIND_CALL_NOREDIR_R1
 \

5029 
VALGRIND_CFI_EPILOGUE
 \

5030 : "=d" (
_ªs
) \

5031 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

5032 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"6","7" \

5034 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5035 } 0)

	)

5037 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
, \

5038 
¨g6
, 
¨g7
 ,
¨g8
, 
¨g9
, 
¨g10
, 
¨g11
) \

5040 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5041 vﬁ©ûê
_¨gvec
[12]; \

5042 vﬁ©ûê
_ªs
; \

5043 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5044 
_¨gvec
[1] = ()
¨g1
; \

5045 
_¨gvec
[2] = ()
¨g2
; \

5046 
_¨gvec
[3] = ()
¨g3
; \

5047 
_¨gvec
[4] = ()
¨g4
; \

5048 
_¨gvec
[5] = ()
¨g5
; \

5049 
_¨gvec
[6] = ()
¨g6
; \

5050 
_¨gvec
[7] = ()
¨g7
; \

5051 
_¨gvec
[8] = ()
¨g8
; \

5052 
_¨gvec
[9] = ()
¨g9
; \

5053 
_¨gvec
[10] = ()
¨g10
; \

5054 
_¨gvec
[11] = ()
¨g11
; \

5055 
__asm__
 volatile( \

5056 
VALGRIND_CFI_PROLOGUE
 \

5070 
VALGRIND_CALL_NOREDIR_R1
 \

5073 
VALGRIND_CFI_EPILOGUE
 \

5074 : "=d" (
_ªs
) \

5075 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

5076 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"6","7" \

5078 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5079 } 0)

	)

5081 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
, \

5082 
¨g6
, 
¨g7
 ,
¨g8
, 
¨g9
, 
¨g10
, 
¨g11
, 
¨g12
)\

5084 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5085 vﬁ©ûê
_¨gvec
[13]; \

5086 vﬁ©ûê
_ªs
; \

5087 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5088 
_¨gvec
[1] = ()
¨g1
; \

5089 
_¨gvec
[2] = ()
¨g2
; \

5090 
_¨gvec
[3] = ()
¨g3
; \

5091 
_¨gvec
[4] = ()
¨g4
; \

5092 
_¨gvec
[5] = ()
¨g5
; \

5093 
_¨gvec
[6] = ()
¨g6
; \

5094 
_¨gvec
[7] = ()
¨g7
; \

5095 
_¨gvec
[8] = ()
¨g8
; \

5096 
_¨gvec
[9] = ()
¨g9
; \

5097 
_¨gvec
[10] = ()
¨g10
; \

5098 
_¨gvec
[11] = ()
¨g11
; \

5099 
_¨gvec
[12] = ()
¨g12
; \

5100 
__asm__
 volatile( \

5101 
VALGRIND_CFI_PROLOGUE
 \

5116 
VALGRIND_CALL_NOREDIR_R1
 \

5119 
VALGRIND_CFI_EPILOGUE
 \

5120 : "=d" (
_ªs
) \

5121 : "a" (&
_¨gvec
[0]Ë
__FRAME_POINTER
 \

5122 : "cc", "mem‹y", 
__CALLER_SAVED_REGS
,"6","7" \

5124 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5125 } 0)

	)

5132 #i‡
deföed
(
PLAT_mùs32_löux
)

5135 
	#__CALLER_SAVED_REGS
 "$2", "$3", "$4", "$5", "$6", \

5137 "$25", "$31"

	)

5142 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

5144 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5145 vﬁ©ûê
_¨gvec
[1]; \

5146 vﬁ©ûê
_ªs
; \

5147 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5148 
__asm__
 volatile( \

5154 
VALGRIND_CALL_NOREDIR_T9
 \

5160 : "Ù" (
_ªs
) \

5161 : "0" (&
_¨gvec
[0]) \

5162 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5164 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5165 } 0)

	)

5167 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

5169 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5170 vﬁ©ûê
_¨gvec
[2]; \

5171 vﬁ©ûê
_ªs
; \

5172 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5173 
_¨gvec
[1] = ()(
¨g1
); \

5174 
__asm__
 volatile( \

5181 
VALGRIND_CALL_NOREDIR_T9
 \

5187 : "Ù" (
_ªs
) \

5188 : "0" (&
_¨gvec
[0]) \

5189 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5191 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5192 } 0)

	)

5194 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
) \

5196 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5197 vﬁ©ûê
_¨gvec
[3]; \

5198 vﬁ©ûê
_ªs
; \

5199 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5200 
_¨gvec
[1] = ()(
¨g1
); \

5201 
_¨gvec
[2] = ()(
¨g2
); \

5202 
__asm__
 volatile( \

5210 
VALGRIND_CALL_NOREDIR_T9
 \

5216 : "Ù" (
_ªs
) \

5217 : "0" (&
_¨gvec
[0]) \

5218 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5220 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5221 } 0)

	)

5223 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
) \

5225 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5226 vﬁ©ûê
_¨gvec
[4]; \

5227 vﬁ©ûê
_ªs
; \

5228 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5229 
_¨gvec
[1] = ()(
¨g1
); \

5230 
_¨gvec
[2] = ()(
¨g2
); \

5231 
_¨gvec
[3] = ()(
¨g3
); \

5232 
__asm__
 volatile( \

5241 
VALGRIND_CALL_NOREDIR_T9
 \

5247 : "Ù" (
_ªs
) \

5248 : "0" (&
_¨gvec
[0]) \

5249 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5251 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5252 } 0)

	)

5254 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

5256 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5257 vﬁ©ûê
_¨gvec
[5]; \

5258 vﬁ©ûê
_ªs
; \

5259 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5260 
_¨gvec
[1] = ()(
¨g1
); \

5261 
_¨gvec
[2] = ()(
¨g2
); \

5262 
_¨gvec
[3] = ()(
¨g3
); \

5263 
_¨gvec
[4] = ()(
¨g4
); \

5264 
__asm__
 volatile( \

5274 
VALGRIND_CALL_NOREDIR_T9
 \

5280 : "Ù" (
_ªs
) \

5281 : "0" (&
_¨gvec
[0]) \

5282 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5284 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5285 } 0)

	)

5287 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

5289 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5290 vﬁ©ûê
_¨gvec
[6]; \

5291 vﬁ©ûê
_ªs
; \

5292 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5293 
_¨gvec
[1] = ()(
¨g1
); \

5294 
_¨gvec
[2] = ()(
¨g2
); \

5295 
_¨gvec
[3] = ()(
¨g3
); \

5296 
_¨gvec
[4] = ()(
¨g4
); \

5297 
_¨gvec
[5] = ()(
¨g5
); \

5298 
__asm__
 volatile( \

5310 
VALGRIND_CALL_NOREDIR_T9
 \

5316 : "Ù" (
_ªs
) \

5317 : "0" (&
_¨gvec
[0]) \

5318 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5320 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5321 } 0)

	)

5322 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

5324 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5325 vﬁ©ûê
_¨gvec
[7]; \

5326 vﬁ©ûê
_ªs
; \

5327 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5328 
_¨gvec
[1] = ()(
¨g1
); \

5329 
_¨gvec
[2] = ()(
¨g2
); \

5330 
_¨gvec
[3] = ()(
¨g3
); \

5331 
_¨gvec
[4] = ()(
¨g4
); \

5332 
_¨gvec
[5] = ()(
¨g5
); \

5333 
_¨gvec
[6] = ()(
¨g6
); \

5334 
__asm__
 volatile( \

5349 
VALGRIND_CALL_NOREDIR_T9
 \

5355 : "Ù" (
_ªs
) \

5356 : "0" (&
_¨gvec
[0]) \

5357 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5359 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5360 } 0)

	)

5362 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

5363 
¨g7
) \

5365 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5366 vﬁ©ûê
_¨gvec
[8]; \

5367 vﬁ©ûê
_ªs
; \

5368 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5369 
_¨gvec
[1] = ()(
¨g1
); \

5370 
_¨gvec
[2] = ()(
¨g2
); \

5371 
_¨gvec
[3] = ()(
¨g3
); \

5372 
_¨gvec
[4] = ()(
¨g4
); \

5373 
_¨gvec
[5] = ()(
¨g5
); \

5374 
_¨gvec
[6] = ()(
¨g6
); \

5375 
_¨gvec
[7] = ()(
¨g7
); \

5376 
__asm__
 volatile( \

5392 
VALGRIND_CALL_NOREDIR_T9
 \

5398 : "Ù" (
_ªs
) \

5399 : "0" (&
_¨gvec
[0]) \

5400 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5402 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5403 } 0)

	)

5405 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

5406 
¨g7
,
¨g8
) \

5408 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5409 vﬁ©ûê
_¨gvec
[9]; \

5410 vﬁ©ûê
_ªs
; \

5411 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5412 
_¨gvec
[1] = ()(
¨g1
); \

5413 
_¨gvec
[2] = ()(
¨g2
); \

5414 
_¨gvec
[3] = ()(
¨g3
); \

5415 
_¨gvec
[4] = ()(
¨g4
); \

5416 
_¨gvec
[5] = ()(
¨g5
); \

5417 
_¨gvec
[6] = ()(
¨g6
); \

5418 
_¨gvec
[7] = ()(
¨g7
); \

5419 
_¨gvec
[8] = ()(
¨g8
); \

5420 
__asm__
 volatile( \

5438 
VALGRIND_CALL_NOREDIR_T9
 \

5444 : "Ù" (
_ªs
) \

5445 : "0" (&
_¨gvec
[0]) \

5446 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5448 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5449 } 0)

	)

5451 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

5452 
¨g7
,
¨g8
,
¨g9
) \

5454 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5455 vﬁ©ûê
_¨gvec
[10]; \

5456 vﬁ©ûê
_ªs
; \

5457 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5458 
_¨gvec
[1] = ()(
¨g1
); \

5459 
_¨gvec
[2] = ()(
¨g2
); \

5460 
_¨gvec
[3] = ()(
¨g3
); \

5461 
_¨gvec
[4] = ()(
¨g4
); \

5462 
_¨gvec
[5] = ()(
¨g5
); \

5463 
_¨gvec
[6] = ()(
¨g6
); \

5464 
_¨gvec
[7] = ()(
¨g7
); \

5465 
_¨gvec
[8] = ()(
¨g8
); \

5466 
_¨gvec
[9] = ()(
¨g9
); \

5467 
__asm__
 volatile( \

5487 
VALGRIND_CALL_NOREDIR_T9
 \

5493 : "Ù" (
_ªs
) \

5494 : "0" (&
_¨gvec
[0]) \

5495 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5497 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5498 } 0)

	)

5500 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

5501 
¨g7
,
¨g8
,
¨g9
,
¨g10
) \

5503 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5504 vﬁ©ûê
_¨gvec
[11]; \

5505 vﬁ©ûê
_ªs
; \

5506 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5507 
_¨gvec
[1] = ()(
¨g1
); \

5508 
_¨gvec
[2] = ()(
¨g2
); \

5509 
_¨gvec
[3] = ()(
¨g3
); \

5510 
_¨gvec
[4] = ()(
¨g4
); \

5511 
_¨gvec
[5] = ()(
¨g5
); \

5512 
_¨gvec
[6] = ()(
¨g6
); \

5513 
_¨gvec
[7] = ()(
¨g7
); \

5514 
_¨gvec
[8] = ()(
¨g8
); \

5515 
_¨gvec
[9] = ()(
¨g9
); \

5516 
_¨gvec
[10] = ()(
¨g10
); \

5517 
__asm__
 volatile( \

5539 
VALGRIND_CALL_NOREDIR_T9
 \

5545 : "Ù" (
_ªs
) \

5546 : "0" (&
_¨gvec
[0]) \

5547 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5549 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5550 } 0)

	)

5552 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
, \

5553 
¨g6
,
¨g7
,
¨g8
,
¨g9
,
¨g10
, \

5554 
¨g11
) \

5556 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5557 vﬁ©ûê
_¨gvec
[12]; \

5558 vﬁ©ûê
_ªs
; \

5559 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5560 
_¨gvec
[1] = ()(
¨g1
); \

5561 
_¨gvec
[2] = ()(
¨g2
); \

5562 
_¨gvec
[3] = ()(
¨g3
); \

5563 
_¨gvec
[4] = ()(
¨g4
); \

5564 
_¨gvec
[5] = ()(
¨g5
); \

5565 
_¨gvec
[6] = ()(
¨g6
); \

5566 
_¨gvec
[7] = ()(
¨g7
); \

5567 
_¨gvec
[8] = ()(
¨g8
); \

5568 
_¨gvec
[9] = ()(
¨g9
); \

5569 
_¨gvec
[10] = ()(
¨g10
); \

5570 
_¨gvec
[11] = ()(
¨g11
); \

5571 
__asm__
 volatile( \

5595 
VALGRIND_CALL_NOREDIR_T9
 \

5601 : "Ù" (
_ªs
) \

5602 : "0" (&
_¨gvec
[0]) \

5603 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5605 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5606 } 0)

	)

5608 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
, \

5609 
¨g6
,
¨g7
,
¨g8
,
¨g9
,
¨g10
, \

5610 
¨g11
,
¨g12
) \

5612 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5613 vﬁ©ûê
_¨gvec
[13]; \

5614 vﬁ©ûê
_ªs
; \

5615 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5616 
_¨gvec
[1] = ()(
¨g1
); \

5617 
_¨gvec
[2] = ()(
¨g2
); \

5618 
_¨gvec
[3] = ()(
¨g3
); \

5619 
_¨gvec
[4] = ()(
¨g4
); \

5620 
_¨gvec
[5] = ()(
¨g5
); \

5621 
_¨gvec
[6] = ()(
¨g6
); \

5622 
_¨gvec
[7] = ()(
¨g7
); \

5623 
_¨gvec
[8] = ()(
¨g8
); \

5624 
_¨gvec
[9] = ()(
¨g9
); \

5625 
_¨gvec
[10] = ()(
¨g10
); \

5626 
_¨gvec
[11] = ()(
¨g11
); \

5627 
_¨gvec
[12] = ()(
¨g12
); \

5628 
__asm__
 volatile( \

5654 
VALGRIND_CALL_NOREDIR_T9
 \

5660 : "Ù" (
_ªs
) \

5661 : "r" (&
_¨gvec
[0]) \

5662 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5664 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5665 } 0)

	)

5671 #i‡
deföed
(
PLAT_mùs64_löux
)

5674 
	#__CALLER_SAVED_REGS
 "$2", "$3", "$4", "$5", "$6", \

5676 "$25", "$31"

	)

5681 
	#CALL_FN_W_v
(
lvÆ
, 
‹ig
) \

5683 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5684 vﬁ©ûê
_¨gvec
[1]; \

5685 vﬁ©ûê
_ªs
; \

5686 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5687 
__asm__
 volatile( \

5689 
VALGRIND_CALL_NOREDIR_T9
 \

5691 : "Ù" (
_ªs
) \

5692 : "0" (&
_¨gvec
[0]) \

5693 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5695 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5696 } 0)

	)

5698 
	#CALL_FN_W_W
(
lvÆ
, 
‹ig
, 
¨g1
) \

5700 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5701 vﬁ©ûê
_¨gvec
[2]; \

5702 vﬁ©ûê
_ªs
; \

5703 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5704 
_¨gvec
[1] = ()(
¨g1
); \

5705 
__asm__
 volatile( \

5708 
VALGRIND_CALL_NOREDIR_T9
 \

5710 : "Ù" (
_ªs
) \

5711 : "r" (&
_¨gvec
[0]) \

5712 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5714 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5715 } 0)

	)

5717 
	#CALL_FN_W_WW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
) \

5719 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5720 vﬁ©ûê
_¨gvec
[3]; \

5721 vﬁ©ûê
_ªs
; \

5722 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5723 
_¨gvec
[1] = ()(
¨g1
); \

5724 
_¨gvec
[2] = ()(
¨g2
); \

5725 
__asm__
 volatile( \

5729 
VALGRIND_CALL_NOREDIR_T9
 \

5731 : "Ù" (
_ªs
) \

5732 : "r" (&
_¨gvec
[0]) \

5733 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5735 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5736 } 0)

	)

5738 
	#CALL_FN_W_WWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
) \

5740 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5741 vﬁ©ûê
_¨gvec
[4]; \

5742 vﬁ©ûê
_ªs
; \

5743 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5744 
_¨gvec
[1] = ()(
¨g1
); \

5745 
_¨gvec
[2] = ()(
¨g2
); \

5746 
_¨gvec
[3] = ()(
¨g3
); \

5747 
__asm__
 volatile( \

5752 
VALGRIND_CALL_NOREDIR_T9
 \

5754 : "Ù" (
_ªs
) \

5755 : "r" (&
_¨gvec
[0]) \

5756 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5758 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5759 } 0)

	)

5761 
	#CALL_FN_W_WWWW
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
) \

5763 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5764 vﬁ©ûê
_¨gvec
[5]; \

5765 vﬁ©ûê
_ªs
; \

5766 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5767 
_¨gvec
[1] = ()(
¨g1
); \

5768 
_¨gvec
[2] = ()(
¨g2
); \

5769 
_¨gvec
[3] = ()(
¨g3
); \

5770 
_¨gvec
[4] = ()(
¨g4
); \

5771 
__asm__
 volatile( \

5777 
VALGRIND_CALL_NOREDIR_T9
 \

5779 : "Ù" (
_ªs
) \

5780 : "r" (&
_¨gvec
[0]) \

5781 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5783 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5784 } 0)

	)

5786 
	#CALL_FN_W_5W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
) \

5788 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5789 vﬁ©ûê
_¨gvec
[6]; \

5790 vﬁ©ûê
_ªs
; \

5791 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5792 
_¨gvec
[1] = ()(
¨g1
); \

5793 
_¨gvec
[2] = ()(
¨g2
); \

5794 
_¨gvec
[3] = ()(
¨g3
); \

5795 
_¨gvec
[4] = ()(
¨g4
); \

5796 
_¨gvec
[5] = ()(
¨g5
); \

5797 
__asm__
 volatile( \

5804 
VALGRIND_CALL_NOREDIR_T9
 \

5806 : "Ù" (
_ªs
) \

5807 : "r" (&
_¨gvec
[0]) \

5808 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5810 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5811 } 0)

	)

5813 
	#CALL_FN_W_6W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
) \

5815 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5816 vﬁ©ûê
_¨gvec
[7]; \

5817 vﬁ©ûê
_ªs
; \

5818 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5819 
_¨gvec
[1] = ()(
¨g1
); \

5820 
_¨gvec
[2] = ()(
¨g2
); \

5821 
_¨gvec
[3] = ()(
¨g3
); \

5822 
_¨gvec
[4] = ()(
¨g4
); \

5823 
_¨gvec
[5] = ()(
¨g5
); \

5824 
_¨gvec
[6] = ()(
¨g6
); \

5825 
__asm__
 volatile( \

5833 
VALGRIND_CALL_NOREDIR_T9
 \

5835 : "Ù" (
_ªs
) \

5836 : "r" (&
_¨gvec
[0]) \

5837 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5839 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5840 } 0)

	)

5842 
	#CALL_FN_W_7W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

5843 
¨g7
) \

5845 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5846 vﬁ©ûê
_¨gvec
[8]; \

5847 vﬁ©ûê
_ªs
; \

5848 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5849 
_¨gvec
[1] = ()(
¨g1
); \

5850 
_¨gvec
[2] = ()(
¨g2
); \

5851 
_¨gvec
[3] = ()(
¨g3
); \

5852 
_¨gvec
[4] = ()(
¨g4
); \

5853 
_¨gvec
[5] = ()(
¨g5
); \

5854 
_¨gvec
[6] = ()(
¨g6
); \

5855 
_¨gvec
[7] = ()(
¨g7
); \

5856 
__asm__
 volatile( \

5865 
VALGRIND_CALL_NOREDIR_T9
 \

5867 : "Ù" (
_ªs
) \

5868 : "r" (&
_¨gvec
[0]) \

5869 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5871 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5872 } 0)

	)

5874 
	#CALL_FN_W_8W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

5875 
¨g7
,
¨g8
) \

5877 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5878 vﬁ©ûê
_¨gvec
[9]; \

5879 vﬁ©ûê
_ªs
; \

5880 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5881 
_¨gvec
[1] = ()(
¨g1
); \

5882 
_¨gvec
[2] = ()(
¨g2
); \

5883 
_¨gvec
[3] = ()(
¨g3
); \

5884 
_¨gvec
[4] = ()(
¨g4
); \

5885 
_¨gvec
[5] = ()(
¨g5
); \

5886 
_¨gvec
[6] = ()(
¨g6
); \

5887 
_¨gvec
[7] = ()(
¨g7
); \

5888 
_¨gvec
[8] = ()(
¨g8
); \

5889 
__asm__
 volatile( \

5899 
VALGRIND_CALL_NOREDIR_T9
 \

5901 : "Ù" (
_ªs
) \

5902 : "r" (&
_¨gvec
[0]) \

5903 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5905 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5906 } 0)

	)

5908 
	#CALL_FN_W_9W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

5909 
¨g7
,
¨g8
,
¨g9
) \

5911 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5912 vﬁ©ûê
_¨gvec
[10]; \

5913 vﬁ©ûê
_ªs
; \

5914 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5915 
_¨gvec
[1] = ()(
¨g1
); \

5916 
_¨gvec
[2] = ()(
¨g2
); \

5917 
_¨gvec
[3] = ()(
¨g3
); \

5918 
_¨gvec
[4] = ()(
¨g4
); \

5919 
_¨gvec
[5] = ()(
¨g5
); \

5920 
_¨gvec
[6] = ()(
¨g6
); \

5921 
_¨gvec
[7] = ()(
¨g7
); \

5922 
_¨gvec
[8] = ()(
¨g8
); \

5923 
_¨gvec
[9] = ()(
¨g9
); \

5924 
__asm__
 volatile( \

5937 
VALGRIND_CALL_NOREDIR_T9
 \

5940 : "Ù" (
_ªs
) \

5941 : "r" (&
_¨gvec
[0]) \

5942 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5944 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5945 } 0)

	)

5947 
	#CALL_FN_W_10W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
,
¨g6
, \

5948 
¨g7
,
¨g8
,
¨g9
,
¨g10
) \

5950 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5951 vﬁ©ûê
_¨gvec
[11]; \

5952 vﬁ©ûê
_ªs
; \

5953 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5954 
_¨gvec
[1] = ()(
¨g1
); \

5955 
_¨gvec
[2] = ()(
¨g2
); \

5956 
_¨gvec
[3] = ()(
¨g3
); \

5957 
_¨gvec
[4] = ()(
¨g4
); \

5958 
_¨gvec
[5] = ()(
¨g5
); \

5959 
_¨gvec
[6] = ()(
¨g6
); \

5960 
_¨gvec
[7] = ()(
¨g7
); \

5961 
_¨gvec
[8] = ()(
¨g8
); \

5962 
_¨gvec
[9] = ()(
¨g9
); \

5963 
_¨gvec
[10] = ()(
¨g10
); \

5964 
__asm__
 volatile( \

5979 
VALGRIND_CALL_NOREDIR_T9
 \

5982 : "Ù" (
_ªs
) \

5983 : "r" (&
_¨gvec
[0]) \

5984 : "mem‹y", 
__CALLER_SAVED_REGS
 \

5986 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

5987 } 0)

	)

5989 
	#CALL_FN_W_11W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
, \

5990 
¨g6
,
¨g7
,
¨g8
,
¨g9
,
¨g10
, \

5991 
¨g11
) \

5993 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

5994 vﬁ©ûê
_¨gvec
[12]; \

5995 vﬁ©ûê
_ªs
; \

5996 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

5997 
_¨gvec
[1] = ()(
¨g1
); \

5998 
_¨gvec
[2] = ()(
¨g2
); \

5999 
_¨gvec
[3] = ()(
¨g3
); \

6000 
_¨gvec
[4] = ()(
¨g4
); \

6001 
_¨gvec
[5] = ()(
¨g5
); \

6002 
_¨gvec
[6] = ()(
¨g6
); \

6003 
_¨gvec
[7] = ()(
¨g7
); \

6004 
_¨gvec
[8] = ()(
¨g8
); \

6005 
_¨gvec
[9] = ()(
¨g9
); \

6006 
_¨gvec
[10] = ()(
¨g10
); \

6007 
_¨gvec
[11] = ()(
¨g11
); \

6008 
__asm__
 volatile( \

6025 
VALGRIND_CALL_NOREDIR_T9
 \

6028 : "Ù" (
_ªs
) \

6029 : "r" (&
_¨gvec
[0]) \

6030 : "mem‹y", 
__CALLER_SAVED_REGS
 \

6032 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

6033 } 0)

	)

6035 
	#CALL_FN_W_12W
(
lvÆ
, 
‹ig
, 
¨g1
,
¨g2
,
¨g3
,
¨g4
,
¨g5
, \

6036 
¨g6
,
¨g7
,
¨g8
,
¨g9
,
¨g10
, \

6037 
¨g11
,
¨g12
) \

6039 vﬁ©ûê
OrigFn
 
_‹ig
 = (
‹ig
); \

6040 vﬁ©ûê
_¨gvec
[13]; \

6041 vﬁ©ûê
_ªs
; \

6042 
_¨gvec
[0] = ()
_‹ig
.
ƒaddr
; \

6043 
_¨gvec
[1] = ()(
¨g1
); \

6044 
_¨gvec
[2] = ()(
¨g2
); \

6045 
_¨gvec
[3] = ()(
¨g3
); \

6046 
_¨gvec
[4] = ()(
¨g4
); \

6047 
_¨gvec
[5] = ()(
¨g5
); \

6048 
_¨gvec
[6] = ()(
¨g6
); \

6049 
_¨gvec
[7] = ()(
¨g7
); \

6050 
_¨gvec
[8] = ()(
¨g8
); \

6051 
_¨gvec
[9] = ()(
¨g9
); \

6052 
_¨gvec
[10] = ()(
¨g10
); \

6053 
_¨gvec
[11] = ()(
¨g11
); \

6054 
_¨gvec
[12] = ()(
¨g12
); \

6055 
__asm__
 volatile( \

6074 
VALGRIND_CALL_NOREDIR_T9
 \

6077 : "Ù" (
_ªs
) \

6078 : "r" (&
_¨gvec
[0]) \

6079 : "mem‹y", 
__CALLER_SAVED_REGS
 \

6081 
lvÆ
 = (
	`__ty≥of__
÷vÆ)Ë
_ªs
; \

6082 } 0)

	)

6102 
	#VG_USERREQ_TOOL_BASE
(
a
,
b
) \

6103 (()(((
a
)&0xffË<< 24 | ((
b
)&0xffË<< 16))

	)

6104 
	#VG_IS_TOOL_USERREQ
(
a
, 
b
, 
v
) \

6105 (
	`VG_USERREQ_TOOL_BASE
(
a
,
b
Ë=((
v
Ë& 0xffff0000))

	)

6112 íum { 
	mVG_USERREQ__RUNNING_ON_VALGRIND
 = 0x1001,

6113 
	mVG_USERREQ__DISCARD_TRANSLATIONS
 = 0x1002,

6120 
	mVG_USERREQ__CLIENT_CALL0
 = 0x1101,

6121 
	mVG_USERREQ__CLIENT_CALL1
 = 0x1102,

6122 
	mVG_USERREQ__CLIENT_CALL2
 = 0x1103,

6123 
	mVG_USERREQ__CLIENT_CALL3
 = 0x1104,

6128 
	mVG_USERREQ__COUNT_ERRORS
 = 0x1201,

6132 
	mVG_USERREQ__GDB_MONITOR_COMMAND
 = 0x1202,

6136 
	mVG_USERREQ__MALLOCLIKE_BLOCK
 = 0x1301,

6137 
	mVG_USERREQ__RESIZEINPLACE_BLOCK
 = 0x130b,

6138 
	mVG_USERREQ__FREELIKE_BLOCK
 = 0x1302,

6140 
	mVG_USERREQ__CREATE_MEMPOOL
 = 0x1303,

6141 
	mVG_USERREQ__DESTROY_MEMPOOL
 = 0x1304,

6142 
	mVG_USERREQ__MEMPOOL_ALLOC
 = 0x1305,

6143 
	mVG_USERREQ__MEMPOOL_FREE
 = 0x1306,

6144 
	mVG_USERREQ__MEMPOOL_TRIM
 = 0x1307,

6145 
	mVG_USERREQ__MOVE_MEMPOOL
 = 0x1308,

6146 
	mVG_USERREQ__MEMPOOL_CHANGE
 = 0x1309,

6147 
	mVG_USERREQ__MEMPOOL_EXISTS
 = 0x130a,

6156 
	mVG_USERREQ__PRINTF
 = 0x1401,

6157 
	mVG_USERREQ__PRINTF_BACKTRACE
 = 0x1402,

6159 
	mVG_USERREQ__PRINTF_VALIST_BY_REF
 = 0x1403,

6160 
	mVG_USERREQ__PRINTF_BACKTRACE_VALIST_BY_REF
 = 0x1404,

6163 
	mVG_USERREQ__STACK_REGISTER
 = 0x1501,

6164 
	mVG_USERREQ__STACK_DEREGISTER
 = 0x1502,

6165 
	mVG_USERREQ__STACK_CHANGE
 = 0x1503,

6168 
	mVG_USERREQ__LOAD_PDB_DEBUGINFO
 = 0x1601,

6171 
	mVG_USERREQ__MAP_IP_TO_SRCLOC
 = 0x1701,

6178 
	mVG_USERREQ__CHANGE_ERR_DISABLEMENT
 = 0x1801,

6181 
	mVG_USERREQ__VEX_INIT_FOR_IRI
 = 0x1901

6182 } 
	tVg_Clõ¡Reque°
;

6184 #i‡!
deföed
(
__GNUC__
)

6185 
	#__exãnsi⁄__


	)

6193 
	#RUNNING_ON_VALGRIND
 \

6194 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6195 
VG_USERREQ__RUNNING_ON_VALGRIND
, \

6197 

	)

6203 
	#VALGRIND_DISCARD_TRANSLATIONS
(
_qzz_addr
,
_qzz_Àn
) \

6204 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__DISCARD_TRANSLATIONS
, \

6205 
_qzz_addr
, 
_qzz_Àn
, 0, 0, 0)

	)

6213 #i‡
deföed
(
__GNUC__
Ë|| deföed(
__INTEL_COMPILER
Ë&& !deföed(
_MSC_VER
)

6216 
	$VALGRIND_PRINTF
(c⁄° *
f‹m©
, ...)

6217 
	`__©åibuã__
((
	`f‹m©
(
__¥ötf__
, 1, 2), 
__unu£d__
));

6220 #i‡
	`deföed
(
_MSC_VER
)

6221 
__ölöe


6223 
	$VALGRIND_PRINTF
(c⁄° *
f‹m©
, ...)

6225 #i‡
	`deföed
(
NVALGRIND
)

6228 #i‡
	`deföed
(
_MSC_VER
Ë|| deföed(
__MINGW64__
)

6229 
uöçå_t
 
_qzz_ªs
;

6231 
_qzz_ªs
;

6233 
va_li°
 
v¨gs
;

6234 
	`va_°¨t
(
v¨gs
, 
f‹m©
);

6235 #i‡
	`deföed
(
_MSC_VER
Ë|| deföed(
__MINGW64__
)

6236 
_qzz_ªs
 = 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0,

6237 
VG_USERREQ__PRINTF_VALIST_BY_REF
,

6238 (
uöçå_t
)
f‹m©
,

6239 (
uöçå_t
)&
v¨gs
,

6242 
_qzz_ªs
 = 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0,

6243 
VG_USERREQ__PRINTF_VALIST_BY_REF
,

6244 ()
f‹m©
,

6245 ()&
v¨gs
,

6248 
	`va_íd
(
v¨gs
);

6249  ()
_qzz_ªs
;

6251 
	}
}

6253 #i‡
deföed
(
__GNUC__
Ë|| deföed(
__INTEL_COMPILER
Ë&& !deföed(
_MSC_VER
)

6254 
	$VALGRIND_PRINTF_BACKTRACE
(c⁄° *
f‹m©
, ...)

6255 
	`__©åibuã__
((
	`f‹m©
(
__¥ötf__
, 1, 2), 
__unu£d__
));

6258 #i‡
	`deföed
(
_MSC_VER
)

6259 
__ölöe


6261 
	$VALGRIND_PRINTF_BACKTRACE
(c⁄° *
f‹m©
, ...)

6263 #i‡
	`deföed
(
NVALGRIND
)

6266 #i‡
	`deföed
(
_MSC_VER
Ë|| deföed(
__MINGW64__
)

6267 
uöçå_t
 
_qzz_ªs
;

6269 
_qzz_ªs
;

6271 
va_li°
 
v¨gs
;

6272 
	`va_°¨t
(
v¨gs
, 
f‹m©
);

6273 #i‡
	`deföed
(
_MSC_VER
Ë|| deföed(
__MINGW64__
)

6274 
_qzz_ªs
 = 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0,

6275 
VG_USERREQ__PRINTF_BACKTRACE_VALIST_BY_REF
,

6276 (
uöçå_t
)
f‹m©
,

6277 (
uöçå_t
)&
v¨gs
,

6280 
_qzz_ªs
 = 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0,

6281 
VG_USERREQ__PRINTF_BACKTRACE_VALIST_BY_REF
,

6282 ()
f‹m©
,

6283 ()&
v¨gs
,

6286 
	`va_íd
(
v¨gs
);

6287  ()
_qzz_ªs
;

6289 
	}
}

6315 
	#VALGRIND_NON_SIMD_CALL0
(
_qyy_‚
) \

6316 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6317 
VG_USERREQ__CLIENT_CALL0
, \

6318 
_qyy_‚
, \

6319 0, 0, 0, 0)

	)

6321 
	#VALGRIND_NON_SIMD_CALL1
(
_qyy_‚
, 
_qyy_¨g1
) \

6322 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6323 
VG_USERREQ__CLIENT_CALL1
, \

6324 
_qyy_‚
, \

6325 
_qyy_¨g1
, 0, 0, 0)

	)

6327 
	#VALGRIND_NON_SIMD_CALL2
(
_qyy_‚
, 
_qyy_¨g1
, 
_qyy_¨g2
) \

6328 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6329 
VG_USERREQ__CLIENT_CALL2
, \

6330 
_qyy_‚
, \

6331 
_qyy_¨g1
, 
_qyy_¨g2
, 0, 0)

	)

6333 
	#VALGRIND_NON_SIMD_CALL3
(
_qyy_‚
, 
_qyy_¨g1
, 
_qyy_¨g2
, 
_qyy_¨g3
) \

6334 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6335 
VG_USERREQ__CLIENT_CALL3
, \

6336 
_qyy_‚
, \

6337 
_qyy_¨g1
, 
_qyy_¨g2
, \

6338 
_qyy_¨g3
, 0)

	)

6344 
	#VALGRIND_COUNT_ERRORS
 \

6345 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

6347 
VG_USERREQ__COUNT_ERRORS
, \

6348 0, 0, 0, 0, 0)

	)

6451 
	#VALGRIND_MALLOCLIKE_BLOCK
(
addr
, 
sizeB
, 
rzB
, 
is_zî€d
) \

6452 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MALLOCLIKE_BLOCK
, \

6453 
addr
, 
sizeB
, 
rzB
, 
is_zî€d
, 0)

	)

6458 
	#VALGRIND_RESIZEINPLACE_BLOCK
(
addr
, 
ﬁdSizeB
, 
√wSizeB
, 
rzB
) \

6459 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__RESIZEINPLACE_BLOCK
, \

6460 
addr
, 
ﬁdSizeB
, 
√wSizeB
, 
rzB
, 0)

	)

6465 
	#VALGRIND_FREELIKE_BLOCK
(
addr
, 
rzB
) \

6466 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__FREELIKE_BLOCK
, \

6467 
addr
, 
rzB
, 0, 0, 0)

	)

6470 
	#VALGRIND_CREATE_MEMPOOL
(
poﬁ
, 
rzB
, 
is_zî€d
) \

6471 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__CREATE_MEMPOOL
, \

6472 
poﬁ
, 
rzB
, 
is_zî€d
, 0, 0)

	)

6475 
	#VALGRIND_DESTROY_MEMPOOL
(
poﬁ
) \

6476 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__DESTROY_MEMPOOL
, \

6477 
poﬁ
, 0, 0, 0, 0)

	)

6480 
	#VALGRIND_MEMPOOL_ALLOC
(
poﬁ
, 
addr
, 
size
) \

6481 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MEMPOOL_ALLOC
, \

6482 
poﬁ
, 
addr
, 
size
, 0, 0)

	)

6485 
	#VALGRIND_MEMPOOL_FREE
(
poﬁ
, 
addr
) \

6486 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MEMPOOL_FREE
, \

6487 
poﬁ
, 
addr
, 0, 0, 0)

	)

6490 
	#VALGRIND_MEMPOOL_TRIM
(
poﬁ
, 
addr
, 
size
) \

6491 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MEMPOOL_TRIM
, \

6492 
poﬁ
, 
addr
, 
size
, 0, 0)

	)

6495 
	#VALGRIND_MOVE_MEMPOOL
(
poﬁA
, 
poﬁB
) \

6496 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MOVE_MEMPOOL
, \

6497 
poﬁA
, 
poﬁB
, 0, 0, 0)

	)

6500 
	#VALGRIND_MEMPOOL_CHANGE
(
poﬁ
, 
addrA
, 
addrB
, 
size
) \

6501 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MEMPOOL_CHANGE
, \

6502 
poﬁ
, 
addrA
, 
addrB
, 
size
, 0)

	)

6505 
	#VALGRIND_MEMPOOL_EXISTS
(
poﬁ
) \

6506 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

6507 
VG_USERREQ__MEMPOOL_EXISTS
, \

6508 
poﬁ
, 0, 0, 0, 0)

	)

6513 
	#VALGRIND_STACK_REGISTER
(
°¨t
, 
íd
) \

6514 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

6515 
VG_USERREQ__STACK_REGISTER
, \

6516 
°¨t
, 
íd
, 0, 0, 0)

	)

6520 
	#VALGRIND_STACK_DEREGISTER
(
id
) \

6521 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__STACK_DEREGISTER
, \

6522 
id
, 0, 0, 0, 0)

	)

6527 
	#VALGRIND_STACK_CHANGE
(
id
, 
°¨t
, 
íd
) \

6528 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__STACK_CHANGE
, \

6529 
id
, 
°¨t
, 
íd
, 0, 0)

	)

6532 
	#VALGRIND_LOAD_PDB_DEBUGINFO
(
fd
, 
±r
, 
tŸÆ_size
, 
dñè
) \

6533 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__LOAD_PDB_DEBUGINFO
, \

6534 
fd
, 
±r
, 
tŸÆ_size
, 
dñè
, 0)

	)

6540 
	#VALGRIND_MAP_IP_TO_SRCLOC
(
addr
, 
buf64
) \

6541 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

6542 
VG_USERREQ__MAP_IP_TO_SRCLOC
, \

6543 
addr
, 
buf64
, 0, 0, 0)

	)

6553 
	#VALGRIND_DISABLE_ERROR_REPORTING
 \

6554 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__CHANGE_ERR_DISABLEMENT
, \

6555 1, 0, 0, 0, 0)

	)

6559 
	#VALGRIND_ENABLE_ERROR_REPORTING
 \

6560 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__CHANGE_ERR_DISABLEMENT
, \

6561 -1, 0, 0, 0, 0)

	)

6568 
	#VALGRIND_MONITOR_COMMAND
(
comm™d
) \

6569 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, 
VG_USERREQ__GDB_MONITOR_COMMAND
, \

6570 
comm™d
, 0, 0, 0, 0)

	)

6573 #unde‡
PLAT_x86_d¨wö


6574 #unde‡
PLAT_amd64_d¨wö


6575 #unde‡
PLAT_x86_wö32


6576 #unde‡
PLAT_amd64_wö64


6577 #unde‡
PLAT_x86_löux


6578 #unde‡
PLAT_amd64_löux


6579 #unde‡
PLAT_µc32_löux


6580 #unde‡
PLAT_µc64be_löux


6581 #unde‡
PLAT_µc64À_löux


6582 #unde‡
PLAT_¨m_löux


6583 #unde‡
PLAT_s390x_löux


6584 #unde‡
PLAT_mùs32_löux


6585 #unde‡
PLAT_mùs64_löux


	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/arpa/nameser_compat.h

34 #i‚de‡
_ARPA_NAMESER_COMPAT_


35 
	#_ARPA_NAMESER_COMPAT_


	)

37 
	#__BIND
 19950621

	)

39 
	~<ídün.h
>

49 
	mid
 :16;

50 #i‡
BYTE_ORDER
 =
BIG_ENDIAN


52 
	mqr
: 1;

53 
	m›code
: 4;

54 
	mØ
: 1;

55 
	mtc
: 1;

56 
	mrd
: 1;

58 
	mø
: 1;

59 
	munu£d
 :1;

60 
	mad
: 1;

61 
	mcd
: 1;

62 
	mrcode
 :4;

64 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN
 || BYTE_ORDER =
PDP_ENDIAN


66 
	mrd
 :1;

67 
	mtc
 :1;

68 
	mØ
 :1;

69 
	m›code
 :4;

70 
	mqr
 :1;

72 
	mrcode
 :4;

73 
	mcd
: 1;

74 
	mad
: 1;

75 
	munu£d
 :1;

76 
	mø
 :1;

79 
	mqdcou¡
 :16;

80 
	m™cou¡
 :16;

81 
	mnscou¡
 :16;

82 
	m¨cou¡
 :16;

83 } 
	tHEADER
;

85 
	#PACKETSZ
 
NS_PACKETSZ


	)

86 
	#MAXDNAME
 
NS_MAXDNAME


	)

87 
	#MAXCDNAME
 
NS_MAXCDNAME


	)

88 
	#MAXLABEL
 
NS_MAXLABEL


	)

89 
	#HFIXEDSZ
 
NS_HFIXEDSZ


	)

90 
	#QFIXEDSZ
 
NS_QFIXEDSZ


	)

91 
	#RRFIXEDSZ
 
NS_RRFIXEDSZ


	)

92 
	#INT32SZ
 
NS_INT32SZ


	)

93 
	#INT16SZ
 
NS_INT16SZ


	)

94 
	#INT8SZ
 
NS_INT8SZ


	)

95 
	#INADDRSZ
 
NS_INADDRSZ


	)

96 
	#IN6ADDRSZ
 
NS_IN6ADDRSZ


	)

97 
	#INDIR_MASK
 
NS_CMPRSFLGS


	)

98 
	#NAMESERVER_PORT
 
NS_DEFAULTPORT


	)

100 
	#S_ZONE
 
ns_s_zn


	)

101 
	#S_PREREQ
 
ns_s_¥


	)

102 
	#S_UPDATE
 
ns_s_ud


	)

103 
	#S_ADDT
 
ns_s_¨


	)

105 
	#QUERY
 
ns_o_quîy


	)

106 
	#IQUERY
 
ns_o_iquîy


	)

107 
	#STATUS
 
ns_o_°©us


	)

108 
	#NS_NOTIFY_OP
 
ns_o_nŸify


	)

109 
	#NS_UPDATE_OP
 
ns_o_upd©e


	)

111 
	#NOERROR
 
ns_r_n€º‹


	)

112 
	#FORMERR
 
ns_r_f‹mîr


	)

113 
	#SERVFAIL
 
ns_r_£rvÁû


	)

114 
	#NXDOMAIN
 
ns_r_nxdomaö


	)

115 
	#NOTIMP
 
ns_r_nŸim∂


	)

116 
	#REFUSED
 
ns_r_ªfu£d


	)

117 
	#YXDOMAIN
 
ns_r_yxdomaö


	)

118 
	#YXRRSET
 
ns_r_yxº£t


	)

119 
	#NXRRSET
 
ns_r_nxº£t


	)

120 
	#NOTAUTH
 
ns_r_nŸauth


	)

121 
	#NOTZONE
 
ns_r_nŸz⁄e


	)

127 
	#DELETE
 
ns_u›_dñëe


	)

128 
	#ADD
 
ns_u›_add


	)

130 
	#T_A
 
ns_t_a


	)

131 
	#T_NS
 
ns_t_ns


	)

132 
	#T_MD
 
ns_t_md


	)

133 
	#T_MF
 
ns_t_mf


	)

134 
	#T_CNAME
 
ns_t_˙ame


	)

135 
	#T_SOA
 
ns_t_sﬂ


	)

136 
	#T_MB
 
ns_t_mb


	)

137 
	#T_MG
 
ns_t_mg


	)

138 
	#T_MR
 
ns_t_mr


	)

139 
	#T_NULL
 
ns_t_nuŒ


	)

140 
	#T_WKS
 
ns_t_wks


	)

141 
	#T_PTR
 
ns_t_±r


	)

142 
	#T_HINFO
 
ns_t_höfo


	)

143 
	#T_MINFO
 
ns_t_möfo


	)

144 
	#T_MX
 
ns_t_mx


	)

145 
	#T_TXT
 
ns_t_txt


	)

146 
	#T_RP
 
ns_t_Ω


	)

147 
	#T_AFSDB
 
ns_t_afsdb


	)

148 
	#T_X25
 
ns_t_x25


	)

149 
	#T_ISDN
 
ns_t_isdn


	)

150 
	#T_RT
 
ns_t_π


	)

151 
	#T_NSAP
 
ns_t_nßp


	)

152 
	#T_NSAP_PTR
 
ns_t_nßp_±r


	)

153 
	#T_SIG
 
ns_t_sig


	)

154 
	#T_KEY
 
ns_t_key


	)

155 
	#T_PX
 
ns_t_px


	)

156 
	#T_GPOS
 
ns_t_gpos


	)

157 
	#T_AAAA
 
ns_t_ØØ


	)

158 
	#T_LOC
 
ns_t_loc


	)

159 
	#T_NXT
 
ns_t_nxt


	)

160 
	#T_EID
 
ns_t_eid


	)

161 
	#T_NIMLOC
 
ns_t_nimloc


	)

162 
	#T_SRV
 
ns_t_§v


	)

163 
	#T_ATMA
 
ns_t_©ma


	)

164 
	#T_NAPTR
 
ns_t_«±r


	)

165 
	#T_A6
 
ns_t_a6


	)

166 
	#T_DNAME
 
ns_t_d«me


	)

167 
	#T_TSIG
 
ns_t_tsig


	)

168 
	#T_IXFR
 
ns_t_ix‰


	)

169 
	#T_AXFR
 
ns_t_ax‰


	)

170 
	#T_MAILB
 
ns_t_maûb


	)

171 
	#T_MAILA
 
ns_t_maûa


	)

172 
	#T_ANY
 
ns_t_™y


	)

174 
	#C_IN
 
ns_c_ö


	)

175 
	#C_CHAOS
 
ns_c_chaos


	)

176 
	#C_HS
 
ns_c_hs


	)

178 
	#C_NONE
 
ns_c_n⁄e


	)

179 
	#C_ANY
 
ns_c_™y


	)

181 
	#GETSHORT
 
NS_GET16


	)

182 
	#GETLONG
 
NS_GET32


	)

183 
	#PUTSHORT
 
NS_PUT16


	)

184 
	#PUTLONG
 
NS_PUT32


	)

	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_BSD
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

62 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

64 
	#htﬁe16
(
x
Ë(x)

	)

65 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

66 
	#À16toh
(
x
Ë(x)

	)

68 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

69 
	#htﬁe32
(
x
Ë(x)

	)

70 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

71 
	#À32toh
(
x
Ë(x)

	)

73 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

74 
	#htﬁe64
(
x
Ë(x)

	)

75 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

76 
	#À64toh
(
x
Ë(x)

	)

79 
	#htobe16
(
x
Ë(x)

	)

80 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

81 
	#be16toh
(
x
Ë(x)

	)

82 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

84 
	#htobe32
(
x
Ë(x)

	)

85 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

86 
	#be32toh
(
x
Ë(x)

	)

87 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

89 
	#htobe64
(
x
Ë(x)

	)

90 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

91 
	#be64toh
(
x
Ë(x)

	)

92 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #unde‡
__USE_ISOC11


102 #unde‡
__USE_ISOC99


103 #unde‡
__USE_ISOC95


104 #unde‡
__USE_ISOCXX11


105 #unde‡
__USE_POSIX


106 #unde‡
__USE_POSIX2


107 #unde‡
__USE_POSIX199309


108 #unde‡
__USE_POSIX199506


109 #unde‡
__USE_XOPEN


110 #unde‡
__USE_XOPEN_EXTENDED


111 #unde‡
__USE_UNIX98


112 #unde‡
__USE_XOPEN2K


113 #unde‡
__USE_XOPEN2KXSI


114 #unde‡
__USE_XOPEN2K8


115 #unde‡
__USE_XOPEN2K8XSI


116 #unde‡
__USE_LARGEFILE


117 #unde‡
__USE_LARGEFILE64


118 #unde‡
__USE_FILE_OFFSET64


119 #unde‡
__USE_BSD


120 #unde‡
__USE_SVID


121 #unde‡
__USE_MISC


122 #unde‡
__USE_ATFILE


123 #unde‡
__USE_GNU


124 #unde‡
__USE_REENTRANT


125 #unde‡
__USE_FORTIFY_LEVEL


126 #unde‡
__KERNEL_STRICT_NAMES


130 #i‚de‡
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

143 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

150 #ifde‡
_GNU_SOURCE


151 #unde‡
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #unde‡
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #unde‡
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #unde‡
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #unde‡
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #unde‡
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #unde‡
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #unde‡
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #unde‡
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #unde‡
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #unde‡
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #unde‡
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #i‡(
deföed
 
_DEFAULT_SOURCE
 \

180 || (!
deföed
 
	g__STRICT_ANSI__
 \

181 && !
deföed
 
	g_ISOC99_SOURCE
 \

182 && !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 \

183 && !
deföed
 
	g_XOPEN_SOURCE
 \

184 && !
deföed
 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
))

185 #unde‡
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #unde‡
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #unde‡
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #i‡(
deföed
 
_ISOC11_SOURCE
 \

195 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

201 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

207 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

216 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifde‡
_DEFAULT_SOURCE


224 #i‡!
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #unde‡
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #unde‡
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #unde‡
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #unde‡
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #unde‡
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #unde‡
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

285 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #unde‡
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #unde‡
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifde‡
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifde‡
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifde‡
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #i‡
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<°dc-¥edef.h
>

360 #unde‡
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

369 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

372 #i‚de‡
__ASSEMBLER__


373 #i‚de‡
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

388 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

389 && 
deföed
 
	g__exã∫_ölöe


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/°ubs.h
>

	@/usr/include/getopt.h

19 #i‚de‡
_GETOPT_H


21 #i‚de‡
__√ed_gë›t


22 
	#_GETOPT_H
 1

	)

32 #i‡!
deföed
 
__GNU_LIBRARY__


33 
	~<˘y≥.h
>

36 #i‚de‡
__THROW


37 #i‚de‡
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

40 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__˝lu•lus


57 *
›èrg
;

71 
›töd
;

76 
›ãº
;

80 
›t›t
;

82 #i‚de‡
__√ed_gë›t


104 
	s›ti⁄


106 c⁄° *
	g«me
;

109 
	ghas_¨g
;

110 *
	gÊag
;

111 
	gvÆ
;

116 
	#no_¨gumít
 0

	)

117 
	#ªquúed_¨gumít
 1

	)

118 
	#›ti⁄Æ_¨gumít
 2

	)

146 #ifde‡
__GNU_LIBRARY__


150 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

151 
__THROW
;

153 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

154 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


158 #ifde‡
__REDIRECT


159 
__REDIRECT_NTH
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

160 c⁄° *
__sh‹t›ts
),

161 
__posix_gë›t
);

163 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

164 c⁄° *
__sh‹t›ts
Ë
__THROW
;

165 
	#gë›t
 
__posix_gë›t


	)

169 
gë›t
 ();

172 #i‚de‡
__√ed_gë›t


173 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

174 c⁄° *
__sh‹t›ts
,

175 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

176 
__THROW
;

177 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

178 c⁄° *
__sh‹t›ts
,

179 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

180 
__THROW
;

184 #ifdef 
__˝lu•lus


189 #unde‡
__√ed_gë›t


	@/usr/include/krb5/krb5.h

2 #i‚de‡
KRB5_KRB5_H_INCLUDED


3 
	#KRB5_KRB5_H_INCLUDED


	)

55 #i‚de‡
KRB5_GENERAL__


56 
	#KRB5_GENERAL__


	)

63 #i‚de‡
KRB5_DEPRECATED


64 
	#KRB5_DEPRECATED
 0

	)

67 #i‡
deföed
(
__MACH__
Ë&& deföed(
__APPLE__
)

68 
	~<T¨gëC⁄dôi⁄Æs.h
>

69 #i‡
TARGET_RT_MAC_CFM


74 #i‡
deföed
(
_MSDOS
Ë|| deföed(
_WIN32
)

75 
	~<wö-mac.h
>

78 #i‚de‡
KRB5_CONFIG__


79 #i‚de‡
KRB5_CALLCONV


80 
	#KRB5_CALLCONV


	)

81 
	#KRB5_CALLCONV_C


	)

85 #i‚de‡
KRB5_CALLCONV_WRONG


86 
	#KRB5_CALLCONV_WRONG


	)

89 #i‚de‡
THREEPARAMOPEN


90 
	#THREEPARAMOPEN
(
x
,
y
,
z
Ë
	`›í
(x,y,z)

	)

93 
	#KRB5_OLD_CRYPTO


	)

95 
	~<°dlib.h
>

96 
	~<limôs.h
>

97 
	~<°d¨g.h
>

99 #i‚de‡
KRB5INT_BEGIN_DECLS


100 #i‡
deföed
(
__˝lu•lus
)

101 
	#KRB5INT_BEGIN_DECLS
 "C" {

	)

102 
	#KRB5INT_END_DECLS
 }

	)

104 
	#KRB5INT_BEGIN_DECLS


	)

105 
	#KRB5INT_END_DECLS


	)

109 
KRB5INT_BEGIN_DECLS


111 #i‡
TARGET_OS_MAC


112 #¥agm®
∑ck
(
push
,2)

115 #i‡(
__GNUC__
 * 10000 + 
__GNUC_MINOR__
 * 100 + 
__GNUC_PATCHLEVEL__
) >= 30203

116 
	#KRB5_ATTR_DEPRECATED
 
	`__©åibuã__
((
dïªˇãd
))

	)

117 #ñi‡
deföed
 
_WIN32


118 
	#KRB5_ATTR_DEPRECATED
 
	`__de˛•ec
(
dïªˇãd
)

	)

120 
	#KRB5_ATTR_DEPRECATED


	)

124 
_¥ofûe_t
;

135 
	tkrb5_o˘ë
;

137 #i‡
INT_MAX
 == 0x7fff

138 
	tkrb5_öt16
;

139 
	tkrb5_ui_2
;

140 #ñi‡
SHRT_MAX
 == 0x7fff

141 
	tkrb5_öt16
;

142 
	tkrb5_ui_2
;

144 #îr‹ 
undeföed
 16 
bô
 
ty≥


147 #i‡
INT_MAX
 == 0x7fffffffL

148 
	tkrb5_öt32
;

149 
	tkrb5_ui_4
;

150 #ñi‡
LONG_MAX
 == 0x7fffffffL

151 
	tkrb5_öt32
;

152 
	tkrb5_ui_4
;

153 #ñi‡
SHRT_MAX
 == 0x7fffffffL

154 
	tkrb5_öt32
;

155 
	tkrb5_ui_4
;

157 #îr‹: 
undeföed
 32 
bô
 
ty≥


160 
	#VALID_INT_BITS
 
INT_MAX


	)

161 
	#VALID_UINT_BITS
 
UINT_MAX


	)

163 
	#KRB5_INT32_MAX
 2147483647

	)

166 
	#KRB5_INT32_MIN
 (-
KRB5_INT32_MAX
-1)

	)

168 
	#KRB5_INT16_MAX
 65535

	)

171 
	#KRB5_INT16_MIN
 (-
KRB5_INT16_MAX
-1)

	)

185 #i‚de‡
FALSE


186 
	#FALSE
 0

	)

188 #i‚de‡
TRUE


189 
	#TRUE
 1

	)

192 
	tkrb5_boﬁón
;

193 
	tkrb5_msgty≥
;

194 
	tkrb5_kvno
;

196 
krb5_öt32
 
	tkrb5_addπy≥
;

197 
krb5_öt32
 
	tkrb5_í˘y≥
;

198 
krb5_öt32
 
	tkrb5_cksumty≥
;

199 
krb5_öt32
 
	tkrb5_authd©©y≥
;

200 
krb5_öt32
 
	tkrb5_keyußge
;

201 
krb5_öt32
 
	tkrb5_¸y±Ÿy≥
;

203 
krb5_öt32
 
	tkrb5_¥óuthty≥
;

204 
krb5_öt32
 
	tkrb5_Êags
;

205 
krb5_öt32
 
	tkrb5_time°amp
;

206 
krb5_öt32
 
	tkrb5_îr‹_code
;

207 
krb5_öt32
 
	tkrb5_dñèt
;

209 
krb5_îr‹_code
 
	tkrb5_magic
;

211 
	s_krb5_d©a
 {

212 
krb5_magic
 
	mmagic
;

213 
	mÀngth
;

214 *
	md©a
;

215 } 
	tkrb5_d©a
;

218 
	s_krb5_o˘ë_d©a
 {

219 
krb5_magic
 
	mmagic
;

220 
	mÀngth
;

221 
krb5_o˘ë
 *
	md©a
;

222 } 
	tkrb5_o˘ë_d©a
;

225 
	#SALT_TYPE_AFS_LENGTH
 
UINT_MAX


	)

226 
	#SALT_TYPE_NO_LENGTH
 
UINT_MAX


	)

228 * 
	tkrb5_poöãr
;

229 c⁄° * 
	tkrb5_c⁄°_poöãr
;

231 
	skrb5_¥öcùÆ_d©a
 {

232 
krb5_magic
 
	mmagic
;

233 
krb5_d©a
 
	mªÆm
;

234 
krb5_d©a
 *
	md©a
;

235 
krb5_öt32
 
	mÀngth
;

236 
krb5_öt32
 
	mty≥
;

237 } 
	tkrb5_¥öcùÆ_d©a
;

239 
krb5_¥öcùÆ_d©a
 * 
	tkrb5_¥öcùÆ
;

245 
	#KRB5_NT_UNKNOWN
 0

	)

246 
	#KRB5_NT_PRINCIPAL
 1

	)

248 
	#KRB5_NT_SRV_INST
 2

	)

249 
	#KRB5_NT_SRV_HST
 3

	)

251 
	#KRB5_NT_SRV_XHST
 4

	)

252 
	#KRB5_NT_UID
 5

	)

253 
	#KRB5_NT_X500_PRINCIPAL
 6

	)

254 
	#KRB5_NT_SMTP_NAME
 7

	)

255 
	#KRB5_NT_ENTERPRISE_PRINCIPAL
 10

	)

256 
	#KRB5_NT_WELLKNOWN
 11

	)

257 
	#KRB5_WELLKNOWN_NAMESTR
 "WELLKNOWN"

	)

259 
	#KRB5_NT_MS_PRINCIPAL
 -128

	)

260 
	#KRB5_NT_MS_PRINCIPAL_AND_ID
 -129

	)

261 
	#KRB5_NT_ENT_PRINCIPAL_AND_ID
 -130

	)

264 c⁄° 
	tkrb5_¥öcùÆ_d©a
 *
	tkrb5_c⁄°_¥öcùÆ
;

266 
	#krb5_¥öc_ªÆm
(
c⁄ãxt
, 
¥öc
Ë(&’röc)->
ªÆm
)

	)

267 
	#krb5_¥öc_£t_ªÆm
(
c⁄ãxt
, 
¥öc
,
vÆue
Ë(’röc)->
ªÆm
 = *(vÆue))

	)

268 
	#krb5_¥öc_£t_ªÆm_Àngth
(
c⁄ãxt
, 
¥öc
,
vÆue
Ë’röc)->
ªÆm
.
Àngth
 = (vÆue)

	)

269 
	#krb5_¥öc_£t_ªÆm_d©a
(
c⁄ãxt
, 
¥öc
,
vÆue
Ë’röc)->
ªÆm
.
d©a
 = (vÆue)

	)

270 
	#krb5_¥öc_size
(
c⁄ãxt
, 
¥öc
Ë’röc)->
Àngth


	)

271 
	#krb5_¥öc_ty≥
(
c⁄ãxt
, 
¥öc
Ë’röc)->
ty≥


	)

272 
	#krb5_¥öc_«me
(
c⁄ãxt
, 
¥öc
Ë’röc)->
d©a


	)

273 
	#krb5_¥öc_comp⁄ít
(
c⁄ãxt
, 
¥öc
,
i
) \

274 (((
i
Ë< 
	`krb5_¥öc_size
(
c⁄ãxt
, 
¥öc
)) \

275 ? (
¥öc
)->
d©a
 + (
i
) \

276 : 
NULL
)

	)

279 
	#KRB5_REFERRAL_REALM
 ""

	)

292 
krb5_boﬁón
 
KRB5_CALLCONV


293 
krb5_is_ª„ºÆ_ªÆm
(c⁄° 
krb5_d©a
 *
r
);

302 c⁄° 
krb5_d©a
 *
KRB5_CALLCONV


303 
krb5_™⁄ymous_ªÆm
();

312 
krb5_c⁄°_¥öcùÆ
 
KRB5_CALLCONV


313 
krb5_™⁄ymous_¥öcùÆ
();

315 
	#KRB5_ANONYMOUS_REALMSTR
 "WELLKNOWN:ANONYMOUS"

	)

316 
	#KRB5_ANONYMOUS_PRINCSTR
 "ANONYMOUS"

	)

326 
	s_krb5_addªss
 {

327 
krb5_magic
 
	mmagic
;

328 
krb5_addπy≥
 
	maddπy≥
;

329 
	mÀngth
;

330 
krb5_o˘ë
 *
	mc⁄ã¡s
;

331 } 
	tkrb5_addªss
;

334 
	#ADDRTYPE_INET
 0x0002

	)

335 
	#ADDRTYPE_CHAOS
 0x0005

	)

336 
	#ADDRTYPE_XNS
 0x0006

	)

337 
	#ADDRTYPE_ISO
 0x0007

	)

338 
	#ADDRTYPE_DDP
 0x0010

	)

339 
	#ADDRTYPE_NETBIOS
 0x0014

	)

340 
	#ADDRTYPE_INET6
 0x0018

	)

342 
	#ADDRTYPE_ADDRPORT
 0x0100

	)

343 
	#ADDRTYPE_IPPORT
 0x0101

	)

346 
	#ADDRTYPE_IS_LOCAL
(
addπy≥
Ë◊ddπy≥ & 0x8000)

	)

353 
	g_krb5_c⁄ãxt
;

354 
_krb5_c⁄ãxt
 * 
	tkrb5_c⁄ãxt
;

356 
	g_krb5_auth_c⁄ãxt
;

357 
_krb5_auth_c⁄ãxt
 * 
	tkrb5_auth_c⁄ãxt
;

359 
	g_krb5_¸y±osy°em_íåy
;

366 
	s_krb5_keyblock
 {

367 
krb5_magic
 
	mmagic
;

368 
krb5_í˘y≥
 
	mí˘y≥
;

369 
	mÀngth
;

370 
krb5_o˘ë
 *
	mc⁄ã¡s
;

371 } 
	tkrb5_keyblock
;

373 
	gkrb5_key_°
;

382 
krb5_key_°
 *
	tkrb5_key
;

384 #ifde‡
KRB5_OLD_CRYPTO


385 
	s_krb5_í¸y±_block
 {

386 
krb5_magic
 
	mmagic
;

387 
krb5_í˘y≥
 
	m¸y±o_íåy
;

390 
krb5_keyblock
 *
	mkey
;

391 } 
	tkrb5_í¸y±_block
;

394 
	s_krb5_checksum
 {

395 
krb5_magic
 
	mmagic
;

396 
krb5_cksumty≥
 
	mchecksum_ty≥
;

397 
	mÀngth
;

398 
krb5_o˘ë
 *
	mc⁄ã¡s
;

399 } 
	tkrb5_checksum
;

401 
	s_krb5_íc_d©a
 {

402 
krb5_magic
 
	mmagic
;

403 
krb5_í˘y≥
 
	mí˘y≥
;

404 
krb5_kvno
 
	mkvno
;

405 
krb5_d©a
 
	mcùhîãxt
;

406 } 
	tkrb5_íc_d©a
;

418 
	s_krb5_¸y±o_iov
 {

419 
krb5_¸y±Ÿy≥
 
	mÊags
;

420 
krb5_d©a
 
	md©a
;

421 } 
	tkrb5_¸y±o_iov
;

424 
	#ENCTYPE_NULL
 0x0000

	)

425 
	#ENCTYPE_DES_CBC_CRC
 0x0001

	)

426 
	#ENCTYPE_DES_CBC_MD4
 0x0002

	)

427 
	#ENCTYPE_DES_CBC_MD5
 0x0003

	)

428 
	#ENCTYPE_DES_CBC_RAW
 0x0004

	)

429 
	#ENCTYPE_DES3_CBC_SHA
 0x0005

	)

430 
	#ENCTYPE_DES3_CBC_RAW
 0x0006

	)

431 
	#ENCTYPE_DES_HMAC_SHA1
 0x0008

	)

433 
	#ENCTYPE_DSA_SHA1_CMS
 0x0009

	)

434 
	#ENCTYPE_MD5_RSA_CMS
 0x000®

	)

435 
	#ENCTYPE_SHA1_RSA_CMS
 0x000b

	)

436 
	#ENCTYPE_RC2_CBC_ENV
 0x000¯

	)

437 
	#ENCTYPE_RSA_ENV
 0x000d

	)

438 
	#ENCTYPE_RSA_ES_OAEP_ENV
 0x000ê

	)

439 
	#ENCTYPE_DES3_CBC_ENV
 0x000‡

	)

441 
	#ENCTYPE_DES3_CBC_SHA1
 0x0010

	)

442 
	#ENCTYPE_AES128_CTS_HMAC_SHA1_96
 0x0011

	)

443 
	#ENCTYPE_AES256_CTS_HMAC_SHA1_96
 0x0012

	)

444 
	#ENCTYPE_ARCFOUR_HMAC
 0x0017

	)

445 
	#ENCTYPE_ARCFOUR_HMAC_EXP
 0x0018

	)

446 
	#ENCTYPE_CAMELLIA128_CTS_CMAC
 0x0019

	)

447 
	#ENCTYPE_CAMELLIA256_CTS_CMAC
 0x001®

	)

448 
	#ENCTYPE_UNKNOWN
 0x01ff

	)

450 
	#CKSUMTYPE_CRC32
 0x0001

	)

451 
	#CKSUMTYPE_RSA_MD4
 0x0002

	)

452 
	#CKSUMTYPE_RSA_MD4_DES
 0x0003

	)

453 
	#CKSUMTYPE_DESCBC
 0x0004

	)

456 
	#CKSUMTYPE_RSA_MD5
 0x0007

	)

457 
	#CKSUMTYPE_RSA_MD5_DES
 0x0008

	)

458 
	#CKSUMTYPE_NIST_SHA
 0x0009

	)

459 
	#CKSUMTYPE_HMAC_SHA1_DES3
 0x000c

	)

460 
	#CKSUMTYPE_HMAC_SHA1_96_AES128
 0x000‡

	)

462 
	#CKSUMTYPE_HMAC_SHA1_96_AES256
 0x0010

	)

464 
	#CKSUMTYPE_CMAC_CAMELLIA128
 0x0011

	)

465 
	#CKSUMTYPE_CMAC_CAMELLIA256
 0x0012

	)

466 
	#CKSUMTYPE_MD5_HMAC_ARCFOUR
 -137

	)

467 
	#CKSUMTYPE_HMAC_MD5_ARCFOUR
 -138

	)

479 
	mKRB5_C_RANDSOURCE_OLDAPI
 = 0,

480 
	mKRB5_C_RANDSOURCE_OSRAND
 = 1,

481 
	mKRB5_C_RANDSOURCE_TRUSTEDPARTY
 = 2,

487 
	mKRB5_C_RANDSOURCE_TIMING
 = 3,

488 
	mKRB5_C_RANDSOURCE_EXTERNAL_PROTOCOL
 = 4,

489 
	mKRB5_C_RANDSOURCE_MAX
 = 5

492 #i‚de‡
krb5_roundup


494 
	#krb5_roundup
(
x
, 
y
Ë((((xË+ (yË- 1)/(y))*(y))

	)

500 
	#krb5_x
(
±r
,
¨gs
Ë(’å)?((*’å)Ë¨gs):(
	`ab‹t
(),1))

	)

501 
	#krb5_xc
(
±r
,
¨gs
Ë(’å)?((*’å)Ë¨gs):(
	`ab‹t
(),(*)0))

	)

503 
	#krb5_x
(
±r
,
¨gs
Ë((*’å)Ë¨gs)

	)

504 
	#krb5_xc
(
±r
,
¨gs
Ë((*’å)Ë¨gs)

	)

530 
krb5_îr‹_code
 
KRB5_CALLCONV


531 
krb5_c_í¸y±
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
key
,

532 
krb5_keyußge
 
ußge
, c⁄° 
krb5_d©a
 *
cùhî_°©e
,

533 c⁄° 
krb5_d©a
 *
öput
, 
krb5_íc_d©a
 *
ouçut
);

559 
krb5_îr‹_code
 
KRB5_CALLCONV


560 
krb5_c_de¸y±
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
key
,

561 
krb5_keyußge
 
ußge
, c⁄° 
krb5_d©a
 *
cùhî_°©e
,

562 c⁄° 
krb5_íc_d©a
 *
öput
, 
krb5_d©a
 *
ouçut
);

577 
krb5_îr‹_code
 
KRB5_CALLCONV


578 
krb5_c_í¸y±_Àngth
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

579 
size_t
 
öpuéí
, size_à*
Àngth
);

590 
krb5_îr‹_code
 
KRB5_CALLCONV


591 
krb5_c_block_size
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

592 
size_t
 *
blocksize
);

604 
krb5_îr‹_code
 
KRB5_CALLCONV


605 
krb5_c_keyÀngths
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

606 
size_t
 *
keybyãs
, size_à*
keyÀngth
);

618 
krb5_îr‹_code
 
KRB5_CALLCONV


619 
krb5_c_öô_°©e
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
key
,

620 
krb5_keyußge
 
ußge
, 
krb5_d©a
 *
√w_°©e
);

631 
krb5_îr‹_code
 
KRB5_CALLCONV


632 
krb5_c_‰ì_°©e
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
key
,

633 
krb5_d©a
 *
°©e
);

650 
krb5_îr‹_code
 
KRB5_CALLCONV


651 
krb5_c_¥f
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
keyblock
,

652 
krb5_d©a
 *
öput
, krb5_d©®*
ouçut
);

663 
krb5_îr‹_code
 
KRB5_CALLCONV


664 
krb5_c_¥f_Àngth
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
, 
size_t
 *
Àn
);

684 
krb5_îr‹_code
 
KRB5_CALLCONV


685 
krb5_c_fx_cf2_sim∂e
(
krb5_c⁄ãxt
 
c⁄ãxt
,

686 
krb5_keyblock
 *
k1
, c⁄° *
≥µî1
,

687 
krb5_keyblock
 *
k2
, c⁄° *
≥µî2
,

688 
krb5_keyblock
 **
out
);

702 
krb5_îr‹_code
 
KRB5_CALLCONV


703 
krb5_c_make_øndom_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

704 
krb5_keyblock
 *
k5_øndom_key
);

724 
krb5_îr‹_code
 
KRB5_CALLCONV


725 
krb5_c_øndom_to_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

726 
krb5_d©a
 *
øndom_d©a
, 
krb5_keyblock
 *
k5_øndom_key
);

741 
krb5_îr‹_code
 
KRB5_CALLCONV


742 
krb5_c_øndom_add_íå›y
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
øndsour˚
,

743 c⁄° 
krb5_d©a
 *
d©a
);

757 
krb5_îr‹_code
 
KRB5_CALLCONV


758 
krb5_c_øndom_make_o˘ës
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_d©a
 *
d©a
);

774 
krb5_îr‹_code
 
KRB5_CALLCONV


775 
krb5_c_øndom_os_íå›y
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
°r⁄g
, *
suc˚ss
);

778 
krb5_îr‹_code
 
KRB5_CALLCONV


779 
krb5_c_øndom_£ed
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_d©a
 *
d©a
);

796 
krb5_îr‹_code
 
KRB5_CALLCONV


797 
krb5_c_°rög_to_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

798 c⁄° 
krb5_d©a
 *
°rög
, c⁄° krb5_d©®*
ß…
,

799 
krb5_keyblock
 *
key
);

818 
krb5_îr‹_code
 
KRB5_CALLCONV


819 
krb5_c_°rög_to_key_wôh_∑øms
(
krb5_c⁄ãxt
 
c⁄ãxt
,

820 
krb5_í˘y≥
 
í˘y≥
,

821 c⁄° 
krb5_d©a
 *
°rög
,

822 c⁄° 
krb5_d©a
 *
ß…
,

823 c⁄° 
krb5_d©a
 *
∑øms
,

824 
krb5_keyblock
 *
key
);

839 
krb5_îr‹_code
 
KRB5_CALLCONV


840 
krb5_c_í˘y≥_com∑ª
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
e1
, krb5_í˘y≥ 
e2
,

841 
krb5_boﬁón
 *
simû¨
);

868 
krb5_îr‹_code
 
KRB5_CALLCONV


869 
krb5_c_make_checksum
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
cksumty≥
,

870 c⁄° 
krb5_keyblock
 *
key
, 
krb5_keyußge
 
ußge
,

871 c⁄° 
krb5_d©a
 *
öput
, 
krb5_checksum
 *
cksum
);

894 
krb5_îr‹_code
 
KRB5_CALLCONV


895 
krb5_c_vîify_checksum
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
key
,

896 
krb5_keyußge
 
ußge
, c⁄° 
krb5_d©a
 *
d©a
,

897 c⁄° 
krb5_checksum
 *
cksum
, 
krb5_boﬁón
 *
vÆid
);

908 
krb5_îr‹_code
 
KRB5_CALLCONV


909 
krb5_c_checksum_Àngth
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
cksumty≥
,

910 
size_t
 *
Àngth
);

925 
krb5_îr‹_code
 
KRB5_CALLCONV


926 
krb5_c_keyed_checksum_ty≥s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

927 *
cou¡
, 
krb5_cksumty≥
 **
cksumty≥s
);

932 
	#KRB5_KEYUSAGE_AS_REQ_PA_ENC_TS
 1

	)

933 
	#KRB5_KEYUSAGE_KDC_REP_TICKET
 2

	)

934 
	#KRB5_KEYUSAGE_AS_REP_ENCPART
 3

	)

935 
	#KRB5_KEYUSAGE_TGS_REQ_AD_SESSKEY
 4

	)

936 
	#KRB5_KEYUSAGE_TGS_REQ_AD_SUBKEY
 5

	)

937 
	#KRB5_KEYUSAGE_TGS_REQ_AUTH_CKSUM
 6

	)

938 
	#KRB5_KEYUSAGE_TGS_REQ_AUTH
 7

	)

939 
	#KRB5_KEYUSAGE_TGS_REP_ENCPART_SESSKEY
 8

	)

940 
	#KRB5_KEYUSAGE_TGS_REP_ENCPART_SUBKEY
 9

	)

941 
	#KRB5_KEYUSAGE_AP_REQ_AUTH_CKSUM
 10

	)

942 
	#KRB5_KEYUSAGE_AP_REQ_AUTH
 11

	)

943 
	#KRB5_KEYUSAGE_AP_REP_ENCPART
 12

	)

944 
	#KRB5_KEYUSAGE_KRB_PRIV_ENCPART
 13

	)

945 
	#KRB5_KEYUSAGE_KRB_CRED_ENCPART
 14

	)

946 
	#KRB5_KEYUSAGE_KRB_SAFE_CKSUM
 15

	)

947 
	#KRB5_KEYUSAGE_APP_DATA_ENCRYPT
 16

	)

948 
	#KRB5_KEYUSAGE_APP_DATA_CKSUM
 17

	)

949 
	#KRB5_KEYUSAGE_KRB_ERROR_CKSUM
 18

	)

950 
	#KRB5_KEYUSAGE_AD_KDCISSUED_CKSUM
 19

	)

951 
	#KRB5_KEYUSAGE_AD_MTE
 20

	)

952 
	#KRB5_KEYUSAGE_AD_ITE
 21

	)

956 
	#KRB5_KEYUSAGE_GSS_TOK_MIC
 22

	)

957 
	#KRB5_KEYUSAGE_GSS_TOK_WRAP_INTEG
 23

	)

958 
	#KRB5_KEYUSAGE_GSS_TOK_WRAP_PRIV
 24

	)

961 
	#KRB5_KEYUSAGE_PA_SAM_CHALLENGE_CKSUM
 25

	)

963 
	#KRB5_KEYUSAGE_PA_SAM_CHALLENGE_TRACKID
 26

	)

965 
	#KRB5_KEYUSAGE_PA_SAM_RESPONSE
 27

	)

969 
	#KRB5_KEYUSAGE_PA_S4U_X509_USER_REQUEST
 26

	)

971 
	#KRB5_KEYUSAGE_PA_S4U_X509_USER_REPLY
 27

	)

974 
	#KRB5_KEYUSAGE_PA_REFERRAL
 26

	)

976 
	#KRB5_KEYUSAGE_AD_SIGNEDPATH
 -21

	)

977 
	#KRB5_KEYUSAGE_IAKERB_FINISHED
 42

	)

978 
	#KRB5_KEYUSAGE_PA_PKINIT_KX
 44

	)

979 
	#KRB5_KEYUSAGE_PA_OTP_REQUEST
 45

	)

981 
	#KRB5_KEYUSAGE_FAST_REQ_CHKSUM
 50

	)

982 
	#KRB5_KEYUSAGE_FAST_ENC
 51

	)

983 
	#KRB5_KEYUSAGE_FAST_REP
 52

	)

984 
	#KRB5_KEYUSAGE_FAST_FINISHED
 53

	)

985 
	#KRB5_KEYUSAGE_ENC_CHALLENGE_CLIENT
 54

	)

986 
	#KRB5_KEYUSAGE_ENC_CHALLENGE_KDC
 55

	)

987 
	#KRB5_KEYUSAGE_AS_REQ
 56

	)

997 
krb5_boﬁón
 
KRB5_CALLCONV


998 
krb5_c_vÆid_í˘y≥
(
krb5_í˘y≥
 
kty≥
);

1007 
krb5_boﬁón
 
KRB5_CALLCONV


1008 
krb5_c_vÆid_cksumty≥
(
krb5_cksumty≥
 
˘y≥
);

1018 
krb5_boﬁón
 
KRB5_CALLCONV


1019 
krb5_c_is_cﬁl_¥oof_cksum
(
krb5_cksumty≥
 
˘y≥
);

1028 
krb5_boﬁón
 
KRB5_CALLCONV


1029 
krb5_c_is_keyed_cksum
(
krb5_cksumty≥
 
˘y≥
);

1035 
	#KRB5_CRYPTO_TYPE_EMPTY
 0

	)

1036 
	#KRB5_CRYPTO_TYPE_HEADER
 1

	)

1037 
	#KRB5_CRYPTO_TYPE_DATA
 2

	)

1038 
	#KRB5_CRYPTO_TYPE_SIGN_ONLY
 3

	)

1039 
	#KRB5_CRYPTO_TYPE_PADDING
 4

	)

1040 
	#KRB5_CRYPTO_TYPE_TRAILER
 5

	)

1041 
	#KRB5_CRYPTO_TYPE_CHECKSUM
 6

	)

1042 
	#KRB5_CRYPTO_TYPE_STREAM
 7

	)

1068 
krb5_îr‹_code
 
KRB5_CALLCONV


1069 
krb5_c_make_checksum_iov
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
cksumty≥
,

1070 c⁄° 
krb5_keyblock
 *
key
, 
krb5_keyußge
 
ußge
,

1071 
krb5_¸y±o_iov
 *
d©a
, 
size_t
 
num_d©a
);

1095 
krb5_îr‹_code
 
KRB5_CALLCONV


1096 
krb5_c_vîify_checksum_iov
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
cksumty≥
,

1097 c⁄° 
krb5_keyblock
 *
key
, 
krb5_keyußge
 
ußge
,

1098 c⁄° 
krb5_¸y±o_iov
 *
d©a
, 
size_t
 
num_d©a
,

1099 
krb5_boﬁón
 *
vÆid
);

1131 
krb5_îr‹_code
 
KRB5_CALLCONV


1132 
krb5_c_í¸y±_iov
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
keyblock
,

1133 
krb5_keyußge
 
ußge
, c⁄° 
krb5_d©a
 *
cùhî_°©e
,

1134 
krb5_¸y±o_iov
 *
d©a
, 
size_t
 
num_d©a
);

1166 
krb5_îr‹_code
 
KRB5_CALLCONV


1167 
krb5_c_de¸y±_iov
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
keyblock
,

1168 
krb5_keyußge
 
ußge
, c⁄° 
krb5_d©a
 *
cùhî_°©e
,

1169 
krb5_¸y±o_iov
 *
d©a
, 
size_t
 
num_d©a
);

1181 
krb5_îr‹_code
 
KRB5_CALLCONV


1182 
krb5_c_¸y±o_Àngth
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

1183 
krb5_¸y±Ÿy≥
 
ty≥
, *
size
);

1200 
krb5_îr‹_code
 
KRB5_CALLCONV


1201 
krb5_c_¸y±o_Àngth_iov
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

1202 
krb5_¸y±o_iov
 *
d©a
, 
size_t
 
num_d©a
);

1217 
krb5_îr‹_code
 
KRB5_CALLCONV


1218 
krb5_c_∑ddög_Àngth
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

1219 
size_t
 
d©a_Àngth
, *
size
);

1233 
krb5_îr‹_code
 
KRB5_CALLCONV


1234 
krb5_k_¸óã_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
key_d©a
,

1235 
krb5_key
 *
out
);

1238 
KRB5_CALLCONV


1239 
krb5_k_ª„ªn˚_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
);

1242 
KRB5_CALLCONV


1243 
krb5_k_‰ì_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
);

1246 
krb5_îr‹_code
 
KRB5_CALLCONV


1247 
krb5_k_key_keyblock
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
,

1248 
krb5_keyblock
 **
key_d©a
);

1251 
krb5_í˘y≥
 
KRB5_CALLCONV


1252 
krb5_k_key_í˘y≥
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
);

1277 
krb5_îr‹_code
 
KRB5_CALLCONV


1278 
krb5_k_í¸y±
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
, 
krb5_keyußge
 
ußge
,

1279 c⁄° 
krb5_d©a
 *
cùhî_°©e
, c⁄° krb5_d©®*
öput
,

1280 
krb5_íc_d©a
 *
ouçut
);

1312 
krb5_îr‹_code
 
KRB5_CALLCONV


1313 
krb5_k_í¸y±_iov
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
, 
krb5_keyußge
 
ußge
,

1314 c⁄° 
krb5_d©a
 *
cùhî_°©e
, 
krb5_¸y±o_iov
 *
d©a
,

1315 
size_t
 
num_d©a
);

1341 
krb5_îr‹_code
 
KRB5_CALLCONV


1342 
krb5_k_de¸y±
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
, 
krb5_keyußge
 
ußge
,

1343 c⁄° 
krb5_d©a
 *
cùhî_°©e
, c⁄° 
krb5_íc_d©a
 *
öput
,

1344 
krb5_d©a
 *
ouçut
);

1376 
krb5_îr‹_code
 
KRB5_CALLCONV


1377 
krb5_k_de¸y±_iov
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
, 
krb5_keyußge
 
ußge
,

1378 c⁄° 
krb5_d©a
 *
cùhî_°©e
, 
krb5_¸y±o_iov
 *
d©a
,

1379 
size_t
 
num_d©a
);

1405 
krb5_îr‹_code
 
KRB5_CALLCONV


1406 
krb5_k_make_checksum
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
cksumty≥
,

1407 
krb5_key
 
key
, 
krb5_keyußge
 
ußge
, c⁄° 
krb5_d©a
 *
öput
,

1408 
krb5_checksum
 *
cksum
);

1431 
krb5_îr‹_code
 
KRB5_CALLCONV


1432 
krb5_k_make_checksum_iov
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
cksumty≥
,

1433 
krb5_key
 
key
, 
krb5_keyußge
 
ußge
,

1434 
krb5_¸y±o_iov
 *
d©a
, 
size_t
 
num_d©a
);

1457 
krb5_îr‹_code
 
KRB5_CALLCONV


1458 
krb5_k_vîify_checksum
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
, 
krb5_keyußge
 
ußge
,

1459 c⁄° 
krb5_d©a
 *
d©a
, c⁄° 
krb5_checksum
 *
cksum
,

1460 
krb5_boﬁón
 *
vÆid
);

1484 
krb5_îr‹_code
 
KRB5_CALLCONV


1485 
krb5_k_vîify_checksum_iov
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
cksumty≥
,

1486 
krb5_key
 
key
, 
krb5_keyußge
 
ußge
,

1487 c⁄° 
krb5_¸y±o_iov
 *
d©a
, 
size_t
 
num_d©a
,

1488 
krb5_boﬁón
 *
vÆid
);

1508 
krb5_îr‹_code
 
KRB5_CALLCONV


1509 
krb5_k_¥f
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_key
 
key
, 
krb5_d©a
 *
öput
, krb5_d©®*
ouçut
);

1511 #ifde‡
KRB5_OLD_CRYPTO


1517 
krb5_îr‹_code
 
KRB5_CALLCONV


1518 
krb5_í¸y±
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_poöãr
 
ö±r
,

1519 
krb5_poöãr
 
ouçå
, 
size_t
 
size
, 
krb5_í¸y±_block
 *
eblock
,

1520 
krb5_poöãr
 
ivec
);

1523 
krb5_îr‹_code
 
KRB5_CALLCONV


1524 
krb5_de¸y±
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_poöãr
 
ö±r
,

1525 
krb5_poöãr
 
ouçå
, 
size_t
 
size
, 
krb5_í¸y±_block
 *
eblock
,

1526 
krb5_poöãr
 
ivec
);

1529 
krb5_îr‹_code
 
KRB5_CALLCONV


1530 
krb5_¥o˚ss_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í¸y±_block
 *
eblock
,

1531 c⁄° 
krb5_keyblock
 * 
key
);

1534 
krb5_îr‹_code
 
KRB5_CALLCONV


1535 
krb5_föish_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í¸y±_block
 * 
eblock
);

1538 
krb5_îr‹_code
 
KRB5_CALLCONV


1539 
krb5_°rög_to_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_í¸y±_block
 *
eblock
,

1540 
krb5_keyblock
 * 
keyblock
, c⁄° 
krb5_d©a
 *
d©a
,

1541 c⁄° 
krb5_d©a
 *
ß…
);

1544 
krb5_îr‹_code
 
KRB5_CALLCONV


1545 
krb5_öô_øndom_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_í¸y±_block
 *
eblock
,

1546 c⁄° 
krb5_keyblock
 *
keyblock
, 
krb5_poöãr
 *
±r
);

1549 
krb5_îr‹_code
 
KRB5_CALLCONV


1550 
krb5_föish_øndom_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_í¸y±_block
 *
eblock
,

1551 
krb5_poöãr
 *
±r
);

1554 
krb5_îr‹_code
 
KRB5_CALLCONV


1555 
krb5_øndom_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_í¸y±_block
 *
eblock
,

1556 
krb5_poöãr
 
±r
, 
krb5_keyblock
 **
keyblock
);

1559 
krb5_í˘y≥
 
KRB5_CALLCONV


1560 
krb5_eblock_í˘y≥
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_í¸y±_block
 *
eblock
);

1563 
krb5_îr‹_code
 
KRB5_CALLCONV


1564 
krb5_u£_í˘y≥
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í¸y±_block
 *
eblock
,

1565 
krb5_í˘y≥
 
í˘y≥
);

1568 
size_t
 
KRB5_CALLCONV


1569 
krb5_í¸y±_size
(
size_t
 
Àngth
, 
krb5_í˘y≥
 
¸y±o
);

1572 
size_t
 
KRB5_CALLCONV


1573 
krb5_checksum_size
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
˘y≥
);

1576 
krb5_îr‹_code
 
KRB5_CALLCONV


1577 
krb5_ˇlcuœã_checksum
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
˘y≥
,

1578 
krb5_c⁄°_poöãr
 
ö
, 
size_t
 
ö_Àngth
,

1579 
krb5_c⁄°_poöãr
 
£ed
, 
size_t
 
£ed_Àngth
,

1580 
krb5_checksum
 * 
outcksum
);

1583 
krb5_îr‹_code
 
KRB5_CALLCONV


1584 
krb5_vîify_checksum
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 
˘y≥
,

1585 c⁄° 
krb5_checksum
 * 
cksum
, 
krb5_c⁄°_poöãr
 
ö
,

1586 
size_t
 
ö_Àngth
, 
krb5_c⁄°_poöãr
 
£ed
,

1587 
size_t
 
£ed_Àngth
);

1603 
	#KDC_OPT_FORWARDABLE
 0x40000000

	)

1604 
	#KDC_OPT_FORWARDED
 0x20000000

	)

1605 
	#KDC_OPT_PROXIABLE
 0x10000000

	)

1606 
	#KDC_OPT_PROXY
 0x08000000

	)

1607 
	#KDC_OPT_ALLOW_POSTDATE
 0x04000000

	)

1608 
	#KDC_OPT_POSTDATED
 0x02000000

	)

1610 
	#KDC_OPT_RENEWABLE
 0x00800000

	)

1616 
	#KDC_OPT_CNAME_IN_ADDL_TKT
 0x00020000

	)

1617 
	#KDC_OPT_CANONICALIZE
 0x00010000

	)

1618 
	#KDC_OPT_REQUEST_ANONYMOUS
 0x00008000

	)

1628 
	#KDC_OPT_DISABLE_TRANSITED_CHECK
 0x00000020

	)

1629 
	#KDC_OPT_RENEWABLE_OK
 0x00000010

	)

1630 
	#KDC_OPT_ENC_TKT_IN_SKEY
 0x00000008

	)

1632 
	#KDC_OPT_RENEW
 0x00000002

	)

1633 
	#KDC_OPT_VALIDATE
 0x00000001

	)

1642 
	#KDC_TKT_COMMON_MASK
 0x54800000

	)

1652 
	#AP_OPTS_RESERVED
 0x80000000

	)

1653 
	#AP_OPTS_USE_SESSION_KEY
 0x40000000

	)

1654 
	#AP_OPTS_MUTUAL_REQUIRED
 0x20000000

	)

1656 
	#AP_OPTS_ETYPE_NEGOTIATION
 0x00000002

	)

1657 
	#AP_OPTS_USE_SUBKEY
 0x00000001

	)

1690 
	#AP_OPTS_WIRE_MASK
 0xfffffff0

	)

1694 
	#AD_TYPE_RESERVED
 0x8000

	)

1695 
	#AD_TYPE_EXTERNAL
 0x4000

	)

1696 
	#AD_TYPE_REGISTERED
 0x2000

	)

1698 
	#AD_TYPE_FIELD_TYPE_MASK
 0x1fff

	)

1704 
	#TKT_FLG_FORWARDABLE
 0x40000000

	)

1705 
	#TKT_FLG_FORWARDED
 0x20000000

	)

1706 
	#TKT_FLG_PROXIABLE
 0x10000000

	)

1707 
	#TKT_FLG_PROXY
 0x08000000

	)

1708 
	#TKT_FLG_MAY_POSTDATE
 0x04000000

	)

1709 
	#TKT_FLG_POSTDATED
 0x02000000

	)

1710 
	#TKT_FLG_INVALID
 0x01000000

	)

1711 
	#TKT_FLG_RENEWABLE
 0x00800000

	)

1712 
	#TKT_FLG_INITIAL
 0x00400000

	)

1713 
	#TKT_FLG_PRE_AUTH
 0x00200000

	)

1714 
	#TKT_FLG_HW_AUTH
 0x00100000

	)

1715 
	#TKT_FLG_TRANSIT_POLICY_CHECKED
 0x00080000

	)

1716 
	#TKT_FLG_OK_AS_DELEGATE
 0x00040000

	)

1717 
	#TKT_FLG_ENC_PA_REP
 0x00010000

	)

1718 
	#TKT_FLG_ANONYMOUS
 0x00008000

	)

1736 
	#LR_TYPE_THIS_SERVER_ONLY
 0x8000

	)

1738 
	#LR_TYPE_INTERPRETATION_MASK
 0x7fff

	)

1741 
	#MSEC_DIRBIT
 0x8000

	)

1742 
	#MSEC_VAL_MASK
 0x7fff

	)

1753 
	#KRB5_PVNO
 5

	)

1757 
	#KRB5_AS_REQ
 ((
krb5_msgty≥
)10Ë

	)

1758 
	#KRB5_AS_REP
 ((
krb5_msgty≥
)11Ë

	)

1759 
	#KRB5_TGS_REQ
 ((
krb5_msgty≥
)12Ë

	)

1760 
	#KRB5_TGS_REP
 ((
krb5_msgty≥
)13Ë

	)

1761 
	#KRB5_AP_REQ
 ((
krb5_msgty≥
)14Ë

	)

1762 
	#KRB5_AP_REP
 ((
krb5_msgty≥
)15Ë

	)

1763 
	#KRB5_SAFE
 ((
krb5_msgty≥
)20Ë

	)

1764 
	#KRB5_PRIV
 ((
krb5_msgty≥
)21Ë

	)

1765 
	#KRB5_CRED
 ((
krb5_msgty≥
)22Ë

	)

1766 
	#KRB5_ERROR
 ((
krb5_msgty≥
)30Ë

	)

1769 
	#KRB5_LRQ_NONE
 0

	)

1770 
	#KRB5_LRQ_ALL_LAST_TGT
 1

	)

1771 
	#KRB5_LRQ_ONE_LAST_TGT
 (-1)

	)

1772 
	#KRB5_LRQ_ALL_LAST_INITIAL
 2

	)

1773 
	#KRB5_LRQ_ONE_LAST_INITIAL
 (-2)

	)

1774 
	#KRB5_LRQ_ALL_LAST_TGT_ISSUED
 3

	)

1775 
	#KRB5_LRQ_ONE_LAST_TGT_ISSUED
 (-3)

	)

1776 
	#KRB5_LRQ_ALL_LAST_RENEWAL
 4

	)

1777 
	#KRB5_LRQ_ONE_LAST_RENEWAL
 (-4)

	)

1778 
	#KRB5_LRQ_ALL_LAST_REQ
 5

	)

1779 
	#KRB5_LRQ_ONE_LAST_REQ
 (-5)

	)

1780 
	#KRB5_LRQ_ALL_PW_EXPTIME
 6

	)

1781 
	#KRB5_LRQ_ONE_PW_EXPTIME
 (-6)

	)

1782 
	#KRB5_LRQ_ALL_ACCT_EXPTIME
 7

	)

1783 
	#KRB5_LRQ_ONE_ACCT_EXPTIME
 (-7)

	)

1786 
	#KRB5_PADATA_NONE
 0

	)

1787 
	#KRB5_PADATA_AP_REQ
 1

	)

1788 
	#KRB5_PADATA_TGS_REQ
 
KRB5_PADATA_AP_REQ


	)

1789 
	#KRB5_PADATA_ENC_TIMESTAMP
 2

	)

1790 
	#KRB5_PADATA_PW_SALT
 3

	)

1792 
	#KRB5_PADATA_ENC_ENCKEY
 4

	)

1794 
	#KRB5_PADATA_ENC_UNIX_TIME
 5

	)

1795 
	#KRB5_PADATA_ENC_SANDIA_SECURID
 6

	)

1796 
	#KRB5_PADATA_SESAME
 7

	)

1797 
	#KRB5_PADATA_OSF_DCE
 8

	)

1798 
	#KRB5_CYBERSAFE_SECUREID
 9

	)

1799 
	#KRB5_PADATA_AFS3_SALT
 10

	)

1800 
	#KRB5_PADATA_ETYPE_INFO
 11

	)

1801 
	#KRB5_PADATA_SAM_CHALLENGE
 12

	)

1802 
	#KRB5_PADATA_SAM_RESPONSE
 13

	)

1803 
	#KRB5_PADATA_PK_AS_REQ_OLD
 14

	)

1804 
	#KRB5_PADATA_PK_AS_REP_OLD
 15

	)

1805 
	#KRB5_PADATA_PK_AS_REQ
 16

	)

1806 
	#KRB5_PADATA_PK_AS_REP
 17

	)

1807 
	#KRB5_PADATA_ETYPE_INFO2
 19

	)

1808 
	#KRB5_PADATA_USE_SPECIFIED_KVNO
 20

	)

1809 
	#KRB5_PADATA_SVR_REFERRAL_INFO
 20

	)

1810 
	#KRB5_PADATA_SAM_REDIRECT
 21

	)

1811 
	#KRB5_PADATA_GET_FROM_TYPED_DATA
 22

	)

1812 
	#KRB5_PADATA_REFERRAL
 25

	)

1813 
	#KRB5_PADATA_SAM_CHALLENGE_2
 30

	)

1814 
	#KRB5_PADATA_SAM_RESPONSE_2
 31

	)

1816 
	#KRB5_PADATA_PAC_REQUEST
 128

	)

1817 
	#KRB5_PADATA_FOR_USER
 129

	)

1818 
	#KRB5_PADATA_S4U_X509_USER
 130

	)

1819 
	#KRB5_PADATA_AS_CHECKSUM
 132

	)

1820 
	#KRB5_PADATA_FX_COOKIE
 133

	)

1821 
	#KRB5_PADATA_FX_FAST
 136

	)

1822 
	#KRB5_PADATA_FX_ERROR
 137

	)

1823 
	#KRB5_PADATA_ENCRYPTED_CHALLENGE
 138

	)

1824 
	#KRB5_PADATA_OTP_CHALLENGE
 141

	)

1825 
	#KRB5_PADATA_OTP_REQUEST
 142

	)

1826 
	#KRB5_PADATA_OTP_PIN_CHANGE
 144

	)

1827 
	#KRB5_PADATA_PKINIT_KX
 147

	)

1828 
	#KRB5_ENCPADATA_REQ_ENC_PA_REP
 149

	)

1830 
	#KRB5_SAM_USE_SAD_AS_KEY
 0x80000000

	)

1831 
	#KRB5_SAM_SEND_ENCRYPTED_SAD
 0x40000000

	)

1832 
	#KRB5_SAM_MUST_PK_ENCRYPT_SAD
 0x20000000

	)

1835 
	#KRB5_DOMAIN_X500_COMPRESS
 1

	)

1838 
	#KRB5_ALTAUTH_ATT_CHALLENGE_RESPONSE
 64

	)

1845 
	#KRB5_AUTHDATA_IF_RELEVANT
 1

	)

1846 
	#KRB5_AUTHDATA_KDC_ISSUED
 4

	)

1847 
	#KRB5_AUTHDATA_AND_OR
 5

	)

1848 
	#KRB5_AUTHDATA_MANDATORY_FOR_KDC
 8

	)

1849 
	#KRB5_AUTHDATA_INITIAL_VERIFIED_CAS
 9

	)

1850 
	#KRB5_AUTHDATA_OSF_DCE
 64

	)

1851 
	#KRB5_AUTHDATA_SESAME
 65

	)

1852 
	#KRB5_AUTHDATA_WIN2K_PAC
 128

	)

1853 
	#KRB5_AUTHDATA_ETYPE_NEGOTIATION
 129

	)

1854 
	#KRB5_AUTHDATA_SIGNTICKET
 512

	)

1855 
	#KRB5_AUTHDATA_FX_ARMOR
 71

	)

1859 
	#KRB5_KPASSWD_SUCCESS
 0

	)

1860 
	#KRB5_KPASSWD_MALFORMED
 1

	)

1861 
	#KRB5_KPASSWD_HARDERROR
 2

	)

1862 
	#KRB5_KPASSWD_AUTHERROR
 3

	)

1863 
	#KRB5_KPASSWD_SOFTERROR
 4

	)

1866 
	#KRB5_KPASSWD_ACCESSDENIED
 5

	)

1867 
	#KRB5_KPASSWD_BAD_VERSION
 6

	)

1869 
	#KRB5_KPASSWD_INITIAL_FLAG_NEEDED
 7

	)

1877 
	s_krb5_tickë_times
 {

1878 
krb5_time°amp
 
	mauthtime
;

1881 
krb5_time°amp
 
	m°¨âime
;

1882 
krb5_time°amp
 
	mídtime
;

1883 
krb5_time°amp
 
	mª√w_tûl
;

1884 } 
	tkrb5_tickë_times
;

1887 
	s_krb5_authd©a
 {

1888 
krb5_magic
 
	mmagic
;

1889 
krb5_authd©©y≥
 
	mad_ty≥
;

1890 
	mÀngth
;

1891 
krb5_o˘ë
 *
	mc⁄ã¡s
;

1892 } 
	tkrb5_authd©a
;

1895 
	s_krb5_å™sôed
 {

1896 
krb5_magic
 
	mmagic
;

1897 
krb5_o˘ë
 
	må_ty≥
;

1898 
krb5_d©a
 
	må_c⁄ã¡s
;

1899 } 
	tkrb5_å™sôed
;

1902 
	s_krb5_íc_tkt_∑π
 {

1903 
krb5_magic
 
	mmagic
;

1905 
krb5_Êags
 
	mÊags
;

1906 
krb5_keyblock
 *
	m£ssi⁄
;

1907 
krb5_¥öcùÆ
 
	m˛õ¡
;

1908 
krb5_å™sôed
 
	må™sôed
;

1909 
krb5_tickë_times
 
	mtimes
;

1910 
krb5_addªss
 **
	mˇddrs
;

1911 
krb5_authd©a
 **
	mauth‹iz©i⁄_d©a
;

1912 } 
	tkrb5_íc_tkt_∑π
;

1920 
	s_krb5_tickë
 {

1921 
krb5_magic
 
	mmagic
;

1923 
krb5_¥öcùÆ
 
	m£rvî
;

1924 
krb5_íc_d©a
 
	míc_∑π
;

1925 
krb5_íc_tkt_∑π
 *
	míc_∑π2
;

1926 } 
	tkrb5_tickë
;

1934 
	s_krb5_authítiˇt‹
 {

1935 
krb5_magic
 
	mmagic
;

1936 
krb5_¥öcùÆ
 
	m˛õ¡
;

1937 
krb5_checksum
 *
	mchecksum
;

1938 
krb5_öt32
 
	mcu£c
;

1939 
krb5_time°amp
 
	m˘ime
;

1940 
krb5_keyblock
 *
	msubkey
;

1941 
krb5_ui_4
 
	m£q_numbî
;

1942 
krb5_authd©a
 **
	mauth‹iz©i⁄_d©a
;

1943 } 
	tkrb5_authítiˇt‹
;

1946 
	s_krb5_tkt_authít
 {

1947 
krb5_magic
 
	mmagic
;

1948 
krb5_tickë
 *
	mtickë
;

1949 
krb5_authítiˇt‹
 *
	mauthítiˇt‹
;

1950 
krb5_Êags
 
	m≠_›ti⁄s
;

1951 } 
	tkrb5_tkt_authít
;

1954 
	s_krb5_¸eds
 {

1955 
krb5_magic
 
	mmagic
;

1956 
krb5_¥öcùÆ
 
	m˛õ¡
;

1957 
krb5_¥öcùÆ
 
	m£rvî
;

1958 
krb5_keyblock
 
	mkeyblock
;

1959 
krb5_tickë_times
 
	mtimes
;

1960 
krb5_boﬁón
 
	mis_skey
;

1962 
krb5_Êags
 
	mtickë_Êags
;

1963 
krb5_addªss
 **
	maddªs£s
;

1964 
krb5_d©a
 
	mtickë
;

1965 
krb5_d©a
 
	m£c⁄d_tickë
;

1968 
krb5_authd©a
 **
	mauthd©a
;

1969 } 
	tkrb5_¸eds
;

1972 
	s_krb5_œ°_ªq_íåy
 {

1973 
krb5_magic
 
	mmagic
;

1974 
krb5_öt32
 
	mÃ_ty≥
;

1975 
krb5_time°amp
 
	mvÆue
;

1976 } 
	tkrb5_œ°_ªq_íåy
;

1979 
	s_krb5_∑_d©a
 {

1980 
krb5_magic
 
	mmagic
;

1981 
krb5_¥óuthty≥
 
	m∑_ty≥
;

1982 
	mÀngth
;

1983 
krb5_o˘ë
 *
	mc⁄ã¡s
;

1984 } 
	tkrb5_∑_d©a
;

1987 
	s_krb5_ty≥d_d©a
 {

1988 
krb5_magic
 
	mmagic
;

1989 
krb5_öt32
 
	mty≥
;

1990 
	mÀngth
;

1991 
krb5_o˘ë
 *
	md©a
;

1992 } 
	tkrb5_ty≥d_d©a
;

1995 
	s_krb5_kdc_ªq
 {

1996 
krb5_magic
 
	mmagic
;

1997 
krb5_msgty≥
 
	mmsg_ty≥
;

1998 
krb5_∑_d©a
 **
	m∑d©a
;

2000 
krb5_Êags
 
	mkdc_›ti⁄s
;

2001 
krb5_¥öcùÆ
 
	m˛õ¡
;

2002 
krb5_¥öcùÆ
 
	m£rvî
;

2003 
krb5_time°amp
 
	m‰om
;

2004 
krb5_time°amp
 
	mtûl
;

2005 
krb5_time°amp
 
	mπime
;

2006 
krb5_öt32
 
	mn⁄˚
;

2007 
	mnkty≥s
;

2008 
krb5_í˘y≥
 *
	mkty≥
;

2009 
krb5_addªss
 **
	maddªs£s
;

2010 
krb5_íc_d©a
 
	mauth‹iz©i⁄_d©a
;

2011 
krb5_authd©a
 **
	mu√nc_authd©a
;

2012 
krb5_tickë
 **
	m£c⁄d_tickë
;

2013 } 
	tkrb5_kdc_ªq
;

2020 
	s_krb5_íc_kdc_ªp_∑π
 {

2021 
krb5_magic
 
	mmagic
;

2023 
krb5_msgty≥
 
	mmsg_ty≥
;

2024 
krb5_keyblock
 *
	m£ssi⁄
;

2025 
krb5_œ°_ªq_íåy
 **
	mœ°_ªq
;

2026 
krb5_öt32
 
	mn⁄˚
;

2027 
krb5_time°amp
 
	mkey_exp
;

2028 
krb5_Êags
 
	mÊags
;

2029 
krb5_tickë_times
 
	mtimes
;

2030 
krb5_¥öcùÆ
 
	m£rvî
;

2031 
krb5_addªss
 **
	mˇddrs
;

2032 
krb5_∑_d©a
 **
	míc_∑d©a
;

2033 } 
	tkrb5_íc_kdc_ªp_∑π
;

2036 
	s_krb5_kdc_ªp
 {

2037 
krb5_magic
 
	mmagic
;

2039 
krb5_msgty≥
 
	mmsg_ty≥
;

2040 
krb5_∑_d©a
 **
	m∑d©a
;

2041 
krb5_¥öcùÆ
 
	m˛õ¡
;

2042 
krb5_tickë
 *
	mtickë
;

2043 
krb5_íc_d©a
 
	míc_∑π
;

2044 
krb5_íc_kdc_ªp_∑π
 *
	míc_∑π2
;

2045 } 
	tkrb5_kdc_ªp
;

2048 
	s_krb5_îr‹
 {

2049 
krb5_magic
 
	mmagic
;

2051 
krb5_time°amp
 
	m˘ime
;

2052 
krb5_öt32
 
	mcu£c
;

2053 
krb5_öt32
 
	msu£c
;

2054 
krb5_time°amp
 
	m°ime
;

2055 
krb5_ui_4
 
	mîr‹
;

2056 
krb5_¥öcùÆ
 
	m˛õ¡
;

2057 
krb5_¥öcùÆ
 
	m£rvî
;

2058 
krb5_d©a
 
	mãxt
;

2059 
krb5_d©a
 
	me_d©a
;

2060 } 
	tkrb5_îr‹
;

2063 
	s_krb5_≠_ªq
 {

2064 
krb5_magic
 
	mmagic
;

2065 
krb5_Êags
 
	m≠_›ti⁄s
;

2066 
krb5_tickë
 *
	mtickë
;

2067 
krb5_íc_d©a
 
	mauthítiˇt‹
;

2068 } 
	tkrb5_≠_ªq
;

2075 
	s_krb5_≠_ªp
 {

2076 
krb5_magic
 
	mmagic
;

2077 
krb5_íc_d©a
 
	míc_∑π
;

2078 } 
	tkrb5_≠_ªp
;

2081 
	s_krb5_≠_ªp_íc_∑π
 {

2082 
krb5_magic
 
	mmagic
;

2083 
krb5_time°amp
 
	m˘ime
;

2084 
krb5_öt32
 
	mcu£c
;

2085 
krb5_keyblock
 *
	msubkey
;

2086 
krb5_ui_4
 
	m£q_numbî
;

2087 } 
	tkrb5_≠_ªp_íc_∑π
;

2090 
	s_krb5_ª•⁄£
 {

2091 
krb5_magic
 
	mmagic
;

2092 
krb5_o˘ë
 
	mmesßge_ty≥
;

2093 
krb5_d©a
 
	mª•⁄£
;

2094 
krb5_öt32
 
	mex≥˘ed_n⁄˚
;

2095 
krb5_time°amp
 
	mªque°_time
;

2096 } 
	tkrb5_ª•⁄£
;

2099 
	s_krb5_¸ed_öfo
 {

2100 
krb5_magic
 
	mmagic
;

2101 
krb5_keyblock
 *
	m£ssi⁄
;

2102 
krb5_¥öcùÆ
 
	m˛õ¡
;

2103 
krb5_¥öcùÆ
 
	m£rvî
;

2104 
krb5_Êags
 
	mÊags
;

2105 
krb5_tickë_times
 
	mtimes
;

2106 
krb5_addªss
 **
	mˇddrs
;

2107 } 
	tkrb5_¸ed_öfo
;

2110 
	s_krb5_¸ed_íc_∑π
 {

2111 
krb5_magic
 
	mmagic
;

2112 
krb5_öt32
 
	mn⁄˚
;

2113 
krb5_time°amp
 
	mtime°amp
;

2114 
krb5_öt32
 
	mu£c
;

2115 
krb5_addªss
 *
	ms_addªss
;

2116 
krb5_addªss
 *
	mr_addªss
;

2117 
krb5_¸ed_öfo
 **
	mtickë_öfo
;

2118 } 
	tkrb5_¸ed_íc_∑π
;

2121 
	s_krb5_¸ed
 {

2122 
krb5_magic
 
	mmagic
;

2123 
krb5_tickë
 **
	mtickës
;

2124 
krb5_íc_d©a
 
	míc_∑π
;

2125 
krb5_¸ed_íc_∑π
 *
	míc_∑π2
;

2126 } 
	tkrb5_¸ed
;

2129 
	s_∑sswd_phø£_ñemít
 {

2130 
krb5_magic
 
	mmagic
;

2131 
krb5_d©a
 *
	m∑sswd
;

2132 
krb5_d©a
 *
	mphø£
;

2133 } 
	t∑sswd_phø£_ñemít
;

2136 
	s_krb5_pwd_d©a
 {

2137 
krb5_magic
 
	mmagic
;

2138 
	m£quí˚_cou¡
;

2139 
∑sswd_phø£_ñemít
 **
	mñemít
;

2140 } 
	tkrb5_pwd_d©a
;

2143 
	s_krb5_∑_svr_ª„ºÆ_d©a
 {

2145 
krb5_¥öcùÆ
 
	m¥öcùÆ
;

2146 } 
	tkrb5_∑_svr_ª„ºÆ_d©a
;

2149 
	s_krb5_∑_£rvî_ª„ºÆ_d©a
 {

2150 
krb5_d©a
 *
	mª„ºed_ªÆm
;

2151 
krb5_¥öcùÆ
 
	måue_¥öcùÆ_«me
;

2152 
krb5_¥öcùÆ
 
	mªque°ed_¥öcùÆ_«me
;

2153 
krb5_time°amp
 
	mª„ºÆ_vÆid_u¡û
;

2154 
krb5_checksum
 
	mªp_cksum
;

2155 } 
	tkrb5_∑_£rvî_ª„ºÆ_d©a
;

2157 
	s_krb5_∑_∑c_ªq
 {

2159 
krb5_boﬁón
 
	mö˛ude_∑c
;

2160 } 
	tkrb5_∑_∑c_ªq
;

2170 
	#KRB5_AUTH_CONTEXT_DO_TIME
 0x00000001

	)

2172 
	#KRB5_AUTH_CONTEXT_RET_TIME
 0x00000002

	)

2174 
	#KRB5_AUTH_CONTEXT_DO_SEQUENCE
 0x00000004

	)

2176 
	#KRB5_AUTH_CONTEXT_RET_SEQUENCE
 0x00000008

	)

2177 
	#KRB5_AUTH_CONTEXT_PERMIT_ALL
 0x00000010

	)

2178 
	#KRB5_AUTH_CONTEXT_USE_SUBKEY
 0x00000020

	)

2187 
	skrb5_ª∂ay_d©a
 {

2188 
krb5_time°amp
 
	mtime°amp
;

2189 
krb5_öt32
 
	mu£c
;

2190 
krb5_ui_4
 
	m£q
;

2191 } 
	tkrb5_ª∂ay_d©a
;

2196 
	#KRB5_AUTH_CONTEXT_GENERATE_LOCAL_ADDR
 0x00000001

	)

2198 
	#KRB5_AUTH_CONTEXT_GENERATE_REMOTE_ADDR
 0x00000002

	)

2200 
	#KRB5_AUTH_CONTEXT_GENERATE_LOCAL_FULL_ADDR
 0x00000004

	)

2202 
	#KRB5_AUTH_CONTEXT_GENERATE_REMOTE_FULL_ADDR
 0x00000008

	)

2205 
	gkrb5_îr‹_code


2206 (
	tKRB5_CALLCONV
 * 
	tkrb5_mk_ªq_checksum_func
)(
	tkrb5_c⁄ãxt
, 
	tkrb5_auth_c⁄ãxt
,

2207 *, 
	tkrb5_d©a
 **);

2219 
krb5_poöãr
 
	tkrb5_cc_curs‹
;

2221 
	g_krb5_cˇche
;

2222 
_krb5_cˇche
 *
	tkrb5_cˇche
;

2223 
	g_krb5_cc_›s
;

2224 
_krb5_cc_›s
 
	tkrb5_cc_›s
;

2226 
	g_krb5_cccﬁ_curs‹
;

2228 
_krb5_cccﬁ_curs‹
 *
	tkrb5_cccﬁ_curs‹
;

2232 
	#KRB5_TC_MATCH_TIMES
 0x00000001

	)

2234 
	#KRB5_TC_MATCH_IS_SKEY
 0x00000002

	)

2236 
	#KRB5_TC_MATCH_FLAGS
 0x00000004

	)

2238 
	#KRB5_TC_MATCH_TIMES_EXACT
 0x00000008

	)

2240 
	#KRB5_TC_MATCH_FLAGS_EXACT
 0x00000010

	)

2242 
	#KRB5_TC_MATCH_AUTHDATA
 0x00000020

	)

2244 
	#KRB5_TC_MATCH_SRV_NAMEONLY
 0x00000040

	)

2246 
	#KRB5_TC_MATCH_2ND_TKT
 0x00000080

	)

2248 
	#KRB5_TC_MATCH_KTYPE
 0x00000100

	)

2250 
	#KRB5_TC_SUPPORTED_KTYPES
 0x00000200

	)

2254 
	#KRB5_TC_OPENCLOSE
 0x00000001

	)

2255 
	#KRB5_TC_NOTICKET
 0x00000002

	)

2271 c⁄° * 
KRB5_CALLCONV


2272 
krb5_cc_gë_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
);

2285 
krb5_îr‹_code
 
KRB5_CALLCONV


2286 
krb5_cc_gë_fuŒ_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
,

2287 **
fuŒ«me_out
);

2289 #i‡
KRB5_DEPRECATED


2290 
krb5_îr‹_code
 
KRB5_CALLCONV


2291 
krb5_cc_gí_√w
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 *
ˇche
);

2309 
krb5_îr‹_code
 
KRB5_CALLCONV


2310 
krb5_cc_öôülize
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
,

2311 
krb5_¥öcùÆ
 
¥öcùÆ
);

2327 
krb5_îr‹_code
 
KRB5_CALLCONV


2328 
krb5_cc_de°roy
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
);

2344 
krb5_îr‹_code
 
KRB5_CALLCONV


2345 
krb5_cc_˛o£
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
);

2362 
krb5_îr‹_code
 
KRB5_CALLCONV


2363 
krb5_cc_°‹e_¸ed
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
, 
krb5_¸eds
 *
¸eds
);

2398 
krb5_îr‹_code
 
KRB5_CALLCONV


2399 
krb5_cc_ªåõve_¸ed
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
,

2400 
krb5_Êags
 
Êags
, 
krb5_¸eds
 *
m¸eds
,

2401 
krb5_¸eds
 *
¸eds
);

2420 
krb5_îr‹_code
 
KRB5_CALLCONV


2421 
krb5_cc_gë_¥öcùÆ
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
,

2422 
krb5_¥öcùÆ
 *
¥öcùÆ
);

2438 
krb5_îr‹_code
 
KRB5_CALLCONV


2439 
krb5_cc_°¨t_£q_gë
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
,

2440 
krb5_cc_curs‹
 *
curs‹
);

2459 
krb5_îr‹_code
 
KRB5_CALLCONV


2460 
krb5_cc_√xt_¸ed
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
,

2461 
krb5_cc_curs‹
 *
curs‹
, 
krb5_¸eds
 *
¸eds
);

2477 
krb5_îr‹_code
 
KRB5_CALLCONV


2478 
krb5_cc_íd_£q_gë
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
,

2479 
krb5_cc_curs‹
 *
curs‹
);

2496 
krb5_îr‹_code
 
KRB5_CALLCONV


2497 
krb5_cc_ªmove_¸ed
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
, 
krb5_Êags
 
Êags
,

2498 
krb5_¸eds
 *
¸eds
);

2511 
krb5_îr‹_code
 
KRB5_CALLCONV


2512 
krb5_cc_£t_Êags
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
, 
krb5_Êags
 
Êags
);

2525 
krb5_îr‹_code
 
KRB5_CALLCONV


2526 
krb5_cc_gë_Êags
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
, 
krb5_Êags
 *
Êags
);

2537 c⁄° * 
KRB5_CALLCONV


2538 
krb5_cc_gë_ty≥
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
);

2555 
krb5_îr‹_code
 
KRB5_CALLCONV


2556 
krb5_cc_move
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
§c
, krb5_cˇchê
d°
);

2567 
krb5_îr‹_code
 
KRB5_CALLCONV


2568 
krb5_cc_œ°_ch™ge_time
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
cˇche
,

2569 
krb5_time°amp
 *
ch™ge_time
);

2581 
krb5_îr‹_code
 
KRB5_CALLCONV


2582 
krb5_cc_lock
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
cˇche
);

2594 
krb5_îr‹_code
 
KRB5_CALLCONV


2595 
krb5_cc_u∆ock
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
cˇche
);

2613 
krb5_îr‹_code
 
KRB5_CALLCONV


2614 
krb5_cccﬁ_curs‹_√w
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cccﬁ_curs‹
 *
curs‹
);

2632 
krb5_îr‹_code
 
KRB5_CALLCONV


2633 
krb5_cccﬁ_curs‹_√xt
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cccﬁ_curs‹
 
curs‹
,

2634 
krb5_cˇche
 *
cˇche
);

2646 
krb5_îr‹_code
 
KRB5_CALLCONV


2647 
krb5_cccﬁ_curs‹_‰ì
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cccﬁ_curs‹
 *
curs‹
);

2659 
krb5_îr‹_code
 
KRB5_CALLCONV


2660 
krb5_cccﬁ_have_c⁄ã¡
(
krb5_c⁄ãxt
 
c⁄ãxt
);

2676 
krb5_îr‹_code
 
KRB5_CALLCONV


2677 
krb5_cccﬁ_œ°_ch™ge_time
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_time°amp
 *
ch™ge_time
);

2693 
krb5_îr‹_code
 
KRB5_CALLCONV


2694 
krb5_cccﬁ_lock
(
krb5_c⁄ãxt
 
c⁄ãxt
);

2705 
krb5_îr‹_code
 
KRB5_CALLCONV


2706 
krb5_cccﬁ_u∆ock
(
krb5_c⁄ãxt
 
c⁄ãxt
);

2721 
krb5_îr‹_code
 
KRB5_CALLCONV


2722 
krb5_cc_√w_unique
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
ty≥
, c⁄° *
höt
,

2723 
krb5_cˇche
 *
id
);

2733 
	gkrb5_rc_°
;

2734 
krb5_rc_°
 *
	tkrb5_rˇche
;

2746 
	#MAX_KEYTAB_NAME_LEN
 1100

	)

2748 
krb5_poöãr
 
	tkrb5_kt_curs‹
;

2751 
	skrb5_keyèb_íåy_°
 {

2752 
krb5_magic
 
	mmagic
;

2753 
krb5_¥öcùÆ
 
	m¥öcùÆ
;

2754 
krb5_time°amp
 
	mtime°amp
;

2755 
krb5_kvno
 
	mvno
;

2756 
krb5_keyblock
 
	mkey
;

2757 } 
	tkrb5_keyèb_íåy
;

2759 
	g_krb5_kt
;

2760 
_krb5_kt
 *
	tkrb5_keyèb
;

2771 c⁄° * 
KRB5_CALLCONV


2772 
krb5_kt_gë_ty≥
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
keyèb
);

2794 
krb5_îr‹_code
 
KRB5_CALLCONV


2795 
krb5_kt_gë_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
keyèb
, *
«me
,

2796 
«mñí
);

2806 
krb5_îr‹_code
 
KRB5_CALLCONV


2807 
krb5_kt_˛o£
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
keyèb
);

2835 
krb5_îr‹_code
 
KRB5_CALLCONV


2836 
krb5_kt_gë_íåy
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
keyèb
,

2837 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
, 
krb5_kvno
 
vno
,

2838 
krb5_í˘y≥
 
í˘y≥
, 
krb5_keyèb_íåy
 *
íåy
);

2857 
krb5_îr‹_code
 
KRB5_CALLCONV


2858 
krb5_kt_°¨t_£q_gë
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
keyèb
,

2859 
krb5_kt_curs‹
 *
curs‹
);

2880 
krb5_îr‹_code
 
KRB5_CALLCONV


2881 
krb5_kt_√xt_íåy
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
keyèb
,

2882 
krb5_keyèb_íåy
 *
íåy
, 
krb5_kt_curs‹
 *
curs‹
);

2899 
krb5_îr‹_code
 
KRB5_CALLCONV


2900 
krb5_kt_íd_£q_gë
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
keyèb
,

2901 
krb5_kt_curs‹
 *
curs‹
);

2914 
krb5_îr‹_code
 
KRB5_CALLCONV


2915 
krb5_kt_have_c⁄ã¡
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
keyèb
);

2925 
	#KRB5_INIT_CONTEXT_SECURE
 0x1

	)

2926 
	#KRB5_INIT_CONTEXT_KDC
 0x2

	)

2945 
krb5_îr‹_code
 
KRB5_CALLCONV


2946 
krb5_öô_c⁄ãxt
(
krb5_c⁄ãxt
 *
c⁄ãxt
);

2964 
krb5_îr‹_code
 
KRB5_CALLCONV


2965 
krb5_öô_£cuª_c⁄ãxt
(
krb5_c⁄ãxt
 *
c⁄ãxt
);

2983 
krb5_îr‹_code
 
KRB5_CALLCONV


2984 
krb5_öô_c⁄ãxt_¥ofûe
(
_¥ofûe_t
 *
¥ofûe
, 
krb5_Êags
 
Êags
,

2985 
krb5_c⁄ãxt
 *
c⁄ãxt
);

2995 
KRB5_CALLCONV


2996 
krb5_‰ì_c⁄ãxt
(
krb5_c⁄ãxt
 
c⁄ãxt
);

3012 
krb5_îr‹_code
 
KRB5_CALLCONV


3013 
krb5_c›y_c⁄ãxt
(
krb5_c⁄ãxt
 
˘x
, krb5_c⁄ãxà*
n˘x_out
);

3033 
krb5_îr‹_code
 
KRB5_CALLCONV


3034 
krb5_£t_deÁu…_tgs_í˘y≥s
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_í˘y≥
 *
ëy≥s
);

3050 
krb5_îr‹_code
 
KRB5_CALLCONV


3051 
krb5_gë_≥rmôãd_í˘y≥s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 **
kty≥s
);

3059 
krb5_boﬁón
 
KRB5_CALLCONV


3060 
krb5_is_thªad_ß„
();

3076 
krb5_îr‹_code
 
KRB5_CALLCONV


3077 
krb5_£rvî_de¸y±_tickë_keyèb
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyèb
 
kt
,

3078 
krb5_tickë
 *
tickë
);

3088 
KRB5_CALLCONV


3089 
krb5_‰ì_tgt_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 **
tgts
);

3094 
	#KRB5_GC_USER_USER
 1

	)

3095 
	#KRB5_GC_CACHED
 2

	)

3096 
	#KRB5_GC_CANONICALIZE
 4

	)

3097 
	#KRB5_GC_NO_STORE
 8

	)

3098 
	#KRB5_GC_FORWARDABLE
 16

	)

3099 
	#KRB5_GC_NO_TRANSIT_CHECK
 32

	)

3100 
	#KRB5_GC_CONSTRAINED_DELEGATION
 64

	)

3142 
krb5_îr‹_code
 
KRB5_CALLCONV


3143 
krb5_gë_¸edítüls
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_Êags
 
›ti⁄s
,

3144 
krb5_cˇche
 
cˇche
, 
krb5_¸eds
 *
ö_¸eds
,

3145 
krb5_¸eds
 **
out_¸eds
);

3148 
krb5_îr‹_code
 
KRB5_CALLCONV


3149 
krb5_gë_¸edítüls_vÆid©e
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_Êags
 
›ti⁄s
,

3150 
krb5_cˇche
 
cˇche
, 
krb5_¸eds
 *
ö_¸eds
,

3151 
krb5_¸eds
 **
out_¸eds
);

3154 
krb5_îr‹_code
 
KRB5_CALLCONV


3155 
krb5_gë_¸edítüls_ª√w
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_Êags
 
›ti⁄s
,

3156 
krb5_cˇche
 
cˇche
, 
krb5_¸eds
 *
ö_¸eds
,

3157 
krb5_¸eds
 **
out_¸eds
);

3181 
krb5_îr‹_code
 
KRB5_CALLCONV


3182 
krb5_mk_ªq
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 *
auth_c⁄ãxt
,

3183 
krb5_Êags
 
≠_ªq_›ti⁄s
, *
£rvi˚
, *
ho°«me
,

3184 
krb5_d©a
 *
ö_d©a
, 
krb5_cˇche
 
cˇche
, krb5_d©®*
outbuf
);

3223 
krb5_îr‹_code
 
KRB5_CALLCONV


3224 
krb5_mk_ªq_exãnded
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 *
auth_c⁄ãxt
,

3225 
krb5_Êags
 
≠_ªq_›ti⁄s
, 
krb5_d©a
 *
ö_d©a
,

3226 
krb5_¸eds
 *
ö_¸eds
, 
krb5_d©a
 *
outbuf
);

3248 
krb5_îr‹_code
 
KRB5_CALLCONV


3249 
krb5_mk_ªp
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
, 
krb5_d©a
 *
outbuf
);

3262 
krb5_îr‹_code
 
KRB5_CALLCONV


3263 
krb5_mk_ªp_d˚
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
, 
krb5_d©a
 *
outbuf
);

3281 
krb5_îr‹_code
 
KRB5_CALLCONV


3282 
krb5_rd_ªp
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

3283 c⁄° 
krb5_d©a
 *
öbuf
, 
krb5_≠_ªp_íc_∑π
 **
ª∂
);

3298 
krb5_îr‹_code
 
KRB5_CALLCONV


3299 
krb5_rd_ªp_d˚
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

3300 c⁄° 
krb5_d©a
 *
öbuf
, 
krb5_ui_4
 *
n⁄˚
);

3314 
krb5_îr‹_code
 
KRB5_CALLCONV


3315 
krb5_mk_îr‹
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_îr‹
 *
dec_îr
,

3316 
krb5_d©a
 *
íc_îr
);

3331 
krb5_îr‹_code
 
KRB5_CALLCONV


3332 
krb5_rd_îr‹
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_d©a
 *
íc_îrbuf
,

3333 
krb5_îr‹
 **
dec_îr‹
);

3371 
krb5_îr‹_code
 
KRB5_CALLCONV


3372 
krb5_rd_ß„
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

3373 c⁄° 
krb5_d©a
 *
öbuf
, krb5_d©®*
outbuf
,

3374 
krb5_ª∂ay_d©a
 *
outd©a
);

3411 
krb5_îr‹_code
 
KRB5_CALLCONV


3412 
krb5_rd_¥iv
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

3413 c⁄° 
krb5_d©a
 *
öbuf
, krb5_d©®*
outbuf
,

3414 
krb5_ª∂ay_d©a
 *
outd©a
);

3448 
krb5_îr‹_code
 
KRB5_CALLCONV


3449 
krb5_∑r£_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
«me
,

3450 
krb5_¥öcùÆ
 *
¥öcùÆ_out
);

3452 
	#KRB5_PRINCIPAL_PARSE_NO_REALM
 0x1

	)

3453 
	#KRB5_PRINCIPAL_PARSE_REQUIRE_REALM
 0x2

	)

3454 
	#KRB5_PRINCIPAL_PARSE_ENTERPRISE
 0x4

	)

3456 
	#KRB5_PRINCIPAL_PARSE_IGNORE_REALM
 0x8

	)

3489 
krb5_îr‹_code
 
KRB5_CALLCONV


3490 
krb5_∑r£_«me_Êags
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
«me
,

3491 
Êags
, 
krb5_¥öcùÆ
 *
¥öcùÆ_out
);

3510 
krb5_îr‹_code
 
KRB5_CALLCONV


3511 
krb5_u≈¨£_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
,

3512 **
«me
);

3537 
krb5_îr‹_code
 
KRB5_CALLCONV


3538 
krb5_u≈¨£_«me_ext
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
,

3539 **
«me
, *
size
);

3541 
	#KRB5_PRINCIPAL_UNPARSE_SHORT
 0x1

	)

3542 
	#KRB5_PRINCIPAL_UNPARSE_NO_REALM
 0x2

	)

3543 
	#KRB5_PRINCIPAL_UNPARSE_DISPLAY
 0x4

	)

3568 
krb5_îr‹_code
 
KRB5_CALLCONV


3569 
krb5_u≈¨£_«me_Êags
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
,

3570 
Êags
, **
«me
);

3588 
krb5_îr‹_code
 
KRB5_CALLCONV


3589 
krb5_u≈¨£_«me_Êags_ext
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
,

3590 
Êags
, **
«me
, *
size
);

3607 
krb5_îr‹_code
 
KRB5_CALLCONV


3608 
krb5_£t_¥öcùÆ_ªÆm
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¥öcùÆ
 
¥öcùÆ
,

3609 c⁄° *
ªÆm
);

3625 
krb5_boﬁón
 
KRB5_CALLCONV_WRONG


3626 
krb5_addªss_£¨ch
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_addªss
 *
addr
,

3627 
krb5_addªss
 *c⁄° *
addæi°
);

3639 
krb5_boﬁón
 
KRB5_CALLCONV


3640 
krb5_addªss_com∑ª
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_addªss
 *
addr1
,

3641 c⁄° 
krb5_addªss
 *
addr2
);

3657 
KRB5_CALLCONV


3658 
krb5_addªss_‹dî
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_addªss
 *
addr1
,

3659 c⁄° 
krb5_addªss
 *
addr2
);

3671 
krb5_boﬁón
 
KRB5_CALLCONV


3672 
krb5_ªÆm_com∑ª
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
¥öc1
,

3673 
krb5_c⁄°_¥öcùÆ
 
¥öc2
);

3685 
krb5_boﬁón
 
KRB5_CALLCONV


3686 
krb5_¥öcùÆ_com∑ª
(
krb5_c⁄ãxt
 
c⁄ãxt
,

3687 
krb5_c⁄°_¥öcùÆ
 
¥öc1
,

3688 
krb5_c⁄°_¥öcùÆ
 
¥öc2
);

3703 
krb5_boﬁón
 
KRB5_CALLCONV


3704 
krb5_¥öcùÆ_com∑ª_™y_ªÆm
(
krb5_c⁄ãxt
 
c⁄ãxt
,

3705 
krb5_c⁄°_¥öcùÆ
 
¥öc1
,

3706 
krb5_c⁄°_¥öcùÆ
 
¥öc2
);

3708 
	#KRB5_PRINCIPAL_COMPARE_IGNORE_REALM
 1

	)

3709 
	#KRB5_PRINCIPAL_COMPARE_ENTERPRISE
 2

	)

3710 
	#KRB5_PRINCIPAL_COMPARE_CASEFOLD
 4

	)

3711 
	#KRB5_PRINCIPAL_COMPARE_UTF8
 8

	)

3732 
krb5_boﬁón
 
KRB5_CALLCONV


3733 
krb5_¥öcùÆ_com∑ª_Êags
(
krb5_c⁄ãxt
 
c⁄ãxt
,

3734 
krb5_c⁄°_¥öcùÆ
 
¥öc1
,

3735 
krb5_c⁄°_¥öcùÆ
 
¥öc2
,

3736 
Êags
);

3755 
krb5_îr‹_code
 
KRB5_CALLCONV


3756 
krb5_öô_keyblock
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 
í˘y≥
,

3757 
size_t
 
Àngth
, 
krb5_keyblock
 **
out
);

3771 
krb5_îr‹_code
 
KRB5_CALLCONV


3772 
krb5_c›y_keyblock
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
‰om
,

3773 
krb5_keyblock
 **
to
);

3787 
krb5_îr‹_code
 
KRB5_CALLCONV


3788 
krb5_c›y_keyblock_c⁄ã¡s
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_keyblock
 *
‰om
,

3789 
krb5_keyblock
 *
to
);

3803 
krb5_îr‹_code
 
KRB5_CALLCONV


3804 
krb5_c›y_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_¸eds
 *
ö¸ed
, krb5_¸ed†**
out¸ed
);

3818 
krb5_îr‹_code
 
KRB5_CALLCONV


3819 
krb5_c›y_d©a
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_d©a
 *
öd©a
, krb5_d©®**
outd©a
);

3834 
krb5_îr‹_code
 
KRB5_CALLCONV


3835 
krb5_c›y_¥öcùÆ
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
ö¥öc
,

3836 
krb5_¥öcùÆ
 *
ouçröc
);

3850 
krb5_îr‹_code
 
KRB5_CALLCONV


3851 
krb5_c›y_addªs£s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_addªss
 *c⁄° *
öaddr
,

3852 
krb5_addªss
 ***
ouèddr
);

3866 
krb5_îr‹_code
 
KRB5_CALLCONV


3867 
krb5_c›y_tickë
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_tickë
 *
‰om
, krb5_tickë **
±o
);

3884 
krb5_îr‹_code
 
KRB5_CALLCONV


3885 
krb5_c›y_authd©a
(
krb5_c⁄ãxt
 
c⁄ãxt
,

3886 
krb5_authd©a
 *c⁄° *
ö_authd©
, krb5_authd©®***
out
);

3906 
krb5_îr‹_code
 
KRB5_CALLCONV


3907 
krb5_föd_authd©a
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_authd©a
 *c⁄° *
tickë_authd©a
,

3908 
krb5_authd©a
 *c⁄° *
≠_ªq_authd©a
,

3909 
krb5_authd©©y≥
 
ad_ty≥
, 
krb5_authd©a
 ***
ªsu…s
);

3928 
krb5_îr‹_code
 
KRB5_CALLCONV


3929 
krb5_mîge_authd©a
(
krb5_c⁄ãxt
 
c⁄ãxt
,

3930 
krb5_authd©a
 *c⁄° *
öauthd©1
,

3931 
krb5_authd©a
 * c⁄° *
öauthd©2
,

3932 
krb5_authd©a
 ***
ouèuthd©
);

3947 
krb5_îr‹_code
 
KRB5_CALLCONV


3948 
krb5_c›y_authítiˇt‹
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_authítiˇt‹
 *
auth‰om
,

3949 
krb5_authítiˇt‹
 **
authto
);

3964 
krb5_îr‹_code
 
KRB5_CALLCONV


3965 
krb5_c›y_checksum
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_checksum
 *
ck‰om
,

3966 
krb5_checksum
 **
ckto
);

3982 
krb5_îr‹_code
 
KRB5_CALLCONV


3983 
krb5_gë_£rvî_rˇche
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_d©a
 *
põ˚
,

3984 
krb5_rˇche
 *
r˝å
);

4015 
krb5_îr‹_code
 
KRB5_CALLCONV_C


4016 
krb5_buûd_¥öcùÆ_ext
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¥öcùÆ
 * 
¥öc
,

4017 
æí
, c⁄° * 
ªÆm
, ...);

4045 
krb5_îr‹_code
 
KRB5_CALLCONV_C


4046 
	$krb5_buûd_¥öcùÆ
(
krb5_c⁄ãxt
 
c⁄ãxt
,

4047 
krb5_¥öcùÆ
 * 
¥öc
,

4048 
æí
,

4049 c⁄° * 
ªÆm
, ...)

4050 #i‡
__GNUC__
 >= 4

4051 
	`__©åibuã__
 ((
£¡öñ
))

4054 #i‡
KRB5_DEPRECATED


4056 
KRB5_ATTR_DEPRECATED
 
krb5_îr‹_code
 
KRB5_CALLCONV


4057 
	`krb5_buûd_¥öcùÆ_va
(
krb5_c⁄ãxt
 
c⁄ãxt
,

4058 
krb5_¥öcùÆ
 
¥öc
,

4059 
æí
,

4060 c⁄° *
ªÆm
,

4061 
va_li°
 
≠
);

4092 
krb5_îr‹_code
 
KRB5_CALLCONV


4093 
	`krb5_buûd_¥öcùÆ_Æloc_va
(
krb5_c⁄ãxt
 
c⁄ãxt
,

4094 
krb5_¥öcùÆ
 *
¥öc
,

4095 
æí
,

4096 c⁄° *
ªÆm
,

4097 
va_li°
 
≠
);

4115 
krb5_îr‹_code
 
KRB5_CALLCONV


4116 
	`krb5_425_c⁄v_¥öcùÆ
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
«me
,

4117 c⁄° *
ö°™˚
, c⁄° *
ªÆm
,

4118 
krb5_¥öcùÆ
 *
¥öc
);

4141 
krb5_îr‹_code
 
KRB5_CALLCONV


4142 
	`krb5_524_c⁄v_¥öcùÆ
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
¥öc
,

4143 *
«me
, *
ö°
, *
ªÆm
);

4147 
¸edítüls
;

4156 
KRB5_CALLCONV


4157 
	`krb5_524_c⁄vît_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
v5¸eds
,

4158 
¸edítüls
 *
v4¸eds
);

4160 #i‡
KRB5_DEPRECATED


4161 
	#krb524_c⁄vît_¸eds_kdc
 
krb5_524_c⁄vît_¸eds


	)

4162 
	#krb524_öô_ës
(
x
Ë(0)

	)

4192 
krb5_îr‹_code
 
KRB5_CALLCONV


4193 
	`krb5_kt_ªsﬁve
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
«me
, 
krb5_keyèb
 *
ktid
);

4207 
krb5_îr‹_code
 
KRB5_CALLCONV


4208 
	`krb5_kt_dup
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
ö
, krb5_keyèb *
out
);

4228 
krb5_îr‹_code
 
KRB5_CALLCONV


4229 
	`krb5_kt_deÁu…_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
, *
«me
, 
«me_size
);

4245 
krb5_îr‹_code
 
KRB5_CALLCONV


4246 
	`krb5_kt_deÁu…
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 *
id
);

4263 
krb5_îr‹_code
 
KRB5_CALLCONV


4264 
	`krb5_kt_˛õ¡_deÁu…
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 *
keyèb_out
);

4276 
krb5_îr‹_code
 
KRB5_CALLCONV


4277 
	`krb5_‰ì_keyèb_íåy_c⁄ã¡s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb_íåy
 *
íåy
);

4280 
krb5_îr‹_code
 
KRB5_CALLCONV


4281 
	`krb5_kt_‰ì_íåy
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb_íåy
 *
íåy
);

4301 
krb5_îr‹_code
 
KRB5_CALLCONV


4302 
	`krb5_kt_ªmove_íåy
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
id
, 
krb5_keyèb_íåy
 *
íåy
);

4320 
krb5_îr‹_code
 
KRB5_CALLCONV


4321 
	`krb5_kt_add_íåy
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyèb
 
id
, 
krb5_keyèb_íåy
 *
íåy
);

4332 
krb5_îr‹_code
 
KRB5_CALLCONV_WRONG


4333 
	`krb5_¥öcùÆ2ß…
(
krb5_c⁄ãxt
 
c⁄ãxt
,

4334 
krb5_c⁄°_¥öcùÆ
 
¥
, 
krb5_d©a
 *
ªt
);

4360 
krb5_îr‹_code
 
KRB5_CALLCONV


4361 
	`krb5_cc_ªsﬁve
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
«me
, 
krb5_cˇche
 *
ˇche
);

4373 
krb5_îr‹_code
 
KRB5_CALLCONV


4374 
	`krb5_cc_dup
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ö
, krb5_cˇchê*
out
);

4399 c⁄° *
KRB5_CALLCONV


4400 
	`krb5_cc_deÁu…_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
);

4422 
krb5_îr‹_code
 
KRB5_CALLCONV


4423 
	`krb5_cc_£t_deÁu…_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
«me
);

4444 
krb5_îr‹_code
 
KRB5_CALLCONV


4445 
	`krb5_cc_deÁu…
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 *
cˇche
);

4456 
krb5_îr‹_code
 
KRB5_CALLCONV


4457 
	`krb5_cc_c›y_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
öcc
, krb5_cˇchê
outcc
);

4476 
krb5_îr‹_code
 
KRB5_CALLCONV


4477 
	`krb5_cc_gë_c⁄fig
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
id
,

4478 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
,

4479 c⁄° *
key
, 
krb5_d©a
 *
d©a
);

4500 
krb5_îr‹_code
 
KRB5_CALLCONV


4501 
	`krb5_cc_£t_c⁄fig
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
id
,

4502 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
,

4503 c⁄° *
key
, 
krb5_d©a
 *
d©a
);

4515 
krb5_boﬁón
 
KRB5_CALLCONV


4516 
	`krb5_is_c⁄fig_¥öcùÆ
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
);

4532 
krb5_îr‹_code
 
KRB5_CALLCONV


4533 
	`krb5_cc_swôch
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
ˇche
);

4546 
krb5_boﬁón
 
KRB5_CALLCONV


4547 
	`krb5_cc_suµ‹t_swôch
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
ty≥
);

4566 
krb5_îr‹_code
 
KRB5_CALLCONV


4567 
	`krb5_cc_ˇche_m©ch
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¥öcùÆ
 
˛õ¡
,

4568 
krb5_cˇche
 *
ˇche_out
);

4604 
krb5_îr‹_code
 
KRB5_CALLCONV


4605 
	`krb5_cc_£À˘
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¥öcùÆ
 
£rvî
,

4606 
krb5_cˇche
 *
ˇche_out
, 
krb5_¥öcùÆ
 *
¥öc_out
);

4615 
KRB5_CALLCONV


4616 
	`krb5_‰ì_¥öcùÆ
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¥öcùÆ
 
vÆ
);

4626 
KRB5_CALLCONV


4627 
	`krb5_‰ì_authítiˇt‹
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_authítiˇt‹
 *
vÆ
);

4639 
KRB5_CALLCONV


4640 
	`krb5_‰ì_addªs£s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_addªss
 **
vÆ
);

4652 
KRB5_CALLCONV


4653 
	`krb5_‰ì_authd©a
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_authd©a
 **
vÆ
);

4663 
KRB5_CALLCONV


4664 
	`krb5_‰ì_tickë
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_tickë
 *
vÆ
);

4674 
KRB5_CALLCONV


4675 
	`krb5_‰ì_îr‹
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_îr‹
 *
vÆ
);

4685 
KRB5_CALLCONV


4686 
	`krb5_‰ì_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
vÆ
);

4696 
KRB5_CALLCONV


4697 
	`krb5_‰ì_¸ed_c⁄ã¡s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
vÆ
);

4707 
KRB5_CALLCONV


4708 
	`krb5_‰ì_checksum
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_checksum
 *
vÆ
);

4718 
KRB5_CALLCONV


4719 
	`krb5_‰ì_checksum_c⁄ã¡s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_checksum
 *
vÆ
);

4729 
KRB5_CALLCONV


4730 
	`krb5_‰ì_keyblock
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyblock
 *
vÆ
);

4740 
KRB5_CALLCONV


4741 
	`krb5_‰ì_keyblock_c⁄ã¡s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_keyblock
 *
key
);

4751 
KRB5_CALLCONV


4752 
	`krb5_‰ì_≠_ªp_íc_∑π
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_≠_ªp_íc_∑π
 *
vÆ
);

4762 
KRB5_CALLCONV


4763 
	`krb5_‰ì_d©a
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_d©a
 *
vÆ
);

4766 
KRB5_CALLCONV


4767 
	`krb5_‰ì_o˘ë_d©a
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_o˘ë_d©a
 *
vÆ
);

4777 
KRB5_CALLCONV


4778 
	`krb5_‰ì_d©a_c⁄ã¡s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_d©a
 *
vÆ
);

4786 
KRB5_CALLCONV


4787 
	`krb5_‰ì_u≈¨£d_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
, *
vÆ
);

4797 
KRB5_CALLCONV


4798 
	`krb5_‰ì_°rög
(
krb5_c⁄ãxt
 
c⁄ãxt
, *
vÆ
);

4808 
KRB5_CALLCONV


4809 
	`krb5_‰ì_í˘y≥s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_í˘y≥
 *
vÆ
);

4817 
KRB5_CALLCONV


4818 
	`krb5_‰ì_cksumty≥s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cksumty≥
 *
vÆ
);

4838 
krb5_îr‹_code
 
KRB5_CALLCONV


4839 
	`krb5_us_timeofday
(
krb5_c⁄ãxt
 
c⁄ãxt
,

4840 
krb5_time°amp
 *
£c⁄ds
, 
krb5_öt32
 *
mi¸o£c⁄ds
);

4856 
krb5_îr‹_code
 
KRB5_CALLCONV


4857 
	`krb5_timeofday
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_time°amp
 *
timîë
);

4873 
krb5_îr‹_code
 
KRB5_CALLCONV


4874 
	`krb5_check_˛ockskew
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_time°amp
 
d©e
);

4887 
krb5_îr‹_code
 
KRB5_CALLCONV


4888 
	`krb5_os_loˇœddr
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_addªss
 ***
addr
);

4906 
krb5_îr‹_code
 
KRB5_CALLCONV


4907 
	`krb5_gë_deÁu…_ªÆm
(
krb5_c⁄ãxt
 
c⁄ãxt
, **
Ãólm
);

4922 
krb5_îr‹_code
 
KRB5_CALLCONV


4923 
	`krb5_£t_deÁu…_ªÆm
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
Ãólm
);

4931 
KRB5_CALLCONV


4932 
	`krb5_‰ì_deÁu…_ªÆm
(
krb5_c⁄ãxt
 
c⁄ãxt
, *
Ãólm
);

4963 
krb5_îr‹_code
 
KRB5_CALLCONV


4964 
	`krb5_¢ame_to_¥öcùÆ
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
ho°«me
, c⁄° *
¢ame
,

4965 
krb5_öt32
 
ty≥
, 
krb5_¥öcùÆ
 *
ªt_¥öc
);

4987 
krb5_boﬁón
 
KRB5_CALLCONV


4988 
	`krb5_¢ame_m©ch
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
m©chög
,

4989 
krb5_c⁄°_¥öcùÆ
 
¥öc
);

5013 
krb5_îr‹_code
 
KRB5_CALLCONV


5014 
	`krb5_ch™ge_∑ssw‹d
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
¸eds
, *
√wpw
,

5015 *
ªsu…_code
, 
krb5_d©a
 *
ªsu…_code_°rög
,

5016 
krb5_d©a
 *
ªsu…_°rög
);

5048 
krb5_îr‹_code
 
KRB5_CALLCONV


5049 
	`krb5_£t_∑ssw‹d
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
¸eds
, *
√wpw
,

5050 
krb5_¥öcùÆ
 
ch™ge_∑ssw‹d_f‹
, *
ªsu…_code
,

5051 
krb5_d©a
 *
ªsu…_code_°rög
, krb5_d©®*
ªsu…_°rög
);

5083 
krb5_îr‹_code
 
KRB5_CALLCONV


5084 
	`krb5_£t_∑ssw‹d_usög_cˇche
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
cˇche
,

5085 *
√wpw
, 
krb5_¥öcùÆ
 
ch™ge_∑ssw‹d_f‹
,

5086 *
ªsu…_code
, 
krb5_d©a
 *
ªsu…_code_°rög
,

5087 
krb5_d©a
 *
ªsu…_°rög
);

5111 
krb5_îr‹_code
 
KRB5_CALLCONV


5112 
	`krb5_chpw_mesßge
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_d©a
 *
£rvî_°rög
,

5113 **
mesßge_out
);

5132 
krb5_îr‹_code
 
KRB5_CALLCONV


5133 
	`krb5_gë_¥ofûe
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
_¥ofûe_t
 ** 
¥ofûe
);

5135 #i‡
KRB5_DEPRECATED


5137 
KRB5_ATTR_DEPRECATED
 
krb5_îr‹_code
 
KRB5_CALLCONV


5138 
	`krb5_gë_ö_tkt_wôh_∑ssw‹d
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_Êags
 
›ti⁄s
,

5139 
krb5_addªss
 *c⁄° *
addrs
, 
krb5_í˘y≥
 *
kty≥s
,

5140 
krb5_¥óuthty≥
 *
¥e_auth_ty≥s
,

5141 c⁄° *
∑ssw‹d
, 
krb5_cˇche
 
cˇche
,

5142 
krb5_¸eds
 *
¸eds
, 
krb5_kdc_ªp
 **
ªt_as_ª∂y
);

5145 
KRB5_ATTR_DEPRECATED
 
krb5_îr‹_code
 
KRB5_CALLCONV


5146 
	`krb5_gë_ö_tkt_wôh_skey
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_Êags
 
›ti⁄s
,

5147 
krb5_addªss
 *c⁄° *
addrs
, 
krb5_í˘y≥
 *
kty≥s
,

5148 
krb5_¥óuthty≥
 *
¥e_auth_ty≥s
,

5149 c⁄° 
krb5_keyblock
 *
key
, 
krb5_cˇche
 
cˇche
,

5150 
krb5_¸eds
 *
¸eds
, 
krb5_kdc_ªp
 **
ªt_as_ª∂y
);

5153 
KRB5_ATTR_DEPRECATED
 
krb5_îr‹_code
 
KRB5_CALLCONV


5154 
	`krb5_gë_ö_tkt_wôh_keyèb
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_Êags
 
›ti⁄s
,

5155 
krb5_addªss
 *c⁄° *
addrs
, 
krb5_í˘y≥
 *
kty≥s
,

5156 
krb5_¥óuthty≥
 *
¥e_auth_ty≥s
,

5157 
krb5_keyèb
 
¨g_keyèb
, 
krb5_cˇche
 
cˇche
,

5158 
krb5_¸eds
 *
¸eds
, 
krb5_kdc_ªp
 **
ªt_as_ª∂y
);

5218 
krb5_îr‹_code
 
KRB5_CALLCONV


5219 
	`krb5_rd_ªq
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 *
auth_c⁄ãxt
,

5220 c⁄° 
krb5_d©a
 *
öbuf
, 
krb5_c⁄°_¥öcùÆ
 
£rvî
,

5221 
krb5_keyèb
 
keyèb
, 
krb5_Êags
 *
≠_ªq_›ti⁄s
,

5222 
krb5_tickë
 **
tickë
);

5246 
krb5_îr‹_code
 
KRB5_CALLCONV


5247 
	`krb5_kt_ªad_£rvi˚_key
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_poöãr
 
key¥oˇrg
,

5248 
krb5_¥öcùÆ
 
¥öcùÆ
, 
krb5_kvno
 
vno
,

5249 
krb5_í˘y≥
 
í˘y≥
, 
krb5_keyblock
 **
key
);

5289 
krb5_îr‹_code
 
KRB5_CALLCONV


5290 
	`krb5_mk_ß„
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5291 c⁄° 
krb5_d©a
 *
u£rd©a
, krb5_d©®*
outbuf
,

5292 
krb5_ª∂ay_d©a
 *
outd©a
);

5328 
krb5_îr‹_code
 
KRB5_CALLCONV


5329 
	`krb5_mk_¥iv
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5330 c⁄° 
krb5_d©a
 *
u£rd©a
, krb5_d©®*
outbuf
,

5331 
krb5_ª∂ay_d©a
 *
outd©a
);

5382 
krb5_îr‹_code
 
KRB5_CALLCONV


5383 
	`krb5_£ndauth
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 *
auth_c⁄ãxt
,

5384 
krb5_poöãr
 
fd
, *
≠∂_vîsi⁄
, 
krb5_¥öcùÆ
 
˛õ¡
,

5385 
krb5_¥öcùÆ
 
£rvî
, 
krb5_Êags
 
≠_ªq_›ti⁄s
,

5386 
krb5_d©a
 *
ö_d©a
, 
krb5_¸eds
 *
ö_¸eds
, 
krb5_cˇche
 
cˇche
,

5387 
krb5_îr‹
 **
îr‹
, 
krb5_≠_ªp_íc_∑π
 **
ªp_ªsu…
,

5388 
krb5_¸eds
 **
out_¸eds
);

5412 
krb5_îr‹_code
 
KRB5_CALLCONV


5413 
	`krb5_ªcvauth
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 *
auth_c⁄ãxt
,

5414 
krb5_poöãr
 
fd
, *
≠∂_vîsi⁄
, 
krb5_¥öcùÆ
 
£rvî
,

5415 
krb5_öt32
 
Êags
, 
krb5_keyèb
 
keyèb
, 
krb5_tickë
 **
tickë
);

5434 
krb5_îr‹_code
 
KRB5_CALLCONV


5435 
	`krb5_ªcvauth_vîsi⁄
(
krb5_c⁄ãxt
 
c⁄ãxt
,

5436 
krb5_auth_c⁄ãxt
 *
auth_c⁄ãxt
,

5437 
krb5_poöãr
 
fd
,

5438 
krb5_¥öcùÆ
 
£rvî
,

5439 
krb5_öt32
 
Êags
,

5440 
krb5_keyèb
 
keyèb
,

5441 
krb5_tickë
 **
tickë
,

5442 
krb5_d©a
 *
vîsi⁄
);

5471 
krb5_îr‹_code
 
KRB5_CALLCONV


5472 
	`krb5_mk_n¸ed
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5473 
krb5_¸eds
 **
µ¸eds
, 
krb5_d©a
 **
µd©a
,

5474 
krb5_ª∂ay_d©a
 *
outd©a
);

5497 
krb5_îr‹_code
 
KRB5_CALLCONV


5498 
	`krb5_mk_1¸ed
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5499 
krb5_¸eds
 *
p¸eds
, 
krb5_d©a
 **
µd©a
,

5500 
krb5_ª∂ay_d©a
 *
outd©a
);

5522 
krb5_îr‹_code
 
KRB5_CALLCONV


5523 
	`krb5_rd_¸ed
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5524 
krb5_d©a
 *
p¸edd©a
, 
krb5_¸eds
 ***
µp¸eds
,

5525 
krb5_ª∂ay_d©a
 *
outd©a
);

5556 
krb5_îr‹_code
 
KRB5_CALLCONV


5557 
	`krb5_fwd_tgt_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5558 *
rho°
, 
krb5_¥öcùÆ
 
˛õ¡
, krb5_¥öcùÆ 
£rvî
,

5559 
krb5_cˇche
 
cc
, 
f‹w¨dabÀ
, 
krb5_d©a
 *
outbuf
);

5580 
krb5_îr‹_code
 
KRB5_CALLCONV


5581 
	`krb5_auth_c⁄_öô
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 *
auth_c⁄ãxt
);

5593 
krb5_îr‹_code
 
KRB5_CALLCONV


5594 
	`krb5_auth_c⁄_‰ì
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
);

5611 
krb5_îr‹_code
 
KRB5_CALLCONV


5612 
	`krb5_auth_c⁄_£tÊags
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
, 
krb5_öt32
 
Êags
);

5629 
krb5_îr‹_code
 
KRB5_CALLCONV


5630 
	`krb5_auth_c⁄_gëÊags
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5631 
krb5_öt32
 *
Êags
);

5647 
krb5_îr‹_code
 
KRB5_CALLCONV


5648 
	`krb5_auth_c⁄_£t_checksum_func
–
krb5_c⁄ãxt
 
c⁄ãxt
,

5649 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5650 
krb5_mk_ªq_checksum_func
 
func
,

5651 *
d©a
);

5663 
krb5_îr‹_code
 
KRB5_CALLCONV


5664 
	`krb5_auth_c⁄_gë_checksum_func
–
krb5_c⁄ãxt
 
c⁄ãxt
,

5665 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5666 
krb5_mk_ªq_checksum_func
 *
func
,

5667 **
d©a
);

5685 
krb5_îr‹_code
 
KRB5_CALLCONV_WRONG


5686 
	`krb5_auth_c⁄_£èddrs
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5687 
krb5_addªss
 *
loˇl_addr
, krb5_addªs†*
ªmŸe_addr
);

5699 
krb5_îr‹_code
 
KRB5_CALLCONV


5700 
	`krb5_auth_c⁄_gëaddrs
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5701 
krb5_addªss
 **
loˇl_addr
, krb5_addªs†**
ªmŸe_addr
);

5719 
krb5_îr‹_code
 
KRB5_CALLCONV


5720 
	`krb5_auth_c⁄_£ç‹ts
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5721 
krb5_addªss
 *
loˇl_p‹t
, krb5_addªs†*
ªmŸe_p‹t
);

5732 
krb5_îr‹_code
 
KRB5_CALLCONV


5733 
	`krb5_auth_c⁄_£tu£ru£rkey
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5734 
krb5_keyblock
 *
keyblock
);

5749 
krb5_îr‹_code
 
KRB5_CALLCONV


5750 
	`krb5_auth_c⁄_gëkey
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5751 
krb5_keyblock
 **
keyblock
);

5765 
krb5_îr‹_code
 
KRB5_CALLCONV


5766 
	`krb5_auth_c⁄_gëkey_k
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5767 
krb5_key
 *
key
);

5782 
krb5_îr‹_code
 
KRB5_CALLCONV


5783 
	`krb5_auth_c⁄_gë£ndsubkey
(
krb5_c⁄ãxt
 
˘x
, 
krb5_auth_c⁄ãxt
 
ac
, 
krb5_keyblock
 **
keyblock
);

5797 
krb5_îr‹_code
 
KRB5_CALLCONV


5798 
	`krb5_auth_c⁄_gë£ndsubkey_k
(
krb5_c⁄ãxt
 
˘x
, 
krb5_auth_c⁄ãxt
 
ac
,

5799 
krb5_key
 *
key
);

5814 
krb5_îr‹_code
 
KRB5_CALLCONV


5815 
	`krb5_auth_c⁄_gëªcvsubkey
(
krb5_c⁄ãxt
 
˘x
, 
krb5_auth_c⁄ãxt
 
ac
, 
krb5_keyblock
 **
keyblock
);

5829 
krb5_îr‹_code
 
KRB5_CALLCONV


5830 
	`krb5_auth_c⁄_gëªcvsubkey_k
(
krb5_c⁄ãxt
 
˘x
, 
krb5_auth_c⁄ãxt
 
ac
, 
krb5_key
 *
key
);

5843 
krb5_îr‹_code
 
KRB5_CALLCONV


5844 
	`krb5_auth_c⁄_£t£ndsubkey
(
krb5_c⁄ãxt
 
˘x
, 
krb5_auth_c⁄ãxt
 
ac
,

5845 
krb5_keyblock
 *
keyblock
);

5861 
krb5_îr‹_code
 
KRB5_CALLCONV


5862 
	`krb5_auth_c⁄_£t£ndsubkey_k
(
krb5_c⁄ãxt
 
˘x
, 
krb5_auth_c⁄ãxt
 
ac
, 
krb5_key
 
key
);

5875 
krb5_îr‹_code
 
KRB5_CALLCONV


5876 
	`krb5_auth_c⁄_£åecvsubkey
(
krb5_c⁄ãxt
 
˘x
, 
krb5_auth_c⁄ãxt
 
ac
,

5877 
krb5_keyblock
 *
keyblock
);

5893 
krb5_îr‹_code
 
KRB5_CALLCONV


5894 
	`krb5_auth_c⁄_£åecvsubkey_k
(
krb5_c⁄ãxt
 
˘x
, 
krb5_auth_c⁄ãxt
 
ac
,

5895 
krb5_key
 
key
);

5897 #i‡
KRB5_DEPRECATED


5899 
KRB5_ATTR_DEPRECATED
 
krb5_îr‹_code
 
KRB5_CALLCONV


5900 
	`krb5_auth_c⁄_gëloˇlsubkey
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5901 
krb5_keyblock
 **
keyblock
);

5904 
KRB5_ATTR_DEPRECATED
 
krb5_îr‹_code
 
KRB5_CALLCONV


5905 
	`krb5_auth_c⁄_gëªmŸesubkey
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5906 
krb5_keyblock
 **
keyblock
);

5922 
krb5_îr‹_code
 
KRB5_CALLCONV


5923 
	`krb5_auth_c⁄_gëloˇl£qnumbî
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5924 
krb5_öt32
 *
£qnumbî
);

5939 
krb5_îr‹_code
 
KRB5_CALLCONV


5940 
	`krb5_auth_c⁄_gëªmŸe£qnumbî
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5941 
krb5_öt32
 *
£qnumbî
);

5943 #i‡
KRB5_DEPRECATED


5949 
KRB5_ATTR_DEPRECATED
 
krb5_îr‹_code
 
KRB5_CALLCONV


5950 
	`krb5_auth_c⁄_öôive˘‹
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
);

5966 
krb5_îr‹_code
 
KRB5_CALLCONV


5967 
	`krb5_auth_c⁄_£åˇche
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5968 
krb5_rˇche
 
rˇche
);

5982 
krb5_îr‹_code
 
KRB5_CALLCONV_WRONG


5983 
	`krb5_auth_c⁄_gërˇche
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

5984 
krb5_rˇche
 *
rˇche
);

5998 
krb5_îr‹_code
 
KRB5_CALLCONV


5999 
	`krb5_auth_c⁄_gëauthítiˇt‹
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

6000 
krb5_authítiˇt‹
 **
authítiˇt‹
);

6014 
krb5_îr‹_code
 
KRB5_CALLCONV


6015 
	`krb5_auth_c⁄_£t_ªq_cksumty≥
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

6016 
krb5_cksumty≥
 
cksumty≥
);

6018 
	#KRB5_REALM_BRANCH_CHAR
 '.'

	)

6059 
krb5_îr‹_code
 
KRB5_CALLCONV


6060 
	`krb5_ªad_∑ssw‹d
(
krb5_c⁄ãxt
 
c⁄ãxt
,

6061 c⁄° *
¥om±
, c⁄° *
¥om±2
,

6062 *
ªtu∫_pwd
, *
size_ªtu∫
);

6087 
krb5_îr‹_code
 
KRB5_CALLCONV


6088 
	`krb5_™ame_to_loˇ ame
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_c⁄°_¥öcùÆ
 
™ame
,

6089 
 size_ö
, *
 ame
);

6114 
krb5_îr‹_code
 
KRB5_CALLCONV


6115 
	`krb5_gë_ho°_ªÆm
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
ho°
, ***
ªÆm•
);

6132 
krb5_îr‹_code
 
KRB5_CALLCONV


6133 
	`krb5_gë_ÁŒback_ho°_ªÆm
(
krb5_c⁄ãxt
 
c⁄ãxt
,

6134 
krb5_d©a
 *
hd©a
, ***
ªÆm•
);

6147 
krb5_îr‹_code
 
KRB5_CALLCONV


6148 
	`krb5_‰ì_ho°_ªÆm
(
krb5_c⁄ãxt
 
c⁄ãxt
, *c⁄° *
ªÆmli°
);

6163 
krb5_boﬁón
 
KRB5_CALLCONV


6164 
	`krb5_ku£rok
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¥öcùÆ
 
¥öcùÆ
, c⁄° *
lu£r
);

6185 
krb5_îr‹_code
 
KRB5_CALLCONV


6186 
	`krb5_auth_c⁄_gíaddrs
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_auth_c⁄ãxt
 
auth_c⁄ãxt
,

6187 
öfd
, 
Êags
);

6202 
krb5_îr‹_code
 
KRB5_CALLCONV


6203 
	`krb5_£t_ªÆ_time
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_time°amp
 
£c⁄ds
,

6204 
krb5_öt32
 
mi¸o£c⁄ds
);

6217 
krb5_îr‹_code
 
KRB5_CALLCONV


6218 
	`krb5_gë_time_off£ts
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_time°amp
 *
£c⁄ds
, 
krb5_öt32
 *
mi¸o£c⁄ds
);

6229 
krb5_îr‹_code
 
KRB5_CALLCONV


6230 
	`krb5_°rög_to_í˘y≥
(*
°rög
, 
krb5_í˘y≥
 *
í˘y≥p
);

6240 
krb5_îr‹_code
 
KRB5_CALLCONV


6241 
	`krb5_°rög_to_ß…ty≥
(*
°rög
, 
krb5_öt32
 *
ß…ty≥p
);

6251 
krb5_îr‹_code
 
KRB5_CALLCONV


6252 
	`krb5_°rög_to_cksumty≥
(*
°rög
, 
krb5_cksumty≥
 *
cksumty≥p
);

6262 
krb5_îr‹_code
 
KRB5_CALLCONV


6263 
	`krb5_°rög_to_time°amp
(*
°rög
, 
krb5_time°amp
 *
time°amµ
);

6273 
krb5_îr‹_code
 
KRB5_CALLCONV


6274 
	`krb5_°rög_to_dñèt
(*
°rög
, 
krb5_dñèt
 *
dñèç
);

6285 
krb5_îr‹_code
 
KRB5_CALLCONV


6286 
	`krb5_í˘y≥_to_°rög
(
krb5_í˘y≥
 
í˘y≥
, *
buf„r
, 
size_t
 
buÊí
);

6304 
krb5_îr‹_code
 
KRB5_CALLCONV


6305 
	`krb5_í˘y≥_to_«me
(
krb5_í˘y≥
 
í˘y≥
, 
krb5_boﬁón
 
sh‹ã°
,

6306 *
buf„r
, 
size_t
 
buÊí
);

6317 
krb5_îr‹_code
 
KRB5_CALLCONV


6318 
	`krb5_ß…ty≥_to_°rög
(
krb5_öt32
 
ß…ty≥
, *
buf„r
, 
size_t
 
buÊí
);

6329 
krb5_îr‹_code
 
KRB5_CALLCONV


6330 
	`krb5_cksumty≥_to_°rög
(
krb5_cksumty≥
 
cksumty≥
, *
buf„r
, 
size_t
 
buÊí
);

6344 
krb5_îr‹_code
 
KRB5_CALLCONV


6345 
	`krb5_time°amp_to_°rög
(
krb5_time°amp
 
time°amp
, *
buf„r
, 
size_t
 
buÊí
);

6361 
krb5_îr‹_code
 
KRB5_CALLCONV


6362 
	`krb5_time°amp_to_sf°rög
(
krb5_time°amp
 
time°amp
, *
buf„r
,

6363 
size_t
 
buÊí
, *
∑d
);

6374 
krb5_îr‹_code
 
KRB5_CALLCONV


6375 
	`krb5_dñèt_to_°rög
(
krb5_dñèt
 
dñèt
, *
buf„r
, 
size_t
 
buÊí
);

6378 
	#KRB5_TGS_NAME
 "krbtgt"

	)

6379 
	#KRB5_TGS_NAME_SIZE
 6

	)

6382 
	#KRB5_RECVAUTH_SKIP_VERSION
 0x0001

	)

6383 
	#KRB5_RECVAUTH_BADAUTHVERS
 0x0002

	)

6387 
	s_krb5_¥om±
 {

6388 *
¥om±
;

6389 
hiddí
;

6390 
krb5_d©a
 *
ª∂y
;

6391 } 
	tkrb5_¥om±
;

6394 
krb5_îr‹_code


6395 (
	tKRB5_CALLCONV
 *
	tkrb5_¥om±î_f˘
)(
	tkrb5_c⁄ãxt
 
	tc⁄ãxt
, *
	td©a
,

6396 c⁄° *
	t«me
, c⁄° *
	tb™√r
,

6397 
	tnum_¥om±s
, 
	tkrb5_¥om±
 
	t¥om±s
[]);

6424 
krb5_îr‹_code
 
KRB5_CALLCONV


6425 
	`krb5_¥om±î_posix
(
krb5_c⁄ãxt
 
c⁄ãxt
, *
d©a
, c⁄° *
«me
,

6426 c⁄° *
b™√r
, 
num_¥om±s
,

6427 
krb5_¥om±
 
¥om±s
[]);

6437 
	#KRB5_RESPONDER_QUESTION_PASSWORD
 "∑ssw‹d"

	)

6474 
	#KRB5_RESPONDER_QUESTION_OTP
 "Ÿp"

	)

6479 
	#KRB5_RESPONDER_OTP_FORMAT_DECIMAL
 0

	)

6480 
	#KRB5_RESPONDER_OTP_FORMAT_HEXADECIMAL
 1

	)

6481 
	#KRB5_RESPONDER_OTP_FORMAT_ALPHANUMERIC
 2

	)

6486 
	#KRB5_RESPONDER_OTP_FLAGS_COLLECT_TOKEN
 0x0001

	)

6491 
	#KRB5_RESPONDER_OTP_FLAGS_COLLECT_PIN
 0x0002

	)

6498 
	#KRB5_RESPONDER_OTP_FLAGS_NEXTOTP
 0x0004

	)

6507 
	#KRB5_RESPONDER_OTP_FLAGS_SEPARATE_PIN
 0x0008

	)

6533 
	#KRB5_RESPONDER_QUESTION_PKINIT
 "pköô"

	)

6539 
	#KRB5_RESPONDER_PKINIT_FLAGS_TOKEN_USER_PIN_COUNT_LOW
 (1 << 0)

	)

6545 
	#KRB5_RESPONDER_PKINIT_FLAGS_TOKEN_USER_PIN_FINAL_TRY
 (1 << 1)

	)

6551 
	#KRB5_RESPONDER_PKINIT_FLAGS_TOKEN_USER_PIN_LOCKED
 (1 << 2)

	)

6566 
krb5_ª•⁄dî_c⁄ãxt_°
 *
	tkrb5_ª•⁄dî_c⁄ãxt
;

6582 c⁄° * c⁄° * 
KRB5_CALLCONV


6583 
	`krb5_ª•⁄dî_li°_que°i⁄s
(
krb5_c⁄ãxt
 
˘x
, 
krb5_ª•⁄dî_c⁄ãxt
 
r˘x
);

6601 c⁄° * 
KRB5_CALLCONV


6602 
	`krb5_ª•⁄dî_gë_chÆÀnge
(
krb5_c⁄ãxt
 
˘x
, 
krb5_ª•⁄dî_c⁄ãxt
 
r˘x
,

6603 c⁄° *
que°i⁄
);

6620 
krb5_îr‹_code
 
KRB5_CALLCONV


6621 
	`krb5_ª•⁄dî_£t_™swî
(
krb5_c⁄ãxt
 
˘x
, 
krb5_ª•⁄dî_c⁄ãxt
 
r˘x
,

6622 c⁄° *
que°i⁄
, c⁄° *
™swî
);

6644 
krb5_îr‹_code


6645 (
	tKRB5_CALLCONV
 *
	tkrb5_ª•⁄dî_‚
)(
	tkrb5_c⁄ãxt
 
	t˘x
, *
	td©a
,

6646 
	tkrb5_ª•⁄dî_c⁄ãxt
 
	tr˘x
);

6648 
	s_krb5_ª•⁄dî_Ÿp_tokíöfo
 {

6649 
krb5_Êags
 
Êags
;

6650 
krb5_öt32
 
f‹m©
;

6651 
krb5_öt32
 
Àngth
;

6652 *
víd‹
;

6653 *
chÆÀnge
;

6654 *
tokí_id
;

6655 *
Æg_id
;

6656 } 
	tkrb5_ª•⁄dî_Ÿp_tokíöfo
;

6658 
	s_krb5_ª•⁄dî_Ÿp_chÆÀnge
 {

6659 *
£rvi˚
;

6660 
krb5_ª•⁄dî_Ÿp_tokíöfo
 **
tokíöfo
;

6661 } 
	tkrb5_ª•⁄dî_Ÿp_chÆÀnge
;

6680 
krb5_îr‹_code
 
KRB5_CALLCONV


6681 
	`krb5_ª•⁄dî_Ÿp_gë_chÆÀnge
(
krb5_c⁄ãxt
 
˘x
,

6682 
krb5_ª•⁄dî_c⁄ãxt
 
r˘x
,

6683 
krb5_ª•⁄dî_Ÿp_chÆÀnge
 **
chl
);

6696 
krb5_îr‹_code
 
KRB5_CALLCONV


6697 
	`krb5_ª•⁄dî_Ÿp_£t_™swî
(
krb5_c⁄ãxt
 
˘x
, 
krb5_ª•⁄dî_c⁄ãxt
 
r˘x
,

6698 
size_t
 
ti
, c⁄° *
vÆue
, c⁄° *
pö
);

6709 
KRB5_CALLCONV


6710 
	`krb5_ª•⁄dî_Ÿp_chÆÀnge_‰ì
(
krb5_c⁄ãxt
 
˘x
,

6711 
krb5_ª•⁄dî_c⁄ãxt
 
r˘x
,

6712 
krb5_ª•⁄dî_Ÿp_chÆÀnge
 *
chl
);

6714 
	s_krb5_ª•⁄dî_pköô_idítôy
 {

6715 *
idítôy
;

6716 
krb5_öt32
 
tokí_Êags
;

6717 } 
	tkrb5_ª•⁄dî_pköô_idítôy
;

6719 
	s_krb5_ª•⁄dî_pköô_chÆÀnge
 {

6720 
krb5_ª•⁄dî_pköô_idítôy
 **
idítôõs
;

6721 } 
	tkrb5_ª•⁄dî_pköô_chÆÀnge
;

6740 
krb5_îr‹_code
 
KRB5_CALLCONV


6741 
	`krb5_ª•⁄dî_pköô_gë_chÆÀnge
(
krb5_c⁄ãxt
 
˘x
,

6742 
krb5_ª•⁄dî_c⁄ãxt
 
r˘x
,

6743 
krb5_ª•⁄dî_pköô_chÆÀnge
 **
chl_out
);

6755 
krb5_îr‹_code
 
KRB5_CALLCONV


6756 
	`krb5_ª•⁄dî_pköô_£t_™swî
(
krb5_c⁄ãxt
 
˘x
, 
krb5_ª•⁄dî_c⁄ãxt
 
r˘x
,

6757 c⁄° *
idítôy
, c⁄° *
pö
);

6768 
KRB5_CALLCONV


6769 
	`krb5_ª•⁄dî_pköô_chÆÀnge_‰ì
(
krb5_c⁄ãxt
 
˘x
,

6770 
krb5_ª•⁄dî_c⁄ãxt
 
r˘x
,

6771 
krb5_ª•⁄dî_pköô_chÆÀnge
 *
chl
);

6774 
	s_krb5_gë_öô_¸eds_›t
 {

6775 
krb5_Êags
 
Êags
;

6776 
krb5_dñèt
 
tkt_li„
;

6777 
krb5_dñèt
 
ª√w_li„
;

6778 
f‹w¨dabÀ
;

6779 
¥oxübÀ
;

6780 
krb5_í˘y≥
 *
ëy≥_li°
;

6781 
ëy≥_li°_Àngth
;

6782 
krb5_addªss
 **
addªss_li°
;

6783 
krb5_¥óuthty≥
 *
¥óuth_li°
;

6784 
¥óuth_li°_Àngth
;

6785 
krb5_d©a
 *
ß…
;

6786 } 
	tkrb5_gë_öô_¸eds_›t
;

6788 
	#KRB5_GET_INIT_CREDS_OPT_TKT_LIFE
 0x0001

	)

6789 
	#KRB5_GET_INIT_CREDS_OPT_RENEW_LIFE
 0x0002

	)

6790 
	#KRB5_GET_INIT_CREDS_OPT_FORWARDABLE
 0x0004

	)

6791 
	#KRB5_GET_INIT_CREDS_OPT_PROXIABLE
 0x0008

	)

6792 
	#KRB5_GET_INIT_CREDS_OPT_ETYPE_LIST
 0x0010

	)

6793 
	#KRB5_GET_INIT_CREDS_OPT_ADDRESS_LIST
 0x0020

	)

6794 
	#KRB5_GET_INIT_CREDS_OPT_PREAUTH_LIST
 0x0040

	)

6795 
	#KRB5_GET_INIT_CREDS_OPT_SALT
 0x0080

	)

6796 
	#KRB5_GET_INIT_CREDS_OPT_CHG_PWD_PRMPT
 0x0100

	)

6797 
	#KRB5_GET_INIT_CREDS_OPT_CANONICALIZE
 0x0200

	)

6798 
	#KRB5_GET_INIT_CREDS_OPT_ANONYMOUS
 0x0400

	)

6814 
krb5_îr‹_code
 
KRB5_CALLCONV


6815 
	`krb5_gë_öô_¸eds_›t_Æloc
(
krb5_c⁄ãxt
 
c⁄ãxt
,

6816 
krb5_gë_öô_¸eds_›t
 **
›t
);

6826 
KRB5_CALLCONV


6827 
	`krb5_gë_öô_¸eds_›t_‰ì
(
krb5_c⁄ãxt
 
c⁄ãxt
,

6828 
krb5_gë_öô_¸eds_›t
 *
›t
);

6831 
KRB5_CALLCONV


6832 
	`krb5_gë_öô_¸eds_›t_öô
(
krb5_gë_öô_¸eds_›t
 *
›t
);

6840 
KRB5_CALLCONV


6841 
	`krb5_gë_öô_¸eds_›t_£t_tkt_li„
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6842 
krb5_dñèt
 
tkt_li„
);

6850 
KRB5_CALLCONV


6851 
	`krb5_gë_öô_¸eds_›t_£t_ª√w_li„
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6852 
krb5_dñèt
 
ª√w_li„
);

6860 
KRB5_CALLCONV


6861 
	`krb5_gë_öô_¸eds_›t_£t_f‹w¨dabÀ
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6862 
f‹w¨dabÀ
);

6870 
KRB5_CALLCONV


6871 
	`krb5_gë_öô_¸eds_›t_£t_¥oxübÀ
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6872 
¥oxübÀ
);

6880 
KRB5_CALLCONV


6881 
	`krb5_gë_öô_¸eds_›t_£t_ˇn⁄iˇlize
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6882 
ˇn⁄iˇlize
);

6895 
KRB5_CALLCONV


6896 
	`krb5_gë_öô_¸eds_›t_£t_™⁄ymous
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6897 
™⁄ymous
);

6906 
KRB5_CALLCONV


6907 
	`krb5_gë_öô_¸eds_›t_£t_ëy≥_li°
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6908 
krb5_í˘y≥
 *
ëy≥_li°
,

6909 
ëy≥_li°_Àngth
);

6917 
KRB5_CALLCONV


6918 
	`krb5_gë_öô_¸eds_›t_£t_addªss_li°
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6919 
krb5_addªss
 **
addªs£s
);

6932 
KRB5_CALLCONV


6933 
	`krb5_gë_öô_¸eds_›t_£t_¥óuth_li°
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6934 
krb5_¥óuthty≥
 *
¥óuth_li°
,

6935 
¥óuth_li°_Àngth
);

6948 
KRB5_CALLCONV


6949 
	`krb5_gë_öô_¸eds_›t_£t_ß…
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6950 
krb5_d©a
 *
ß…
);

6962 
KRB5_CALLCONV


6963 
	`krb5_gë_öô_¸eds_›t_£t_ch™ge_∑ssw‹d_¥om±
(
krb5_gë_öô_¸eds_›t
 *
›t
,

6964 
¥om±
);

6967 
	s_krb5_gic_›t_∑_d©a
 {

6968 *
©å
;

6969 *
vÆue
;

6970 } 
	tkrb5_gic_›t_∑_d©a
;

6984 
krb5_îr‹_code
 
KRB5_CALLCONV


6985 
	`krb5_gë_öô_¸eds_›t_£t_∑
(
krb5_c⁄ãxt
 
c⁄ãxt
,

6986 
krb5_gë_öô_¸eds_›t
 *
›t
, c⁄° *
©å
,

6987 c⁄° *
vÆue
);

7004 
krb5_îr‹_code
 
KRB5_CALLCONV


7005 
	`krb5_gë_öô_¸eds_›t_£t_Á°_cˇche_«me
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7006 
krb5_gë_öô_¸eds_›t
 *
›t
,

7007 c⁄° *
Á°_cˇche_«me
);

7021 
krb5_îr‹_code
 
KRB5_CALLCONV


7022 
	`krb5_gë_öô_¸eds_›t_£t_Á°_cˇche
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7023 
krb5_gë_öô_¸eds_›t
 *
›t
,

7024 
krb5_cˇche
 
cˇche
);

7042 
krb5_îr‹_code
 
KRB5_CALLCONV


7043 
	`krb5_gë_öô_¸eds_›t_£t_ö_cˇche
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7044 
krb5_gë_öô_¸eds_›t
 *
›t
,

7045 
krb5_cˇche
 
cˇche
);

7060 
krb5_îr‹_code
 
KRB5_CALLCONV


7061 
	`krb5_gë_öô_¸eds_›t_£t_out_cˇche
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7062 
krb5_gë_öô_¸eds_›t
 *
›t
,

7063 
krb5_cˇche
 
cˇche
);

7078 
krb5_îr‹_code
 
KRB5_CALLCONV


7079 
	`krb5_gë_öô_¸eds_›t_£t_Á°_Êags
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7080 
krb5_gë_öô_¸eds_›t
 *
›t
,

7081 
krb5_Êags
 
Êags
);

7093 
krb5_îr‹_code
 
KRB5_CALLCONV


7094 
	`krb5_gë_öô_¸eds_›t_gë_Á°_Êags
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7095 
krb5_gë_öô_¸eds_›t
 *
›t
,

7096 
krb5_Êags
 *
out_Êags
);

7099 
	#KRB5_FAST_REQUIRED
 0x0001

	)

7102 (
	tKRB5_CALLCONV
 *
	tkrb5_expúe_ˇŒback_func
)(
	tkrb5_c⁄ãxt
 
	tc⁄ãxt
, *
	td©a
,

7103 
	tkrb5_time°amp
 
	t∑ssw‹d_expú©i⁄
,

7104 
	tkrb5_time°amp
 
	taccou¡_expú©i⁄
,

7105 
	tkrb5_boﬁón
 
	tis_œ°_ªq
);

7146 
krb5_îr‹_code
 
KRB5_CALLCONV


7147 
	`krb5_gë_öô_¸eds_›t_£t_expúe_ˇŒback
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7148 
krb5_gë_öô_¸eds_›t
 *
›t
,

7149 
krb5_expúe_ˇŒback_func
 
cb
,

7150 *
d©a
);

7162 
krb5_îr‹_code
 
KRB5_CALLCONV


7163 
	`krb5_gë_öô_¸eds_›t_£t_ª•⁄dî
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7164 
krb5_gë_öô_¸eds_›t
 *
›t
,

7165 
krb5_ª•⁄dî_‚
 
ª•⁄dî
, *
d©a
);

7211 
krb5_îr‹_code
 
KRB5_CALLCONV


7212 
	`krb5_gë_öô_¸eds_∑ssw‹d
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
¸eds
,

7213 
krb5_¥öcùÆ
 
˛õ¡
, c⁄° *
∑ssw‹d
,

7214 
krb5_¥om±î_f˘
 
¥om±î
, *
d©a
,

7215 
krb5_dñèt
 
°¨t_time
,

7216 c⁄° *
ö_tkt_£rvi˚
,

7217 
krb5_gë_öô_¸eds_›t
 *
k5_gic_›ti⁄s
);

7219 
_krb5_öô_¸eds_c⁄ãxt
;

7220 
_krb5_öô_¸eds_c⁄ãxt
 *
	tkrb5_öô_¸eds_c⁄ãxt
;

7222 
	#KRB5_INIT_CREDS_STEP_FLAG_CONTINUE
 0x1

	)

7230 
KRB5_CALLCONV


7231 
	`krb5_öô_¸eds_‰ì
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_öô_¸eds_c⁄ãxt
 
˘x
);

7245 
krb5_îr‹_code
 
KRB5_CALLCONV


7246 
	`krb5_öô_¸eds_gë
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_öô_¸eds_c⁄ãxt
 
˘x
);

7262 
krb5_îr‹_code
 
KRB5_CALLCONV


7263 
	`krb5_öô_¸eds_gë_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_öô_¸eds_c⁄ãxt
 
˘x
,

7264 
krb5_¸eds
 *
¸eds
);

7275 
krb5_îr‹_code
 
KRB5_CALLCONV


7276 
	`krb5_öô_¸eds_gë_îr‹
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_öô_¸eds_c⁄ãxt
 
˘x
,

7277 
krb5_îr‹
 **
îr‹
);

7295 
krb5_îr‹_code
 
KRB5_CALLCONV


7296 
	`krb5_öô_¸eds_öô
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¥öcùÆ
 
˛õ¡
,

7297 
krb5_¥om±î_f˘
 
¥om±î
, *
d©a
,

7298 
krb5_dñèt
 
°¨t_time
, 
krb5_gë_öô_¸eds_›t
 *
›ti⁄s
,

7299 
krb5_öô_¸eds_c⁄ãxt
 *
˘x
);

7313 
krb5_îr‹_code
 
KRB5_CALLCONV


7314 
	`krb5_öô_¸eds_£t_keyèb
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_öô_¸eds_c⁄ãxt
 
˘x
,

7315 
krb5_keyèb
 
keyèb
);

7344 
krb5_îr‹_code
 
KRB5_CALLCONV


7345 
	`krb5_öô_¸eds_°ï
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_öô_¸eds_c⁄ãxt
 
˘x
,

7346 
krb5_d©a
 *
ö
, krb5_d©®*
out
, krb5_d©®*
ªÆm
,

7347 *
Êags
);

7361 
krb5_îr‹_code
 
KRB5_CALLCONV


7362 
	`krb5_öô_¸eds_£t_∑ssw‹d
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_öô_¸eds_c⁄ãxt
 
˘x
,

7363 c⁄° *
∑ssw‹d
);

7378 
krb5_îr‹_code
 
KRB5_CALLCONV


7379 
	`krb5_öô_¸eds_£t_£rvi˚
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_öô_¸eds_c⁄ãxt
 
˘x
,

7380 c⁄° *
£rvi˚
);

7394 
krb5_îr‹_code
 
KRB5_CALLCONV


7395 
	`krb5_öô_¸eds_gë_times
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_öô_¸eds_c⁄ãxt
 
˘x
,

7396 
krb5_tickë_times
 *
times
);

7398 
_krb5_tkt_¸eds_c⁄ãxt
;

7399 
_krb5_tkt_¸eds_c⁄ãxt
 *
	tkrb5_tkt_¸eds_c⁄ãxt
;

7425 
krb5_îr‹_code
 
KRB5_CALLCONV


7426 
	`krb5_tkt_¸eds_öô
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_cˇche
 
cˇche
,

7427 
krb5_¸eds
 *
¸eds
, 
krb5_Êags
 
›ti⁄s
,

7428 
krb5_tkt_¸eds_c⁄ãxt
 *
˘x
);

7444 
krb5_îr‹_code
 
KRB5_CALLCONV


7445 
	`krb5_tkt_¸eds_gë
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_tkt_¸eds_c⁄ãxt
 
˘x
);

7463 
krb5_îr‹_code
 
KRB5_CALLCONV


7464 
	`krb5_tkt_¸eds_gë_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_tkt_¸eds_c⁄ãxt
 
˘x
,

7465 
krb5_¸eds
 *
¸eds
);

7475 
KRB5_CALLCONV


7476 
	`krb5_tkt_¸eds_‰ì
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_tkt_¸eds_c⁄ãxt
 
˘x
);

7478 
	#KRB5_TKT_CREDS_STEP_FLAG_CONTINUE
 0x1

	)

7508 
krb5_îr‹_code
 
KRB5_CALLCONV


7509 
	`krb5_tkt_¸eds_°ï
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_tkt_¸eds_c⁄ãxt
 
˘x
,

7510 
krb5_d©a
 *
ö
, krb5_d©®*
out
, krb5_d©®*
ªÆm
,

7511 *
Êags
);

7527 
krb5_îr‹_code
 
KRB5_CALLCONV


7528 
	`krb5_tkt_¸eds_gë_times
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_tkt_¸eds_c⁄ãxt
 
˘x
,

7529 
krb5_tickë_times
 *
times
);

7555 
krb5_îr‹_code
 
KRB5_CALLCONV


7556 
	`krb5_gë_öô_¸eds_keyèb
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
¸eds
,

7557 
krb5_¥öcùÆ
 
˛õ¡
, 
krb5_keyèb
 
¨g_keyèb
,

7558 
krb5_dñèt
 
°¨t_time
, c⁄° *
ö_tkt_£rvi˚
,

7559 
krb5_gë_öô_¸eds_›t
 *
k5_gic_›ti⁄s
);

7561 
	s_krb5_vîify_öô_¸eds_›t
 {

7562 
krb5_Êags
 
Êags
;

7563 
≠_ªq_noÁû
;

7564 } 
	tkrb5_vîify_öô_¸eds_›t
;

7566 
	#KRB5_VERIFY_INIT_CREDS_OPT_AP_REQ_NOFAIL
 0x0001

	)

7573 
KRB5_CALLCONV


7574 
	`krb5_vîify_öô_¸eds_›t_öô
(
krb5_vîify_öô_¸eds_›t
 *
k5_vic_›ti⁄s
);

7591 
KRB5_CALLCONV


7592 
	`krb5_vîify_öô_¸eds_›t_£t_≠_ªq_noÁû
(
krb5_vîify_öô_¸eds_›t
 * 
k5_vic_›ti⁄s
,

7593 
≠_ªq_noÁû
);

7626 
krb5_îr‹_code
 
KRB5_CALLCONV


7627 
	`krb5_vîify_öô_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
¸eds
,

7628 
krb5_¥öcùÆ
 
£rvî
, 
krb5_keyèb
 
keyèb
,

7629 
krb5_cˇche
 *
cˇche
,

7630 
krb5_vîify_öô_¸eds_›t
 *
›ti⁄s
);

7665 
krb5_îr‹_code
 
KRB5_CALLCONV


7666 
	`krb5_gë_vÆid©ed_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
¸eds
,

7667 
krb5_¥öcùÆ
 
˛õ¡
, 
krb5_cˇche
 
cˇche
,

7668 c⁄° *
ö_tkt_£rvi˚
);

7691 
krb5_îr‹_code
 
KRB5_CALLCONV


7692 
	`krb5_gë_ª√wed_¸eds
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_¸eds
 *
¸eds
,

7693 
krb5_¥öcùÆ
 
˛õ¡
, 
krb5_cˇche
 
cˇche
,

7694 c⁄° *
ö_tkt_£rvi˚
);

7704 
krb5_îr‹_code
 
KRB5_CALLCONV


7705 
	`krb5_decode_tickë
(c⁄° 
krb5_d©a
 *
code
, 
krb5_tickë
 **
ªp
);

7722 
KRB5_CALLCONV


7723 
	`krb5_≠pdeÁu…_°rög
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
≠≤ame
,

7724 c⁄° 
krb5_d©a
 *
ªÆm
, c⁄° *
›ti⁄
,

7725 c⁄° *
deÁu…_vÆue
, ** 
ªt_vÆue
);

7742 
KRB5_CALLCONV


7743 
	`krb5_≠pdeÁu…_boﬁón
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
≠≤ame
,

7744 c⁄° 
krb5_d©a
 *
ªÆm
, c⁄° *
›ti⁄
,

7745 
deÁu…_vÆue
, *
ªt_vÆue
);

7751 
	#KRB5_PROMPT_TYPE_PASSWORD
 0x1

	)

7753 
	#KRB5_PROMPT_TYPE_NEW_PASSWORD
 0x2

	)

7755 
	#KRB5_PROMPT_TYPE_NEW_PASSWORD_AGAIN
 0x3

	)

7757 
	#KRB5_PROMPT_TYPE_PREAUTH
 0x4

	)

7759 
krb5_öt32
 
	tkrb5_¥om±_ty≥
;

7774 
krb5_¥om±_ty≥
* 
KRB5_CALLCONV


7775 
	`krb5_gë_¥om±_ty≥s
(
krb5_c⁄ãxt
 
c⁄ãxt
);

7786 
KRB5_CALLCONV_C


7787 
	$krb5_£t_îr‹_mesßge
(
krb5_c⁄ãxt
 
˘x
, 
krb5_îr‹_code
 
code
, c⁄° *
fmt
, ...)

7788 #i‡!
	`deföed
(
__˝lu•lus
Ë&& (
__GNUC__
 > 2)

7789 
	`__©åibuã__
((
	$__f‹m©__
(
__¥ötf__
, 3, 4)))

7801 
KRB5_CALLCONV


7802 
	$krb5_v£t_îr‹_mesßge
(
krb5_c⁄ãxt
 
˘x
, 
krb5_îr‹_code
 
code
,

7803 c⁄° *
fmt
, 
va_li°
 
¨gs
)

7804 #i‡!
	`deföed
(
__˝lu•lus
Ë&& (
__GNUC__
 > 2)

7805 
	`__©åibuã__
((
	$__f‹m©__
(
__¥ötf__
, 3, 0)))

7815 
KRB5_CALLCONV


7816 
	`krb5_c›y_îr‹_mesßge
(
krb5_c⁄ãxt
 
de°_˘x
, krb5_c⁄ãxà
§c_˘x
);

7838 c⁄° * 
KRB5_CALLCONV


7839 
	`krb5_gë_îr‹_mesßge
(
krb5_c⁄ãxt
 
˘x
, 
krb5_îr‹_code
 
code
);

7847 
KRB5_CALLCONV


7848 
	`krb5_‰ì_îr‹_mesßge
(
krb5_c⁄ãxt
 
˘x
, c⁄° *
msg
);

7858 
KRB5_CALLCONV


7859 
	`krb5_˛ór_îr‹_mesßge
(
krb5_c⁄ãxt
 
˘x
);

7873 
krb5_îr‹_code
 
KRB5_CALLCONV


7874 
	`krb5_decode_authd©a_c⁄èöî
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7875 
krb5_authd©©y≥
 
ty≥
,

7876 c⁄° 
krb5_authd©a
 *
c⁄èöî
,

7877 
krb5_authd©a
 ***
authd©a
);

7892 
krb5_îr‹_code
 
KRB5_CALLCONV


7893 
	`krb5_ícode_authd©a_c⁄èöî
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7894 
krb5_authd©©y≥
 
ty≥
,

7895 
krb5_authd©a
 * c⁄°*
authd©a
,

7896 
krb5_authd©a
 ***
c⁄èöî
);

7914 
krb5_îr‹_code
 
KRB5_CALLCONV


7915 
	`krb5_make_authd©a_kdc_issued
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7916 c⁄° 
krb5_keyblock
 *
key
,

7917 
krb5_c⁄°_¥öcùÆ
 
issuî
,

7918 
krb5_authd©a
 *c⁄° *
authd©a
,

7919 
krb5_authd©a
 ***
ad_kdcissued
);

7935 
krb5_îr‹_code
 
KRB5_CALLCONV


7936 
	`krb5_vîify_authd©a_kdc_issued
(
krb5_c⁄ãxt
 
c⁄ãxt
,

7937 c⁄° 
krb5_keyblock
 *
key
,

7938 c⁄° 
krb5_authd©a
 *
ad_kdcissued
,

7939 
krb5_¥öcùÆ
 *
issuî
,

7940 
krb5_authd©a
 ***
authd©a
);

7947 
	#KRB5_PAC_LOGON_INFO
 1

	)

7948 
	#KRB5_PAC_CREDENTIALS_INFO
 2

	)

7949 
	#KRB5_PAC_SERVER_CHECKSUM
 6

	)

7950 
	#KRB5_PAC_PRIVSVR_CHECKSUM
 7

	)

7951 
	#KRB5_PAC_CLIENT_INFO
 10

	)

7952 
	#KRB5_PAC_DELEGATION_INFO
 11

	)

7953 
	#KRB5_PAC_UPN_DNS_INFO
 12

	)

7955 
krb5_∑c_d©a
;

7957 
krb5_∑c_d©a
 *
	tkrb5_∑c
;

7981 
krb5_îr‹_code
 
KRB5_CALLCONV


7982 
	`krb5_∑c_add_buf„r
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_∑c
 
∑c
, 
krb5_ui_4
 
ty≥
,

7983 c⁄° 
krb5_d©a
 *
d©a
);

7993 
KRB5_CALLCONV


7994 
	`krb5_∑c_‰ì
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_∑c
 
∑c
);

8008 
krb5_îr‹_code
 
KRB5_CALLCONV


8009 
	`krb5_∑c_gë_buf„r
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_∑c
 
∑c
, 
krb5_ui_4
 
ty≥
,

8010 
krb5_d©a
 *
d©a
);

8022 
krb5_îr‹_code
 
KRB5_CALLCONV


8023 
	`krb5_∑c_gë_ty≥s
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_∑c
 
∑c
, 
size_t
 *
Àn
,

8024 
krb5_ui_4
 **
ty≥s
);

8036 
krb5_îr‹_code
 
KRB5_CALLCONV


8037 
	`krb5_∑c_öô
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_∑c
 *
∑c
);

8051 
krb5_îr‹_code
 
KRB5_CALLCONV


8052 
	`krb5_∑c_∑r£
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
±r
, 
size_t
 
Àn
,

8053 
krb5_∑c
 *
∑c
);

8081 
krb5_îr‹_code
 
KRB5_CALLCONV


8082 
	`krb5_∑c_vîify
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° 
krb5_∑c
 
∑c
,

8083 
krb5_time°amp
 
authtime
, 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
,

8084 c⁄° 
krb5_keyblock
 *
£rvî
, c⁄° krb5_keyblock *
¥ivsvr
);

8104 
krb5_îr‹_code
 
KRB5_CALLCONV


8105 
	`krb5_∑c_sign
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_∑c
 
∑c
, 
krb5_time°amp
 
authtime
,

8106 
krb5_c⁄°_¥öcùÆ
 
¥öcùÆ
, c⁄° 
krb5_keyblock
 *
£rvî_key
,

8107 c⁄° 
krb5_keyblock
 *
¥ivsvr_key
, 
krb5_d©a
 *
d©a
);

8120 
krb5_îr‹_code
 
KRB5_CALLCONV


8121 
	`krb5_Ælow_wók_¸y±o
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_boﬁón
 
íabÀ
);

8130 
	s_krb5_åa˚_öfo
 {

8131 c⁄° *
mesßge
;

8132 } 
	tkrb5_åa˚_öfo
;

8135 (
	tKRB5_CALLCONV
 *
	tkrb5_åa˚_ˇŒback
)(
	tkrb5_c⁄ãxt
 
	tc⁄ãxt
,

8136 c⁄° 
	tkrb5_åa˚_öfo
 *
	töfo
,

8137 *
	tcb_d©a
);

8162 
krb5_îr‹_code
 
KRB5_CALLCONV


8163 
	`krb5_£t_åa˚_ˇŒback
(
krb5_c⁄ãxt
 
c⁄ãxt
, 
krb5_åa˚_ˇŒback
 
‚
,

8164 *
cb_d©a
);

8182 
krb5_îr‹_code
 
KRB5_CALLCONV


8183 
	`krb5_£t_åa˚_fûíame
(
krb5_c⁄ãxt
 
c⁄ãxt
, c⁄° *
fûíame
);

8185 #i‡
TARGET_OS_MAC


8186 #¥agm®
	`∑ck
(
p›
)

8189 
KRB5INT_END_DECLS


8193 
	#krb5_c⁄°
 c⁄°

	)

8195 #unde‡
KRB5_ATTR_DEPRECATED


8205 
	~<ë/com_îr.h
>

8207 
	#KRB5KDC_ERR_NONE
 (-1765328384L)

	)

8208 
	#KRB5KDC_ERR_NAME_EXP
 (-1765328383L)

	)

8209 
	#KRB5KDC_ERR_SERVICE_EXP
 (-1765328382L)

	)

8210 
	#KRB5KDC_ERR_BAD_PVNO
 (-1765328381L)

	)

8211 
	#KRB5KDC_ERR_C_OLD_MAST_KVNO
 (-1765328380L)

	)

8212 
	#KRB5KDC_ERR_S_OLD_MAST_KVNO
 (-1765328379L)

	)

8213 
	#KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN
 (-1765328378L)

	)

8214 
	#KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN
 (-1765328377L)

	)

8215 
	#KRB5KDC_ERR_PRINCIPAL_NOT_UNIQUE
 (-1765328376L)

	)

8216 
	#KRB5KDC_ERR_NULL_KEY
 (-1765328375L)

	)

8217 
	#KRB5KDC_ERR_CANNOT_POSTDATE
 (-1765328374L)

	)

8218 
	#KRB5KDC_ERR_NEVER_VALID
 (-1765328373L)

	)

8219 
	#KRB5KDC_ERR_POLICY
 (-1765328372L)

	)

8220 
	#KRB5KDC_ERR_BADOPTION
 (-1765328371L)

	)

8221 
	#KRB5KDC_ERR_ETYPE_NOSUPP
 (-1765328370L)

	)

8222 
	#KRB5KDC_ERR_SUMTYPE_NOSUPP
 (-1765328369L)

	)

8223 
	#KRB5KDC_ERR_PADATA_TYPE_NOSUPP
 (-1765328368L)

	)

8224 
	#KRB5KDC_ERR_TRTYPE_NOSUPP
 (-1765328367L)

	)

8225 
	#KRB5KDC_ERR_CLIENT_REVOKED
 (-1765328366L)

	)

8226 
	#KRB5KDC_ERR_SERVICE_REVOKED
 (-1765328365L)

	)

8227 
	#KRB5KDC_ERR_TGT_REVOKED
 (-1765328364L)

	)

8228 
	#KRB5KDC_ERR_CLIENT_NOTYET
 (-1765328363L)

	)

8229 
	#KRB5KDC_ERR_SERVICE_NOTYET
 (-1765328362L)

	)

8230 
	#KRB5KDC_ERR_KEY_EXP
 (-1765328361L)

	)

8231 
	#KRB5KDC_ERR_PREAUTH_FAILED
 (-1765328360L)

	)

8232 
	#KRB5KDC_ERR_PREAUTH_REQUIRED
 (-1765328359L)

	)

8233 
	#KRB5KDC_ERR_SERVER_NOMATCH
 (-1765328358L)

	)

8234 
	#KRB5KDC_ERR_MUST_USE_USER2USER
 (-1765328357L)

	)

8235 
	#KRB5KDC_ERR_PATH_NOT_ACCEPTED
 (-1765328356L)

	)

8236 
	#KRB5KDC_ERR_SVC_UNAVAILABLE
 (-1765328355L)

	)

8237 
	#KRB5PLACEHOLD_30
 (-1765328354L)

	)

8238 
	#KRB5KRB_AP_ERR_BAD_INTEGRITY
 (-1765328353L)

	)

8239 
	#KRB5KRB_AP_ERR_TKT_EXPIRED
 (-1765328352L)

	)

8240 
	#KRB5KRB_AP_ERR_TKT_NYV
 (-1765328351L)

	)

8241 
	#KRB5KRB_AP_ERR_REPEAT
 (-1765328350L)

	)

8242 
	#KRB5KRB_AP_ERR_NOT_US
 (-1765328349L)

	)

8243 
	#KRB5KRB_AP_ERR_BADMATCH
 (-1765328348L)

	)

8244 
	#KRB5KRB_AP_ERR_SKEW
 (-1765328347L)

	)

8245 
	#KRB5KRB_AP_ERR_BADADDR
 (-1765328346L)

	)

8246 
	#KRB5KRB_AP_ERR_BADVERSION
 (-1765328345L)

	)

8247 
	#KRB5KRB_AP_ERR_MSG_TYPE
 (-1765328344L)

	)

8248 
	#KRB5KRB_AP_ERR_MODIFIED
 (-1765328343L)

	)

8249 
	#KRB5KRB_AP_ERR_BADORDER
 (-1765328342L)

	)

8250 
	#KRB5KRB_AP_ERR_ILL_CR_TKT
 (-1765328341L)

	)

8251 
	#KRB5KRB_AP_ERR_BADKEYVER
 (-1765328340L)

	)

8252 
	#KRB5KRB_AP_ERR_NOKEY
 (-1765328339L)

	)

8253 
	#KRB5KRB_AP_ERR_MUT_FAIL
 (-1765328338L)

	)

8254 
	#KRB5KRB_AP_ERR_BADDIRECTION
 (-1765328337L)

	)

8255 
	#KRB5KRB_AP_ERR_METHOD
 (-1765328336L)

	)

8256 
	#KRB5KRB_AP_ERR_BADSEQ
 (-1765328335L)

	)

8257 
	#KRB5KRB_AP_ERR_INAPP_CKSUM
 (-1765328334L)

	)

8258 
	#KRB5KRB_AP_PATH_NOT_ACCEPTED
 (-1765328333L)

	)

8259 
	#KRB5KRB_ERR_RESPONSE_TOO_BIG
 (-1765328332L)

	)

8260 
	#KRB5PLACEHOLD_53
 (-1765328331L)

	)

8261 
	#KRB5PLACEHOLD_54
 (-1765328330L)

	)

8262 
	#KRB5PLACEHOLD_55
 (-1765328329L)

	)

8263 
	#KRB5PLACEHOLD_56
 (-1765328328L)

	)

8264 
	#KRB5PLACEHOLD_57
 (-1765328327L)

	)

8265 
	#KRB5PLACEHOLD_58
 (-1765328326L)

	)

8266 
	#KRB5PLACEHOLD_59
 (-1765328325L)

	)

8267 
	#KRB5KRB_ERR_GENERIC
 (-1765328324L)

	)

8268 
	#KRB5KRB_ERR_FIELD_TOOLONG
 (-1765328323L)

	)

8269 
	#KRB5KDC_ERR_CLIENT_NOT_TRUSTED
 (-1765328322L)

	)

8270 
	#KRB5KDC_ERR_KDC_NOT_TRUSTED
 (-1765328321L)

	)

8271 
	#KRB5KDC_ERR_INVALID_SIG
 (-1765328320L)

	)

8272 
	#KRB5KDC_ERR_DH_KEY_PARAMETERS_NOT_ACCEPTED
 (-1765328319L)

	)

8273 
	#KRB5KDC_ERR_CERTIFICATE_MISMATCH
 (-1765328318L)

	)

8274 
	#KRB5KRB_AP_ERR_NO_TGT
 (-1765328317L)

	)

8275 
	#KRB5KDC_ERR_WRONG_REALM
 (-1765328316L)

	)

8276 
	#KRB5KRB_AP_ERR_USER_TO_USER_REQUIRED
 (-1765328315L)

	)

8277 
	#KRB5KDC_ERR_CANT_VERIFY_CERTIFICATE
 (-1765328314L)

	)

8278 
	#KRB5KDC_ERR_INVALID_CERTIFICATE
 (-1765328313L)

	)

8279 
	#KRB5KDC_ERR_REVOKED_CERTIFICATE
 (-1765328312L)

	)

8280 
	#KRB5KDC_ERR_REVOCATION_STATUS_UNKNOWN
 (-1765328311L)

	)

8281 
	#KRB5KDC_ERR_REVOCATION_STATUS_UNAVAILABLE
 (-1765328310L)

	)

8282 
	#KRB5KDC_ERR_CLIENT_NAME_MISMATCH
 (-1765328309L)

	)

8283 
	#KRB5KDC_ERR_KDC_NAME_MISMATCH
 (-1765328308L)

	)

8284 
	#KRB5KDC_ERR_INCONSISTENT_KEY_PURPOSE
 (-1765328307L)

	)

8285 
	#KRB5KDC_ERR_DIGEST_IN_CERT_NOT_ACCEPTED
 (-1765328306L)

	)

8286 
	#KRB5KDC_ERR_PA_CHECKSUM_MUST_BE_INCLUDED
 (-1765328305L)

	)

8287 
	#KRB5KDC_ERR_DIGEST_IN_SIGNED_DATA_NOT_ACCEPTED
 (-1765328304L)

	)

8288 
	#KRB5KDC_ERR_PUBLIC_KEY_ENCRYPTION_NOT_SUPPORTED
 (-1765328303L)

	)

8289 
	#KRB5PLACEHOLD_82
 (-1765328302L)

	)

8290 
	#KRB5PLACEHOLD_83
 (-1765328301L)

	)

8291 
	#KRB5PLACEHOLD_84
 (-1765328300L)

	)

8292 
	#KRB5KRB_AP_ERR_IAKERB_KDC_NOT_FOUND
 (-1765328299L)

	)

8293 
	#KRB5KRB_AP_ERR_IAKERB_KDC_NO_RESPONSE
 (-1765328298L)

	)

8294 
	#KRB5PLACEHOLD_87
 (-1765328297L)

	)

8295 
	#KRB5PLACEHOLD_88
 (-1765328296L)

	)

8296 
	#KRB5PLACEHOLD_89
 (-1765328295L)

	)

8297 
	#KRB5PLACEHOLD_90
 (-1765328294L)

	)

8298 
	#KRB5PLACEHOLD_91
 (-1765328293L)

	)

8299 
	#KRB5PLACEHOLD_92
 (-1765328292L)

	)

8300 
	#KRB5KDC_ERR_UNKNOWN_CRITICAL_FAST_OPTION
 (-1765328291L)

	)

8301 
	#KRB5PLACEHOLD_94
 (-1765328290L)

	)

8302 
	#KRB5PLACEHOLD_95
 (-1765328289L)

	)

8303 
	#KRB5PLACEHOLD_96
 (-1765328288L)

	)

8304 
	#KRB5PLACEHOLD_97
 (-1765328287L)

	)

8305 
	#KRB5PLACEHOLD_98
 (-1765328286L)

	)

8306 
	#KRB5PLACEHOLD_99
 (-1765328285L)

	)

8307 
	#KRB5KDC_ERR_NO_ACCEPTABLE_KDF
 (-1765328284L)

	)

8308 
	#KRB5PLACEHOLD_101
 (-1765328283L)

	)

8309 
	#KRB5PLACEHOLD_102
 (-1765328282L)

	)

8310 
	#KRB5PLACEHOLD_103
 (-1765328281L)

	)

8311 
	#KRB5PLACEHOLD_104
 (-1765328280L)

	)

8312 
	#KRB5PLACEHOLD_105
 (-1765328279L)

	)

8313 
	#KRB5PLACEHOLD_106
 (-1765328278L)

	)

8314 
	#KRB5PLACEHOLD_107
 (-1765328277L)

	)

8315 
	#KRB5PLACEHOLD_108
 (-1765328276L)

	)

8316 
	#KRB5PLACEHOLD_109
 (-1765328275L)

	)

8317 
	#KRB5PLACEHOLD_110
 (-1765328274L)

	)

8318 
	#KRB5PLACEHOLD_111
 (-1765328273L)

	)

8319 
	#KRB5PLACEHOLD_112
 (-1765328272L)

	)

8320 
	#KRB5PLACEHOLD_113
 (-1765328271L)

	)

8321 
	#KRB5PLACEHOLD_114
 (-1765328270L)

	)

8322 
	#KRB5PLACEHOLD_115
 (-1765328269L)

	)

8323 
	#KRB5PLACEHOLD_116
 (-1765328268L)

	)

8324 
	#KRB5PLACEHOLD_117
 (-1765328267L)

	)

8325 
	#KRB5PLACEHOLD_118
 (-1765328266L)

	)

8326 
	#KRB5PLACEHOLD_119
 (-1765328265L)

	)

8327 
	#KRB5PLACEHOLD_120
 (-1765328264L)

	)

8328 
	#KRB5PLACEHOLD_121
 (-1765328263L)

	)

8329 
	#KRB5PLACEHOLD_122
 (-1765328262L)

	)

8330 
	#KRB5PLACEHOLD_123
 (-1765328261L)

	)

8331 
	#KRB5PLACEHOLD_124
 (-1765328260L)

	)

8332 
	#KRB5PLACEHOLD_125
 (-1765328259L)

	)

8333 
	#KRB5PLACEHOLD_126
 (-1765328258L)

	)

8334 
	#KRB5PLACEHOLD_127
 (-1765328257L)

	)

8335 
	#KRB5_ERR_RCSID
 (-1765328256L)

	)

8336 
	#KRB5_LIBOS_BADLOCKFLAG
 (-1765328255L)

	)

8337 
	#KRB5_LIBOS_CANTREADPWD
 (-1765328254L)

	)

8338 
	#KRB5_LIBOS_BADPWDMATCH
 (-1765328253L)

	)

8339 
	#KRB5_LIBOS_PWDINTR
 (-1765328252L)

	)

8340 
	#KRB5_PARSE_ILLCHAR
 (-1765328251L)

	)

8341 
	#KRB5_PARSE_MALFORMED
 (-1765328250L)

	)

8342 
	#KRB5_CONFIG_CANTOPEN
 (-1765328249L)

	)

8343 
	#KRB5_CONFIG_BADFORMAT
 (-1765328248L)

	)

8344 
	#KRB5_CONFIG_NOTENUFSPACE
 (-1765328247L)

	)

8345 
	#KRB5_BADMSGTYPE
 (-1765328246L)

	)

8346 
	#KRB5_CC_BADNAME
 (-1765328245L)

	)

8347 
	#KRB5_CC_UNKNOWN_TYPE
 (-1765328244L)

	)

8348 
	#KRB5_CC_NOTFOUND
 (-1765328243L)

	)

8349 
	#KRB5_CC_END
 (-1765328242L)

	)

8350 
	#KRB5_NO_TKT_SUPPLIED
 (-1765328241L)

	)

8351 
	#KRB5KRB_AP_WRONG_PRINC
 (-1765328240L)

	)

8352 
	#KRB5KRB_AP_ERR_TKT_INVALID
 (-1765328239L)

	)

8353 
	#KRB5_PRINC_NOMATCH
 (-1765328238L)

	)

8354 
	#KRB5_KDCREP_MODIFIED
 (-1765328237L)

	)

8355 
	#KRB5_KDCREP_SKEW
 (-1765328236L)

	)

8356 
	#KRB5_IN_TKT_REALM_MISMATCH
 (-1765328235L)

	)

8357 
	#KRB5_PROG_ETYPE_NOSUPP
 (-1765328234L)

	)

8358 
	#KRB5_PROG_KEYTYPE_NOSUPP
 (-1765328233L)

	)

8359 
	#KRB5_WRONG_ETYPE
 (-1765328232L)

	)

8360 
	#KRB5_PROG_SUMTYPE_NOSUPP
 (-1765328231L)

	)

8361 
	#KRB5_REALM_UNKNOWN
 (-1765328230L)

	)

8362 
	#KRB5_SERVICE_UNKNOWN
 (-1765328229L)

	)

8363 
	#KRB5_KDC_UNREACH
 (-1765328228L)

	)

8364 
	#KRB5_NO_LOCALNAME
 (-1765328227L)

	)

8365 
	#KRB5_MUTUAL_FAILED
 (-1765328226L)

	)

8366 
	#KRB5_RC_TYPE_EXISTS
 (-1765328225L)

	)

8367 
	#KRB5_RC_MALLOC
 (-1765328224L)

	)

8368 
	#KRB5_RC_TYPE_NOTFOUND
 (-1765328223L)

	)

8369 
	#KRB5_RC_UNKNOWN
 (-1765328222L)

	)

8370 
	#KRB5_RC_REPLAY
 (-1765328221L)

	)

8371 
	#KRB5_RC_IO
 (-1765328220L)

	)

8372 
	#KRB5_RC_NOIO
 (-1765328219L)

	)

8373 
	#KRB5_RC_PARSE
 (-1765328218L)

	)

8374 
	#KRB5_RC_IO_EOF
 (-1765328217L)

	)

8375 
	#KRB5_RC_IO_MALLOC
 (-1765328216L)

	)

8376 
	#KRB5_RC_IO_PERM
 (-1765328215L)

	)

8377 
	#KRB5_RC_IO_IO
 (-1765328214L)

	)

8378 
	#KRB5_RC_IO_UNKNOWN
 (-1765328213L)

	)

8379 
	#KRB5_RC_IO_SPACE
 (-1765328212L)

	)

8380 
	#KRB5_TRANS_CANTOPEN
 (-1765328211L)

	)

8381 
	#KRB5_TRANS_BADFORMAT
 (-1765328210L)

	)

8382 
	#KRB5_LNAME_CANTOPEN
 (-1765328209L)

	)

8383 
	#KRB5_LNAME_NOTRANS
 (-1765328208L)

	)

8384 
	#KRB5_LNAME_BADFORMAT
 (-1765328207L)

	)

8385 
	#KRB5_CRYPTO_INTERNAL
 (-1765328206L)

	)

8386 
	#KRB5_KT_BADNAME
 (-1765328205L)

	)

8387 
	#KRB5_KT_UNKNOWN_TYPE
 (-1765328204L)

	)

8388 
	#KRB5_KT_NOTFOUND
 (-1765328203L)

	)

8389 
	#KRB5_KT_END
 (-1765328202L)

	)

8390 
	#KRB5_KT_NOWRITE
 (-1765328201L)

	)

8391 
	#KRB5_KT_IOERR
 (-1765328200L)

	)

8392 
	#KRB5_NO_TKT_IN_RLM
 (-1765328199L)

	)

8393 
	#KRB5DES_BAD_KEYPAR
 (-1765328198L)

	)

8394 
	#KRB5DES_WEAK_KEY
 (-1765328197L)

	)

8395 
	#KRB5_BAD_ENCTYPE
 (-1765328196L)

	)

8396 
	#KRB5_BAD_KEYSIZE
 (-1765328195L)

	)

8397 
	#KRB5_BAD_MSIZE
 (-1765328194L)

	)

8398 
	#KRB5_CC_TYPE_EXISTS
 (-1765328193L)

	)

8399 
	#KRB5_KT_TYPE_EXISTS
 (-1765328192L)

	)

8400 
	#KRB5_CC_IO
 (-1765328191L)

	)

8401 
	#KRB5_FCC_PERM
 (-1765328190L)

	)

8402 
	#KRB5_FCC_NOFILE
 (-1765328189L)

	)

8403 
	#KRB5_FCC_INTERNAL
 (-1765328188L)

	)

8404 
	#KRB5_CC_WRITE
 (-1765328187L)

	)

8405 
	#KRB5_CC_NOMEM
 (-1765328186L)

	)

8406 
	#KRB5_CC_FORMAT
 (-1765328185L)

	)

8407 
	#KRB5_CC_NOT_KTYPE
 (-1765328184L)

	)

8408 
	#KRB5_INVALID_FLAGS
 (-1765328183L)

	)

8409 
	#KRB5_NO_2ND_TKT
 (-1765328182L)

	)

8410 
	#KRB5_NOCREDS_SUPPLIED
 (-1765328181L)

	)

8411 
	#KRB5_SENDAUTH_BADAUTHVERS
 (-1765328180L)

	)

8412 
	#KRB5_SENDAUTH_BADAPPLVERS
 (-1765328179L)

	)

8413 
	#KRB5_SENDAUTH_BADRESPONSE
 (-1765328178L)

	)

8414 
	#KRB5_SENDAUTH_REJECTED
 (-1765328177L)

	)

8415 
	#KRB5_PREAUTH_BAD_TYPE
 (-1765328176L)

	)

8416 
	#KRB5_PREAUTH_NO_KEY
 (-1765328175L)

	)

8417 
	#KRB5_PREAUTH_FAILED
 (-1765328174L)

	)

8418 
	#KRB5_RCACHE_BADVNO
 (-1765328173L)

	)

8419 
	#KRB5_CCACHE_BADVNO
 (-1765328172L)

	)

8420 
	#KRB5_KEYTAB_BADVNO
 (-1765328171L)

	)

8421 
	#KRB5_PROG_ATYPE_NOSUPP
 (-1765328170L)

	)

8422 
	#KRB5_RC_REQUIRED
 (-1765328169L)

	)

8423 
	#KRB5_ERR_BAD_HOSTNAME
 (-1765328168L)

	)

8424 
	#KRB5_ERR_HOST_REALM_UNKNOWN
 (-1765328167L)

	)

8425 
	#KRB5_SNAME_UNSUPP_NAMETYPE
 (-1765328166L)

	)

8426 
	#KRB5KRB_AP_ERR_V4_REPLY
 (-1765328165L)

	)

8427 
	#KRB5_REALM_CANT_RESOLVE
 (-1765328164L)

	)

8428 
	#KRB5_TKT_NOT_FORWARDABLE
 (-1765328163L)

	)

8429 
	#KRB5_FWD_BAD_PRINCIPAL
 (-1765328162L)

	)

8430 
	#KRB5_GET_IN_TKT_LOOP
 (-1765328161L)

	)

8431 
	#KRB5_CONFIG_NODEFREALM
 (-1765328160L)

	)

8432 
	#KRB5_SAM_UNSUPPORTED
 (-1765328159L)

	)

8433 
	#KRB5_SAM_INVALID_ETYPE
 (-1765328158L)

	)

8434 
	#KRB5_SAM_NO_CHECKSUM
 (-1765328157L)

	)

8435 
	#KRB5_SAM_BAD_CHECKSUM
 (-1765328156L)

	)

8436 
	#KRB5_KT_NAME_TOOLONG
 (-1765328155L)

	)

8437 
	#KRB5_KT_KVNONOTFOUND
 (-1765328154L)

	)

8438 
	#KRB5_APPL_EXPIRED
 (-1765328153L)

	)

8439 
	#KRB5_LIB_EXPIRED
 (-1765328152L)

	)

8440 
	#KRB5_CHPW_PWDNULL
 (-1765328151L)

	)

8441 
	#KRB5_CHPW_FAIL
 (-1765328150L)

	)

8442 
	#KRB5_KT_FORMAT
 (-1765328149L)

	)

8443 
	#KRB5_NOPERM_ETYPE
 (-1765328148L)

	)

8444 
	#KRB5_CONFIG_ETYPE_NOSUPP
 (-1765328147L)

	)

8445 
	#KRB5_OBSOLETE_FN
 (-1765328146L)

	)

8446 
	#KRB5_EAI_FAIL
 (-1765328145L)

	)

8447 
	#KRB5_EAI_NODATA
 (-1765328144L)

	)

8448 
	#KRB5_EAI_NONAME
 (-1765328143L)

	)

8449 
	#KRB5_EAI_SERVICE
 (-1765328142L)

	)

8450 
	#KRB5_ERR_NUMERIC_REALM
 (-1765328141L)

	)

8451 
	#KRB5_ERR_BAD_S2K_PARAMS
 (-1765328140L)

	)

8452 
	#KRB5_ERR_NO_SERVICE
 (-1765328139L)

	)

8453 
	#KRB5_CC_READONLY
 (-1765328138L)

	)

8454 
	#KRB5_CC_NOSUPP
 (-1765328137L)

	)

8455 
	#KRB5_DELTAT_BADFORMAT
 (-1765328136L)

	)

8456 
	#KRB5_PLUGIN_NO_HANDLE
 (-1765328135L)

	)

8457 
	#KRB5_PLUGIN_OP_NOTSUPP
 (-1765328134L)

	)

8458 
	#KRB5_ERR_INVALID_UTF8
 (-1765328133L)

	)

8459 
	#KRB5_ERR_FAST_REQUIRED
 (-1765328132L)

	)

8460 
	#KRB5_LOCAL_ADDR_REQUIRED
 (-1765328131L)

	)

8461 
	#KRB5_REMOTE_ADDR_REQUIRED
 (-1765328130L)

	)

8462 
	#KRB5_TRACE_NOSUPP
 (-1765328129L)

	)

8463 c⁄° 
îr‹_èbÀ
 
ë_krb5_îr‹_èbÀ
;

8464 
	`öôülize_krb5_îr‹_èbÀ
();

8467 
	`öôülize_krb5_îr‹_èbÀ_r
(
ë_li°
 **
li°
);

8469 
	#ERROR_TABLE_BASE_krb5
 (-1765328384L)

	)

8472 
	#öô_krb5_îr_tbl
 
öôülize_krb5_îr‹_èbÀ


	)

8473 
	#krb5_îr_ba£
 
ERROR_TABLE_BASE_krb5


	)

8479 
	~<ë/com_îr.h
>

8481 
	#KRB5_PLUGIN_VER_NOTSUPP
 (-1750600192L)

	)

8482 
	#KRB5_PLUGIN_BAD_MODULE_SPEC
 (-1750600191L)

	)

8483 
	#KRB5_PLUGIN_NAME_NOTFOUND
 (-1750600190L)

	)

8484 
	#KRB5KDC_ERR_DISCARD
 (-1750600189L)

	)

8485 
	#KRB5_DCC_CANNOT_CREATE
 (-1750600188L)

	)

8486 
	#KRB5_KCC_INVALID_ANCHOR
 (-1750600187L)

	)

8487 
	#KRB5_KCC_UNKNOWN_VERSION
 (-1750600186L)

	)

8488 
	#KRB5_KCC_INVALID_UID
 (-1750600185L)

	)

8489 c⁄° 
îr‹_èbÀ
 
ë_k5e1_îr‹_èbÀ
;

8490 
	`öôülize_k5e1_îr‹_èbÀ
();

8493 
	`öôülize_k5e1_îr‹_èbÀ_r
(
ë_li°
 **
li°
);

8495 
	#ERROR_TABLE_BASE_k5e1
 (-1750600192L)

	)

8498 
	#öô_k5e1_îr_tbl
 
öôülize_k5e1_îr‹_èbÀ


	)

8499 
	#k5e1_îr_ba£
 
ERROR_TABLE_BASE_k5e1


	)

8505 
	~<ë/com_îr.h
>

8507 
	#KRB5_KDB_RCSID
 (-1780008448L)

	)

8508 
	#KRB5_KDB_INUSE
 (-1780008447L)

	)

8509 
	#KRB5_KDB_UK_SERROR
 (-1780008446L)

	)

8510 
	#KRB5_KDB_UK_RERROR
 (-1780008445L)

	)

8511 
	#KRB5_KDB_UNAUTH
 (-1780008444L)

	)

8512 
	#KRB5_KDB_NOENTRY
 (-1780008443L)

	)

8513 
	#KRB5_KDB_ILL_WILDCARD
 (-1780008442L)

	)

8514 
	#KRB5_KDB_DB_INUSE
 (-1780008441L)

	)

8515 
	#KRB5_KDB_DB_CHANGED
 (-1780008440L)

	)

8516 
	#KRB5_KDB_TRUNCATED_RECORD
 (-1780008439L)

	)

8517 
	#KRB5_KDB_RECURSIVELOCK
 (-1780008438L)

	)

8518 
	#KRB5_KDB_NOTLOCKED
 (-1780008437L)

	)

8519 
	#KRB5_KDB_BADLOCKMODE
 (-1780008436L)

	)

8520 
	#KRB5_KDB_DBNOTINITED
 (-1780008435L)

	)

8521 
	#KRB5_KDB_DBINITED
 (-1780008434L)

	)

8522 
	#KRB5_KDB_ILLDIRECTION
 (-1780008433L)

	)

8523 
	#KRB5_KDB_NOMASTERKEY
 (-1780008432L)

	)

8524 
	#KRB5_KDB_BADMASTERKEY
 (-1780008431L)

	)

8525 
	#KRB5_KDB_INVALIDKEYSIZE
 (-1780008430L)

	)

8526 
	#KRB5_KDB_CANTREAD_STORED
 (-1780008429L)

	)

8527 
	#KRB5_KDB_BADSTORED_MKEY
 (-1780008428L)

	)

8528 
	#KRB5_KDB_NOACTMASTERKEY
 (-1780008427L)

	)

8529 
	#KRB5_KDB_KVNONOMATCH
 (-1780008426L)

	)

8530 
	#KRB5_KDB_STORED_MKEY_NOTCURRENT
 (-1780008425L)

	)

8531 
	#KRB5_KDB_CANTLOCK_DB
 (-1780008424L)

	)

8532 
	#KRB5_KDB_DB_CORRUPT
 (-1780008423L)

	)

8533 
	#KRB5_KDB_BAD_VERSION
 (-1780008422L)

	)

8534 
	#KRB5_KDB_BAD_SALTTYPE
 (-1780008421L)

	)

8535 
	#KRB5_KDB_BAD_ENCTYPE
 (-1780008420L)

	)

8536 
	#KRB5_KDB_BAD_CREATEFLAGS
 (-1780008419L)

	)

8537 
	#KRB5_KDB_NO_PERMITTED_KEY
 (-1780008418L)

	)

8538 
	#KRB5_KDB_NO_MATCHING_KEY
 (-1780008417L)

	)

8539 
	#KRB5_KDB_DBTYPE_NOTFOUND
 (-1780008416L)

	)

8540 
	#KRB5_KDB_DBTYPE_NOSUP
 (-1780008415L)

	)

8541 
	#KRB5_KDB_DBTYPE_INIT
 (-1780008414L)

	)

8542 
	#KRB5_KDB_SERVER_INTERNAL_ERR
 (-1780008413L)

	)

8543 
	#KRB5_KDB_ACCESS_ERROR
 (-1780008412L)

	)

8544 
	#KRB5_KDB_INTERNAL_ERROR
 (-1780008411L)

	)

8545 
	#KRB5_KDB_CONSTRAINT_VIOLATION
 (-1780008410L)

	)

8546 
	#KRB5_LOG_CONV
 (-1780008409L)

	)

8547 
	#KRB5_LOG_UNSTABLE
 (-1780008408L)

	)

8548 
	#KRB5_LOG_CORRUPT
 (-1780008407L)

	)

8549 
	#KRB5_LOG_ERROR
 (-1780008406L)

	)

8550 
	#KRB5_KDB_DBTYPE_MISMATCH
 (-1780008405L)

	)

8551 
	#KRB5_KDB_POLICY_REF
 (-1780008404L)

	)

8552 
	#KRB5_KDB_STRINGS_TOOLONG
 (-1780008403L)

	)

8553 c⁄° 
îr‹_èbÀ
 
ë_kdb5_îr‹_èbÀ
;

8554 
	`öôülize_kdb5_îr‹_èbÀ
();

8557 
	`öôülize_kdb5_îr‹_èbÀ_r
(
ë_li°
 **
li°
);

8559 
	#ERROR_TABLE_BASE_kdb5
 (-1780008448L)

	)

8562 
	#öô_kdb5_îr_tbl
 
öôülize_kdb5_îr‹_èbÀ


	)

8563 
	#kdb5_îr_ba£
 
ERROR_TABLE_BASE_kdb5


	)

8569 
	~<ë/com_îr.h
>

8571 
	#KV5M_NONE
 (-1760647424L)

	)

8572 
	#KV5M_PRINCIPAL
 (-1760647423L)

	)

8573 
	#KV5M_DATA
 (-1760647422L)

	)

8574 
	#KV5M_KEYBLOCK
 (-1760647421L)

	)

8575 
	#KV5M_CHECKSUM
 (-1760647420L)

	)

8576 
	#KV5M_ENCRYPT_BLOCK
 (-1760647419L)

	)

8577 
	#KV5M_ENC_DATA
 (-1760647418L)

	)

8578 
	#KV5M_CRYPTOSYSTEM_ENTRY
 (-1760647417L)

	)

8579 
	#KV5M_CS_TABLE_ENTRY
 (-1760647416L)

	)

8580 
	#KV5M_CHECKSUM_ENTRY
 (-1760647415L)

	)

8581 
	#KV5M_AUTHDATA
 (-1760647414L)

	)

8582 
	#KV5M_TRANSITED
 (-1760647413L)

	)

8583 
	#KV5M_ENC_TKT_PART
 (-1760647412L)

	)

8584 
	#KV5M_TICKET
 (-1760647411L)

	)

8585 
	#KV5M_AUTHENTICATOR
 (-1760647410L)

	)

8586 
	#KV5M_TKT_AUTHENT
 (-1760647409L)

	)

8587 
	#KV5M_CREDS
 (-1760647408L)

	)

8588 
	#KV5M_LAST_REQ_ENTRY
 (-1760647407L)

	)

8589 
	#KV5M_PA_DATA
 (-1760647406L)

	)

8590 
	#KV5M_KDC_REQ
 (-1760647405L)

	)

8591 
	#KV5M_ENC_KDC_REP_PART
 (-1760647404L)

	)

8592 
	#KV5M_KDC_REP
 (-1760647403L)

	)

8593 
	#KV5M_ERROR
 (-1760647402L)

	)

8594 
	#KV5M_AP_REQ
 (-1760647401L)

	)

8595 
	#KV5M_AP_REP
 (-1760647400L)

	)

8596 
	#KV5M_AP_REP_ENC_PART
 (-1760647399L)

	)

8597 
	#KV5M_RESPONSE
 (-1760647398L)

	)

8598 
	#KV5M_SAFE
 (-1760647397L)

	)

8599 
	#KV5M_PRIV
 (-1760647396L)

	)

8600 
	#KV5M_PRIV_ENC_PART
 (-1760647395L)

	)

8601 
	#KV5M_CRED
 (-1760647394L)

	)

8602 
	#KV5M_CRED_INFO
 (-1760647393L)

	)

8603 
	#KV5M_CRED_ENC_PART
 (-1760647392L)

	)

8604 
	#KV5M_PWD_DATA
 (-1760647391L)

	)

8605 
	#KV5M_ADDRESS
 (-1760647390L)

	)

8606 
	#KV5M_KEYTAB_ENTRY
 (-1760647389L)

	)

8607 
	#KV5M_CONTEXT
 (-1760647388L)

	)

8608 
	#KV5M_OS_CONTEXT
 (-1760647387L)

	)

8609 
	#KV5M_ALT_METHOD
 (-1760647386L)

	)

8610 
	#KV5M_ETYPE_INFO_ENTRY
 (-1760647385L)

	)

8611 
	#KV5M_DB_CONTEXT
 (-1760647384L)

	)

8612 
	#KV5M_AUTH_CONTEXT
 (-1760647383L)

	)

8613 
	#KV5M_KEYTAB
 (-1760647382L)

	)

8614 
	#KV5M_RCACHE
 (-1760647381L)

	)

8615 
	#KV5M_CCACHE
 (-1760647380L)

	)

8616 
	#KV5M_PREAUTH_OPS
 (-1760647379L)

	)

8617 
	#KV5M_SAM_CHALLENGE
 (-1760647378L)

	)

8618 
	#KV5M_SAM_CHALLENGE_2
 (-1760647377L)

	)

8619 
	#KV5M_SAM_KEY
 (-1760647376L)

	)

8620 
	#KV5M_ENC_SAM_RESPONSE_ENC
 (-1760647375L)

	)

8621 
	#KV5M_ENC_SAM_RESPONSE_ENC_2
 (-1760647374L)

	)

8622 
	#KV5M_SAM_RESPONSE
 (-1760647373L)

	)

8623 
	#KV5M_SAM_RESPONSE_2
 (-1760647372L)

	)

8624 
	#KV5M_PREDICTED_SAM_RESPONSE
 (-1760647371L)

	)

8625 
	#KV5M_PASSWD_PHRASE_ELEMENT
 (-1760647370L)

	)

8626 
	#KV5M_GSS_OID
 (-1760647369L)

	)

8627 
	#KV5M_GSS_QUEUE
 (-1760647368L)

	)

8628 
	#KV5M_FAST_ARMORED_REQ
 (-1760647367L)

	)

8629 
	#KV5M_FAST_REQ
 (-1760647366L)

	)

8630 
	#KV5M_FAST_RESPONSE
 (-1760647365L)

	)

8631 
	#KV5M_AUTHDATA_CONTEXT
 (-1760647364L)

	)

8632 c⁄° 
îr‹_èbÀ
 
ë_kv5m_îr‹_èbÀ
;

8633 
	`öôülize_kv5m_îr‹_èbÀ
();

8636 
	`öôülize_kv5m_îr‹_èbÀ_r
(
ë_li°
 **
li°
);

8638 
	#ERROR_TABLE_BASE_kv5m
 (-1760647424L)

	)

8641 
	#öô_kv5m_îr_tbl
 
öôülize_kv5m_îr‹_èbÀ


	)

8642 
	#kv5m_îr_ba£
 
ERROR_TABLE_BASE_kv5m


	)

8648 
	~<ë/com_îr.h
>

8650 
	#KRB524_BADKEY
 (-1750206208L)

	)

8651 
	#KRB524_BADADDR
 (-1750206207L)

	)

8652 
	#KRB524_BADPRINC
 (-1750206206L)

	)

8653 
	#KRB524_BADREALM
 (-1750206205L)

	)

8654 
	#KRB524_V4ERR
 (-1750206204L)

	)

8655 
	#KRB524_ENCFULL
 (-1750206203L)

	)

8656 
	#KRB524_DECEMPTY
 (-1750206202L)

	)

8657 
	#KRB524_NOTRESP
 (-1750206201L)

	)

8658 
	#KRB524_KRB4_DISABLED
 (-1750206200L)

	)

8659 c⁄° 
îr‹_èbÀ
 
ë_k524_îr‹_èbÀ
;

8660 
	`öôülize_k524_îr‹_èbÀ
();

8663 
	`öôülize_k524_îr‹_èbÀ_r
(
ë_li°
 **
li°
);

8665 
	#ERROR_TABLE_BASE_k524
 (-1750206208L)

	)

8668 
	#öô_k524_îr_tbl
 
öôülize_k524_îr‹_èbÀ


	)

8669 
	#k524_îr_ba£
 
ERROR_TABLE_BASE_k524


	)

8675 
	~<ë/com_îr.h
>

8677 
	#ASN1_BAD_TIMEFORMAT
 (1859794432L)

	)

8678 
	#ASN1_MISSING_FIELD
 (1859794433L)

	)

8679 
	#ASN1_MISPLACED_FIELD
 (1859794434L)

	)

8680 
	#ASN1_TYPE_MISMATCH
 (1859794435L)

	)

8681 
	#ASN1_OVERFLOW
 (1859794436L)

	)

8682 
	#ASN1_OVERRUN
 (1859794437L)

	)

8683 
	#ASN1_BAD_ID
 (1859794438L)

	)

8684 
	#ASN1_BAD_LENGTH
 (1859794439L)

	)

8685 
	#ASN1_BAD_FORMAT
 (1859794440L)

	)

8686 
	#ASN1_PARSE_ERROR
 (1859794441L)

	)

8687 
	#ASN1_BAD_GMTIME
 (1859794442L)

	)

8688 
	#ASN1_MISMATCH_INDEF
 (1859794443L)

	)

8689 
	#ASN1_MISSING_EOC
 (1859794444L)

	)

8690 
	#ASN1_OMITTED
 (1859794445L)

	)

8691 c⁄° 
îr‹_èbÀ
 
ë_a¢1_îr‹_èbÀ
;

8692 
	`öôülize_a¢1_îr‹_èbÀ
();

8695 
	`öôülize_a¢1_îr‹_èbÀ_r
(
ë_li°
 **
li°
);

8697 
	#ERROR_TABLE_BASE_a¢1
 (1859794432L)

	)

8700 
	#öô_a¢1_îr_tbl
 
öôülize_a¢1_îr‹_èbÀ


	)

8701 
	#a¢1_îr_ba£
 
ERROR_TABLE_BASE_a¢1


	)

	@/usr/include/lber_types.h

21 #i‚de‡
_LBER_TYPES_H


22 
	#_LBER_TYPES_H


	)

24 
	~<ld≠_cdefs.h
>

26 
	gLDAP_BEGIN_DECL


29 
	#LBER_INT_T
 

	)

32 
	#LBER_TAG_T
 

	)

35 
	#LBER_SOCKET_T
 

	)

38 
	#LBER_LEN_T
 

	)

43 
LBER_INT_T
 
	tbî_öt_t
;

46 sig√d 
	tLBER_INT_T
 
	tbî_söt_t
;

47 
	tLBER_INT_T
 
	tbî_uöt_t
;

50 
	tLBER_TAG_T
 
	tbî_èg_t
;

53 
LBER_SOCKET_T
 
	tbî_sockë_t
;

56 
	tLBER_LEN_T
 
	tbî_Àn_t
;

59 sig√d 
	tLBER_LEN_T
 
	tbî_¶í_t
;

61 
	gLDAP_END_DECL


	@/usr/include/ldap_features.h

21 #i‚de‡
_LDAP_FEATURES_H


22 
	#_LDAP_FEATURES_H
 1

	)

25 
	#LDAP_VENDOR_VERSION
 20431

	)

26 
	#LDAP_VENDOR_VERSION_MAJOR
 2

	)

27 
	#LDAP_VENDOR_VERSION_MINOR
 4

	)

28 
	#LDAP_VENDOR_VERSION_PATCH
 31

	)

56 
	#LDAP_API_FEATURE_X_OPENLDAP_THREAD_SAFE
 1

	)

	@/usr/include/libio.h

28 #i‚de‡
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_c⁄fig.h
>

33 
	#_IO_Âos_t
 
_G_Âos_t


	)

34 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li°
 
_G_va_li°


	)

45 
	#_IO_wöt_t
 
wöt_t


	)

48 
	#__√ed___va_li°


	)

49 
	~<°d¨g.h
>

50 #ifde‡
__GNUC_VA_LIST


51 #unde‡
_IO_va_li°


52 
	#_IO_va_li°
 
__gnuc_va_li°


	)

55 #i‚de‡
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #i‚de‡
EOF


62 
	#EOF
 (-1)

	)

64 #i‚de‡
NULL


65 #i‡
deföed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuŒ
)

	)

69 #i‡!
deföed
(
__˝lu•lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifde‡
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifde‡
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifde‡
_IO_MTSAFE_IO


148 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<bôs/°dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¨kî
 {

161 
_IO_m¨kî
 *
	m_√xt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

169 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

170 
	mpublic
:

171 
°ªamm¨kî
(
°ªambuf
 *
sb
);

172 ~
°ªamm¨kî
();

173 
ßvög
(Ë{  
	m_•os
 == -2; }

174 
dñè
(
°ªamm¨kî
&);

175 
dñè
();

180 
	e__codecvt_ªsu…


182 
	m__codecvt_ok
,

183 
	m__codecvt_∑πül
,

184 
	m__codecvt_îr‹
,

185 
	m__codecvt_noc⁄v


188 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

194 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

195 
	m__mb°©e_t
 *,

196 c⁄° 
	mwch¨_t
 *,

197 c⁄° 
	mwch¨_t
 *,

198 c⁄° 
	mwch¨_t
 **, *,

200 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

201 
	m__mb°©e_t
 *, *,

203 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

204 
	m__mb°©e_t
 *,

206 c⁄° **, 
	mwch¨_t
 *,

207 
	mwch¨_t
 *, wchar_t **);

208 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

211 c⁄° *, c⁄° *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

214 
_IO_ic⁄v_t
 
	m__cd_ö
;

215 
_IO_ic⁄v_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¨_t
 *
	m_IO_ªad_±r
;

222 
wch¨_t
 *
	m_IO_ªad_íd
;

223 
wch¨_t
 *
	m_IO_ªad_ba£
;

224 
wch¨_t
 *
	m_IO_wrôe_ba£
;

225 
wch¨_t
 *
	m_IO_wrôe_±r
;

226 
wch¨_t
 *
	m_IO_wrôe_íd
;

227 
wch¨_t
 *
	m_IO_buf_ba£
;

228 
wch¨_t
 *
	m_IO_buf_íd
;

230 
wch¨_t
 *
	m_IO_ßve_ba£
;

231 
wch¨_t
 *
	m_IO_backup_ba£
;

233 
wch¨_t
 *
	m_IO_ßve_íd
;

235 
__mb°©e_t
 
	m_IO_°©e
;

236 
__mb°©e_t
 
	m_IO_œ°_°©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¨_t
 
	m_sh‹tbuf
[1];

241 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

245 
	s_IO_FILE
 {

246 
	m_Êags
;

247 
	#_IO_fûe_Êags
 
_Êags


	)

251 * 
	m_IO_ªad_±r
;

252 * 
	m_IO_ªad_íd
;

253 * 
	m_IO_ªad_ba£
;

254 * 
	m_IO_wrôe_ba£
;

255 * 
	m_IO_wrôe_±r
;

256 * 
	m_IO_wrôe_íd
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_íd
;

260 *
	m_IO_ßve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_ßve_íd
;

264 
_IO_m¨kî
 *
	m_m¨kîs
;

266 
_IO_FILE
 *
	m_chaö
;

268 
	m_fûío
;

270 
	m_blksize
;

272 
	m_Êags2
;

274 
_IO_off_t
 
	m_ﬁd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cﬁumn
;

279 sig√d 
	m_vèbÀ_off£t
;

280 
	m_sh‹tbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifde‡
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com∂ëe


290 
_IO_FILE
 
	m_fûe
;

292 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_‰ìªs_li°
;

299 *
	m_‰ìªs_buf
;

300 
size_t
 
	m_‰ìªs_size
;

302 *
	m__∑d1
;

303 *
	m__∑d2
;

304 *
	m__∑d3
;

305 *
	m__∑d4
;

306 
size_t
 
	m__∑d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

314 #i‚de‡
__˝lu•lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_∂us
;

320 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

321 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

322 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

323 #i‚de‡
_LIBC


324 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

325 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

326 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

328 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

329 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

330 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

338 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

346 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, c⁄° *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_˛o£_‚
 (*
	t__cookõ
);

361 #ifde‡
_GNU_SOURCE


363 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

364 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

365 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

366 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

371 
__io_ªad_‚
 *
	mªad
;

372 
__io_wrôe_‚
 *
	mwrôe
;

373 
__io_£ek_‚
 *
	m£ek
;

374 
__io_˛o£_‚
 *
	m˛o£
;

375 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

376 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

378 
	g_IO_cookõ_fûe
;

381 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

382 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

386 #ifde‡
__˝lu•lus


390 
__undîÊow
 (
_IO_FILE
 *);

391 
__uÊow
 (
_IO_FILE
 *);

392 
__ovîÊow
 (
_IO_FILE
 *, );

393 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

395 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

396 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

399 #i‡ 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

402 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

405 
	#_IO_gëc_u∆ocked
(
_Â
) \

406 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

407 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

408 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

409 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

410 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

411 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

412 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

413 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

414 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

415 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

417 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_gëwc_u∆ocked
(
_Â
) \

419 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

420 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

421 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

422 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

423 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

424 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

425 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

426 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

427 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

428 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

431 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

432 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

434 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

436 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

437 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

439 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

443 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

445 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

446 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

447 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

449 #ifde‡
_IO_MTSAFE_IO


450 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

451 
	#_IO_Êockfûe
(
_Â
) \

452 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

453 
	#_IO_fu∆ockfûe
(
_Â
) \

454 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

456 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

457 
	#_IO_Êockfûe
(
_Â
Ë

	)

458 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

459 
	#_IO_·rylockfûe
(
_Â
Ë

	)

460 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

461 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

464 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

465 
_IO_va_li°
, *
__ª°ri˘
);

466 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

467 
_IO_va_li°
);

468 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

476 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

478 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

479 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

480 #i‡
__GNUC__
 >= 2

483 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


484 
	~<shlib-com∑t.h
>

485 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

487 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

488 c⁄° 
_IO_°dö_u£d
;

489 
wók_exã∫
 (
_IO_°dö_u£d
);

492 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


493 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

497 
	#_IO_fwide
(
__Â
, 
__mode
) \

498 ({ 
__ªsu…
 = (
__mode
); \

499 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

501 i‡((
__Â
)->
_mode
 == 0) \

503 (
__Â
)->
_mode
 = -1; \

504 
__ªsu…
 = (
__Â
)->
_mode
; \

506 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

507 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

509 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

510 
__ªsu…
; })

	)

513 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

514 
_IO_va_li°
, *
__ª°ri˘
);

515 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

516 
_IO_va_li°
);

517 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

518 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

521 #ifde‡
__LDBL_COMPAT


522 
	~<bôs/libio-ldbl.h
>

525 #ifde‡
__˝lu•lus


	@/usr/include/paths.h

32 #i‚de‡
_PATHS_H_


33 
	#_PATHS_H_


	)

36 
	#_PATH_DEFPATH
 "/u§/bö:/bö"

	)

38 
	#_PATH_STDPATH
 \

39 "/u§/bö:/bö:/u§/sbö:/sbö"

	)

41 
	#_PATH_BSHELL
 "/bö/sh"

	)

42 
	#_PATH_CONSOLE
 "/dev/c⁄sﬁe"

	)

43 
	#_PATH_CSHELL
 "/bö/csh"

	)

44 
	#_PATH_DEVDB
 "/v¨/run/dev.db"

	)

45 
	#_PATH_DEVNULL
 "/dev/nuŒ"

	)

46 
	#_PATH_DRUM
 "/dev/drum"

	)

47 
	#_PATH_GSHADOW
 "/ëc/gshadow"

	)

48 
	#_PATH_KLOG
 "/¥oc/kmsg"

	)

49 
	#_PATH_KMEM
 "/dev/kmem"

	)

50 
	#_PATH_LASTLOG
 "/v¨/log/œ°log"

	)

51 
	#_PATH_MAILDIR
 "/v¨/maû"

	)

52 
	#_PATH_MAN
 "/u§/sh¨e/m™"

	)

53 
	#_PATH_MEM
 "/dev/mem"

	)

54 
	#_PATH_MNTTAB
 "/ëc/f°ab"

	)

55 
	#_PATH_MOUNTED
 "/ëc/mèb"

	)

56 
	#_PATH_NOLOGIN
 "/ëc/nﬁogö"

	)

57 
	#_PATH_PRESERVE
 "/v¨/lib"

	)

58 
	#_PATH_RWHODIR
 "/v¨/•oﬁ/rwho"

	)

59 
	#_PATH_SENDMAIL
 "/u§/sbö/£ndmaû"

	)

60 
	#_PATH_SHADOW
 "/ëc/shadow"

	)

61 
	#_PATH_SHELLS
 "/ëc/shñls"

	)

62 
	#_PATH_TTY
 "/dev/ây"

	)

63 
	#_PATH_UNIX
 "/boŸ/vmlöux"

	)

64 
	#_PATH_UTMP
 "/v¨/run/utmp"

	)

65 
	#_PATH_VI
 "/u§/bö/vi"

	)

66 
	#_PATH_WTMP
 "/v¨/log/wtmp"

	)

69 
	#_PATH_DEV
 "/dev/"

	)

70 
	#_PATH_TMP
 "/tmp/"

	)

71 
	#_PATH_VARDB
 "/v¨/lib/misc/"

	)

72 
	#_PATH_VARRUN
 "/v¨/run/"

	)

73 
	#_PATH_VARTMP
 "/v¨/tmp/"

	)

	@/usr/include/rpc/auth.h

38 #i‚de‡
_RPC_AUTH_H


40 
	#_RPC_AUTH_H
 1

	)

41 
	~<„©uªs.h
>

42 
	~<Ωc/xdr.h
>

44 
	g__BEGIN_DECLS


46 
	#MAX_AUTH_BYTES
 400

	)

47 
	#MAXNETNAMELEN
 255

	)

52 
	eauth_°©
 {

53 
	mAUTH_OK
=0,

57 
	mAUTH_BADCRED
=1,

58 
	mAUTH_REJECTEDCRED
=2,

59 
	mAUTH_BADVERF
=3,

60 
	mAUTH_REJECTEDVERF
=4,

61 
	mAUTH_TOOWEAK
=5,

65 
	mAUTH_INVALIDRESP
=6,

66 
	mAUTH_FAILED
=7

69 
	udes_block
 {

71 
u_öt32_t
 
	mhigh
;

72 
u_öt32_t
 
	mlow
;

73 } 
	mkey
;

74 
	mc
[8];

76 
des_block
 
	tdes_block
;

77 
boﬁ_t
 
	$xdr_des_block
 (
XDR
 *
__xdrs
, 
des_block
 *
__blkp
Ë
__THROW
;

82 
	s›aque_auth
 {

83 
íum_t
 
ﬂ_Êav‹
;

84 
ˇddr_t
 
ﬂ_ba£
;

85 
u_öt
 
ﬂ_Àngth
;

91 
AUTH
 
	tAUTH
;

92 
	sAUTH
 {

93 
›aque_auth
 
ah_¸ed
;

94 
›aque_auth
 
ah_vîf
;

95 
des_block
 
ah_key
;

96 
	sauth_›s
 {

97 (*
ah_√xtvîf
Ë(
AUTH
 *);

98 (*
ah_m¨shÆ
Ë(
AUTH
 *, 
XDR
 *);

99 (*
ah_vÆid©e
Ë(
AUTH
 *, 
›aque_auth
 *);

101 (*
ah_ª‰esh
Ë(
AUTH
 *);

102 (*
ah_de°roy
Ë(
AUTH
 *);

103 } *
ah_›s
;

104 
ˇddr_t
 
ah_¥iv©e
;

116 
	#AUTH_NEXTVERF
(
auth
) \

117 ((*((
auth
)->
ah_›s
->
ah_√xtvîf
))◊uth))

	)

118 
	#auth_√xtvîf
(
auth
) \

119 ((*((
auth
)->
ah_›s
->
ah_√xtvîf
))◊uth))

	)

121 
	#AUTH_MARSHALL
(
auth
, 
xdrs
) \

122 ((*((
auth
)->
ah_›s
->
ah_m¨shÆ
))◊uth, 
xdrs
))

	)

123 
	#auth_m¨shÆl
(
auth
, 
xdrs
) \

124 ((*((
auth
)->
ah_›s
->
ah_m¨shÆ
))◊uth, 
xdrs
))

	)

126 
	#AUTH_VALIDATE
(
auth
, 
vîÂ
) \

127 ((*((
auth
)->
ah_›s
->
ah_vÆid©e
))(◊uth), 
vîÂ
))

	)

128 
	#auth_vÆid©e
(
auth
, 
vîÂ
) \

129 ((*((
auth
)->
ah_›s
->
ah_vÆid©e
))(◊uth), 
vîÂ
))

	)

131 
	#AUTH_REFRESH
(
auth
) \

132 ((*((
auth
)->
ah_›s
->
ah_ª‰esh
))◊uth))

	)

133 
	#auth_ª‰esh
(
auth
) \

134 ((*((
auth
)->
ah_›s
->
ah_ª‰esh
))◊uth))

	)

136 
	#AUTH_DESTROY
(
auth
) \

137 ((*((
auth
)->
ah_›s
->
ah_de°roy
))◊uth))

	)

138 
	#auth_de°roy
(
auth
) \

139 ((*((
auth
)->
ah_›s
->
ah_de°roy
))◊uth))

	)

142 
›aque_auth
 
_nuŒ_auth
;

158 
AUTH
 *
	`authunix_¸óã
 (*
__mach«me
, 
__uid_t
 
__uid
, 
__gid_t
 
__gid
,

159 
__Àn
, 
__gid_t
 *
__aup_gids
);

160 
AUTH
 *
	`authunix_¸óã_deÁu…
 ();

161 
AUTH
 *
	$authn⁄e_¸óã
 (Ë
__THROW
;

162 
AUTH
 *
	$authdes_¸óã
 (c⁄° *
__£rvî«me
, 
u_öt
 
__wödow
,

163 
sockaddr
 *
__synˇddr
, 
des_block
 *
__ckey
)

164 
__THROW
;

165 
AUTH
 *
	$authdes_pk_¸óã
 (c⁄° *, 
√tobj
 *, 
u_öt
,

166 
sockaddr
 *, 
des_block
 *Ë
__THROW
;

169 
	#AUTH_NONE
 0

	)

170 
	#AUTH_NULL
 0

	)

171 
	#AUTH_SYS
 1

	)

172 
	#AUTH_UNIX
 
AUTH_SYS


	)

173 
	#AUTH_SHORT
 2

	)

174 
	#AUTH_DES
 3

	)

175 
	#AUTH_DH
 
AUTH_DES


	)

176 
	#AUTH_KERB
 4

	)

182 
	$gë√äame
 (*Ë
__THROW
;

183 
	$ho°2√äame
 (*, c⁄° *, c⁄° *Ë
__THROW
;

184 
	$u£r2√äame
 (*, c⁄° 
uid_t
, c⁄° *Ë
__THROW
;

185 
	$√äame2u£r
 (c⁄° *, 
uid_t
 *, 
gid_t
 *, *, gid_t *)

186 
__THROW
;

187 
	$√äame2ho°
 (c⁄° *, *, c⁄° Ë
__THROW
;

194 
	`key_de¸y±£ssi⁄
 (*, 
des_block
 *);

195 
	`key_de¸y±£ssi⁄_pk
 (*, 
√tobj
 *, 
des_block
 *);

196 
	`key_í¸y±£ssi⁄
 (*, 
des_block
 *);

197 
	`key_í¸y±£ssi⁄_pk
 (*, 
√tobj
 *, 
des_block
 *);

198 
	`key_gídes
 (
des_block
 *);

199 
	`key_£t£¸ë
 (*);

200 
	`key_£¸ëkey_is_£t
 ();

201 
	`key_gë_c⁄v
 (*, 
des_block
 *);

206 
boﬁ_t
 
	$xdr_›aque_auth
 (
XDR
 *, 
›aque_auth
 *Ë
__THROW
;

208 
__END_DECLS


	@/usr/include/rpc/auth_des.h

18 #i‚de‡
_RPC_AUTH_DES_H


19 
	#_RPC_AUTH_DES_H
 1

	)

21 
	~<sys/cdefs.h
>

22 
	~<Ωc/auth.h
>

24 
__BEGIN_DECLS


27 
	eauthdes_«meköd


29 
	mADN_FULLNAME
,

30 
	mADN_NICKNAME


35 
	sauthdes_fuŒ«me


37 *
	m«me
;

38 
des_block
 
	mkey
;

39 
uöt32_t
 
	mwödow
;

43 
	sauthdes_¸ed


45 
authdes_«meköd
 
	madc_«meköd
;

46 
authdes_fuŒ«me
 
	madc_fuŒ«me
;

47 
uöt32_t
 
	madc_nick«me
;

51 
	sΩc_timevÆ


53 
uöt32_t
 
	mtv_£c
;

54 
uöt32_t
 
	mtv_u£c
;

58 
	sauthdes_vîf


62 
Ωc_timevÆ
 
	madv_˘ime
;

63 
des_block
 
	madv_xtime
;

65 
	madv_time_u
;

66 
uöt32_t
 
	madv_öt_u
;

74 
	#adv_time°amp
 
adv_time_u
.
adv_˘ime


	)

75 
	#adv_xtime°amp
 
adv_time_u
.
adv_xtime


	)

76 
	#adv_wövîf
 
adv_öt_u


	)

83 
	#adv_timevîf
 
adv_time_u
.
adv_˘ime


	)

84 
	#adv_xtimevîf
 
adv_time_u
.
adv_xtime


	)

85 
	#adv_nick«me
 
adv_öt_u


	)

88 
	$authdes_gëu¸ed
 (c⁄° 
authdes_¸ed
 * 
__adc
,

89 
uid_t
 * 
__uid
, 
gid_t
 * 
__gid
,

90 *
__grou∂í
, 
gid_t
 * 
__groups
Ë
__THROW
;

95 
	$gëpublickey
 (c⁄° *
__«me
, *
__key
Ë
__THROW
;

102 
	$gë£¸ëkey
 (c⁄° *
__«me
, *
__key
,

103 c⁄° *
__∑sswd
Ë
__THROW
;

105 
	$πime
 (
sockaddr_ö
 *
__addΩ
, 
Ωc_timevÆ
 *
__timï
,

106 
Ωc_timevÆ
 *
__timeout
Ë
__THROW
;

108 
__END_DECLS


	@/usr/include/rpc/auth_unix.h

41 #i‚de‡
_RPC_AUTH_UNIX_H


42 
	#_RPC_AUTH_UNIX_H
 1

	)

44 
	~<„©uªs.h
>

45 
	~<sys/ty≥s.h
>

46 
	~<Ωc/ty≥s.h
>

47 
	~<Ωc/auth.h
>

48 
	~<Ωc/xdr.h
>

50 
	g__BEGIN_DECLS


53 
	#MAX_MACHINE_NAME
 255

	)

56 
	#NGRPS
 16

	)

61 
	sauthunix_∑rms


63 
u_l⁄g
 
	maup_time
;

64 *
	maup_mach«me
;

65 
__uid_t
 
	maup_uid
;

66 
__gid_t
 
	maup_gid
;

67 
u_öt
 
	maup_Àn
;

68 
__gid_t
 *
	maup_gids
;

71 
boﬁ_t
 
	$xdr_authunix_∑rms
 (
XDR
 *
__xdrs
, 
authunix_∑rms
 *
__p
)

72 
__THROW
;

79 
	ssh‹t_h™d_vîf


81 
›aque_auth
 
√w_¸ed
;

84 
__END_DECLS


	@/usr/include/rpc/clnt.h

34 #i‚de‡
_RPC_CLNT_H


35 
	#_RPC_CLNT_H
 1

	)

37 
	~<„©uªs.h
>

38 
	~<sys/ty≥s.h
>

39 
	~<Ωc/ty≥s.h
>

40 
	~<Ωc/auth.h
>

41 
	~<sys/un.h
>

43 
__BEGIN_DECLS


50 
	e˛¡_°©
 {

51 
	mRPC_SUCCESS
=0,

55 
	mRPC_CANTENCODEARGS
=1,

56 
	mRPC_CANTDECODERES
=2,

57 
	mRPC_CANTSEND
=3,

58 
	mRPC_CANTRECV
=4,

59 
	mRPC_TIMEDOUT
=5,

63 
	mRPC_VERSMISMATCH
=6,

64 
	mRPC_AUTHERROR
=7,

65 
	mRPC_PROGUNAVAIL
=8,

66 
	mRPC_PROGVERSMISMATCH
=9,

67 
	mRPC_PROCUNAVAIL
=10,

68 
	mRPC_CANTDECODEARGS
=11,

69 
	mRPC_SYSTEMERROR
=12,

70 
	mRPC_NOBROADCAST
 = 21,

74 
	mRPC_UNKNOWNHOST
=13,

75 
	mRPC_UNKNOWNPROTO
=17,

76 
	mRPC_UNKNOWNADDR
 = 19,

81 
	mRPC_RPCBFAILURE
=14,

82 
	#RPC_PMAPFAILURE
 
RPC_RPCBFAILURE


	)

83 
	mRPC_PROGNOTREGISTERED
=15,

84 
	mRPC_N2AXLATEFAILURE
 = 22,

88 
	mRPC_FAILED
=16,

89 
	mRPC_INTR
=18,

90 
	mRPC_TLIERROR
=20,

91 
	mRPC_UDERROR
=23,

95 
	mRPC_INPROGRESS
 = 24,

96 
	mRPC_STALERACHANDLE
 = 25

103 
	sΩc_îr
 {

104 
˛¡_°©
 
	mª_°©us
;

106 
	mRE_î∫o
;

107 
auth_°©
 
	mRE_why
;

109 
u_l⁄g
 
	mlow
;

110 
u_l⁄g
 
	mhigh
;

111 } 
	mRE_vîs
;

113 
	ms1
;

114 
	ms2
;

115 } 
	mRE_lb
;

116 } 
	mru
;

117 
	#ª_î∫o
 
ru
.
RE_î∫o


	)

118 
	#ª_why
 
ru
.
RE_why


	)

119 
	#ª_vîs
 
ru
.
RE_vîs


	)

120 
	#ª_lb
 
ru
.
RE_lb


	)

129 
CLIENT
 
	tCLIENT
;

130 
	sCLIENT
 {

131 
AUTH
 *
	m˛_auth
;

132 
	s˛¡_›s
 {

133 
˛¡_°©
 (*
˛_ˇŒ
Ë(
	mCLIENT
 *, 
	mu_l⁄g
, 
	mxdΩroc_t
, 
	mˇddr_t
, xdrproc_t,

134 
	mˇddr_t
, 
	mtimevÆ
);

136 (*
	m˛_ab‹t
) ();

137 (*
	m˛_gëîr
Ë(
	mCLIENT
 *, 
	mΩc_îr
 *);

139 
boﬁ_t
 (*
˛_‰ìªs
Ë(
	mCLIENT
 *, 
	mxdΩroc_t
, 
	mˇddr_t
);

141 (*
	m˛_de°roy
Ë(
	mCLIENT
 *);

142 
boﬁ_t
 (*
˛_c⁄åﬁ
Ë(
	mCLIENT
 *, , *);

144 } *
	m˛_›s
;

145 
ˇddr_t
 
	m˛_¥iv©e
;

167 
	#CLNT_CALL
(
rh
, 
¥oc
, 
x¨gs
, 
¨g•
, 
xªs
, 
ª•
, 
£cs
) \

168 ((*(
rh
)->
˛_›s
->
˛_ˇŒ
)‘h, 
¥oc
, 
x¨gs
, 
¨g•
, 
xªs
, 
ª•
, 
£cs
))

	)

169 
	#˛¡_ˇŒ
(
rh
, 
¥oc
, 
x¨gs
, 
¨g•
, 
xªs
, 
ª•
, 
£cs
) \

170 ((*(
rh
)->
˛_›s
->
˛_ˇŒ
)‘h, 
¥oc
, 
x¨gs
, 
¨g•
, 
xªs
, 
ª•
, 
£cs
))

	)

177 
	#CLNT_ABORT
(
rh
Ë((*‘h)->
˛_›s
->
˛_ab‹t
)‘h))

	)

178 
	#˛¡_ab‹t
(
rh
Ë((*‘h)->
˛_›s
->
˛_ab‹t
)‘h))

	)

185 
	#CLNT_GETERR
(
rh
,
îΩ
Ë((*‘h)->
˛_›s
->
˛_gëîr
)‘h,Éºp))

	)

186 
	#˛¡_gëîr
(
rh
,
îΩ
Ë((*‘h)->
˛_›s
->
˛_gëîr
)‘h,Éºp))

	)

196 
	#CLNT_FREERES
(
rh
,
xªs
,
ª•
Ë((*‘h)->
˛_›s
->
˛_‰ìªs
)‘h,xªs,ª•))

	)

197 
	#˛¡_‰ìªs
(
rh
,
xªs
,
ª•
Ë((*‘h)->
˛_›s
->
˛_‰ìªs
)‘h,xªs,ª•))

	)

206 
	#CLNT_CONTROL
(
˛
,
rq
,
ö
Ë((*(˛)->
˛_›s
->
˛_c⁄åﬁ
)(˛,rq,ö))

	)

207 
	#˛¡_c⁄åﬁ
(
˛
,
rq
,
ö
Ë((*(˛)->
˛_›s
->
˛_c⁄åﬁ
)(˛,rq,ö))

	)

216 
	#CLSET_TIMEOUT
 1

	)

217 
	#CLGET_TIMEOUT
 2

	)

218 
	#CLGET_SERVER_ADDR
 3

	)

219 
	#CLGET_FD
 6

	)

220 
	#CLGET_SVC_ADDR
 7

	)

221 
	#CLSET_FD_CLOSE
 8

	)

222 
	#CLSET_FD_NCLOSE
 9

	)

223 
	#CLGET_XID
 10

	)

224 
	#CLSET_XID
 11

	)

225 
	#CLGET_VERS
 12

	)

226 
	#CLSET_VERS
 13

	)

227 
	#CLGET_PROG
 14

	)

228 
	#CLSET_PROG
 15

	)

229 
	#CLSET_SVC_ADDR
 16

	)

230 
	#CLSET_PUSH_TIMOD
 17

	)

231 
	#CLSET_POP_TIMOD
 18

	)

235 
	#CLSET_RETRY_TIMEOUT
 4

	)

236 
	#CLGET_RETRY_TIMEOUT
 5

	)

243 
	#CLNT_DESTROY
(
rh
Ë((*‘h)->
˛_›s
->
˛_de°roy
)‘h))

	)

244 
	#˛¡_de°roy
(
rh
Ë((*‘h)->
˛_›s
->
˛_de°roy
)‘h))

	)

253 
	#RPCTEST_PROGRAM
 ((
u_l⁄g
)1)

	)

254 
	#RPCTEST_VERSION
 ((
u_l⁄g
)1)

	)

255 
	#RPCTEST_NULL_PROC
 ((
u_l⁄g
)2)

	)

256 
	#RPCTEST_NULL_BATCH_PROC
 ((
u_l⁄g
)3)

	)

262 
	#NULLPROC
 ((
u_l⁄g
)0)

	)

277 
CLIENT
 *
	$˛¡øw_¸óã
 (c⁄° 
u_l⁄g
 
__¥og
, c⁄° u_l⁄g 
__vîs
)

278 
__THROW
;

291 
CLIENT
 *
	$˛¡_¸óã
 (c⁄° *
__ho°
, c⁄° 
u_l⁄g
 
__¥og
,

292 c⁄° 
u_l⁄g
 
__vîs
, c⁄° *
__¥Ÿ
)

293 
__THROW
;

307 
CLIENT
 *
	$˛¡t˝_¸óã
 (
sockaddr_ö
 *
__øddr
, 
u_l⁄g
 
__¥og
,

308 
u_l⁄g
 
__vîsi⁄
, *
__sockp
, 
u_öt
 
__£ndsz
,

309 
u_öt
 
__ªcvsz
Ë
__THROW
;

332 
CLIENT
 *
	$˛¡udp_¸óã
 (
sockaddr_ö
 *
__øddr
, 
u_l⁄g
 
__¥ogøm
,

333 
u_l⁄g
 
__vîsi⁄
, 
timevÆ
 
__waô_ª£nd
,

334 *
__sockp
Ë
__THROW
;

335 
CLIENT
 *
	$˛¡udp_buf¸óã
 (
sockaddr_ö
 *
__øddr
,

336 
u_l⁄g
 
__¥ogøm
, u_l⁄g 
__vîsi⁄
,

337 
timevÆ
 
__waô_ª£nd
, *
__sockp
,

338 
u_öt
 
__£ndsz
, u_öà
__ªcvsz
Ë
__THROW
;

354 
CLIENT
 *
	$˛¡unix_¸óã
 (
sockaddr_un
 *
__øddr
, 
u_l⁄g
 
__¥ogøm
,

355 
u_l⁄g
 
__vîsi⁄
, *
__sockp
,

356 
u_öt
 
__£ndsz
, u_öà
__ªcvsz
Ë
__THROW
;

359 
	$ˇŒΩc
 (c⁄° *
__ho°
, c⁄° 
u_l⁄g
 
__¥ognum
,

360 c⁄° 
u_l⁄g
 
__vî¢um
, c⁄° u_l⁄g 
__¥o˙um
,

361 c⁄° 
xdΩroc_t
 
__ö¥oc
, c⁄° *
__ö
,

362 c⁄° 
xdΩroc_t
 
__ouçroc
, *
__out
Ë
__THROW
;

363 
	$_Ωc_dèbÀsize
 (Ë
__THROW
;

368 
	`˛¡_p¸óãîr‹
 (c⁄° *
__msg
);

369 *
	$˛¡_•¸óãîr‹
(c⁄° *
__msg
Ë
__THROW
;

374 
	`˛¡_≥ºno
 (
˛¡_°©
 
__num
);

379 
	`˛¡_≥º‹
 (
CLIENT
 *
__˛¡
, c⁄° *
__msg
);

381 *
	$˛¡_•îr‹
 (
CLIENT
 *
__˛¡
, c⁄° *
__msg
Ë
__THROW
;

387 
	sΩc_¸óãîr
 {

388 
˛¡_°©
 
cf_°©
;

389 
Ωc_îr
 
cf_îr‹
;

392 
Ωc_¸óãîr
Ñpc_createerr;

399 *
	$˛¡_•î∫o
 (
˛¡_°©
 
__num
Ë
__THROW
;

404 
	$gëΩ˝‹t
 (c⁄° * 
__ho°
, 
u_l⁄g
 
__¥ognum
,

405 
u_l⁄g
 
__vî¢um
, 
u_öt
 
__¥Ÿo
Ë
__THROW
;

411 
	$gë_myaddªss
 (
sockaddr_ö
 *Ë
__THROW
;

413 
	#UDPMSGSIZE
 8800

	)

414 
	#RPCSMALLMSGSIZE
 400

	)

416 
__END_DECLS


	@/usr/include/rpc/netdb.h

36 #i‚de‡
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<„©uªs.h
>

41 
	#__√ed_size_t


	)

42 
	~<°ddef.h
>

44 
__BEGIN_DECLS


46 
	sΩ˚¡


48 *
	mr_«me
;

49 **
	mr_Æü£s
;

50 
	mr_numbî
;

53 
	$£åp˚¡
 (
__°ay›í
Ë
__THROW
;

54 
	$ídΩ˚¡
 (Ë
__THROW
;

55 
Ω˚¡
 *
	$gëΩcby«me
 (c⁄° *
__«me
Ë
__THROW
;

56 
Ω˚¡
 *
	$gëΩcbynumbî
 (
__numbî
Ë
__THROW
;

57 
Ω˚¡
 *
	$gëΩ˚¡
 (Ë
__THROW
;

59 #ifde‡
__USE_MISC


60 
	$gëΩcby«me_r
 (c⁄° *
__«me
, 
Ω˚¡
 *
__ªsu…_buf
,

61 *
__buf„r
, 
size_t
 
__buÊí
,

62 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

64 
	$gëΩcbynumbî_r
 (
__numbî
, 
Ω˚¡
 *
__ªsu…_buf
,

65 *
__buf„r
, 
size_t
 
__buÊí
,

66 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

68 
	$gëΩ˚¡_r
 (
Ω˚¡
 *
__ªsu…_buf
, *
__buf„r
,

69 
size_t
 
__buÊí
, 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

72 
__END_DECLS


	@/usr/include/rpc/rpc_msg.h

35 #i‚de‡
_RPC_MSG_H


36 
	#_RPC_MSG_H
 1

	)

38 
	~<sys/cdefs.h
>

40 
	~<Ωc/xdr.h
>

41 
	~<Ωc/˛¡.h
>

43 
	#RPC_MSG_VERSION
 ((
u_l⁄g
Ë2)

	)

44 
	#RPC_SERVICE_PORT
 ((
u_sh‹t
Ë2048)

	)

46 
__BEGIN_DECLS


54 
	emsg_ty≥
 {

55 
	mCALL
=0,

56 
	mREPLY
=1

59 
	eª∂y_°©
 {

60 
	mMSG_ACCEPTED
=0,

61 
	mMSG_DENIED
=1

64 
	eac˚±_°©
 {

65 
	mSUCCESS
=0,

66 
	mPROG_UNAVAIL
=1,

67 
	mPROG_MISMATCH
=2,

68 
	mPROC_UNAVAIL
=3,

69 
	mGARBAGE_ARGS
=4,

70 
	mSYSTEM_ERR
=5

73 
	eªje˘_°©
 {

74 
	mRPC_MISMATCH
=0,

75 
	mAUTH_ERROR
=1

87 
	sac˚±ed_ª∂y
 {

88 
›aque_auth
 
	m¨_vîf
;

89 
ac˚±_°©
 
	m¨_°©
;

92 
u_l⁄g
 
	mlow
;

93 
u_l⁄g
 
	mhigh
;

94 } 
	mAR_vîsi⁄s
;

96 
ˇddr_t
 
	mwhîe
;

97 
xdΩroc_t
 
	m¥oc
;

98 } 
	mAR_ªsu…s
;

100 } 
	mru
;

101 
	#¨_ªsu…s
 
ru
.
AR_ªsu…s


	)

102 
	#¨_vîs
 
ru
.
AR_vîsi⁄s


	)

108 
	sªje˘ed_ª∂y
 {

109 
ªje˘_°©
 
	mrj_°©
;

112 
u_l⁄g
 
	mlow
;

113 
u_l⁄g
 
	mhigh
;

114 } 
	mRJ_vîsi⁄s
;

115 
auth_°©
 
	mRJ_why
;

116 } 
	mru
;

117 
	#rj_vîs
 
ru
.
RJ_vîsi⁄s


	)

118 
	#rj_why
 
ru
.
RJ_why


	)

124 
	sª∂y_body
 {

125 
ª∂y_°©
 
	mΩ_°©
;

127 
ac˚±ed_ª∂y
 
	mRP_¨
;

128 
ªje˘ed_ª∂y
 
	mRP_dr
;

129 } 
	mru
;

130 
	#Ω_a˝t
 
ru
.
RP_¨


	)

131 
	#Ω_rj˘
 
ru
.
RP_dr


	)

137 
	sˇŒ_body
 {

138 
u_l⁄g
 
	mcb_Ωcvîs
;

139 
u_l⁄g
 
	mcb_¥og
;

140 
u_l⁄g
 
	mcb_vîs
;

141 
u_l⁄g
 
	mcb_¥oc
;

142 
›aque_auth
 
	mcb_¸ed
;

143 
›aque_auth
 
	mcb_vîf
;

149 
	sΩc_msg
 {

150 
u_l⁄g
 
	mrm_xid
;

151 
msg_ty≥
 
	mrm_dúe˘i⁄
;

153 
ˇŒ_body
 
	mRM_cmb
;

154 
ª∂y_body
 
	mRM_rmb
;

155 } 
	mru
;

156 
	#rm_ˇŒ
 
ru
.
RM_cmb


	)

157 
	#rm_ª∂y
 
ru
.
RM_rmb


	)

159 
	#a˝ãd_Ωly
 
ru
.
RM_rmb
.ru.
RP_¨


	)

160 
	#rj˘ed_Ωly
 
ru
.
RM_rmb
.ru.
RP_dr


	)

169 
boﬁ_t
 
	$xdr_ˇŒmsg
 (
XDR
 *
__xdrs
, 
Ωc_msg
 *
__cmsg
Ë
__THROW
;

177 
boﬁ_t
 
	$xdr_ˇŒhdr
 (
XDR
 *
__xdrs
, 
Ωc_msg
 *
__cmsg
Ë
__THROW
;

185 
boﬁ_t
 
	$xdr_ª∂ymsg
 (
XDR
 *
__xdrs
, 
Ωc_msg
 *
__rmsg
Ë
__THROW
;

193 
	$_£ãº_ª∂y
 (
Ωc_msg
 *
__msg
, 
Ωc_îr
 *
__îr‹
)

194 
__THROW
;

196 
__END_DECLS


	@/usr/include/rpc/svc.h

51 #i‚de‡
_RPC_SVC_H


52 
	#_RPC_SVC_H
 1

	)

54 
	~<„©uªs.h
>

55 
	~<Ωc/Ωc_msg.h
>

57 
__BEGIN_DECLS


81 
	ex¥t_°©
 {

82 
	mXPRT_DIED
,

83 
	mXPRT_MOREREQS
,

84 
	mXPRT_IDLE


90 
SVCXPRT
 
	tSVCXPRT
;

91 
	sSVCXPRT
 {

92 
	mxp_sock
;

93 
u_sh‹t
 
	mxp_p‹t
;

94 c⁄° 
	sxp_›s
 {

95 
boﬁ_t
 (*
xp_ªcv
Ë(
SVCXPRT
 *
	m__x¥t
, 
Ωc_msg
 *
	m__msg
);

97 
x¥t_°©
 (*
xp_°©
Ë(
SVCXPRT
 *
	m__x¥t
);

99 
boﬁ_t
 (*
xp_gë¨gs
Ë(
SVCXPRT
 *
	m__x¥t
, 
xdΩroc_t
 
	m__xdr_¨gs
,

100 
ˇddr_t
 
	m__¨gs_±r
);

101 
boﬁ_t
 (*
xp_ª∂y
Ë(
SVCXPRT
 *
	m__x¥t
, 
Ωc_msg
 *
	m__msg
);

103 
boﬁ_t
 (*
xp_‰ì¨gs
Ë(
SVCXPRT
 *
	m__x¥t
, 
xdΩroc_t
 
	m__xdr_¨gs
,

104 
ˇddr_t
 
	m__¨gs_±r
);

106 (*
	mxp_de°roy
Ë(
SVCXPRT
 *
	m__x¥t
);

108 } *
	mxp_›s
;

109 
	mxp_addæí
;

110 
sockaddr_ö
 
	mxp_øddr
;

111 
›aque_auth
 
	mxp_vîf
;

112 
ˇddr_t
 
	mxp_p1
;

113 
ˇddr_t
 
	mxp_p2
;

114 
	mxp_∑d
 [256];

120 
	#svc_gëˇŒî
(
x
Ë(&(x)->
xp_øddr
)

	)

130 
	#SVC_RECV
(
x¥t
, 
msg
) \

131 (*(
x¥t
)->
xp_›s
->
xp_ªcv
)((x¥t), (
msg
))

	)

132 
	#svc_ªcv
(
x¥t
, 
msg
) \

133 (*(
x¥t
)->
xp_›s
->
xp_ªcv
)((x¥t), (
msg
))

	)

135 
	#SVC_STAT
(
x¥t
) \

136 (*(
x¥t
)->
xp_›s
->
xp_°©
)(x¥t)

	)

137 
	#svc_°©
(
x¥t
) \

138 (*(
x¥t
)->
xp_›s
->
xp_°©
)(x¥t)

	)

140 
	#SVC_GETARGS
(
x¥t
, 
x¨gs
, 
¨g•
) \

141 (*(
x¥t
)->
xp_›s
->
xp_gë¨gs
)((x¥t), (
x¨gs
), (
¨g•
))

	)

142 
	#svc_gë¨gs
(
x¥t
, 
x¨gs
, 
¨g•
) \

143 (*(
x¥t
)->
xp_›s
->
xp_gë¨gs
)((x¥t), (
x¨gs
), (
¨g•
))

	)

145 
	#SVC_REPLY
(
x¥t
, 
msg
) \

146 (*(
x¥t
)->
xp_›s
->
xp_ª∂y
Ë((x¥t), (
msg
))

	)

147 
	#svc_ª∂y
(
x¥t
, 
msg
) \

148 (*(
x¥t
)->
xp_›s
->
xp_ª∂y
Ë((x¥t), (
msg
))

	)

150 
	#SVC_FREEARGS
(
x¥t
, 
x¨gs
, 
¨g•
) \

151 (*(
x¥t
)->
xp_›s
->
xp_‰ì¨gs
)((x¥t), (
x¨gs
), (
¨g•
))

	)

152 
	#svc_‰ì¨gs
(
x¥t
, 
x¨gs
, 
¨g•
) \

153 (*(
x¥t
)->
xp_›s
->
xp_‰ì¨gs
)((x¥t), (
x¨gs
), (
¨g•
))

	)

155 
	#SVC_DESTROY
(
x¥t
) \

156 (*(
x¥t
)->
xp_›s
->
xp_de°roy
)(x¥t)

	)

157 
	#svc_de°roy
(
x¥t
) \

158 (*(
x¥t
)->
xp_›s
->
xp_de°roy
)(x¥t)

	)

164 
	ssvc_ªq
 {

165 
Ω˝rog_t
 
	mrq_¥og
;

166 
Ωcvîs_t
 
	mrq_vîs
;

167 
Ω˝roc_t
 
	mrq_¥oc
;

168 
›aque_auth
 
	mrq_¸ed
;

169 
ˇddr_t
 
	mrq_˛¡¸ed
;

170 
SVCXPRT
 *
	mrq_x¥t
;

173 #i‚de‡
__DISPATCH_FN_T


174 
	#__DISPATCH_FN_T


	)

175 (*
	t__di•©ch_‚_t
Ë(
	tsvc_ªq
*, 
	tSVCXPRT
*);

188 
boﬁ_t
 
	$svc_ªgi°î
 (
SVCXPRT
 *
__x¥t
, 
Ω˝rog_t
 
__¥og
,

189 
Ωcvîs_t
 
__vîs
, 
__di•©ch_‚_t
 
__di•©ch
,

190 
Ω˝rŸ_t
 
__¥Ÿocﬁ
Ë
__THROW
;

199 
	$svc_uƒegi°î
 (
Ω˝rog_t
 
__¥og
, 
Ωcvîs_t
 
__vîs
Ë
__THROW
;

207 
	$x¥t_ªgi°î
 (
SVCXPRT
 *
__x¥t
Ë
__THROW
;

215 
	$x¥t_uƒegi°î
 (
SVCXPRT
 *
__x¥t
Ë
__THROW
;

244 
boﬁ_t
 
	$svc_£ndª∂y
 (
SVCXPRT
 *
__x¥t
, 
xdΩroc_t
 
__xdr_ªsu…s
,

245 
ˇddr_t
 
__xdr_loˇti⁄
Ë
__THROW
;

247 
	$sv˚º_decode
 (
SVCXPRT
 *
__x¥t
Ë
__THROW
;

249 
	$sv˚º_wókauth
 (
SVCXPRT
 *
__x¥t
Ë
__THROW
;

251 
	$sv˚º_n›roc
 (
SVCXPRT
 *
__x¥t
Ë
__THROW
;

253 
	$sv˚º_¥ogvîs
 (
SVCXPRT
 *
__x¥t
, 
Ωcvîs_t
 
__low_vîs
,

254 
Ωcvîs_t
 
__high_vîs
Ë
__THROW
;

256 
	$sv˚º_auth
 (
SVCXPRT
 *
__x¥t
, 
auth_°©
 
__why
Ë
__THROW
;

258 
	$sv˚º_n›rog
 (
SVCXPRT
 *
__x¥t
Ë
__THROW
;

260 
	$sv˚º_sy°emîr
 (
SVCXPRT
 *
__x¥t
Ë
__THROW
;

278 
pﬁlfd
 *
svc_pﬁlfd
;

279 
svc_max_pﬁlfd
;

280 
fd_£t
 
svc_fd£t
;

281 
	#svc_fds
 
svc_fd£t
.
fds_bôs
[0]

	)

287 
	$svc_gëªq
 (
__rdfds
Ë
__THROW
;

288 
	$svc_gëªq_comm⁄
 (c⁄° 
__fd
Ë
__THROW
;

289 
	$svc_gëªq£t
 (
fd_£t
 *
__ªadfds
Ë
__THROW
;

290 
	$svc_gëªq_pﬁl
 (
pﬁlfd
 *, c⁄° Ë
__THROW
;

291 
	$svc_exô
 (Ë
__THROW
;

292 
	$svc_run
 (Ë
__THROW
;

297 
	#RPC_ANYSOCK
 -1

	)

306 
SVCXPRT
 *
	$sv¸aw_¸óã
 (Ë
__THROW
;

311 
SVCXPRT
 *
	$svcudp_¸óã
 (
__sock
Ë
__THROW
;

312 
SVCXPRT
 *
	$svcudp_buf¸óã
 (
__sock
, 
u_öt
 
__£ndsz
, u_öà
__ªcvsz
)

313 
__THROW
;

318 
SVCXPRT
 *
	$sv˘˝_¸óã
 (
__sock
, 
u_öt
 
__£ndsize
, u_öà
__ªcvsize
)

319 
__THROW
;

324 
SVCXPRT
 *
	$svcfd_¸óã
 (
__sock
, 
u_öt
 
__£ndsize
, u_öà
__ªcvsize
)

325 
__THROW
;

330 
SVCXPRT
 *
	$svcunix_¸óã
 (
__sock
, 
u_öt
 
__£ndsize
, u_öà
__ªcvsize
,

331 *
__∑th
Ë
__THROW
;

334 
__END_DECLS


	@/usr/include/rpc/svc_auth.h

34 #i‚de‡
_RPC_SVC_AUTH_H


35 
	#_RPC_SVC_AUTH_H
 1

	)

37 
	~<„©uªs.h
>

38 
	~<Ωc/svc.h
>

40 
__BEGIN_DECLS


45 
auth_°©
 
	$_authítiˇã
 (
svc_ªq
 *
__rq°
,

46 
Ωc_msg
 *
__msg
Ë
__THROW
;

48 
__END_DECLS


	@/usr/include/rpc/types.h

34 #i‚de‡
_RPC_TYPES_H


35 
	#_RPC_TYPES_H
 1

	)

37 
	tboﬁ_t
;

38 
	tíum_t
;

40 
	tΩ˝rog_t
;

41 
	tΩcvîs_t
;

42 
	tΩ˝roc_t
;

43 
	tΩ˝rŸ_t
;

44 
	tΩ˝‹t_t
;

46 
	#__d⁄tˇª__
 -1

	)

48 #i‚de‡
FALSE


49 
	#FALSE
 (0)

	)

52 #i‚de‡
TRUE


53 
	#TRUE
 (1)

	)

56 #i‚de‡
NULL


57 
	#NULL
 0

	)

60 
	~<°dlib.h
>

61 
	#mem_Æloc
(
bsize
Ë
	`mÆloc
(bsize)

	)

66 
	#mem_‰ì
(
±r
, 
bsize
Ë
	`‰ì
’å)

	)

68 #i‚de‡
makedev


69 
	~<sys/ty≥s.h
>

72 #i‡
deföed
 
__APPLE_CC__
 || deföed 
__FªeBSD__


73 
	#__u_ch¨_deföed


	)

74 
	#__daddr_t_deföed


	)

77 #i‚de‡
__u_ch¨_deföed


78 
__u_ch¨
 
	tu_ch¨
;

79 
__u_sh‹t
 
	tu_sh‹t
;

80 
__u_öt
 
	tu_öt
;

81 
__u_l⁄g
 
	tu_l⁄g
;

82 
__quad_t
 
	tquad_t
;

83 
__u_quad_t
 
	tu_quad_t
;

84 
__fsid_t
 
	tfsid_t
;

85 
	#__u_ch¨_deföed


	)

87 #i‚de‡
__daddr_t_deföed


88 
__daddr_t
 
	tdaddr_t
;

89 
__ˇddr_t
 
	tˇddr_t
;

90 
	#__daddr_t_deföed


	)

93 
	~<sys/time.h
>

94 
	~<sys/∑øm.h
>

96 
	~<√töë/ö.h
>

98 #i‚de‡
INADDR_LOOPBACK


99 
	#INADDR_LOOPBACK
 (
u_l⁄g
)0x7F000001

	)

101 #i‚de‡
MAXHOSTNAMELEN


102 
	#MAXHOSTNAMELEN
 64

	)

	@/usr/include/rpc/xdr.h

34 #i‚de‡
_RPC_XDR_H


35 
	#_RPC_XDR_H
 1

	)

37 
	~<„©uªs.h
>

38 
	~<sys/ty≥s.h
>

39 
	~<Ωc/ty≥s.h
>

42 
	~<°dio.h
>

44 
__BEGIN_DECLS


81 
	exdr_›
 {

82 
	mXDR_ENCODE
 = 0,

83 
	mXDR_DECODE
 = 1,

84 
	mXDR_FREE
 = 2

90 
	#BYTES_PER_XDR_UNIT
 (4)

	)

97 
	#RNDUP
(
x
Ë(((xË+ 
BYTES_PER_XDR_UNIT
 - 1Ë& ~(BYTES_PER_XDR_UNIT - 1))

	)

99 
	#RNDUP
(
x
Ë((((xË+ 
BYTES_PER_XDR_UNIT
 - 1) / BYTES_PER_XDR_UNIT) \

100 * 
BYTES_PER_XDR_UNIT
)

	)

109 
XDR
 
	tXDR
;

110 
	sXDR


112 
xdr_›
 
	mx_›
;

113 
	sxdr_›s


115 
boﬁ_t
 (*
x_gël⁄g
Ë(
XDR
 *
	m__xdrs
, *
	m__Õ
);

117 
boﬁ_t
 (*
x_pué⁄g
Ë(
XDR
 *
	m__xdrs
, c⁄° *
	m__Õ
);

119 
boﬁ_t
 (*
x_gëbyãs
Ë(
XDR
 *
	m__xdrs
, 
ˇddr_t
 
	m__addr
, 
u_öt
 
	m__Àn
);

121 
boﬁ_t
 (*
x_putbyãs
Ë(
XDR
 *
	m__xdrs
, c⁄° *
	m__addr
, 
u_öt
 
	m__Àn
);

123 
u_öt
 (*
x_gëpo°n
Ë(c⁄° 
XDR
 *
	m__xdrs
);

125 
boﬁ_t
 (*
x_£ço°n
Ë(
XDR
 *
	m__xdrs
, 
u_öt
 
	m__pos
);

127 
	möt32_t
 *(*
	mx_ölöe
Ë(
XDR
 *
	m__xdrs
, 
u_öt
 
	m__Àn
);

129 (*
	mx_de°roy
Ë(
XDR
 *
	m__xdrs
);

131 
boﬁ_t
 (*
x_gëöt32
Ë(
XDR
 *
	m__xdrs
, 
öt32_t
 *
	m__ù
);

133 
boﬁ_t
 (*
x_putöt32
Ë(
XDR
 *
	m__xdrs
, c⁄° 
öt32_t
 *
	m__ù
);

136 *
	mx_›s
;

137 
ˇddr_t
 
	mx_public
;

138 
ˇddr_t
 
	mx_¥iv©e
;

139 
ˇddr_t
 
	mx_ba£
;

140 
u_öt
 
	mx_h™dy
;

152 
	$boﬁ_t
 (*
	txdΩroc_t
Ë(
	tXDR
 *, *,...);

165 
	#XDR_GETINT32
(
xdrs
, 
öt32p
) \

166 (*(
xdrs
)->
x_›s
->
x_gëöt32
)(xdrs, 
öt32p
)

	)

167 
	#xdr_gëöt32
(
xdrs
, 
öt32p
) \

168 (*(
xdrs
)->
x_›s
->
x_gëöt32
)(xdrs, 
öt32p
)

	)

170 
	#XDR_PUTINT32
(
xdrs
, 
öt32p
) \

171 (*(
xdrs
)->
x_›s
->
x_putöt32
)(xdrs, 
öt32p
)

	)

172 
	#xdr_putöt32
(
xdrs
, 
öt32p
) \

173 (*(
xdrs
)->
x_›s
->
x_putöt32
)(xdrs, 
öt32p
)

	)

175 
	#XDR_GETLONG
(
xdrs
, 
l⁄gp
) \

176 (*(
xdrs
)->
x_›s
->
x_gël⁄g
)(xdrs, 
l⁄gp
)

	)

177 
	#xdr_gël⁄g
(
xdrs
, 
l⁄gp
) \

178 (*(
xdrs
)->
x_›s
->
x_gël⁄g
)(xdrs, 
l⁄gp
)

	)

180 
	#XDR_PUTLONG
(
xdrs
, 
l⁄gp
) \

181 (*(
xdrs
)->
x_›s
->
x_pué⁄g
)(xdrs, 
l⁄gp
)

	)

182 
	#xdr_pué⁄g
(
xdrs
, 
l⁄gp
) \

183 (*(
xdrs
)->
x_›s
->
x_pué⁄g
)(xdrs, 
l⁄gp
)

	)

185 
	#XDR_GETBYTES
(
xdrs
, 
addr
, 
Àn
) \

186 (*(
xdrs
)->
x_›s
->
x_gëbyãs
)(xdrs, 
addr
, 
Àn
)

	)

187 
	#xdr_gëbyãs
(
xdrs
, 
addr
, 
Àn
) \

188 (*(
xdrs
)->
x_›s
->
x_gëbyãs
)(xdrs, 
addr
, 
Àn
)

	)

190 
	#XDR_PUTBYTES
(
xdrs
, 
addr
, 
Àn
) \

191 (*(
xdrs
)->
x_›s
->
x_putbyãs
)(xdrs, 
addr
, 
Àn
)

	)

192 
	#xdr_putbyãs
(
xdrs
, 
addr
, 
Àn
) \

193 (*(
xdrs
)->
x_›s
->
x_putbyãs
)(xdrs, 
addr
, 
Àn
)

	)

195 
	#XDR_GETPOS
(
xdrs
) \

196 (*(
xdrs
)->
x_›s
->
x_gëpo°n
)(xdrs)

	)

197 
	#xdr_gëpos
(
xdrs
) \

198 (*(
xdrs
)->
x_›s
->
x_gëpo°n
)(xdrs)

	)

200 
	#XDR_SETPOS
(
xdrs
, 
pos
) \

201 (*(
xdrs
)->
x_›s
->
x_£ço°n
)(xdrs, 
pos
)

	)

202 
	#xdr_£ços
(
xdrs
, 
pos
) \

203 (*(
xdrs
)->
x_›s
->
x_£ço°n
)(xdrs, 
pos
)

	)

205 
	#XDR_INLINE
(
xdrs
, 
Àn
) \

206 (*(
xdrs
)->
x_›s
->
x_ölöe
)(xdrs, 
Àn
)

	)

207 
	#xdr_ölöe
(
xdrs
, 
Àn
) \

208 (*(
xdrs
)->
x_›s
->
x_ölöe
)(xdrs, 
Àn
)

	)

210 
	#XDR_DESTROY
(
xdrs
) \

212 i‡((
xdrs
)->
x_›s
->
x_de°roy
) \

213 (*(
xdrs
)->
x_›s
->
x_de°roy
)(xdrs); \

214 
	}
} 0)

	)

215 
	#xdr_de°roy
(
xdrs
) \

217 i‡((
xdrs
)->
x_›s
->
x_de°roy
) \

218 (*(
xdrs
)->
x_›s
->
x_de°roy
)(xdrs); \

219 } 0)

	)

231 
	#NULL_xdΩroc_t
 ((
xdΩroc_t
)0)

	)

232 
	sxdr_dis¸im


234 
	mvÆue
;

235 
xdΩroc_t
 
	m¥oc
;

254 
	#IXDR_GET_INT32
(
buf
Ë((
öt32_t
)
	`¡ohl
((
uöt32_t
)*(buf)++))

	)

255 
	#IXDR_PUT_INT32
(
buf
, 
v
Ë(*(buf)++ = (
öt32_t
)
	`ht⁄l
((
uöt32_t
)(v)))

	)

256 
	#IXDR_GET_U_INT32
(
buf
Ë((
uöt32_t
)
	`IXDR_GET_INT32
(buf))

	)

257 
	#IXDR_PUT_U_INT32
(
buf
, 
v
Ë
	`IXDR_PUT_INT32
(buf, (
öt32_t
)(v))

	)

263 
	#IXDR_GET_LONG
(
buf
Ë(()
	`IXDR_GET_U_INT32
(buf))

	)

264 
	#IXDR_PUT_LONG
(
buf
, 
v
Ë(()
	`IXDR_PUT_INT32
(buf, ()(v)))

	)

265 
	#IXDR_GET_U_LONG
(
buf
Ë((
u_l⁄g
)
	`IXDR_GET_LONG
(buf))

	)

266 
	#IXDR_PUT_U_LONG
(
buf
, 
v
Ë
	`IXDR_PUT_LONG
(buf, ()(v))

	)

269 
	#IXDR_GET_BOOL
(
buf
Ë((
boﬁ_t
)
	`IXDR_GET_LONG
(buf))

	)

270 
	#IXDR_GET_ENUM
(
buf
, 
t
Ë(—)
	`IXDR_GET_LONG
(buf))

	)

271 
	#IXDR_GET_SHORT
(
buf
Ë(()
	`IXDR_GET_LONG
(buf))

	)

272 
	#IXDR_GET_U_SHORT
(
buf
Ë((
u_sh‹t
)
	`IXDR_GET_LONG
(buf))

	)

274 
	#IXDR_PUT_BOOL
(
buf
, 
v
Ë
	`IXDR_PUT_LONG
(buf, ()(v))

	)

275 
	#IXDR_PUT_ENUM
(
buf
, 
v
Ë
	`IXDR_PUT_LONG
(buf, ()(v))

	)

276 
	#IXDR_PUT_SHORT
(
buf
, 
v
Ë
	`IXDR_PUT_LONG
(buf, ()(v))

	)

277 
	#IXDR_PUT_U_SHORT
(
buf
, 
v
Ë
	`IXDR_PUT_LONG
(buf, ()(v))

	)

285 
boﬁ_t
 
	$xdr_void
 (Ë
__THROW
;

286 
boﬁ_t
 
	$xdr_sh‹t
 (
XDR
 *
__xdrs
, *
__•
Ë
__THROW
;

287 
boﬁ_t
 
	$xdr_u_sh‹t
 (
XDR
 *
__xdrs
, 
u_sh‹t
 *
__u•
Ë
__THROW
;

288 
boﬁ_t
 
	$xdr_öt
 (
XDR
 *
__xdrs
, *
__ù
Ë
__THROW
;

289 
boﬁ_t
 
	$xdr_u_öt
 (
XDR
 *
__xdrs
, 
u_öt
 *
__up
Ë
__THROW
;

290 
boﬁ_t
 
	$xdr_l⁄g
 (
XDR
 *
__xdrs
, *
__Õ
Ë
__THROW
;

291 
boﬁ_t
 
	$xdr_u_l⁄g
 (
XDR
 *
__xdrs
, 
u_l⁄g
 *
__uÕ
Ë
__THROW
;

292 
boﬁ_t
 
	$xdr_hy≥r
 (
XDR
 *
__xdrs
, 
quad_t
 *
__Œp
Ë
__THROW
;

293 
boﬁ_t
 
	$xdr_u_hy≥r
 (
XDR
 *
__xdrs
, 
u_quad_t
 *
__uŒp
Ë
__THROW
;

294 
boﬁ_t
 
	$xdr_l⁄gl⁄g_t
 (
XDR
 *
__xdrs
, 
quad_t
 *
__Œp
Ë
__THROW
;

295 
boﬁ_t
 
	$xdr_u_l⁄gl⁄g_t
 (
XDR
 *
__xdrs
, 
u_quad_t
 *
__uŒp
Ë
__THROW
;

296 
boﬁ_t
 
	$xdr_öt8_t
 (
XDR
 *
__xdrs
, 
öt8_t
 *
__ù
Ë
__THROW
;

297 
boﬁ_t
 
	$xdr_uöt8_t
 (
XDR
 *
__xdrs
, 
uöt8_t
 *
__up
Ë
__THROW
;

298 
boﬁ_t
 
	$xdr_öt16_t
 (
XDR
 *
__xdrs
, 
öt16_t
 *
__ù
Ë
__THROW
;

299 
boﬁ_t
 
	$xdr_uöt16_t
 (
XDR
 *
__xdrs
, 
uöt16_t
 *
__up
Ë
__THROW
;

300 
boﬁ_t
 
	$xdr_öt32_t
 (
XDR
 *
__xdrs
, 
öt32_t
 *
__ù
Ë
__THROW
;

301 
boﬁ_t
 
	$xdr_uöt32_t
 (
XDR
 *
__xdrs
, 
uöt32_t
 *
__up
Ë
__THROW
;

302 
boﬁ_t
 
	$xdr_öt64_t
 (
XDR
 *
__xdrs
, 
öt64_t
 *
__ù
Ë
__THROW
;

303 
boﬁ_t
 
	$xdr_uöt64_t
 (
XDR
 *
__xdrs
, 
uöt64_t
 *
__up
Ë
__THROW
;

304 
boﬁ_t
 
	$xdr_quad_t
 (
XDR
 *
__xdrs
, 
quad_t
 *
__ù
Ë
__THROW
;

305 
boﬁ_t
 
	$xdr_u_quad_t
 (
XDR
 *
__xdrs
, 
u_quad_t
 *
__up
Ë
__THROW
;

306 
boﬁ_t
 
	$xdr_boﬁ
 (
XDR
 *
__xdrs
, 
boﬁ_t
 *
__bp
Ë
__THROW
;

307 
boﬁ_t
 
	$xdr_íum
 (
XDR
 *
__xdrs
, 
íum_t
 *
__ï
Ë
__THROW
;

308 
boﬁ_t
 
	$xdr_¨øy
 (
XDR
 * 
_xdrs
, 
ˇddr_t
 *
__addΩ
, 
u_öt
 *
__sizï
,

309 
u_öt
 
__maxsize
, u_öà
__ñsize
, 
xdΩroc_t
 
__ñ¥oc
)

310 
__THROW
;

311 
boﬁ_t
 
	$xdr_byãs
 (
XDR
 *
__xdrs
, **
__˝p
, 
u_öt
 *
__sizï
,

312 
u_öt
 
__maxsize
Ë
__THROW
;

313 
boﬁ_t
 
	$xdr_›aque
 (
XDR
 *
__xdrs
, 
ˇddr_t
 
__˝
, 
u_öt
 
__˙t
Ë
__THROW
;

314 
boﬁ_t
 
	$xdr_°rög
 (
XDR
 *
__xdrs
, **
__˝p
, 
u_öt
 
__maxsize
Ë
__THROW
;

315 
boﬁ_t
 
	$xdr_uni⁄
 (
XDR
 *
__xdrs
, 
íum_t
 *
__dscmp
, *
__u≈
,

316 c⁄° 
xdr_dis¸im
 *
__choi˚s
,

317 
xdΩroc_t
 
__dÁu…
Ë
__THROW
;

318 
boﬁ_t
 
	$xdr_ch¨
 (
XDR
 *
__xdrs
, *
__˝
Ë
__THROW
;

319 
boﬁ_t
 
	$xdr_u_ch¨
 (
XDR
 *
__xdrs
, 
u_ch¨
 *
__˝
Ë
__THROW
;

320 
boﬁ_t
 
	$xdr_ve˘‹
 (
XDR
 *
__xdrs
, *
__ba£p
, 
u_öt
 
__√Àm
,

321 
u_öt
 
__ñemsize
, 
xdΩroc_t
 
__xdr_ñem
Ë
__THROW
;

322 
boﬁ_t
 
	$xdr_Êﬂt
 (
XDR
 *
__xdrs
, *
__Â
Ë
__THROW
;

323 
boﬁ_t
 
	$xdr_doubÀ
 (
XDR
 *
__xdrs
, *
__dp
Ë
__THROW
;

324 
boﬁ_t
 
	$xdr_ª„ªn˚
 (
XDR
 *
__xdrs
, 
ˇddr_t
 *
__xµ
, 
u_öt
 
__size
,

325 
xdΩroc_t
 
__¥oc
Ë
__THROW
;

326 
boﬁ_t
 
	$xdr_poöãr
 (
XDR
 *
__xdrs
, **
__objµ
,

327 
u_öt
 
__obj_size
, 
xdΩroc_t
 
__xdr_obj
Ë
__THROW
;

328 
boﬁ_t
 
	$xdr_wøp°rög
 (
XDR
 *
__xdrs
, **
__˝p
Ë
__THROW
;

329 
u_l⁄g
 
	$xdr_sizeof
 (
xdΩroc_t
, *Ë
__THROW
;

335 
	#MAX_NETOBJ_SZ
 1024

	)

336 
	s√tobj


338 
u_öt
 
n_Àn
;

339 *
n_byãs
;

341 
√tobj
 
	t√tobj
;

342 
boﬁ_t
 
	$xdr_√tobj
 (
XDR
 *
__xdrs
, 
√tobj
 *
__≈
Ë
__THROW
;

350 
	$xdrmem_¸óã
 (
XDR
 *
__xdrs
, c⁄° 
ˇddr_t
 
__addr
,

351 
u_öt
 
__size
, 
xdr_›
 
__x›
Ë
__THROW
;

354 
	$xdr°dio_¸óã
 (
XDR
 *
__xdrs
, 
FILE
 *
__fûe
, 
xdr_›
 
__x›
)

355 
__THROW
;

358 
	`xdºec_¸óã
 (
XDR
 *
__xdrs
, 
u_öt
 
__£ndsize
,

359 
u_öt
 
__ªcvsize
, 
ˇddr_t
 
__t˝_h™dÀ
,

360 (*
__ªadô
) (*, *, ),

361 (*
__wrôeô
Ë(*, *, )Ë
__THROW
;

364 
boﬁ_t
 
	$xdºec_ído‰ec‹d
 (
XDR
 *
__xdrs
, 
boﬁ_t
 
__£ndnow
Ë
__THROW
;

367 
boﬁ_t
 
	$xdºec_skùªc‹d
 (
XDR
 *
__xdrs
Ë
__THROW
;

370 
boﬁ_t
 
	$xdºec_eof
 (
XDR
 *
__xdrs
Ë
__THROW
;

373 
	$xdr_‰ì
 (
xdΩroc_t
 
__¥oc
, *
__objp
Ë
__THROW
;

375 
__END_DECLS


	@/usr/include/stdint.h

22 #i‚de‡
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/wch¨.h
>

27 
	~<bôs/w‹dsize.h
>

34 #i‚de‡
__öt8_t_deföed


35 
	#__öt8_t_deföed


	)

36 sig√d 
	töt8_t
;

37 
	töt16_t
;

38 
	töt32_t
;

39 #i‡
__WORDSIZE
 == 64

40 
	töt64_t
;

42 
__exãnsi⁄__


43 
	töt64_t
;

48 
	tuöt8_t
;

49 
	tuöt16_t
;

50 #i‚de‡
__uöt32_t_deföed


51 
	tuöt32_t
;

52 
	#__uöt32_t_deföed


	)

54 #i‡
__WORDSIZE
 == 64

55 
	tuöt64_t
;

57 
__exãnsi⁄__


58 
	tuöt64_t
;

65 sig√d 
	töt_Àa°8_t
;

66 
	töt_Àa°16_t
;

67 
	töt_Àa°32_t
;

68 #i‡
__WORDSIZE
 == 64

69 
	töt_Àa°64_t
;

71 
__exãnsi⁄__


72 
	töt_Àa°64_t
;

76 
	tuöt_Àa°8_t
;

77 
	tuöt_Àa°16_t
;

78 
	tuöt_Àa°32_t
;

79 #i‡
__WORDSIZE
 == 64

80 
	tuöt_Àa°64_t
;

82 
__exãnsi⁄__


83 
	tuöt_Àa°64_t
;

90 sig√d 
	töt_Á°8_t
;

91 #i‡
__WORDSIZE
 == 64

92 
	töt_Á°16_t
;

93 
	töt_Á°32_t
;

94 
	töt_Á°64_t
;

96 
	töt_Á°16_t
;

97 
	töt_Á°32_t
;

98 
__exãnsi⁄__


99 
	töt_Á°64_t
;

103 
	tuöt_Á°8_t
;

104 #i‡
__WORDSIZE
 == 64

105 
	tuöt_Á°16_t
;

106 
	tuöt_Á°32_t
;

107 
	tuöt_Á°64_t
;

109 
	tuöt_Á°16_t
;

110 
	tuöt_Á°32_t
;

111 
__exãnsi⁄__


112 
	tuöt_Á°64_t
;

117 #i‡
__WORDSIZE
 == 64

118 #i‚de‡
__öçå_t_deföed


119 
	töçå_t
;

120 
	#__öçå_t_deföed


	)

122 
	tuöçå_t
;

124 #i‚de‡
__öçå_t_deföed


125 
	töçå_t
;

126 
	#__öçå_t_deföed


	)

128 
	tuöçå_t
;

133 #i‡
__WORDSIZE
 == 64

134 
	tötmax_t
;

135 
	tuötmax_t
;

137 
__exãnsi⁄__


138 
	tötmax_t
;

139 
__exãnsi⁄__


140 
	tuötmax_t
;

144 #i‡
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
Ë¯## 
L


	)

146 
	#__UINT64_C
(
c
Ë¯## 
UL


	)

148 
	#__INT64_C
(
c
Ë¯## 
LL


	)

149 
	#__UINT64_C
(
c
Ë¯## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #i‡
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #i‡
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #i‡
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #i‡
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #i‡
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #i‡
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 
	#SIZE_MAX
 (4294967295U)

	)

267 #i‚de‡
WCHAR_MIN


269 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

270 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

274 
	#WINT_MIN
 (0u)

	)

275 
	#WINT_MAX
 (4294967295u)

	)

278 
	#INT8_C
(
c
Ë
	)
c

279 
	#INT16_C
(
c
Ë
	)
c

280 
	#INT32_C
(
c
Ë
	)
c

281 #i‡
__WORDSIZE
 == 64

282 
	#INT64_C
(
c
Ë¯## 
L


	)

284 
	#INT64_C
(
c
Ë¯## 
LL


	)

288 
	#UINT8_C
(
c
Ë
	)
c

289 
	#UINT16_C
(
c
Ë
	)
c

290 
	#UINT32_C
(
c
Ë¯## 
U


	)

291 #i‡
__WORDSIZE
 == 64

292 
	#UINT64_C
(
c
Ë¯## 
UL


	)

294 
	#UINT64_C
(
c
Ë¯## 
ULL


	)

298 #i‡
__WORDSIZE
 == 64

299 
	#INTMAX_C
(
c
Ë¯## 
L


	)

300 
	#UINTMAX_C
(
c
Ë¯## 
UL


	)

302 
	#INTMAX_C
(
c
Ë¯## 
LL


	)

303 
	#UINTMAX_C
(
c
Ë¯## 
ULL


	)

	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

23 
__off_t
 
	m__pos
;

24 
__mb°©e_t
 
	m__°©e
;

25 } 
	t_G_Âos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb°©e_t
 
	m__°©e
;

30 } 
	t_G_Âos64_t
;

31 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gc⁄v.h
>

35 
__gc⁄v_öfo
 
	m__cd
;

38 
__gc⁄v_öfo
 
	m__cd
;

39 
__gc⁄v_°ï_d©a
 
	m__d©a
;

40 } 
	m__comböed
;

41 } 
	t_G_ic⁄v_t
;

46 
	#_G_va_li°
 
__gnuc_va_li°


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/ldap_cdefs.h

17 #i‚de‡
_LDAP_CDEFS_H


18 
	#_LDAP_CDEFS_H


	)

20 #i‡
deföed
(
__˝lu•lus
Ë|| deföed(
c_∂u•lus
)

21 
	#LDAP_BEGIN_DECL
 "C" {

	)

22 
	#LDAP_END_DECL
 }

	)

24 
	#LDAP_BEGIN_DECL


	)

25 
	#LDAP_END_DECL


	)

28 #i‡!
deföed
(
LDAP_NO_PROTOTYPES
Ë&& ( deföed(
LDAP_NEEDS_PROTOTYPES
) || \

29 
deföed
(
__STDC__
Ë|| deföed(
__˝lu•lus
Ë|| 
	$deföed
(
c_∂u•lus
) )

32 
	#LDAP_P
(
¥Ÿos
Ë
	)
protos

33 
	#LDAP_CONCAT1
(
x
,
y
Ëx ## 
	)
y

34 
	#LDAP_CONCAT
(
x
,
y
Ë
	`LDAP_CONCAT1
(x,y)

	)

35 
	#LDAP_STRING
(
x
Ë#x

	)

36 
	#LDAP_XSTRING
(
x
Ë
	`LDAP_STRING
(xË

	)

38 #i‚de‡
LDAP_CONST


39 
	#LDAP_CONST
 c⁄°

	)

45 
	#LDAP_P
(
¥Ÿos
Ë()

	)

46 
	#LDAP_CONCAT
(
x
,
y
Ëx 
	)
y

47 
	#LDAP_STRING
(
x
Ë"x"

	)

49 #i‚de‡
LDAP_CONST


50 
	#LDAP_CONST


	)

55 #i‡(
__GNUC__
Ë* 1000 + (
__GNUC_MINOR__
) >= 2006

56 
	#LDAP_GCCATTR
(
©ås
Ë
	`__©åibuã__
◊ârs)

	)

58 
	#LDAP_GCCATTR
(
©ås
)

	)

130 #i‡
	`deföed
(
_WIN32
) && \

131 ((
	`deföed
(
LDAP_LIBS_DYNAMIC
Ë&& !deföed(
LBER_LIBRARY
)) || \

132 (!
	`deföed
(
LDAP_LIBS_DYNAMIC
Ë&& 
	$deföed
(
SLAPD_IMPORT
)))

133 
	#LBER_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

134 
	#LBER_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

136 
	#LBER_F
(
ty≥
Ë
	)
type

137 
	#LBER_V
(
ty≥
Ë
	)
type

141 #i‡
	`deföed
(
_WIN32
) && \

142 ((
	`deföed
(
LDAP_LIBS_DYNAMIC
Ë&& !deföed(
LDAP_LIBRARY
)) || \

143 (!
	`deföed
(
LDAP_LIBS_DYNAMIC
Ë&& 
	$deföed
(
SLAPD_IMPORT
)))

144 
	#LDAP_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

145 
	#LDAP_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

147 
	#LDAP_F
(
ty≥
Ë
	)
type

148 
	#LDAP_V
(
ty≥
Ë
	)
type

152 #i‡
	`deföed
(
_WIN32
Ë&& deföed(
SLAPD_IMPORT
)

153 
	#LDAP_AVL_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

154 
	#LDAP_AVL_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

156 
	#LDAP_AVL_F
(
ty≥
Ë
	)
type

157 
	#LDAP_AVL_V
(
ty≥
Ë
	)
type

161 #i‡
	`deföed
(
_WIN32
Ë&& deföed(
SLAPD_IMPORT
)

162 
	#LDAP_LDIF_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

163 
	#LDAP_LDIF_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

165 
	#LDAP_LDIF_F
(
ty≥
Ë
	)
type

166 
	#LDAP_LDIF_V
(
ty≥
Ë
	)
type

170 #i‡
	`deföed
(
_WIN32
Ë&& deföed(
SLAPD_IMPORT
)

171 
	#LDAP_LUNICODE_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

172 
	#LDAP_LUNICODE_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

174 
	#LDAP_LUNICODE_F
(
ty≥
Ë
	)
type

175 
	#LDAP_LUNICODE_V
(
ty≥
Ë
	)
type

179 #i‡
	`deföed
(
_WIN32
Ë&& deföed(
SLAPD_IMPORT
)

180 
	#LDAP_LUTIL_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

181 
	#LDAP_LUTIL_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

183 
	#LDAP_LUTIL_F
(
ty≥
Ë
	)
type

184 
	#LDAP_LUTIL_V
(
ty≥
Ë
	)
type

188 #i‡
	`deföed
(
_WIN32
Ë&& deföed(
SLAPD_IMPORT
)

189 
	#LDAP_REWRITE_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

190 
	#LDAP_REWRITE_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

192 
	#LDAP_REWRITE_F
(
ty≥
Ë
	)
type

193 
	#LDAP_REWRITE_V
(
ty≥
Ë
	)
type

197 #i‡
	`deföed
(
_WIN32
Ë&& deföed(
SLAPD_IMPORT
)

198 
	#LDAP_SLAPD_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

199 
	#LDAP_SLAPD_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

201 
	#LDAP_SLAPD_F
(
ty≥
Ë
	)
type

202 
	#LDAP_SLAPD_V
(
ty≥
Ë
	)
type

206 #i‡
	`deföed
(
_WIN32
Ë&& deföed(
SLAPD_IMPORT
)

207 
	#LDAP_SLAPI_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

208 
	#LDAP_SLAPI_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

210 
	#LDAP_SLAPI_F
(
ty≥
Ë
	)
type

211 
	#LDAP_SLAPI_V
(
ty≥
Ë
	)
type

215 #i‡
	`deföed
(
_WIN32
Ë&& deföed(
SLAPD_IMPORT
)

216 
	#SLAPI_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

217 
	#SLAPI_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

219 
	#SLAPI_F
(
ty≥
Ë
	)
type

220 
	#SLAPI_V
(
ty≥
Ë
	)
type

239 #i‡(
	`deföed
(
__MINGW32__
Ë&& !deföed(
CSTATIC
)) || \

240 (
	`deföed
(
_MSC_VER
Ë&& 
	$deföed
(
_DLL
))

241 
	#LDAP_LIBC_F
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

242 
	#LDAP_LIBC_V
(
ty≥
Ë
	`__de˛•ec
(
dŒimp‹t
Ë
	)
type

244 
	#LDAP_LIBC_F
(
ty≥
Ë
	)
type

245 
	#LDAP_LIBC_V
(
ty≥
Ë
	)
type

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde‡
__GCC_IEC_559


37 #i‡
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde‡
__GCC_IEC_559_COMPLEX


45 #i‡
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/gconv.h

22 #i‚de‡
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<„©uªs.h
>

26 
	#__√ed_mb°©e_t


	)

27 
	#__√ed_wöt_t


	)

28 
	~<wch¨.h
>

29 
	#__√ed_size_t


	)

30 
	#__√ed_wch¨_t


	)

31 
	~<°ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gc⁄v_°ï
;

65 
	g__gc⁄v_°ï_d©a
;

66 
	g__gc⁄v_lﬂded_obje˘
;

67 
	g__gc⁄v_å™s_d©a
;

71 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

79 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

80 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

84 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

85 
	t__gc⁄v_°ï_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
) (*, const *,

97 (*
	t__gc⁄v_å™s_quîy_f˘
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

102 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

104 
	s__gc⁄v_å™s_d©a


107 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

108 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

109 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

110 *
__d©a
;

111 
__gc⁄v_å™s_d©a
 *
__√xt
;

116 
	s__gc⁄v_°ï


118 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

119 c⁄° *
__mod«me
;

121 
__cou¡î
;

123 *
__‰om_«me
;

124 *
__to_«me
;

126 
__gc⁄v_f˘
 
__f˘
;

127 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

128 
__gc⁄v_öô_f˘
 
__öô_f˘
;

129 
__gc⁄v_íd_f˘
 
__íd_f˘
;

133 
__mö_√eded_‰om
;

134 
__max_√eded_‰om
;

135 
__mö_√eded_to
;

136 
__max_√eded_to
;

139 
__°©eful
;

141 *
__d©a
;

146 
	s__gc⁄v_°ï_d©a


148 *
__outbuf
;

149 *
__outbu„nd
;

153 
__Êags
;

157 
__övoˇti⁄_cou¡î
;

161 
__öã∫Æ_u£
;

163 
__mb°©e_t
 *
__°©ï
;

164 
__mb°©e_t
 
__°©e
;

168 
__gc⁄v_å™s_d©a
 *
__å™s
;

173 
	s__gc⁄v_öfo


175 
size_t
 
__n°ïs
;

176 
__gc⁄v_°ï
 *
__°ïs
;

177 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

178 } *
	t__gc⁄v_t
;

	@/usr/include/wchar.h

23 #i‚de‡
_WCHAR_H


25 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<„©uªs.h
>

30 #ifde‡
_WCHAR_H


32 
	#__√ed___FILE


	)

33 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


34 
	#__√ed_FILE


	)

36 
	~<°dio.h
>

38 
	#__√ed___va_li°


	)

39 
	~<°d¨g.h
>

41 
	~<bôs/wch¨.h
>

44 
	#__√ed_size_t


	)

45 
	#__√ed_wch¨_t


	)

46 
	#__√ed_NULL


	)

48 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


49 #unde‡
__√ed_wöt_t


50 
	#__√ed_wöt_t


	)

51 
	~<°ddef.h
>

55 #i‚de‡
_WINT_T


60 
	#_WINT_T


	)

61 
	twöt_t
;

65 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
deföed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twöt_t
;

69 
	g__END_NAMESPACE_STD


74 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
____mb°©e_t_deföed


80 
	#____mb°©e_t_deföed
 1

	)

84 
	m__cou¡
;

87 #ifde‡
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wöt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__vÆue
;

94 } 
	t__mb°©e_t
;

96 #unde‡
__√ed_mb°©e_t


101 #ifde‡
_WCHAR_H


103 #i‚de‡
__mb°©e_t_deföed


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb°©e_t_deföed
 1

	)

111 #ifde‡
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

115 #i‚de‡
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #i‚de‡
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


128 
	~<w˘y≥.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

150 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

151 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

158 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

159 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
)

164 
__THROW
 
__©åibuã_puª__
;

166 
	$wc¢cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©åibuã_puª__
;

168 
__END_NAMESPACE_STD


170 #ifde‡
__USE_XOPEN2K8


172 
	$wcsˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

175 
	$wc¢ˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

176 
size_t
 
__n
Ë
__THROW
;

180 
	~<xloˇÀ.h
>

182 
	$wcsˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

183 
__loˇÀ_t
 
__loc
Ë
__THROW
;

185 
	$wc¢ˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

186 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscﬁl
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

196 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

197 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifde‡
__USE_XOPEN2K8


206 
	$wcscﬁl_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

207 
__loˇÀ_t
 
__loc
Ë
__THROW
;

212 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

213 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

216 
wch¨_t
 *
	$wcsdup
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 "C++" c⁄° 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

227 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

228 
__THROW
 
__©åibuã_puª__
;

231 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

233 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 "C++" c⁄° 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

237 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

238 
__THROW
 
__©åibuã_puª__
;

240 
__END_NAMESPACE_STD


242 #ifde‡
__USE_GNU


245 
wch¨_t
 *
	$wcsch∫ul
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__wc
)

246 
__THROW
 
__©åibuã_puª__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ªje˘
)

253 
__THROW
 
__©åibuã_puª__
;

256 
size_t
 
	$wcs•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

257 
__THROW
 
__©åibuã_puª__
;

259 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

262 "C++" c⁄° 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
,

263 c⁄° 
wch¨_t
 *
__ac˚±
)

264 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

266 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

267 
__THROW
 
__©åibuã_puª__
;

270 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

273 "C++" c⁄° 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
,

274 c⁄° 
wch¨_t
 *
__√edÀ
)

275 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

277 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

278 
__THROW
 
__©åibuã_puª__
;

282 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

283 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

284 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

287 
size_t
 
	$wc¶í
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

288 
__END_NAMESPACE_STD


290 #ifde‡
__USE_XOPEN


292 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

295 "C++" c⁄° 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
,

296 c⁄° 
wch¨_t
 *
__√edÀ
)

297 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

299 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

300 
__THROW
 
__©åibuã_puª__
;

304 #ifde‡
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Àn
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

307 
__THROW
 
__©åibuã_puª__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

316 "C++" c⁄° 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

320 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©åibuã_puª__
;

325 
	$wmemcmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©åibuã_puª__
;

329 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

330 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

334 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifde‡
__USE_GNU


344 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

345 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

357 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

361 
	$mbsöô
 (c⁄° 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

365 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

366 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

367 
mb°©e_t
 *
__ª°ri˘
 
__p
Ë
__THROW
;

370 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

371 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

374 
size_t
 
	$__mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

375 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

376 
size_t
 
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

377 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifde‡
__USE_EXTERN_INLINES


386 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

387 
__exã∫_ölöe
 
wöt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

392 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

393 
__exã∫_ölöe
 

394 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

395 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

396 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

398 
__exã∫_ölöe
 
size_t


399 
__NTH
 (
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

400 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

401 {  (
__ps
 !
NULL


402 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

409 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

410 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

414 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

415 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

416 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

424 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

425 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

429 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

430 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

431 
size_t
 
__nwc
, size_à
__Àn
,

432 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

437 #ifde‡
__USE_XOPEN


439 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

443 
	$wcswidth
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc°od
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

451 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifde‡
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc°of
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

459 
	$wc°ﬁd
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

460 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc°ﬁ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

469 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

473 
	$wc°oul
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

474 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifde‡
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__exãnsi⁄__


483 
	$wc°ﬁl
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

484 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

485 
__THROW
;

489 
__exãnsi⁄__


490 
	$wc°ouŒ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

491 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

492 
__ba£
Ë
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifde‡
__USE_GNU


499 
__exãnsi⁄__


500 
	$wc°oq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

501 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

502 
__THROW
;

506 
__exãnsi⁄__


507 
	$wc°ouq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

508 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

509 
__ba£
Ë
__THROW
;

512 #ifde‡
__USE_GNU


526 
	~<xloˇÀ.h
>

530 
	$wc°ﬁ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

531 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

532 
__loˇÀ_t
 
__loc
Ë
__THROW
;

534 
	$wc°oul_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

535 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

536 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

538 
__exãnsi⁄__


539 
	$wc°ﬁl_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

540 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

541 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

543 
__exãnsi⁄__


544 
	$wc°ouŒ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

545 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

546 
__ba£
, 
__loˇÀ_t
 
__loc
)

547 
__THROW
;

549 
	$wc°od_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

550 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
;

553 
	$wc°of_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

554 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

555 
__THROW
;

557 
	$wc°ﬁd_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

558 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

559 
__loˇÀ_t
 
__loc
Ë
__THROW
;

563 #ifde‡
__USE_XOPEN2K8


566 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

567 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

571 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

572 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

583 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

594 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

595 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

601 
	`w¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

604 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

605 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

606 
__THROW
 ;

612 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

613 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

614 
__gnuc_va_li°
 
__¨g
)

620 
	`vw¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

621 
__gnuc_va_li°
 
__¨g
)

625 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

626 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

627 
__gnuc_va_li°
 
__¨g
)

628 
__THROW
 ;

635 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

636 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

642 
	`wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

645 
	$swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

646 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

647 
__THROW
 ;

649 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

650 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

651 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

652 #ifde‡
__REDIRECT


656 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

657 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

658 
__isoc99_fwsˇnf
)

660 
	`__REDIRECT
 (
wsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

661 
__isoc99_wsˇnf
)

663 
	`__REDIRECT_NTH
 (
swsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

664 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

665 ...), 
__isoc99_swsˇnf
)

668 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

669 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

670 
	`__isoc99_wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

671 
	$__isoc99_swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

672 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

673 
__THROW
;

674 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

675 
	#wsˇnf
 
__isoc99_wsˇnf


	)

676 
	#swsˇnf
 
__isoc99_swsˇnf


	)

680 
__END_NAMESPACE_STD


683 #ifde‡
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

690 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

691 
__gnuc_va_li°
 
__¨g
)

697 
	`vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

698 
__gnuc_va_li°
 
__¨g
)

701 
	$vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

702 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

703 
__gnuc_va_li°
 
__¨g
)

704 
__THROW
 ;

706 #i‡!
deföed
 
__USE_GNU
 \

707 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

708 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

711 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

712 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

714 
	`__REDIRECT
 (
vwsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

715 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

717 
	`__REDIRECT_NTH
 (
vswsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

718 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

719 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

722 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

723 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

724 
__gnuc_va_li°
 
__¨g
);

725 
	`__isoc99_vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

726 
__gnuc_va_li°
 
__¨g
);

727 
	$__isoc99_vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

728 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

729 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

730 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

731 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

732 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

746 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

752 
wöt_t
 
	`gëwch¨
 ();

759 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

760 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

766 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

774 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

775 
__FILE
 *
__ª°ri˘
 
__°ªam
);

781 
	`Âutws
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

782 
__FILE
 *
__ª°ri˘
 
__°ªam
);

789 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

790 
__END_NAMESPACE_STD


793 #ifde‡
__USE_GNU


801 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

802 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

810 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

818 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

827 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

828 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

837 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

838 
__FILE
 *
__ª°ri˘
 
__°ªam
);

846 
	`Âutws_u∆ocked
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

847 
__FILE
 *
__ª°ri˘
 
__°ªam
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

856 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

857 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifde‡
__USE_GNU


861 
	~<xloˇÀ.h
>

865 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

866 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

867 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

868 
__loˇÀ_t
 
__loc
Ë
__THROW
;

877 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


878 
	#__√ed_iswxxx


	)

879 
	~<w˘y≥.h
>

883 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


884 
	~<bôs/wch¨2.h
>

887 #ifde‡
__LDBL_COMPAT


888 
	~<bôs/wch¨-ldbl.h
>

891 
__END_DECLS


899 #unde‡
__√ed_mb°©e_t


900 #unde‡
__√ed_wöt_t


	@/usr/include/wctype.h

23 #i‚de‡
_WCTYPE_H


25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 #i‚de‡
__√ed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__√ed_wöt_t


	)

33 
	~<wch¨.h
>

37 #i‚de‡
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #unde‡
__√ed_iswxxx


46 #i‚de‡
__iswxxx_deföed


47 
	#__iswxxx_deföed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	tw˘y≥_t
;

53 
	g__END_NAMESPACE_C99


55 #i‚de‡
_ISwbô


60 
	~<ídün.h
>

61 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


62 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

64 
	#_ISwbô
(
bô
) \

65 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

73 
	m__ISwuµî
 = 0,

74 
	m__ISwlowî
 = 1,

75 
	m__ISwÆpha
 = 2,

76 
	m__ISwdigô
 = 3,

77 
	m__ISwxdigô
 = 4,

78 
	m__ISw•a˚
 = 5,

79 
	m__ISw¥öt
 = 6,

80 
	m__ISwgøph
 = 7,

81 
	m__ISwbœnk
 = 8,

82 
	m__ISw˙ål
 = 9,

83 
	m__ISwpun˘
 = 10,

84 
	m__ISwÆnum
 = 11,

86 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

87 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

88 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

89 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

90 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

91 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

92 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

93 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

94 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

95 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

96 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

97 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

117 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

120 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

124 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

128 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

133 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

136 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

141 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

146 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

151 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

156 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

161 #ifde‡
__USE_ISOC99


162 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

171 
w˘y≥_t
 
	$w˘y≥
 (c⁄° *
__¥›îty
Ë
__THROW
;

175 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 c⁄° 
	t__öt32_t
 *
	tw˘øns_t
;

187 
__END_NAMESPACE_C99


188 #ifde‡
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

197 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifde‡
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
w˘øns_t
 
	$w˘øns
 (c⁄° *
__¥›îty
Ë
__THROW
;

221 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifde‡
__USE_XOPEN2K8


226 
	~<xloˇÀ.h
>

230 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

236 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

239 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

243 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

247 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

252 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

255 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

260 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

265 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

270 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

275 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

280 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

284 
w˘y≥_t
 
	$w˘y≥_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

285 
__THROW
;

289 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

290 
__THROW
;

298 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

301 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

305 
w˘øns_t
 
	$w˘øns_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

306 
__THROW
;

309 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

310 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
226
4523
_sockopttmp0.c
capi/socks.h
capi/socks_glibc.h
dlib/int_osf1.c
dlib/int_osf2.c
dlib/int_osf3.c
dlib/interposition.c
include/autoconf.h
include/common.h
include/config.h
include/errorsymbols.h
include/errorsymbols_gen.h
include/fmt.h
include/interposition.h
include/monitor.h
include/osdep.h
include/qos.h
include/redefac.h
include/sockd.h
include/socks.h
include/socks_gssapi.h
include/symbols.h
include/tostring.h
include/upnp.h
include/yacconfig.h
lib/Raccept.c
lib/Rbind.c
lib/Rbindresvport.c
lib/Rcompat.c
lib/Rconnect.c
lib/Rgethostbyname.c
lib/Rgetpeername.c
lib/Rgetsockname.c
lib/Rgetsockopt.c
lib/Rlisten.c
lib/Rrresvport.c
lib/address.c
lib/addressmatch.c
lib/authneg.c
lib/broken.c
lib/client.c
lib/clientconfig.c
lib/clientprotocol.c
lib/config.c
lib/config_parse.c
lib/config_parse.h
lib/config_parse.y
lib/config_scan.c
lib/config_scan.l
lib/connectchild.c
lib/debug.c
lib/errorsymbols.c
lib/fmt.c
lib/fmt_customer.c
lib/fmt_protocol.c
lib/gssapi.c
lib/hostcache.c
lib/hostid.c
lib/httpproxy.c
lib/hw.c
lib/iface.c
lib/io.c
lib/iobuf.c
lib/ipv6.c
lib/log.c
lib/method.c
lib/parse_util.c
lib/protocol.c
lib/serr.c
lib/showconfig.c
lib/sockaddr.c
lib/socket.c
lib/socketopt.c
lib/sockopt.c
lib/sockopt_gen.c
lib/tcpinfo.c
lib/time.c
lib/tostring.c
lib/udp.c
lib/udp_util.c
lib/upnp.c
lib/userio.c
lib/util.c
libscompat/daemon.c
libscompat/difftime.c
libscompat/getifaddrs.c
libscompat/hstrerror.c
libscompat/ifaddrs.h
libscompat/in_cksum.c
libscompat/in_cksum.h
libscompat/inet_ntoa.c
libscompat/inet_pton.c
libscompat/issetugid.c
libscompat/memmove.c
libscompat/pselect.c
libscompat/seteuid.c
libscompat/setproctitle.c
libscompat/sockatmark.c
libscompat/strlcpy.c
libscompat/strvis.c
libscompat/timers.h
libscompat/vis_compat.h
libscompat/vsyslog.c
sockd/accesscheck.c
sockd/auth_bsd.c
sockd/auth_pam.c
sockd/auth_password.c
sockd/cpu.c
sockd/cpuaffinity.c
sockd/cpupolicy.c
sockd/dante_udp.c
sockd/fmt_sockd.c
sockd/getoutaddr.c
sockd/ldap_util.c
sockd/math.c
sockd/method_gssapi.c
sockd/method_uname.c
sockd/monitor.c
sockd/monitor_util.c
sockd/mother_util.c
sockd/privileges.c
sockd/rule.c
sockd/serverconfig.c
sockd/session.c
sockd/shmem.c
sockd/shmemconfig.c
sockd/sockd.c
sockd/sockd_child.c
sockd/sockd_icmp.c
sockd/sockd_io.c
sockd/sockd_io_misc.c
sockd/sockd_negotiate.c
sockd/sockd_protocol.c
sockd/sockd_request.c
sockd/sockd_socket.c
sockd/sockd_tcp.c
sockd/sockd_udp.c
sockd/sockd_util.c
sockd/statistics.c
sockd/udp_port.c
unlicensed/bandwidth.c
unlicensed/bandwidth_key.c
unlicensed/checkmodule.c
unlicensed/ldap.c
unlicensed/ldap_key.c
unlicensed/redirect.c
unlicensed/redirect_key.c
/usr/include/arpa/inet.h
/usr/include/arpa/nameser.h
/usr/include/assert.h
/usr/include/com_err.h
/usr/include/crypt.h
/usr/include/ctype.h
/usr/include/curl/curl.h
/usr/include/dlfcn.h
/usr/include/errno.h
/usr/include/et/com_err.h
/usr/include/execinfo.h
/usr/include/fcntl.h
/usr/include/grp.h
/usr/include/gssapi.h
/usr/include/gssapi/gssapi.h
/usr/include/gssapi/gssapi_ext.h
/usr/include/gssapi/gssapi_generic.h
/usr/include/gssapi/gssapi_krb5.h
/usr/include/ifaddrs.h
/usr/include/inttypes.h
/usr/include/json-c/json.h
/usr/include/krb5.h
/usr/include/lber.h
/usr/include/ldap.h
/usr/include/limits.h
/usr/include/math.h
/usr/include/net/if.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/netinet/in_systm.h
/usr/include/netinet/ip.h
/usr/include/netinet/ip_icmp.h
/usr/include/netinet/tcp.h
/usr/include/netinet/udp.h
/usr/include/pthread.h
/usr/include/pwd.h
/usr/include/regex.h
/usr/include/resolv.h
/usr/include/rpc/rpc.h
/usr/include/sched.h
/usr/include/setjmp.h
/usr/include/shadow.h
/usr/include/signal.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/syslog.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/valgrind/valgrind.h
/usr/include/alloca.h
/usr/include/arpa/nameser_compat.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/krb5/krb5.h
/usr/include/lber_types.h
/usr/include/ldap_features.h
/usr/include/libio.h
/usr/include/paths.h
/usr/include/rpc/auth.h
/usr/include/rpc/auth_des.h
/usr/include/rpc/auth_unix.h
/usr/include/rpc/clnt.h
/usr/include/rpc/netdb.h
/usr/include/rpc/rpc_msg.h
/usr/include/rpc/svc.h
/usr/include/rpc/svc_auth.h
/usr/include/rpc/types.h
/usr/include/rpc/xdr.h
/usr/include/stdint.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/ldap_cdefs.h
/usr/include/stdc-predef.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
